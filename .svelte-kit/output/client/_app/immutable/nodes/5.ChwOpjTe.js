import{Z as ot,s as Xe,e as f,j as L,b as _,q as k,d as J,h as a,m as D,v as E,i as U,w as i,x as Y,n as pe,z as Ae,_ as At,B as F,p as yt,o as Pt,k as _e,$ as it,t as Q,r as $,f as V,a0 as St,y as ce,a1 as qe,A as be,a2 as ht,l as Bt}from"../chunks/index.BYLndrM5.js";import{S as Je,i as Ye,t as je,a as et,c as Mt,b as Rt,d as Ht,m as qt,e as Ut,g as zt}from"../chunks/index.BNHbygFo.js";import{e as Oe,u as Ze,d as Qe,a as Ft,c as Vt,b as Kt,i as wt,f as jt,g as Gt,s as lt,h as Pe,j as Wt,p as Xt}from"../chunks/index.B2EzFEja.js";import{g as Te}from"../chunks/entry.BxUesXR0.js";import"../chunks/index-48209844.IIRtDZyg.js";import{m as rt,a as Ge,I as Jt}from"../chunks/IonPage.KvUD72q2.js";import{q as Yt,t as Zt}from"../chunks/ion-modal.CsJaVgKZ.js";const Qt=(l,e)=>{if(!customElements.get(l)){class t extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const n={};for(const r of this.attributes)n[r.name]=r.value;new e({target:this.shadowRoot,props:n})}}customElements.define(l,t)}},$t=function(l){return document.createElement(l).constructor!==HTMLElement},xt=(l,e)=>{$t(l)||Qt(l,e)},We=async(l,e,t)=>{Yt(),Zt(),xt(l,e);const o=await rt.create({component:l,componentProps:t});return o.present(),await o.onWillDismiss()};let we=ot({km_inicial:[],gas_inicial:[],km_final:[],gas_final:[]}),Lt=ot({flag:[]});function en(l){let e,t,o,n,r="Cancelar",d,h,m="Captura de Km/Gas",O,I,v,s="Confirmar",p,g,u,c,N,C,S;return{c(){e=f("ion-header"),t=f("ion-toolbar"),o=f("ion-buttons"),n=f("ion-button"),n.textContent=r,d=L(),h=f("ion-title"),h.textContent=m,O=L(),I=f("ion-buttons"),v=f("ion-button"),v.textContent=s,p=L(),g=f("ion-content"),u=f("ion-item"),c=f("ion-input"),this.h()},l(A){e=_(A,"ION-HEADER",{translucent:!0});var P=k(e);t=_(P,"ION-TOOLBAR",{});var y=k(t);o=_(y,"ION-BUTTONS",{slot:!0});var M=k(o);n=_(M,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),J(n)!=="svelte-17pq4f4"&&(n.textContent=r),M.forEach(a),d=D(y),h=_(y,"ION-TITLE",{"data-svelte-h":!0}),J(h)!=="svelte-1yhkaq7"&&(h.textContent=m),O=D(y),I=_(y,"ION-BUTTONS",{slot:!0});var H=k(I);v=_(H,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),J(v)!=="svelte-cm6j4s"&&(v.textContent=s),H.forEach(a),y.forEach(a),P.forEach(a),p=D(A),g=_(A,"ION-CONTENT",{fullscreen:!0});var b=k(g);u=_(b,"ION-ITEM",{});var R=k(u);c=_(R,"ION-INPUT",{class:!0,inputmode:!0,pattern:!0,type:!0,placeholder:!0,value:!0,required:!0});var T=k(c);T.forEach(a),R.forEach(a),b.forEach(a),this.h()},h(){E(n,"color","medium"),E(o,"slot","start"),E(v,"strong",""),E(I,"slot","end"),E(e,"translucent",""),E(c,"class","fin-km"),E(c,"inputmode","numeric"),E(c,"pattern","[0-9]*"),E(c,"type","number"),E(c,"placeholder",N="Ingresa "+l[0]+" actual"),E(c,"value",l[1]),E(c,"required",""),E(g,"fullscreen","")},m(A,P){U(A,e,P),i(e,t),i(t,o),i(o,n),i(t,d),i(t,h),i(t,O),i(t,I),i(I,v),U(A,p,P),U(A,g,P),i(g,u),i(u,c),C||(S=[Y(n,"click",l[2]),Y(v,"click",l[3]),Y(c,"input",l[4])],C=!0)},p(A,[P]){P&1&&N!==(N="Ingresa "+A[0]+" actual")&&E(c,"placeholder",N),P&2&&E(c,"value",A[1])},i:pe,o:pe,d(A){A&&(a(e),a(p),a(g)),C=!1,Ae(S)}}}function tn(l,e,t){const o=At();let n=document.querySelector("ion-modal"),r=n.componentProps.data_type;n.componentProps.isLast;let d;Lt.subscribe(v=>{r=v.flag[0],r=="km_final"||r=="km_inicial"?t(0,d="kilometraje"):t(0,d="litros de gasolina")});let h=0;function m(){rt.dismiss()}function O(){o("modalResult",{data:"Your data",role:"confirm"}),r=="km_inicial"?we.update(s=>({...s,km_inicial:[h]})):r=="gas_inicial"?we.update(s=>({...s,gas_inicial:[h]})):r=="km_final"?we.update(s=>({...s,km_final:[h]})):r=="gas_final"&&we.update(s=>({...s,gas_final:[h]})),m()}return[d,h,m,O,v=>t(1,h=v.target.value)]}class nn extends Je{constructor(e){super(),Ye(this,e,tn,en,Xe,{})}}const Ke=ot({items:[],checkedIndices:[],mandatory:[]});function dt(l,e,t){const o=l.slice();return o[50]=e[t],o[51]=e,o[52]=t,o}function on(l){let e,t,o,n,r,d="Kilometraje inicial",h,m,O=l[0]?l[0]+" km.":"Cargar km",I,v,s,p,g,u,c,N="Gasolina inicial (litros)",C,S,A=l[1]?l[1]+" litros":"Cargar gas",P,y,M,H;return y=it(l[20][0]),{c(){e=f("ion-item"),t=f("ion-label"),o=f("input"),n=L(),r=f("p"),r.textContent=d,h=L(),m=f("ion-button"),I=Q(O),v=L(),s=f("ion-item"),p=f("ion-label"),g=f("input"),u=L(),c=f("p"),c.textContent=N,C=L(),S=f("ion-button"),P=Q(A),this.h()},l(b){e=_(b,"ION-ITEM",{});var R=k(e);t=_(R,"ION-LABEL",{style:!0});var T=k(t);o=_(T,"INPUT",{id:!0,style:!0,type:!0}),n=D(T),r=_(T,"P",{style:!0,"data-svelte-h":!0}),J(r)!=="svelte-88twxi"&&(r.textContent=d),T.forEach(a),h=D(R),m=_(R,"ION-BUTTON",{fill:!0,size:!0,class:!0,"aria-selected":!0});var w=k(m);I=$(w,O),w.forEach(a),R.forEach(a),v=D(b),s=_(b,"ION-ITEM",{});var q=k(s);p=_(q,"ION-LABEL",{style:!0});var z=k(p);g=_(z,"INPUT",{id:!0,style:!0,type:!0}),u=D(z),c=_(z,"P",{style:!0,"data-svelte-h":!0}),J(c)!=="svelte-1ux30eb"&&(c.textContent=N),z.forEach(a),C=D(q),S=_(q,"ION-BUTTON",{fill:!0,class:!0,size:!0,style:!0});var K=k(S);P=$(K,A),K.forEach(a),q.forEach(a),this.h()},h(){V(o,"id","chkbox-km-ini"),F(o,"pointer-events","auto"),V(o,"type","checkbox"),o.required=!0,F(r,"margin-left","10px"),F(t,"display","flex"),E(m,"fill","outline"),E(m,"size","small"),E(m,"class","loadKmInicial"),E(m,"aria-selected",""),V(g,"id","chkbox-gas-ini"),F(g,"pointer-events","auto"),V(g,"type","checkbox"),g.required=!0,F(c,"margin-left","10px"),F(p,"display","flex"),E(S,"fill","outline"),E(S,"class","loadGasInicial"),E(S,"size","small"),F(S,"height","16px "),y.p(o,g)},m(b,R){U(b,e,R),i(e,t),i(t,o),o.checked=~(l[4]||[]).indexOf(o.__value),l[27](o),i(t,n),i(t,r),i(e,h),i(e,m),i(m,I),U(b,v,R),U(b,s,R),i(s,p),i(p,g),l[29](g),g.checked=~(l[4]||[]).indexOf(g.__value),i(p,u),i(p,c),i(s,C),i(s,S),i(S,P),M||(H=[Y(o,"change",l[26]),Y(m,"click",l[28]),Y(g,"change",l[30]),Y(S,"click",l[31])],M=!0)},p(b,R){R[0]&16&&(o.checked=~(b[4]||[]).indexOf(o.__value)),R[0]&1&&O!==(O=b[0]?b[0]+" km.":"Cargar km")&&ce(I,O),R[0]&16&&(g.checked=~(b[4]||[]).indexOf(g.__value)),R[0]&2&&A!==(A=b[1]?b[1]+" litros":"Cargar gas")&&ce(P,A)},d(b){b&&(a(e),a(v),a(s)),l[27](null),l[29](null),y.r(),M=!1,Ae(H)}}}function ln(l){let e,t,o,n,r,d="Kilometraje final",h,m,O=l[2]?l[2]+" km.":"Cargar km",I,v,s,p,g,u,c,N="Gasolina final (litros)",C,S,A=l[3]?l[3]+" litros":"Cargar gas",P,y,M,H;return y=it(l[20][0]),{c(){e=f("ion-item"),t=f("ion-label"),o=f("input"),n=L(),r=f("p"),r.textContent=d,h=L(),m=f("ion-button"),I=Q(O),v=L(),s=f("ion-item"),p=f("ion-label"),g=f("input"),u=L(),c=f("p"),c.textContent=N,C=L(),S=f("ion-button"),P=Q(A),this.h()},l(b){e=_(b,"ION-ITEM",{});var R=k(e);t=_(R,"ION-LABEL",{style:!0});var T=k(t);o=_(T,"INPUT",{id:!0,style:!0,type:!0}),n=D(T),r=_(T,"P",{style:!0,"data-svelte-h":!0}),J(r)!=="svelte-ccmu71"&&(r.textContent=d),T.forEach(a),h=D(R),m=_(R,"ION-BUTTON",{fill:!0,size:!0,class:!0,"aria-selected":!0});var w=k(m);I=$(w,O),w.forEach(a),R.forEach(a),v=D(b),s=_(b,"ION-ITEM",{});var q=k(s);p=_(q,"ION-LABEL",{style:!0});var z=k(p);g=_(z,"INPUT",{id:!0,style:!0,type:!0}),u=D(z),c=_(z,"P",{style:!0,"data-svelte-h":!0}),J(c)!=="svelte-wsoyd2"&&(c.textContent=N),z.forEach(a),C=D(q),S=_(q,"ION-BUTTON",{fill:!0,size:!0,class:!0});var K=k(S);P=$(K,A),K.forEach(a),q.forEach(a),this.h()},h(){V(o,"id","chkbox-km-fin"),F(o,"pointer-events","auto"),V(o,"type","checkbox"),o.required=!0,F(r,"margin-left","10px"),F(t,"display","flex"),E(m,"fill","outline"),E(m,"size","small"),E(m,"class","loadKmInicial"),E(m,"aria-selected",""),V(g,"id","chkbox-gas-fin"),F(g,"pointer-events","auto"),V(g,"type","checkbox"),g.required=!0,F(c,"margin-left","10px"),F(p,"display","flex"),E(S,"fill","outline"),E(S,"size","small"),E(S,"class","loadGasInicial"),y.p(o,g)},m(b,R){U(b,e,R),i(e,t),i(t,o),o.checked=~(l[4]||[]).indexOf(o.__value),l[21](o),i(t,n),i(t,r),i(e,h),i(e,m),i(m,I),U(b,v,R),U(b,s,R),i(s,p),i(p,g),g.checked=~(l[4]||[]).indexOf(g.__value),l[24](g),i(p,u),i(p,c),i(s,C),i(s,S),i(S,P),M||(H=[Y(o,"change",l[19]),Y(m,"click",l[22]),Y(g,"change",l[23]),Y(S,"click",l[25])],M=!0)},p(b,R){R[0]&16&&(o.checked=~(b[4]||[]).indexOf(o.__value)),R[0]&4&&O!==(O=b[2]?b[2]+" km.":"Cargar km")&&ce(I,O),R[0]&16&&(g.checked=~(b[4]||[]).indexOf(g.__value)),R[0]&8&&A!==(A=b[3]?b[3]+" litros":"Cargar gas")&&ce(P,A)},d(b){b&&(a(e),a(v),a(s)),l[21](null),l[24](null),y.r(),M=!1,Ae(H)}}}function rn(l){let e=[],t=new Map,o,n=Oe(l[12]);const r=d=>d[50].id_checklist_event;for(let d=0;d<n.length;d+=1){let h=dt(l,n,d),m=r(h);t.set(m,e[d]=pt(m,h))}return{c(){for(let d=0;d<e.length;d+=1)e[d].c();o=_e()},l(d){for(let h=0;h<e.length;h+=1)e[h].l(d);o=_e()},m(d,h){for(let m=0;m<e.length;m+=1)e[m]&&e[m].m(d,h);U(d,o,h)},p(d,h){h[0]&202864&&(n=Oe(d[12]),e=Ze(e,h,r,1,d,n,t,o.parentNode,Qe,pt,o,dt))},d(d){d&&a(o);for(let h=0;h<e.length;h+=1)e[h].d(d)}}}function pt(l,e){let t,o,n,r=e[50],d,h,m=e[50].item+"",O,I,v,s,p=(e[11][e[50].id_checklist_event]?e[11][e[50].id_checklist_event]:"Cargar evidencia")+"",g,u,c,N,C,S,A;const P=()=>e[33](n,r),y=()=>e[33](null,r);function M(){return e[34](e[50])}function H(...b){return e[36](e[50],...b)}return C=it(e[20][0]),{key:l,first:null,c(){t=f("ion-item"),o=f("ion-label"),n=f("input"),d=L(),h=f("p"),O=Q(m),I=L(),v=f("ion-button"),s=f("label"),g=Q(p),u=L(),c=f("input"),N=L(),this.h()},l(b){t=_(b,"ION-ITEM",{});var R=k(t);o=_(R,"ION-LABEL",{style:!0});var T=k(o);n=_(T,"INPUT",{id:!0,style:!0,type:!0}),d=D(T),h=_(T,"P",{style:!0});var w=k(h);O=$(w,m),w.forEach(a),T.forEach(a),I=D(R),v=_(R,"ION-BUTTON",{fill:!0,class:!0,size:!0});var q=k(v);s=_(q,"LABEL",{for:!0});var z=k(s);g=$(z,p),z.forEach(a),u=D(q),c=_(q,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0}),q.forEach(a),N=D(R),R.forEach(a),this.h()},h(){V(n,"id",`chkbox-${e[50].id_checklist_event}`),F(n,"pointer-events","auto"),V(n,"type","checkbox"),n.__value=e[50].id_checklist_event,St(n,n.__value),n.required=!0,F(h,"margin-left","10px"),F(o,"display","flex"),V(s,"for","chklist-"+e[50].id_checklist_event),F(c,"display","none"),V(c,"id","chklist-"+e[50].id_checklist_event),V(c,"name","fileToUpload"),V(c,"type","file"),V(c,"accept","image/*"),E(v,"fill","outline"),E(v,"class","loadEvidence svelte-1lh6nay"),E(v,"size","small"),C.p(n),this.first=t},m(b,R){U(b,t,R),i(t,o),i(o,n),n.checked=~(e[4]||[]).indexOf(n.__value),P(),i(o,d),i(o,h),i(h,O),i(t,I),i(t,v),i(v,s),i(s,g),i(v,u),i(v,c),e[35](c),i(t,N),S||(A=[Y(n,"change",e[32]),Y(n,"change",M),Y(c,"change",H)],S=!0)},p(b,R){e=b,R[0]&16&&(n.checked=~(e[4]||[]).indexOf(n.__value)),r!==e[50]&&(y(),r=e[50],P()),R[0]&2048&&p!==(p=(e[11][e[50].id_checklist_event]?e[11][e[50].id_checklist_event]:"Cargar evidencia")+"")&&ce(g,p)},d(b){b&&a(t),y(),e[35](null),C.r(),S=!1,Ae(A)}}}function an(l){let e,t,o,n,r="Cancelar",d,h,m="Requerimientos de ruta",O,I,v,s,p,g,u,c="Confirmar",N,C;function S(M,H){return M[13]?ln:on}let P=S(l)(l),y=l[12]&&rn(l);return{c(){e=f("ion-header"),t=f("ion-toolbar"),o=f("ion-buttons"),n=f("ion-button"),n.textContent=r,d=L(),h=f("ion-title"),h.textContent=m,O=L(),I=f("ion-content"),v=f("ion-list"),P.c(),s=L(),y&&y.c(),p=L(),g=f("ion-footer"),u=f("ion-button"),u.textContent=c,this.h()},l(M){e=_(M,"ION-HEADER",{translucent:!0});var H=k(e);t=_(H,"ION-TOOLBAR",{});var b=k(t);o=_(b,"ION-BUTTONS",{slot:!0});var R=k(o);n=_(R,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),J(n)!=="svelte-1dnmkxs"&&(n.textContent=r),R.forEach(a),d=D(b),h=_(b,"ION-TITLE",{"data-svelte-h":!0}),J(h)!=="svelte-ucox25"&&(h.textContent=m),b.forEach(a),H.forEach(a),O=D(M),I=_(M,"ION-CONTENT",{fullscreen:!0});var T=k(I);v=_(T,"ION-LIST",{});var w=k(v);P.l(w),s=D(w),y&&y.l(w),w.forEach(a),T.forEach(a),p=D(M),g=_(M,"ION-FOOTER",{});var q=k(g);u=_(q,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),J(u)!=="svelte-g82qqw"&&(u.textContent=c),q.forEach(a),this.h()},h(){E(n,"color","medium"),E(o,"slot","start"),E(e,"translucent",""),E(I,"fullscreen",""),E(u,"fill","outline"),E(u,"color","tertiary"),E(u,"strong",""),F(u,"width","99%"),F(u,"height","auto")},m(M,H){U(M,e,H),i(e,t),i(t,o),i(o,n),i(t,d),i(t,h),U(M,O,H),U(M,I,H),i(I,v),P.m(v,null),i(v,s),y&&y.m(v,null),U(M,p,H),U(M,g,H),i(g,u),N||(C=[Y(n,"click",l[14]),Y(u,"click",l[15])],N=!0)},p(M,H){P.p(M,H),M[12]&&y.p(M,H)},i:pe,o:pe,d(M){M&&(a(e),a(O),a(I),a(p),a(g)),P.d(),y&&y.d(),N=!1,Ae(C)}}}function tt(l,e){if(typeof l=="object"&&l!==null||Array.isArray(l)){if(Array.isArray(l))return l.map(t=>tt(t,e)).flat();{const t=Object.keys(l);let o;return e=="id_checklist_event"?o=t.filter(r=>r.toLowerCase().includes("id_checklist_event")).map(r=>l[r]):e=="mandatory"?o=t.filter(r=>r.toLowerCase().includes("mandatory")).map(r=>l[r]):(console.error("Tipo de dato no reconocido."),o=!1),o}}else return console.error("Invalid input. Please provide a valid object or array."),[]}function xe(l,e){let t=new FormData;t.append("id_route",l),t.append("status",e),fetch("https://app.rutaflow.com/api/admin/route/change_status.php",{method:"POST",body:t}).then(o=>o.json()).then(o=>{}).catch(o=>{console.error("Error fetching data:",o)})}function sn(l,e,t){let o;yt(l,Ke,B=>t(39,o=B));let n=document.querySelector("ion-modal");const r=n.componentProps.checklist,d=n.componentProps.driverId,h=n.componentProps.routeId,m=n.componentProps.isLast;let O,I,v,s,p=[],g=null,u={},c,N,C,S,A={},P={};Pt(()=>{m?console.log("Último checklist"):(Ke.update(B=>(B.mandatory=tt(r,"mandatory"),B.items=tt(r,"id_checklist_event"),B)),console.log(o))});const y=async()=>{await(await Ge.create({header:"Datos o checklist incompletos",message:"Carga la evidencia requerida y marca todas las casillas para confirmar",buttons:[{text:"Cerrar"}]})).present()},M=async()=>{await(await Ge.create({header:"Datos capturados",message:"El kilometraje y gasolina final fueron registrados correctamente, espere aprobación para finalizar ruta",buttons:[{text:"Cerrar"}]})).present()},H=async B=>{await(await Ge.create({header:"Datos inválidos",message:B=="km"?"Llena correctamente el campo de kilometraje inicial":"Llena correctamente el campo de gasolina inicial",buttons:[{text:"Cerrar"}]})).present()},b=()=>{rt.dismiss(),d?Te(`/drivers/${d}`):Te("/drivers/me")},R=()=>{if(m){var B=z(v,"km"),G=z(s,"gas");const X=new FormData;X.append("km_final",B),X.append("gas_final",G),X.append("id_route",h),B&&G?(b(),fetch("https://app.rutaflow.com/api/admin/checklist/add_evidence.php",{method:"POST",body:X}).then(x=>x.json()).then(x=>{M()}).catch(x=>{console.error("Error fetching data:",x)})):y()}else{var te=z(O,"km"),oe=z(I,"gas");Ke.update(X=>{const x=X.items,ne=X.mandatory;if(x.every(j=>X.checkedIndices.includes(j))&&te&&oe){b();const j=new FormData;for(const W in A)if(A.hasOwnProperty(W)){const{img:se,img_id:Ce}=A[W];j.append(`selectedImages[${W}][img]`,se),j.append(`selectedImages[${W}][img_id]`,Ce)}j.append("km_inicial",te),j.append("gas_inicial",oe),j.append("id_route",h),fetch("https://app.rutaflow.com/api/admin/checklist/add_evidence.php",{method:"POST",body:j}).then(W=>W.json()).then(W=>{ne&&ne[0]=="1"?xe(h,"checklist-pending"):xe(h,"enroute")}).catch(W=>{console.error("Error fetching data:",W)})}else y();return X})}re()},T=async(B,G)=>{const oe=B.target.files[0],X=await w(oe);if(X){const x=new FormData;x.append("fileToUpload",X);try{const ne=await fetch("https://app.rutaflow.com/api/admin/manager/upload_img_driver.php",{method:"POST",body:x});if(ne.ok){const Z=await ne.json();A={...A,[G]:{img:Z.img,img_id:Z.img_id}},t(11,P={...P,[G]:Z.filename}),q(G),t(6,u[G].checked=!0,u)}else console.error("File upload failed:",ne.statusText)}catch(ne){console.error("Error during file upload:",ne)}}},w=async B=>new Promise(G=>{const te=new FileReader;te.onload=oe=>{const X=new Image;X.src=oe.target.result,X.onload=()=>{const x=document.createElement("canvas"),ne=x.getContext("2d"),Z=800,j=600;let W=X.width,se=X.height;W>Z&&(se*=Z/W,W=Z),se>j&&(W*=j/se,se=j),x.width=W,x.height=se,ne.drawImage(X,0,0,W,se),x.toBlob(Ce=>{G(Ce)},"image/jpeg",.7)}},te.readAsDataURL(B)}),q=B=>{Ke.update(G=>(G.checkedIndices.indexOf(B)===-1?G.checkedIndices.push(B):console.error(`ID ${B} is already checked.`),G.items.forEach(oe=>{oe.id_checklist_event===B&&(oe.checked=!0)}),G))};function z(B,G){return/^\d+$/.test(B)?parseInt(B,10):(H(G),null)}function K(B,G){ee(G),n.componentProps.data_type=G,We("modal-gas-km",nn,{r:G}).then(()=>{we.subscribe(te=>{ie(te,G)})})}function ee(B){Lt.update(G=>({...G,flag:[B]}))}function ie(B,G){t(0,O=B.km_inicial?B.km_inicial:null),t(1,I=B.gas_inicial?B.gas_inicial:null),t(2,v=B.km_final?B.km_final:null),t(3,s=B.gas_final?B.gas_final:null),G=="km_inicial"&&t(7,c.checked=!0,c),G=="gas_inicial"&&t(8,N.checked=!0,N),G=="km_final"&&t(9,C.checked=!0,C),G=="gas_final"&&t(10,S.checked=!0,S)}function re(){we.set({km_inicial:[],gas_inicial:[],km_final:[],gas_final:[]})}const de=[[]];function he(){p=qe(de[0],this.__value,this.checked),t(4,p)}function ae(B){be[B?"unshift":"push"](()=>{C=B,t(9,C)})}const ke=B=>K(B,"km_final");function Ie(){p=qe(de[0],this.__value,this.checked),t(4,p)}function Se(B){be[B?"unshift":"push"](()=>{S=B,t(10,S)})}const Ne=B=>K(B,"gas_final");function ve(){p=qe(de[0],this.__value,this.checked),t(4,p)}function ue(B){be[B?"unshift":"push"](()=>{c=B,t(7,c)})}const Ee=B=>K(B,"km_inicial");function Be(B){be[B?"unshift":"push"](()=>{N=B,t(8,N)})}function ge(){p=qe(de[0],this.__value,this.checked),t(4,p)}const Ue=B=>K(B,"gas_inicial");function Me(){p=qe(de[0],this.__value,this.checked),t(4,p)}function me(B,G){be[B?"unshift":"push"](()=>{u[G.id_checklist_event]=B,t(6,u)})}const Re=B=>q(B.id_checklist_event);function He(B){be[B?"unshift":"push"](()=>{g=B,t(5,g)})}return[O,I,v,s,p,g,u,c,N,C,S,P,r,m,b,R,T,q,K,he,de,ae,ke,Ie,Se,Ne,ve,ue,Ee,Be,ge,Ue,Me,me,Re,He,(B,G)=>T(G,B.id_checklist_event)]}class Dt extends Je{constructor(e){super(),Ye(this,e,sn,an,Xe,{},null,[-1,-1])}}function cn(l){let e,t,o,n,r,d="Domicilio 2",h,m,O=l[2].line2+"",I,v,s;return{c(){e=f("ion-item"),t=f("ion-icon"),o=L(),n=f("ion-label"),r=f("p"),r.textContent=d,h=L(),m=f("h2"),I=Q(O),v=L(),s=f("ion-icon"),this.h()},l(p){e=_(p,"ION-ITEM",{href:!0});var g=k(e);t=_(g,"ION-ICON",{icon:!0,slot:!0}),k(t).forEach(a),o=D(g),n=_(g,"ION-LABEL",{class:!0});var u=k(n);r=_(u,"P",{"data-svelte-h":!0}),J(r)!=="svelte-1qy148r"&&(r.textContent=d),h=D(u),m=_(u,"H2",{});var c=k(m);I=$(c,O),c.forEach(a),u.forEach(a),v=D(g),s=_(g,"ION-ICON",{icon:!0,slot:!0}),k(s).forEach(a),g.forEach(a),this.h()},h(){E(t,"icon",lt),E(t,"slot","start"),E(n,"class","ion-text-wrap"),E(s,"icon",Pe),E(s,"slot","end"),E(e,"href","https://www.google.com/maps/searhc/?api=1&query="+l[2].line2)},m(p,g){U(p,e,g),i(e,t),i(e,o),i(e,n),i(n,r),i(n,h),i(n,m),i(m,I),i(e,v),i(e,s)},p:pe,d(p){p&&a(e)}}}function un(l){let e,t,o,n,r,d="Domicilio 1",h,m,O=l[2].line1+"",I,v,s,p,g=l[2].line2&&l[2].line2.trim().length,u,c=g&&fn(l);return{c(){e=f("ion-item"),t=f("ion-icon"),o=L(),n=f("ion-label"),r=f("p"),r.textContent=d,h=L(),m=f("h2"),I=Q(O),v=L(),s=f("ion-icon"),p=L(),c&&c.c(),u=_e(),this.h()},l(N){e=_(N,"ION-ITEM",{href:!0});var C=k(e);t=_(C,"ION-ICON",{icon:!0,slot:!0}),k(t).forEach(a),o=D(C),n=_(C,"ION-LABEL",{class:!0});var S=k(n);r=_(S,"P",{"data-svelte-h":!0}),J(r)!=="svelte-1ehcrdm"&&(r.textContent=d),h=D(S),m=_(S,"H2",{});var A=k(m);I=$(A,O),A.forEach(a),S.forEach(a),v=D(C),s=_(C,"ION-ICON",{icon:!0,slot:!0}),k(s).forEach(a),C.forEach(a),p=D(N),c&&c.l(N),u=_e(),this.h()},h(){E(t,"icon",lt),E(t,"slot","start"),E(n,"class","ion-text-wrap"),E(s,"icon",Pe),E(s,"slot","end"),E(e,"href","https://www.google.com/maps/search/?api=1&query="+l[2].line1)},m(N,C){U(N,e,C),i(e,t),i(e,o),i(e,n),i(n,r),i(n,h),i(n,m),i(m,I),i(e,v),i(e,s),U(N,p,C),c&&c.m(N,C),U(N,u,C)},p(N,C){g&&c.p(N,C)},d(N){N&&(a(e),a(p),a(u)),c&&c.d(N)}}}function fn(l){let e,t,o,n,r,d="Domicilio 2",h,m,O=l[2].line2+"",I,v,s;return{c(){e=f("ion-item"),t=f("ion-icon"),o=L(),n=f("ion-label"),r=f("p"),r.textContent=d,h=L(),m=f("h2"),I=Q(O),v=L(),s=f("ion-icon"),this.h()},l(p){e=_(p,"ION-ITEM",{href:!0});var g=k(e);t=_(g,"ION-ICON",{icon:!0,slot:!0}),k(t).forEach(a),o=D(g),n=_(g,"ION-LABEL",{class:!0});var u=k(n);r=_(u,"P",{"data-svelte-h":!0}),J(r)!=="svelte-1qy148r"&&(r.textContent=d),h=D(u),m=_(u,"H2",{});var c=k(m);I=$(c,O),c.forEach(a),u.forEach(a),v=D(g),s=_(g,"ION-ICON",{icon:!0,slot:!0}),k(s).forEach(a),g.forEach(a),this.h()},h(){E(t,"icon",lt),E(t,"slot","start"),E(n,"class","ion-text-wrap"),E(s,"icon",Pe),E(s,"slot","end"),E(e,"href","https://www.google.com/maps/search/?api=1&query="+l[2].line2)},m(p,g){U(p,e,g),i(e,t),i(e,o),i(e,n),i(n,r),i(n,h),i(n,m),i(m,I),i(e,v),i(e,s)},p:pe,d(p){p&&a(e)}}}function _n(l){let e,t=l[2].comments!="<br>"&&hn(l);return{c(){t&&t.c(),e=_e()},l(o){t&&t.l(o),e=_e()},m(o,n){t&&t.m(o,n),U(o,e,n)},p(o,n){o[2].comments!="<br>"&&t.p(o,n)},d(o){o&&a(e),t&&t.d(o)}}}function hn(l){let e,t,o,n,r,d="Notas de ubicación",h,m,O=l[2].comments+"",I;return{c(){e=f("ion-item"),t=f("ion-icon"),o=L(),n=f("ion-label"),r=f("p"),r.textContent=d,h=L(),m=f("h2"),I=Q(O),this.h()},l(v){e=_(v,"ION-ITEM",{});var s=k(e);t=_(s,"ION-ICON",{icon:!0,slot:!0}),k(t).forEach(a),o=D(s),n=_(s,"ION-LABEL",{class:!0});var p=k(n);r=_(p,"P",{"data-svelte-h":!0}),J(r)!=="svelte-nhm2ft"&&(r.textContent=d),h=D(p),m=_(p,"H2",{});var g=k(m);I=$(g,O),g.forEach(a),p.forEach(a),s.forEach(a),this.h()},h(){E(t,"icon",wt),E(t,"slot","start"),E(n,"class","ion-text-wrap")},m(v,s){U(v,e,s),i(e,t),i(e,o),i(e,n),i(n,r),i(n,h),i(n,m),i(m,I)},p:pe,d(v){v&&a(e)}}}function dn(l){let e,t,o,n,r,d="Horarios",h,m,O=l[2].schedule+"",I;return{c(){e=f("ion-item"),t=f("ion-icon"),o=L(),n=f("ion-label"),r=f("p"),r.textContent=d,h=L(),m=f("h2"),I=Q(O),this.h()},l(v){e=_(v,"ION-ITEM",{});var s=k(e);t=_(s,"ION-ICON",{icon:!0,slot:!0}),k(t).forEach(a),o=D(s),n=_(s,"ION-LABEL",{});var p=k(n);r=_(p,"P",{"data-svelte-h":!0}),J(r)!=="svelte-11q7hm5"&&(r.textContent=d),h=D(p),m=_(p,"H2",{});var g=k(m);I=$(g,O),g.forEach(a),p.forEach(a),s.forEach(a),this.h()},h(){E(t,"icon",jt),E(t,"slot","start")},m(v,s){U(v,e,s),i(e,t),i(e,o),i(e,n),i(n,r),i(n,h),i(n,m),i(m,I)},p:pe,d(v){v&&a(e)}}}function pn(l){let e,t,o,n,r,d="Notas del operador",h,m,O=l[2].driver_comments+"",I;return{c(){e=f("ion-item"),t=f("ion-icon"),o=L(),n=f("ion-label"),r=f("p"),r.textContent=d,h=L(),m=f("h2"),I=Q(O),this.h()},l(v){e=_(v,"ION-ITEM",{});var s=k(e);t=_(s,"ION-ICON",{icon:!0,slot:!0}),k(t).forEach(a),o=D(s),n=_(s,"ION-LABEL",{});var p=k(n);r=_(p,"P",{"data-svelte-h":!0}),J(r)!=="svelte-1yk9qp4"&&(r.textContent=d),h=D(p),m=_(p,"H2",{});var g=k(m);I=$(g,O),g.forEach(a),p.forEach(a),s.forEach(a),this.h()},h(){E(t,"icon",Gt),E(t,"slot","start")},m(v,s){U(v,e,s),i(e,t),i(e,o),i(e,n),i(n,r),i(n,h),i(n,m),i(m,I)},p:pe,d(v){v&&a(e)}}}function mn(l){let e,t=l[2].logistic_comments!="<br>"&&vn(l);return{c(){t&&t.c(),e=_e()},l(o){t&&t.l(o),e=_e()},m(o,n){t&&t.m(o,n),U(o,e,n)},p(o,n){o[2].logistic_comments!="<br>"&&t.p(o,n)},d(o){o&&a(e),t&&t.d(o)}}}function vn(l){let e,t,o,n,r,d="Comentarios logísticos",h,m,O=l[2].logistic_comments+"",I;return{c(){e=f("ion-item"),t=f("ion-icon"),o=L(),n=f("ion-label"),r=f("p"),r.textContent=d,h=L(),m=f("h2"),I=Q(O),this.h()},l(v){e=_(v,"ION-ITEM",{});var s=k(e);t=_(s,"ION-ICON",{icon:!0,slot:!0}),k(t).forEach(a),o=D(s),n=_(s,"ION-LABEL",{class:!0});var p=k(n);r=_(p,"P",{"data-svelte-h":!0}),J(r)!=="svelte-1iz85r6"&&(r.textContent=d),h=D(p),m=_(p,"H2",{});var g=k(m);I=$(g,O),g.forEach(a),p.forEach(a),s.forEach(a),this.h()},h(){E(t,"icon",wt),E(t,"slot","start"),E(n,"class","ion-text-wrap")},m(v,s){U(v,e,s),i(e,t),i(e,o),i(e,n),i(n,r),i(n,h),i(n,m),i(m,I)},p:pe,d(v){v&&a(e)}}}function mt(l){let e,t,o;return{c(){e=f("section"),t=f("ion-img"),this.h()},l(n){e=_(n,"SECTION",{});var r=k(e);t=_(r,"ION-IMG",{src:!0,alt:!0,style:!0}),k(t).forEach(a),r.forEach(a),this.h()},h(){ht(t.src,o=l[1])||E(t,"src",o),E(t,"alt","Evidencia fotográfica"),F(t,"max-width","100%"),F(t,"margin-top","16px")},m(n,r){U(n,e,r),i(e,t)},p(n,r){r&2&&!ht(t.src,o=n[1])&&E(t,"src",o)},d(n){n&&a(e)}}}function gn(l){let e,t,o,n,r="Cancelar",d,h,m=l[2].title+"",O,I,v,s,p="Confirmar",g,u,c,N,C,S,A,P,y="Cliente",M,H,b=l[2].client_name+"",R,T,w,q=l[2].comments&&l[2].comments.trim().length,z,K=l[2].schedule&&l[2].schedule.trim().length,ee,ie,re=l[2].logistic_comments&&l[2].logistic_comments.trim().length,de,he,ae,ke,Ie,Se,Ne,ve,ue,Ee,Be,ge,Ue="Subir Evidencia",Me,me,Re,He,$e;function B(j,W){if(j[2].line1&&j[2].line1.trim().length)return un;if(j[2].line2&&j[2].line2.trim().length)return cn}let G=B(l),te=G&&G(l),oe=q&&_n(l),X=K&&dn(l),x=l[2].driver_comments&&pn(l),ne=re&&mn(l),Z=l[1]&&mt(l);return{c(){e=f("ion-header"),t=f("ion-toolbar"),o=f("ion-buttons"),n=f("ion-button"),n.textContent=r,d=L(),h=f("ion-title"),O=Q(m),I=L(),v=f("ion-buttons"),s=f("ion-button"),s.textContent=p,g=L(),u=f("ion-content"),c=f("ion-list"),N=f("ion-item"),C=f("ion-icon"),S=L(),A=f("ion-label"),P=f("p"),P.textContent=y,M=L(),H=f("h2"),R=Q(b),T=L(),te&&te.c(),w=L(),oe&&oe.c(),z=L(),X&&X.c(),ee=L(),x&&x.c(),ie=L(),ne&&ne.c(),de=L(),he=f("ion-item"),ae=f("ion-icon"),ke=L(),Ie=f("ion-textarea"),Se=L(),Ne=f("section"),ve=f("label"),ue=f("ion-button"),Ee=f("ion-icon"),Be=L(),ge=f("label"),ge.textContent=Ue,Me=L(),me=f("input"),Re=L(),Z&&Z.c(),this.h()},l(j){e=_(j,"ION-HEADER",{translucent:!0});var W=k(e);t=_(W,"ION-TOOLBAR",{});var se=k(t);o=_(se,"ION-BUTTONS",{slot:!0});var Ce=k(o);n=_(Ce,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),J(n)!=="svelte-1f8rjcf"&&(n.textContent=r),Ce.forEach(a),d=D(se),h=_(se,"ION-TITLE",{title:!0});var at=k(h);O=$(at,m),at.forEach(a),I=D(se),v=_(se,"ION-BUTTONS",{slot:!0});var st=k(v);s=_(st,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),J(s)!=="svelte-1ida0il"&&(s.textContent=p),st.forEach(a),se.forEach(a),W.forEach(a),g=D(j),u=_(j,"ION-CONTENT",{fullscreen:!0});var ct=k(u);c=_(ct,"ION-LIST",{});var le=k(c);N=_(le,"ION-ITEM",{});var ze=k(N);C=_(ze,"ION-ICON",{icon:!0,slot:!0}),k(C).forEach(a),S=D(ze),A=_(ze,"ION-LABEL",{});var Fe=k(A);P=_(Fe,"P",{"data-svelte-h":!0}),J(P)!=="svelte-jrq7ei"&&(P.textContent=y),M=D(Fe),H=_(Fe,"H2",{});var ut=k(H);R=$(ut,b),ut.forEach(a),Fe.forEach(a),ze.forEach(a),T=D(le),te&&te.l(le),w=D(le),oe&&oe.l(le),z=D(le),X&&X.l(le),ee=D(le),x&&x.l(le),ie=D(le),ne&&ne.l(le),de=D(le),he=_(le,"ION-ITEM",{});var Ve=k(he);ae=_(Ve,"ION-ICON",{icon:!0,slot:!0}),k(ae).forEach(a),ke=D(Ve),Ie=_(Ve,"ION-TEXTAREA",{label:!0,placeholder:!0}),k(Ie).forEach(a),Ve.forEach(a),Se=D(le),Ne=_(le,"SECTION",{});var ft=k(Ne);ve=_(ft,"LABEL",{for:!0,style:!0});var _t=k(ve);ue=_(_t,"ION-BUTTON",{fill:!0,class:!0,expand:!0});var ye=k(ue);Ee=_(ye,"ION-ICON",{icon:!0,slot:!0}),k(Ee).forEach(a),Be=D(ye),ge=_(ye,"LABEL",{for:!0,style:!0,"data-svelte-h":!0}),J(ge)!=="svelte-1as0od8"&&(ge.textContent=Ue),Me=D(ye),me=_(ye,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0}),ye.forEach(a),_t.forEach(a),ft.forEach(a),Re=D(le),Z&&Z.l(le),le.forEach(a),ct.forEach(a),this.h()},h(){E(n,"color","medium"),E(o,"slot","start"),E(h,"title",l[2].title),E(s,"strong",""),E(v,"slot","end"),E(e,"translucent",""),E(C,"icon",Ft),E(C,"slot","start"),E(ae,"icon",Vt),E(ae,"slot","start"),E(Ie,"label","Notas"),E(Ie,"placeholder","Escribe aquí..."),E(Ee,"icon",Kt),E(Ee,"slot","start"),V(ge,"for","eventEvidence"),F(ge,"padding","8px 10px"),F(me,"display","none"),V(me,"id","eventEvidence"),V(me,"name","fileToUpload"),V(me,"type","file"),V(me,"accept","image/*"),E(ue,"fill","outline"),E(ue,"class","loadEvidence"),E(ue,"expand","block"),V(ve,"for","eventEvidence"),F(ve,"display","block"),F(ve,"width","100%"),E(u,"fullscreen","")},m(j,W){U(j,e,W),i(e,t),i(t,o),i(o,n),i(t,d),i(t,h),i(h,O),i(t,I),i(t,v),i(v,s),U(j,g,W),U(j,u,W),i(u,c),i(c,N),i(N,C),i(N,S),i(N,A),i(A,P),i(A,M),i(A,H),i(H,R),i(c,T),te&&te.m(c,null),i(c,w),oe&&oe.m(c,null),i(c,z),X&&X.m(c,null),i(c,ee),x&&x.m(c,null),i(c,ie),ne&&ne.m(c,null),i(c,de),i(c,he),i(he,ae),i(he,ke),i(he,Ie),l[6](Ie),i(c,Se),i(c,Ne),i(Ne,ve),i(ve,ue),i(ue,Ee),i(ue,Be),i(ue,ge),i(ue,Me),i(ue,me),i(c,Re),Z&&Z.m(c,null),He||($e=[Y(n,"click",l[4]),Y(s,"click",l[5]),Y(me,"change",l[3])],He=!0)},p(j,[W]){te&&te.p(j,W),q&&oe.p(j,W),K&&X.p(j,W),j[2].driver_comments&&x.p(j,W),re&&ne.p(j,W),j[1]?Z?Z.p(j,W):(Z=mt(j),Z.c(),Z.m(c,null)):Z&&(Z.d(1),Z=null)},i:pe,o:pe,d(j){j&&(a(e),a(g),a(u)),te&&te.d(),oe&&oe.d(),X&&X.d(),x&&x.d(),ne&&ne.d(),l[6](null),Z&&Z.d(),He=!1,Ae($e)}}}function bn(l,e,t){let o=document.querySelector("ion-modal"),n=o.componentProps.delivery,r=o.componentProps.isLast,d=n.driver_comments?n.driver_comments:"",h=n.img?n.img:"",m="";const O=async u=>{const N=u.target.files[0],C=await I(N);if(C){const S=new FormData;S.append("fileToUpload",C);try{const A=await fetch("https://app.rutaflow.com/api/admin/manager/upload_img_driver.php",{method:"POST",body:S});if(A.ok){const P=await A.json();t(1,h=P.img),m=P.img_id}else console.error("File upload failed:",A.statusText)}catch(A){console.error("Error during file upload:",A)}}},I=async u=>new Promise(c=>{const N=new FileReader;N.onload=C=>{const S=new Image;S.src=C.target.result,S.onload=()=>{const A=document.createElement("canvas"),P=A.getContext("2d"),y=800,M=600;let H=S.width,b=S.height;H>y&&(b*=y/H,H=y),b>M&&(H*=M/b,b=M),A.width=H,A.height=b,P.drawImage(S,0,0,H,b),A.toBlob(R=>{c(R)},"image/jpeg",.7)}},N.readAsDataURL(u)}),v=()=>{o.dismiss({data:Date.now()})},s=()=>{var u=new Object;u.id_route=n.id_route,u.id_event=n.id_event,u.comments=d.value,u.img=h,u.img_id=m;const c=new FormData;for(const N in u)c.append(N,u[N]);fetch("https://app.rutaflow.com/api/admin/evidence/send_evidence.php",{method:"POST",body:c}).then(N=>N.json()).then(N=>{v();var C=u.id_route;r&&p("","",C,r)}).catch(N=>{console.error("Error fetching data:",N)})},p=(u,c,N,C)=>{o.componentProps.routeId=N,o.componentProps.driverId=n.id_driver,We("modal-km-gas",Dt,{checklist:u,driverId:c,routeId:N,isLast:C}).then(S=>{})};function g(u){be[u?"unshift":"push"](()=>{d=u,t(0,d)})}return[d,h,n,O,v,s,g]}class kn extends Je{constructor(e){super(),Ye(this,e,bn,gn,Xe,{})}}function vt(l,e,t){const o=l.slice();return o[26]=e[t],o}function gt(l,e,t){const o=l.slice();return o[26]=e[t],o[28]=t,o}function bt(l,e,t){const o=l.slice();return o[26]=e[t],o[28]=t,o}function kt(l){let e,t;return e=new Jt({props:{$$slots:{default:[Tn]},$$scope:{ctx:l}}}),{c(){Rt(e.$$.fragment)},l(o){Ht(e.$$.fragment,o)},m(o,n){qt(e,o,n),t=!0},p(o,n){const r={};n[0]&127|n[1]&2&&(r.$$scope={dirty:n,ctx:o}),e.$set(r)},i(o){t||(je(e.$$.fragment,o),t=!0)},o(o){et(e.$$.fragment,o),t=!1},d(o){Ut(e,o)}}}function In(l){let e=nt(l[0],"enroute")+"",t,o,n,r,d='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Jala para actualizar" refreshing-spinner="circles" refreshing-text="Actualizando..."></ion-refresher-content>',h,m,O=[],I=new Map,v,s,p=Oe(l[3]);const g=u=>u[26].id_event;for(let u=0;u<p.length;u+=1){let c=vt(l,p,u),N=g(c);I.set(N,O[u]=Et(N,c))}return{c(){t=Q(e),o=L(),n=f("ion-content"),r=f("ion-refresher"),r.innerHTML=d,h=L(),m=f("ion-list");for(let u=0;u<O.length;u+=1)O[u].c();this.h()},l(u){t=$(u,e),o=D(u),n=_(u,"ION-CONTENT",{});var c=k(n);r=_(c,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),J(r)!=="svelte-1jkndk3"&&(r.innerHTML=d),h=D(c),m=_(c,"ION-LIST",{});var N=k(m);for(let C=0;C<O.length;C+=1)O[C].l(N);N.forEach(a),c.forEach(a),this.h()},h(){E(r,"slot","fixed")},m(u,c){U(u,t,c),U(u,o,c),U(u,n,c),i(n,r),l[19](r),i(n,h),i(n,m);for(let N=0;N<O.length;N+=1)O[N]&&O[N].m(m,null);v||(s=Y(r,"ionRefresh",l[7]),v=!0)},p(u,c){c[0]&1&&e!==(e=nt(u[0],"enroute")+"")&&ce(t,e),c[0]&5384&&(p=Oe(u[3]),O=Ze(O,c,g,1,u,p,I,m,Qe,Et,null,vt))},d(u){u&&(a(t),a(o),a(n)),l[19](null);for(let c=0;c<O.length;c+=1)O[c].d();v=!1,s()}}}function En(l){let e,t;function o(d,h){return h[0]&32&&(e=null),e==null&&(e=!!d[5].every(yn)),e?Nn:On}let n=o(l,[-1,-1]),r=n(l);return{c(){r.c(),t=_e()},l(d){r.l(d),t=_e()},m(d,h){r.m(d,h),U(d,t,h)},p(d,h){n===(n=o(d,h))&&r?r.p(d,h):(r.d(1),r=n(d),r&&(r.c(),r.m(t.parentNode,t)))},d(d){d&&a(t),r.d(d)}}}function It(l){let e;return{c(){e=f("span"),this.h()},l(t){e=_(t,"SPAN",{class:!0}),k(e).forEach(a),this.h()},h(){V(e,"class","notes svelte-ziybgw")},m(t,o){U(t,e,o)},d(t){t&&a(e)}}}function Et(l,e){let t,o,n,r,d=parseInt(e[26].pos)+1+"",h,m,O,I,v,s,p=e[26].title+"",g,u,c=e[26].support_list&&e[26].support_list.length||e[10](e[26]),N,C,S,A,P,y=c&&It();function M(){return e[20](e[26])}return{key:l,first:null,c(){t=f("ion-item"),o=f("ion-avatar"),n=f("div"),r=f("div"),h=Q(d),O=L(),I=f("ion-label"),v=f("ion-text"),s=f("h3"),g=Q(p),u=L(),y&&y.c(),N=L(),C=f("ion-icon"),S=L(),this.h()},l(H){t=_(H,"ION-ITEM",{});var b=k(t);o=_(b,"ION-AVATAR",{slot:!0});var R=k(o);n=_(R,"DIV",{class:!0,title:!0,style:!0});var T=k(n);r=_(T,"DIV",{class:!0});var w=k(r);h=$(w,d),w.forEach(a),T.forEach(a),R.forEach(a),O=D(b),I=_(b,"ION-LABEL",{button:!0});var q=k(I);v=_(q,"ION-TEXT",{color:!0});var z=k(v);s=_(z,"H3",{});var K=k(s);g=$(K,p),u=D(K),y&&y.l(K),K.forEach(a),z.forEach(a),q.forEach(a),N=D(b),C=_(b,"ION-ICON",{icon:!0,slot:!0,style:!0}),k(C).forEach(a),S=D(b),b.forEach(a),this.h()},h(){V(r,"class","order svelte-ziybgw"),V(n,"class","order-wrapper svelte-ziybgw"),V(n,"title",m=Le(e[26].status)),F(n,"background-color",fe(e[26])),F(n,"color",De(fe(e[26]))),E(o,"slot","start"),E(v,"color","#2e2e2e"),E(I,"button",""),E(C,"icon",Pe),E(C,"slot","end"),F(C,"color",fe(e[26])),this.first=t},m(H,b){U(H,t,b),i(t,o),i(o,n),i(n,r),i(r,h),i(t,O),i(t,I),i(I,v),i(v,s),i(s,g),i(s,u),y&&y.m(s,null),i(t,N),i(t,C),i(t,S),A||(P=Y(I,"click",M),A=!0)},p(H,b){e=H,b[0]&8&&d!==(d=parseInt(e[26].pos)+1+"")&&ce(h,d),b[0]&8&&m!==(m=Le(e[26].status))&&V(n,"title",m),b[0]&8&&F(n,"background-color",fe(e[26])),b[0]&8&&F(n,"color",De(fe(e[26]))),b[0]&8&&p!==(p=e[26].title+"")&&ce(g,p),b[0]&8&&(c=e[26].support_list&&e[26].support_list.length||e[10](e[26])),c?y||(y=It(),y.c(),y.m(s,null)):y&&(y.d(1),y=null),b[0]&8&&F(C,"color",fe(e[26]))},d(H){H&&a(t),y&&y.d(),A=!1,P()}}}function On(l){let e=l[9](l[5],l[1],l[0])+"",t,o,n,r,d='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Pull to refresh" refreshing-spinner="circles" refreshing-text="Refreshing..."></ion-refresher-content>',h,m,O=[],I=new Map,v,s,p=Oe(l[3]);const g=u=>u[26].id_event;for(let u=0;u<p.length;u+=1){let c=gt(l,p,u),N=g(c);I.set(N,O[u]=Nt(N,c))}return{c(){t=Q(e),o=L(),n=f("ion-content"),r=f("ion-refresher"),r.innerHTML=d,h=L(),m=f("ion-list");for(let u=0;u<O.length;u+=1)O[u].c();this.h()},l(u){t=$(u,e),o=D(u),n=_(u,"ION-CONTENT",{});var c=k(n);r=_(c,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),J(r)!=="svelte-1poui8g"&&(r.innerHTML=d),h=D(c),m=_(c,"ION-LIST",{});var N=k(m);for(let C=0;C<O.length;C+=1)O[C].l(N);N.forEach(a),c.forEach(a),this.h()},h(){E(r,"slot","fixed")},m(u,c){U(u,t,c),U(u,o,c),U(u,n,c),i(n,r),l[17](r),i(n,h),i(n,m);for(let N=0;N<O.length;N+=1)O[N]&&O[N].m(m,null);v||(s=Y(r,"ionRefresh",l[7]),v=!0)},p(u,c){c[0]&35&&e!==(e=u[9](u[5],u[1],u[0])+"")&&ce(t,e),c[0]&9480&&(p=Oe(u[3]),O=Ze(O,c,g,1,u,p,I,m,Qe,Nt,null,gt))},d(u){u&&(a(t),a(o),a(n)),l[17](null);for(let c=0;c<O.length;c+=1)O[c].d();v=!1,s()}}}function Nn(l){let e,t,o='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Pull to refresh" refreshing-spinner="circles" refreshing-text="Refreshing..."></ion-refresher-content>',n,r,d=[],h=new Map,m,O,I=Oe(l[3]);const v=s=>s[26].id_event;for(let s=0;s<I.length;s+=1){let p=bt(l,I,s),g=v(p);h.set(g,d[s]=Ct(g,p))}return{c(){e=f("ion-content"),t=f("ion-refresher"),t.innerHTML=o,n=L(),r=f("ion-list");for(let s=0;s<d.length;s+=1)d[s].c();this.h()},l(s){e=_(s,"ION-CONTENT",{});var p=k(e);t=_(p,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),J(t)!=="svelte-1poui8g"&&(t.innerHTML=o),n=D(p),r=_(p,"ION-LIST",{});var g=k(r);for(let u=0;u<d.length;u+=1)d[u].l(g);g.forEach(a),p.forEach(a),this.h()},h(){E(t,"slot","fixed")},m(s,p){U(s,e,p),i(e,t),l[15](t),i(e,n),i(e,r);for(let g=0;g<d.length;g+=1)d[g]&&d[g].m(r,null);m||(O=Y(t,"ionRefresh",l[7]),m=!0)},p(s,p){p[0]&9480&&(I=Oe(s[3]),d=Ze(d,p,v,1,s,I,h,r,Qe,Ct,null,bt))},d(s){s&&a(e),l[15](null);for(let p=0;p<d.length;p+=1)d[p].d();m=!1,O()}}}function Ot(l){let e;return{c(){e=f("span"),this.h()},l(t){e=_(t,"SPAN",{class:!0}),k(e).forEach(a),this.h()},h(){V(e,"class","notes svelte-ziybgw")},m(t,o){U(t,e,o)},d(t){t&&a(e)}}}function Nt(l,e){let t,o,n,r,d=parseInt(e[26].pos)+1+"",h,m,O,I,v,s,p=e[26].title+"",g,u,c=e[26].support_list&&e[26].support_list.length||e[10](e[26]),N,C,S="",A,P,y,M,H,b=c&&Ot();function R(){return e[18](e[26],e[28])}return{key:l,first:null,c(){t=f("ion-item"),o=f("ion-avatar"),n=f("div"),r=f("div"),h=Q(d),O=L(),I=f("ion-label"),v=f("ion-text"),s=f("h3"),g=Q(p),u=L(),b&&b.c(),N=L(),C=f("div"),C.innerHTML=S,A=L(),P=f("ion-icon"),y=L(),this.h()},l(T){t=_(T,"ION-ITEM",{});var w=k(t);o=_(w,"ION-AVATAR",{slot:!0});var q=k(o);n=_(q,"DIV",{class:!0,title:!0,style:!0});var z=k(n);r=_(z,"DIV",{class:!0});var K=k(r);h=$(K,d),K.forEach(a),z.forEach(a),q.forEach(a),O=D(w),I=_(w,"ION-LABEL",{button:!0});var ee=k(I);v=_(ee,"ION-TEXT",{color:!0});var ie=k(v);s=_(ie,"H3",{});var re=k(s);g=$(re,p),u=D(re),b&&b.l(re),re.forEach(a),ie.forEach(a),N=D(ee),C=_(ee,"DIV",{class:!0,"data-svelte-h":!0}),J(C)!=="svelte-130ohbs"&&(C.innerHTML=S),ee.forEach(a),A=D(w),P=_(w,"ION-ICON",{icon:!0,slot:!0}),k(P).forEach(a),y=D(w),w.forEach(a),this.h()},h(){V(r,"class","order svelte-ziybgw"),V(n,"class","order-wrapper svelte-ziybgw"),V(n,"title",m=Le(e[26].status)),F(n,"background-color",fe(e[26])),F(n,"color",De(fe(e[26]))),E(o,"slot","start"),E(v,"color","#2e2e2e"),V(C,"class","sub svelte-ziybgw"),E(I,"button",""),E(P,"icon",Pe),E(P,"slot","end"),this.first=t},m(T,w){U(T,t,w),i(t,o),i(o,n),i(n,r),i(r,h),i(t,O),i(t,I),i(I,v),i(v,s),i(s,g),i(s,u),b&&b.m(s,null),i(I,N),i(I,C),i(t,A),i(t,P),i(t,y),M||(H=Y(I,"click",R),M=!0)},p(T,w){e=T,w[0]&8&&d!==(d=parseInt(e[26].pos)+1+"")&&ce(h,d),w[0]&8&&m!==(m=Le(e[26].status))&&V(n,"title",m),w[0]&8&&F(n,"background-color",fe(e[26])),w[0]&8&&F(n,"color",De(fe(e[26]))),w[0]&8&&p!==(p=e[26].title+"")&&ce(g,p),w[0]&8&&(c=e[26].support_list&&e[26].support_list.length||e[10](e[26])),c?b||(b=Ot(),b.c(),b.m(s,null)):b&&(b.d(1),b=null)},d(T){T&&a(t),b&&b.d(),M=!1,H()}}}function Tt(l){let e;return{c(){e=f("span"),this.h()},l(t){e=_(t,"SPAN",{class:!0}),k(e).forEach(a),this.h()},h(){V(e,"class","notes svelte-ziybgw")},m(t,o){U(t,e,o)},d(t){t&&a(e)}}}function Ct(l,e){let t,o,n,r,d=parseInt(e[26].pos)+1+"",h,m,O,I,v,s,p=e[26].title+"",g,u,c=e[26].support_list&&e[26].support_list.length||e[10](e[26]),N,C,S="",A,P,y,M,H,b=c&&Tt();function R(){return e[16](e[26],e[28])}return{key:l,first:null,c(){t=f("ion-item"),o=f("ion-avatar"),n=f("div"),r=f("div"),h=Q(d),O=L(),I=f("ion-label"),v=f("ion-text"),s=f("h3"),g=Q(p),u=L(),b&&b.c(),N=L(),C=f("div"),C.innerHTML=S,A=L(),P=f("ion-icon"),y=L(),this.h()},l(T){t=_(T,"ION-ITEM",{});var w=k(t);o=_(w,"ION-AVATAR",{slot:!0});var q=k(o);n=_(q,"DIV",{class:!0,title:!0,style:!0});var z=k(n);r=_(z,"DIV",{class:!0});var K=k(r);h=$(K,d),K.forEach(a),z.forEach(a),q.forEach(a),O=D(w),I=_(w,"ION-LABEL",{button:!0});var ee=k(I);v=_(ee,"ION-TEXT",{color:!0});var ie=k(v);s=_(ie,"H3",{});var re=k(s);g=$(re,p),u=D(re),b&&b.l(re),re.forEach(a),ie.forEach(a),N=D(ee),C=_(ee,"DIV",{class:!0,"data-svelte-h":!0}),J(C)!=="svelte-130ohbs"&&(C.innerHTML=S),ee.forEach(a),A=D(w),P=_(w,"ION-ICON",{icon:!0,slot:!0}),k(P).forEach(a),y=D(w),w.forEach(a),this.h()},h(){V(r,"class","order svelte-ziybgw"),V(n,"class","order-wrapper svelte-ziybgw"),V(n,"title",m=Le(e[26].status)),F(n,"background-color",fe(e[26])),F(n,"color",De(fe(e[26]))),E(o,"slot","start"),E(v,"color","#2e2e2e"),V(C,"class","sub svelte-ziybgw"),E(I,"button",""),E(P,"icon",Pe),E(P,"slot","end"),this.first=t},m(T,w){U(T,t,w),i(t,o),i(o,n),i(n,r),i(r,h),i(t,O),i(t,I),i(I,v),i(v,s),i(s,g),i(s,u),b&&b.m(s,null),i(I,N),i(I,C),i(t,A),i(t,P),i(t,y),M||(H=Y(I,"click",R),M=!0)},p(T,w){e=T,w[0]&8&&d!==(d=parseInt(e[26].pos)+1+"")&&ce(h,d),w[0]&8&&m!==(m=Le(e[26].status))&&V(n,"title",m),w[0]&8&&F(n,"background-color",fe(e[26])),w[0]&8&&F(n,"color",De(fe(e[26]))),w[0]&8&&p!==(p=e[26].title+"")&&ce(g,p),w[0]&8&&(c=e[26].support_list&&e[26].support_list.length||e[10](e[26])),c?b||(b=Tt(),b.c(),b.m(s,null)):b&&(b.d(1),b=null)},d(T){T&&a(t),b&&b.d(),M=!1,H()}}}function Tn(l){let e,t,o,n,r=`<ion-icon icon="${Wt}"></ion-icon>`,d,h,m,O=l[2].name+"",I,v,s,p=l[4].name+"",g,u,c,N,C;function S(y,M){return y[5].length>0?En:In}let A=S(l),P=A(l);return{c(){e=f("ion-header"),t=f("ion-toolbar"),o=f("ion-buttons"),n=f("ion-button"),n.innerHTML=r,d=L(),h=f("ion-buttons"),m=f("ion-button"),I=Q(O),v=L(),s=f("ion-title"),g=Q(p),u=L(),P.c(),c=_e(),this.h()},l(y){e=_(y,"ION-HEADER",{translucent:!0});var M=k(e);t=_(M,"ION-TOOLBAR",{});var H=k(t);o=_(H,"ION-BUTTONS",{slot:!0});var b=k(o);n=_(b,"ION-BUTTON",{title:!0,alt:!0,"data-svelte-h":!0}),J(n)!=="svelte-7ppz3r"&&(n.innerHTML=r),b.forEach(a),d=D(H),h=_(H,"ION-BUTTONS",{slot:!0});var R=k(h);m=_(R,"ION-BUTTON",{});var T=k(m);I=$(T,O),T.forEach(a),R.forEach(a),v=D(H),s=_(H,"ION-TITLE",{});var w=k(s);g=$(w,p),w.forEach(a),H.forEach(a),M.forEach(a),u=D(y),P.l(y),c=_e(),this.h()},h(){E(n,"title","Atrás"),E(n,"alt","Atrás"),E(o,"slot","start"),E(h,"slot","secondary"),E(e,"translucent","")},m(y,M){U(y,e,M),i(e,t),i(t,o),i(o,n),i(t,d),i(t,h),i(h,m),i(m,I),i(t,v),i(t,s),i(s,g),U(y,u,M),P.m(y,M),U(y,c,M),N||(C=Y(n,"click",l[11]),N=!0)},p(y,M){M[0]&4&&O!==(O=y[2].name+"")&&ce(I,O),M[0]&16&&p!==(p=y[4].name+"")&&ce(g,p),A===(A=S(y))&&P?P.p(y,M):(P.d(1),P=A(y),P&&(P.c(),P.m(c.parentNode,c)))},d(y){y&&(a(e),a(u),a(c)),P.d(y),N=!1,C()}}}function Cn(l){let e,t,o,n=l[2]&&kt(l);return{c(){e=L(),n&&n.c(),t=_e(),this.h()},l(r){Bt("svelte-kn0kph",document.head).forEach(a),e=D(r),n&&n.l(r),t=_e(),this.h()},h(){document.title="Rutaflow - Detalles de ruta"},m(r,d){U(r,e,d),n&&n.m(r,d),U(r,t,d),o=!0},p(r,d){r[2]?n?(n.p(r,d),d[0]&4&&je(n,1)):(n=kt(r),n.c(),je(n,1),n.m(t.parentNode,t)):n&&(zt(),et(n,1,1,()=>{n=null}),Mt())},i(r){o||(je(n),o=!0)},o(r){et(n),o=!1},d(r){r&&(a(e),a(t)),n&&n.d(r)}}}function fe(l){let e="#ffffff";return l.status==="pending"?e="#f2e300":l.status==="completed"&&(e="#44d900"),e}function Le(l){let e="";return l=="pending"?e="Pendiente":l=="completed"&&(e="Completado"),e}function De(l){l.slice(0,1)==="#"&&(l=l.slice(1)),l.length===3&&(l=l.split("").map(function(r){return r+r}).join(""));const e=parseInt(l.substr(0,2),16),t=parseInt(l.substr(2,2),16),o=parseInt(l.substr(4,2),16);return(e*299+t*587+o*114)/1e3>=128?"#414040":"#fff"}function nt(l,e){let t=new FormData;return t.append("id_route",l),t.append("status",e),fetch("https://app.rutaflow.com/api/admin/route/change_status.php",{method:"POST",body:t}).then(o=>o.json()).then(o=>{}).catch(o=>{console.error("Error fetching data:",o)}),""}const yn=l=>l.img;function wn(l,e,t){let o;yt(l,Xt,T=>t(14,o=T));var n=this&&this.__awaiter||function(T,w,q,z){function K(ee){return ee instanceof q?ee:new q(function(ie){ie(ee)})}return new(q||(q=Promise))(function(ee,ie){function re(ae){try{he(z.next(ae))}catch(ke){ie(ke)}}function de(ae){try{he(z.throw(ae))}catch(ke){ie(ke)}}function he(ae){ae.done?ee(ae.value):K(ae.value).then(re,de)}he((z=z.apply(T,w||[])).next())})};let{routeId:r}=e,{driverId:d}=e,h=new Object,m=[],O={},I={},v;const s=()=>n(void 0,void 0,void 0,function*(){yield p(r),v.complete()});function p(T){const w=new FormData;w.append("id_route",T),fetch("https://app.rutaflow.com/api/admin/report/seguimiento_list.php",{method:"POST",body:w}).then(q=>q.json()).then(q=>{t(4,O=q.data.seguimiento_list[0]),t(3,m=q.data.event_list),t(5,I=q.data.checklist)}).catch(q=>{console.error("Error fetching data:",q)})}const g=T=>new Promise((w,q)=>{const z=new FormData;z.append("id_route",T.id_route),z.append("id_event",T.id_event),fetch("https://app.rutaflow.com/api/admin/evidence/evidence_by_event.php",{method:"POST",body:z}).then(K=>K.json()).then(K=>{w(K.data.event_evidence[0])}).catch(K=>{console.error("Error fetching data:",K),q(K)})}),u=(T,w)=>{g(T).then(q=>{T.client_name=O.client_name,q&&(T.img=q.img,T.driver_comments=q.driver_comments,T.comments=q.comments),We("modal-delivery-info",kn,{delivery:T,isLast:w}).then(z=>{})})},c=(T,w,q)=>{var z=!1;return We("modal-checklist",Dt,{checklist:T,driverId:w,routeId:q,isLast:z}).then(K=>{}),nt(q,"checklist"),""},N=T=>{if(T.tracking_type=="subscription"){if(T.subscriber_info&&T.payment_type==="cash"&&new Date(T.subscriber_info.payment_next)<new Date)return!0}else if(T.tracking_type=="ecommerce"&&Number(T.payment_pending)>0)return!0;return!1},C=()=>{h.id_driver?Te(`/drivers/${h.id_driver}`):Te("/drivers/me")},S=(T,w)=>n(void 0,void 0,void 0,function*(){yield(yield Ge.create({header:T||"Error",message:w||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()});function A(T){return T===m.length-1}function P(T){be[T?"unshift":"push"](()=>{v=T,t(6,v)})}const y=(T,w)=>u(T,A(w));function M(T){be[T?"unshift":"push"](()=>{v=T,t(6,v)})}const H=(T,w)=>u(T,A(w));function b(T){be[T?"unshift":"push"](()=>{v=T,t(6,v)})}const R=T=>{const w=m.findIndex(ie=>ie.id_event===T.id_event),q=w===0,z=w>0?m[w-1]:null,K=q||z&&z.img!==null,ee=T.img!==null&&T.img!=="";K||q&&!ee?u(T):S("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")};return l.$$set=T=>{"routeId"in T&&t(0,r=T.routeId),"driverId"in T&&t(1,d=T.driverId)},l.$$.update=()=>{l.$$.dirty[0]&16389&&(t(0,{routeId:r,driverId:d}=o.params,r,(t(1,d),t(14,o),t(2,h),t(0,r))),t(2,h=JSON.parse(localStorage.getItem("userSession"))),h?h.id_user&&(h.type=="admin"||h.type=="super")?(Te(`/drivers/me/routes/${r}`),p(r)):h.id_user&&h.id_driver&&(p(r),Te(`/drivers/${h.id_driver}/routes/${r}`)):Te("/"))},[r,d,h,m,O,I,v,s,u,c,N,C,S,A,o,P,y,M,H,b,R]}class Rn extends Je{constructor(e){super(),Ye(this,e,wn,Cn,Xe,{routeId:0,driverId:1},null,[-1,-1])}}export{Rn as component};

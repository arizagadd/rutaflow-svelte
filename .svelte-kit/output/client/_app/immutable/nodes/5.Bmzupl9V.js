import{Z as ft,s as We,e as s,j as N,b as c,q as m,d as oe,h as a,m as T,v,i as x,w as o,x as ce,n as ze,z as Be,_ as tn,B as L,o as Ze,k as De,$ as dt,t as Ee,r as Ie,f as $,a0 as nn,a1 as Qe,A as Se,y as Le,a2 as on,a3 as Ke,a4 as ln,a5 as rn,l as an,p as sn,F as cn}from"../chunks/index.CdEBkEwf.js";import{S as Je,i as Ye,t as lt,a as at,c as un,b as fn,d as dn,m as _n,e as hn,g as pn}from"../chunks/index.c2pjNB5R.js";import{e as He,u as xe,d as $e,a as mn,b as vn,c as gn,i as Qt,f as bn,g as Zt,h as En,j as st,k as In,m as kn,n as xt,s as _t,o as Re,q as On,r as Nn,t as Tn,v as Cn,w as yn,x as wn,y as Ln,z as zn,p as An}from"../chunks/index.BSS51izx.js";import"../chunks/index-48209844.IIRtDZyg.js";import{m as et,D as it,a as je,I as Mn}from"../chunks/IonPage.CBN9dEnc.js";import{q as Sn,t as Dn}from"../chunks/ion-modal.CsJaVgKZ.js";import{g as qe}from"../chunks/entry.DlmTrdCe.js";const Pn=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global,Bn=(l,e)=>{if(!customElements.get(l)){class t extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const n={};for(const r of this.attributes)n[r.name]=r.value;new e({target:this.shadowRoot,props:n})}}customElements.define(l,t)}},Hn=function(l){return document.createElement(l).constructor!==HTMLElement},Rn=(l,e)=>{Hn(l)||Bn(l,e)},Ue=async(l,e,t)=>{Sn(),Dn(),Rn(l,e);const i=await et.create({component:l,componentProps:t});return i.present(),await i.onWillDismiss()};let Ge=ft({km_inicial:[],gas_inicial:[],km_final:[],gas_final:[]}),$t=ft({flag:[]});function Un(l){let e,t,i,n,r="Cancelar",f,d,h="Captura de Km/Gas",I,g,_,u="Confirmar",p,b,O,C,U,M,F;return{c(){e=s("ion-header"),t=s("ion-toolbar"),i=s("ion-buttons"),n=s("ion-button"),n.textContent=r,f=N(),d=s("ion-title"),d.textContent=h,I=N(),g=s("ion-buttons"),_=s("ion-button"),_.textContent=u,p=N(),b=s("ion-content"),O=s("ion-item"),C=s("ion-input"),this.h()},l(q){e=c(q,"ION-HEADER",{translucent:!0});var V=m(e);t=c(V,"ION-TOOLBAR",{});var z=m(t);i=c(z,"ION-BUTTONS",{slot:!0});var S=m(i);n=c(S,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),oe(n)!=="svelte-17pq4f4"&&(n.textContent=r),S.forEach(a),f=T(z),d=c(z,"ION-TITLE",{"data-svelte-h":!0}),oe(d)!=="svelte-1yhkaq7"&&(d.textContent=h),I=T(z),g=c(z,"ION-BUTTONS",{slot:!0});var E=m(g);_=c(E,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),oe(_)!=="svelte-cm6j4s"&&(_.textContent=u),E.forEach(a),z.forEach(a),V.forEach(a),p=T(q),b=c(q,"ION-CONTENT",{fullscreen:!0});var y=m(b);O=c(y,"ION-ITEM",{});var D=m(O);C=c(D,"ION-INPUT",{class:!0,inputmode:!0,pattern:!0,type:!0,placeholder:!0,value:!0,required:!0});var B=m(C);B.forEach(a),D.forEach(a),y.forEach(a),this.h()},h(){v(n,"color","medium"),v(i,"slot","start"),v(_,"strong",""),v(g,"slot","end"),v(e,"translucent",""),v(C,"class","fin-km"),v(C,"inputmode","numeric"),v(C,"pattern","[0-9]*"),v(C,"type","number"),v(C,"placeholder",U="Ingresa "+l[0]+" actual"),v(C,"value",l[1]),v(C,"required",""),v(b,"fullscreen","")},m(q,V){x(q,e,V),o(e,t),o(t,i),o(i,n),o(t,f),o(t,d),o(t,I),o(t,g),o(g,_),x(q,p,V),x(q,b,V),o(b,O),o(O,C),M||(F=[ce(n,"click",l[2]),ce(_,"click",l[3]),ce(C,"input",l[4])],M=!0)},p(q,[V]){V&1&&U!==(U="Ingresa "+q[0]+" actual")&&v(C,"placeholder",U),V&2&&v(C,"value",q[1])},i:ze,o:ze,d(q){q&&(a(e),a(p),a(b)),M=!1,Be(F)}}}function Vn(l,e,t){const i=tn();let n=document.querySelector("ion-modal"),r=n.componentProps.data_type;n.componentProps.isLast;let f;$t.subscribe(_=>{r=_.flag[0],r=="km_final"||r=="km_inicial"?t(0,f="kilometraje"):t(0,f="litros de gasolina")});let d=0;function h(){et.dismiss()}function I(){i("modalResult",{data:"Your data",role:"confirm"}),r=="km_inicial"?Ge.update(u=>({...u,km_inicial:[d]})):r=="gas_inicial"?Ge.update(u=>({...u,gas_inicial:[d]})):r=="km_final"?Ge.update(u=>({...u,km_final:[d]})):r=="gas_final"&&Ge.update(u=>({...u,gas_final:[d]})),h()}return[f,d,h,I,_=>t(1,d=_.target.value)]}class Fn extends Je{constructor(e){super(),Ye(this,e,Vn,Un,We,{})}}const rt=ft({items:[],checkedIndices:[],mandatory:[]});function gt(l,e,t){const i=l.slice();return i[55]=e[t],i[56]=e,i[57]=t,i}function qn(l){let e,t,i,n,r,f="Kilometraje inicial",d,h,I=l[0]?l[0]+" km.":"Cargar km",g,_,u,p,b,O,C,U="Gasolina inicial (litros)",M,F,q=l[1]?l[1]+" litros":"Cargar gas",V,z,S,E;return z=dt(l[21][0]),{c(){e=s("ion-item"),t=s("ion-label"),i=s("input"),n=N(),r=s("p"),r.textContent=f,d=N(),h=s("ion-button"),g=Ee(I),_=N(),u=s("ion-item"),p=s("ion-label"),b=s("input"),O=N(),C=s("p"),C.textContent=U,M=N(),F=s("ion-button"),V=Ee(q),this.h()},l(y){e=c(y,"ION-ITEM",{});var D=m(e);t=c(D,"ION-LABEL",{style:!0});var B=m(t);i=c(B,"INPUT",{id:!0,style:!0,type:!0}),n=T(B),r=c(B,"P",{style:!0,"data-svelte-h":!0}),oe(r)!=="svelte-88twxi"&&(r.textContent=f),B.forEach(a),d=T(D),h=c(D,"ION-BUTTON",{fill:!0,size:!0,class:!0,"aria-selected":!0});var H=m(h);g=Ie(H,I),H.forEach(a),D.forEach(a),_=T(y),u=c(y,"ION-ITEM",{});var X=m(u);p=c(X,"ION-LABEL",{style:!0});var W=m(p);b=c(W,"INPUT",{id:!0,style:!0,type:!0}),O=T(W),C=c(W,"P",{style:!0,"data-svelte-h":!0}),oe(C)!=="svelte-1ux30eb"&&(C.textContent=U),W.forEach(a),M=T(X),F=c(X,"ION-BUTTON",{fill:!0,class:!0,size:!0,style:!0});var ee=m(F);V=Ie(ee,q),ee.forEach(a),X.forEach(a),this.h()},h(){$(i,"id","chkbox-km-ini"),L(i,"pointer-events","auto"),$(i,"type","checkbox"),i.required=!0,L(r,"margin-left","10px"),L(t,"display","flex"),v(h,"fill","outline"),v(h,"size","small"),v(h,"class","loadKmInicial"),v(h,"aria-selected",""),$(b,"id","chkbox-gas-ini"),L(b,"pointer-events","auto"),$(b,"type","checkbox"),b.required=!0,L(C,"margin-left","10px"),L(p,"display","flex"),v(F,"fill","outline"),v(F,"class","loadGasInicial"),v(F,"size","small"),L(F,"height","16px "),z.p(i,b)},m(y,D){x(y,e,D),o(e,t),o(t,i),i.checked=~(l[4]||[]).indexOf(i.__value),l[28](i),o(t,n),o(t,r),o(e,d),o(e,h),o(h,g),x(y,_,D),x(y,u,D),o(u,p),o(p,b),l[30](b),b.checked=~(l[4]||[]).indexOf(b.__value),o(p,O),o(p,C),o(u,M),o(u,F),o(F,V),S||(E=[ce(i,"change",l[27]),ce(h,"click",l[29]),ce(b,"change",l[31]),ce(F,"click",l[32])],S=!0)},p(y,D){D[0]&16&&(i.checked=~(y[4]||[]).indexOf(i.__value)),D[0]&1&&I!==(I=y[0]?y[0]+" km.":"Cargar km")&&Le(g,I),D[0]&16&&(b.checked=~(y[4]||[]).indexOf(b.__value)),D[0]&2&&q!==(q=y[1]?y[1]+" litros":"Cargar gas")&&Le(V,q)},d(y){y&&(a(e),a(_),a(u)),l[28](null),l[30](null),z.r(),S=!1,Be(E)}}}function jn(l){let e,t,i,n,r,f="Kilometraje final",d,h,I=l[2]?l[2]+" km.":"Cargar km",g,_,u,p,b,O,C,U="Gasolina final (litros)",M,F,q=l[3]?l[3]+" litros":"Cargar gas",V,z,S,E;return z=dt(l[21][0]),{c(){e=s("ion-item"),t=s("ion-label"),i=s("input"),n=N(),r=s("p"),r.textContent=f,d=N(),h=s("ion-button"),g=Ee(I),_=N(),u=s("ion-item"),p=s("ion-label"),b=s("input"),O=N(),C=s("p"),C.textContent=U,M=N(),F=s("ion-button"),V=Ee(q),this.h()},l(y){e=c(y,"ION-ITEM",{});var D=m(e);t=c(D,"ION-LABEL",{style:!0});var B=m(t);i=c(B,"INPUT",{id:!0,style:!0,type:!0}),n=T(B),r=c(B,"P",{style:!0,"data-svelte-h":!0}),oe(r)!=="svelte-ccmu71"&&(r.textContent=f),B.forEach(a),d=T(D),h=c(D,"ION-BUTTON",{fill:!0,size:!0,class:!0,"aria-selected":!0});var H=m(h);g=Ie(H,I),H.forEach(a),D.forEach(a),_=T(y),u=c(y,"ION-ITEM",{});var X=m(u);p=c(X,"ION-LABEL",{style:!0});var W=m(p);b=c(W,"INPUT",{id:!0,style:!0,type:!0}),O=T(W),C=c(W,"P",{style:!0,"data-svelte-h":!0}),oe(C)!=="svelte-wsoyd2"&&(C.textContent=U),W.forEach(a),M=T(X),F=c(X,"ION-BUTTON",{fill:!0,size:!0,class:!0});var ee=m(F);V=Ie(ee,q),ee.forEach(a),X.forEach(a),this.h()},h(){$(i,"id","chkbox-km-fin"),L(i,"pointer-events","auto"),$(i,"type","checkbox"),i.required=!0,L(r,"margin-left","10px"),L(t,"display","flex"),v(h,"fill","outline"),v(h,"size","small"),v(h,"class","loadKmInicial"),v(h,"aria-selected",""),$(b,"id","chkbox-gas-fin"),L(b,"pointer-events","auto"),$(b,"type","checkbox"),b.required=!0,L(C,"margin-left","10px"),L(p,"display","flex"),v(F,"fill","outline"),v(F,"size","small"),v(F,"class","loadGasInicial"),z.p(i,b)},m(y,D){x(y,e,D),o(e,t),o(t,i),i.checked=~(l[4]||[]).indexOf(i.__value),l[22](i),o(t,n),o(t,r),o(e,d),o(e,h),o(h,g),x(y,_,D),x(y,u,D),o(u,p),o(p,b),b.checked=~(l[4]||[]).indexOf(b.__value),l[25](b),o(p,O),o(p,C),o(u,M),o(u,F),o(F,V),S||(E=[ce(i,"change",l[20]),ce(h,"click",l[23]),ce(b,"change",l[24]),ce(F,"click",l[26])],S=!0)},p(y,D){D[0]&16&&(i.checked=~(y[4]||[]).indexOf(i.__value)),D[0]&4&&I!==(I=y[2]?y[2]+" km.":"Cargar km")&&Le(g,I),D[0]&16&&(b.checked=~(y[4]||[]).indexOf(b.__value)),D[0]&8&&q!==(q=y[3]?y[3]+" litros":"Cargar gas")&&Le(V,q)},d(y){y&&(a(e),a(_),a(u)),l[22](null),l[25](null),z.r(),S=!1,Be(E)}}}function Gn(l){let e=[],t=new Map,i,n=He(l[13]);const r=f=>f[55].id_checklist_event;for(let f=0;f<n.length;f+=1){let d=gt(l,n,f),h=r(d);t.set(h,e[f]=bt(h,d))}return{c(){for(let f=0;f<e.length;f+=1)e[f].c();i=De()},l(f){for(let d=0;d<e.length;d+=1)e[d].l(f);i=De()},m(f,d){for(let h=0;h<e.length;h+=1)e[h]&&e[h].m(f,d);x(f,i,d)},p(f,d){d[0]&407664&&(n=He(f[13]),e=xe(e,d,r,1,f,n,t,i.parentNode,$e,bt,i,gt))},d(f){f&&a(i);for(let d=0;d<e.length;d+=1)e[d].d(f)}}}function Kn(l){let e,t=(l[12][l[55].id_checklist_event]?l[12][l[55].id_checklist_event]:"Cargar evidencia")+"",i;return{c(){e=s("label"),i=Ee(t),this.h()},l(n){e=c(n,"LABEL",{for:!0,class:!0});var r=m(e);i=Ie(r,t),r.forEach(a),this.h()},h(){$(e,"for","chklist-"+l[55].id_checklist_event),$(e,"class","button-label svelte-1ruehls")},m(n,r){x(n,e,r),o(e,i)},p(n,r){r[0]&4096&&t!==(t=(n[12][n[55].id_checklist_event]?n[12][n[55].id_checklist_event]:"Cargar evidencia")+"")&&Le(i,t)},d(n){n&&a(e)}}}function Xn(l){let e;return{c(){e=s("ion-spinner"),this.h()},l(t){e=c(t,"ION-SPINNER",{name:!0,class:!0}),m(e).forEach(a),this.h()},h(){v(e,"name","dots"),v(e,"class","button-spinner svelte-1ruehls")},m(t,i){x(t,e,i)},p:ze,d(t){t&&a(e)}}}function bt(l,e){let t,i,n,r=e[55],f,d,h=e[55].item+"",I,g,_,u=e[55].mandatory=="1"?" * ":"",p,b,O,C,U,M,F,q,V,z;const S=()=>e[34](n,r),E=()=>e[34](null,r);function y(){return e[35](e[55])}function D(W,ee){return W[11][W[55].id_checklist_event]?Xn:Kn}let B=D(e),H=B(e);function X(...W){return e[37](e[55],...W)}return q=dt(e[21][0]),{key:l,first:null,c(){t=s("ion-item"),i=s("ion-label"),n=s("input"),f=N(),d=s("p"),I=Ee(h),g=N(),_=s("b"),p=Ee(u),b=N(),O=s("ion-button"),C=s("div"),H.c(),U=N(),M=s("input"),F=N(),this.h()},l(W){t=c(W,"ION-ITEM",{});var ee=m(t);i=c(ee,"ION-LABEL",{style:!0});var ne=m(i);n=c(ne,"INPUT",{id:!0,style:!0,type:!0}),f=T(ne),d=c(ne,"P",{style:!0});var ie=m(d);I=Ie(ie,h),g=T(ie),ie.forEach(a),_=c(ne,"B",{style:!0});var ve=m(_);p=Ie(ve,u),ve.forEach(a),ne.forEach(a),b=T(ee),O=c(ee,"ION-BUTTON",{fill:!0,class:!0,size:!0});var ue=m(O);C=c(ue,"DIV",{class:!0});var _e=m(C);H.l(_e),U=T(_e),M=c(_e,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0}),_e.forEach(a),ue.forEach(a),F=T(ee),ee.forEach(a),this.h()},h(){$(n,"id",`chkbox-${e[55].id_checklist_event}`),L(n,"pointer-events","auto"),$(n,"type","checkbox"),n.__value=e[55].id_checklist_event,nn(n,n.__value),n.required=!0,L(d,"margin-left","10px"),L(_,"margin-left","5px"),L(i,"display","flex"),L(M,"display","none"),$(M,"id","chklist-"+e[55].id_checklist_event),$(M,"name","fileToUpload"),$(M,"type","file"),$(M,"accept","image/*"),$(C,"class","button-content svelte-1ruehls"),v(O,"fill","outline"),v(O,"class","loadEvidence svelte-1ruehls"),v(O,"size","small"),q.p(n),this.first=t},m(W,ee){x(W,t,ee),o(t,i),o(i,n),n.checked=~(e[4]||[]).indexOf(n.__value),S(),o(i,f),o(i,d),o(d,I),o(d,g),o(i,_),o(_,p),o(t,b),o(t,O),o(O,C),H.m(C,null),o(C,U),o(C,M),e[36](M),o(t,F),V||(z=[ce(n,"change",e[33]),ce(n,"change",y),ce(M,"change",X)],V=!0)},p(W,ee){e=W,ee[0]&16&&(n.checked=~(e[4]||[]).indexOf(n.__value)),r!==e[55]&&(E(),r=e[55],S()),B===(B=D(e))&&H?H.p(e,ee):(H.d(1),H=B(e),H&&(H.c(),H.m(C,U)))},d(W){W&&a(t),E(),H.d(),e[36](null),q.r(),V=!1,Be(z)}}}function Wn(l){let e,t,i,n,r="Cancelar",f,d,h="REQUERIMIENTOS DE RUTA",I,g,_,u,p,b,O,C="Confirmar",U,M;function F(S,E){return S[14]?jn:qn}let V=F(l)(l),z=l[13]&&Gn(l);return{c(){e=s("ion-header"),t=s("ion-toolbar"),i=s("ion-buttons"),n=s("ion-button"),n.textContent=r,f=N(),d=s("ion-title"),d.textContent=h,I=N(),g=s("ion-content"),_=s("ion-list"),V.c(),u=N(),z&&z.c(),p=N(),b=s("ion-footer"),O=s("ion-button"),O.textContent=C,this.h()},l(S){e=c(S,"ION-HEADER",{translucent:!0});var E=m(e);t=c(E,"ION-TOOLBAR",{});var y=m(t);i=c(y,"ION-BUTTONS",{slot:!0});var D=m(i);n=c(D,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),oe(n)!=="svelte-1dnmkxs"&&(n.textContent=r),D.forEach(a),f=T(y),d=c(y,"ION-TITLE",{"data-svelte-h":!0}),oe(d)!=="svelte-19bar5p"&&(d.textContent=h),y.forEach(a),E.forEach(a),I=T(S),g=c(S,"ION-CONTENT",{fullscreen:!0});var B=m(g);_=c(B,"ION-LIST",{});var H=m(_);V.l(H),u=T(H),z&&z.l(H),H.forEach(a),B.forEach(a),p=T(S),b=c(S,"ION-FOOTER",{});var X=m(b);O=c(X,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),oe(O)!=="svelte-g82qqw"&&(O.textContent=C),X.forEach(a),this.h()},h(){v(n,"color","medium"),v(i,"slot","start"),v(e,"translucent",""),v(g,"fullscreen",""),v(O,"fill","outline"),v(O,"color","tertiary"),v(O,"strong",""),L(O,"width","99%"),L(O,"height","auto")},m(S,E){x(S,e,E),o(e,t),o(t,i),o(i,n),o(t,f),o(t,d),x(S,I,E),x(S,g,E),o(g,_),V.m(_,null),o(_,u),z&&z.m(_,null),x(S,p,E),x(S,b,E),o(b,O),U||(M=[ce(n,"click",l[15]),ce(O,"click",l[16])],U=!0)},p(S,E){V.p(S,E),S[13]&&z.p(S,E)},i:ze,o:ze,d(S){S&&(a(e),a(I),a(g),a(p),a(b)),V.d(),z&&z.d(),U=!1,Be(M)}}}function ct(l,e){if(typeof l=="object"&&l!==null||Array.isArray(l)){if(Array.isArray(l))return l.map(t=>ct(t,e)).flat();{const t=Object.keys(l);let i;return e=="id_checklist_event"?i=t.filter(r=>r.toLowerCase().includes("id_checklist_event")).map(r=>l[r]):e=="mandatory"?i=t.filter(r=>r.toLowerCase().includes("mandatory")).map(r=>l[r]):(console.error("Tipo de dato no reconocido."),i=!1),i}}else return console.error("Invalid input. Please provide a valid object or array."),[]}function Jn(l,e,t){let i=it,n=document.querySelector("ion-modal");const r=n.componentProps.checklist,f=n.componentProps.driverId,d=n.componentProps.routeId,h=n.componentProps.isLast;let I,g,_,u,p=[],b=null,O={},C,U,M,F,q={},V=new Object,z={},S={};Ze(()=>{V=JSON.parse(localStorage.getItem("userSession")),h?console.log("Último checklist"):rt.update(k=>(k.mandatory=ct(r,"mandatory"),k.items=ct(r,"id_checklist_event"),k))});function E(k){t(11,q[k]=!0,q)}const y=async()=>{await(await je.create({header:"Datos o checklist incompletos",message:"Carga la evidencia requerida y marca todas las casillas para confirmar",buttons:[{text:"Cerrar"}]})).present()},D=async()=>{await(await je.create({header:"Datos capturados",message:"El kilometraje y gasolina final fueron registrados correctamente, espere aprobación para finalizar ruta",buttons:[{text:"Cerrar"}]})).present()},B=async k=>{await(await je.create({header:"Datos inválidos",message:k=="km"?"Llena correctamente el campo de kilometraje inicial":"Llena correctamente el campo de gasolina inicial",buttons:[{text:"Cerrar"}]})).present()},H=()=>{et.dismiss(),f?qe(`/drivers/${f}`):qe("/drivers/me")},X=()=>{if(h){var k=ve(_,"km"),w=ve(u,"gas");let se=new FormData;se.append("km_final",k),se.append("gas_final",w),se.append("id_route",d),se=me(se),k&&w?(H(),fetch(`${i}api/admin/checklist/add_evidence.php`,{method:"POST",body:se}).then(ge=>ge.json()).then(ge=>{D()}).catch(ge=>{console.error("Error fetching data:",ge)})):y()}else{var j=ve(I,"km"),te=ve(g,"gas");rt.update(se=>{se.items;const ge=se.mandatory;if(se.items.filter((re,pe)=>se.mandatory[pe]==="1").every(re=>se.checkedIndices.includes(re))&&j&&te){H();let re=new FormData;re=me(re),re.append("km_inicial",j),re.append("gas_inicial",te),re.append("id_route",d);for(const pe in z)if(z.hasOwnProperty(pe)){const{img:Ae,img_id:Ve}=z[pe];re.append(`selectedImages[${pe}][img]`,Ae),re.append(`selectedImages[${pe}][img_id]`,Ve)}fetch(`${i}api/admin/checklist/add_evidence.php`,{method:"POST",body:re}).then(pe=>pe.json()).then(pe=>{ge&&ge.some(Ae=>Ae==="1")?ie(d,"checklist-pending"):ie(d,"enroute")}).catch(pe=>{console.error("Error fetching data:",pe)})}else if(!ge&&j&&te){let re=new FormData;re.append("km_inicial",j),re.append("gas_inicial",te),re=me(re),fetch(`${i}api/admin/checklist/add_evidence.php`,{method:"POST",body:re}).then(pe=>pe.json()).then(pe=>{ie(d,"enroute")}).catch(pe=>{console.error("Error fetching data:",pe)})}else y();return se})}fe()},W=async(k,w)=>{E(w);const te=k.target.files[0],se=await ee(te);if(se){let ge=new FormData;ge.append("fileToUpload",se),ge=me(ge);try{const ye=await fetch(`${i}api/admin/manager/upload_img_driver.php`,{method:"POST",body:ge});if(ye.ok){const le=await ye.json();z={...z,[w]:{img:le.img,img_id:le.img_id}},t(12,S={...S,[w]:le.filename}),ne(w),t(6,O[w].checked=!0,O),t(11,q[w]=!1,q)}else console.error("File upload failed:",ye.statusText)}catch(ye){console.error("Error during file upload:",ye)}}},ee=async k=>new Promise(w=>{const j=new FileReader;j.onload=te=>{const se=new Image;se.src=te.target.result,se.onload=()=>{const ge=document.createElement("canvas"),ye=ge.getContext("2d"),le=800,re=600;let pe=se.width,Ae=se.height;pe>le&&(Ae*=le/pe,pe=le),Ae>re&&(pe*=re/Ae,Ae=re),ge.width=pe,ge.height=Ae,ye.drawImage(se,0,0,pe,Ae),ge.toBlob(Ve=>{w(Ve)},"image/jpeg",.7)}},j.readAsDataURL(k)}),ne=k=>{rt.update(w=>(w.checkedIndices.indexOf(k)===-1?w.checkedIndices.push(k):console.error(`ID ${k} is already checked.`),w.items.forEach(te=>{te.id_checklist_event===k&&(te.checked=!0)}),w))};function ie(k,w){let j=new FormData;j.append("id_route",k),j.append("status",w),j=me(j),fetch(`${i}api/admin/route/change_status.php`,{method:"POST",body:j}).then(te=>te.json()).then(te=>{}).catch(te=>{console.error("Error fetching data:",te)})}function ve(k,w){return/^\d+$/.test(k)?parseInt(k,10):(B(w),null)}function ue(k,w){_e(w),n.componentProps.data_type=w,Ue("modal-gas-km",Fn,{r:w}).then(()=>{Ge.subscribe(j=>{be(j,w)})})}function _e(k){$t.update(w=>({...w,flag:[k]}))}function be(k,w){t(0,I=k.km_inicial?k.km_inicial:null),t(1,g=k.gas_inicial?k.gas_inicial:null),t(2,_=k.km_final?k.km_final:null),t(3,u=k.gas_final?k.gas_final:null),w=="km_inicial"&&C&&t(7,C.checked=!0,C),w=="gas_inicial"&&U&&t(8,U.checked=!0,U),w=="km_final"&&M&&t(9,M.checked=!0,M),w=="gas_final"&&F&&t(10,F.checked=!0,F)}function fe(){Ge.set({km_inicial:[],gas_inicial:[],km_final:[],gas_final:[]})}function me(k){return k.append("token",V.token),k.append("id_user_over",V.id_user),k}const ke=[[]];function Oe(){p=Qe(ke[0],this.__value,this.checked),t(4,p)}function we(k){Se[k?"unshift":"push"](()=>{M=k,t(9,M)})}const Te=k=>ue(k,"km_final");function he(){p=Qe(ke[0],this.__value,this.checked),t(4,p)}function Ne(k){Se[k?"unshift":"push"](()=>{F=k,t(10,F)})}const Ce=k=>ue(k,"gas_final");function R(){p=Qe(ke[0],this.__value,this.checked),t(4,p)}function J(k){Se[k?"unshift":"push"](()=>{C=k,t(7,C)})}const A=k=>ue(k,"km_inicial");function G(k){Se[k?"unshift":"push"](()=>{U=k,t(8,U)})}function K(){p=Qe(ke[0],this.__value,this.checked),t(4,p)}const P=k=>ue(k,"gas_inicial");function Q(){p=Qe(ke[0],this.__value,this.checked),t(4,p)}function ae(k,w){Se[k?"unshift":"push"](()=>{O[w.id_checklist_event]=k,t(6,O)})}const de=k=>ne(k.id_checklist_event);function Y(k){Se[k?"unshift":"push"](()=>{b=k,t(5,b)})}return[I,g,_,u,p,b,O,C,U,M,F,q,S,r,h,H,X,W,ne,ue,Oe,ke,we,Te,he,Ne,Ce,R,J,A,G,K,P,Q,ae,de,Y,(k,w)=>W(w,k.id_checklist_event)]}class en extends Je{constructor(e){super(),Ye(this,e,Jn,Wn,We,{},null,[-1,-1])}}function Et(l,e,t){const i=l.slice();return i[55]=e[t],i[57]=t,i}function Yn(l){let e,t,i="Confirmar",n,r;return{c(){e=s("ion-buttons"),t=s("ion-button"),t.textContent=i,this.h()},l(f){e=c(f,"ION-BUTTONS",{slot:!0});var d=m(e);t=c(d,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),oe(t)!=="svelte-1ida0il"&&(t.textContent=i),d.forEach(a),this.h()},h(){v(t,"strong",""),v(e,"slot","end")},m(f,d){x(f,e,d),o(e,t),n||(r=ce(t,"click",l[22]),n=!0)},p:ze,d(f){f&&a(e),n=!1,r()}}}function Qn(l){let e,t,i,n,r,f="Teléfono de Negocio",d,h,I=l[14].client_phone+"",g;return{c(){e=s("ion-item"),t=s("ion-icon"),i=N(),n=s("ion-label"),r=s("p"),r.textContent=f,d=N(),h=s("h2"),g=Ee(I),this.h()},l(_){e=c(_,"ION-ITEM",{href:!0});var u=m(e);t=c(u,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),i=T(u),n=c(u,"ION-LABEL",{class:!0});var p=m(n);r=c(p,"P",{"data-svelte-h":!0}),oe(r)!=="svelte-1u5l7fz"&&(r.textContent=f),d=T(p),h=c(p,"H2",{});var b=m(h);g=Ie(b,I),b.forEach(a),p.forEach(a),u.forEach(a),this.h()},h(){v(t,"icon",vn),v(t,"slot","start"),v(n,"class","ion-text-wrap"),v(e,"href","tel:"+l[14].client_phone)},m(_,u){x(_,e,u),o(e,t),o(e,i),o(e,n),o(n,r),o(n,d),o(n,h),o(h,g)},p:ze,d(_){_&&a(e)}}}function Zn(l){let e,t,i,n,r,f="Domicilio Alternativo",d,h,I=l[14].line2+"",g,_,u;return{c(){e=s("ion-item"),t=s("ion-icon"),i=N(),n=s("ion-label"),r=s("p"),r.textContent=f,d=N(),h=s("h2"),g=Ee(I),_=N(),u=s("ion-icon"),this.h()},l(p){e=c(p,"ION-ITEM",{href:!0});var b=m(e);t=c(b,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),i=T(b),n=c(b,"ION-LABEL",{class:!0});var O=m(n);r=c(O,"P",{"data-svelte-h":!0}),oe(r)!=="svelte-1ub9uzw"&&(r.textContent=f),d=T(O),h=c(O,"H2",{});var C=m(h);g=Ie(C,I),C.forEach(a),O.forEach(a),_=T(b),u=c(b,"ION-ICON",{icon:!0,slot:!0}),m(u).forEach(a),b.forEach(a),this.h()},h(){v(t,"icon",_t),v(t,"slot","start"),v(n,"class","ion-text-wrap"),v(u,"icon",Re),v(u,"slot","end"),v(e,"href","https://www.google.com/maps/searhc/?api=1&query="+l[14].line2)},m(p,b){x(p,e,b),o(e,t),o(e,i),o(e,n),o(n,r),o(n,d),o(n,h),o(h,g),o(e,_),o(e,u)},p:ze,d(p){p&&a(e)}}}function xn(l){let e,t,i,n,r,f="Domicilio",d,h,I=l[14].line1+"",g,_,u,p,b=l[14].line2&&l[14].line2.trim().length,O,C=b&&$n(l);return{c(){e=s("ion-item"),t=s("ion-icon"),i=N(),n=s("ion-label"),r=s("p"),r.textContent=f,d=N(),h=s("h2"),g=Ee(I),_=N(),u=s("ion-icon"),p=N(),C&&C.c(),O=De(),this.h()},l(U){e=c(U,"ION-ITEM",{href:!0});var M=m(e);t=c(M,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),i=T(M),n=c(M,"ION-LABEL",{class:!0});var F=m(n);r=c(F,"P",{"data-svelte-h":!0}),oe(r)!=="svelte-cbm7q1"&&(r.textContent=f),d=T(F),h=c(F,"H2",{});var q=m(h);g=Ie(q,I),q.forEach(a),F.forEach(a),_=T(M),u=c(M,"ION-ICON",{icon:!0,slot:!0}),m(u).forEach(a),M.forEach(a),p=T(U),C&&C.l(U),O=De(),this.h()},h(){v(t,"icon",_t),v(t,"slot","start"),v(n,"class","ion-text-wrap"),v(u,"icon",Re),v(u,"slot","end"),v(e,"href","https://www.google.com/maps/search/?api=1&query="+l[14].line1)},m(U,M){x(U,e,M),o(e,t),o(e,i),o(e,n),o(n,r),o(n,d),o(n,h),o(h,g),o(e,_),o(e,u),x(U,p,M),C&&C.m(U,M),x(U,O,M)},p(U,M){b&&C.p(U,M)},d(U){U&&(a(e),a(p),a(O)),C&&C.d(U)}}}function $n(l){let e,t,i,n,r,f="Domicilio Alternativo",d,h,I=l[14].line2+"",g,_,u;return{c(){e=s("ion-item"),t=s("ion-icon"),i=N(),n=s("ion-label"),r=s("p"),r.textContent=f,d=N(),h=s("h2"),g=Ee(I),_=N(),u=s("ion-icon"),this.h()},l(p){e=c(p,"ION-ITEM",{href:!0});var b=m(e);t=c(b,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),i=T(b),n=c(b,"ION-LABEL",{class:!0});var O=m(n);r=c(O,"P",{"data-svelte-h":!0}),oe(r)!=="svelte-1ub9uzw"&&(r.textContent=f),d=T(O),h=c(O,"H2",{});var C=m(h);g=Ie(C,I),C.forEach(a),O.forEach(a),_=T(b),u=c(b,"ION-ICON",{icon:!0,slot:!0}),m(u).forEach(a),b.forEach(a),this.h()},h(){v(t,"icon",_t),v(t,"slot","start"),v(n,"class","ion-text-wrap"),v(u,"icon",Re),v(u,"slot","end"),v(e,"href","https://www.google.com/maps/search/?api=1&query="+l[14].line2)},m(p,b){x(p,e,b),o(e,t),o(e,i),o(e,n),o(n,r),o(n,d),o(n,h),o(h,g),o(e,_),o(e,u)},p:ze,d(p){p&&a(e)}}}function It(l){let e,t,i,n,r,f="Contacto del Cliente",d,h,I,g,_=l[3]&&l[3]==="1"&&kt(l);return{c(){e=s("ion-item"),t=s("ion-icon"),i=N(),n=s("ion-label"),r=s("p"),r.textContent=f,d=N(),h=s("h2"),I=Ee(l[7]),g=N(),_&&_.c(),this.h()},l(u){e=c(u,"ION-ITEM",{});var p=m(e);t=c(p,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),i=T(p),n=c(p,"ION-LABEL",{class:!0});var b=m(n);r=c(b,"P",{"data-svelte-h":!0}),oe(r)!=="svelte-1utsyb6"&&(r.textContent=f),d=T(b),h=c(b,"H2",{});var O=m(h);I=Ie(O,l[7]),O.forEach(a),b.forEach(a),g=T(p),_&&_.l(p),p.forEach(a),this.h()},h(){v(t,"icon",gn),v(t,"slot","start"),v(n,"class","ion-text-wrap")},m(u,p){x(u,e,p),o(e,t),o(e,i),o(e,n),o(n,r),o(n,d),o(n,h),o(h,I),o(e,g),_&&_.m(e,null)},p(u,p){p[0]&128&&Le(I,u[7]),u[3]&&u[3]==="1"?_?_.p(u,p):(_=kt(u),_.c(),_.m(e,null)):_&&(_.d(1),_=null)},d(u){u&&a(e),_&&_.d()}}}function kt(l){let e,t=`<ion-icon icon="${On}" slot="start"></ion-icon>
                        Notificar Cliente`,i,n;return{c(){e=s("ion-button"),e.innerHTML=t,this.h()},l(r){e=c(r,"ION-BUTTON",{fill:!0,style:!0,"data-svelte-h":!0}),oe(e)!=="svelte-w3qtwm"&&(e.innerHTML=t),this.h()},h(){v(e,"fill","outline"),L(e,"margin-left","16px")},m(r,f){x(r,e,f),i||(n=ce(e,"click",l[23]),i=!0)},p:ze,d(r){r&&a(e),i=!1,n()}}}function Ot(l){let e,t,i,n,r,f="Notas de ubicación",d,h,I;return{c(){e=s("ion-item"),t=s("ion-icon"),i=N(),n=s("ion-label"),r=s("p"),r.textContent=f,d=N(),h=s("h2"),I=Ee(l[8]),this.h()},l(g){e=c(g,"ION-ITEM",{});var _=m(e);t=c(_,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),i=T(_),n=c(_,"ION-LABEL",{class:!0});var u=m(n);r=c(u,"P",{"data-svelte-h":!0}),oe(r)!=="svelte-nhm2ft"&&(r.textContent=f),d=T(u),h=c(u,"H2",{});var p=m(h);I=Ie(p,l[8]),p.forEach(a),u.forEach(a),_.forEach(a),this.h()},h(){v(t,"icon",Qt),v(t,"slot","start"),v(n,"class","ion-text-wrap")},m(g,_){x(g,e,_),o(e,t),o(e,i),o(e,n),o(n,r),o(n,d),o(n,h),o(h,I)},p(g,_){_[0]&256&&Le(I,g[8])},d(g){g&&a(e)}}}function eo(l){let e,t,i,n,r,f="Horarios",d,h,I=l[14].schedule+"",g;return{c(){e=s("ion-item"),t=s("ion-icon"),i=N(),n=s("ion-label"),r=s("p"),r.textContent=f,d=N(),h=s("h2"),g=Ee(I),this.h()},l(_){e=c(_,"ION-ITEM",{});var u=m(e);t=c(u,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),i=T(u),n=c(u,"ION-LABEL",{});var p=m(n);r=c(p,"P",{"data-svelte-h":!0}),oe(r)!=="svelte-11q7hm5"&&(r.textContent=f),d=T(p),h=c(p,"H2",{});var b=m(h);g=Ie(b,I),b.forEach(a),p.forEach(a),u.forEach(a),this.h()},h(){v(t,"icon",bn),v(t,"slot","start")},m(_,u){x(_,e,u),o(e,t),o(e,i),o(e,n),o(n,r),o(n,d),o(n,h),o(h,g)},p:ze,d(_){_&&a(e)}}}function to(l){let e,t,i,n,r,f="Notas del operador",d,h,I=l[14].driver_comments+"",g;return{c(){e=s("ion-item"),t=s("ion-icon"),i=N(),n=s("ion-label"),r=s("p"),r.textContent=f,d=N(),h=s("h2"),g=Ee(I),this.h()},l(_){e=c(_,"ION-ITEM",{});var u=m(e);t=c(u,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),i=T(u),n=c(u,"ION-LABEL",{});var p=m(n);r=c(p,"P",{"data-svelte-h":!0}),oe(r)!=="svelte-1yk9qp4"&&(r.textContent=f),d=T(p),h=c(p,"H2",{});var b=m(h);g=Ie(b,I),b.forEach(a),p.forEach(a),u.forEach(a),this.h()},h(){v(t,"icon",Zt),v(t,"slot","start")},m(_,u){x(_,e,u),o(e,t),o(e,i),o(e,n),o(n,r),o(n,d),o(n,h),o(h,g)},p:ze,d(_){_&&a(e)}}}function no(l){let e,t=l[14].logistic_comments!="<br>"&&oo(l);return{c(){t&&t.c(),e=De()},l(i){t&&t.l(i),e=De()},m(i,n){t&&t.m(i,n),x(i,e,n)},p(i,n){i[14].logistic_comments!="<br>"&&t.p(i,n)},d(i){i&&a(e),t&&t.d(i)}}}function oo(l){let e,t,i,n,r,f="Comentarios logísticos",d,h,I=l[14].logistic_comments+"",g;return{c(){e=s("ion-item"),t=s("ion-icon"),i=N(),n=s("ion-label"),r=s("p"),r.textContent=f,d=N(),h=s("h2"),g=Ee(I),this.h()},l(_){e=c(_,"ION-ITEM",{});var u=m(e);t=c(u,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),i=T(u),n=c(u,"ION-LABEL",{class:!0});var p=m(n);r=c(p,"P",{"data-svelte-h":!0}),oe(r)!=="svelte-1iz85r6"&&(r.textContent=f),d=T(p),h=c(p,"H2",{});var b=m(h);g=Ie(b,I),b.forEach(a),p.forEach(a),u.forEach(a),this.h()},h(){v(t,"icon",Qt),v(t,"slot","start"),v(n,"class","ion-text-wrap")},m(_,u){x(_,e,u),o(e,t),o(e,i),o(e,n),o(n,r),o(n,d),o(n,h),o(h,g)},p:ze,d(_){_&&a(e)}}}function Nt(l){let e,t,i,n;return{c(){e=s("ion-item"),t=s("ion-icon"),i=N(),n=s("ion-textarea"),this.h()},l(r){e=c(r,"ION-ITEM",{});var f=m(e);t=c(f,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),i=T(f),n=c(f,"ION-TEXTAREA",{placeholder:!0}),m(n).forEach(a),f.forEach(a),this.h()},h(){v(t,"icon",En),v(t,"slot","start"),v(n,"placeholder","Escribe el motivo...")},m(r,f){x(r,e,f),o(e,t),o(e,i),o(e,n),l[29](n)},p:ze,d(r){r&&a(e),l[29](null)}}}function lo(l){let e,t,i,n,r,f,d,h,I,g,_="Estado de entrega",u,p,b="Entregado",O,C,U="No Entregado",M,F,q="Entrega Parcial",V,z,S,E=l[5]===!0&&Tt(l),y=(l[6]===!0||l[6]===!1&&l[5]===!1)&&Ct(l);return{c(){e=s("ion-item"),t=s("ion-icon"),i=N(),n=s("ion-textarea"),r=N(),f=s("ion-item"),d=s("ion-icon"),h=N(),I=s("ion-select"),g=s("div"),g.textContent=_,u=N(),p=s("ion-select-option"),p.textContent=b,O=N(),C=s("ion-select-option"),C.textContent=U,M=N(),F=s("ion-select-option"),F.textContent=q,V=N(),z=s("section"),E&&E.c(),S=N(),y&&y.c(),this.h()},l(D){e=c(D,"ION-ITEM",{});var B=m(e);t=c(B,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),i=T(B),n=c(B,"ION-TEXTAREA",{label:!0,placeholder:!0}),m(n).forEach(a),B.forEach(a),r=T(D),f=c(D,"ION-ITEM",{});var H=m(f);d=c(H,"ION-ICON",{icon:!0,slot:!0}),m(d).forEach(a),h=T(H),I=c(H,"ION-SELECT",{value:!0});var X=m(I);g=c(X,"DIV",{slot:!0,"data-svelte-h":!0}),oe(g)!=="svelte-1635zca"&&(g.textContent=_),u=T(X),p=c(X,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),oe(p)!=="svelte-s33eln"&&(p.textContent=b),O=T(X),C=c(X,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),oe(C)!=="svelte-1a859l3"&&(C.textContent=U),M=T(X),F=c(X,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),oe(F)!=="svelte-1c4dcm8"&&(F.textContent=q),X.forEach(a),H.forEach(a),V=T(D),z=c(D,"SECTION",{style:!0});var W=m(z);E&&E.l(W),S=T(W),y&&y.l(W),W.forEach(a),this.h()},h(){v(t,"icon",st),v(t,"slot","start"),v(n,"label","Notas"),v(n,"placeholder","Escribe aquí..."),v(d,"icon",In),v(d,"slot","start"),$(g,"slot","label"),v(p,"value","delivered"),v(C,"value","notdelivered"),v(F,"value","partialdeliver"),v(I,"value",l[17]?l[17]:"delivered"),L(z,"display","flex"),L(z,"gap","8px"),L(z,"padding","16px 16px 6px")},m(D,B){x(D,e,B),o(e,t),o(e,i),o(e,n),l[30](n),x(D,r,B),x(D,f,B),o(f,d),o(f,h),o(f,I),o(I,g),o(I,u),o(I,p),o(I,O),o(I,C),o(I,M),o(I,F),l[31](I),x(D,V,B),x(D,z,B),E&&E.m(z,null),o(z,S),y&&y.m(z,null)},p(D,B){D[5]===!0?E?E.p(D,B):(E=Tt(D),E.c(),E.m(z,S)):E&&(E.d(1),E=null),D[6]===!0||D[6]===!1&&D[5]===!1?y?y.p(D,B):(y=Ct(D),y.c(),y.m(z,null)):y&&(y.d(1),y=null)},d(D){D&&(a(e),a(r),a(f),a(V),a(z)),l[30](null),l[31](null),E&&E.d(),y&&y.d()}}}function Tt(l){let e,t=`<ion-icon icon="${Nn}" slot="start"></ion-icon>
                        Ingreso`,i,n;return{c(){e=s("ion-button"),e.innerHTML=t,this.h()},l(r){e=c(r,"ION-BUTTON",{id:!0,style:!0,"data-svelte-h":!0}),oe(e)!=="svelte-3onvnr"&&(e.innerHTML=t),this.h()},h(){v(e,"id","checkInBtn"),L(e,"flex","1")},m(r,f){x(r,e,f),i||(n=ce(e,"click",l[24]),i=!0)},p:ze,d(r){r&&a(e),i=!1,n()}}}function Ct(l){let e,t,i,n,r,f;return{c(){e=s("ion-button"),t=s("ion-icon"),i=Ee(`
                        Salida`),this.h()},l(d){e=c(d,"ION-BUTTON",{id:!0,style:!0,disabled:!0});var h=m(e);t=c(h,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),i=Ie(h,`
                        Salida`),h.forEach(a),this.h()},h(){v(t,"icon",kn),v(t,"slot","start"),v(e,"id","checkOutBtn"),L(e,"flex","1"),v(e,"disabled",n=l[6]===!1)},m(d,h){x(d,e,h),o(e,t),o(e,i),r||(f=ce(e,"click",l[25]),r=!0)},p(d,h){h[0]&64&&n!==(n=d[6]===!1)&&v(e,"disabled",n)},d(d){d&&a(e),r=!1,f()}}}function io(l){let e,t,i,n,r,f="Subir Evidencia",d,h,I,g;return{c(){e=s("section"),t=s("ion-button"),i=s("ion-icon"),n=N(),r=s("label"),r.textContent=f,d=N(),h=s("input"),this.h()},l(_){e=c(_,"SECTION",{style:!0});var u=m(e);t=c(u,"ION-BUTTON",{fill:!0,class:!0,style:!0});var p=m(t);i=c(p,"ION-ICON",{icon:!0,slot:!0}),m(i).forEach(a),n=T(p),r=c(p,"LABEL",{for:!0,"data-svelte-h":!0}),oe(r)!=="svelte-1wg51s6"&&(r.textContent=f),d=T(p),h=c(p,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0}),p.forEach(a),u.forEach(a),this.h()},h(){v(i,"icon",xt),v(i,"slot","start"),$(r,"for","eventEvidence"),L(h,"display","none"),$(h,"id","eventEvidence"),$(h,"name","fileToUpload"),$(h,"type","file"),h.multiple=!0,$(h,"accept","image/*"),v(t,"fill","outline"),v(t,"class","loadEvidence"),L(t,"flex","1"),L(e,"display","flex"),L(e,"gap","8px"),L(e,"padding","0px 16px")},m(_,u){x(_,e,u),o(e,t),o(t,i),o(t,n),o(t,r),o(t,d),o(t,h),I||(g=[ce(h,"change",l[18]),ce(h,"click",l[19])],I=!0)},p:ze,d(_){_&&a(e),I=!1,Be(g)}}}function yt(l){let e,t='<ion-spinner name="dots"></ion-spinner>';return{c(){e=s("section"),e.innerHTML=t,this.h()},l(i){e=c(i,"SECTION",{style:!0,"data-svelte-h":!0}),oe(e)!=="svelte-1sj3e0"&&(e.innerHTML=t),this.h()},h(){L(e,"text-align","center")},m(i,n){x(i,e,n)},d(i){i&&a(e)}}}function wt(l){let e,t,i=He(l[2]),n=[];for(let r=0;r<i.length;r+=1)n[r]=Lt(Et(l,i,r));return{c(){e=s("section"),t=s("div");for(let r=0;r<n.length;r+=1)n[r].c();this.h()},l(r){e=c(r,"SECTION",{});var f=m(e);t=c(f,"DIV",{class:!0,style:!0});var d=m(t);for(let h=0;h<n.length;h+=1)n[h].l(d);d.forEach(a),f.forEach(a),this.h()},h(){$(t,"class","image-grid"),L(t,"display","grid"),L(t,"grid-template-columns","repeat(auto-fill, minmax(100px, 1fr))"),L(t,"gap","10px"),L(t,"padding","0px 10px")},m(r,f){x(r,e,f),o(e,t);for(let d=0;d<n.length;d+=1)n[d]&&n[d].m(t,null)},p(r,f){if(f[0]&69206020){i=He(r[2]);let d;for(d=0;d<i.length;d+=1){const h=Et(r,i,d);n[d]?n[d].p(h,f):(n[d]=Lt(h),n[d].c(),n[d].m(t,null))}for(;d<n.length;d+=1)n[d].d(1);n.length=i.length}},d(r){r&&a(e),on(n,r)}}}function Lt(l){let e,t,i,n,r,f=`<ion-icon icon="${Tn}"></ion-icon>`,d,h,I;function g(){return l[32](l[55])}function _(){return l[33](l[57])}return{c(){e=s("div"),t=s("ion-img"),n=N(),r=s("button"),r.innerHTML=f,d=N(),this.h()},l(u){e=c(u,"DIV",{class:!0,style:!0});var p=m(e);t=c(p,"ION-IMG",{src:!0,alt:!0,style:!0}),m(t).forEach(a),n=T(p),r=c(p,"BUTTON",{class:!0,style:!0,"data-svelte-h":!0}),oe(r)!=="svelte-zguiov"&&(r.innerHTML=f),d=T(p),p.forEach(a),this.h()},h(){Ke(t.src,i=l[55])||v(t,"src",i),v(t,"alt","Evidencia fotográfica"),L(t,"width","100%"),L(t,"height","100px"),L(t,"object-fit","cover"),L(t,"cursor","pointer"),L(t,"border","1px solid #ccc"),L(t,"border-radius","4px"),L(t,"margin-top","16px"),$(r,"class","remove-button"),L(r,"position","absolute"),L(r,"top","5px"),L(r,"right","5px"),L(r,"border","none"),L(r,"cursor","pointer"),L(r,"font-size","18px"),L(r,"background","white"),L(r,"border-radius","50%"),L(r,"padding","3px 4px 0px"),L(r,"box-shadow","2px 2px 6px rgba(0, 0, 0, 0.3)"),L(r,"color","#0000008f"),$(e,"class","image-container"),L(e,"position","relative")},m(u,p){x(u,e,p),o(e,t),o(e,n),o(e,r),o(e,d),h||(I=[ce(t,"click",g),ce(r,"click",_)],h=!0)},p(u,p){l=u,p[0]&4&&!Ke(t.src,i=l[55])&&v(t,"src",i)},d(u){u&&a(e),h=!1,Be(I)}}}function zt(l){let e,t,i,n,r,f,d=`<ion-icon icon="${Cn}"></ion-icon>`,h,I;return{c(){e=s("div"),t=s("div"),i=s("ion-img"),r=N(),f=s("button"),f.innerHTML=d,this.h()},l(g){e=c(g,"DIV",{class:!0,style:!0});var _=m(e);t=c(_,"DIV",{class:!0,style:!0});var u=m(t);i=c(u,"ION-IMG",{src:!0,alt:!0,style:!0}),m(i).forEach(a),r=T(u),f=c(u,"BUTTON",{class:!0,style:!0,"data-svelte-h":!0}),oe(f)!=="svelte-g0qr0o"&&(f.innerHTML=d),u.forEach(a),_.forEach(a),this.h()},h(){Ke(i.src,n=l[12])||v(i,"src",n),v(i,"alt","Evidencia fotográfica"),L(i,"width","100%"),L(i,"height","auto"),$(f,"class","close-button"),L(f,"position","absolute"),L(f,"top","5px"),L(f,"right","5px"),L(f,"background","white"),L(f,"color","#444444d1"),L(f,"border","none"),L(f,"cursor","pointer"),L(f,"padding","2px 2px 0px 6px"),L(f,"border-radius","50%"),L(f,"font-size","20px"),$(t,"class","modal-content"),L(t,"position","relative"),L(t,"background","white"),L(t,"padding","20px"),L(t,"border-radius","8px"),L(t,"max-width","90vw"),L(t,"max-height","90vh"),L(t,"overflow","auto"),$(e,"class","modal-overlay"),L(e,"position","fixed"),L(e,"top","0"),L(e,"left","0"),L(e,"width","100vw"),L(e,"height","100vh"),L(e,"background","rgba(0, 0, 0, 0.8)"),L(e,"display","flex"),L(e,"justify-content","center"),L(e,"align-items","center"),L(e,"z-index","1000")},m(g,_){x(g,e,_),o(e,t),o(t,i),o(t,r),o(t,f),h||(I=[ce(f,"click",l[27]),ce(t,"click",ln(l[28])),ce(e,"click",l[27])],h=!0)},p(g,_){_[0]&4096&&!Ke(i.src,n=g[12])&&v(i,"src",n)},d(g){g&&a(e),h=!1,Be(I)}}}function ro(l){let e,t,i,n,r="Cerrar",f,d,h=l[14].title+"",I,g,_,u,p,b,O,C,U,M,F="Negocio",q,V,z=l[14].client_name+"",S,E,y=l[14].client_phone&&l[14].client_phone.trim().length,D,B,H,X,W=l[14].schedule&&l[14].schedule.trim().length,ee,ne,ie=l[14].logistic_comments&&l[14].logistic_comments.trim().length,ve,ue,_e,be,fe,me,ke,Oe,we,Te=(!l[15]&&!l[16]||l[15]&&l[16])&&Yn(l),he=y&&Qn(l);function Ne(w,j){if(w[14].line1&&w[14].line1.trim().length)return xn;if(w[14].line2&&w[14].line2.trim().length)return Zn}let Ce=Ne(l),R=Ce&&Ce(l),J=l[7]&&It(l),A=l[8]&&l[8]!=="<br>"&&Ot(l),G=W&&eo(l),K=l[14].driver_comments&&to(l),P=ie&&no(l),Q=l[9]&&Nt(l),ae=!l[16]&&lo(l),de=(l[15]&&l[16]||!l[15]&&!l[16])&&io(l),Y=l[4]&&yt(),Z=l[1]&&wt(l),k=l[11]&&zt(l);return{c(){e=s("ion-header"),t=s("ion-toolbar"),i=s("ion-buttons"),n=s("ion-button"),n.textContent=r,f=N(),d=s("ion-title"),I=Ee(h),g=N(),Te&&Te.c(),_=N(),u=s("ion-content"),p=s("ion-list"),b=s("ion-item"),O=s("ion-icon"),C=N(),U=s("ion-label"),M=s("p"),M.textContent=F,q=N(),V=s("h2"),S=Ee(z),E=N(),he&&he.c(),D=N(),R&&R.c(),B=N(),J&&J.c(),H=N(),A&&A.c(),X=N(),G&&G.c(),ee=N(),K&&K.c(),ne=N(),P&&P.c(),ve=N(),Q&&Q.c(),ue=N(),ae&&ae.c(),_e=N(),de&&de.c(),be=N(),Y&&Y.c(),fe=N(),Z&&Z.c(),me=N(),k&&k.c(),ke=De(),this.h()},l(w){e=c(w,"ION-HEADER",{translucent:!0});var j=m(e);t=c(j,"ION-TOOLBAR",{});var te=m(t);i=c(te,"ION-BUTTONS",{slot:!0});var se=m(i);n=c(se,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),oe(n)!=="svelte-2ks32x"&&(n.textContent=r),se.forEach(a),f=T(te),d=c(te,"ION-TITLE",{style:!0,title:!0});var ge=m(d);I=Ie(ge,h),ge.forEach(a),g=T(te),Te&&Te.l(te),te.forEach(a),j.forEach(a),_=T(w),u=c(w,"ION-CONTENT",{fullscreen:!0});var ye=m(u);p=c(ye,"ION-LIST",{});var le=m(p);b=c(le,"ION-ITEM",{});var re=m(b);O=c(re,"ION-ICON",{icon:!0,slot:!0}),m(O).forEach(a),C=T(re),U=c(re,"ION-LABEL",{});var pe=m(U);M=c(pe,"P",{"data-svelte-h":!0}),oe(M)!=="svelte-57b1dg"&&(M.textContent=F),q=T(pe),V=c(pe,"H2",{});var Ae=m(V);S=Ie(Ae,z),Ae.forEach(a),pe.forEach(a),re.forEach(a),E=T(le),he&&he.l(le),D=T(le),R&&R.l(le),B=T(le),J&&J.l(le),H=T(le),A&&A.l(le),X=T(le),G&&G.l(le),ee=T(le),K&&K.l(le),ne=T(le),P&&P.l(le),ve=T(le),Q&&Q.l(le),ue=T(le),ae&&ae.l(le),_e=T(le),de&&de.l(le),be=T(le),Y&&Y.l(le),fe=T(le),Z&&Z.l(le),le.forEach(a),ye.forEach(a),me=T(w),k&&k.l(w),ke=De(),this.h()},h(){v(n,"color","medium"),v(i,"slot","start"),L(d,"text-align","center"),v(d,"title",l[14].title),v(e,"translucent",""),v(O,"icon",mn),v(O,"slot","start"),v(u,"fullscreen","")},m(w,j){x(w,e,j),o(e,t),o(t,i),o(i,n),o(t,f),o(t,d),o(d,I),o(t,g),Te&&Te.m(t,null),x(w,_,j),x(w,u,j),o(u,p),o(p,b),o(b,O),o(b,C),o(b,U),o(U,M),o(U,q),o(U,V),o(V,S),o(p,E),he&&he.m(p,null),o(p,D),R&&R.m(p,null),o(p,B),J&&J.m(p,null),o(p,H),A&&A.m(p,null),o(p,X),G&&G.m(p,null),o(p,ee),K&&K.m(p,null),o(p,ne),P&&P.m(p,null),o(p,ve),Q&&Q.m(p,null),o(p,ue),ae&&ae.m(p,null),o(p,_e),de&&de.m(p,null),o(p,be),Y&&Y.m(p,null),o(p,fe),Z&&Z.m(p,null),x(w,me,j),k&&k.m(w,j),x(w,ke,j),Oe||(we=ce(n,"click",l[20]),Oe=!0)},p(w,j){(!w[15]&&!w[16]||w[15]&&w[16])&&Te.p(w,j),y&&he.p(w,j),R&&R.p(w,j),w[7]?J?J.p(w,j):(J=It(w),J.c(),J.m(p,H)):J&&(J.d(1),J=null),w[8]&&w[8]!=="<br>"?A?A.p(w,j):(A=Ot(w),A.c(),A.m(p,X)):A&&(A.d(1),A=null),W&&G.p(w,j),w[14].driver_comments&&K.p(w,j),ie&&P.p(w,j),w[9]?Q?Q.p(w,j):(Q=Nt(w),Q.c(),Q.m(p,ue)):Q&&(Q.d(1),Q=null),w[16]||ae.p(w,j),(w[15]&&w[16]||!w[15]&&!w[16])&&de.p(w,j),w[4]?Y||(Y=yt(),Y.c(),Y.m(p,fe)):Y&&(Y.d(1),Y=null),w[1]?Z?Z.p(w,j):(Z=wt(w),Z.c(),Z.m(p,null)):Z&&(Z.d(1),Z=null),w[11]?k?k.p(w,j):(k=zt(w),k.c(),k.m(ke.parentNode,ke)):k&&(k.d(1),k=null)},i:ze,o:ze,d(w){w&&(a(e),a(_),a(u),a(me),a(ke)),Te&&Te.d(),he&&he.d(),R&&R.d(),J&&J.d(),A&&A.d(),G&&G.d(),K&&K.d(),P&&P.d(),Q&&Q.d(),ae&&ae.d(),de&&de.d(),Y&&Y.d(),Z&&Z.d(),k&&k.d(w),Oe=!1,we()}}}const At=/Teléfono:\s*(\d{10,})/;function Mt(l,e){for(let t=0;t<e.length;t++)if(e[t].alias===l)return e[t].val;return""}function ot(l=""){return l.split(",").map(t=>t.trim())}function ao(l,e,t){let i=it,n=document.querySelector("ion-modal"),r=n.componentProps.delivery,f=n.componentProps.isLast||!1,d=n.componentProps.flag||!1,h=r.driver_comments?r.driver_comments:"",I=r.deliver_status?r.deliver_status:"",g=r.img?r.img:"",_=r.img_id?r.img_id:"",u=g?ot(g):new Array,p=_?ot(_):new Array,b={latitude:null,longitude:null},O=new Object,C="",U="",M=!1,F=!0,q=!1,V="",z=r.comments_ext,S=!1,E="",y=!1,D=null,B=new Object,H="";Ze(()=>{B=JSON.parse(localStorage.getItem("userSession")),Te(),W()});async function X(Y="",Z,k={}){let w=new FormData;t(4,M=!0);for(const[j,te]of Object.entries(k))w.append(j,te);w=A(w);try{const j=await fetch(Y,{method:"POST",body:w});if(j.ok){const te=await j.json();Z(te)}else console.error("Request failed:",j.statusText)}catch(j){console.error("Error during file upload:",j)}finally{t(4,M=!1)}}function W(){r.date_service?r.date_service&&!r.date_completed&&!r.service_time?(t(5,F=!1),t(6,q=!0)):r.date_service&&r.date_completed&&r.service_time&&(t(5,F=!1),t(6,q=!1)):(t(5,F=!0),t(6,q=!1))}if(r.comments_ext){const Y=r.comments_ext.match(At);Y&&(V=Y[1],z=r.comments_ext.replace(At,"").trim())}const ee=async(Y,Z)=>{await(await je.create({header:Y||"Error",message:Z||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()},ne=async(Y="",Z="",k="",w,j={})=>{await(await je.create({header:Y||"Error",message:Z||"Vuelva a intentar",buttons:[{text:"No",role:"cancel",handler:()=>{}},{text:"Sí",handler:()=>{X(k,w,j)}}]})).present()},ie=async Y=>{if(u.length==5)ee("Límite de evidencias","Solo se permite subir 5 fotos por parada");else if(d&&f&&u.length==1)ee("Límite de evidencias","Para el final de la ruta solo se permite subir 1 foto");else{const w=Y.target.files[0],j=await _e(w);if(j){t(1,g=u.join(",")),_=p.join(",");var Z=new Object;Z.fileToUpload=j,X(`${i}api/admin/manager/upload_img_driver.php`,function(te){t(1,g=g?`${g},${te.img}`:te.img),_=_?`${_},${te.img_id}`:te.img_id,t(2,u=ot(g)),p=ot(_)},Z)}}};function ve(Y){var Z=r.service_time;!Z&&F&&!f&&!d&&(Y.preventDefault(),ee("Registrar Ingreso","Antes de subir la evidencia registra el ingreso a la actual parada."))}function ue(){var Y=d?r.date_completed:!1;if(!Y&&!F&&q&&!f&&!d){var Z=new Object;Z.id_event=r.id_event,Z.type="checkout",ne("Registrar Salida","¿Completaste tu entrega?",i+"api/admin/route/record_check_date.php",function(k){k.minutes&&ee("Tiempo por parada","Completaste la parada en "+k.minutes+" minutos.")},Z)}}const _e=async Y=>new Promise(Z=>{const k=new FileReader;k.onload=w=>{const j=new Image;j.src=w.target.result,j.onload=()=>{const te=document.createElement("canvas"),se=te.getContext("2d"),ge=800,ye=600;let le=j.width,re=j.height;le>ge&&(re*=ge/le,le=ge),re>ye&&(le*=ye/re,re=ye),te.width=le,te.height=re,se.drawImage(j,0,0,le,re),te.toBlob(pe=>{Z(pe)},"image/jpeg",.7)}},k.readAsDataURL(Y)}),be=()=>{n.dismiss({data:Date.now()})};function fe(Y){t(2,u=u.filter((Z,k)=>k!==Y))}const me=async()=>{try{if(t(1,g=u.join(",")),_=p.join(","),ue(),await Oe())if(H.value=="delivered"||H.value!=="delivered"&&h.value){const Z={id_route:r.id_route,...!d&&!f&&{id_event:r.id_event},...!d&&!f&&{comments:h.value},...!d&&!f&&{deliver_status:H.value},img:g,img_id:_,lat:b.latitude,lon:b.longitude,...C==="0"&&{approve:"0"},...f&&{isLast:!0},...d&&f&&{destiny:!0}};Z.img&&Z.img_id?X(`${i}api/admin/evidence/send_evidence.php`,function(k){if(k.success==!0){const w=Z.id_route;be(),f&&ke("","",w,f)}else ee("Carga fallida","Actualiza la página y vuelve a intentar cargar la información!")},Z):ee("Información incompleta","Cargar evidencia fotográfica faltante para completar parada.")}else ee("Motivo de status de entrega","Favor de ingresar en notas el motivo por el que la entrega no fue entregada correctamente");else ee("Ubicación faltante","Asegúrate darle permisos a Rutaflow para acceder a tu ubicación")}catch(Y){console.error("Error fetching data:",Y)}},ke=(Y,Z,k,w)=>{n.componentProps.routeId=k,n.componentProps.driverId=r.id_driver,Ue("modal-km-gas",en,{checklist:Y,driverId:Z,routeId:k,isLast:w}).then(j=>{})},Oe=async()=>navigator.geolocation?new Promise((Y,Z)=>{navigator.geolocation.getCurrentPosition(k=>{b.latitude=k.coords.latitude,b.longitude=k.coords.longitude,Y(!0)},k=>{console.error("Error getting location:",k),Y(!1)})}):(console.error("Geolocation is not supported by your browser"),!1);async function we(Y){Y.stopPropagation();let Z=new FormData;Z.append("client_phone",V),Z.append("client_name",r.title),Z.append("delivery_phone",r.client_phone),Z.append("enterprise_name",r.enterprise_name),Z=A(Z);try{const k=await fetch(`${i}api/admin/message_central/send_sms.php`,{method:"POST",body:Z});if(k.ok){const w=await k.json();ee("SMS enviado","Se envío correctamente un SMS a "+r.title+" con número de teléfono: "+V)}else ee("SMS no enviado","Hubo un error al enviar SMS a "+r.title+" con número de teléfono: "+phoneNumber0+". Por favor contacte a soporte.")}catch(k){console.error("Error during file upload:",k)}}const Te=async()=>{if(r.id_enterprise){let Y=new FormData;Y.append("id_enterprise",r.id_enterprise),Y=A(Y);try{const Z=await fetch(`${i}api/admin/enterprise/enterprise_settings.php`,{method:"POST",body:Y});Z.ok?(O=(await Z.json()).nodos,C=Mt("stops_wait_approval",O),t(3,U=Mt("sms_active",O))):console.error("File upload failed:",Z.statusText)}catch(Z){console.error("Error during file upload:",Z)}}};function he(){t(5,F=!1),t(6,q=!0),Ce(r.id_event,"checkin")}function Ne(){t(6,q=!1),t(5,F=!1),Ce(r.id_event,"checkout")}async function Ce(Y,Z){if(Z){let k=new FormData;k.append("type",Z),k.append("id_event",Y),k=A(k);try{const w=await fetch(`${i}api/admin/route/record_check_date.php`,{method:"POST",body:k});if(w.ok){const j=await w.json();j.minutes&&ee("Tiempo por parada","Completaste la parada en "+j.minutes+" minutos.")}else console.error("File upload failed:",w.statusText)}catch(w){console.error("Error during file upload:",w)}finally{}}}const R=Y=>{t(12,D=Y),t(11,y=!0)},J=()=>{t(11,y=!1),t(12,D=null)};function A(Y){return Y.append("token",B.token),Y.append("id_user_over",B.id_user),Y}function G(Y){rn.call(this,l,Y)}function K(Y){Se[Y?"unshift":"push"](()=>{E=Y,t(10,E)})}function P(Y){Se[Y?"unshift":"push"](()=>{h=Y,t(0,h)})}function Q(Y){Se[Y?"unshift":"push"](()=>{H=Y,t(13,H)})}return[h,g,u,U,M,F,q,V,z,S,E,y,D,H,r,f,d,I,ie,ve,be,fe,me,we,he,Ne,R,J,G,K,P,Q,Y=>R(Y),Y=>fe(Y)]}class St extends Je{constructor(e){super(),Ye(this,e,ao,ro,We,{},null,[-1,-1])}}function Dt(l){let e;return{c(){e=s("ion-spinner"),this.h()},l(t){e=c(t,"ION-SPINNER",{name:!0}),m(e).forEach(a),this.h()},h(){v(e,"name","dots")},m(t,i){x(t,e,i)},d(t){t&&a(e)}}}function Pt(l){let e,t,i;return{c(){e=s("section"),t=s("ion-img"),this.h()},l(n){e=c(n,"SECTION",{});var r=m(e);t=c(r,"ION-IMG",{src:!0,alt:!0,style:!0}),m(t).forEach(a),r.forEach(a),this.h()},h(){Ke(t.src,i=l[0])||v(t,"src",i),v(t,"alt","Evidencia fotográfica"),L(t,"max-width","100%"),L(t,"margin-top","16px")},m(n,r){x(n,e,r),o(e,t)},p(n,r){r&1&&!Ke(t.src,i=n[0])&&v(t,"src",i)},d(n){n&&a(e)}}}function so(l){let e,t,i,n,r="Cancelar",f,d,h="AGREGAR GASTO",I,g,_,u,p,b,O,C,U,M,F,q,V,z,S,E,y,D,B='Tipo de pago <ion-text color="danger">(Obligatorio)</ion-text>',H,X,W="Efectivo",ee,ne,ie="Tarjeta",ve,ue,_e="Transferencia",be,fe,me,ke,Oe,we,Te,he,Ne,Ce,R=`<ion-icon icon="${xt}" slot="start"></ion-icon>
                        Subir Evidencia`,J,A,G,K,P,Q,ae,de,Y="Confirmar",Z,k,w=l[5]&&Dt(),j=l[0]&&Pt(l);return{c(){e=s("ion-header"),t=s("ion-toolbar"),i=s("ion-buttons"),n=s("ion-button"),n.textContent=r,f=N(),d=s("ion-title"),d.textContent=h,I=N(),g=s("ion-content"),_=s("ion-list"),u=s("ion-item"),p=s("ion-icon"),b=N(),O=s("ion-input"),C=N(),U=s("ion-item"),M=s("ion-icon"),F=N(),q=s("ion-input"),V=N(),z=s("ion-item"),S=s("ion-icon"),E=N(),y=s("ion-select"),D=s("div"),D.innerHTML=B,H=N(),X=s("ion-select-option"),X.textContent=W,ee=N(),ne=s("ion-select-option"),ne.textContent=ie,ve=N(),ue=s("ion-select-option"),ue.textContent=_e,be=N(),fe=s("ion-item"),me=s("ion-icon"),ke=N(),Oe=s("ion-textarea"),we=N(),Te=s("section"),he=s("label"),Ne=s("ion-button"),Ce=s("label"),Ce.innerHTML=R,J=N(),A=s("input"),G=N(),w&&w.c(),K=N(),j&&j.c(),P=N(),Q=s("ion-footer"),ae=s("ion-toolbar"),de=s("ion-button"),de.textContent=Y,this.h()},l(te){e=c(te,"ION-HEADER",{translucent:!0});var se=m(e);t=c(se,"ION-TOOLBAR",{});var ge=m(t);i=c(ge,"ION-BUTTONS",{slot:!0});var ye=m(i);n=c(ye,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),oe(n)!=="svelte-1f8rjcf"&&(n.textContent=r),ye.forEach(a),f=T(ge),d=c(ge,"ION-TITLE",{title:!0,"data-svelte-h":!0}),oe(d)!=="svelte-efps2s"&&(d.textContent=h),ge.forEach(a),se.forEach(a),I=T(te),g=c(te,"ION-CONTENT",{fullscreen:!0});var le=m(g);_=c(le,"ION-LIST",{});var re=m(_);u=c(re,"ION-ITEM",{});var pe=m(u);p=c(pe,"ION-ICON",{icon:!0,slot:!0}),m(p).forEach(a),b=T(pe),O=c(pe,"ION-INPUT",{label:!0,type:!0,placeholder:!0,value:!0}),m(O).forEach(a),pe.forEach(a),C=T(re),U=c(re,"ION-ITEM",{});var Ae=m(U);M=c(Ae,"ION-ICON",{icon:!0,slot:!0}),m(M).forEach(a),F=T(Ae),q=c(Ae,"ION-INPUT",{label:!0,type:!0,value:!0}),m(q).forEach(a),Ae.forEach(a),V=T(re),z=c(re,"ION-ITEM",{});var Ve=m(z);S=c(Ve,"ION-ICON",{icon:!0,slot:!0}),m(S).forEach(a),E=T(Ve),y=c(Ve,"ION-SELECT",{placeholder:!0,value:!0});var Fe=m(y);D=c(Fe,"DIV",{slot:!0,"data-svelte-h":!0}),oe(D)!=="svelte-wl764p"&&(D.innerHTML=B),H=T(Fe),X=c(Fe,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),oe(X)!=="svelte-i9crym"&&(X.textContent=W),ee=T(Fe),ne=c(Fe,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),oe(ne)!=="svelte-fx0z11"&&(ne.textContent=ie),ve=T(Fe),ue=c(Fe,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),oe(ue)!=="svelte-1c24jf2"&&(ue.textContent=_e),Fe.forEach(a),Ve.forEach(a),be=T(re),fe=c(re,"ION-ITEM",{});var tt=m(fe);me=c(tt,"ION-ICON",{icon:!0,slot:!0}),m(me).forEach(a),ke=T(tt),Oe=c(tt,"ION-TEXTAREA",{label:!0,placeholder:!0}),m(Oe).forEach(a),tt.forEach(a),we=T(re),Te=c(re,"SECTION",{});var ht=m(Te);he=c(ht,"LABEL",{for:!0,style:!0});var pt=m(he);Ne=c(pt,"ION-BUTTON",{fill:!0,size:!0,class:!0,expand:!0});var nt=m(Ne);Ce=c(nt,"LABEL",{for:!0,style:!0,"data-svelte-h":!0}),oe(Ce)!=="svelte-1m9yw22"&&(Ce.innerHTML=R),J=T(nt),A=c(nt,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0}),nt.forEach(a),pt.forEach(a),ht.forEach(a),G=T(re),w&&w.l(re),K=T(re),j&&j.l(re),re.forEach(a),le.forEach(a),P=T(te),Q=c(te,"ION-FOOTER",{});var mt=m(Q);ae=c(mt,"ION-TOOLBAR",{});var vt=m(ae);de=c(vt,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),oe(de)!=="svelte-1c7dl3f"&&(de.textContent=Y),vt.forEach(a),mt.forEach(a),this.h()},h(){v(n,"color","medium"),v(i,"slot","start"),v(d,"title",""),v(e,"translucent",""),v(p,"icon",Zt),v(p,"slot","start"),v(O,"label","Concepto"),v(O,"type","text"),v(O,"placeholder","Escribe aquí..."),v(O,"value",l[6]?l[6]:""),v(M,"icon",st),v(M,"slot","start"),v(q,"label","Cantidad"),v(q,"type","number"),v(q,"value",l[7]?l[7]:""),v(S,"icon",yn),v(S,"slot","start"),$(D,"slot","label"),v(X,"value","cash"),v(ne,"value","card"),v(ue,"value","transfer"),v(y,"placeholder","Tipo de pago"),v(y,"value",l[8]?l[8]:""),v(me,"icon",st),v(me,"slot","start"),v(Oe,"label","Comentarios"),v(Oe,"placeholder","Escribe aquí..."),$(Ce,"for","eventEvidence"),L(Ce,"width","100%"),L(Ce,"padding","8px"),L(A,"display","none"),$(A,"id","eventEvidence"),$(A,"name","fileToUpload"),$(A,"type","file"),$(A,"accept","image/*"),v(Ne,"fill","outline"),v(Ne,"size","small"),v(Ne,"class","loadEvidence"),v(Ne,"expand","block"),$(he,"for","eventEvidence"),L(he,"display","block"),L(he,"width","100%"),v(g,"fullscreen",""),v(de,"fill","outline"),v(de,"color","tertiary"),v(de,"strong",""),L(de,"width","99%"),L(de,"height","auto")},m(te,se){x(te,e,se),o(e,t),o(t,i),o(i,n),o(t,f),o(t,d),x(te,I,se),x(te,g,se),o(g,_),o(_,u),o(u,p),o(u,b),o(u,O),l[12](O),o(_,C),o(_,U),o(U,M),o(U,F),o(U,q),l[13](q),o(_,V),o(_,z),o(z,S),o(z,E),o(z,y),o(y,D),o(y,H),o(y,X),o(y,ee),o(y,ne),o(y,ve),o(y,ue),l[14](y),o(_,be),o(_,fe),o(fe,me),o(fe,ke),o(fe,Oe),l[15](Oe),o(_,we),o(_,Te),o(Te,he),o(he,Ne),o(Ne,Ce),o(Ne,J),o(Ne,A),o(_,G),w&&w.m(_,null),o(_,K),j&&j.m(_,null),x(te,P,se),x(te,Q,se),o(Q,ae),o(ae,de),Z||(k=[ce(n,"click",l[10]),ce(A,"change",l[9]),ce(de,"click",l[11])],Z=!0)},p(te,[se]){te[5]?w||(w=Dt(),w.c(),w.m(_,K)):w&&(w.d(1),w=null),te[0]?j?j.p(te,se):(j=Pt(te),j.c(),j.m(_,null)):j&&(j.d(1),j=null)},i:ze,o:ze,d(te){te&&(a(e),a(I),a(g),a(P),a(Q)),l[12](null),l[13](null),l[14](null),l[15](null),w&&w.d(),j&&j.d(),Z=!1,Be(k)}}}function co(l,e,t){let i=it,n=document.querySelector("ion-modal"),r=n.componentProps.routeId,f=n.componentProps.ex_concept,d=n.componentProps.ex_amount,h=n.componentProps.ex_type,I=n.componentProps.id_expense,g="",_="",u="",p=0,b="",O="",C=!1,U=new Object;Ze(()=>{U=JSON.parse(localStorage.getItem("userSession"))});const M=async(H,X)=>{await(await je.create({header:H||"Error",message:X||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()},F=async H=>{t(5,C=!0);const W=H.target.files[0],ee=await q(W);if(ee){let ne=new FormData;ne.append("fileToUpload",ee),ne=S(ne);try{const ie=await fetch(`${i}api/admin/manager/upload_img_driver.php`,{method:"POST",body:ne});if(ie.ok){const ve=await ie.json();t(0,g=ve.img),_=ve.img_id}else console.error("File upload failed:",ie.statusText)}catch(ie){console.error("Error during file upload:",ie)}finally{t(5,C=!1)}}},q=async H=>new Promise(X=>{const W=new FileReader;W.onload=ee=>{const ne=new Image;ne.src=ee.target.result,ne.onload=()=>{const ie=document.createElement("canvas"),ve=ie.getContext("2d"),ue=800,_e=600;let be=ne.width,fe=ne.height;be>ue&&(fe*=ue/be,be=ue),fe>_e&&(be*=_e/fe,fe=_e),ie.width=be,ie.height=fe,ve.drawImage(ne,0,0,be,fe),ie.toBlob(me=>{X(me)},"image/jpeg",.7)}},W.readAsDataURL(H)}),V=()=>{et.dismiss()},z=()=>{var H=new Object;H.id_route=r,H.comments=b.value,H.type=u.value,H.img=g,H.img_id=_,H.amount=p.value,H.concept=O.value,H.status="done",H.id_expense=I||"null";let X=new FormData;for(const W in H)X.append(W,H[W]);X=S(X),!_||!g||!b.value||!p.value||!O.value?M("Datos incompletos","Llena los datos requeridos para completar el registro"):fetch(`${i}api/admin/expenses/add_expense.php`,{method:"POST",body:X}).then(W=>W.json()).then(W=>{V()}).catch(W=>{console.error("Error fetching data:",W)})};function S(H){return H.append("token",U.token),H.append("id_user_over",U.id_user),H}function E(H){Se[H?"unshift":"push"](()=>{O=H,t(4,O)})}function y(H){Se[H?"unshift":"push"](()=>{p=H,t(2,p)})}function D(H){Se[H?"unshift":"push"](()=>{u=H,t(1,u)})}function B(H){Se[H?"unshift":"push"](()=>{b=H,t(3,b)})}return[g,u,p,b,O,C,f,d,h,F,V,z,E,y,D,B]}class ut extends Je{constructor(e){super(),Ye(this,e,co,so,We,{})}}function Bt(l,e,t){const i=l.slice();return i[7]=e[t],i}function uo(l){let e,t="Cargar gasto",i,n;function r(...f){return l[4](l[7],...f)}return{c(){e=s("ion-button"),e.textContent=t,this.h()},l(f){e=c(f,"ION-BUTTON",{fill:!0,size:!0,"aria-selected":!0,"data-svelte-h":!0}),oe(e)!=="svelte-175aelj"&&(e.textContent=t),this.h()},h(){v(e,"fill","outline"),v(e,"size","small"),v(e,"aria-selected","")},m(f,d){x(f,e,d),i||(n=ce(e,"click",r),i=!0)},p(f,d){l=f},d(f){f&&a(e),i=!1,n()}}}function fo(l){let e,t="Gasto completado";return{c(){e=s("ion-button"),e.textContent=t,this.h()},l(i){e=c(i,"ION-BUTTON",{fill:!0,size:!0,"aria-selected":!0,"data-svelte-h":!0}),oe(e)!=="svelte-tlger7"&&(e.textContent=t),this.h()},h(){v(e,"fill","solid"),v(e,"size","small"),v(e,"aria-selected","")},m(i,n){x(i,e,n)},p:ze,d(i){i&&a(e)}}}function Ht(l,e){let t,i,n,r=e[7].concept+"",f,d,h;function I(u,p){return u[7].status=="done"?fo:uo}let _=I(e)(e);return{key:l,first:null,c(){t=s("ion-item"),i=s("ion-label"),n=s("p"),f=Ee(r),d=N(),_.c(),h=N(),this.h()},l(u){t=c(u,"ION-ITEM",{});var p=m(t);i=c(p,"ION-LABEL",{style:!0});var b=m(i);n=c(b,"P",{style:!0});var O=m(n);f=Ie(O,r),O.forEach(a),b.forEach(a),d=T(p),_.l(p),h=T(p),p.forEach(a),this.h()},h(){L(n,"margin-left","10px"),L(i,"display","flex"),this.first=t},m(u,p){x(u,t,p),o(t,i),o(i,n),o(n,f),o(t,d),_.m(t,null),o(t,h)},p(u,p){e=u,_.p(e,p)},d(u){u&&a(t),_.d()}}}function _o(l){let e,t,i,n,r=`<ion-icon style="font-size: 25px!important;" icon="${wn}"></ion-icon>`,f,d,h="LISTA DE GASTOS",I,g,_,u=[],p=new Map,b,O,C,U="Cerrar",M,F,q=He(l[0]);const V=z=>z[7].id_expenses;for(let z=0;z<q.length;z+=1){let S=Bt(l,q,z),E=V(S);p.set(E,u[z]=Ht(E,S))}return{c(){e=s("ion-header"),t=s("ion-toolbar"),i=s("ion-buttons"),n=s("ion-button"),n.innerHTML=r,f=N(),d=s("ion-title"),d.textContent=h,I=N(),g=s("ion-content"),_=s("ion-list");for(let z=0;z<u.length;z+=1)u[z].c();b=N(),O=s("ion-footer"),C=s("ion-button"),C.textContent=U,this.h()},l(z){e=c(z,"ION-HEADER",{translucent:!0});var S=m(e);t=c(S,"ION-TOOLBAR",{});var E=m(t);i=c(E,"ION-BUTTONS",{slot:!0});var y=m(i);n=c(y,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),oe(n)!=="svelte-160xz3i"&&(n.innerHTML=r),y.forEach(a),f=T(E),d=c(E,"ION-TITLE",{"data-svelte-h":!0}),oe(d)!=="svelte-1phn90x"&&(d.textContent=h),E.forEach(a),S.forEach(a),I=T(z),g=c(z,"ION-CONTENT",{fullscreen:!0});var D=m(g);_=c(D,"ION-LIST",{});var B=m(_);for(let X=0;X<u.length;X+=1)u[X].l(B);B.forEach(a),D.forEach(a),b=T(z),O=c(z,"ION-FOOTER",{});var H=m(O);C=c(H,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),oe(C)!=="svelte-zv7v83"&&(C.textContent=U),H.forEach(a),this.h()},h(){v(n,"color","medium"),v(i,"slot","end"),v(e,"translucent",""),v(g,"fullscreen",""),v(C,"fill","outline"),v(C,"color","tertiary"),v(C,"strong",""),L(C,"width","99%"),L(C,"height","auto")},m(z,S){x(z,e,S),o(e,t),o(t,i),o(i,n),o(t,f),o(t,d),x(z,I,S),x(z,g,S),o(g,_);for(let E=0;E<u.length;E+=1)u[E]&&u[E].m(_,null);x(z,b,S),x(z,O,S),o(O,C),M||(F=[ce(n,"click",l[3]),ce(C,"click",l[1])],M=!0)},p(z,[S]){S&5&&(q=He(z[0]),u=xe(u,S,V,1,z,q,p,_,$e,Ht,null,Bt))},i:ze,o:ze,d(z){z&&(a(e),a(I),a(g),a(b),a(O));for(let S=0;S<u.length;S+=1)u[S].d();M=!1,Be(F)}}}function ho(l){let e=document.querySelector("ion-modal");e.componentProps.routeId;let t=e.componentProps.expenses;Ze(()=>{});const i=()=>{et.dismiss()};function n(d,h,I,g,_){e.componentProps.ex_amount=I,e.componentProps.ex_concept=h,e.componentProps.ex_type=g,e.componentProps.id_expense=_,Ue("modal-expense",ut,{amount:I,concept:h,type:g,id_expense:_}).then(()=>{}),i()}return[t,i,n,d=>{Ue("modal-expense",ut,{routeId:d}).then(h=>{}),i()},(d,h)=>n(h,d.concept,d.amount,d.type,d.id_expenses)]}class po extends Je{constructor(e){super(),Ye(this,e,ho,_o,We,{})}}const{document:Rt}=Pn;function Ut(l,e,t){const i=l.slice();return i[45]=e[t],i[47]=t,i}function Vt(l,e,t){const i=l.slice();return i[45]=e[t],i[47]=t,i}function Ft(l,e,t){const i=l.slice();return i[45]=e[t],i[47]=t,i}function qt(l){let e,t;return e=new Mn({props:{$$slots:{default:[ko]},$$scope:{ctx:l}}}),{c(){fn(e.$$.fragment)},l(i){dn(e.$$.fragment,i)},m(i,n){_n(e,i,n),t=!0},p(i,n){const r={};n[0]&1019|n[1]&524288&&(r.$$scope={dirty:n,ctx:i}),e.$set(r)},i(i){t||(lt(e.$$.fragment,i),t=!0)},o(i){at(e.$$.fragment,i),t=!1},d(i){hn(e,i)}}}function mo(l){let e,t='<div id="g_map" style="width: 100%; height: 100vh;"></div>';return{c(){e=s("ion-content"),e.innerHTML=t},l(i){e=c(i,"ION-CONTENT",{"data-svelte-h":!0}),oe(e)!=="svelte-1ydw6i9"&&(e.innerHTML=t)},m(i,n){x(i,e,n)},p:ze,d(i){i&&a(e)}}}function vo(l){let e;function t(r,f){if(r[7].length>0)return bo;if(!r[3])return go}let i=t(l),n=i&&i(l);return{c(){n&&n.c(),e=De()},l(r){n&&n.l(r),e=De()},m(r,f){n&&n.m(r,f),x(r,e,f)},p(r,f){i===(i=t(r))&&n?n.p(r,f):(n&&n.d(1),n=i&&i(r),n&&(n.c(),n.m(e.parentNode,e)))},d(r){r&&a(e),n&&n.d(r)}}}function go(l){let e,t,i,n='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Jala para actualizar" refreshing-spinner="circles" refreshing-text="Actualizando..."></ion-refresher-content>',r,f,d,h,I,g,_="0",u,p,b,O,C,U=l[6].origin+"",M,F,q,V="",z,S,E,y=[],D=new Map,B,H,X,W,ee,ne=l[5].length+1+"",ie,ve,ue,_e,be,fe,me=l[6].destination+"",ke,Oe,we,Te="",he,Ne,Ce,R,J=l[4]&&jt(l),A=He(l[5]);const G=K=>K[45].id_event;for(let K=0;K<A.length;K+=1){let P=Ut(l,A,K),Q=G(P);D.set(Q,y[K]=Kt(Q,P))}return{c(){J&&J.c(),e=N(),t=s("ion-content"),i=s("ion-refresher"),i.innerHTML=n,r=N(),f=s("ion-list"),d=s("ion-item"),h=s("ion-avatar"),I=s("div"),g=s("div"),g.textContent=_,p=N(),b=s("ion-label"),O=s("ion-text"),C=s("h3"),M=Ee(U),F=N(),q=s("div"),q.innerHTML=V,z=N(),S=s("ion-icon"),E=N();for(let K=0;K<y.length;K+=1)y[K].c();B=N(),H=s("ion-item"),X=s("ion-avatar"),W=s("div"),ee=s("div"),ie=Ee(ne),ue=N(),_e=s("ion-label"),be=s("ion-text"),fe=s("h3"),ke=Ee(me),Oe=N(),we=s("div"),we.innerHTML=Te,he=N(),Ne=s("ion-icon"),this.h()},l(K){J&&J.l(K),e=T(K),t=c(K,"ION-CONTENT",{});var P=m(t);i=c(P,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),oe(i)!=="svelte-1srnbs3"&&(i.innerHTML=n),r=T(P),f=c(P,"ION-LIST",{});var Q=m(f);d=c(Q,"ION-ITEM",{});var ae=m(d);h=c(ae,"ION-AVATAR",{slot:!0});var de=m(h);I=c(de,"DIV",{class:!0,title:!0,style:!0});var Y=m(I);g=c(Y,"DIV",{class:!0,"data-svelte-h":!0}),oe(g)!=="svelte-3lvlrb"&&(g.textContent=_),Y.forEach(a),de.forEach(a),p=T(ae),b=c(ae,"ION-LABEL",{button:!0});var Z=m(b);O=c(Z,"ION-TEXT",{color:!0});var k=m(O);C=c(k,"H3",{});var w=m(C);M=Ie(w,U),w.forEach(a),k.forEach(a),F=T(Z),q=c(Z,"DIV",{class:!0,"data-svelte-h":!0}),oe(q)!=="svelte-gz9kb"&&(q.innerHTML=V),Z.forEach(a),z=T(ae),S=c(ae,"ION-ICON",{icon:!0,slot:!0}),m(S).forEach(a),ae.forEach(a),E=T(Q);for(let pe=0;pe<y.length;pe+=1)y[pe].l(Q);B=T(Q),H=c(Q,"ION-ITEM",{});var j=m(H);X=c(j,"ION-AVATAR",{slot:!0});var te=m(X);W=c(te,"DIV",{class:!0,title:!0,style:!0});var se=m(W);ee=c(se,"DIV",{class:!0});var ge=m(ee);ie=Ie(ge,ne),ge.forEach(a),se.forEach(a),te.forEach(a),ue=T(j),_e=c(j,"ION-LABEL",{button:!0});var ye=m(_e);be=c(ye,"ION-TEXT",{color:!0});var le=m(be);fe=c(le,"H3",{});var re=m(fe);ke=Ie(re,me),re.forEach(a),le.forEach(a),Oe=T(ye),we=c(ye,"DIV",{class:!0,"data-svelte-h":!0}),oe(we)!=="svelte-130ohbs"&&(we.innerHTML=Te),ye.forEach(a),he=T(j),Ne=c(j,"ION-ICON",{icon:!0,slot:!0}),m(Ne).forEach(a),j.forEach(a),Q.forEach(a),P.forEach(a),this.h()},h(){v(i,"slot","fixed"),$(g,"class","order svelte-egzizz"),$(I,"class","order-wrapper svelte-egzizz"),$(I,"title",u="$"+l[6].origin),L(I,"background-color",l[6].color),L(I,"color",Me(l[6].color)),v(h,"slot","start"),v(O,"color","#2e2e2e"),$(q,"class","sub svelte-egzizz"),v(b,"button",""),v(S,"icon",Re),v(S,"slot","end"),$(ee,"class","order svelte-egzizz"),$(W,"class","order-wrapper svelte-egzizz"),$(W,"title",ve="$"+l[6].destination),L(W,"background-color",l[6].color),L(W,"color",Me(l[6].color)),v(X,"slot","start"),v(be,"color","#2e2e2e"),$(we,"class","sub svelte-egzizz"),v(_e,"button",""),v(Ne,"icon",Re),v(Ne,"slot","end")},m(K,P){J&&J.m(K,P),x(K,e,P),x(K,t,P),o(t,i),l[30](i),o(t,r),o(t,f),o(f,d),o(d,h),o(h,I),o(I,g),o(d,p),o(d,b),o(b,O),o(O,C),o(C,M),o(b,F),o(b,q),o(d,z),o(d,S),o(f,E);for(let Q=0;Q<y.length;Q+=1)y[Q]&&y[Q].m(f,null);o(f,B),o(f,H),o(H,X),o(X,W),o(W,ee),o(ee,ie),o(H,ue),o(H,_e),o(_e,be),o(be,fe),o(fe,ke),o(_e,Oe),o(_e,we),o(H,he),o(H,Ne),Ce||(R=[ce(i,"ionRefresh",l[10]),ce(b,"click",l[31]),ce(_e,"click",l[33])],Ce=!0)},p(K,P){K[4]?J?J.p(K,P):(J=jt(K),J.c(),J.m(e.parentNode,e)):J&&(J.d(1),J=null),P[0]&64&&u!==(u="$"+K[6].origin)&&$(I,"title",u),P[0]&64&&L(I,"background-color",K[6].color),P[0]&64&&L(I,"color",Me(K[6].color)),P[0]&64&&U!==(U=K[6].origin+"")&&Le(M,U),P[0]&331808&&(A=He(K[5]),y=xe(y,P,G,1,K,A,D,f,$e,Kt,B,Ut)),P[0]&32&&ne!==(ne=K[5].length+1+"")&&Le(ie,ne),P[0]&64&&ve!==(ve="$"+K[6].destination)&&$(W,"title",ve),P[0]&64&&L(W,"background-color",K[6].color),P[0]&64&&L(W,"color",Me(K[6].color)),P[0]&64&&me!==(me=K[6].destination+"")&&Le(ke,me)},d(K){K&&(a(e),a(t)),J&&J.d(K),l[30](null);for(let P=0;P<y.length;P+=1)y[P].d();Ce=!1,Be(R)}}}function bo(l){let e,t;function i(f,d){return d[0]&144&&(e=null),e==null&&(e=!!(f[7].filter(No).every(To)&&!f[4])),e?Io:Eo}let n=i(l,[-1,-1]),r=n(l);return{c(){r.c(),t=De()},l(f){r.l(f),t=De()},m(f,d){r.m(f,d),x(f,t,d)},p(f,d){n===(n=i(f,d))&&r?r.p(f,d):(r.d(1),r=n(f),r&&(r.c(),r.m(t.parentNode,t)))},d(f){f&&a(t),r.d(f)}}}function jt(l){let e=l[14]("",l[1],l[0])+"",t;return{c(){t=Ee(e)},l(i){t=Ie(i,e)},m(i,n){x(i,t,n)},p(i,n){n[0]&3&&e!==(e=i[14]("",i[1],i[0])+"")&&Le(t,e)},d(i){i&&a(t)}}}function Gt(l){let e;return{c(){e=s("span"),this.h()},l(t){e=c(t,"SPAN",{class:!0}),m(e).forEach(a),this.h()},h(){$(e,"class","notes svelte-egzizz")},m(t,i){x(t,e,i)},d(t){t&&a(e)}}}function Kt(l,e){let t,i,n,r,f=parseInt(e[45].pos)+1+"",d,h,I,g,_,u,p=e[45].title+"",b,O,C=e[45].support_list&&e[45].support_list.length||e[16](e[45]),U,M,F,q,V=C&&Gt();function z(){return e[32](e[45])}return{key:l,first:null,c(){t=s("ion-item"),i=s("ion-avatar"),n=s("div"),r=s("div"),d=Ee(f),I=N(),g=s("ion-label"),_=s("ion-text"),u=s("h3"),b=Ee(p),O=N(),V&&V.c(),U=N(),M=s("ion-icon"),this.h()},l(S){t=c(S,"ION-ITEM",{});var E=m(t);i=c(E,"ION-AVATAR",{slot:!0});var y=m(i);n=c(y,"DIV",{class:!0,title:!0,style:!0});var D=m(n);r=c(D,"DIV",{class:!0});var B=m(r);d=Ie(B,f),B.forEach(a),D.forEach(a),y.forEach(a),I=T(E),g=c(E,"ION-LABEL",{button:!0});var H=m(g);_=c(H,"ION-TEXT",{color:!0});var X=m(_);u=c(X,"H3",{});var W=m(u);b=Ie(W,p),O=T(W),V&&V.l(W),W.forEach(a),X.forEach(a),H.forEach(a),U=T(E),M=c(E,"ION-ICON",{icon:!0,slot:!0,style:!0}),m(M).forEach(a),E.forEach(a),this.h()},h(){$(r,"class","order svelte-egzizz"),$(n,"class","order-wrapper svelte-egzizz"),$(n,"title",h=Xe(e[45].status)),L(n,"background-color",Pe(e[45].status,e[45].date_service)),L(n,"color",Me(Pe(e[45].status))),v(i,"slot","start"),v(_,"color","#2e2e2e"),v(g,"button",""),v(M,"icon",Re),v(M,"slot","end"),L(M,"color",Pe(e[45].status,e[45].date_service)),this.first=t},m(S,E){x(S,t,E),o(t,i),o(i,n),o(n,r),o(r,d),o(t,I),o(t,g),o(g,_),o(_,u),o(u,b),o(u,O),V&&V.m(u,null),o(t,U),o(t,M),F||(q=ce(g,"click",z),F=!0)},p(S,E){e=S,E[0]&32&&f!==(f=parseInt(e[45].pos)+1+"")&&Le(d,f),E[0]&32&&h!==(h=Xe(e[45].status))&&$(n,"title",h),E[0]&32&&L(n,"background-color",Pe(e[45].status,e[45].date_service)),E[0]&32&&L(n,"color",Me(Pe(e[45].status))),E[0]&32&&p!==(p=e[45].title+"")&&Le(b,p),E[0]&32&&(C=e[45].support_list&&e[45].support_list.length||e[16](e[45])),C?V||(V=Gt(),V.c(),V.m(u,null)):V&&(V.d(1),V=null),E[0]&32&&L(M,"color",Pe(e[45].status,e[45].date_service))},d(S){S&&a(t),V&&V.d(),F=!1,q()}}}function Eo(l){let e=l[14](l[7],l[1],l[0])+"",t,i,n,r,f='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Pull to refresh" refreshing-spinner="circles" refreshing-text="Refreshing..."></ion-refresher-content>',d,h,I,g,_,u,p="0",b,O,C,U,M,F=l[6].origin+"",q,V,z,S="",E,y,D,B=[],H=new Map,X,W,ee,ne,ie,ve=l[5].length+1+"",ue,_e,be,fe,me,ke,Oe=l[6].destination+"",we,Te,he,Ne="",Ce,R,J,A,G=He(l[5]);const K=P=>P[45].id_event;for(let P=0;P<G.length;P+=1){let Q=Vt(l,G,P),ae=K(Q);H.set(ae,B[P]=Wt(ae,Q))}return{c(){t=Ee(e),i=N(),n=s("ion-content"),r=s("ion-refresher"),r.innerHTML=f,d=N(),h=s("ion-list"),I=s("ion-item"),g=s("ion-avatar"),_=s("div"),u=s("div"),u.textContent=p,O=N(),C=s("ion-label"),U=s("ion-text"),M=s("h3"),q=Ee(F),V=N(),z=s("div"),z.innerHTML=S,E=N(),y=s("ion-icon"),D=N();for(let P=0;P<B.length;P+=1)B[P].c();X=N(),W=s("ion-item"),ee=s("ion-avatar"),ne=s("div"),ie=s("div"),ue=Ee(ve),be=N(),fe=s("ion-label"),me=s("ion-text"),ke=s("h3"),we=Ee(Oe),Te=N(),he=s("div"),he.innerHTML=Ne,Ce=N(),R=s("ion-icon"),this.h()},l(P){t=Ie(P,e),i=T(P),n=c(P,"ION-CONTENT",{});var Q=m(n);r=c(Q,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),oe(r)!=="svelte-dvt1s"&&(r.innerHTML=f),d=T(Q),h=c(Q,"ION-LIST",{});var ae=m(h);I=c(ae,"ION-ITEM",{});var de=m(I);g=c(de,"ION-AVATAR",{slot:!0});var Y=m(g);_=c(Y,"DIV",{class:!0,title:!0,style:!0});var Z=m(_);u=c(Z,"DIV",{class:!0,"data-svelte-h":!0}),oe(u)!=="svelte-3lvlrb"&&(u.textContent=p),Z.forEach(a),Y.forEach(a),O=T(de),C=c(de,"ION-LABEL",{button:!0});var k=m(C);U=c(k,"ION-TEXT",{color:!0});var w=m(U);M=c(w,"H3",{});var j=m(M);q=Ie(j,F),j.forEach(a),w.forEach(a),V=T(k),z=c(k,"DIV",{class:!0,"data-svelte-h":!0}),oe(z)!=="svelte-gz9kb"&&(z.innerHTML=S),k.forEach(a),E=T(de),y=c(de,"ION-ICON",{icon:!0,slot:!0}),m(y).forEach(a),de.forEach(a),D=T(ae);for(let Ae=0;Ae<B.length;Ae+=1)B[Ae].l(ae);X=T(ae),W=c(ae,"ION-ITEM",{});var te=m(W);ee=c(te,"ION-AVATAR",{slot:!0});var se=m(ee);ne=c(se,"DIV",{class:!0,title:!0,style:!0});var ge=m(ne);ie=c(ge,"DIV",{class:!0});var ye=m(ie);ue=Ie(ye,ve),ye.forEach(a),ge.forEach(a),se.forEach(a),be=T(te),fe=c(te,"ION-LABEL",{button:!0});var le=m(fe);me=c(le,"ION-TEXT",{color:!0});var re=m(me);ke=c(re,"H3",{});var pe=m(ke);we=Ie(pe,Oe),pe.forEach(a),re.forEach(a),Te=T(le),he=c(le,"DIV",{class:!0,"data-svelte-h":!0}),oe(he)!=="svelte-130ohbs"&&(he.innerHTML=Ne),le.forEach(a),Ce=T(te),R=c(te,"ION-ICON",{icon:!0,slot:!0}),m(R).forEach(a),te.forEach(a),ae.forEach(a),Q.forEach(a),this.h()},h(){v(r,"slot","fixed"),$(u,"class","order svelte-egzizz"),$(_,"class","order-wrapper svelte-egzizz"),$(_,"title",b="$"+l[6].origin),L(_,"background-color",l[6].color),L(_,"color",Me(l[6].color)),v(g,"slot","start"),v(U,"color","#2e2e2e"),$(z,"class","sub svelte-egzizz"),v(C,"button",""),v(y,"icon",Re),v(y,"slot","end"),$(ie,"class","order svelte-egzizz"),$(ne,"class","order-wrapper svelte-egzizz"),$(ne,"title",_e="$"+l[6].destination),L(ne,"background-color",l[6].color),L(ne,"color",Me(l[6].color)),v(ee,"slot","start"),v(me,"color","#2e2e2e"),$(he,"class","sub svelte-egzizz"),v(fe,"button",""),v(R,"icon",Re),v(R,"slot","end")},m(P,Q){x(P,t,Q),x(P,i,Q),x(P,n,Q),o(n,r),l[26](r),o(n,d),o(n,h),o(h,I),o(I,g),o(g,_),o(_,u),o(I,O),o(I,C),o(C,U),o(U,M),o(M,q),o(C,V),o(C,z),o(I,E),o(I,y),o(h,D);for(let ae=0;ae<B.length;ae+=1)B[ae]&&B[ae].m(h,null);o(h,X),o(h,W),o(W,ee),o(ee,ne),o(ne,ie),o(ie,ue),o(W,be),o(W,fe),o(fe,me),o(me,ke),o(ke,we),o(fe,Te),o(fe,he),o(W,Ce),o(W,R),J||(A=[ce(r,"ionRefresh",l[10]),ce(C,"click",l[27]),ce(fe,"click",l[29])],J=!0)},p(P,Q){Q[0]&131&&e!==(e=P[14](P[7],P[1],P[0])+"")&&Le(t,e),Q[0]&64&&b!==(b="$"+P[6].origin)&&$(_,"title",b),Q[0]&64&&L(_,"background-color",P[6].color),Q[0]&64&&L(_,"color",Me(P[6].color)),Q[0]&64&&F!==(F=P[6].origin+"")&&Le(q,F),Q[0]&331808&&(G=He(P[5]),B=xe(B,Q,K,1,P,G,H,h,$e,Wt,X,Vt)),Q[0]&32&&ve!==(ve=P[5].length+1+"")&&Le(ue,ve),Q[0]&64&&_e!==(_e="$"+P[6].destination)&&$(ne,"title",_e),Q[0]&64&&L(ne,"background-color",P[6].color),Q[0]&64&&L(ne,"color",Me(P[6].color)),Q[0]&64&&Oe!==(Oe=P[6].destination+"")&&Le(we,Oe)},d(P){P&&(a(t),a(i),a(n)),l[26](null);for(let Q=0;Q<B.length;Q+=1)B[Q].d();J=!1,Be(A)}}}function Io(l){let e,t,i='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Jale para actualizar" refreshing-spinner="circles" refreshing-text="Actualizando..."></ion-refresher-content>',n,r,f,d,h,I,g="0",_,u,p,b,O,C=l[6].origin+"",U,M,F,q="",V,z,S,E=[],y=new Map,D,B,H,X,W,ee=l[5].length+1+"",ne,ie,ve,ue,_e,be,fe=l[6].destination+"",me,ke,Oe,we="",Te,he,Ne,Ce,R=He(l[5]);const J=A=>A[45].id_event;for(let A=0;A<R.length;A+=1){let G=Ft(l,R,A),K=J(G);y.set(K,E[A]=Yt(K,G))}return{c(){e=s("ion-content"),t=s("ion-refresher"),t.innerHTML=i,n=N(),r=s("ion-list"),f=s("ion-item"),d=s("ion-avatar"),h=s("div"),I=s("div"),I.textContent=g,u=N(),p=s("ion-label"),b=s("ion-text"),O=s("h3"),U=Ee(C),M=N(),F=s("div"),F.innerHTML=q,V=N(),z=s("ion-icon"),S=N();for(let A=0;A<E.length;A+=1)E[A].c();D=N(),B=s("ion-item"),H=s("ion-avatar"),X=s("div"),W=s("div"),ne=Ee(ee),ve=N(),ue=s("ion-label"),_e=s("ion-text"),be=s("h3"),me=Ee(fe),ke=N(),Oe=s("div"),Oe.innerHTML=we,Te=N(),he=s("ion-icon"),this.h()},l(A){e=c(A,"ION-CONTENT",{});var G=m(e);t=c(G,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),oe(t)!=="svelte-15ukrgn"&&(t.innerHTML=i),n=T(G),r=c(G,"ION-LIST",{});var K=m(r);f=c(K,"ION-ITEM",{});var P=m(f);d=c(P,"ION-AVATAR",{slot:!0});var Q=m(d);h=c(Q,"DIV",{class:!0,title:!0,style:!0});var ae=m(h);I=c(ae,"DIV",{class:!0,"data-svelte-h":!0}),oe(I)!=="svelte-3lvlrb"&&(I.textContent=g),ae.forEach(a),Q.forEach(a),u=T(P),p=c(P,"ION-LABEL",{button:!0});var de=m(p);b=c(de,"ION-TEXT",{color:!0});var Y=m(b);O=c(Y,"H3",{});var Z=m(O);U=Ie(Z,C),Z.forEach(a),Y.forEach(a),M=T(de),F=c(de,"DIV",{class:!0,"data-svelte-h":!0}),oe(F)!=="svelte-gz9kb"&&(F.innerHTML=q),de.forEach(a),V=T(P),z=c(P,"ION-ICON",{icon:!0,slot:!0}),m(z).forEach(a),P.forEach(a),S=T(K);for(let le=0;le<E.length;le+=1)E[le].l(K);D=T(K),B=c(K,"ION-ITEM",{});var k=m(B);H=c(k,"ION-AVATAR",{slot:!0});var w=m(H);X=c(w,"DIV",{class:!0,title:!0,style:!0});var j=m(X);W=c(j,"DIV",{class:!0});var te=m(W);ne=Ie(te,ee),te.forEach(a),j.forEach(a),w.forEach(a),ve=T(k),ue=c(k,"ION-LABEL",{button:!0});var se=m(ue);_e=c(se,"ION-TEXT",{color:!0});var ge=m(_e);be=c(ge,"H3",{});var ye=m(be);me=Ie(ye,fe),ye.forEach(a),ge.forEach(a),ke=T(se),Oe=c(se,"DIV",{class:!0,"data-svelte-h":!0}),oe(Oe)!=="svelte-130ohbs"&&(Oe.innerHTML=we),se.forEach(a),Te=T(k),he=c(k,"ION-ICON",{icon:!0,slot:!0}),m(he).forEach(a),k.forEach(a),K.forEach(a),G.forEach(a),this.h()},h(){v(t,"slot","fixed"),$(I,"class","order svelte-egzizz"),$(h,"class","order-wrapper svelte-egzizz"),$(h,"title",_="$"+l[6].origin),L(h,"background-color",l[6].color),L(h,"color",Me(l[6].color)),v(d,"slot","start"),v(b,"color","#2e2e2e"),$(F,"class","sub svelte-egzizz"),v(p,"button",""),v(z,"icon",Re),v(z,"slot","end"),$(W,"class","order svelte-egzizz"),$(X,"class","order-wrapper svelte-egzizz"),$(X,"title",ie="$"+l[6].destination),L(X,"background-color",l[6].color),L(X,"color",Me(l[6].color)),v(H,"slot","start"),v(_e,"color","#2e2e2e"),$(Oe,"class","sub svelte-egzizz"),v(ue,"button",""),v(he,"icon",Re),v(he,"slot","end")},m(A,G){x(A,e,G),o(e,t),l[22](t),o(e,n),o(e,r),o(r,f),o(f,d),o(d,h),o(h,I),o(f,u),o(f,p),o(p,b),o(b,O),o(O,U),o(p,M),o(p,F),o(f,V),o(f,z),o(r,S);for(let K=0;K<E.length;K+=1)E[K]&&E[K].m(r,null);o(r,D),o(r,B),o(B,H),o(H,X),o(X,W),o(W,ne),o(B,ve),o(B,ue),o(ue,_e),o(_e,be),o(be,me),o(ue,ke),o(ue,Oe),o(B,Te),o(B,he),Ne||(Ce=[ce(t,"ionRefresh",l[10]),ce(p,"click",l[23]),ce(ue,"click",l[25])],Ne=!0)},p(A,G){G[0]&64&&_!==(_="$"+A[6].origin)&&$(h,"title",_),G[0]&64&&L(h,"background-color",A[6].color),G[0]&64&&L(h,"color",Me(A[6].color)),G[0]&64&&C!==(C=A[6].origin+"")&&Le(U,C),G[0]&331808&&(R=He(A[5]),E=xe(E,G,J,1,A,R,y,r,$e,Yt,D,Ft)),G[0]&32&&ee!==(ee=A[5].length+1+"")&&Le(ne,ee),G[0]&64&&ie!==(ie="$"+A[6].destination)&&$(X,"title",ie),G[0]&64&&L(X,"background-color",A[6].color),G[0]&64&&L(X,"color",Me(A[6].color)),G[0]&64&&fe!==(fe=A[6].destination+"")&&Le(me,fe)},d(A){A&&a(e),l[22](null);for(let G=0;G<E.length;G+=1)E[G].d();Ne=!1,Be(Ce)}}}function Xt(l){let e;return{c(){e=s("span"),this.h()},l(t){e=c(t,"SPAN",{class:!0}),m(e).forEach(a),this.h()},h(){$(e,"class","notes svelte-egzizz")},m(t,i){x(t,e,i)},d(t){t&&a(e)}}}function Wt(l,e){let t,i,n,r,f=parseInt(e[45].pos)+1+"",d,h,I,g,_,u,p=e[45].title+"",b,O,C=e[45].support_list&&e[45].support_list.length||e[16](e[45]),U,M,F="",q,V,z,S,E=C&&Xt();function y(){return e[28](e[45])}return{key:l,first:null,c(){t=s("ion-item"),i=s("ion-avatar"),n=s("div"),r=s("div"),d=Ee(f),I=N(),g=s("ion-label"),_=s("ion-text"),u=s("h3"),b=Ee(p),O=N(),E&&E.c(),U=N(),M=s("div"),M.innerHTML=F,q=N(),V=s("ion-icon"),this.h()},l(D){t=c(D,"ION-ITEM",{});var B=m(t);i=c(B,"ION-AVATAR",{slot:!0});var H=m(i);n=c(H,"DIV",{class:!0,title:!0,style:!0});var X=m(n);r=c(X,"DIV",{class:!0});var W=m(r);d=Ie(W,f),W.forEach(a),X.forEach(a),H.forEach(a),I=T(B),g=c(B,"ION-LABEL",{button:!0});var ee=m(g);_=c(ee,"ION-TEXT",{color:!0});var ne=m(_);u=c(ne,"H3",{});var ie=m(u);b=Ie(ie,p),O=T(ie),E&&E.l(ie),ie.forEach(a),ne.forEach(a),U=T(ee),M=c(ee,"DIV",{class:!0,"data-svelte-h":!0}),oe(M)!=="svelte-qaecoo"&&(M.innerHTML=F),ee.forEach(a),q=T(B),V=c(B,"ION-ICON",{icon:!0,slot:!0}),m(V).forEach(a),B.forEach(a),this.h()},h(){$(r,"class","order svelte-egzizz"),$(n,"class","order-wrapper svelte-egzizz"),$(n,"title",h=Xe(e[45].status)),L(n,"background-color",Pe(e[45].status,e[45].date_service)),L(n,"color",Me(Pe(e[45].status))),v(i,"slot","start"),v(_,"color","#2e2e2e"),$(M,"class","sub svelte-egzizz"),v(g,"button",""),v(V,"icon",Re),v(V,"slot","end"),this.first=t},m(D,B){x(D,t,B),o(t,i),o(i,n),o(n,r),o(r,d),o(t,I),o(t,g),o(g,_),o(_,u),o(u,b),o(u,O),E&&E.m(u,null),o(g,U),o(g,M),o(t,q),o(t,V),z||(S=ce(g,"click",y),z=!0)},p(D,B){e=D,B[0]&32&&f!==(f=parseInt(e[45].pos)+1+"")&&Le(d,f),B[0]&32&&h!==(h=Xe(e[45].status))&&$(n,"title",h),B[0]&32&&L(n,"background-color",Pe(e[45].status,e[45].date_service)),B[0]&32&&L(n,"color",Me(Pe(e[45].status))),B[0]&32&&p!==(p=e[45].title+"")&&Le(b,p),B[0]&32&&(C=e[45].support_list&&e[45].support_list.length||e[16](e[45])),C?E||(E=Xt(),E.c(),E.m(u,null)):E&&(E.d(1),E=null)},d(D){D&&a(t),E&&E.d(),z=!1,S()}}}function Jt(l){let e;return{c(){e=s("span"),this.h()},l(t){e=c(t,"SPAN",{class:!0}),m(e).forEach(a),this.h()},h(){$(e,"class","notes svelte-egzizz")},m(t,i){x(t,e,i)},d(t){t&&a(e)}}}function Yt(l,e){let t,i,n,r,f=parseInt(e[45].pos)+1+"",d,h,I,g,_,u,p=e[45].title+"",b,O,C=e[45].support_list&&e[45].support_list.length||e[16](e[45]),U,M,F="",q,V,z,S,E=C&&Jt();function y(){return e[24](e[45])}return{key:l,first:null,c(){t=s("ion-item"),i=s("ion-avatar"),n=s("div"),r=s("div"),d=Ee(f),I=N(),g=s("ion-label"),_=s("ion-text"),u=s("h3"),b=Ee(p),O=N(),E&&E.c(),U=N(),M=s("div"),M.innerHTML=F,q=N(),V=s("ion-icon"),this.h()},l(D){t=c(D,"ION-ITEM",{});var B=m(t);i=c(B,"ION-AVATAR",{slot:!0});var H=m(i);n=c(H,"DIV",{class:!0,title:!0,style:!0});var X=m(n);r=c(X,"DIV",{class:!0});var W=m(r);d=Ie(W,f),W.forEach(a),X.forEach(a),H.forEach(a),I=T(B),g=c(B,"ION-LABEL",{button:!0});var ee=m(g);_=c(ee,"ION-TEXT",{color:!0});var ne=m(_);u=c(ne,"H3",{});var ie=m(u);b=Ie(ie,p),O=T(ie),E&&E.l(ie),ie.forEach(a),ne.forEach(a),U=T(ee),M=c(ee,"DIV",{class:!0,"data-svelte-h":!0}),oe(M)!=="svelte-qaecoo"&&(M.innerHTML=F),ee.forEach(a),q=T(B),V=c(B,"ION-ICON",{icon:!0,slot:!0}),m(V).forEach(a),B.forEach(a),this.h()},h(){$(r,"class","order svelte-egzizz"),$(n,"class","order-wrapper svelte-egzizz"),$(n,"title",h=Xe(e[45].status)),L(n,"background-color",Pe(e[45].status,e[45].date_service)),L(n,"color",Me(Pe(e[45].status))),v(i,"slot","start"),v(_,"color","#2e2e2e"),$(M,"class","sub svelte-egzizz"),v(g,"button",""),v(V,"icon",Re),v(V,"slot","end"),this.first=t},m(D,B){x(D,t,B),o(t,i),o(i,n),o(n,r),o(r,d),o(t,I),o(t,g),o(g,_),o(_,u),o(u,b),o(u,O),E&&E.m(u,null),o(g,U),o(g,M),o(t,q),o(t,V),z||(S=ce(g,"click",y),z=!0)},p(D,B){e=D,B[0]&32&&f!==(f=parseInt(e[45].pos)+1+"")&&Le(d,f),B[0]&32&&h!==(h=Xe(e[45].status))&&$(n,"title",h),B[0]&32&&L(n,"background-color",Pe(e[45].status,e[45].date_service)),B[0]&32&&L(n,"color",Me(Pe(e[45].status))),B[0]&32&&p!==(p=e[45].title+"")&&Le(b,p),B[0]&32&&(C=e[45].support_list&&e[45].support_list.length||e[16](e[45])),C?E||(E=Jt(),E.c(),E.m(u,null)):E&&(E.d(1),E=null)},d(D){D&&a(t),E&&E.d(),z=!1,S()}}}function ko(l){let e,t,i,n,r=`<ion-icon icon="${Ln}"></ion-icon>`,f,d,h,I=`<ion-icon icon="${zn}"></ion-icon>`,g,_,u=(l[6].name?l[6].name.toUpperCase():"")+"",p,b,O,C='<ion-segment-button value="list"><ion-label>Paradas</ion-label></ion-segment-button> <ion-segment-button value="map"><ion-label>Mapa</ion-label></ion-segment-button>',U,M,F,q;function V(E,y){if(E[9]==="list")return vo;if(E[9]==="map")return mo}let z=V(l),S=z&&z(l);return{c(){e=s("ion-header"),t=s("ion-toolbar"),i=s("ion-buttons"),n=s("ion-button"),n.innerHTML=r,f=N(),d=s("ion-buttons"),h=s("ion-button"),h.innerHTML=I,g=N(),_=s("ion-title"),p=Ee(u),b=N(),O=s("ion-segment"),O.innerHTML=C,U=N(),S&&S.c(),M=De(),this.h()},l(E){e=c(E,"ION-HEADER",{translucent:!0});var y=m(e);t=c(y,"ION-TOOLBAR",{});var D=m(t);i=c(D,"ION-BUTTONS",{slot:!0});var B=m(i);n=c(B,"ION-BUTTON",{title:!0,alt:!0,"data-svelte-h":!0}),oe(n)!=="svelte-7ppz3r"&&(n.innerHTML=r),B.forEach(a),f=T(D),d=c(D,"ION-BUTTONS",{slot:!0});var H=m(d);h=c(H,"ION-BUTTON",{"data-svelte-h":!0}),oe(h)!=="svelte-nf50hj"&&(h.innerHTML=I),H.forEach(a),g=T(D),_=c(D,"ION-TITLE",{});var X=m(_);p=Ie(X,u),X.forEach(a),D.forEach(a),b=T(y),O=c(y,"ION-SEGMENT",{value:!0,"data-svelte-h":!0}),oe(O)!=="svelte-lue4c9"&&(O.innerHTML=C),y.forEach(a),U=T(E),S&&S.l(E),M=De(),this.h()},h(){v(n,"title","Atrás"),v(n,"alt","Atrás"),v(i,"slot","start"),v(d,"slot","end"),v(O,"value","list"),v(e,"translucent","")},m(E,y){x(E,e,y),o(e,t),o(t,i),o(i,n),o(t,f),o(t,d),o(d,h),o(t,g),o(t,_),o(_,p),o(e,b),o(e,O),x(E,U,y),S&&S.m(E,y),x(E,M,y),F||(q=[ce(n,"click",l[17]),ce(h,"click",l[20]),ce(O,"ionChange",l[21])],F=!0)},p(E,y){y[0]&64&&u!==(u=(E[6].name?E[6].name.toUpperCase():"")+"")&&Le(p,u),z===(z=V(E))&&S?S.p(E,y):(S&&S.d(1),S=z&&z(E),S&&(S.c(),S.m(M.parentNode,M)))},d(E){E&&(a(e),a(U),a(M)),S&&S.d(E),F=!1,Be(q)}}}function Oo(l){let e,t,i,n=l[2]&&qt(l);return{c(){e=N(),n&&n.c(),t=De(),this.h()},l(r){an("svelte-kn0kph",Rt.head).forEach(a),e=T(r),n&&n.l(r),t=De(),this.h()},h(){Rt.title="Rutaflow - Detalles de ruta"},m(r,f){x(r,e,f),n&&n.m(r,f),x(r,t,f),i=!0},p(r,f){r[2]?n?(n.p(r,f),f[0]&4&&lt(n,1)):(n=qt(r),n.c(),lt(n,1),n.m(t.parentNode,t)):n&&(pn(),at(n,1,1,()=>{n=null}),un())},i(r){i||(lt(n),i=!0)},o(r){at(n),i=!1},d(r){r&&(a(e),a(t)),n&&n.d(r)}}}function Pe(l,e=""){let t="#ffffff";return l==="pending"&&!e?t="#f2e300":l=="pending"&&e?t="#F6A833":l==="completed"&&(t="#44d900"),t}function Xe(l){let e="";return l=="pending"?e="Pendiente":l=="completed"&&(e="Completado"),e}function Me(l){l.slice(0,1)==="#"&&(l=l.slice(1)),l.length===3&&(l=l.split("").map(function(r){return r+r}).join(""));const e=parseInt(l.substr(0,2),16),t=parseInt(l.substr(2,2),16),i=parseInt(l.substr(4,2),16);return(e*299+t*587+i*114)/1e3>=128?"#414040":"#fff"}const No=l=>l.mandatory==="1",To=l=>l.img;function Co(l,e,t){let i;sn(l,An,R=>t(19,i=R));var n=this&&this.__awaiter||function(R,J,A,G){function K(P){return P instanceof A?P:new A(function(Q){Q(P)})}return new(A||(A=Promise))(function(P,Q){function ae(Z){try{Y(G.next(Z))}catch(k){Q(k)}}function de(Z){try{Y(G.throw(Z))}catch(k){Q(k)}}function Y(Z){Z.done?P(Z.value):K(Z.value).then(ae,de)}Y((G=G.apply(R,J||[])).next())})};let{routeId:r}=e,{driverId:f}=e,d=it,h=new Object,I=!0,g=!1,_=[],u={},p=[],b=[],O,C=!1,U="list",M;const F=()=>n(void 0,void 0,void 0,function*(){yield z(r),O.complete()});Ze(()=>n(void 0,void 0,void 0,function*(){yield z(r)}));function q(R){return n(this,void 0,void 0,function*(){if(t(9,U=R),U==="map"){yield cn(),M=document.getElementById("g_map");const J=new google.maps.Map(M,{zoom:8,center:{lat:20.6745683,lng:-103.3986104},mapId:"4504f8b37365c3d0"}),A=new google.maps.LatLngBounds,{AdvancedMarkerElement:G,PinElement:K}=yield google.maps.importLibrary("marker");navigator.geolocation?navigator.geolocation.getCurrentPosition(function(P){const Q=new google.maps.LatLng(P.coords.latitude,P.coords.longitude);new google.maps.Marker({position:Q,map:J,icon:{path:google.maps.SymbolPath.CIRCLE,fillColor:"#0062ff",fillOpacity:1,scale:6,strokeColor:"#ffffff",strokeWeight:2}}),new google.maps.Circle({strokeColor:"#00BFFF",strokeOpacity:.5,strokeWeight:1,fillColor:"#00BFFF",fillOpacity:.2,map:J,center:Q,radius:P.coords.accuracy}),A.extend(Q)},function(P){console.error("Error retrieving location:",P)}):console.error("Geolocation not supported by this browser."),u.lat1===u.lat2&&u.lon1===u.lon2?V(A,J,{lat:u.lat2,lon:u.lon2,color:u.color,title:u.destination},{type:"icon",iconClass:"icon-home",title:"Origen/Destino",glyph:`0,${String(_.length+1)}`}):(V(A,J,{lat:u.lat1,lon:u.lon1,color:u.color,title:u.origin},{type:"icon",iconClass:"icon-home",title:"Origen",glyph:"0"}),V(A,J,{lat:u.lat2,lon:u.lon2,color:u.color,title:u.destination},{type:"icon",iconClass:"icon-flag",title:"Destino",glyph:String(_.length+1)})),_.forEach((P,Q)=>{const ae=parseFloat(P.lat),de=parseFloat(P.lon),Y=new google.maps.LatLng(ae,de),Z=new google.maps.Marker({position:{lat:ae,lng:de},map:J,title:P.title}),k=new K({background:Pe(P.status,P.date_service),borderColor:"#000",glyphColor:"#000",glyph:(parseInt(P.pos)+1).toString()});new G({map:J,position:Y,content:k.element,title:"Parada "+(parseInt(P.pos)+1).toString()+": "+P.title}).addListener("click",function(j){E(P,!1)}),A.extend(Z.getPosition())}),J.fitBounds(A)}})}function V(R,J,A,G){return n(this,void 0,void 0,function*(){let K;const P=parseFloat(A.lat),Q=parseFloat(A.lon),ae=new google.maps.LatLng(P,Q),{AdvancedMarkerElement:de,PinElement:Y}=yield google.maps.importLibrary("marker");G.type=="icon"?(K=document.createElement("i"),K.className=`${G.iconClass} icon`,K.style.fontSize="14px",K.style.color=Me(A.color),K.style.fontWeight="600"):G.type=="text";const Z=new google.maps.Marker({position:{lat:P,lng:Q},map:J,title:`${G.title}. ${A.title}`}),k=new Y({background:A.color,borderColor:"#000",glyphColor:Me(A.color),glyph:G.glyph});return new de({map:J,position:ae,content:k.element,title:G.title+": "+A.title}).addListener("click",function(j){y(u,G.title=="Destino"||G.title=="Origen/Destino")}),Z})}function z(R){return n(this,void 0,void 0,function*(){let J=new FormData;J.append("id_route",R),J=ne(J);try{const G=yield(yield fetch(`${d}api/admin/report/seguimiento_list.php`,{method:"POST",body:J})).json();t(6,u=G.data.seguimiento_list[0]),t(5,_=G.data.event_list),t(7,p=G.data.checklist),b=G.data.expenses,u&&t(4,g=u.km_inicial=="0"&&u.gas_inicial=="0"),t(3,I=!1)}catch(A){t(3,I=!1),console.error("Error fetching data:",A)}})}const S=R=>new Promise((J,A)=>{let G=new FormData;G.append("id_route",R.id_route),G.append("id_event",R.id_event),G=ne(G),fetch(`${d}api/admin/evidence/evidence_by_event.php`,{method:"POST",body:G}).then(K=>K.json()).then(K=>{J(K.data.event_evidence[0])}).catch(K=>{console.error("Error fetching data:",K),A(K)})}),E=(R,J)=>{S(R).then(A=>{A&&(R.img=A.img,R.driver_comments=A.driver_comments,R.comments=A.comments),Ue("modal-delivery-info",St,{delivery:R,isLast:J}).then(G=>{}).finally(()=>{z(r)})})},y=(R,J)=>{var A=new Object;J?A={title:R.destination,line1:R.dest_address}:A={title:R.origin,line1:R.origin_address},A.client_name=R.client_name,A.client_phone=R.tel,A.id_route=R.id_route;var G=!0;Ue("modal-delivery-info",St,{delivery:A,isLast:J,flag:G})},D=(R,J,A)=>{var G=!1;return C||(C=!0,Ue("modal-checklist",en,{checklist:R,driverId:J,routeId:A,isLast:G}).then(K=>{C=!1}),X(A,"checklist")),""},B=R=>n(void 0,void 0,void 0,function*(){return yield z(R),b.length>0?Ue("modal-expense-detail",po,{routeId:R,expenses:b}).then(J=>{}):Ue("modal-expense",ut,{routeId:R}).then(J=>{}),""}),H=R=>{if(R.tracking_type=="subscription"){if(R.subscriber_info&&R.payment_type==="cash"&&new Date(R.subscriber_info.payment_next)<new Date)return!0}else if(R.tracking_type=="ecommerce"&&Number(R.payment_pending)>0)return!0;return!1};function X(R,J){let A=new FormData;return A.append("id_route",R),A.append("status",J),A=ne(A),fetch(`${d}api/admin/route/change_status.php`,{method:"POST",body:A}).then(G=>G.json()).then(G=>{}).catch(G=>{console.error("Error fetching data:",G)}),""}const W=()=>{h.type=="super"||h.type=="admin"?qe("/drivers/me"):h.id_driver&&qe(`/drivers/${h.id_driver}`)},ee=(R,J)=>n(void 0,void 0,void 0,function*(){yield(yield je.create({header:R||"Error",message:J||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()});function ne(R){return R.append("token",h.token),R.append("id_user_over",h.id_user),R}const ie=()=>B(r),ve=R=>q(R.detail.value);function ue(R){Se[R?"unshift":"push"](()=>{O=R,t(8,O)})}const _e=()=>{y(u,!1)},be=R=>{const J=_.findIndex(Q=>Q.id_event===R.id_event),A=J===0,G=J>0?_[J-1]:null,K=A||G&&G.img!==null,P=R.img!==null&&R.img!=="";K||A&&!P?E(R,!1):ee("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")},fe=()=>{y(u,!0)};function me(R){Se[R?"unshift":"push"](()=>{O=R,t(8,O)})}const ke=()=>{y(u,!1)},Oe=R=>{const J=_.findIndex(Q=>Q.id_event===R.id_event),A=J===0,G=J>0?_[J-1]:null,K=A||G&&G.img!==null,P=R.img!==null&&R.img!=="";K||A&&!P?E(R,!1):ee("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")},we=()=>{y(u,!0)};function Te(R){Se[R?"unshift":"push"](()=>{O=R,t(8,O)})}const he=()=>{y(u,!1)},Ne=R=>{const J=_.findIndex(Q=>Q.id_event===R.id_event),A=J===0,G=J>0?_[J-1]:null,K=A||G&&G.img!==null,P=R.img!==null&&R.img!=="";K||A&&!P?E(R,!1):ee("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")},Ce=()=>{y(u,!0)};return l.$$set=R=>{"routeId"in R&&t(0,r=R.routeId),"driverId"in R&&t(1,f=R.driverId)},l.$$.update=()=>{l.$$.dirty[0]&524293&&(t(0,{routeId:r,driverId:f}=i.params,r,(t(1,f),t(19,i),t(2,h),t(0,r))),t(2,h=JSON.parse(localStorage.getItem("userSession"))),h?h.id_user&&(h.type=="admin"||h.type=="super")?(z(r),qe(`/drivers/me/routes/${r}`)):h.id_user&&h.id_driver&&(z(r),qe(`/drivers/${h.id_driver}/routes/${r}`)):qe("/"))},[r,f,h,I,g,_,u,p,O,U,F,q,E,y,D,B,H,W,ee,i,ie,ve,ue,_e,be,fe,me,ke,Oe,we,Te,he,Ne,Ce]}class Do extends Je{constructor(e){super(),Ye(this,e,Co,Oo,We,{routeId:0,driverId:1},null,[-1,-1])}}export{Do as component};

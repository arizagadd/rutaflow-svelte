import{Z as ht,s as Je,e as s,j as y,b as c,q as m,d as ne,h as a,m as w,v as g,i as K,w as r,x as se,n as ze,z as He,_ as en,B as b,o as xe,k as Se,$ as pt,t as _e,r as he,f as G,a0 as tn,a1 as Ze,A as De,y as we,a2 as nn,a3 as Xe,a4 as on,a5 as ln,l as rn,p as an,F as sn}from"../chunks/index.CdEBkEwf.js";import{S as Ye,i as Qe,t as rt,a as ut,c as cn,b as un,d as fn,m as dn,e as _n,g as hn}from"../chunks/index.Dw8w8a4z.js";import{e as Re,u as $e,d as et,a as pn,c as mn,i as Jt,b as vn,f as Yt,g as gn,h as bn,j as ft,k as En,m as Qt,n as Zt,s as mt,o as Ue,q as kn,r as In,t as On,v as Nn,w as Tn,x as Cn,y as yn,z as wn,p as Ln}from"../chunks/index.h4YCQnSM.js";import"../chunks/index-6e05b96e.C_9q9BoX.js";import{m as tt,D as at,a as qe,I as zn}from"../chunks/IonPage.CVwoZG8Y.js";import{q as An,t as Mn}from"../chunks/ion-modal.BYMRzj9z.js";import{g as je}from"../chunks/entry.D6I6KACp.js";const Sn=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global,Dn=(o,e)=>{if(!customElements.get(o)){class t extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const n={};for(const i of this.attributes)n[i.name]=i.value;new e({target:this.shadowRoot,props:n})}}customElements.define(o,t)}},Pn=function(o){return document.createElement(o).constructor!==HTMLElement},Hn=(o,e)=>{Pn(o)||Dn(o,e)},Ve=async(o,e,t)=>{An(),Mn(),Hn(o,e);const l=await tt.create({component:o,componentProps:t});return l.present(),await l.onWillDismiss()};let Ke=ht({km_inicial:[],gas_inicial:[],km_final:[],gas_final:[]}),xt=ht({flag:[]});function Bn(o){let e,t,l,n,i="Cancelar",d,u,_="Captura de Km/Gas",I,E,h,f="Confirmar",v,k,N,L,U,B,j;return{c(){e=s("ion-header"),t=s("ion-toolbar"),l=s("ion-buttons"),n=s("ion-button"),n.textContent=i,d=y(),u=s("ion-title"),u.textContent=_,I=y(),E=s("ion-buttons"),h=s("ion-button"),h.textContent=f,v=y(),k=s("ion-content"),N=s("ion-item"),L=s("ion-input"),this.h()},l(F){e=c(F,"ION-HEADER",{translucent:!0});var W=m(e);t=c(W,"ION-TOOLBAR",{});var H=m(t);l=c(H,"ION-BUTTONS",{slot:!0});var C=m(l);n=c(C,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),ne(n)!=="svelte-17pq4f4"&&(n.textContent=i),C.forEach(a),d=w(H),u=c(H,"ION-TITLE",{"data-svelte-h":!0}),ne(u)!=="svelte-1yhkaq7"&&(u.textContent=_),I=w(H),E=c(H,"ION-BUTTONS",{slot:!0});var S=m(E);h=c(S,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),ne(h)!=="svelte-cm6j4s"&&(h.textContent=f),S.forEach(a),H.forEach(a),W.forEach(a),v=w(F),k=c(F,"ION-CONTENT",{fullscreen:!0});var A=m(k);N=c(A,"ION-ITEM",{});var P=m(N);L=c(P,"ION-INPUT",{class:!0,inputmode:!0,pattern:!0,type:!0,placeholder:!0,value:!0,required:!0});var V=m(L);V.forEach(a),P.forEach(a),A.forEach(a),this.h()},h(){g(n,"color","medium"),g(l,"slot","start"),g(h,"strong",""),g(E,"slot","end"),g(e,"translucent",""),g(L,"class","fin-km"),g(L,"inputmode","numeric"),g(L,"pattern","[0-9]*"),g(L,"type","number"),g(L,"placeholder",U="Ingresa "+o[0]+" actual"),g(L,"value",o[1]),g(L,"required",""),g(k,"fullscreen","")},m(F,W){K(F,e,W),r(e,t),r(t,l),r(l,n),r(t,d),r(t,u),r(t,I),r(t,E),r(E,h),K(F,v,W),K(F,k,W),r(k,N),r(N,L),B||(j=[se(n,"click",o[2]),se(h,"click",o[3]),se(L,"input",o[4])],B=!0)},p(F,[W]){W&1&&U!==(U="Ingresa "+F[0]+" actual")&&g(L,"placeholder",U),W&2&&g(L,"value",F[1])},i:ze,o:ze,d(F){F&&(a(e),a(v),a(k)),B=!1,He(j)}}}function Rn(o,e,t){const l=en();let i=document.querySelector("ion-modal").componentProps.data_type,d="";xt.subscribe(h=>{i=h.flag[0],i=="km_final"||i=="km_inicial"?t(0,d="kilometraje"):t(0,d="litros de gasolina")});let u=0;function _(){tt.dismiss()}function I(){l("modalResult",{data:"Your data",role:"confirm"}),i=="km_inicial"?Ke.update(f=>({...f,km_inicial:[u]})):i=="gas_inicial"?Ke.update(f=>({...f,gas_inicial:[u]})):i=="km_final"?Ke.update(f=>({...f,km_final:[u]})):i=="gas_final"&&Ke.update(f=>({...f,gas_final:[u]})),_()}return[d,u,_,I,h=>t(1,u=h.target.value)]}class Un extends Ye{constructor(e){super(),Qe(this,e,Rn,Bn,Je,{})}}const st=ht({items:[],checkedIndices:[],mandatory:[]});function bt(o,e,t){const l=o.slice();return l[55]=e[t],l[56]=e,l[57]=t,l}function Vn(o){let e,t,l,n,i,d="Kilometraje inicial",u,_,I=o[0]?o[0]+" km.":"Cargar km",E,h,f,v,k,N,L,U="Gasolina inicial (litros)",B,j,F=o[1]?o[1]+" litros":"Cargar gas",W,H,C,S;return H=pt(o[21][0]),{c(){e=s("ion-item"),t=s("ion-label"),l=s("input"),n=y(),i=s("p"),i.textContent=d,u=y(),_=s("ion-button"),E=_e(I),h=y(),f=s("ion-item"),v=s("ion-label"),k=s("input"),N=y(),L=s("p"),L.textContent=U,B=y(),j=s("ion-button"),W=_e(F),this.h()},l(A){e=c(A,"ION-ITEM",{});var P=m(e);t=c(P,"ION-LABEL",{style:!0});var V=m(t);l=c(V,"INPUT",{id:!0,style:!0,type:!0}),n=w(V),i=c(V,"P",{style:!0,"data-svelte-h":!0}),ne(i)!=="svelte-88twxi"&&(i.textContent=d),V.forEach(a),u=w(P),_=c(P,"ION-BUTTON",{fill:!0,size:!0,class:!0,"aria-selected":!0});var M=m(_);E=he(M,I),M.forEach(a),P.forEach(a),h=w(A),f=c(A,"ION-ITEM",{});var D=m(f);v=c(D,"ION-LABEL",{style:!0});var R=m(v);k=c(R,"INPUT",{id:!0,style:!0,type:!0}),N=w(R),L=c(R,"P",{style:!0,"data-svelte-h":!0}),ne(L)!=="svelte-1ux30eb"&&(L.textContent=U),R.forEach(a),B=w(D),j=c(D,"ION-BUTTON",{fill:!0,class:!0,size:!0,style:!0});var x=m(j);W=he(x,F),x.forEach(a),D.forEach(a),this.h()},h(){G(l,"id","chkbox-km-ini"),b(l,"pointer-events","auto"),G(l,"type","checkbox"),l.required=!0,b(i,"margin-left","10px"),b(t,"display","flex"),g(_,"fill","outline"),g(_,"size","small"),g(_,"class","loadKmInicial"),g(_,"aria-selected",""),G(k,"id","chkbox-gas-ini"),b(k,"pointer-events","auto"),G(k,"type","checkbox"),k.required=!0,b(L,"margin-left","10px"),b(v,"display","flex"),g(j,"fill","outline"),g(j,"class","loadGasInicial"),g(j,"size","small"),b(j,"height","16px "),H.p(l,k)},m(A,P){K(A,e,P),r(e,t),r(t,l),l.checked=~(o[4]||[]).indexOf(l.__value),o[28](l),r(t,n),r(t,i),r(e,u),r(e,_),r(_,E),K(A,h,P),K(A,f,P),r(f,v),r(v,k),o[30](k),k.checked=~(o[4]||[]).indexOf(k.__value),r(v,N),r(v,L),r(f,B),r(f,j),r(j,W),C||(S=[se(l,"change",o[27]),se(_,"click",o[29]),se(k,"change",o[31]),se(j,"click",o[32])],C=!0)},p(A,P){P[0]&16&&(l.checked=~(A[4]||[]).indexOf(l.__value)),P[0]&1&&I!==(I=A[0]?A[0]+" km.":"Cargar km")&&we(E,I),P[0]&16&&(k.checked=~(A[4]||[]).indexOf(k.__value)),P[0]&2&&F!==(F=A[1]?A[1]+" litros":"Cargar gas")&&we(W,F)},d(A){A&&(a(e),a(h),a(f)),o[28](null),o[30](null),H.r(),C=!1,He(S)}}}function Fn(o){let e,t,l,n,i,d="Kilometraje final",u,_,I=o[2]?o[2]+" km.":"Cargar km",E,h,f,v,k,N,L,U="Gasolina final (litros)",B,j,F=o[3]?o[3]+" litros":"Cargar gas",W,H,C,S;return H=pt(o[21][0]),{c(){e=s("ion-item"),t=s("ion-label"),l=s("input"),n=y(),i=s("p"),i.textContent=d,u=y(),_=s("ion-button"),E=_e(I),h=y(),f=s("ion-item"),v=s("ion-label"),k=s("input"),N=y(),L=s("p"),L.textContent=U,B=y(),j=s("ion-button"),W=_e(F),this.h()},l(A){e=c(A,"ION-ITEM",{});var P=m(e);t=c(P,"ION-LABEL",{style:!0});var V=m(t);l=c(V,"INPUT",{id:!0,style:!0,type:!0}),n=w(V),i=c(V,"P",{style:!0,"data-svelte-h":!0}),ne(i)!=="svelte-ccmu71"&&(i.textContent=d),V.forEach(a),u=w(P),_=c(P,"ION-BUTTON",{fill:!0,size:!0,class:!0,"aria-selected":!0});var M=m(_);E=he(M,I),M.forEach(a),P.forEach(a),h=w(A),f=c(A,"ION-ITEM",{});var D=m(f);v=c(D,"ION-LABEL",{style:!0});var R=m(v);k=c(R,"INPUT",{id:!0,style:!0,type:!0}),N=w(R),L=c(R,"P",{style:!0,"data-svelte-h":!0}),ne(L)!=="svelte-wsoyd2"&&(L.textContent=U),R.forEach(a),B=w(D),j=c(D,"ION-BUTTON",{fill:!0,size:!0,class:!0});var x=m(j);W=he(x,F),x.forEach(a),D.forEach(a),this.h()},h(){G(l,"id","chkbox-km-fin"),b(l,"pointer-events","auto"),G(l,"type","checkbox"),l.required=!0,b(i,"margin-left","10px"),b(t,"display","flex"),g(_,"fill","outline"),g(_,"size","small"),g(_,"class","loadKmInicial"),g(_,"aria-selected",""),G(k,"id","chkbox-gas-fin"),b(k,"pointer-events","auto"),G(k,"type","checkbox"),k.required=!0,b(L,"margin-left","10px"),b(v,"display","flex"),g(j,"fill","outline"),g(j,"size","small"),g(j,"class","loadGasInicial"),H.p(l,k)},m(A,P){K(A,e,P),r(e,t),r(t,l),l.checked=~(o[4]||[]).indexOf(l.__value),o[22](l),r(t,n),r(t,i),r(e,u),r(e,_),r(_,E),K(A,h,P),K(A,f,P),r(f,v),r(v,k),k.checked=~(o[4]||[]).indexOf(k.__value),o[25](k),r(v,N),r(v,L),r(f,B),r(f,j),r(j,W),C||(S=[se(l,"change",o[20]),se(_,"click",o[23]),se(k,"change",o[24]),se(j,"click",o[26])],C=!0)},p(A,P){P[0]&16&&(l.checked=~(A[4]||[]).indexOf(l.__value)),P[0]&4&&I!==(I=A[2]?A[2]+" km.":"Cargar km")&&we(E,I),P[0]&16&&(k.checked=~(A[4]||[]).indexOf(k.__value)),P[0]&8&&F!==(F=A[3]?A[3]+" litros":"Cargar gas")&&we(W,F)},d(A){A&&(a(e),a(h),a(f)),o[22](null),o[25](null),H.r(),C=!1,He(S)}}}function jn(o){let e=[],t=new Map,l,n=Re(o[13]);const i=d=>d[55].id_checklist_event;for(let d=0;d<n.length;d+=1){let u=bt(o,n,d),_=i(u);t.set(_,e[d]=Et(_,u))}return{c(){for(let d=0;d<e.length;d+=1)e[d].c();l=Se()},l(d){for(let u=0;u<e.length;u+=1)e[u].l(d);l=Se()},m(d,u){for(let _=0;_<e.length;_+=1)e[_]&&e[_].m(d,u);K(d,l,u)},p(d,u){u[0]&407664&&(n=Re(d[13]),e=$e(e,u,i,1,d,n,t,l.parentNode,et,Et,l,bt))},d(d){d&&a(l);for(let u=0;u<e.length;u+=1)e[u].d(d)}}}function qn(o){let e,t=(o[12][o[55].id_checklist_event]?o[12][o[55].id_checklist_event]:"Cargar evidencia")+"",l;return{c(){e=s("label"),l=_e(t),this.h()},l(n){e=c(n,"LABEL",{for:!0,class:!0});var i=m(e);l=he(i,t),i.forEach(a),this.h()},h(){G(e,"for","chklist-"+o[55].id_checklist_event),G(e,"class","button-label svelte-1ruehls")},m(n,i){K(n,e,i),r(e,l)},p(n,i){i[0]&4096&&t!==(t=(n[12][n[55].id_checklist_event]?n[12][n[55].id_checklist_event]:"Cargar evidencia")+"")&&we(l,t)},d(n){n&&a(e)}}}function Gn(o){let e;return{c(){e=s("ion-spinner"),this.h()},l(t){e=c(t,"ION-SPINNER",{name:!0,class:!0}),m(e).forEach(a),this.h()},h(){g(e,"name","dots"),g(e,"class","button-spinner svelte-1ruehls")},m(t,l){K(t,e,l)},p:ze,d(t){t&&a(e)}}}function Et(o,e){let t,l,n,i=e[55],d,u,_=e[55].item+"",I,E,h,f=e[55].mandatory=="1"?" * ":"",v,k,N,L,U,B,j,F,W,H;const C=()=>e[34](n,i),S=()=>e[34](null,i);function A(){return e[35](e[55])}function P(R,x){return R[11][R[55].id_checklist_event]?Gn:qn}let V=P(e),M=V(e);function D(...R){return e[37](e[55],...R)}return F=pt(e[21][0]),{key:o,first:null,c(){t=s("ion-item"),l=s("ion-label"),n=s("input"),d=y(),u=s("p"),I=_e(_),E=y(),h=s("b"),v=_e(f),k=y(),N=s("ion-button"),L=s("div"),M.c(),U=y(),B=s("input"),j=y(),this.h()},l(R){t=c(R,"ION-ITEM",{});var x=m(t);l=c(x,"ION-LABEL",{style:!0});var oe=m(l);n=c(oe,"INPUT",{id:!0,style:!0,type:!0}),d=w(oe),u=c(oe,"P",{style:!0});var ee=m(u);I=he(ee,_),E=w(ee),ee.forEach(a),h=c(oe,"B",{style:!0});var fe=m(h);v=he(fe,f),fe.forEach(a),oe.forEach(a),k=w(x),N=c(x,"ION-BUTTON",{fill:!0,class:!0,size:!0});var ae=m(N);L=c(ae,"DIV",{class:!0});var re=m(L);M.l(re),U=w(re),B=c(re,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0,capture:!0}),re.forEach(a),ae.forEach(a),j=w(x),x.forEach(a),this.h()},h(){G(n,"id",`chkbox-${e[55].id_checklist_event}`),b(n,"pointer-events","auto"),G(n,"type","checkbox"),n.__value=e[55].id_checklist_event,tn(n,n.__value),n.required=!0,b(u,"margin-left","10px"),b(h,"margin-left","5px"),b(l,"display","flex"),b(B,"display","none"),G(B,"id","chklist-"+e[55].id_checklist_event),G(B,"name","fileToUpload"),G(B,"type","file"),G(B,"accept","image/*"),G(B,"capture","environment"),G(L,"class","button-content svelte-1ruehls"),g(N,"fill","outline"),g(N,"class","loadEvidence svelte-1ruehls"),g(N,"size","small"),F.p(n),this.first=t},m(R,x){K(R,t,x),r(t,l),r(l,n),n.checked=~(e[4]||[]).indexOf(n.__value),C(),r(l,d),r(l,u),r(u,I),r(u,E),r(l,h),r(h,v),r(t,k),r(t,N),r(N,L),M.m(L,null),r(L,U),r(L,B),e[36](B),r(t,j),W||(H=[se(n,"change",e[33]),se(n,"change",A),se(B,"change",D)],W=!0)},p(R,x){e=R,x[0]&16&&(n.checked=~(e[4]||[]).indexOf(n.__value)),i!==e[55]&&(S(),i=e[55],C()),V===(V=P(e))&&M?M.p(e,x):(M.d(1),M=V(e),M&&(M.c(),M.m(L,U)))},d(R){R&&a(t),S(),M.d(),e[36](null),F.r(),W=!1,He(H)}}}function Kn(o){let e,t,l,n,i="Cancelar",d,u,_="REQUERIMIENTOS DE RUTA",I,E,h,f,v,k,N,L="Confirmar",U,B;function j(C,S){return C[14]?Fn:Vn}let W=j(o)(o),H=o[13]&&jn(o);return{c(){e=s("ion-header"),t=s("ion-toolbar"),l=s("ion-buttons"),n=s("ion-button"),n.textContent=i,d=y(),u=s("ion-title"),u.textContent=_,I=y(),E=s("ion-content"),h=s("ion-list"),W.c(),f=y(),H&&H.c(),v=y(),k=s("ion-footer"),N=s("ion-button"),N.textContent=L,this.h()},l(C){e=c(C,"ION-HEADER",{translucent:!0});var S=m(e);t=c(S,"ION-TOOLBAR",{});var A=m(t);l=c(A,"ION-BUTTONS",{slot:!0});var P=m(l);n=c(P,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),ne(n)!=="svelte-1dnmkxs"&&(n.textContent=i),P.forEach(a),d=w(A),u=c(A,"ION-TITLE",{"data-svelte-h":!0}),ne(u)!=="svelte-19bar5p"&&(u.textContent=_),A.forEach(a),S.forEach(a),I=w(C),E=c(C,"ION-CONTENT",{fullscreen:!0});var V=m(E);h=c(V,"ION-LIST",{});var M=m(h);W.l(M),f=w(M),H&&H.l(M),M.forEach(a),V.forEach(a),v=w(C),k=c(C,"ION-FOOTER",{});var D=m(k);N=c(D,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),ne(N)!=="svelte-g82qqw"&&(N.textContent=L),D.forEach(a),this.h()},h(){g(n,"color","medium"),g(l,"slot","start"),g(e,"translucent",""),g(E,"fullscreen",""),g(N,"fill","outline"),g(N,"color","tertiary"),g(N,"strong",""),b(N,"width","99%"),b(N,"height","auto")},m(C,S){K(C,e,S),r(e,t),r(t,l),r(l,n),r(t,d),r(t,u),K(C,I,S),K(C,E,S),r(E,h),W.m(h,null),r(h,f),H&&H.m(h,null),K(C,v,S),K(C,k,S),r(k,N),U||(B=[se(n,"click",o[15]),se(N,"click",o[16])],U=!0)},p(C,S){W.p(C,S),C[13]&&H.p(C,S)},i:ze,o:ze,d(C){C&&(a(e),a(I),a(E),a(v),a(k)),W.d(),H&&H.d(),U=!1,He(B)}}}function dt(o,e){if(typeof o=="object"&&o!==null||Array.isArray(o)){if(Array.isArray(o))return o.map(t=>dt(t,e)).flat();{const t=Object.keys(o);let l;return e=="id_checklist_event"?l=t.filter(i=>i.toLowerCase().includes("id_checklist_event")).map(i=>o[i]):e=="mandatory"?l=t.filter(i=>i.toLowerCase().includes("mandatory")).map(i=>o[i]):(console.error("Tipo de dato no reconocido."),l=!1),l}}else return console.error("Invalid input. Please provide a valid object or array."),[]}function Xn(o,e,t){let l=at,n=document.querySelector("ion-modal");const i=n.componentProps.checklist,d=n.componentProps.driverId,u=n.componentProps.routeId,_=n.componentProps.isLast;let I,E,h,f,v=[],k=null,N={},L,U,B,j,F={},W=new Object,H={},C={};xe(()=>{W=JSON.parse(localStorage.getItem("userSession")),_?console.log("Último checklist"):st.update(O=>(O.mandatory=dt(i,"mandatory"),O.items=dt(i,"id_checklist_event"),O))});function S(O){t(11,F[O]=!0,F)}const A=async()=>{await(await qe.create({header:"Datos o checklist incompletos",message:"Carga la evidencia requerida y marca todas las casillas para confirmar",buttons:[{text:"Cerrar"}]})).present()},P=async()=>{await(await qe.create({header:"Datos capturados",message:"El kilometraje y gasolina final fueron registrados correctamente, espere aprobación para finalizar ruta",buttons:[{text:"Cerrar"}]})).present()},V=async O=>{await(await qe.create({header:"Datos inválidos",message:O=="km"?"Llena correctamente el campo de kilometraje inicial":"Llena correctamente el campo de gasolina inicial",buttons:[{text:"Cerrar"}]})).present()},M=()=>{tt.dismiss(),d?je(`/drivers/${d}`):je("/drivers/me")},D=()=>{if(_){var O=fe(h,"km"),J=fe(f,"gas");let ie=new FormData;ie.append("km_final",O),ie.append("gas_final",J),ie.append("id_route",u),ie=Ee(ie),O&&J?(M(),fetch(`${l}api/admin/checklist/add_evidence.php`,{method:"POST",body:ie}).then(pe=>pe.json()).then(pe=>{P()}).catch(pe=>{console.error("Error fetching data:",pe)})):A()}else{var le=fe(I,"km"),$=fe(E,"gas");st.update(ie=>{ie.items;const pe=ie.mandatory;if(ie.items.filter((Te,Ie)=>ie.mandatory[Ie]==="1").every(Te=>ie.checkedIndices.includes(Te))&&le&&$){M();let Te=new FormData;Te=Ee(Te),Te.append("km_inicial",le),Te.append("gas_inicial",$),Te.append("id_route",u);for(const Ie in H)if(H.hasOwnProperty(Ie)){const{img:Be,img_id:Ge}=H[Ie];Te.append(`selectedImages[${Ie}][img]`,Be),Te.append(`selectedImages[${Ie}][img_id]`,Ge)}fetch(`${l}api/admin/checklist/add_evidence.php`,{method:"POST",body:Te}).then(Ie=>Ie.json()).then(Ie=>{pe&&pe.some(Be=>Be==="1")?ee(u,"checklist-pending"):ee(u,"enroute")}).catch(Ie=>{console.error("Error fetching data:",Ie)})}else if(!pe&&le&&$){let Te=new FormData;Te.append("km_inicial",le),Te.append("gas_inicial",$),Te=Ee(Te),fetch(`${l}api/admin/checklist/add_evidence.php`,{method:"POST",body:Te}).then(Ie=>Ie.json()).then(Ie=>{ee(u,"enroute")}).catch(Ie=>{console.error("Error fetching data:",Ie)})}else A();return ie})}Oe()},R=async(O,J)=>{S(J);const $=O.target.files[0],ie=await x($);if(ie){let pe=new FormData;pe.append("fileToUpload",ie),pe=Ee(pe);try{const Le=await fetch(`${l}api/admin/manager/upload_img_driver.php`,{method:"POST",body:pe});if(Le.ok){const ye=await Le.json();H={...H,[J]:{img:ye.img,img_id:ye.img_id}},t(12,C={...C,[J]:ye.filename}),oe(J),t(6,N[J].checked=!0,N),t(11,F[J]=!1,F)}else console.error("File upload failed:",Le.statusText)}catch(Le){console.error("Error during file upload:",Le)}}},x=async O=>new Promise(J=>{const le=new Image;le.src=URL.createObjectURL(O),le.onload=()=>{const $=document.createElement("canvas"),ie=$.getContext("2d"),pe=800,Le=600;let ye=le.width,Te=le.height;ye>pe&&(Te*=pe/ye,ye=pe),Te>Le&&(ye*=Le/Te,Te=Le),$.width=ye,$.height=Te,ie.drawImage(le,0,0,ye,Te),$.toBlob(Ie=>{J(Ie),URL.revokeObjectURL(le.src),ie.clearRect(0,0,$.width,$.height)},"image/jpeg",.7)}}),oe=O=>{st.update(J=>(J.checkedIndices.indexOf(O)===-1?J.checkedIndices.push(O):console.error(`ID ${O} is already checked.`),J.items.forEach($=>{$.id_checklist_event===O&&($.checked=!0)}),J))};function ee(O,J){let le=new FormData;le.append("id_route",O),le.append("status",J),le=Ee(le),fetch(`${l}api/admin/route/change_status.php`,{method:"POST",body:le}).then($=>$.json()).then($=>{}).catch($=>{console.error("Error fetching data:",$)})}function fe(O,J){return/^\d+$/.test(O)?parseInt(O,10):(V(J),null)}function ae(O,J){re(J),n.componentProps.data_type=J,Ve("modal-gas-km",Un,{r:J}).then(()=>{Ke.subscribe(le=>{be(le,J)})})}function re(O){xt.update(J=>({...J,flag:[O]}))}function be(O,J){t(0,I=O.km_inicial?O.km_inicial:null),t(1,E=O.gas_inicial?O.gas_inicial:null),t(2,h=O.km_final?O.km_final:null),t(3,f=O.gas_final?O.gas_final:null),J=="km_inicial"&&L&&t(7,L.checked=!0,L),J=="gas_inicial"&&U&&t(8,U.checked=!0,U),J=="km_final"&&B&&t(9,B.checked=!0,B),J=="gas_final"&&j&&t(10,j.checked=!0,j)}function Oe(){Ke.set({km_inicial:[],gas_inicial:[],km_final:[],gas_final:[]})}function Ee(O){return O.append("token",W.token),O.append("id_user_over",W.id_user),O}const me=[[]];function de(){v=Ze(me[0],this.__value,this.checked),t(4,v)}function ue(O){De[O?"unshift":"push"](()=>{B=O,t(9,B)})}const Ne=O=>ae(O,"km_final");function ve(){v=Ze(me[0],this.__value,this.checked),t(4,v)}function ke(O){De[O?"unshift":"push"](()=>{j=O,t(10,j)})}const Ce=O=>ae(O,"gas_final");function ge(){v=Ze(me[0],this.__value,this.checked),t(4,v)}function ce(O){De[O?"unshift":"push"](()=>{L=O,t(7,L)})}const Z=O=>ae(O,"km_inicial");function te(O){De[O?"unshift":"push"](()=>{U=O,t(8,U)})}function Q(){v=Ze(me[0],this.__value,this.checked),t(4,v)}const p=O=>ae(O,"gas_inicial");function z(){v=Ze(me[0],this.__value,this.checked),t(4,v)}function T(O,J){De[O?"unshift":"push"](()=>{N[J.id_checklist_event]=O,t(6,N)})}const q=O=>oe(O.id_checklist_event);function X(O){De[O?"unshift":"push"](()=>{k=O,t(5,k)})}return[I,E,h,f,v,k,N,L,U,B,j,F,C,i,_,M,D,R,oe,ae,de,me,ue,Ne,ve,ke,Ce,ge,ce,Z,te,Q,p,z,T,q,X,(O,J)=>R(J,O.id_checklist_event)]}class $t extends Ye{constructor(e){super(),Qe(this,e,Xn,Kn,Je,{},null,[-1,-1])}}function Pe(o,e){o=o.replace(/^#/,""),o.length===3&&(o=o.split("").map(i=>i+i).join(""));let t=parseInt(o.substring(0,2),16),l=parseInt(o.substring(2,4),16),n=parseInt(o.substring(4,6),16);return`rgba(${t}, ${l}, ${n}, ${e})`}function kt(o,e,t){const l=o.slice();return l[51]=e[t],l[53]=t,l}function Wn(o){let e,t,l="Confirmar",n,i;return{c(){e=s("ion-buttons"),t=s("ion-button"),t.textContent=l,this.h()},l(d){e=c(d,"ION-BUTTONS",{slot:!0});var u=m(e);t=c(u,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),ne(t)!=="svelte-1ida0il"&&(t.textContent=l),u.forEach(a),this.h()},h(){g(t,"strong",""),g(e,"slot","end")},m(d,u){K(d,e,u),r(e,t),n||(i=se(t,"click",o[22]),n=!0)},p:ze,d(d){d&&a(e),n=!1,i()}}}function Jn(o){let e,t,l,n,i,d="Empresa",u,_,I=o[11].enterprise_name+"",E;return{c(){e=s("ion-item"),t=s("ion-icon"),l=y(),n=s("ion-label"),i=s("p"),i.textContent=d,u=y(),_=s("h2"),E=_e(I),this.h()},l(h){e=c(h,"ION-ITEM",{});var f=m(e);t=c(f,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=w(f),n=c(f,"ION-LABEL",{});var v=m(n);i=c(v,"P",{"data-svelte-h":!0}),ne(i)!=="svelte-6noid3"&&(i.textContent=d),u=w(v),_=c(v,"H2",{});var k=m(_);E=he(k,I),k.forEach(a),v.forEach(a),f.forEach(a),this.h()},h(){g(t,"icon",Zt),g(t,"slot","start")},m(h,f){K(h,e,f),r(e,t),r(e,l),r(e,n),r(n,i),r(n,u),r(n,_),r(_,E)},p:ze,d(h){h&&a(e)}}}function Yn(o){let e,t,l,n,i,d="Negocio",u,_,I=o[11].client_name+"",E;return{c(){e=s("ion-item"),t=s("ion-icon"),l=y(),n=s("ion-label"),i=s("p"),i.textContent=d,u=y(),_=s("h2"),E=_e(I),this.h()},l(h){e=c(h,"ION-ITEM",{});var f=m(e);t=c(f,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=w(f),n=c(f,"ION-LABEL",{});var v=m(n);i=c(v,"P",{"data-svelte-h":!0}),ne(i)!=="svelte-57b1dg"&&(i.textContent=d),u=w(v),_=c(v,"H2",{});var k=m(_);E=he(k,I),k.forEach(a),v.forEach(a),f.forEach(a),this.h()},h(){g(t,"icon",Zt),g(t,"slot","start")},m(h,f){K(h,e,f),r(e,t),r(e,l),r(e,n),r(n,i),r(n,u),r(n,_),r(_,E)},p:ze,d(h){h&&a(e)}}}function Qn(o){let e,t,l,n,i,d="Teléfono de Negocio",u,_,I=o[11].client_phone+"",E;return{c(){e=s("ion-item"),t=s("ion-icon"),l=y(),n=s("ion-label"),i=s("p"),i.textContent=d,u=y(),_=s("h2"),E=_e(I),this.h()},l(h){e=c(h,"ION-ITEM",{href:!0});var f=m(e);t=c(f,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=w(f),n=c(f,"ION-LABEL",{class:!0});var v=m(n);i=c(v,"P",{"data-svelte-h":!0}),ne(i)!=="svelte-1u5l7fz"&&(i.textContent=d),u=w(v),_=c(v,"H2",{});var k=m(_);E=he(k,I),k.forEach(a),v.forEach(a),f.forEach(a),this.h()},h(){g(t,"icon",pn),g(t,"slot","start"),g(n,"class","ion-text-wrap"),g(e,"href","tel:"+o[11].client_phone)},m(h,f){K(h,e,f),r(e,t),r(e,l),r(e,n),r(n,i),r(n,u),r(n,_),r(_,E)},p:ze,d(h){h&&a(e)}}}function Zn(o){let e,t,l,n,i,d="Domicilio Alternativo",u,_,I=o[11].line2+"",E,h,f;return{c(){e=s("ion-item"),t=s("ion-icon"),l=y(),n=s("ion-label"),i=s("p"),i.textContent=d,u=y(),_=s("h2"),E=_e(I),h=y(),f=s("ion-icon"),this.h()},l(v){e=c(v,"ION-ITEM",{href:!0});var k=m(e);t=c(k,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=w(k),n=c(k,"ION-LABEL",{class:!0});var N=m(n);i=c(N,"P",{"data-svelte-h":!0}),ne(i)!=="svelte-1ub9uzw"&&(i.textContent=d),u=w(N),_=c(N,"H2",{});var L=m(_);E=he(L,I),L.forEach(a),N.forEach(a),h=w(k),f=c(k,"ION-ICON",{icon:!0,slot:!0}),m(f).forEach(a),k.forEach(a),this.h()},h(){g(t,"icon",mt),g(t,"slot","start"),g(n,"class","ion-text-wrap"),g(f,"icon",Ue),g(f,"slot","end"),g(e,"href","https://www.google.com/maps/searhc/?api=1&query="+o[11].line2)},m(v,k){K(v,e,k),r(e,t),r(e,l),r(e,n),r(n,i),r(n,u),r(n,_),r(_,E),r(e,h),r(e,f)},p:ze,d(v){v&&a(e)}}}function xn(o){let e,t,l,n,i,d="Domicilio",u,_,I=o[11].line1+"",E,h,f,v,k=o[11].line2&&o[11].line2.trim().length,N,L=k&&$n(o);return{c(){e=s("ion-item"),t=s("ion-icon"),l=y(),n=s("ion-label"),i=s("p"),i.textContent=d,u=y(),_=s("h2"),E=_e(I),h=y(),f=s("ion-icon"),v=y(),L&&L.c(),N=Se(),this.h()},l(U){e=c(U,"ION-ITEM",{href:!0});var B=m(e);t=c(B,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=w(B),n=c(B,"ION-LABEL",{class:!0});var j=m(n);i=c(j,"P",{"data-svelte-h":!0}),ne(i)!=="svelte-cbm7q1"&&(i.textContent=d),u=w(j),_=c(j,"H2",{});var F=m(_);E=he(F,I),F.forEach(a),j.forEach(a),h=w(B),f=c(B,"ION-ICON",{icon:!0,slot:!0}),m(f).forEach(a),B.forEach(a),v=w(U),L&&L.l(U),N=Se(),this.h()},h(){g(t,"icon",mt),g(t,"slot","start"),g(n,"class","ion-text-wrap"),g(f,"icon",Ue),g(f,"slot","end"),g(e,"href","https://www.google.com/maps/search/?api=1&query="+o[11].line1)},m(U,B){K(U,e,B),r(e,t),r(e,l),r(e,n),r(n,i),r(n,u),r(n,_),r(_,E),r(e,h),r(e,f),K(U,v,B),L&&L.m(U,B),K(U,N,B)},p(U,B){k&&L.p(U,B)},d(U){U&&(a(e),a(v),a(N)),L&&L.d(U)}}}function $n(o){let e,t,l,n,i,d="Domicilio Alternativo",u,_,I=o[11].line2+"",E,h,f;return{c(){e=s("ion-item"),t=s("ion-icon"),l=y(),n=s("ion-label"),i=s("p"),i.textContent=d,u=y(),_=s("h2"),E=_e(I),h=y(),f=s("ion-icon"),this.h()},l(v){e=c(v,"ION-ITEM",{href:!0});var k=m(e);t=c(k,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=w(k),n=c(k,"ION-LABEL",{class:!0});var N=m(n);i=c(N,"P",{"data-svelte-h":!0}),ne(i)!=="svelte-1ub9uzw"&&(i.textContent=d),u=w(N),_=c(N,"H2",{});var L=m(_);E=he(L,I),L.forEach(a),N.forEach(a),h=w(k),f=c(k,"ION-ICON",{icon:!0,slot:!0}),m(f).forEach(a),k.forEach(a),this.h()},h(){g(t,"icon",mt),g(t,"slot","start"),g(n,"class","ion-text-wrap"),g(f,"icon",Ue),g(f,"slot","end"),g(e,"href","https://www.google.com/maps/search/?api=1&query="+o[11].line2)},m(v,k){K(v,e,k),r(e,t),r(e,l),r(e,n),r(n,i),r(n,u),r(n,_),r(_,E),r(e,h),r(e,f)},p:ze,d(v){v&&a(e)}}}function It(o){let e,t,l,n,i,d="Contacto del Cliente",u,_,I,E,h=o[15]&&o[15]==="1"&&eo(o);return{c(){e=s("ion-item"),t=s("ion-icon"),l=y(),n=s("ion-label"),i=s("p"),i.textContent=d,u=y(),_=s("h2"),I=_e(o[6]),E=y(),h&&h.c(),this.h()},l(f){e=c(f,"ION-ITEM",{});var v=m(e);t=c(v,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=w(v),n=c(v,"ION-LABEL",{class:!0});var k=m(n);i=c(k,"P",{"data-svelte-h":!0}),ne(i)!=="svelte-1utsyb6"&&(i.textContent=d),u=w(k),_=c(k,"H2",{});var N=m(_);I=he(N,o[6]),N.forEach(a),k.forEach(a),E=w(v),h&&h.l(v),v.forEach(a),this.h()},h(){g(t,"icon",mn),g(t,"slot","start"),g(n,"class","ion-text-wrap")},m(f,v){K(f,e,v),r(e,t),r(e,l),r(e,n),r(n,i),r(n,u),r(n,_),r(_,I),r(e,E),h&&h.m(e,null)},p(f,v){v[0]&64&&we(I,f[6]),f[15]&&f[15]==="1"&&h.p(f,v)},d(f){f&&a(e),h&&h.d()}}}function eo(o){let e,t=`<ion-icon icon="${kn}" slot="start"></ion-icon>
                        Notificar Cliente`,l,n;return{c(){e=s("ion-button"),e.innerHTML=t,this.h()},l(i){e=c(i,"ION-BUTTON",{fill:!0,style:!0,"data-svelte-h":!0}),ne(e)!=="svelte-w3qtwm"&&(e.innerHTML=t),this.h()},h(){g(e,"fill","outline"),b(e,"margin-left","16px")},m(i,d){K(i,e,d),l||(n=se(e,"click",o[23]),l=!0)},p:ze,d(i){i&&a(e),l=!1,n()}}}function Ot(o){let e,t,l,n,i,d="Notas de ubicación",u,_,I;return{c(){e=s("ion-item"),t=s("ion-icon"),l=y(),n=s("ion-label"),i=s("p"),i.textContent=d,u=y(),_=s("h2"),I=_e(o[7]),this.h()},l(E){e=c(E,"ION-ITEM",{});var h=m(e);t=c(h,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=w(h),n=c(h,"ION-LABEL",{class:!0});var f=m(n);i=c(f,"P",{"data-svelte-h":!0}),ne(i)!=="svelte-nhm2ft"&&(i.textContent=d),u=w(f),_=c(f,"H2",{});var v=m(_);I=he(v,o[7]),v.forEach(a),f.forEach(a),h.forEach(a),this.h()},h(){g(t,"icon",Jt),g(t,"slot","start"),g(n,"class","ion-text-wrap")},m(E,h){K(E,e,h),r(e,t),r(e,l),r(e,n),r(n,i),r(n,u),r(n,_),r(_,I)},p(E,h){h[0]&128&&we(I,E[7])},d(E){E&&a(e)}}}function to(o){let e,t,l,n,i,d="Horarios",u,_,I=o[11].schedule+"",E;return{c(){e=s("ion-item"),t=s("ion-icon"),l=y(),n=s("ion-label"),i=s("p"),i.textContent=d,u=y(),_=s("h2"),E=_e(I),this.h()},l(h){e=c(h,"ION-ITEM",{});var f=m(e);t=c(f,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=w(f),n=c(f,"ION-LABEL",{});var v=m(n);i=c(v,"P",{"data-svelte-h":!0}),ne(i)!=="svelte-11q7hm5"&&(i.textContent=d),u=w(v),_=c(v,"H2",{});var k=m(_);E=he(k,I),k.forEach(a),v.forEach(a),f.forEach(a),this.h()},h(){g(t,"icon",vn),g(t,"slot","start")},m(h,f){K(h,e,f),r(e,t),r(e,l),r(e,n),r(n,i),r(n,u),r(n,_),r(_,E)},p:ze,d(h){h&&a(e)}}}function no(o){let e,t,l,n,i,d="Notas del operador",u,_,I=o[11].driver_comments+"",E;return{c(){e=s("ion-item"),t=s("ion-icon"),l=y(),n=s("ion-label"),i=s("p"),i.textContent=d,u=y(),_=s("h2"),E=_e(I),this.h()},l(h){e=c(h,"ION-ITEM",{});var f=m(e);t=c(f,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=w(f),n=c(f,"ION-LABEL",{});var v=m(n);i=c(v,"P",{"data-svelte-h":!0}),ne(i)!=="svelte-1yk9qp4"&&(i.textContent=d),u=w(v),_=c(v,"H2",{});var k=m(_);E=he(k,I),k.forEach(a),v.forEach(a),f.forEach(a),this.h()},h(){g(t,"icon",Yt),g(t,"slot","start")},m(h,f){K(h,e,f),r(e,t),r(e,l),r(e,n),r(n,i),r(n,u),r(n,_),r(_,E)},p:ze,d(h){h&&a(e)}}}function oo(o){let e,t=o[11].logistic_comments!="<br>"&&lo(o);return{c(){t&&t.c(),e=Se()},l(l){t&&t.l(l),e=Se()},m(l,n){t&&t.m(l,n),K(l,e,n)},p(l,n){l[11].logistic_comments!="<br>"&&t.p(l,n)},d(l){l&&a(e),t&&t.d(l)}}}function lo(o){let e,t,l,n,i,d="Comentarios logísticos",u,_,I=o[11].logistic_comments+"",E;return{c(){e=s("ion-item"),t=s("ion-icon"),l=y(),n=s("ion-label"),i=s("p"),i.textContent=d,u=y(),_=s("h2"),E=_e(I),this.h()},l(h){e=c(h,"ION-ITEM",{});var f=m(e);t=c(f,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=w(f),n=c(f,"ION-LABEL",{class:!0});var v=m(n);i=c(v,"P",{"data-svelte-h":!0}),ne(i)!=="svelte-1iz85r6"&&(i.textContent=d),u=w(v),_=c(v,"H2",{});var k=m(_);E=he(k,I),k.forEach(a),v.forEach(a),f.forEach(a),this.h()},h(){g(t,"icon",Jt),g(t,"slot","start"),g(n,"class","ion-text-wrap")},m(h,f){K(h,e,f),r(e,t),r(e,l),r(e,n),r(n,i),r(n,u),r(n,_),r(_,E)},p:ze,d(h){h&&a(e)}}}function io(o){let e,t,l,n,i="<p>Etiqueta</p>",d,u,_=(o[11].tag?o[11].tag:"")+"",I;return{c(){e=s("ion-item"),t=s("ion-icon"),l=y(),n=s("ion-label"),n.innerHTML=i,d=y(),u=s("div"),I=_e(_),this.h()},l(E){e=c(E,"ION-ITEM",{});var h=m(e);t=c(h,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=w(h),n=c(h,"ION-LABEL",{class:!0,"data-svelte-h":!0}),ne(n)!=="svelte-50rr6d"&&(n.innerHTML=i),d=w(h),u=c(h,"DIV",{class:!0,style:!0});var f=m(u);I=he(f,_),f.forEach(a),h.forEach(a),this.h()},h(){g(t,"icon",gn),g(t,"slot","start"),g(n,"class","ion-text-wrap"),G(u,"class","stop-tag"),b(u,"background-color",o[16]),b(u,"border","1px solid "+o[17]),b(u,"color",o[11].tag_color),b(u,"font-size","14px"),b(u,"text-align","center"),b(u,"align-content","center"),b(u,"border-radius","20px"),b(u,"white-space","normal"),b(u,"padding","4px 8px"),b(u,"width","auto",1),b(u,"display","inline-block")},m(E,h){K(E,e,h),r(e,t),r(e,l),r(e,n),r(e,d),r(e,u),r(u,I)},p:ze,d(E){E&&a(e)}}}function ro(o){let e,t,l,n,i,d="Estado de entrega",u,_,I="Entregado",E,h,f="No Entregado",v,k,N="Entrega Parcial",L,U,B,j,F,W,H,C,S=o[4]===!0&&Nt(o),A=(o[5]===!0||o[5]===!1&&o[4]===!1)&&Tt(o);return{c(){e=s("ion-item"),t=s("ion-icon"),l=y(),n=s("ion-select"),i=s("div"),i.textContent=d,u=y(),_=s("ion-select-option"),_.textContent=I,E=y(),h=s("ion-select-option"),h.textContent=f,v=y(),k=s("ion-select-option"),k.textContent=N,L=y(),U=s("ion-item"),B=s("ion-icon"),j=y(),F=s("ion-textarea"),W=y(),H=s("section"),S&&S.c(),C=y(),A&&A.c(),this.h()},l(P){e=c(P,"ION-ITEM",{});var V=m(e);t=c(V,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=w(V),n=c(V,"ION-SELECT",{value:!0});var M=m(n);i=c(M,"DIV",{slot:!0,"data-svelte-h":!0}),ne(i)!=="svelte-1635zca"&&(i.textContent=d),u=w(M),_=c(M,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),ne(_)!=="svelte-s33eln"&&(_.textContent=I),E=w(M),h=c(M,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),ne(h)!=="svelte-1a859l3"&&(h.textContent=f),v=w(M),k=c(M,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),ne(k)!=="svelte-1c4dcm8"&&(k.textContent=N),M.forEach(a),V.forEach(a),L=w(P),U=c(P,"ION-ITEM",{});var D=m(U);B=c(D,"ION-ICON",{icon:!0,slot:!0}),m(B).forEach(a),j=w(D),F=c(D,"ION-TEXTAREA",{label:!0,placeholder:!0}),m(F).forEach(a),D.forEach(a),W=w(P),H=c(P,"SECTION",{style:!0});var R=m(H);S&&S.l(R),C=w(R),A&&A.l(R),R.forEach(a),this.h()},h(){g(t,"icon",bn),g(t,"slot","start"),G(i,"slot","label"),g(_,"value","delivered"),g(h,"value","notdelivered"),g(k,"value","partialdeliver"),g(n,"value",o[14]?o[14]:"delivered"),g(B,"icon",ft),g(B,"slot","start"),g(F,"label","Notas"),g(F,"placeholder","Escribe aquí..."),b(H,"display","flex"),b(H,"gap","8px"),b(H,"padding","16px 16px 6px")},m(P,V){K(P,e,V),r(e,t),r(e,l),r(e,n),r(n,i),r(n,u),r(n,_),r(n,E),r(n,h),r(n,v),r(n,k),o[29](n),K(P,L,V),K(P,U,V),r(U,B),r(U,j),r(U,F),o[30](F),K(P,W,V),K(P,H,V),S&&S.m(H,null),r(H,C),A&&A.m(H,null)},p(P,V){P[4]===!0?S?S.p(P,V):(S=Nt(P),S.c(),S.m(H,C)):S&&(S.d(1),S=null),P[5]===!0||P[5]===!1&&P[4]===!1?A?A.p(P,V):(A=Tt(P),A.c(),A.m(H,null)):A&&(A.d(1),A=null)},d(P){P&&(a(e),a(L),a(U),a(W),a(H)),o[29](null),o[30](null),S&&S.d(),A&&A.d()}}}function Nt(o){let e,t=`<ion-icon icon="${In}" slot="start"></ion-icon>
                        Ingreso`,l,n;return{c(){e=s("ion-button"),e.innerHTML=t,this.h()},l(i){e=c(i,"ION-BUTTON",{id:!0,style:!0,"data-svelte-h":!0}),ne(e)!=="svelte-3onvnr"&&(e.innerHTML=t),this.h()},h(){g(e,"id","checkInBtn"),b(e,"flex","1")},m(i,d){K(i,e,d),l||(n=se(e,"click",o[24]),l=!0)},p:ze,d(i){i&&a(e),l=!1,n()}}}function Tt(o){let e,t,l,n,i,d;return{c(){e=s("ion-button"),t=s("ion-icon"),l=_e(`
                        Salida`),this.h()},l(u){e=c(u,"ION-BUTTON",{id:!0,style:!0,disabled:!0});var _=m(e);t=c(_,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=he(_,`
                        Salida`),_.forEach(a),this.h()},h(){g(t,"icon",En),g(t,"slot","start"),g(e,"id","checkOutBtn"),b(e,"flex","1"),g(e,"disabled",n=o[5]===!1)},m(u,_){K(u,e,_),r(e,t),r(e,l),i||(d=se(e,"click",o[25]),i=!0)},p(u,_){_[0]&32&&n!==(n=u[5]===!1)&&g(e,"disabled",n)},d(u){u&&a(e),i=!1,d()}}}function ao(o){let e,t,l,n,i,d,u,_;return{c(){e=s("section"),t=s("ion-button"),l=s("label"),n=s("ion-icon"),i=_e(`
                                Subir Evidencia
                            `),d=s("input"),this.h()},l(I){e=c(I,"SECTION",{style:!0});var E=m(e);t=c(E,"ION-BUTTON",{fill:!0,class:!0,style:!0});var h=m(t);l=c(h,"LABEL",{for:!0,style:!0});var f=m(l);n=c(f,"ION-ICON",{icon:!0,slot:!0,style:!0}),m(n).forEach(a),i=he(f,`
                                Subir Evidencia
                            `),d=c(f,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0,capture:!0}),f.forEach(a),h.forEach(a),E.forEach(a),this.h()},h(){g(n,"icon",Qt),g(n,"slot","start"),b(n,"vertical-align","middle"),b(d,"display","none"),G(d,"id","eventEvidence"),G(d,"name","fileToUpload"),G(d,"type","file"),d.multiple=!0,G(d,"accept","image/*"),G(d,"capture","environment"),G(l,"for","eventEvidence"),b(l,"width","100%"),b(l,"height","100%"),g(t,"fill","outline"),g(t,"class","loadEvidence"),b(t,"flex","1"),b(t,"display","flex"),b(t,"align-items","center"),b(t,"gap","8px"),b(e,"display","flex"),b(e,"gap","8px"),b(e,"padding","0px 16px")},m(I,E){K(I,e,E),r(e,t),r(t,l),r(l,n),r(l,i),r(l,d),u||(_=[se(d,"change",o[18]),se(d,"click",o[19])],u=!0)},p:ze,d(I){I&&a(e),u=!1,He(_)}}}function Ct(o){let e,t,l=Re(o[2]),n=[];for(let i=0;i<l.length;i+=1)n[i]=yt(kt(o,l,i));return{c(){e=s("section"),t=s("div");for(let i=0;i<n.length;i+=1)n[i].c();this.h()},l(i){e=c(i,"SECTION",{});var d=m(e);t=c(d,"DIV",{class:!0,style:!0});var u=m(t);for(let _=0;_<n.length;_+=1)n[_].l(u);u.forEach(a),d.forEach(a),this.h()},h(){G(t,"class","image-grid"),b(t,"display","grid"),b(t,"grid-template-columns","repeat(auto-fill, minmax(100px, 1fr))"),b(t,"gap","10px"),b(t,"padding","0px 10px")},m(i,d){K(i,e,d),r(e,t);for(let u=0;u<n.length;u+=1)n[u]&&n[u].m(t,null)},p(i,d){if(d[0]&69206020){l=Re(i[2]);let u;for(u=0;u<l.length;u+=1){const _=kt(i,l,u);n[u]?n[u].p(_,d):(n[u]=yt(_),n[u].c(),n[u].m(t,null))}for(;u<n.length;u+=1)n[u].d(1);n.length=l.length}},d(i){i&&a(e),nn(n,i)}}}function yt(o){let e,t,l,n,i,d=`<ion-icon icon="${On}"></ion-icon>`,u,_,I;function E(){return o[31](o[51])}function h(){return o[32](o[53])}return{c(){e=s("div"),t=s("ion-img"),n=y(),i=s("button"),i.innerHTML=d,u=y(),this.h()},l(f){e=c(f,"DIV",{class:!0,style:!0});var v=m(e);t=c(v,"ION-IMG",{src:!0,alt:!0,style:!0}),m(t).forEach(a),n=w(v),i=c(v,"BUTTON",{class:!0,style:!0,"data-svelte-h":!0}),ne(i)!=="svelte-zguiov"&&(i.innerHTML=d),u=w(v),v.forEach(a),this.h()},h(){Xe(t.src,l=o[51])||g(t,"src",l),g(t,"alt","Evidencia fotográfica"),b(t,"width","100%"),b(t,"height","100px"),b(t,"object-fit","cover"),b(t,"cursor","pointer"),b(t,"border","1px solid #ccc"),b(t,"border-radius","4px"),b(t,"margin-top","16px"),G(i,"class","remove-button"),b(i,"position","absolute"),b(i,"top","5px"),b(i,"right","5px"),b(i,"border","none"),b(i,"cursor","pointer"),b(i,"font-size","18px"),b(i,"background","white"),b(i,"border-radius","50%"),b(i,"padding","3px 4px 0px"),b(i,"box-shadow","2px 2px 6px rgba(0, 0, 0, 0.3)"),b(i,"color","#0000008f"),G(e,"class","image-container"),b(e,"position","relative")},m(f,v){K(f,e,v),r(e,t),r(e,n),r(e,i),r(e,u),_||(I=[se(t,"click",E),se(i,"click",h)],_=!0)},p(f,v){o=f,v[0]&4&&!Xe(t.src,l=o[51])&&g(t,"src",l)},d(f){f&&a(e),_=!1,He(I)}}}function wt(o){let e,t='<ion-spinner name="dots" style="color:white;"></ion-spinner>';return{c(){e=s("div"),e.innerHTML=t,this.h()},l(l){e=c(l,"DIV",{class:!0,style:!0,"data-svelte-h":!0}),ne(e)!=="svelte-h8s7r2"&&(e.innerHTML=t),this.h()},h(){G(e,"class","overlay"),b(e,"position","fixed"),b(e,"top","0"),b(e,"left","0"),b(e,"width","100vw"),b(e,"height","100vh"),b(e,"background","rgba(0, 0, 0, 0.5)"),b(e,"display","flex"),b(e,"align-items","center"),b(e,"justify-content","center"),b(e,"z-index","9999")},m(l,n){K(l,e,n)},d(l){l&&a(e)}}}function Lt(o){let e,t,l,n,i,d,u=`<ion-icon icon="${Nn}"></ion-icon>`,_,I;return{c(){e=s("div"),t=s("div"),l=s("ion-img"),i=y(),d=s("button"),d.innerHTML=u,this.h()},l(E){e=c(E,"DIV",{class:!0,style:!0});var h=m(e);t=c(h,"DIV",{class:!0,style:!0});var f=m(t);l=c(f,"ION-IMG",{src:!0,alt:!0,style:!0}),m(l).forEach(a),i=w(f),d=c(f,"BUTTON",{class:!0,style:!0,"data-svelte-h":!0}),ne(d)!=="svelte-g0qr0o"&&(d.innerHTML=u),f.forEach(a),h.forEach(a),this.h()},h(){Xe(l.src,n=o[9])||g(l,"src",n),g(l,"alt","Evidencia fotográfica"),b(l,"width","100%"),b(l,"height","auto"),G(d,"class","close-button"),b(d,"position","absolute"),b(d,"top","5px"),b(d,"right","5px"),b(d,"background","white"),b(d,"color","#444444d1"),b(d,"border","none"),b(d,"cursor","pointer"),b(d,"padding","2px 2px 0px 6px"),b(d,"border-radius","50%"),b(d,"font-size","20px"),G(t,"class","modal-content"),b(t,"position","relative"),b(t,"background","white"),b(t,"padding","20px"),b(t,"border-radius","8px"),b(t,"max-width","90vw"),b(t,"max-height","90vh"),b(t,"overflow","auto"),G(e,"class","modal-overlay"),b(e,"position","fixed"),b(e,"top","0"),b(e,"left","0"),b(e,"width","100vw"),b(e,"height","100vh"),b(e,"background","rgba(0, 0, 0, 0.8)"),b(e,"display","flex"),b(e,"justify-content","center"),b(e,"align-items","center"),b(e,"z-index","1000")},m(E,h){K(E,e,h),r(e,t),r(t,l),r(t,i),r(t,d),_||(I=[se(d,"click",o[27]),se(t,"click",on(o[28])),se(e,"click",o[27])],_=!0)},p(E,h){h[0]&512&&!Xe(l.src,n=E[9])&&g(l,"src",n)},d(E){E&&a(e),_=!1,He(I)}}}function so(o){let e,t,l,n,i="Cerrar",d,u,_=o[11].title+"",I,E,h,f,v,k,N=o[11].client_phone&&o[11].client_phone.trim().length,L,U,B,j,F=o[11].schedule&&o[11].schedule.trim().length,W,H,C=o[11].logistic_comments&&o[11].logistic_comments.trim().length,S,A,P,V,M,D,R,x,oe,ee=(!o[12]&&!o[13]||o[12]&&o[13])&&Wn(o);function fe(p,z){return p[11].client_name!=null?Yn:Jn}let re=fe(o)(o),be=N&&Qn(o);function Oe(p,z){if(p[11].line1&&p[11].line1.trim().length)return xn;if(p[11].line2&&p[11].line2.trim().length)return Zn}let Ee=Oe(o),me=Ee&&Ee(o),de=o[6]&&It(o),ue=o[7]&&o[7]!=="<br>"&&Ot(o),Ne=F&&to(o),ve=o[11].driver_comments&&no(o),ke=C&&oo(o),Ce=o[11].tag&&o[11].tag_color&&io(o),ge=!o[13]&&ro(o),ce=(o[12]&&o[13]||!o[12]&&!o[13])&&ao(o),Z=o[1]&&Ct(o),te=o[3]&&wt(),Q=o[8]&&Lt(o);return{c(){e=s("ion-header"),t=s("ion-toolbar"),l=s("ion-buttons"),n=s("ion-button"),n.textContent=i,d=y(),u=s("ion-title"),I=_e(_),E=y(),ee&&ee.c(),h=y(),f=s("ion-content"),v=s("ion-list"),re.c(),k=y(),be&&be.c(),L=y(),me&&me.c(),U=y(),de&&de.c(),B=y(),ue&&ue.c(),j=y(),Ne&&Ne.c(),W=y(),ve&&ve.c(),H=y(),ke&&ke.c(),S=y(),Ce&&Ce.c(),A=y(),ge&&ge.c(),P=y(),ce&&ce.c(),V=y(),Z&&Z.c(),M=y(),te&&te.c(),D=y(),Q&&Q.c(),R=Se(),this.h()},l(p){e=c(p,"ION-HEADER",{translucent:!0});var z=m(e);t=c(z,"ION-TOOLBAR",{});var T=m(t);l=c(T,"ION-BUTTONS",{slot:!0});var q=m(l);n=c(q,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),ne(n)!=="svelte-2ks32x"&&(n.textContent=i),q.forEach(a),d=w(T),u=c(T,"ION-TITLE",{style:!0,title:!0});var X=m(u);I=he(X,_),X.forEach(a),E=w(T),ee&&ee.l(T),T.forEach(a),z.forEach(a),h=w(p),f=c(p,"ION-CONTENT",{fullscreen:!0});var Y=m(f);v=c(Y,"ION-LIST",{});var O=m(v);re.l(O),k=w(O),be&&be.l(O),L=w(O),me&&me.l(O),U=w(O),de&&de.l(O),B=w(O),ue&&ue.l(O),j=w(O),Ne&&Ne.l(O),W=w(O),ve&&ve.l(O),H=w(O),ke&&ke.l(O),S=w(O),Ce&&Ce.l(O),A=w(O),ge&&ge.l(O),P=w(O),ce&&ce.l(O),V=w(O),Z&&Z.l(O),O.forEach(a),Y.forEach(a),M=w(p),te&&te.l(p),D=w(p),Q&&Q.l(p),R=Se(),this.h()},h(){g(n,"color","medium"),g(l,"slot","start"),b(u,"text-align","center"),g(u,"title",o[11].title),g(e,"translucent",""),g(f,"fullscreen","")},m(p,z){K(p,e,z),r(e,t),r(t,l),r(l,n),r(t,d),r(t,u),r(u,I),r(t,E),ee&&ee.m(t,null),K(p,h,z),K(p,f,z),r(f,v),re.m(v,null),r(v,k),be&&be.m(v,null),r(v,L),me&&me.m(v,null),r(v,U),de&&de.m(v,null),r(v,B),ue&&ue.m(v,null),r(v,j),Ne&&Ne.m(v,null),r(v,W),ve&&ve.m(v,null),r(v,H),ke&&ke.m(v,null),r(v,S),Ce&&Ce.m(v,null),r(v,A),ge&&ge.m(v,null),r(v,P),ce&&ce.m(v,null),r(v,V),Z&&Z.m(v,null),K(p,M,z),te&&te.m(p,z),K(p,D,z),Q&&Q.m(p,z),K(p,R,z),x||(oe=se(n,"click",o[20]),x=!0)},p(p,z){(!p[12]&&!p[13]||p[12]&&p[13])&&ee.p(p,z),re.p(p,z),N&&be.p(p,z),me&&me.p(p,z),p[6]?de?de.p(p,z):(de=It(p),de.c(),de.m(v,B)):de&&(de.d(1),de=null),p[7]&&p[7]!=="<br>"?ue?ue.p(p,z):(ue=Ot(p),ue.c(),ue.m(v,j)):ue&&(ue.d(1),ue=null),F&&Ne.p(p,z),p[11].driver_comments&&ve.p(p,z),C&&ke.p(p,z),p[11].tag&&p[11].tag_color&&Ce.p(p,z),p[13]||ge.p(p,z),(p[12]&&p[13]||!p[12]&&!p[13])&&ce.p(p,z),p[1]?Z?Z.p(p,z):(Z=Ct(p),Z.c(),Z.m(v,null)):Z&&(Z.d(1),Z=null),p[3]?te||(te=wt(),te.c(),te.m(D.parentNode,D)):te&&(te.d(1),te=null),p[8]?Q?Q.p(p,z):(Q=Lt(p),Q.c(),Q.m(R.parentNode,R)):Q&&(Q.d(1),Q=null)},i:ze,o:ze,d(p){p&&(a(e),a(h),a(f),a(M),a(D),a(R)),ee&&ee.d(),re.d(),be&&be.d(),me&&me.d(),de&&de.d(),ue&&ue.d(),Ne&&Ne.d(),ve&&ve.d(),ke&&ke.d(),Ce&&Ce.d(),ge&&ge.d(),ce&&ce.d(),Z&&Z.d(),te&&te.d(p),Q&&Q.d(p),x=!1,oe()}}}const zt=/Teléfono:\s*(\d{10,})/;function it(o=""){return o.split(",").map(t=>t.trim())}function co(o,e,t){let l=at,n=document.querySelector("ion-modal"),i=n.componentProps.delivery,d=n.componentProps.isLast||!1,u=n.componentProps.flag||!1,_=i.driver_comments?i.driver_comments:"",I=i.deliver_status?i.deliver_status:"",E=i.img?i.img:"",h=i.img_id?i.img_id:"",f=E?it(E):new Array,v=h?it(h):new Array,k={latitude:null,longitude:null},N=i.stopsApproval,L=i.smsActive,U=!1,B=!0,j=!1,F="",W=i.comments_ext,H=!1,C="",S=new Object,A="",P=Pe(i.tag_color,.2),V=Pe(i.tag_color,.3);xe(()=>{S=JSON.parse(localStorage.getItem("userSession")),D()});async function M(T="",q,X={}){let Y=new FormData;t(3,U=!0);for(const[O,J]of Object.entries(X))Y.append(O,J);Y=ge(Y);try{const O=await fetch(T,{method:"POST",body:Y});if(O.ok){const J=await O.json();q(J)}else console.error("Request failed:",O.statusText)}catch(O){console.error("Error during file upload:",O)}finally{t(3,U=!1)}}function D(){i.date_service?i.date_service&&!i.date_completed&&!i.service_time?(t(4,B=!1),t(5,j=!0)):i.date_service&&i.date_completed&&i.service_time&&(t(4,B=!1),t(5,j=!1)):(t(4,B=!0),t(5,j=!1))}if(i.comments_ext){const T=i.comments_ext.match(zt);T&&(F=T[1],W=i.comments_ext.replace(zt,"").trim())}const R=async(T,q)=>{await(await qe.create({header:T||"Error",message:q||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()},x=async(T="",q="",X="",Y,O={})=>{await(await qe.create({header:T||"Error",message:q||"Vuelva a intentar",buttons:[{text:"No",role:"cancel",handler:()=>{}},{text:"Sí",handler:()=>{M(X,Y,O)}}]})).present()},oe=async T=>{if(f.length>=5){R("Límite de evidencias","Solo se permite subir 5 fotos por parada");return}if(u&&d&&f.length>=1){R("Límite de evidencias","Para el final de la ruta solo se permite subir 1 foto");return}const X=T.target.files[0];if(X)try{t(3,U=!0);const Y=await ae(X);if(Y){const O=new FormData;O.append("fileToUpload",Y),fetch(`${l}api/admin/manager/upload_img_driver.php`,{method:"POST",body:O}).then(J=>J.json()).then(J=>{t(1,E=E?`${E},${J.img}`:J.img),h=h?`${h},${J.img_id}`:J.img_id,t(2,f=it(E)),v=it(h)}).catch(J=>console.error("Upload error:",J))}}catch(Y){console.error("Compression error:",Y)}finally{t(3,U=!1)}};function ee(T){var q=i.service_time;!q&&B&&!d&&!u&&(T.preventDefault(),R("Registrar Ingreso","Antes de subir la evidencia registra el ingreso a la actual parada."))}function fe(){var T=u?i.date_completed:!1;if(!T&&!B&&j&&!d&&!u){var q=new Object;q.id_event=i.id_event,q.type="checkout",x("Registrar Salida","¿Completaste tu entrega?",l+"api/admin/route/record_check_date.php",function(X){X.minutes&&R("Tiempo por parada","Completaste la parada en "+X.minutes+" minutos.")},q)}}const ae=async T=>new Promise(q=>{const X=new Image;X.src=URL.createObjectURL(T),X.onload=()=>{const Y=document.createElement("canvas"),O=Y.getContext("2d"),J=800,le=600;let $=X.width,ie=X.height;$>J&&(ie*=J/$,$=J),ie>le&&($*=le/ie,ie=le),Y.width=$,Y.height=ie,O.drawImage(X,0,0,$,ie),Y.toBlob(pe=>{q(pe),URL.revokeObjectURL(X.src),O.clearRect(0,0,Y.width,Y.height)},"image/jpeg",.7)}}),re=()=>{n.dismiss({data:Date.now()})};function be(T){t(2,f=f.filter((q,X)=>X!==T))}const Oe=async()=>{try{if(t(3,U=!0),t(1,E=f.join(",")),h=v.join(","),fe(),await me())if(A.value=="delivered"||A.value!=="delivered"&&(_.value||i.driver_comments)||u&&d){const q={id_route:i.id_route,...!u&&!d&&{id_event:i.id_event},...!u&&!d&&{comments:_.value},...!u&&!d&&{deliver_status:A.value},img:E,img_id:h,lat:k.latitude,lon:k.longitude,...N==="0"&&{approve:"0"},...d&&{isLast:!0},...u&&d&&{destiny:!0}};q.img&&q.img_id||E?M(`${l}api/admin/evidence/send_evidence.php`,function(X){if(X.success==!0){const Y=q.id_route;re(),d&&(Ee("","",Y,d),N=="0"&&ce(Y,"completed"))}else R("Carga fallida","Actualiza la página y vuelve a intentar cargar la información!")},q):R("Información incompleta","Cargar evidencia fotográfica faltante para completar parada.")}else R("Motivo de status de entrega","Favor de ingresar en notas el motivo por el que la entrega no fue entregada correctamente");else R("Ubicación faltante","Asegúrate darle permisos a Rutaflow para acceder a tu ubicación")}catch(T){console.error("Error fetching data:",T)}finally{t(3,U=!1)}},Ee=(T,q,X,Y)=>{n.componentProps.routeId=X,n.componentProps.driverId=i.id_driver,Ve("modal-km-gas",$t,{checklist:T,driverId:q,routeId:X,isLast:Y}).then(O=>{})},me=async()=>navigator.geolocation?new Promise((T,q)=>{navigator.geolocation.getCurrentPosition(X=>{k.latitude=X.coords.latitude,k.longitude=X.coords.longitude,T(!0)},X=>{console.error("Error getting location:",X),T(!1)})}):(console.error("Geolocation is not supported by your browser"),!1);async function de(T){T.stopPropagation();let q=new FormData;q.append("client_phone",F),q.append("client_name",i.title),q.append("delivery_phone",i.client_phone),q.append("enterprise_name",i.enterprise_name),q=ge(q);try{const X=await fetch(`${l}api/admin/message_central/send_sms.php`,{method:"POST",body:q});if(X.ok){const Y=await X.json();R("SMS enviado","Se envío correctamente un SMS a "+i.title+" con número de teléfono: "+F)}else R("SMS no enviado","Hubo un error al enviar SMS a "+i.title+" con número de teléfono: "+phoneNumber0+". Por favor contacte a soporte.")}catch(X){console.error("Error during file upload:",X)}}function ue(){t(4,B=!1),t(5,j=!0),ve(i.id_event,"checkin")}function Ne(){t(5,j=!1),t(4,B=!1),ve(i.id_event,"checkout")}async function ve(T,q){if(q){let X=new FormData;X.append("type",q),X.append("id_event",T),X=ge(X);try{const Y=await fetch(`${l}api/admin/route/record_check_date.php`,{method:"POST",body:X});if(Y.ok){const O=await Y.json();O.minutes&&R("Tiempo por parada","Completaste la parada en "+O.minutes+" minutos.")}else console.error("File upload failed:",Y.statusText)}catch(Y){console.error("Error during file upload:",Y)}finally{}}}const ke=T=>{t(9,C=T),t(8,H=!0)},Ce=()=>{t(8,H=!1),t(9,C="")};function ge(T){return T.append("token",S.token),T.append("id_user_over",S.id_user),T}function ce(T,q){let X=new FormData;return X.append("id_route",T),X.append("status",q),X=ge(X),fetch(`${l}api/admin/route/change_status.php`,{method:"POST",body:X}).then(Y=>Y.json()).then(Y=>{}).catch(Y=>{console.error("Error fetching data:",Y)}),""}function Z(T){ln.call(this,o,T)}function te(T){De[T?"unshift":"push"](()=>{A=T,t(10,A)})}function Q(T){De[T?"unshift":"push"](()=>{_=T,t(0,_)})}return[_,E,f,U,B,j,F,W,H,C,A,i,d,u,I,L,P,V,oe,ee,re,be,Oe,de,ue,Ne,ke,Ce,Z,te,Q,T=>ke(T),T=>be(T)]}class At extends Ye{constructor(e){super(),Qe(this,e,co,so,Je,{},null,[-1,-1])}}function Mt(o){let e,t,l;return{c(){e=s("section"),t=s("ion-img"),this.h()},l(n){e=c(n,"SECTION",{});var i=m(e);t=c(i,"ION-IMG",{src:!0,alt:!0,style:!0}),m(t).forEach(a),i.forEach(a),this.h()},h(){Xe(t.src,l=o[0])||g(t,"src",l),g(t,"alt","Evidencia fotográfica"),b(t,"max-width","100%"),b(t,"margin-top","16px")},m(n,i){K(n,e,i),r(e,t)},p(n,i){i&1&&!Xe(t.src,l=n[0])&&g(t,"src",l)},d(n){n&&a(e)}}}function St(o){let e,t='<ion-spinner name="dots" style="color:white;"></ion-spinner>';return{c(){e=s("div"),e.innerHTML=t,this.h()},l(l){e=c(l,"DIV",{class:!0,style:!0,"data-svelte-h":!0}),ne(e)!=="svelte-h8s7r2"&&(e.innerHTML=t),this.h()},h(){G(e,"class","overlay"),b(e,"position","fixed"),b(e,"top","0"),b(e,"left","0"),b(e,"width","100vw"),b(e,"height","100vh"),b(e,"background","rgba(0, 0, 0, 0.5)"),b(e,"display","flex"),b(e,"align-items","center"),b(e,"justify-content","center"),b(e,"z-index","9999")},m(l,n){K(l,e,n)},d(l){l&&a(e)}}}function uo(o){let e,t,l,n,i="Cancelar",d,u,_="AGREGAR GASTO",I,E,h,f="Confirmar",v,k,N,L,U,B,j,F,W,H,C,S,A,P,V,M,D,R,x='Tipo de pago <ion-text color="danger">(Obligatorio)</ion-text>',oe,ee,fe="Efectivo",ae,re,be="Tarjeta",Oe,Ee,me="Transferencia",de,ue,Ne,ve,ke,Ce,ge,ce,Z,te,Q=`<ion-icon icon="${Qt}" slot="start"></ion-icon>
                        Subir Evidencia`,p,z,T,q,X,Y,O,J=o[0]&&Mt(o),le=o[5]&&St();return{c(){e=s("ion-header"),t=s("ion-toolbar"),l=s("ion-buttons"),n=s("ion-button"),n.textContent=i,d=y(),u=s("ion-title"),u.textContent=_,I=y(),E=s("ion-buttons"),h=s("ion-button"),h.textContent=f,v=y(),k=s("ion-content"),N=s("ion-list"),L=s("ion-item"),U=s("ion-icon"),B=y(),j=s("ion-input"),F=y(),W=s("ion-item"),H=s("ion-icon"),C=y(),S=s("ion-input"),A=y(),P=s("ion-item"),V=s("ion-icon"),M=y(),D=s("ion-select"),R=s("div"),R.innerHTML=x,oe=y(),ee=s("ion-select-option"),ee.textContent=fe,ae=y(),re=s("ion-select-option"),re.textContent=be,Oe=y(),Ee=s("ion-select-option"),Ee.textContent=me,de=y(),ue=s("ion-item"),Ne=s("ion-icon"),ve=y(),ke=s("ion-textarea"),Ce=y(),ge=s("section"),ce=s("label"),Z=s("ion-button"),te=s("label"),te.innerHTML=Q,p=y(),z=s("input"),T=y(),J&&J.c(),q=y(),le&&le.c(),X=Se(),this.h()},l($){e=c($,"ION-HEADER",{translucent:!0});var ie=m(e);t=c(ie,"ION-TOOLBAR",{});var pe=m(t);l=c(pe,"ION-BUTTONS",{slot:!0});var Le=m(l);n=c(Le,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),ne(n)!=="svelte-1f8rjcf"&&(n.textContent=i),Le.forEach(a),d=w(pe),u=c(pe,"ION-TITLE",{title:!0,"data-svelte-h":!0}),ne(u)!=="svelte-efps2s"&&(u.textContent=_),I=w(pe),E=c(pe,"ION-BUTTONS",{slot:!0});var ye=m(E);h=c(ye,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),ne(h)!=="svelte-k5zoz0"&&(h.textContent=f),ye.forEach(a),pe.forEach(a),ie.forEach(a),v=w($),k=c($,"ION-CONTENT",{fullscreen:!0});var Te=m(k);N=c(Te,"ION-LIST",{});var Ie=m(N);L=c(Ie,"ION-ITEM",{});var Be=m(L);U=c(Be,"ION-ICON",{icon:!0,slot:!0}),m(U).forEach(a),B=w(Be),j=c(Be,"ION-INPUT",{label:!0,type:!0,placeholder:!0,value:!0}),m(j).forEach(a),Be.forEach(a),F=w(Ie),W=c(Ie,"ION-ITEM",{});var Ge=m(W);H=c(Ge,"ION-ICON",{icon:!0,slot:!0}),m(H).forEach(a),C=w(Ge),S=c(Ge,"ION-INPUT",{label:!0,type:!0,value:!0}),m(S).forEach(a),Ge.forEach(a),A=w(Ie),P=c(Ie,"ION-ITEM",{});var nt=m(P);V=c(nt,"ION-ICON",{icon:!0,slot:!0}),m(V).forEach(a),M=w(nt),D=c(nt,"ION-SELECT",{placeholder:!0,value:!0});var Fe=m(D);R=c(Fe,"DIV",{slot:!0,"data-svelte-h":!0}),ne(R)!=="svelte-wl764p"&&(R.innerHTML=x),oe=w(Fe),ee=c(Fe,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),ne(ee)!=="svelte-i9crym"&&(ee.textContent=fe),ae=w(Fe),re=c(Fe,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),ne(re)!=="svelte-fx0z11"&&(re.textContent=be),Oe=w(Fe),Ee=c(Fe,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),ne(Ee)!=="svelte-1c24jf2"&&(Ee.textContent=me),Fe.forEach(a),nt.forEach(a),de=w(Ie),ue=c(Ie,"ION-ITEM",{});var ot=m(ue);Ne=c(ot,"ION-ICON",{icon:!0,slot:!0}),m(Ne).forEach(a),ve=w(ot),ke=c(ot,"ION-TEXTAREA",{label:!0,placeholder:!0}),m(ke).forEach(a),ot.forEach(a),Ce=w(Ie),ge=c(Ie,"SECTION",{});var vt=m(ge);ce=c(vt,"LABEL",{for:!0,style:!0});var gt=m(ce);Z=c(gt,"ION-BUTTON",{fill:!0,size:!0,class:!0,expand:!0});var lt=m(Z);te=c(lt,"LABEL",{for:!0,style:!0,"data-svelte-h":!0}),ne(te)!=="svelte-1m9yw22"&&(te.innerHTML=Q),p=w(lt),z=c(lt,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0,capture:!0}),lt.forEach(a),gt.forEach(a),vt.forEach(a),T=w(Ie),J&&J.l(Ie),Ie.forEach(a),Te.forEach(a),q=w($),le&&le.l($),X=Se(),this.h()},h(){g(n,"color","medium"),g(l,"slot","start"),g(u,"title",""),g(h,"strong",""),g(E,"slot","end"),g(e,"translucent",""),g(U,"icon",Yt),g(U,"slot","start"),g(j,"label","Concepto"),g(j,"type","text"),g(j,"placeholder","Escribe aquí..."),g(j,"value",o[6]?o[6]:""),g(H,"icon",ft),g(H,"slot","start"),g(S,"label","Cantidad"),g(S,"type","number"),g(S,"value",o[7]?o[7]:""),g(V,"icon",Tn),g(V,"slot","start"),G(R,"slot","label"),g(ee,"value","cash"),g(re,"value","card"),g(Ee,"value","transfer"),g(D,"placeholder","Tipo de pago"),g(D,"value",o[8]?o[8]:""),g(Ne,"icon",ft),g(Ne,"slot","start"),g(ke,"label","Comentarios"),g(ke,"placeholder","Escribe aquí..."),G(te,"for","eventEvidence"),b(te,"width","100%"),b(te,"padding","8px"),b(z,"display","none"),G(z,"id","eventEvidence"),G(z,"name","fileToUpload"),G(z,"type","file"),G(z,"accept","image/*"),G(z,"capture","environment"),g(Z,"fill","outline"),g(Z,"size","small"),g(Z,"class","loadEvidence"),g(Z,"expand","block"),G(ce,"for","eventEvidence"),b(ce,"display","block"),b(ce,"width","100%"),g(k,"fullscreen","")},m($,ie){K($,e,ie),r(e,t),r(t,l),r(l,n),r(t,d),r(t,u),r(t,I),r(t,E),r(E,h),K($,v,ie),K($,k,ie),r(k,N),r(N,L),r(L,U),r(L,B),r(L,j),o[12](j),r(N,F),r(N,W),r(W,H),r(W,C),r(W,S),o[13](S),r(N,A),r(N,P),r(P,V),r(P,M),r(P,D),r(D,R),r(D,oe),r(D,ee),r(D,ae),r(D,re),r(D,Oe),r(D,Ee),o[14](D),r(N,de),r(N,ue),r(ue,Ne),r(ue,ve),r(ue,ke),o[15](ke),r(N,Ce),r(N,ge),r(ge,ce),r(ce,Z),r(Z,te),r(Z,p),r(Z,z),r(N,T),J&&J.m(N,null),K($,q,ie),le&&le.m($,ie),K($,X,ie),Y||(O=[se(n,"click",o[10]),se(h,"click",o[11]),se(z,"change",o[9])],Y=!0)},p($,[ie]){$[0]?J?J.p($,ie):(J=Mt($),J.c(),J.m(N,null)):J&&(J.d(1),J=null),$[5]?le||(le=St(),le.c(),le.m(X.parentNode,X)):le&&(le.d(1),le=null)},i:ze,o:ze,d($){$&&(a(e),a(v),a(k),a(q),a(X)),o[12](null),o[13](null),o[14](null),o[15](null),J&&J.d(),le&&le.d($),Y=!1,He(O)}}}function fo(o,e,t){let l=at,n=document.querySelector("ion-modal"),i=n.componentProps.routeId,d=n.componentProps.ex_concept,u=n.componentProps.ex_amount,_=n.componentProps.ex_type,I=n.componentProps.id_expense,E="",h="",f="",v=0,k="",N="",L=!1,U=new Object;xe(()=>{U=JSON.parse(localStorage.getItem("userSession"))});const B=async(M,D)=>{await(await qe.create({header:M,message:D,buttons:[{text:"Cerrar"}]})).present()},j=async M=>{t(5,L=!0);const R=M.target.files[0],x=await F(R);if(x){let oe=new FormData;oe.append("fileToUpload",x),oe=C(oe);try{const ee=await fetch(`${l}api/admin/manager/upload_img_driver.php`,{method:"POST",body:oe});if(ee.ok){const fe=await ee.json();t(0,E=fe.img),h=fe.img_id}else console.error("File upload failed:",ee.statusText)}catch(ee){console.error("Error during file upload:",ee)}finally{t(5,L=!1)}}},F=async M=>new Promise(D=>{const R=new Image;R.src=URL.createObjectURL(M),R.onload=()=>{const x=document.createElement("canvas"),oe=x.getContext("2d"),ee=800,fe=600;let ae=R.width,re=R.height;ae>ee&&(re*=ee/ae,ae=ee),re>fe&&(ae*=fe/re,re=fe),x.width=ae,x.height=re,oe.drawImage(R,0,0,ae,re),x.toBlob(be=>{D(be),URL.revokeObjectURL(R.src),oe.clearRect(0,0,x.width,x.height)},"image/jpeg",.7)}}),W=()=>{tt.dismiss()},H=()=>{var M=new Object;M.id_route=i,M.comments=k.value,M.type=f.value,M.img=E,M.img_id=h,M.amount=v.value,M.concept=N.value,M.status="done",M.id_expense=I||"null";let D=new FormData;for(const R in M)D.append(R,M[R]);D=C(D),!h||!E||!k.value||!v.value||!N.value?B("Datos incompletos","Llena los datos requeridos para completar el registro"):fetch(`${l}api/admin/expenses/add_expense.php`,{method:"POST",body:D}).then(R=>R.json()).then(R=>{W()}).catch(R=>{console.error("Error fetching data:",R)})};function C(M){return M.append("token",U.token),M.append("id_user_over",U.id_user),M}function S(M){De[M?"unshift":"push"](()=>{N=M,t(4,N)})}function A(M){De[M?"unshift":"push"](()=>{v=M,t(2,v)})}function P(M){De[M?"unshift":"push"](()=>{f=M,t(1,f)})}function V(M){De[M?"unshift":"push"](()=>{k=M,t(3,k)})}return[E,f,v,k,N,L,d,u,_,j,W,H,S,A,P,V]}class _t extends Ye{constructor(e){super(),Qe(this,e,fo,uo,Je,{})}}function Dt(o,e,t){const l=o.slice();return l[7]=e[t],l}function _o(o){let e,t="Cargar gasto",l,n;function i(...d){return o[4](o[7],...d)}return{c(){e=s("ion-button"),e.textContent=t,this.h()},l(d){e=c(d,"ION-BUTTON",{fill:!0,size:!0,"aria-selected":!0,"data-svelte-h":!0}),ne(e)!=="svelte-175aelj"&&(e.textContent=t),this.h()},h(){g(e,"fill","outline"),g(e,"size","small"),g(e,"aria-selected","")},m(d,u){K(d,e,u),l||(n=se(e,"click",i),l=!0)},p(d,u){o=d},d(d){d&&a(e),l=!1,n()}}}function ho(o){let e,t="Gasto completado";return{c(){e=s("ion-button"),e.textContent=t,this.h()},l(l){e=c(l,"ION-BUTTON",{fill:!0,size:!0,"aria-selected":!0,"data-svelte-h":!0}),ne(e)!=="svelte-tlger7"&&(e.textContent=t),this.h()},h(){g(e,"fill","solid"),g(e,"size","small"),g(e,"aria-selected","")},m(l,n){K(l,e,n)},p:ze,d(l){l&&a(e)}}}function Pt(o,e){let t,l,n,i=e[7].concept+"",d,u,_;function I(f,v){return f[7].status=="done"?ho:_o}let h=I(e)(e);return{key:o,first:null,c(){t=s("ion-item"),l=s("ion-label"),n=s("p"),d=_e(i),u=y(),h.c(),_=y(),this.h()},l(f){t=c(f,"ION-ITEM",{});var v=m(t);l=c(v,"ION-LABEL",{style:!0});var k=m(l);n=c(k,"P",{style:!0});var N=m(n);d=he(N,i),N.forEach(a),k.forEach(a),u=w(v),h.l(v),_=w(v),v.forEach(a),this.h()},h(){b(n,"margin-left","10px"),b(l,"display","flex"),this.first=t},m(f,v){K(f,t,v),r(t,l),r(l,n),r(n,d),r(t,u),h.m(t,null),r(t,_)},p(f,v){e=f,h.p(e,v)},d(f){f&&a(t),h.d()}}}function po(o){let e,t,l,n,i=`<ion-icon style="font-size: 25px!important;" icon="${Cn}"></ion-icon>`,d,u,_="LISTA DE GASTOS",I,E,h,f=[],v=new Map,k,N,L,U="Cerrar",B,j,F=Re(o[0]);const W=H=>H[7].id_expenses;for(let H=0;H<F.length;H+=1){let C=Dt(o,F,H),S=W(C);v.set(S,f[H]=Pt(S,C))}return{c(){e=s("ion-header"),t=s("ion-toolbar"),l=s("ion-buttons"),n=s("ion-button"),n.innerHTML=i,d=y(),u=s("ion-title"),u.textContent=_,I=y(),E=s("ion-content"),h=s("ion-list");for(let H=0;H<f.length;H+=1)f[H].c();k=y(),N=s("ion-footer"),L=s("ion-button"),L.textContent=U,this.h()},l(H){e=c(H,"ION-HEADER",{translucent:!0});var C=m(e);t=c(C,"ION-TOOLBAR",{});var S=m(t);l=c(S,"ION-BUTTONS",{slot:!0});var A=m(l);n=c(A,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),ne(n)!=="svelte-160xz3i"&&(n.innerHTML=i),A.forEach(a),d=w(S),u=c(S,"ION-TITLE",{"data-svelte-h":!0}),ne(u)!=="svelte-1phn90x"&&(u.textContent=_),S.forEach(a),C.forEach(a),I=w(H),E=c(H,"ION-CONTENT",{fullscreen:!0});var P=m(E);h=c(P,"ION-LIST",{});var V=m(h);for(let D=0;D<f.length;D+=1)f[D].l(V);V.forEach(a),P.forEach(a),k=w(H),N=c(H,"ION-FOOTER",{});var M=m(N);L=c(M,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),ne(L)!=="svelte-zv7v83"&&(L.textContent=U),M.forEach(a),this.h()},h(){g(n,"color","medium"),g(l,"slot","end"),g(e,"translucent",""),g(E,"fullscreen",""),g(L,"fill","outline"),g(L,"color","tertiary"),g(L,"strong",""),b(L,"width","99%"),b(L,"height","auto")},m(H,C){K(H,e,C),r(e,t),r(t,l),r(l,n),r(t,d),r(t,u),K(H,I,C),K(H,E,C),r(E,h);for(let S=0;S<f.length;S+=1)f[S]&&f[S].m(h,null);K(H,k,C),K(H,N,C),r(N,L),B||(j=[se(n,"click",o[3]),se(L,"click",o[1])],B=!0)},p(H,[C]){C&5&&(F=Re(H[0]),f=$e(f,C,W,1,H,F,v,h,et,Pt,null,Dt))},i:ze,o:ze,d(H){H&&(a(e),a(I),a(E),a(k),a(N));for(let C=0;C<f.length;C+=1)f[C].d();B=!1,He(j)}}}function mo(o){let e=document.querySelector("ion-modal");e.componentProps.routeId;let t=e.componentProps.expenses;xe(()=>{});const l=()=>{tt.dismiss()};function n(u,_,I,E,h){e.componentProps.ex_amount=I,e.componentProps.ex_concept=_,e.componentProps.ex_type=E,e.componentProps.id_expense=h,Ve("modal-expense",_t,{amount:I,concept:_,type:E,id_expense:h}).then(()=>{}),l()}return[t,l,n,u=>{Ve("modal-expense",_t,{routeId:u}).then(_=>{}),l()},(u,_)=>n(_,u.concept,u.amount,u.type,u.id_expenses)]}class vo extends Ye{constructor(e){super(),Qe(this,e,mo,po,Je,{})}}const{document:Ht}=Sn;function Bt(o,e,t){const l=o.slice();return l[49]=e[t],l[51]=t,l}function Rt(o,e,t){const l=o.slice();return l[49]=e[t],l[51]=t,l}function Ut(o,e,t){const l=o.slice();return l[49]=e[t],l[51]=t,l}function Vt(o){let e,t;return e=new zn({props:{$$slots:{default:[zo]},$$scope:{ctx:o}}}),{c(){un(e.$$.fragment)},l(l){fn(e.$$.fragment,l)},m(l,n){dn(e,l,n),t=!0},p(l,n){const i={};n[0]&2043|n[1]&8388608&&(i.$$scope={dirty:n,ctx:l}),e.$set(i)},i(l){t||(rt(e.$$.fragment,l),t=!0)},o(l){ut(e.$$.fragment,l),t=!1},d(l){_n(e,l)}}}function go(o){let e,t='<div id="g_map" style="width: 100%; height: 100vh;"></div>';return{c(){e=s("ion-content"),e.innerHTML=t},l(l){e=c(l,"ION-CONTENT",{"data-svelte-h":!0}),ne(e)!=="svelte-1ydw6i9"&&(e.innerHTML=t)},m(l,n){K(l,e,n)},p:ze,d(l){l&&a(e)}}}function bo(o){let e;function t(i,d){if(i[7].length>0)return ko;if(!i[3])return Eo}let l=t(o),n=l&&l(o);return{c(){n&&n.c(),e=Se()},l(i){n&&n.l(i),e=Se()},m(i,d){n&&n.m(i,d),K(i,e,d)},p(i,d){l===(l=t(i))&&n?n.p(i,d):(n&&n.d(1),n=l&&l(i),n&&(n.c(),n.m(e.parentNode,e)))},d(i){i&&a(e),n&&n.d(i)}}}function Eo(o){let e,t,l,n='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Jala para actualizar" refreshing-spinner="circles" refreshing-text="Actualizando..."></ion-refresher-content>',i,d,u,_,I,E,h="0",f,v,k,N,L,U=o[6].origin+"",B,j,F,W="",H,C,S,A=[],P=new Map,V,M,D,R,x,oe=o[5].length+1+"",ee,fe,ae,re,be,Oe,Ee=o[6].destination+"",me,de,ue,Ne="",ve,ke,Ce,ge,ce=o[4]&&Ft(o),Z=Re(o[5]);const te=Q=>Q[49].id_event;for(let Q=0;Q<Z.length;Q+=1){let p=Bt(o,Z,Q),z=te(p);P.set(z,A[Q]=qt(z,p))}return{c(){ce&&ce.c(),e=y(),t=s("ion-content"),l=s("ion-refresher"),l.innerHTML=n,i=y(),d=s("ion-list"),u=s("ion-item"),_=s("ion-avatar"),I=s("div"),E=s("div"),E.textContent=h,v=y(),k=s("ion-label"),N=s("ion-text"),L=s("h3"),B=_e(U),j=y(),F=s("div"),F.innerHTML=W,H=y(),C=s("ion-icon"),S=y();for(let Q=0;Q<A.length;Q+=1)A[Q].c();V=y(),M=s("ion-item"),D=s("ion-avatar"),R=s("div"),x=s("div"),ee=_e(oe),ae=y(),re=s("ion-label"),be=s("ion-text"),Oe=s("h3"),me=_e(Ee),de=y(),ue=s("div"),ue.innerHTML=Ne,ve=y(),ke=s("ion-icon"),this.h()},l(Q){ce&&ce.l(Q),e=w(Q),t=c(Q,"ION-CONTENT",{});var p=m(t);l=c(p,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),ne(l)!=="svelte-1srnbs3"&&(l.innerHTML=n),i=w(p),d=c(p,"ION-LIST",{});var z=m(d);u=c(z,"ION-ITEM",{});var T=m(u);_=c(T,"ION-AVATAR",{slot:!0});var q=m(_);I=c(q,"DIV",{class:!0,title:!0,style:!0});var X=m(I);E=c(X,"DIV",{class:!0,"data-svelte-h":!0}),ne(E)!=="svelte-3lvlrb"&&(E.textContent=h),X.forEach(a),q.forEach(a),v=w(T),k=c(T,"ION-LABEL",{button:!0});var Y=m(k);N=c(Y,"ION-TEXT",{color:!0});var O=m(N);L=c(O,"H3",{});var J=m(L);B=he(J,U),J.forEach(a),O.forEach(a),j=w(Y),F=c(Y,"DIV",{class:!0,"data-svelte-h":!0}),ne(F)!=="svelte-gz9kb"&&(F.innerHTML=W),Y.forEach(a),H=w(T),C=c(T,"ION-ICON",{icon:!0,slot:!0}),m(C).forEach(a),T.forEach(a),S=w(z);for(let Ie=0;Ie<A.length;Ie+=1)A[Ie].l(z);V=w(z),M=c(z,"ION-ITEM",{});var le=m(M);D=c(le,"ION-AVATAR",{slot:!0});var $=m(D);R=c($,"DIV",{class:!0,title:!0,style:!0});var ie=m(R);x=c(ie,"DIV",{class:!0});var pe=m(x);ee=he(pe,oe),pe.forEach(a),ie.forEach(a),$.forEach(a),ae=w(le),re=c(le,"ION-LABEL",{button:!0});var Le=m(re);be=c(Le,"ION-TEXT",{color:!0});var ye=m(be);Oe=c(ye,"H3",{});var Te=m(Oe);me=he(Te,Ee),Te.forEach(a),ye.forEach(a),de=w(Le),ue=c(Le,"DIV",{class:!0,"data-svelte-h":!0}),ne(ue)!=="svelte-130ohbs"&&(ue.innerHTML=Ne),Le.forEach(a),ve=w(le),ke=c(le,"ION-ICON",{icon:!0,slot:!0}),m(ke).forEach(a),le.forEach(a),z.forEach(a),p.forEach(a),this.h()},h(){g(l,"slot","fixed"),G(E,"class","order svelte-egzizz"),G(I,"class","order-wrapper svelte-egzizz"),G(I,"title",f="$"+o[6].origin),b(I,"background-color",o[6].color),b(I,"color",Ae(o[6].color)),g(_,"slot","start"),g(N,"color","#2e2e2e"),G(F,"class","sub svelte-egzizz"),g(k,"button",""),g(C,"icon",Ue),g(C,"slot","end"),G(x,"class","order svelte-egzizz"),G(R,"class","order-wrapper svelte-egzizz"),G(R,"title",fe="$"+o[6].destination),b(R,"background-color",o[6].color),b(R,"color",Ae(o[6].color)),g(D,"slot","start"),g(be,"color","#2e2e2e"),G(ue,"class","sub svelte-egzizz"),g(re,"button",""),g(ke,"icon",Ue),g(ke,"slot","end")},m(Q,p){ce&&ce.m(Q,p),K(Q,e,p),K(Q,t,p),r(t,l),o[31](l),r(t,i),r(t,d),r(d,u),r(u,_),r(_,I),r(I,E),r(u,v),r(u,k),r(k,N),r(N,L),r(L,B),r(k,j),r(k,F),r(u,H),r(u,C),r(d,S);for(let z=0;z<A.length;z+=1)A[z]&&A[z].m(d,null);r(d,V),r(d,M),r(M,D),r(D,R),r(R,x),r(x,ee),r(M,ae),r(M,re),r(re,be),r(be,Oe),r(Oe,me),r(re,de),r(re,ue),r(M,ve),r(M,ke),Ce||(ge=[se(l,"ionRefresh",o[11]),se(k,"click",o[32]),se(re,"click",o[34])],Ce=!0)},p(Q,p){Q[4]?ce?ce.p(Q,p):(ce=Ft(Q),ce.c(),ce.m(e.parentNode,e)):ce&&(ce.d(1),ce=null),p[0]&64&&f!==(f="$"+Q[6].origin)&&G(I,"title",f),p[0]&64&&b(I,"background-color",Q[6].color),p[0]&64&&b(I,"color",Ae(Q[6].color)),p[0]&64&&U!==(U=Q[6].origin+"")&&we(B,U),p[0]&664608&&(Z=Re(Q[5]),A=$e(A,p,te,1,Q,Z,P,d,et,qt,V,Bt)),p[0]&32&&oe!==(oe=Q[5].length+1+"")&&we(ee,oe),p[0]&64&&fe!==(fe="$"+Q[6].destination)&&G(R,"title",fe),p[0]&64&&b(R,"background-color",Q[6].color),p[0]&64&&b(R,"color",Ae(Q[6].color)),p[0]&64&&Ee!==(Ee=Q[6].destination+"")&&we(me,Ee)},d(Q){Q&&(a(e),a(t)),ce&&ce.d(Q),o[31](null);for(let p=0;p<A.length;p+=1)A[p].d();Ce=!1,He(ge)}}}function ko(o){let e,t;function l(d,u){return u[0]&144&&(e=null),e==null&&(e=!!(d[7].filter(Mo).every(So)&&!d[4])),e?To:No}let n=l(o,[-1,-1]),i=n(o);return{c(){i.c(),t=Se()},l(d){i.l(d),t=Se()},m(d,u){i.m(d,u),K(d,t,u)},p(d,u){n===(n=l(d,u))&&i?i.p(d,u):(i.d(1),i=n(d),i&&(i.c(),i.m(t.parentNode,t)))},d(d){d&&a(t),i.d(d)}}}function Ft(o){let e=o[15]("",o[1],o[0])+"",t;return{c(){t=_e(e)},l(l){t=he(l,e)},m(l,n){K(l,t,n)},p(l,n){n[0]&3&&e!==(e=l[15]("",l[1],l[0])+"")&&we(t,e)},d(l){l&&a(t)}}}function jt(o){let e;return{c(){e=s("span"),this.h()},l(t){e=c(t,"SPAN",{class:!0}),m(e).forEach(a),this.h()},h(){G(e,"class","notes svelte-egzizz")},m(t,l){K(t,e,l)},d(t){t&&a(e)}}}function Io(o){let e;return{c(){e=s("ion-icon"),this.h()},l(t){e=c(t,"ION-ICON",{icon:!0,slot:!0,style:!0}),m(e).forEach(a),this.h()},h(){g(e,"icon",Ue),g(e,"slot","end"),b(e,"color",Me(o[49].status,o[49].date_service))},m(t,l){K(t,e,l)},p(t,l){l[0]&32&&b(e,"color",Me(t[49].status,t[49].date_service))},d(t){t&&a(e)}}}function Oo(o){let e,t=(o[49].tag?o[49].tag:"")+"",l;return{c(){e=s("div"),l=_e(t),this.h()},l(n){e=c(n,"DIV",{class:!0,slot:!0,style:!0});var i=m(e);l=he(i,t),i.forEach(a),this.h()},h(){G(e,"class","stop-tag"),G(e,"slot","end"),b(e,"background-color",Pe(o[49].tag_color,.3)),b(e,"border","1px solid "+Pe(o[49].tag_color,.4)),b(e,"color",o[49].tag_color),b(e,"font-size","10px"),b(e,"text-align","center"),b(e,"align-content","center"),b(e,"border-radius","20px"),b(e,"white-space","normal"),b(e,"padding","3px 6px"),b(e,"width","auto",1),b(e,"display","inline-block"),b(e,"font-weight","500")},m(n,i){K(n,e,i),r(e,l)},p(n,i){i[0]&32&&t!==(t=(n[49].tag?n[49].tag:"")+"")&&we(l,t),i[0]&32&&b(e,"background-color",Pe(n[49].tag_color,.3)),i[0]&32&&b(e,"border","1px solid "+Pe(n[49].tag_color,.4)),i[0]&32&&b(e,"color",n[49].tag_color)},d(n){n&&a(e)}}}function qt(o,e){let t,l,n,i,d=parseInt(e[49].pos)+1+"",u,_,I,E,h,f,v=e[49].title+"",k,N,L=e[49].support_list&&e[49].support_list.length||e[17](e[49]),U,B,j,F=L&&jt();function W(){return e[33](e[49])}function H(A,P){return A[49].tag_color&&A[49].tag?Oo:Io}let C=H(e),S=C(e);return{key:o,first:null,c(){t=s("ion-item"),l=s("ion-avatar"),n=s("div"),i=s("div"),u=_e(d),I=y(),E=s("ion-label"),h=s("ion-text"),f=s("h3"),k=_e(v),N=y(),F&&F.c(),U=y(),S.c(),this.h()},l(A){t=c(A,"ION-ITEM",{});var P=m(t);l=c(P,"ION-AVATAR",{slot:!0});var V=m(l);n=c(V,"DIV",{class:!0,title:!0,style:!0});var M=m(n);i=c(M,"DIV",{class:!0});var D=m(i);u=he(D,d),D.forEach(a),M.forEach(a),V.forEach(a),I=w(P),E=c(P,"ION-LABEL",{button:!0});var R=m(E);h=c(R,"ION-TEXT",{color:!0});var x=m(h);f=c(x,"H3",{});var oe=m(f);k=he(oe,v),N=w(oe),F&&F.l(oe),oe.forEach(a),x.forEach(a),R.forEach(a),U=w(P),S.l(P),P.forEach(a),this.h()},h(){G(i,"class","order svelte-egzizz"),G(n,"class","order-wrapper svelte-egzizz"),G(n,"title",_=We(e[49].status)),b(n,"background-color",Me(e[49].status,e[49].date_service)),b(n,"color",Ae(Me(e[49].status))),g(l,"slot","start"),g(h,"color","#2e2e2e"),g(E,"button",""),this.first=t},m(A,P){K(A,t,P),r(t,l),r(l,n),r(n,i),r(i,u),r(t,I),r(t,E),r(E,h),r(h,f),r(f,k),r(f,N),F&&F.m(f,null),r(t,U),S.m(t,null),B||(j=se(E,"click",W),B=!0)},p(A,P){e=A,P[0]&32&&d!==(d=parseInt(e[49].pos)+1+"")&&we(u,d),P[0]&32&&_!==(_=We(e[49].status))&&G(n,"title",_),P[0]&32&&b(n,"background-color",Me(e[49].status,e[49].date_service)),P[0]&32&&b(n,"color",Ae(Me(e[49].status))),P[0]&32&&v!==(v=e[49].title+"")&&we(k,v),P[0]&32&&(L=e[49].support_list&&e[49].support_list.length||e[17](e[49])),L?F||(F=jt(),F.c(),F.m(f,null)):F&&(F.d(1),F=null),C===(C=H(e))&&S?S.p(e,P):(S.d(1),S=C(e),S&&(S.c(),S.m(t,null)))},d(A){A&&a(t),F&&F.d(),S.d(),B=!1,j()}}}function No(o){let e=o[15](o[7],o[1],o[0])+"",t,l,n,i,d='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Pull to refresh" refreshing-spinner="circles" refreshing-text="Refreshing..."></ion-refresher-content>',u,_,I,E,h,f,v="0",k,N,L,U,B,j=o[6].origin+"",F,W,H,C="",S,A,P,V=[],M=new Map,D,R,x,oe,ee,fe=o[5].length+1+"",ae,re,be,Oe,Ee,me,de=o[6].destination+"",ue,Ne,ve,ke="",Ce,ge,ce,Z,te=Re(o[5]);const Q=p=>p[49].id_event;for(let p=0;p<te.length;p+=1){let z=Rt(o,te,p),T=Q(z);M.set(T,V[p]=Kt(T,z))}return{c(){t=_e(e),l=y(),n=s("ion-content"),i=s("ion-refresher"),i.innerHTML=d,u=y(),_=s("ion-list"),I=s("ion-item"),E=s("ion-avatar"),h=s("div"),f=s("div"),f.textContent=v,N=y(),L=s("ion-label"),U=s("ion-text"),B=s("h3"),F=_e(j),W=y(),H=s("div"),H.innerHTML=C,S=y(),A=s("ion-icon"),P=y();for(let p=0;p<V.length;p+=1)V[p].c();D=y(),R=s("ion-item"),x=s("ion-avatar"),oe=s("div"),ee=s("div"),ae=_e(fe),be=y(),Oe=s("ion-label"),Ee=s("ion-text"),me=s("h3"),ue=_e(de),Ne=y(),ve=s("div"),ve.innerHTML=ke,Ce=y(),ge=s("ion-icon"),this.h()},l(p){t=he(p,e),l=w(p),n=c(p,"ION-CONTENT",{});var z=m(n);i=c(z,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),ne(i)!=="svelte-dvt1s"&&(i.innerHTML=d),u=w(z),_=c(z,"ION-LIST",{});var T=m(_);I=c(T,"ION-ITEM",{});var q=m(I);E=c(q,"ION-AVATAR",{slot:!0});var X=m(E);h=c(X,"DIV",{class:!0,title:!0,style:!0});var Y=m(h);f=c(Y,"DIV",{class:!0,"data-svelte-h":!0}),ne(f)!=="svelte-3lvlrb"&&(f.textContent=v),Y.forEach(a),X.forEach(a),N=w(q),L=c(q,"ION-LABEL",{button:!0});var O=m(L);U=c(O,"ION-TEXT",{color:!0});var J=m(U);B=c(J,"H3",{});var le=m(B);F=he(le,j),le.forEach(a),J.forEach(a),W=w(O),H=c(O,"DIV",{class:!0,"data-svelte-h":!0}),ne(H)!=="svelte-gz9kb"&&(H.innerHTML=C),O.forEach(a),S=w(q),A=c(q,"ION-ICON",{icon:!0,slot:!0}),m(A).forEach(a),q.forEach(a),P=w(T);for(let Be=0;Be<V.length;Be+=1)V[Be].l(T);D=w(T),R=c(T,"ION-ITEM",{});var $=m(R);x=c($,"ION-AVATAR",{slot:!0});var ie=m(x);oe=c(ie,"DIV",{class:!0,title:!0,style:!0});var pe=m(oe);ee=c(pe,"DIV",{class:!0});var Le=m(ee);ae=he(Le,fe),Le.forEach(a),pe.forEach(a),ie.forEach(a),be=w($),Oe=c($,"ION-LABEL",{button:!0});var ye=m(Oe);Ee=c(ye,"ION-TEXT",{color:!0});var Te=m(Ee);me=c(Te,"H3",{});var Ie=m(me);ue=he(Ie,de),Ie.forEach(a),Te.forEach(a),Ne=w(ye),ve=c(ye,"DIV",{class:!0,"data-svelte-h":!0}),ne(ve)!=="svelte-130ohbs"&&(ve.innerHTML=ke),ye.forEach(a),Ce=w($),ge=c($,"ION-ICON",{icon:!0,slot:!0}),m(ge).forEach(a),$.forEach(a),T.forEach(a),z.forEach(a),this.h()},h(){g(i,"slot","fixed"),G(f,"class","order svelte-egzizz"),G(h,"class","order-wrapper svelte-egzizz"),G(h,"title",k="$"+o[6].origin),b(h,"background-color",o[6].color),b(h,"color",Ae(o[6].color)),g(E,"slot","start"),g(U,"color","#2e2e2e"),G(H,"class","sub svelte-egzizz"),g(L,"button",""),g(A,"icon",Ue),g(A,"slot","end"),G(ee,"class","order svelte-egzizz"),G(oe,"class","order-wrapper svelte-egzizz"),G(oe,"title",re="$"+o[6].destination),b(oe,"background-color",o[6].color),b(oe,"color",Ae(o[6].color)),g(x,"slot","start"),g(Ee,"color","#2e2e2e"),G(ve,"class","sub svelte-egzizz"),g(Oe,"button",""),g(ge,"icon",Ue),g(ge,"slot","end")},m(p,z){K(p,t,z),K(p,l,z),K(p,n,z),r(n,i),o[27](i),r(n,u),r(n,_),r(_,I),r(I,E),r(E,h),r(h,f),r(I,N),r(I,L),r(L,U),r(U,B),r(B,F),r(L,W),r(L,H),r(I,S),r(I,A),r(_,P);for(let T=0;T<V.length;T+=1)V[T]&&V[T].m(_,null);r(_,D),r(_,R),r(R,x),r(x,oe),r(oe,ee),r(ee,ae),r(R,be),r(R,Oe),r(Oe,Ee),r(Ee,me),r(me,ue),r(Oe,Ne),r(Oe,ve),r(R,Ce),r(R,ge),ce||(Z=[se(i,"ionRefresh",o[11]),se(L,"click",o[28]),se(Oe,"click",o[30])],ce=!0)},p(p,z){z[0]&131&&e!==(e=p[15](p[7],p[1],p[0])+"")&&we(t,e),z[0]&64&&k!==(k="$"+p[6].origin)&&G(h,"title",k),z[0]&64&&b(h,"background-color",p[6].color),z[0]&64&&b(h,"color",Ae(p[6].color)),z[0]&64&&j!==(j=p[6].origin+"")&&we(F,j),z[0]&664608&&(te=Re(p[5]),V=$e(V,z,Q,1,p,te,M,_,et,Kt,D,Rt)),z[0]&32&&fe!==(fe=p[5].length+1+"")&&we(ae,fe),z[0]&64&&re!==(re="$"+p[6].destination)&&G(oe,"title",re),z[0]&64&&b(oe,"background-color",p[6].color),z[0]&64&&b(oe,"color",Ae(p[6].color)),z[0]&64&&de!==(de=p[6].destination+"")&&we(ue,de)},d(p){p&&(a(t),a(l),a(n)),o[27](null);for(let z=0;z<V.length;z+=1)V[z].d();ce=!1,He(Z)}}}function To(o){let e,t,l='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Jale para actualizar" refreshing-spinner="circles" refreshing-text="Actualizando..."></ion-refresher-content>',n,i,d,u,_,I,E="0",h,f,v,k,N,L=o[6].origin+"",U,B,j,F="",W,H,C,S=[],A=new Map,P,V,M,D,R,x=o[5].length+1+"",oe,ee,fe,ae,re,be,Oe=o[6].destination+"",Ee,me,de,ue="",Ne,ve,ke,Ce,ge=Re(o[5]);const ce=Z=>Z[49].id_event;for(let Z=0;Z<ge.length;Z+=1){let te=Ut(o,ge,Z),Q=ce(te);A.set(Q,S[Z]=Wt(Q,te))}return{c(){e=s("ion-content"),t=s("ion-refresher"),t.innerHTML=l,n=y(),i=s("ion-list"),d=s("ion-item"),u=s("ion-avatar"),_=s("div"),I=s("div"),I.textContent=E,f=y(),v=s("ion-label"),k=s("ion-text"),N=s("h3"),U=_e(L),B=y(),j=s("div"),j.innerHTML=F,W=y(),H=s("ion-icon"),C=y();for(let Z=0;Z<S.length;Z+=1)S[Z].c();P=y(),V=s("ion-item"),M=s("ion-avatar"),D=s("div"),R=s("div"),oe=_e(x),fe=y(),ae=s("ion-label"),re=s("ion-text"),be=s("h3"),Ee=_e(Oe),me=y(),de=s("div"),de.innerHTML=ue,Ne=y(),ve=s("ion-icon"),this.h()},l(Z){e=c(Z,"ION-CONTENT",{});var te=m(e);t=c(te,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),ne(t)!=="svelte-15ukrgn"&&(t.innerHTML=l),n=w(te),i=c(te,"ION-LIST",{});var Q=m(i);d=c(Q,"ION-ITEM",{});var p=m(d);u=c(p,"ION-AVATAR",{slot:!0});var z=m(u);_=c(z,"DIV",{class:!0,title:!0,style:!0});var T=m(_);I=c(T,"DIV",{class:!0,"data-svelte-h":!0}),ne(I)!=="svelte-3lvlrb"&&(I.textContent=E),T.forEach(a),z.forEach(a),f=w(p),v=c(p,"ION-LABEL",{button:!0});var q=m(v);k=c(q,"ION-TEXT",{color:!0});var X=m(k);N=c(X,"H3",{});var Y=m(N);U=he(Y,L),Y.forEach(a),X.forEach(a),B=w(q),j=c(q,"DIV",{class:!0,"data-svelte-h":!0}),ne(j)!=="svelte-gz9kb"&&(j.innerHTML=F),q.forEach(a),W=w(p),H=c(p,"ION-ICON",{icon:!0,slot:!0}),m(H).forEach(a),p.forEach(a),C=w(Q);for(let ye=0;ye<S.length;ye+=1)S[ye].l(Q);P=w(Q),V=c(Q,"ION-ITEM",{});var O=m(V);M=c(O,"ION-AVATAR",{slot:!0});var J=m(M);D=c(J,"DIV",{class:!0,title:!0,style:!0});var le=m(D);R=c(le,"DIV",{class:!0});var $=m(R);oe=he($,x),$.forEach(a),le.forEach(a),J.forEach(a),fe=w(O),ae=c(O,"ION-LABEL",{button:!0});var ie=m(ae);re=c(ie,"ION-TEXT",{color:!0});var pe=m(re);be=c(pe,"H3",{});var Le=m(be);Ee=he(Le,Oe),Le.forEach(a),pe.forEach(a),me=w(ie),de=c(ie,"DIV",{class:!0,"data-svelte-h":!0}),ne(de)!=="svelte-130ohbs"&&(de.innerHTML=ue),ie.forEach(a),Ne=w(O),ve=c(O,"ION-ICON",{icon:!0,slot:!0}),m(ve).forEach(a),O.forEach(a),Q.forEach(a),te.forEach(a),this.h()},h(){g(t,"slot","fixed"),G(I,"class","order svelte-egzizz"),G(_,"class","order-wrapper svelte-egzizz"),G(_,"title",h="$"+o[6].origin),b(_,"background-color",o[6].color),b(_,"color",Ae(o[6].color)),g(u,"slot","start"),g(k,"color","#2e2e2e"),G(j,"class","sub svelte-egzizz"),g(v,"button",""),g(H,"icon",Ue),g(H,"slot","end"),G(R,"class","order svelte-egzizz"),G(D,"class","order-wrapper svelte-egzizz"),G(D,"title",ee="$"+o[6].destination),b(D,"background-color",o[6].color),b(D,"color",Ae(o[6].color)),g(M,"slot","start"),g(re,"color","#2e2e2e"),G(de,"class","sub svelte-egzizz"),g(ae,"button",""),g(ve,"icon",Ue),g(ve,"slot","end")},m(Z,te){K(Z,e,te),r(e,t),o[23](t),r(e,n),r(e,i),r(i,d),r(d,u),r(u,_),r(_,I),r(d,f),r(d,v),r(v,k),r(k,N),r(N,U),r(v,B),r(v,j),r(d,W),r(d,H),r(i,C);for(let Q=0;Q<S.length;Q+=1)S[Q]&&S[Q].m(i,null);r(i,P),r(i,V),r(V,M),r(M,D),r(D,R),r(R,oe),r(V,fe),r(V,ae),r(ae,re),r(re,be),r(be,Ee),r(ae,me),r(ae,de),r(V,Ne),r(V,ve),ke||(Ce=[se(t,"ionRefresh",o[11]),se(v,"click",o[24]),se(ae,"click",o[26])],ke=!0)},p(Z,te){te[0]&64&&h!==(h="$"+Z[6].origin)&&G(_,"title",h),te[0]&64&&b(_,"background-color",Z[6].color),te[0]&64&&b(_,"color",Ae(Z[6].color)),te[0]&64&&L!==(L=Z[6].origin+"")&&we(U,L),te[0]&664608&&(ge=Re(Z[5]),S=$e(S,te,ce,1,Z,ge,A,i,et,Wt,P,Ut)),te[0]&32&&x!==(x=Z[5].length+1+"")&&we(oe,x),te[0]&64&&ee!==(ee="$"+Z[6].destination)&&G(D,"title",ee),te[0]&64&&b(D,"background-color",Z[6].color),te[0]&64&&b(D,"color",Ae(Z[6].color)),te[0]&64&&Oe!==(Oe=Z[6].destination+"")&&we(Ee,Oe)},d(Z){Z&&a(e),o[23](null);for(let te=0;te<S.length;te+=1)S[te].d();ke=!1,He(Ce)}}}function Gt(o){let e;return{c(){e=s("span"),this.h()},l(t){e=c(t,"SPAN",{class:!0}),m(e).forEach(a),this.h()},h(){G(e,"class","notes svelte-egzizz")},m(t,l){K(t,e,l)},d(t){t&&a(e)}}}function Co(o){let e;return{c(){e=s("ion-icon"),this.h()},l(t){e=c(t,"ION-ICON",{icon:!0,slot:!0,style:!0}),m(e).forEach(a),this.h()},h(){g(e,"icon",Ue),g(e,"slot","end"),b(e,"color",Me(o[49].status,o[49].date_service))},m(t,l){K(t,e,l)},p(t,l){l[0]&32&&b(e,"color",Me(t[49].status,t[49].date_service))},d(t){t&&a(e)}}}function yo(o){let e,t=(o[49].tag?o[49].tag:"")+"",l;return{c(){e=s("div"),l=_e(t),this.h()},l(n){e=c(n,"DIV",{class:!0,slot:!0,style:!0});var i=m(e);l=he(i,t),i.forEach(a),this.h()},h(){G(e,"class","stop-tag"),G(e,"slot","end"),b(e,"background-color",Pe(o[49].tag_color,.3)),b(e,"border","1px solid "+Pe(o[49].tag_color,.4)),b(e,"color",o[49].tag_color),b(e,"font-size","10px"),b(e,"text-align","center"),b(e,"align-content","center"),b(e,"border-radius","20px"),b(e,"white-space","normal"),b(e,"padding","3px 6px"),b(e,"width","auto",1),b(e,"display","inline-block"),b(e,"font-weight","500")},m(n,i){K(n,e,i),r(e,l)},p(n,i){i[0]&32&&t!==(t=(n[49].tag?n[49].tag:"")+"")&&we(l,t),i[0]&32&&b(e,"background-color",Pe(n[49].tag_color,.3)),i[0]&32&&b(e,"border","1px solid "+Pe(n[49].tag_color,.4)),i[0]&32&&b(e,"color",n[49].tag_color)},d(n){n&&a(e)}}}function Kt(o,e){let t,l,n,i,d=parseInt(e[49].pos)+1+"",u,_,I,E,h,f,v=e[49].title+"",k,N,L=e[49].support_list&&e[49].support_list.length||e[17](e[49]),U,B,j="",F,W,H,C=L&&Gt();function S(){return e[29](e[49])}function A(M,D){return M[49].tag_color&&M[49].tag?yo:Co}let P=A(e),V=P(e);return{key:o,first:null,c(){t=s("ion-item"),l=s("ion-avatar"),n=s("div"),i=s("div"),u=_e(d),I=y(),E=s("ion-label"),h=s("ion-text"),f=s("h3"),k=_e(v),N=y(),C&&C.c(),U=y(),B=s("div"),B.innerHTML=j,F=y(),V.c(),this.h()},l(M){t=c(M,"ION-ITEM",{});var D=m(t);l=c(D,"ION-AVATAR",{slot:!0});var R=m(l);n=c(R,"DIV",{class:!0,title:!0,style:!0});var x=m(n);i=c(x,"DIV",{class:!0});var oe=m(i);u=he(oe,d),oe.forEach(a),x.forEach(a),R.forEach(a),I=w(D),E=c(D,"ION-LABEL",{button:!0});var ee=m(E);h=c(ee,"ION-TEXT",{color:!0});var fe=m(h);f=c(fe,"H3",{});var ae=m(f);k=he(ae,v),N=w(ae),C&&C.l(ae),ae.forEach(a),fe.forEach(a),U=w(ee),B=c(ee,"DIV",{class:!0,"data-svelte-h":!0}),ne(B)!=="svelte-qaecoo"&&(B.innerHTML=j),ee.forEach(a),F=w(D),V.l(D),D.forEach(a),this.h()},h(){G(i,"class","order svelte-egzizz"),G(n,"class","order-wrapper svelte-egzizz"),G(n,"title",_=We(e[49].status)),b(n,"background-color",Me(e[49].status,e[49].date_service)),b(n,"color",Ae(Me(e[49].status))),g(l,"slot","start"),g(h,"color","#2e2e2e"),G(B,"class","sub svelte-egzizz"),g(E,"button",""),this.first=t},m(M,D){K(M,t,D),r(t,l),r(l,n),r(n,i),r(i,u),r(t,I),r(t,E),r(E,h),r(h,f),r(f,k),r(f,N),C&&C.m(f,null),r(E,U),r(E,B),r(t,F),V.m(t,null),W||(H=se(E,"click",S),W=!0)},p(M,D){e=M,D[0]&32&&d!==(d=parseInt(e[49].pos)+1+"")&&we(u,d),D[0]&32&&_!==(_=We(e[49].status))&&G(n,"title",_),D[0]&32&&b(n,"background-color",Me(e[49].status,e[49].date_service)),D[0]&32&&b(n,"color",Ae(Me(e[49].status))),D[0]&32&&v!==(v=e[49].title+"")&&we(k,v),D[0]&32&&(L=e[49].support_list&&e[49].support_list.length||e[17](e[49])),L?C||(C=Gt(),C.c(),C.m(f,null)):C&&(C.d(1),C=null),P===(P=A(e))&&V?V.p(e,D):(V.d(1),V=P(e),V&&(V.c(),V.m(t,null)))},d(M){M&&a(t),C&&C.d(),V.d(),W=!1,H()}}}function Xt(o){let e;return{c(){e=s("span"),this.h()},l(t){e=c(t,"SPAN",{class:!0}),m(e).forEach(a),this.h()},h(){G(e,"class","notes svelte-egzizz")},m(t,l){K(t,e,l)},d(t){t&&a(e)}}}function wo(o){let e;return{c(){e=s("ion-icon"),this.h()},l(t){e=c(t,"ION-ICON",{icon:!0,slot:!0,style:!0}),m(e).forEach(a),this.h()},h(){g(e,"icon",Ue),g(e,"slot","end"),b(e,"color",Me(o[49].status,o[49].date_service))},m(t,l){K(t,e,l)},p(t,l){l[0]&32&&b(e,"color",Me(t[49].status,t[49].date_service))},d(t){t&&a(e)}}}function Lo(o){let e,t=(o[49].tag?o[49].tag:"")+"",l;return{c(){e=s("div"),l=_e(t),this.h()},l(n){e=c(n,"DIV",{class:!0,slot:!0,style:!0});var i=m(e);l=he(i,t),i.forEach(a),this.h()},h(){G(e,"class","stop-tag"),G(e,"slot","end"),b(e,"background-color",Pe(o[49].tag_color,.3)),b(e,"border","1px solid "+Pe(o[49].tag_color,.4)),b(e,"color",o[49].tag_color),b(e,"font-size","10px"),b(e,"text-align","center"),b(e,"align-content","center"),b(e,"border-radius","20px"),b(e,"white-space","normal"),b(e,"padding","3px 6px"),b(e,"width","auto",1),b(e,"display","inline-block"),b(e,"font-weight","500")},m(n,i){K(n,e,i),r(e,l)},p(n,i){i[0]&32&&t!==(t=(n[49].tag?n[49].tag:"")+"")&&we(l,t),i[0]&32&&b(e,"background-color",Pe(n[49].tag_color,.3)),i[0]&32&&b(e,"border","1px solid "+Pe(n[49].tag_color,.4)),i[0]&32&&b(e,"color",n[49].tag_color)},d(n){n&&a(e)}}}function Wt(o,e){let t,l,n,i,d=parseInt(e[49].pos)+1+"",u,_,I,E,h,f,v=e[49].title+"",k,N,L=e[49].support_list&&e[49].support_list.length||e[17](e[49]),U,B,j="",F,W,H,C=L&&Xt();function S(){return e[25](e[49])}function A(M,D){return M[49].tag_color&&M[49].tag?Lo:wo}let P=A(e),V=P(e);return{key:o,first:null,c(){t=s("ion-item"),l=s("ion-avatar"),n=s("div"),i=s("div"),u=_e(d),I=y(),E=s("ion-label"),h=s("ion-text"),f=s("h3"),k=_e(v),N=y(),C&&C.c(),U=y(),B=s("div"),B.innerHTML=j,F=y(),V.c(),this.h()},l(M){t=c(M,"ION-ITEM",{});var D=m(t);l=c(D,"ION-AVATAR",{slot:!0});var R=m(l);n=c(R,"DIV",{class:!0,title:!0,style:!0});var x=m(n);i=c(x,"DIV",{class:!0});var oe=m(i);u=he(oe,d),oe.forEach(a),x.forEach(a),R.forEach(a),I=w(D),E=c(D,"ION-LABEL",{button:!0});var ee=m(E);h=c(ee,"ION-TEXT",{color:!0});var fe=m(h);f=c(fe,"H3",{});var ae=m(f);k=he(ae,v),N=w(ae),C&&C.l(ae),ae.forEach(a),fe.forEach(a),U=w(ee),B=c(ee,"DIV",{class:!0,"data-svelte-h":!0}),ne(B)!=="svelte-qaecoo"&&(B.innerHTML=j),ee.forEach(a),F=w(D),V.l(D),D.forEach(a),this.h()},h(){G(i,"class","order svelte-egzizz"),G(n,"class","order-wrapper svelte-egzizz"),G(n,"title",_=We(e[49].status)),b(n,"background-color",Me(e[49].status,e[49].date_service)),b(n,"color",Ae(Me(e[49].status))),g(l,"slot","start"),g(h,"color","#2e2e2e"),G(B,"class","sub svelte-egzizz"),g(E,"button",""),this.first=t},m(M,D){K(M,t,D),r(t,l),r(l,n),r(n,i),r(i,u),r(t,I),r(t,E),r(E,h),r(h,f),r(f,k),r(f,N),C&&C.m(f,null),r(E,U),r(E,B),r(t,F),V.m(t,null),W||(H=se(E,"click",S),W=!0)},p(M,D){e=M,D[0]&32&&d!==(d=parseInt(e[49].pos)+1+"")&&we(u,d),D[0]&32&&_!==(_=We(e[49].status))&&G(n,"title",_),D[0]&32&&b(n,"background-color",Me(e[49].status,e[49].date_service)),D[0]&32&&b(n,"color",Ae(Me(e[49].status))),D[0]&32&&v!==(v=e[49].title+"")&&we(k,v),D[0]&32&&(L=e[49].support_list&&e[49].support_list.length||e[17](e[49])),L?C||(C=Xt(),C.c(),C.m(f,null)):C&&(C.d(1),C=null),P===(P=A(e))&&V?V.p(e,D):(V.d(1),V=P(e),V&&(V.c(),V.m(t,null)))},d(M){M&&a(t),C&&C.d(),V.d(),W=!1,H()}}}function zo(o){let e,t,l,n,i=`<ion-icon icon="${yn}"></ion-icon>`,d,u,_,I=`<ion-icon icon="${wn}"></ion-icon>`,E,h,f=(o[6].name?o[6].name.toUpperCase():"")+"",v,k,N,L='<ion-segment-button value="list"><ion-label>Paradas</ion-label></ion-segment-button> <ion-segment-button value="map"><ion-label>Mapa</ion-label></ion-segment-button>',U,B,j,F;function W(S,A){if(S[9]==="list")return bo;if(S[9]==="map")return go}let H=W(o),C=H&&H(o);return{c(){e=s("ion-header"),t=s("ion-toolbar"),l=s("ion-buttons"),n=s("ion-button"),n.innerHTML=i,d=y(),u=s("ion-buttons"),_=s("ion-button"),_.innerHTML=I,E=y(),h=s("ion-title"),v=_e(f),k=y(),N=s("ion-segment"),N.innerHTML=L,U=y(),C&&C.c(),B=Se(),this.h()},l(S){e=c(S,"ION-HEADER",{translucent:!0});var A=m(e);t=c(A,"ION-TOOLBAR",{});var P=m(t);l=c(P,"ION-BUTTONS",{slot:!0});var V=m(l);n=c(V,"ION-BUTTON",{title:!0,alt:!0,"data-svelte-h":!0}),ne(n)!=="svelte-7ppz3r"&&(n.innerHTML=i),V.forEach(a),d=w(P),u=c(P,"ION-BUTTONS",{slot:!0});var M=m(u);_=c(M,"ION-BUTTON",{"data-svelte-h":!0}),ne(_)!=="svelte-nf50hj"&&(_.innerHTML=I),M.forEach(a),E=w(P),h=c(P,"ION-TITLE",{});var D=m(h);v=he(D,f),D.forEach(a),P.forEach(a),k=w(A),N=c(A,"ION-SEGMENT",{value:!0,"data-svelte-h":!0}),ne(N)!=="svelte-lue4c9"&&(N.innerHTML=L),A.forEach(a),U=w(S),C&&C.l(S),B=Se(),this.h()},h(){g(n,"title","Atrás"),g(n,"alt","Atrás"),g(l,"slot","start"),g(u,"slot","end"),g(N,"value","list"),g(e,"translucent","")},m(S,A){K(S,e,A),r(e,t),r(t,l),r(l,n),r(t,d),r(t,u),r(u,_),r(t,E),r(t,h),r(h,v),r(e,k),r(e,N),K(S,U,A),C&&C.m(S,A),K(S,B,A),j||(F=[se(n,"click",o[18]),se(_,"click",o[21]),se(N,"ionChange",o[22])],j=!0)},p(S,A){A[0]&64&&f!==(f=(S[6].name?S[6].name.toUpperCase():"")+"")&&we(v,f),H===(H=W(S))&&C?C.p(S,A):(C&&C.d(1),C=H&&H(S),C&&(C.c(),C.m(B.parentNode,B)))},d(S){S&&(a(e),a(U),a(B)),C&&C.d(S),j=!1,He(F)}}}function Ao(o){let e,t,l,n=o[2]&&Vt(o);return{c(){e=y(),n&&n.c(),t=Se(),this.h()},l(i){rn("svelte-kn0kph",Ht.head).forEach(a),e=w(i),n&&n.l(i),t=Se(),this.h()},h(){Ht.title="Rutaflow - Detalles de ruta"},m(i,d){K(i,e,d),n&&n.m(i,d),K(i,t,d),l=!0},p(i,d){i[2]?n?(n.p(i,d),d[0]&4&&rt(n,1)):(n=Vt(i),n.c(),rt(n,1),n.m(t.parentNode,t)):n&&(hn(),ut(n,1,1,()=>{n=null}),cn())},i(i){l||(rt(n),l=!0)},o(i){ut(n),l=!1},d(i){i&&(a(e),a(t)),n&&n.d(i)}}}function Me(o,e=""){let t="#ffffff";return o==="pending"&&!e?t="#f2e300":o=="pending"&&e?t="#F6A833":o==="completed"&&(t="#44d900"),t}function We(o){let e="";return o=="pending"?e="Pendiente":o=="completed"&&(e="Completado"),e}function Ae(o){o.slice(0,1)==="#"&&(o=o.slice(1)),o.length===3&&(o=o.split("").map(function(i){return i+i}).join(""));const e=parseInt(o.substr(0,2),16),t=parseInt(o.substr(2,2),16),l=parseInt(o.substr(4,2),16);return(e*299+t*587+l*114)/1e3>=128?"#414040":"#fff"}function ct(o,e){for(let t=0;t<e.length;t++)if(e[t].alias===o)return e[t].val;return""}const Mo=o=>o.mandatory==="1",So=o=>o.img;function Do(o,e,t){let l;an(o,Ln,p=>t(20,l=p));var n=this&&this.__awaiter||function(p,z,T,q){function X(Y){return Y instanceof T?Y:new T(function(O){O(Y)})}return new(T||(T=Promise))(function(Y,O){function J(ie){try{$(q.next(ie))}catch(pe){O(pe)}}function le(ie){try{$(q.throw(ie))}catch(pe){O(pe)}}function $(ie){ie.done?Y(ie.value):X(ie.value).then(J,le)}$((q=q.apply(p,z||[])).next())})};let{routeId:i}=e,{driverId:d}=e,u=at,_=new Object,I=!0,E=!1,h=[],f={},v=[],k=[],N,L=!1,U="list",B,j="",F="",W="0",H=new Object;const C=()=>n(void 0,void 0,void 0,function*(){yield P(i),N.complete()});xe(()=>n(void 0,void 0,void 0,function*(){be(),yield P(i)}));function S(p){return n(this,void 0,void 0,function*(){if(t(9,U=p),U==="map"){yield sn(),B=document.getElementById("g_map");const z=new google.maps.Map(B,{zoom:8,center:{lat:20.6745683,lng:-103.3986104},mapId:"4504f8b37365c3d0"}),T=new google.maps.LatLngBounds,{AdvancedMarkerElement:q,PinElement:X}=yield google.maps.importLibrary("marker");navigator.geolocation?navigator.geolocation.getCurrentPosition(function(Y){const O=new google.maps.LatLng(Y.coords.latitude,Y.coords.longitude);new google.maps.Marker({position:O,map:z,icon:{path:google.maps.SymbolPath.CIRCLE,fillColor:"#0062ff",fillOpacity:1,scale:6,strokeColor:"#ffffff",strokeWeight:2}}),new google.maps.Circle({strokeColor:"#00BFFF",strokeOpacity:.5,strokeWeight:1,fillColor:"#00BFFF",fillOpacity:.2,map:z,center:O,radius:Y.coords.accuracy}),T.extend(O)},function(Y){console.error("Error retrieving location:",Y)}):console.error("Geolocation not supported by this browser."),f.lat1===f.lat2&&f.lon1===f.lon2?A(T,z,{lat:f.lat2,lon:f.lon2,color:f.color,title:f.destination},{type:"icon",iconClass:"icon-home",title:"Origen/Destino",glyph:`0,${String(h.length+1)}`}):(A(T,z,{lat:f.lat1,lon:f.lon1,color:f.color,title:f.origin},{type:"icon",iconClass:"icon-home",title:"Origen",glyph:"0"}),A(T,z,{lat:f.lat2,lon:f.lon2,color:f.color,title:f.destination},{type:"icon",iconClass:"icon-flag",title:"Destino",glyph:String(h.length+1)})),h.forEach((Y,O)=>{const J=parseFloat(Y.lat),le=parseFloat(Y.lon),$=new google.maps.LatLng(J,le),ie=new google.maps.Marker({position:{lat:J,lng:le},map:z,title:Y.title}),pe=new X({background:Me(Y.status,Y.date_service),borderColor:"#000",glyphColor:"#000",glyph:(parseInt(Y.pos)+1).toString()});new q({map:z,position:$,content:pe.element,title:"Parada "+(parseInt(Y.pos)+1).toString()+": "+Y.title}).addListener("click",function(ye){M(Y,!1)}),T.extend(ie.getPosition())}),z.fitBounds(T)}})}function A(p,z,T,q){return n(this,void 0,void 0,function*(){let X;const Y=parseFloat(T.lat),O=parseFloat(T.lon),J=new google.maps.LatLng(Y,O),{AdvancedMarkerElement:le,PinElement:$}=yield google.maps.importLibrary("marker");q.type=="icon"?(X=document.createElement("i"),X.className=`${q.iconClass} icon`,X.style.fontSize="14px",X.style.color=Ae(T.color),X.style.fontWeight="600"):q.type=="text";const ie=new google.maps.Marker({position:{lat:Y,lng:O},map:z,title:`${q.title}. ${T.title}`}),pe=new $({background:T.color,borderColor:"#000",glyphColor:Ae(T.color),glyph:q.glyph});return new le({map:z,position:J,content:pe.element,title:q.title+": "+T.title}).addListener("click",function(ye){D(f,q.title=="Destino"||q.title=="Origen/Destino")}),ie})}function P(p){return n(this,void 0,void 0,function*(){let z=new FormData;z.append("id_route",p),z=re(z),z.append("id_enterprise",_.id_enterprise);try{const q=yield(yield fetch(`${u}api/admin/report/seguimiento_list.php`,{method:"POST",body:z})).json();t(6,f=q.data.seguimiento_list[0]),t(5,h=q.data.event_list),t(7,v=q.data.checklist),k=q.data.expenses,f&&t(4,E=f.km_inicial=="0"&&f.gas_inicial=="0"),t(3,I=!1)}catch(T){t(3,I=!1),console.error("Error fetching data:",T)}})}const V=p=>new Promise((z,T)=>{let q=new FormData;q.append("id_route",p.id_route),q.append("id_event",p.id_event),q=re(q),fetch(`${u}api/admin/evidence/evidence_by_event.php`,{method:"POST",body:q}).then(X=>X.json()).then(X=>{z(X.data.event_evidence[0])}).catch(X=>{console.error("Error fetching data:",X),T(X)})}),M=(p,z)=>{V(p).then(T=>{p.stopsApproval=j,p.smsActive=F,T&&(p.img=T.img,p.driver_comments=T.driver_comments,p.comments=T.comments),Ve("modal-delivery-info",At,{delivery:p,isLast:z}).then(q=>{}).finally(()=>{P(i)})})},D=(p,z)=>{var T=new Object;z?T={title:p.destination,line1:p.dest_address}:T={title:p.origin,line1:p.origin_address},T.client_name=p.client_name,T.client_phone=p.tel,T.id_route=p.id_route,T.stopsApproval=j,T.smsActive=F;var q=!0;Ve("modal-delivery-info",At,{delivery:T,isLast:z,flag:q})},R=(p,z,T)=>{var q=!1;return L||(L=!0,Ve("modal-checklist",$t,{checklist:p,driverId:z,routeId:T,isLast:q}).then(X=>{L=!1}),ee(T,"checklist")),""},x=p=>n(void 0,void 0,void 0,function*(){return yield P(p),k.length>0?Ve("modal-expense-detail",vo,{routeId:p,expenses:k}).then(z=>{}):Ve("modal-expense",_t,{routeId:p}).then(z=>{}),""}),oe=p=>{if(p.tracking_type=="subscription"){if(p.subscriber_info&&p.payment_type==="cash"&&new Date(p.subscriber_info.payment_next)<new Date)return!0}else if(p.tracking_type=="ecommerce"&&Number(p.payment_pending)>0)return!0;return!1};function ee(p,z){let T=new FormData;return T.append("id_route",p),T.append("status",z),T=re(T),fetch(`${u}api/admin/route/change_status.php`,{method:"POST",body:T}).then(q=>q.json()).then(q=>{}).catch(q=>{console.error("Error fetching data:",q)}),""}const fe=()=>{_.type=="super"||_.type=="admin"?je("/drivers/me"):_.id_driver&&je(`/drivers/${_.id_driver}`)},ae=(p,z)=>n(void 0,void 0,void 0,function*(){yield(yield qe.create({header:p||"Error",message:z||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()});function re(p){return p.append("token",_.token),p.append("id_user_over",_.id_user),p}const be=()=>n(void 0,void 0,void 0,function*(){if(_.id_enterprise){let p=new FormData;p.append("id_enterprise",_.id_enterprise),p=re(p);try{const z=yield fetch(`${u}api/admin/enterprise/enterprise_settings.php`,{method:"POST",body:p});z.ok?(H=(yield z.json()).nodos,j=ct("stops_wait_approval",H),F=ct("sms_active",H),t(10,W=ct("stops_order_restriction",H))):console.error("File upload failed:",z.statusText)}catch(z){console.error("Error during file upload:",z)}}}),Oe=()=>x(i),Ee=p=>S(p.detail.value);function me(p){De[p?"unshift":"push"](()=>{N=p,t(8,N)})}const de=()=>{D(f,!1)},ue=p=>{const z=h.findIndex(O=>O.id_event===p.id_event),T=z===0,q=z>0?h[z-1]:null,X=T||q&&q.img!==null,Y=p.img!==null&&p.img!=="";X||T&&!Y||W=="1"?M(p,!1):ae("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")},Ne=()=>{D(f,!0)};function ve(p){De[p?"unshift":"push"](()=>{N=p,t(8,N)})}const ke=()=>{D(f,!1)},Ce=p=>{const z=h.findIndex(O=>O.id_event===p.id_event),T=z===0,q=z>0?h[z-1]:null,X=T||q&&q.img!==null,Y=p.img!==null&&p.img!=="";X||T&&!Y||W=="1"?M(p,!1):ae("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")},ge=()=>{D(f,!0)};function ce(p){De[p?"unshift":"push"](()=>{N=p,t(8,N)})}const Z=()=>{D(f,!1)},te=p=>{const z=h.findIndex(O=>O.id_event===p.id_event),T=z===0,q=z>0?h[z-1]:null,X=T||q&&q.img!==null,Y=p.img!==null&&p.img!=="";X||T&&!Y||W=="1"?M(p,!1):ae("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")},Q=()=>{D(f,!0)};return o.$$set=p=>{"routeId"in p&&t(0,i=p.routeId),"driverId"in p&&t(1,d=p.driverId)},o.$$.update=()=>{o.$$.dirty[0]&1048581&&(t(0,{routeId:i,driverId:d}=l.params,i,(t(1,d),t(20,l),t(2,_),t(0,i))),t(2,_=JSON.parse(localStorage.getItem("userSession"))),_?_.id_user&&(_.type=="admin"||_.type=="super")?(P(i),je(`/drivers/me/routes/${i}`)):_.id_user&&_.id_driver&&(P(i),je(`/drivers/${_.id_driver}/routes/${i}`)):je("/"))},[i,d,_,I,E,h,f,v,N,U,W,C,S,M,D,R,x,oe,fe,ae,l,Oe,Ee,me,de,ue,Ne,ve,ke,Ce,ge,ce,Z,te,Q]}class jo extends Ye{constructor(e){super(),Qe(this,e,Do,Ao,Je,{routeId:0,driverId:1},null,[-1,-1])}}export{jo as component};

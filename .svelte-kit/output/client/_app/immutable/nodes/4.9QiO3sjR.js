import{s as ke,j as R,k as A,l as ge,h as u,m as L,i as I,p as Ie,e as h,t as q,b as p,q as b,r as z,d as X,v as j,w as f,x as $,y as Y,z as Ee,A as ye,n as de,f as C,B as J,C as he}from"../chunks/index.BYLndrM5.js";import{S as Ne,i as Oe,t as Z,a as le,c as Te,b as we,d as Ae,m as Se,e as De,g as Re}from"../chunks/index.BNHbygFo.js";import{l as Le,p as He,e as x,u as pe,d as me}from"../chunks/index.CeQQYKs5.js";import"../chunks/index-48209844.IIRtDZyg.js";import{I as Me,a as Pe}from"../chunks/IonPage.KvUD72q2.js";import{g as K}from"../chunks/entry.BL0zc3kS.js";import"../chunks/authStore.Dl96eK1q.js";function oe(t,e,o){const l=t.slice();return l[19]=e[o],l}function se(t,e,o){const l=t.slice();return l[19]=e[o],l}function re(t){let e,o;return e=new Me({props:{$$slots:{default:[je]},$$scope:{ctx:t}}}),{c(){we(e.$$.fragment)},l(l){Ae(e.$$.fragment,l)},m(l,n){Se(e,l,n),o=!0},p(l,n){const r={};n&16777279&&(r.$$scope={dirty:n,ctx:l}),e.$set(r)},i(l){o||(Z(e.$$.fragment,l),o=!0)},o(l){le(e.$$.fragment,l),o=!1},d(l){De(e,l)}}}function Ce(t){let e=[],o=new Map,l,n=x(t[2].filter(t[13]));const r=i=>i[19].id_route;for(let i=0;i<n.length;i+=1){let s=oe(t,n,i),a=r(s);o.set(a,e[i]=ue(a,s))}return{c(){for(let i=0;i<e.length;i+=1)e[i].c();l=A()},l(i){for(let s=0;s<e.length;s+=1)e[s].l(i);l=A()},m(i,s){for(let a=0;a<e.length;a+=1)e[a]&&e[a].m(i,s);I(i,l,s)},p(i,s){s&901&&(n=x(i[2].filter(i[13])),e=pe(e,s,r,1,i,n,o,l.parentNode,me,ue,l,oe))},d(i){i&&u(l);for(let s=0;s<e.length;s+=1)e[s].d(i)}}}function Ve(t){let e=[],o=new Map,l,n=x(t[2]);const r=i=>i[19].id_route;for(let i=0;i<n.length;i+=1){let s=se(t,n,i),a=r(s);o.set(a,e[i]=fe(a,s))}return{c(){for(let i=0;i<e.length;i+=1)e[i].c();l=A()},l(i){for(let s=0;s<e.length;s+=1)e[s].l(i);l=A()},m(i,s){for(let a=0;a<e.length;a+=1)e[a]&&e[a].m(i,s);I(i,l,s)},p(i,s){s&900&&(n=x(i[2]),e=pe(e,s,r,1,i,n,o,l.parentNode,me,fe,l,se))},d(i){i&&u(l);for(let s=0;s<e.length;s+=1)e[s].d(i)}}}function qe(t){let e=t[8]("false")+"",o;return{c(){o=q(e)},l(l){o=z(l,e)},m(l,n){I(l,o,n)},p:de,d(l){l&&u(o)}}}function ze(t){let e=t[8]("true")+"",o,l,n,r=(t[19].status!="completed"||t[19].status!="cancelled")&&ae(t);return{c(){o=q(e),l=R(),r&&r.c(),n=A()},l(i){o=z(i,e),l=L(i),r&&r.l(i),n=A()},m(i,s){I(i,o,s),I(i,l,s),r&&r.m(i,s),I(i,n,s)},p(i,s){i[19].status!="completed"||i[19].status!="cancelled"?r?r.p(i,s):(r=ae(i),r.c(),r.m(n.parentNode,n)):r&&(r.d(1),r=null)},d(i){i&&(u(o),u(l),u(n)),r&&r.d(i)}}}function ae(t){let e,o,l,n,r=t[9](t[19].name.charAt(0))+"",i,s,a,_,S,k=t[19].name+"",E,B,g,O,v=t[19].date_start+"",M,V,c,w,H,P;return{c(){e=h("ion-item"),o=h("ion-avatar"),l=h("div"),n=h("div"),i=q(r),a=R(),_=h("ion-label"),S=h("h2"),E=q(k),B=R(),g=h("h3"),O=q("Inicio: "),M=q(v),V=R(),c=h("div"),w=R(),this.h()},l(y){e=p(y,"ION-ITEM",{button:!0});var d=b(e);o=p(d,"ION-AVATAR",{slot:!0});var D=b(o);l=p(D,"DIV",{class:!0,style:!0,title:!0});var N=b(l);n=p(N,"DIV",{class:!0,style:!0});var m=b(n);i=z(m,r),m.forEach(u),N.forEach(u),D.forEach(u),a=L(d),_=p(d,"ION-LABEL",{});var T=b(_);S=p(T,"H2",{});var U=b(S);E=z(U,k),U.forEach(u),B=L(T),g=p(T,"H3",{class:!0});var F=b(g);O=z(F,"Inicio: "),M=z(F,v),F.forEach(u),T.forEach(u),V=L(d),c=p(d,"DIV",{slot:!0}),b(c).forEach(u),w=L(d),d.forEach(u),this.h()},h(){C(n,"class","route-symbol svelte-1xh3ip"),C(n,"style",""),C(l,"class","route-color svelte-1xh3ip"),J(l,"background-color",G(t[19].status)),J(l,"color",te(G(t[19].status))),C(l,"title",s=ee(t[19].status)),j(o,"slot","start"),C(g,"class","text-muted svelte-1xh3ip"),C(c,"slot","end"),j(e,"button","")},m(y,d){I(y,e,d),f(e,o),f(o,l),f(l,n),f(n,i),f(e,a),f(e,_),f(_,S),f(S,E),f(_,B),f(_,g),f(g,O),f(g,M),f(e,V),f(e,c),f(e,w),H||(P=$(e,"click",function(){he(t[7](t[19].id_route,t[19].status))&&t[7](t[19].id_route,t[19].status).apply(this,arguments)}),H=!0)},p(y,d){t=y,d&5&&r!==(r=t[9](t[19].name.charAt(0))+"")&&Y(i,r),d&5&&J(l,"background-color",G(t[19].status)),d&5&&J(l,"color",te(G(t[19].status))),d&5&&s!==(s=ee(t[19].status))&&C(l,"title",s),d&5&&k!==(k=t[19].name+"")&&Y(E,k),d&5&&v!==(v=t[19].date_start+"")&&Y(M,v)},d(y){y&&u(e),H=!1,P()}}}function ue(t,e){let o,l,n;function r(a,_){return _&5&&(l=null),l==null&&(l=!!ve(a[19].date_start)),l?ze:qe}let i=r(e,-1),s=i(e);return{key:t,first:null,c(){o=A(),s.c(),n=A(),this.h()},l(a){o=A(),s.l(a),n=A(),this.h()},h(){this.first=o},m(a,_){I(a,o,_),s.m(a,_),I(a,n,_)},p(a,_){e=a,i===(i=r(e,_))&&s?s.p(e,_):(s.d(1),s=i(e),s&&(s.c(),s.m(n.parentNode,n)))},d(a){a&&(u(o),u(n)),s.d(a)}}}function Be(t){let e=t[8]("false")+"",o;return{c(){o=q(e)},l(l){o=z(l,e)},m(l,n){I(l,o,n)},p:de,d(l){l&&u(o)}}}function Ue(t){let e=t[8]("true")+"",o,l,n,r=(t[19].status!="completed"||t[19].status!="cancelled")&&ce(t);return{c(){o=q(e),l=R(),r&&r.c(),n=A()},l(i){o=z(i,e),l=L(i),r&&r.l(i),n=A()},m(i,s){I(i,o,s),I(i,l,s),r&&r.m(i,s),I(i,n,s)},p(i,s){i[19].status!="completed"||i[19].status!="cancelled"?r?r.p(i,s):(r=ce(i),r.c(),r.m(n.parentNode,n)):r&&(r.d(1),r=null)},d(i){i&&(u(o),u(l),u(n)),r&&r.d(i)}}}function ce(t){let e,o,l,n,r=t[9](t[19].name.charAt(0))+"",i,s,a,_,S,k=t[19].name+"",E,B,g,O,v=t[19].date_start+"",M,V,c,w,H,P;return{c(){e=h("ion-item"),o=h("ion-avatar"),l=h("div"),n=h("div"),i=q(r),a=R(),_=h("ion-label"),S=h("h2"),E=q(k),B=R(),g=h("h3"),O=q("Inicio: "),M=q(v),V=R(),c=h("div"),w=R(),this.h()},l(y){e=p(y,"ION-ITEM",{button:!0});var d=b(e);o=p(d,"ION-AVATAR",{slot:!0});var D=b(o);l=p(D,"DIV",{class:!0,style:!0,title:!0});var N=b(l);n=p(N,"DIV",{class:!0,style:!0});var m=b(n);i=z(m,r),m.forEach(u),N.forEach(u),D.forEach(u),a=L(d),_=p(d,"ION-LABEL",{});var T=b(_);S=p(T,"H2",{});var U=b(S);E=z(U,k),U.forEach(u),B=L(T),g=p(T,"H3",{class:!0});var F=b(g);O=z(F,"Inicio: "),M=z(F,v),F.forEach(u),T.forEach(u),V=L(d),c=p(d,"DIV",{slot:!0}),b(c).forEach(u),w=L(d),d.forEach(u),this.h()},h(){C(n,"class","route-symbol svelte-1xh3ip"),C(n,"style",""),C(l,"class","route-color svelte-1xh3ip"),J(l,"background-color",G(t[19].status)),J(l,"color",te(G(t[19].status))),C(l,"title",s=ee(t[19].status)),j(o,"slot","start"),C(g,"class","text-muted svelte-1xh3ip"),C(c,"slot","end"),j(e,"button","")},m(y,d){I(y,e,d),f(e,o),f(o,l),f(l,n),f(n,i),f(e,a),f(e,_),f(_,S),f(S,E),f(_,B),f(_,g),f(g,O),f(g,M),f(e,V),f(e,c),f(e,w),H||(P=$(e,"click",function(){he(t[7](t[19].id_route,t[19].status))&&t[7](t[19].id_route,t[19].status).apply(this,arguments)}),H=!0)},p(y,d){t=y,d&4&&r!==(r=t[9](t[19].name.charAt(0))+"")&&Y(i,r),d&4&&J(l,"background-color",G(t[19].status)),d&4&&J(l,"color",te(G(t[19].status))),d&4&&s!==(s=ee(t[19].status))&&C(l,"title",s),d&4&&k!==(k=t[19].name+"")&&Y(E,k),d&4&&v!==(v=t[19].date_start+"")&&Y(M,v)},d(y){y&&u(e),H=!1,P()}}}function fe(t,e){let o,l,n;function r(a,_){return _&4&&(l=null),l==null&&(l=!!ve(a[19].date_start)),l?Ue:Be}let i=r(e,-1),s=i(e);return{key:t,first:null,c(){o=A(),s.c(),n=A(),this.h()},l(a){o=A(),s.l(a),n=A(),this.h()},h(){this.first=o},m(a,_){I(a,o,_),s.m(a,_),I(a,n,_)},p(a,_){e=a,i===(i=r(e,_))&&s?s.p(e,_):(s.d(1),s=i(e),s&&(s.c(),s.m(n.parentNode,n)))},d(a){a&&(u(o),u(n)),s.d(a)}}}function _e(t){let e,o='<ion-row class="h-full items-center"><ion-col class="text-center"><h2 class="text-3xl text-muted mb-4 svelte-1xh3ip">No hay rutas pendientes para hoy</h2> <p class="text-muted svelte-1xh3ip">Espere indicaciones de su supervisor</p></ion-col></ion-row>';return{c(){e=h("ion-grid"),e.innerHTML=o,this.h()},l(l){e=p(l,"ION-GRID",{class:!0,"data-svelte-h":!0}),X(e)!=="svelte-3d9uou"&&(e.innerHTML=o),this.h()},h(){j(e,"class","ion-text-center h-full")},m(l,n){I(l,e,n)},d(l){l&&u(e)}}}function je(t){let e,o,l,n,r=t[1].name+"",i,s,a,_="Rutas del día",S,k,E,B=`<ion-icon icon="${Le}"></ion-icon>`,g,O,v,M='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Jale para actualizar" refreshing-spinner="circles" refreshing-text="Actualizando..."></ion-refresher-content>',V,c,w,H,P;function y(m,T){return m[0]=="me"&&m[4]?Ve:Ce}let d=y(t),D=d(t),N=!t[3]&&_e();return{c(){e=h("ion-header"),o=h("ion-toolbar"),l=h("ion-buttons"),n=h("ion-button"),i=q(r),s=R(),a=h("ion-title"),a.textContent=_,S=R(),k=h("ion-buttons"),E=h("ion-button"),E.innerHTML=B,g=R(),O=h("ion-content"),v=h("ion-refresher"),v.innerHTML=M,V=R(),c=h("ion-list"),D.c(),w=R(),N&&N.c(),this.h()},l(m){e=p(m,"ION-HEADER",{translucent:!0});var T=b(e);o=p(T,"ION-TOOLBAR",{});var U=b(o);l=p(U,"ION-BUTTONS",{slot:!0});var F=b(l);n=p(F,"ION-BUTTON",{});var ie=b(n);i=z(ie,r),ie.forEach(u),F.forEach(u),s=L(U),a=p(U,"ION-TITLE",{"data-svelte-h":!0}),X(a)!=="svelte-82wrsm"&&(a.textContent=_),S=L(U),k=p(U,"ION-BUTTONS",{slot:!0});var ne=b(k);E=p(ne,"ION-BUTTON",{title:!0,alt:!0,"data-svelte-h":!0}),X(E)!=="svelte-1itonhq"&&(E.innerHTML=B),ne.forEach(u),U.forEach(u),T.forEach(u),g=L(m),O=p(m,"ION-CONTENT",{});var Q=b(O);v=p(Q,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),X(v)!=="svelte-1wkherr"&&(v.innerHTML=M),V=L(Q),c=p(Q,"ION-LIST",{});var W=b(c);D.l(W),w=L(W),N&&N.l(W),W.forEach(u),Q.forEach(u),this.h()},h(){j(l,"slot","secondary"),j(E,"title","Salir"),j(E,"alt","Salir"),j(k,"slot","primary"),j(e,"translucent",""),j(v,"slot","fixed")},m(m,T){I(m,e,T),f(e,o),f(o,l),f(l,n),f(n,i),f(o,s),f(o,a),f(o,S),f(o,k),f(k,E),I(m,g,T),I(m,O,T),f(O,v),t[12](v),f(O,V),f(O,c),D.m(c,null),f(c,w),N&&N.m(c,null),H||(P=[$(E,"click",t[10]),$(v,"ionRefresh",t[6])],H=!0)},p(m,T){T&2&&r!==(r=m[1].name+"")&&Y(i,r),d===(d=y(m))&&D?D.p(m,T):(D.d(1),D=d(m),D&&(D.c(),D.m(c,w))),m[3]?N&&(N.d(1),N=null):N||(N=_e(),N.c(),N.m(c,null))},d(m){m&&(u(e),u(g),u(O)),t[12](null),D.d(),N&&N.d(),H=!1,Ee(P)}}}function Fe(t){let e,o,l,n=t[1]&&re(t);return{c(){e=R(),n&&n.c(),o=A(),this.h()},l(r){ge("svelte-qavk4j",document.head).forEach(u),e=L(r),n&&n.l(r),o=A(),this.h()},h(){document.title="Rutas - Rutaflow"},m(r,i){I(r,e,i),n&&n.m(r,i),I(r,o,i),l=!0},p(r,[i]){r[1]?n?(n.p(r,i),i&2&&Z(n,1)):(n=re(r),n.c(),Z(n,1),n.m(o.parentNode,o)):n&&(Re(),le(n,1,1,()=>{n=null}),Te())},i(r){l||(Z(n),l=!0)},o(r){le(n),l=!1},d(r){r&&(u(e),u(o)),n&&n.d(r)}}}function ve(t){var e=be();const o=t.split(" ")[0];return e===o}function G(t){let e="#ffffff";return t==="pending"?e="#dbb814b2":t==="completed"?e="#77d039":t=="enroute"?e="#5c7de8":t=="paused"?e="#949db9":t=="cancelled"?e="#ea0909b2":t=="checklist"?e="#11cab9b2":t=="checklist-pending"&&(e="#a8a8a8"),e}function ee(t){let e="";return t==="pending"?e="Pendiente":t==="completed"?e="Completado":t=="enroute"?e="En ruta":t=="paused"?e="Pausado":t=="cancelled"?e="Cancelado":t=="checklist"?e="En checklist":t=="checklist-pending"&&(e="Pendiente de aprobar checklist"),e}function te(t){t.slice(0,1)==="#"&&(t=t.slice(1)),t.length===3&&(t=t.split("").map(function(r){return r+r}).join(""));const e=parseInt(t.substr(0,2),16),o=parseInt(t.substr(2,2),16),l=parseInt(t.substr(4,2),16);return(e*299+o*587+l*114)/1e3>=128?"#414040":"#fff"}function be(){var t=new Date,e=t.getDate(),o=t.getMonth()+1,l=t.getFullYear();return e<10&&(e="0"+e),o<10&&(o="0"+o),t=l+"-"+o+"-"+e,t}function Je(t,e,o){let l;Ie(t,He,c=>o(11,l=c));let{driverId:n}=e,r=[],i=!1,s=!1,a=new Object,_;const S=async()=>{await k(),_.complete()};function k(c){var w=be();const H=new FormData;H.append("actual_date",w),fetch("https://app.rutaflow.com/api/admin/report/seguimiento_list.php",{method:"POST",body:H}).then(P=>P.json()).then(P=>{const y=P;o(2,r=y.data.seguimiento_list),y.data.event_list}).catch(P=>{console.error("Error fetching data:",P)})}function E(c,w){w=="checklist-pending"?O("Checklist Pendiente de Autorizar","La lista de requerimientos de ruta está en revisión, podrás inciar la ruta una vez autorizado el checklist."):K(`/drivers/${n}/routes/${c}`)}function B(c){return c=="true"?o(3,i=!0):o(3,i=!1),""}const g=c=>c.charAt(0).toUpperCase()+c.slice(1),O=async(c,w)=>{await(await Pe.create({header:c||"Error",message:w||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()},v=()=>{K("/"),o(4,s=!1),localStorage.removeItem("userSession")};function M(c){ye[c?"unshift":"push"](()=>{_=c,o(5,_)})}const V=c=>c.id_driver===n;return t.$$set=c=>{"driverId"in c&&o(0,n=c.driverId)},t.$$.update=()=>{if(t.$$.dirty&2051){o(0,{driverId:n}=l.params,n);const c=localStorage.getItem("userSession");o(1,a=JSON.parse(c)),a?n=="me"&&a.id_user?a.type=="admin"||a.type=="super"?(K("/drivers/me"),k(),o(4,s=!0)):(O("Usuario no autorizado","Este usuario no tiene acceso a la app de Rutaflow, entrar en contacto con soporte"),K("/")):a&&n&&(K(`/drivers/${a.id_driver}`),k()):(O("Sesión cerrada","Será redireccionado para volver a ingresar"),K("/"))}},[n,a,r,i,s,_,S,E,B,g,v,l,M,V]}class $e extends Ne{constructor(e){super(),Oe(this,e,Je,Fe,ke,{driverId:0})}}export{$e as component};

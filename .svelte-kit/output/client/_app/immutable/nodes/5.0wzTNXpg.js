import{Z as _t,s as We,e as s,j as y,b as c,q as m,d as te,h as a,m as w,v as g,i as J,w as o,x as ue,n as Le,z as He,_ as xt,B as k,o as Ze,k as Me,$ as ht,t as pe,r as me,f as W,a0 as $t,a1 as Qe,A as De,y as we,a2 as en,a3 as Ke,a4 as tn,a5 as nn,l as on,p as ln,F as rn}from"../chunks/index.CdEBkEwf.js";import{S as Je,i as Ye,t as it,a as ct,c as an,b as sn,d as cn,m as un,e as fn,g as dn}from"../chunks/index.c2pjNB5R.js";import{e as Be,u as xe,d as $e,a as _n,b as hn,c as pn,i as Wt,f as mn,g as Jt,h as vn,j as gn,k as ut,m as bn,n as Yt,s as pt,o as Re,q as En,r as In,t as kn,v as On,w as Nn,x as Tn,y as Cn,z as yn,p as wn}from"../chunks/index.885vwGL4.js";import"../chunks/index-48209844.IIRtDZyg.js";import{m as et,D as rt,a as je,I as Ln}from"../chunks/IonPage.BBTTLk2_.js";import{q as zn,t as An}from"../chunks/ion-modal.CsJaVgKZ.js";import{g as Fe}from"../chunks/entry.Dd6Gio1i.js";const Mn=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global,Sn=(i,e)=>{if(!customElements.get(i)){class t extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const n={};for(const r of this.attributes)n[r.name]=r.value;new e({target:this.shadowRoot,props:n})}}customElements.define(i,t)}},Dn=function(i){return document.createElement(i).constructor!==HTMLElement},Pn=(i,e)=>{Dn(i)||Sn(i,e)},Ue=async(i,e,t)=>{zn(),An(),Pn(i,e);const l=await et.create({component:i,componentProps:t});return l.present(),await l.onWillDismiss()};let Ge=_t({km_inicial:[],gas_inicial:[],km_final:[],gas_final:[]}),Qt=_t({flag:[]});function Hn(i){let e,t,l,n,r="Cancelar",d,u,_="Captura de Km/Gas",T,b,h,f="Confirmar",v,E,N,L,U,S,j;return{c(){e=s("ion-header"),t=s("ion-toolbar"),l=s("ion-buttons"),n=s("ion-button"),n.textContent=r,d=y(),u=s("ion-title"),u.textContent=_,T=y(),b=s("ion-buttons"),h=s("ion-button"),h.textContent=f,v=y(),E=s("ion-content"),N=s("ion-item"),L=s("ion-input"),this.h()},l(K){e=c(K,"ION-HEADER",{translucent:!0});var F=m(e);t=c(F,"ION-TOOLBAR",{});var A=m(t);l=c(A,"ION-BUTTONS",{slot:!0});var B=m(l);n=c(B,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),te(n)!=="svelte-17pq4f4"&&(n.textContent=r),B.forEach(a),d=w(A),u=c(A,"ION-TITLE",{"data-svelte-h":!0}),te(u)!=="svelte-1yhkaq7"&&(u.textContent=_),T=w(A),b=c(A,"ION-BUTTONS",{slot:!0});var I=m(b);h=c(I,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),te(h)!=="svelte-cm6j4s"&&(h.textContent=f),I.forEach(a),A.forEach(a),F.forEach(a),v=w(K),E=c(K,"ION-CONTENT",{fullscreen:!0});var D=m(E);N=c(D,"ION-ITEM",{});var H=m(N);L=c(H,"ION-INPUT",{class:!0,inputmode:!0,pattern:!0,type:!0,placeholder:!0,value:!0,required:!0});var R=m(L);R.forEach(a),H.forEach(a),D.forEach(a),this.h()},h(){g(n,"color","medium"),g(l,"slot","start"),g(h,"strong",""),g(b,"slot","end"),g(e,"translucent",""),g(L,"class","fin-km"),g(L,"inputmode","numeric"),g(L,"pattern","[0-9]*"),g(L,"type","number"),g(L,"placeholder",U="Ingresa "+i[0]+" actual"),g(L,"value",i[1]),g(L,"required",""),g(E,"fullscreen","")},m(K,F){J(K,e,F),o(e,t),o(t,l),o(l,n),o(t,d),o(t,u),o(t,T),o(t,b),o(b,h),J(K,v,F),J(K,E,F),o(E,N),o(N,L),S||(j=[ue(n,"click",i[2]),ue(h,"click",i[3]),ue(L,"input",i[4])],S=!0)},p(K,[F]){F&1&&U!==(U="Ingresa "+K[0]+" actual")&&g(L,"placeholder",U),F&2&&g(L,"value",K[1])},i:Le,o:Le,d(K){K&&(a(e),a(v),a(E)),S=!1,He(j)}}}function Bn(i,e,t){const l=xt();let r=document.querySelector("ion-modal").componentProps.data_type,d;Qt.subscribe(h=>{r=h.flag[0],r=="km_final"||r=="km_inicial"?t(0,d="kilometraje"):t(0,d="litros de gasolina")});let u=0;function _(){et.dismiss()}function T(){l("modalResult",{data:"Your data",role:"confirm"}),r=="km_inicial"?Ge.update(f=>({...f,km_inicial:[u]})):r=="gas_inicial"?Ge.update(f=>({...f,gas_inicial:[u]})):r=="km_final"?Ge.update(f=>({...f,km_final:[u]})):r=="gas_final"&&Ge.update(f=>({...f,gas_final:[u]})),_()}return[d,u,_,T,h=>t(1,u=h.target.value)]}class Rn extends Je{constructor(e){super(),Ye(this,e,Bn,Hn,We,{})}}const at=_t({items:[],checkedIndices:[],mandatory:[]});function gt(i,e,t){const l=i.slice();return l[55]=e[t],l[56]=e,l[57]=t,l}function Un(i){let e,t,l,n,r,d="Kilometraje inicial",u,_,T=i[0]?i[0]+" km.":"Cargar km",b,h,f,v,E,N,L,U="Gasolina inicial (litros)",S,j,K=i[1]?i[1]+" litros":"Cargar gas",F,A,B,I;return A=ht(i[21][0]),{c(){e=s("ion-item"),t=s("ion-label"),l=s("input"),n=y(),r=s("p"),r.textContent=d,u=y(),_=s("ion-button"),b=pe(T),h=y(),f=s("ion-item"),v=s("ion-label"),E=s("input"),N=y(),L=s("p"),L.textContent=U,S=y(),j=s("ion-button"),F=pe(K),this.h()},l(D){e=c(D,"ION-ITEM",{});var H=m(e);t=c(H,"ION-LABEL",{style:!0});var R=m(t);l=c(R,"INPUT",{id:!0,style:!0,type:!0}),n=w(R),r=c(R,"P",{style:!0,"data-svelte-h":!0}),te(r)!=="svelte-88twxi"&&(r.textContent=d),R.forEach(a),u=w(H),_=c(H,"ION-BUTTON",{fill:!0,size:!0,class:!0,"aria-selected":!0});var M=m(_);b=me(M,T),M.forEach(a),H.forEach(a),h=w(D),f=c(D,"ION-ITEM",{});var G=m(f);v=c(G,"ION-LABEL",{style:!0});var q=m(v);E=c(q,"INPUT",{id:!0,style:!0,type:!0}),N=w(q),L=c(q,"P",{style:!0,"data-svelte-h":!0}),te(L)!=="svelte-1ux30eb"&&(L.textContent=U),q.forEach(a),S=w(G),j=c(G,"ION-BUTTON",{fill:!0,class:!0,size:!0,style:!0});var $=m(j);F=me($,K),$.forEach(a),G.forEach(a),this.h()},h(){W(l,"id","chkbox-km-ini"),k(l,"pointer-events","auto"),W(l,"type","checkbox"),l.required=!0,k(r,"margin-left","10px"),k(t,"display","flex"),g(_,"fill","outline"),g(_,"size","small"),g(_,"class","loadKmInicial"),g(_,"aria-selected",""),W(E,"id","chkbox-gas-ini"),k(E,"pointer-events","auto"),W(E,"type","checkbox"),E.required=!0,k(L,"margin-left","10px"),k(v,"display","flex"),g(j,"fill","outline"),g(j,"class","loadGasInicial"),g(j,"size","small"),k(j,"height","16px "),A.p(l,E)},m(D,H){J(D,e,H),o(e,t),o(t,l),l.checked=~(i[4]||[]).indexOf(l.__value),i[28](l),o(t,n),o(t,r),o(e,u),o(e,_),o(_,b),J(D,h,H),J(D,f,H),o(f,v),o(v,E),i[30](E),E.checked=~(i[4]||[]).indexOf(E.__value),o(v,N),o(v,L),o(f,S),o(f,j),o(j,F),B||(I=[ue(l,"change",i[27]),ue(_,"click",i[29]),ue(E,"change",i[31]),ue(j,"click",i[32])],B=!0)},p(D,H){H[0]&16&&(l.checked=~(D[4]||[]).indexOf(l.__value)),H[0]&1&&T!==(T=D[0]?D[0]+" km.":"Cargar km")&&we(b,T),H[0]&16&&(E.checked=~(D[4]||[]).indexOf(E.__value)),H[0]&2&&K!==(K=D[1]?D[1]+" litros":"Cargar gas")&&we(F,K)},d(D){D&&(a(e),a(h),a(f)),i[28](null),i[30](null),A.r(),B=!1,He(I)}}}function Vn(i){let e,t,l,n,r,d="Kilometraje final",u,_,T=i[2]?i[2]+" km.":"Cargar km",b,h,f,v,E,N,L,U="Gasolina final (litros)",S,j,K=i[3]?i[3]+" litros":"Cargar gas",F,A,B,I;return A=ht(i[21][0]),{c(){e=s("ion-item"),t=s("ion-label"),l=s("input"),n=y(),r=s("p"),r.textContent=d,u=y(),_=s("ion-button"),b=pe(T),h=y(),f=s("ion-item"),v=s("ion-label"),E=s("input"),N=y(),L=s("p"),L.textContent=U,S=y(),j=s("ion-button"),F=pe(K),this.h()},l(D){e=c(D,"ION-ITEM",{});var H=m(e);t=c(H,"ION-LABEL",{style:!0});var R=m(t);l=c(R,"INPUT",{id:!0,style:!0,type:!0}),n=w(R),r=c(R,"P",{style:!0,"data-svelte-h":!0}),te(r)!=="svelte-ccmu71"&&(r.textContent=d),R.forEach(a),u=w(H),_=c(H,"ION-BUTTON",{fill:!0,size:!0,class:!0,"aria-selected":!0});var M=m(_);b=me(M,T),M.forEach(a),H.forEach(a),h=w(D),f=c(D,"ION-ITEM",{});var G=m(f);v=c(G,"ION-LABEL",{style:!0});var q=m(v);E=c(q,"INPUT",{id:!0,style:!0,type:!0}),N=w(q),L=c(q,"P",{style:!0,"data-svelte-h":!0}),te(L)!=="svelte-wsoyd2"&&(L.textContent=U),q.forEach(a),S=w(G),j=c(G,"ION-BUTTON",{fill:!0,size:!0,class:!0});var $=m(j);F=me($,K),$.forEach(a),G.forEach(a),this.h()},h(){W(l,"id","chkbox-km-fin"),k(l,"pointer-events","auto"),W(l,"type","checkbox"),l.required=!0,k(r,"margin-left","10px"),k(t,"display","flex"),g(_,"fill","outline"),g(_,"size","small"),g(_,"class","loadKmInicial"),g(_,"aria-selected",""),W(E,"id","chkbox-gas-fin"),k(E,"pointer-events","auto"),W(E,"type","checkbox"),E.required=!0,k(L,"margin-left","10px"),k(v,"display","flex"),g(j,"fill","outline"),g(j,"size","small"),g(j,"class","loadGasInicial"),A.p(l,E)},m(D,H){J(D,e,H),o(e,t),o(t,l),l.checked=~(i[4]||[]).indexOf(l.__value),i[22](l),o(t,n),o(t,r),o(e,u),o(e,_),o(_,b),J(D,h,H),J(D,f,H),o(f,v),o(v,E),E.checked=~(i[4]||[]).indexOf(E.__value),i[25](E),o(v,N),o(v,L),o(f,S),o(f,j),o(j,F),B||(I=[ue(l,"change",i[20]),ue(_,"click",i[23]),ue(E,"change",i[24]),ue(j,"click",i[26])],B=!0)},p(D,H){H[0]&16&&(l.checked=~(D[4]||[]).indexOf(l.__value)),H[0]&4&&T!==(T=D[2]?D[2]+" km.":"Cargar km")&&we(b,T),H[0]&16&&(E.checked=~(D[4]||[]).indexOf(E.__value)),H[0]&8&&K!==(K=D[3]?D[3]+" litros":"Cargar gas")&&we(F,K)},d(D){D&&(a(e),a(h),a(f)),i[22](null),i[25](null),A.r(),B=!1,He(I)}}}function Fn(i){let e=[],t=new Map,l,n=Be(i[13]);const r=d=>d[55].id_checklist_event;for(let d=0;d<n.length;d+=1){let u=gt(i,n,d),_=r(u);t.set(_,e[d]=bt(_,u))}return{c(){for(let d=0;d<e.length;d+=1)e[d].c();l=Me()},l(d){for(let u=0;u<e.length;u+=1)e[u].l(d);l=Me()},m(d,u){for(let _=0;_<e.length;_+=1)e[_]&&e[_].m(d,u);J(d,l,u)},p(d,u){u[0]&407664&&(n=Be(d[13]),e=xe(e,u,r,1,d,n,t,l.parentNode,$e,bt,l,gt))},d(d){d&&a(l);for(let u=0;u<e.length;u+=1)e[u].d(d)}}}function jn(i){let e,t=(i[12][i[55].id_checklist_event]?i[12][i[55].id_checklist_event]:"Cargar evidencia")+"",l;return{c(){e=s("label"),l=pe(t),this.h()},l(n){e=c(n,"LABEL",{for:!0,class:!0});var r=m(e);l=me(r,t),r.forEach(a),this.h()},h(){W(e,"for","chklist-"+i[55].id_checklist_event),W(e,"class","button-label svelte-1ruehls")},m(n,r){J(n,e,r),o(e,l)},p(n,r){r[0]&4096&&t!==(t=(n[12][n[55].id_checklist_event]?n[12][n[55].id_checklist_event]:"Cargar evidencia")+"")&&we(l,t)},d(n){n&&a(e)}}}function qn(i){let e;return{c(){e=s("ion-spinner"),this.h()},l(t){e=c(t,"ION-SPINNER",{name:!0,class:!0}),m(e).forEach(a),this.h()},h(){g(e,"name","dots"),g(e,"class","button-spinner svelte-1ruehls")},m(t,l){J(t,e,l)},p:Le,d(t){t&&a(e)}}}function bt(i,e){let t,l,n,r=e[55],d,u,_=e[55].item+"",T,b,h,f=e[55].mandatory=="1"?" * ":"",v,E,N,L,U,S,j,K,F,A;const B=()=>e[34](n,r),I=()=>e[34](null,r);function D(){return e[35](e[55])}function H(q,$){return q[11][q[55].id_checklist_event]?qn:jn}let R=H(e),M=R(e);function G(...q){return e[37](e[55],...q)}return K=ht(e[21][0]),{key:i,first:null,c(){t=s("ion-item"),l=s("ion-label"),n=s("input"),d=y(),u=s("p"),T=pe(_),b=y(),h=s("b"),v=pe(f),E=y(),N=s("ion-button"),L=s("div"),M.c(),U=y(),S=s("input"),j=y(),this.h()},l(q){t=c(q,"ION-ITEM",{});var $=m(t);l=c($,"ION-LABEL",{style:!0});var ne=m(l);n=c(ne,"INPUT",{id:!0,style:!0,type:!0}),d=w(ne),u=c(ne,"P",{style:!0});var oe=m(u);T=me(oe,_),b=w(oe),oe.forEach(a),h=c(ne,"B",{style:!0});var he=m(h);v=me(he,f),he.forEach(a),ne.forEach(a),E=w($),N=c($,"ION-BUTTON",{fill:!0,class:!0,size:!0});var ce=m(N);L=c(ce,"DIV",{class:!0});var ae=m(L);M.l(ae),U=w(ae),S=c(ae,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0,capture:!0}),ae.forEach(a),ce.forEach(a),j=w($),$.forEach(a),this.h()},h(){W(n,"id",`chkbox-${e[55].id_checklist_event}`),k(n,"pointer-events","auto"),W(n,"type","checkbox"),n.__value=e[55].id_checklist_event,$t(n,n.__value),n.required=!0,k(u,"margin-left","10px"),k(h,"margin-left","5px"),k(l,"display","flex"),k(S,"display","none"),W(S,"id","chklist-"+e[55].id_checklist_event),W(S,"name","fileToUpload"),W(S,"type","file"),W(S,"accept","image/*"),W(S,"capture","environment"),W(L,"class","button-content svelte-1ruehls"),g(N,"fill","outline"),g(N,"class","loadEvidence svelte-1ruehls"),g(N,"size","small"),K.p(n),this.first=t},m(q,$){J(q,t,$),o(t,l),o(l,n),n.checked=~(e[4]||[]).indexOf(n.__value),B(),o(l,d),o(l,u),o(u,T),o(u,b),o(l,h),o(h,v),o(t,E),o(t,N),o(N,L),M.m(L,null),o(L,U),o(L,S),e[36](S),o(t,j),F||(A=[ue(n,"change",e[33]),ue(n,"change",D),ue(S,"change",G)],F=!0)},p(q,$){e=q,$[0]&16&&(n.checked=~(e[4]||[]).indexOf(n.__value)),r!==e[55]&&(I(),r=e[55],B()),R===(R=H(e))&&M?M.p(e,$):(M.d(1),M=R(e),M&&(M.c(),M.m(L,U)))},d(q){q&&a(t),I(),M.d(),e[36](null),K.r(),F=!1,He(A)}}}function Gn(i){let e,t,l,n,r="Cancelar",d,u,_="REQUERIMIENTOS DE RUTA",T,b,h,f,v,E,N,L="Confirmar",U,S;function j(B,I){return B[14]?Vn:Un}let F=j(i)(i),A=i[13]&&Fn(i);return{c(){e=s("ion-header"),t=s("ion-toolbar"),l=s("ion-buttons"),n=s("ion-button"),n.textContent=r,d=y(),u=s("ion-title"),u.textContent=_,T=y(),b=s("ion-content"),h=s("ion-list"),F.c(),f=y(),A&&A.c(),v=y(),E=s("ion-footer"),N=s("ion-button"),N.textContent=L,this.h()},l(B){e=c(B,"ION-HEADER",{translucent:!0});var I=m(e);t=c(I,"ION-TOOLBAR",{});var D=m(t);l=c(D,"ION-BUTTONS",{slot:!0});var H=m(l);n=c(H,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),te(n)!=="svelte-1dnmkxs"&&(n.textContent=r),H.forEach(a),d=w(D),u=c(D,"ION-TITLE",{"data-svelte-h":!0}),te(u)!=="svelte-19bar5p"&&(u.textContent=_),D.forEach(a),I.forEach(a),T=w(B),b=c(B,"ION-CONTENT",{fullscreen:!0});var R=m(b);h=c(R,"ION-LIST",{});var M=m(h);F.l(M),f=w(M),A&&A.l(M),M.forEach(a),R.forEach(a),v=w(B),E=c(B,"ION-FOOTER",{});var G=m(E);N=c(G,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),te(N)!=="svelte-g82qqw"&&(N.textContent=L),G.forEach(a),this.h()},h(){g(n,"color","medium"),g(l,"slot","start"),g(e,"translucent",""),g(b,"fullscreen",""),g(N,"fill","outline"),g(N,"color","tertiary"),g(N,"strong",""),k(N,"width","99%"),k(N,"height","auto")},m(B,I){J(B,e,I),o(e,t),o(t,l),o(l,n),o(t,d),o(t,u),J(B,T,I),J(B,b,I),o(b,h),F.m(h,null),o(h,f),A&&A.m(h,null),J(B,v,I),J(B,E,I),o(E,N),U||(S=[ue(n,"click",i[15]),ue(N,"click",i[16])],U=!0)},p(B,I){F.p(B,I),B[13]&&A.p(B,I)},i:Le,o:Le,d(B){B&&(a(e),a(T),a(b),a(v),a(E)),F.d(),A&&A.d(),U=!1,He(S)}}}function ft(i,e){if(typeof i=="object"&&i!==null||Array.isArray(i)){if(Array.isArray(i))return i.map(t=>ft(t,e)).flat();{const t=Object.keys(i);let l;return e=="id_checklist_event"?l=t.filter(r=>r.toLowerCase().includes("id_checklist_event")).map(r=>i[r]):e=="mandatory"?l=t.filter(r=>r.toLowerCase().includes("mandatory")).map(r=>i[r]):(console.error("Tipo de dato no reconocido."),l=!1),l}}else return console.error("Invalid input. Please provide a valid object or array."),[]}function Kn(i,e,t){let l=rt,n=document.querySelector("ion-modal");const r=n.componentProps.checklist,d=n.componentProps.driverId,u=n.componentProps.routeId,_=n.componentProps.isLast;let T,b,h,f,v=[],E=null,N={},L,U,S,j,K={},F=new Object,A={},B={};Ze(()=>{F=JSON.parse(localStorage.getItem("userSession")),_?console.log("Último checklist"):at.update(P=>(P.mandatory=ft(r,"mandatory"),P.items=ft(r,"id_checklist_event"),P))});function I(P){t(11,K[P]=!0,K)}const D=async()=>{await(await je.create({header:"Datos o checklist incompletos",message:"Carga la evidencia requerida y marca todas las casillas para confirmar",buttons:[{text:"Cerrar"}]})).present()},H=async()=>{await(await je.create({header:"Datos capturados",message:"El kilometraje y gasolina final fueron registrados correctamente, espere aprobación para finalizar ruta",buttons:[{text:"Cerrar"}]})).present()},R=async P=>{await(await je.create({header:"Datos inválidos",message:P=="km"?"Llena correctamente el campo de kilometraje inicial":"Llena correctamente el campo de gasolina inicial",buttons:[{text:"Cerrar"}]})).present()},M=()=>{et.dismiss(),d?Fe(`/drivers/${d}`):Fe("/drivers/me")},G=()=>{if(_){var P=he(h,"km"),z=he(f,"gas");let ie=new FormData;ie.append("km_final",P),ie.append("gas_final",z),ie.append("id_route",u),ie=_e(ie),P&&z?(M(),fetch(`${l}api/admin/checklist/add_evidence.php`,{method:"POST",body:ie}).then(fe=>fe.json()).then(fe=>{H()}).catch(fe=>{console.error("Error fetching data:",fe)})):D()}else{var X=he(T,"km"),x=he(b,"gas");at.update(ie=>{ie.items;const fe=ie.mandatory;if(ie.items.filter((ge,de)=>ie.mandatory[de]==="1").every(ge=>ie.checkedIndices.includes(ge))&&X&&x){M();let ge=new FormData;ge=_e(ge),ge.append("km_inicial",X),ge.append("gas_inicial",x),ge.append("id_route",u);for(const de in A)if(A.hasOwnProperty(de)){const{img:Se,img_id:qe}=A[de];ge.append(`selectedImages[${de}][img]`,Se),ge.append(`selectedImages[${de}][img_id]`,qe)}fetch(`${l}api/admin/checklist/add_evidence.php`,{method:"POST",body:ge}).then(de=>de.json()).then(de=>{fe&&fe.some(Se=>Se==="1")?oe(u,"checklist-pending"):oe(u,"enroute")}).catch(de=>{console.error("Error fetching data:",de)})}else if(!fe&&X&&x){let ge=new FormData;ge.append("km_inicial",X),ge.append("gas_inicial",x),ge=_e(ge),fetch(`${l}api/admin/checklist/add_evidence.php`,{method:"POST",body:ge}).then(de=>de.json()).then(de=>{oe(u,"enroute")}).catch(de=>{console.error("Error fetching data:",de)})}else D();return ie})}Ee()},q=async(P,z)=>{I(z);const x=P.target.files[0],ie=await $(x);if(ie){let fe=new FormData;fe.append("fileToUpload",ie),fe=_e(fe);try{const ye=await fetch(`${l}api/admin/manager/upload_img_driver.php`,{method:"POST",body:fe});if(ye.ok){const se=await ye.json();A={...A,[z]:{img:se.img,img_id:se.img_id}},t(12,B={...B,[z]:se.filename}),ne(z),t(6,N[z].checked=!0,N),t(11,K[z]=!1,K)}else console.error("File upload failed:",ye.statusText)}catch(ye){console.error("Error during file upload:",ye)}}},$=async P=>new Promise(z=>{const X=new Image;X.src=URL.createObjectURL(P),X.onload=()=>{const x=document.createElement("canvas"),ie=x.getContext("2d"),fe=800,ye=600;let se=X.width,ge=X.height;se>fe&&(ge*=fe/se,se=fe),ge>ye&&(se*=ye/ge,ge=ye),x.width=se,x.height=ge,ie.drawImage(X,0,0,se,ge),x.toBlob(de=>{z(de),URL.revokeObjectURL(X.src),ie.clearRect(0,0,x.width,x.height)},"image/jpeg",.7)}}),ne=P=>{at.update(z=>(z.checkedIndices.indexOf(P)===-1?z.checkedIndices.push(P):console.error(`ID ${P} is already checked.`),z.items.forEach(x=>{x.id_checklist_event===P&&(x.checked=!0)}),z))};function oe(P,z){let X=new FormData;X.append("id_route",P),X.append("status",z),X=_e(X),fetch(`${l}api/admin/route/change_status.php`,{method:"POST",body:X}).then(x=>x.json()).then(x=>{}).catch(x=>{console.error("Error fetching data:",x)})}function he(P,z){return/^\d+$/.test(P)?parseInt(P,10):(R(z),null)}function ce(P,z){ae(z),n.componentProps.data_type=z,Ue("modal-gas-km",Rn,{r:z}).then(()=>{Ge.subscribe(X=>{Te(X,z)})})}function ae(P){Qt.update(z=>({...z,flag:[P]}))}function Te(P,z){t(0,T=P.km_inicial?P.km_inicial:null),t(1,b=P.gas_inicial?P.gas_inicial:null),t(2,h=P.km_final?P.km_final:null),t(3,f=P.gas_final?P.gas_final:null),z=="km_inicial"&&L&&t(7,L.checked=!0,L),z=="gas_inicial"&&U&&t(8,U.checked=!0,U),z=="km_final"&&S&&t(9,S.checked=!0,S),z=="gas_final"&&j&&t(10,j.checked=!0,j)}function Ee(){Ge.set({km_inicial:[],gas_inicial:[],km_final:[],gas_final:[]})}function _e(P){return P.append("token",F.token),P.append("id_user_over",F.id_user),P}const Ie=[[]];function Ce(){v=Qe(Ie[0],this.__value,this.checked),t(4,v)}function Oe(P){De[P?"unshift":"push"](()=>{S=P,t(9,S)})}const ke=P=>ce(P,"km_final");function ve(){v=Qe(Ie[0],this.__value,this.checked),t(4,v)}function Ne(P){De[P?"unshift":"push"](()=>{j=P,t(10,j)})}const ze=P=>ce(P,"gas_final");function be(){v=Qe(Ie[0],this.__value,this.checked),t(4,v)}function re(P){De[P?"unshift":"push"](()=>{L=P,t(7,L)})}const ee=P=>ce(P,"km_inicial");function le(P){De[P?"unshift":"push"](()=>{U=P,t(8,U)})}function Z(){v=Qe(Ie[0],this.__value,this.checked),t(4,v)}const p=P=>ce(P,"gas_inicial");function O(){v=Qe(Ie[0],this.__value,this.checked),t(4,v)}function C(P,z){De[P?"unshift":"push"](()=>{N[z.id_checklist_event]=P,t(6,N)})}const V=P=>ne(P.id_checklist_event);function Q(P){De[P?"unshift":"push"](()=>{E=P,t(5,E)})}return[T,b,h,f,v,E,N,L,U,S,j,K,B,r,_,M,G,q,ne,ce,Ce,Ie,Oe,ke,ve,Ne,ze,be,re,ee,le,Z,p,O,C,V,Q,(P,z)=>q(z,P.id_checklist_event)]}class Zt extends Je{constructor(e){super(),Ye(this,e,Kn,Gn,We,{},null,[-1,-1])}}function Et(i,e,t){const l=i.slice();return l[49]=e[t],l[51]=t,l}function Xn(i){let e,t,l="Confirmar",n,r;return{c(){e=s("ion-buttons"),t=s("ion-button"),t.textContent=l,this.h()},l(d){e=c(d,"ION-BUTTONS",{slot:!0});var u=m(e);t=c(u,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),te(t)!=="svelte-1ida0il"&&(t.textContent=l),u.forEach(a),this.h()},h(){g(t,"strong",""),g(e,"slot","end")},m(d,u){J(d,e,u),o(e,t),n||(r=ue(t,"click",i[20]),n=!0)},p:Le,d(d){d&&a(e),n=!1,r()}}}function Wn(i){let e,t,l,n,r,d="Teléfono de Negocio",u,_,T=i[11].client_phone+"",b;return{c(){e=s("ion-item"),t=s("ion-icon"),l=y(),n=s("ion-label"),r=s("p"),r.textContent=d,u=y(),_=s("h2"),b=pe(T),this.h()},l(h){e=c(h,"ION-ITEM",{href:!0});var f=m(e);t=c(f,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=w(f),n=c(f,"ION-LABEL",{class:!0});var v=m(n);r=c(v,"P",{"data-svelte-h":!0}),te(r)!=="svelte-1u5l7fz"&&(r.textContent=d),u=w(v),_=c(v,"H2",{});var E=m(_);b=me(E,T),E.forEach(a),v.forEach(a),f.forEach(a),this.h()},h(){g(t,"icon",hn),g(t,"slot","start"),g(n,"class","ion-text-wrap"),g(e,"href","tel:"+i[11].client_phone)},m(h,f){J(h,e,f),o(e,t),o(e,l),o(e,n),o(n,r),o(n,u),o(n,_),o(_,b)},p:Le,d(h){h&&a(e)}}}function Jn(i){let e,t,l,n,r,d="Domicilio Alternativo",u,_,T=i[11].line2+"",b,h,f;return{c(){e=s("ion-item"),t=s("ion-icon"),l=y(),n=s("ion-label"),r=s("p"),r.textContent=d,u=y(),_=s("h2"),b=pe(T),h=y(),f=s("ion-icon"),this.h()},l(v){e=c(v,"ION-ITEM",{href:!0});var E=m(e);t=c(E,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=w(E),n=c(E,"ION-LABEL",{class:!0});var N=m(n);r=c(N,"P",{"data-svelte-h":!0}),te(r)!=="svelte-1ub9uzw"&&(r.textContent=d),u=w(N),_=c(N,"H2",{});var L=m(_);b=me(L,T),L.forEach(a),N.forEach(a),h=w(E),f=c(E,"ION-ICON",{icon:!0,slot:!0}),m(f).forEach(a),E.forEach(a),this.h()},h(){g(t,"icon",pt),g(t,"slot","start"),g(n,"class","ion-text-wrap"),g(f,"icon",Re),g(f,"slot","end"),g(e,"href","https://www.google.com/maps/searhc/?api=1&query="+i[11].line2)},m(v,E){J(v,e,E),o(e,t),o(e,l),o(e,n),o(n,r),o(n,u),o(n,_),o(_,b),o(e,h),o(e,f)},p:Le,d(v){v&&a(e)}}}function Yn(i){let e,t,l,n,r,d="Domicilio",u,_,T=i[11].line1+"",b,h,f,v,E=i[11].line2&&i[11].line2.trim().length,N,L=E&&Qn(i);return{c(){e=s("ion-item"),t=s("ion-icon"),l=y(),n=s("ion-label"),r=s("p"),r.textContent=d,u=y(),_=s("h2"),b=pe(T),h=y(),f=s("ion-icon"),v=y(),L&&L.c(),N=Me(),this.h()},l(U){e=c(U,"ION-ITEM",{href:!0});var S=m(e);t=c(S,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=w(S),n=c(S,"ION-LABEL",{class:!0});var j=m(n);r=c(j,"P",{"data-svelte-h":!0}),te(r)!=="svelte-cbm7q1"&&(r.textContent=d),u=w(j),_=c(j,"H2",{});var K=m(_);b=me(K,T),K.forEach(a),j.forEach(a),h=w(S),f=c(S,"ION-ICON",{icon:!0,slot:!0}),m(f).forEach(a),S.forEach(a),v=w(U),L&&L.l(U),N=Me(),this.h()},h(){g(t,"icon",pt),g(t,"slot","start"),g(n,"class","ion-text-wrap"),g(f,"icon",Re),g(f,"slot","end"),g(e,"href","https://www.google.com/maps/search/?api=1&query="+i[11].line1)},m(U,S){J(U,e,S),o(e,t),o(e,l),o(e,n),o(n,r),o(n,u),o(n,_),o(_,b),o(e,h),o(e,f),J(U,v,S),L&&L.m(U,S),J(U,N,S)},p(U,S){E&&L.p(U,S)},d(U){U&&(a(e),a(v),a(N)),L&&L.d(U)}}}function Qn(i){let e,t,l,n,r,d="Domicilio Alternativo",u,_,T=i[11].line2+"",b,h,f;return{c(){e=s("ion-item"),t=s("ion-icon"),l=y(),n=s("ion-label"),r=s("p"),r.textContent=d,u=y(),_=s("h2"),b=pe(T),h=y(),f=s("ion-icon"),this.h()},l(v){e=c(v,"ION-ITEM",{href:!0});var E=m(e);t=c(E,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=w(E),n=c(E,"ION-LABEL",{class:!0});var N=m(n);r=c(N,"P",{"data-svelte-h":!0}),te(r)!=="svelte-1ub9uzw"&&(r.textContent=d),u=w(N),_=c(N,"H2",{});var L=m(_);b=me(L,T),L.forEach(a),N.forEach(a),h=w(E),f=c(E,"ION-ICON",{icon:!0,slot:!0}),m(f).forEach(a),E.forEach(a),this.h()},h(){g(t,"icon",pt),g(t,"slot","start"),g(n,"class","ion-text-wrap"),g(f,"icon",Re),g(f,"slot","end"),g(e,"href","https://www.google.com/maps/search/?api=1&query="+i[11].line2)},m(v,E){J(v,e,E),o(e,t),o(e,l),o(e,n),o(n,r),o(n,u),o(n,_),o(_,b),o(e,h),o(e,f)},p:Le,d(v){v&&a(e)}}}function It(i){let e,t,l,n,r,d="Contacto del Cliente",u,_,T,b,h=i[15]&&i[15]==="1"&&Zn(i);return{c(){e=s("ion-item"),t=s("ion-icon"),l=y(),n=s("ion-label"),r=s("p"),r.textContent=d,u=y(),_=s("h2"),T=pe(i[6]),b=y(),h&&h.c(),this.h()},l(f){e=c(f,"ION-ITEM",{});var v=m(e);t=c(v,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=w(v),n=c(v,"ION-LABEL",{class:!0});var E=m(n);r=c(E,"P",{"data-svelte-h":!0}),te(r)!=="svelte-1utsyb6"&&(r.textContent=d),u=w(E),_=c(E,"H2",{});var N=m(_);T=me(N,i[6]),N.forEach(a),E.forEach(a),b=w(v),h&&h.l(v),v.forEach(a),this.h()},h(){g(t,"icon",pn),g(t,"slot","start"),g(n,"class","ion-text-wrap")},m(f,v){J(f,e,v),o(e,t),o(e,l),o(e,n),o(n,r),o(n,u),o(n,_),o(_,T),o(e,b),h&&h.m(e,null)},p(f,v){v[0]&64&&we(T,f[6]),f[15]&&f[15]==="1"&&h.p(f,v)},d(f){f&&a(e),h&&h.d()}}}function Zn(i){let e,t=`<ion-icon icon="${En}" slot="start"></ion-icon>
                        Notificar Cliente`,l,n;return{c(){e=s("ion-button"),e.innerHTML=t,this.h()},l(r){e=c(r,"ION-BUTTON",{fill:!0,style:!0,"data-svelte-h":!0}),te(e)!=="svelte-w3qtwm"&&(e.innerHTML=t),this.h()},h(){g(e,"fill","outline"),k(e,"margin-left","16px")},m(r,d){J(r,e,d),l||(n=ue(e,"click",i[21]),l=!0)},p:Le,d(r){r&&a(e),l=!1,n()}}}function kt(i){let e,t,l,n,r,d="Notas de ubicación",u,_,T;return{c(){e=s("ion-item"),t=s("ion-icon"),l=y(),n=s("ion-label"),r=s("p"),r.textContent=d,u=y(),_=s("h2"),T=pe(i[7]),this.h()},l(b){e=c(b,"ION-ITEM",{});var h=m(e);t=c(h,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=w(h),n=c(h,"ION-LABEL",{class:!0});var f=m(n);r=c(f,"P",{"data-svelte-h":!0}),te(r)!=="svelte-nhm2ft"&&(r.textContent=d),u=w(f),_=c(f,"H2",{});var v=m(_);T=me(v,i[7]),v.forEach(a),f.forEach(a),h.forEach(a),this.h()},h(){g(t,"icon",Wt),g(t,"slot","start"),g(n,"class","ion-text-wrap")},m(b,h){J(b,e,h),o(e,t),o(e,l),o(e,n),o(n,r),o(n,u),o(n,_),o(_,T)},p(b,h){h[0]&128&&we(T,b[7])},d(b){b&&a(e)}}}function xn(i){let e,t,l,n,r,d="Horarios",u,_,T=i[11].schedule+"",b;return{c(){e=s("ion-item"),t=s("ion-icon"),l=y(),n=s("ion-label"),r=s("p"),r.textContent=d,u=y(),_=s("h2"),b=pe(T),this.h()},l(h){e=c(h,"ION-ITEM",{});var f=m(e);t=c(f,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=w(f),n=c(f,"ION-LABEL",{});var v=m(n);r=c(v,"P",{"data-svelte-h":!0}),te(r)!=="svelte-11q7hm5"&&(r.textContent=d),u=w(v),_=c(v,"H2",{});var E=m(_);b=me(E,T),E.forEach(a),v.forEach(a),f.forEach(a),this.h()},h(){g(t,"icon",mn),g(t,"slot","start")},m(h,f){J(h,e,f),o(e,t),o(e,l),o(e,n),o(n,r),o(n,u),o(n,_),o(_,b)},p:Le,d(h){h&&a(e)}}}function $n(i){let e,t,l,n,r,d="Notas del operador",u,_,T=i[11].driver_comments+"",b;return{c(){e=s("ion-item"),t=s("ion-icon"),l=y(),n=s("ion-label"),r=s("p"),r.textContent=d,u=y(),_=s("h2"),b=pe(T),this.h()},l(h){e=c(h,"ION-ITEM",{});var f=m(e);t=c(f,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=w(f),n=c(f,"ION-LABEL",{});var v=m(n);r=c(v,"P",{"data-svelte-h":!0}),te(r)!=="svelte-1yk9qp4"&&(r.textContent=d),u=w(v),_=c(v,"H2",{});var E=m(_);b=me(E,T),E.forEach(a),v.forEach(a),f.forEach(a),this.h()},h(){g(t,"icon",Jt),g(t,"slot","start")},m(h,f){J(h,e,f),o(e,t),o(e,l),o(e,n),o(n,r),o(n,u),o(n,_),o(_,b)},p:Le,d(h){h&&a(e)}}}function eo(i){let e,t=i[11].logistic_comments!="<br>"&&to(i);return{c(){t&&t.c(),e=Me()},l(l){t&&t.l(l),e=Me()},m(l,n){t&&t.m(l,n),J(l,e,n)},p(l,n){l[11].logistic_comments!="<br>"&&t.p(l,n)},d(l){l&&a(e),t&&t.d(l)}}}function to(i){let e,t,l,n,r,d="Comentarios logísticos",u,_,T=i[11].logistic_comments+"",b;return{c(){e=s("ion-item"),t=s("ion-icon"),l=y(),n=s("ion-label"),r=s("p"),r.textContent=d,u=y(),_=s("h2"),b=pe(T),this.h()},l(h){e=c(h,"ION-ITEM",{});var f=m(e);t=c(f,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=w(f),n=c(f,"ION-LABEL",{class:!0});var v=m(n);r=c(v,"P",{"data-svelte-h":!0}),te(r)!=="svelte-1iz85r6"&&(r.textContent=d),u=w(v),_=c(v,"H2",{});var E=m(_);b=me(E,T),E.forEach(a),v.forEach(a),f.forEach(a),this.h()},h(){g(t,"icon",Wt),g(t,"slot","start"),g(n,"class","ion-text-wrap")},m(h,f){J(h,e,f),o(e,t),o(e,l),o(e,n),o(n,r),o(n,u),o(n,_),o(_,b)},p:Le,d(h){h&&a(e)}}}function no(i){let e,t,l,n,r="<p>Tag de Parada</p>",d,u,_=(i[11].tag?i[11].tag:"")+"",T;return{c(){e=s("ion-item"),t=s("ion-icon"),l=y(),n=s("ion-label"),n.innerHTML=r,d=y(),u=s("div"),T=pe(_),this.h()},l(b){e=c(b,"ION-ITEM",{});var h=m(e);t=c(h,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=w(h),n=c(h,"ION-LABEL",{class:!0,"data-svelte-h":!0}),te(n)!=="svelte-10cks0z"&&(n.innerHTML=r),d=w(h),u=c(h,"DIV",{class:!0,style:!0});var f=m(u);T=me(f,_),f.forEach(a),h.forEach(a),this.h()},h(){g(t,"icon",vn),g(t,"slot","start"),g(n,"class","ion-text-wrap"),W(u,"class","stop-tag"),k(u,"background-color",i[11].tag_color?i[11].tag_color:""),k(u,"color","white"),k(u,"text-align","center"),k(u,"width","50%"),k(u,"border-radius","20px"),k(u,"position","relative"),k(u,"white-space","normal"),k(u,"font-size","14px")},m(b,h){J(b,e,h),o(e,t),o(e,l),o(e,n),o(e,d),o(e,u),o(u,T)},p:Le,d(b){b&&a(e)}}}function oo(i){let e,t,l,n,r,d="Estado de entrega",u,_,T="Entregado",b,h,f="No Entregado",v,E,N="Entrega Parcial",L,U,S,j,K,F,A,B,I=i[4]===!0&&Ot(i),D=(i[5]===!0||i[5]===!1&&i[4]===!1)&&Nt(i);return{c(){e=s("ion-item"),t=s("ion-icon"),l=y(),n=s("ion-select"),r=s("div"),r.textContent=d,u=y(),_=s("ion-select-option"),_.textContent=T,b=y(),h=s("ion-select-option"),h.textContent=f,v=y(),E=s("ion-select-option"),E.textContent=N,L=y(),U=s("ion-item"),S=s("ion-icon"),j=y(),K=s("ion-textarea"),F=y(),A=s("section"),I&&I.c(),B=y(),D&&D.c(),this.h()},l(H){e=c(H,"ION-ITEM",{});var R=m(e);t=c(R,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=w(R),n=c(R,"ION-SELECT",{value:!0});var M=m(n);r=c(M,"DIV",{slot:!0,"data-svelte-h":!0}),te(r)!=="svelte-1635zca"&&(r.textContent=d),u=w(M),_=c(M,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),te(_)!=="svelte-s33eln"&&(_.textContent=T),b=w(M),h=c(M,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),te(h)!=="svelte-1a859l3"&&(h.textContent=f),v=w(M),E=c(M,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),te(E)!=="svelte-1c4dcm8"&&(E.textContent=N),M.forEach(a),R.forEach(a),L=w(H),U=c(H,"ION-ITEM",{});var G=m(U);S=c(G,"ION-ICON",{icon:!0,slot:!0}),m(S).forEach(a),j=w(G),K=c(G,"ION-TEXTAREA",{label:!0,placeholder:!0}),m(K).forEach(a),G.forEach(a),F=w(H),A=c(H,"SECTION",{style:!0});var q=m(A);I&&I.l(q),B=w(q),D&&D.l(q),q.forEach(a),this.h()},h(){g(t,"icon",gn),g(t,"slot","start"),W(r,"slot","label"),g(_,"value","delivered"),g(h,"value","notdelivered"),g(E,"value","partialdeliver"),g(n,"value",i[14]?i[14]:"delivered"),g(S,"icon",ut),g(S,"slot","start"),g(K,"label","Notas"),g(K,"placeholder","Escribe aquí..."),k(A,"display","flex"),k(A,"gap","8px"),k(A,"padding","16px 16px 6px")},m(H,R){J(H,e,R),o(e,t),o(e,l),o(e,n),o(n,r),o(n,u),o(n,_),o(n,b),o(n,h),o(n,v),o(n,E),i[27](n),J(H,L,R),J(H,U,R),o(U,S),o(U,j),o(U,K),i[28](K),J(H,F,R),J(H,A,R),I&&I.m(A,null),o(A,B),D&&D.m(A,null)},p(H,R){H[4]===!0?I?I.p(H,R):(I=Ot(H),I.c(),I.m(A,B)):I&&(I.d(1),I=null),H[5]===!0||H[5]===!1&&H[4]===!1?D?D.p(H,R):(D=Nt(H),D.c(),D.m(A,null)):D&&(D.d(1),D=null)},d(H){H&&(a(e),a(L),a(U),a(F),a(A)),i[27](null),i[28](null),I&&I.d(),D&&D.d()}}}function Ot(i){let e,t=`<ion-icon icon="${In}" slot="start"></ion-icon>
                        Ingreso`,l,n;return{c(){e=s("ion-button"),e.innerHTML=t,this.h()},l(r){e=c(r,"ION-BUTTON",{id:!0,style:!0,"data-svelte-h":!0}),te(e)!=="svelte-3onvnr"&&(e.innerHTML=t),this.h()},h(){g(e,"id","checkInBtn"),k(e,"flex","1")},m(r,d){J(r,e,d),l||(n=ue(e,"click",i[22]),l=!0)},p:Le,d(r){r&&a(e),l=!1,n()}}}function Nt(i){let e,t,l,n,r,d;return{c(){e=s("ion-button"),t=s("ion-icon"),l=pe(`
                        Salida`),this.h()},l(u){e=c(u,"ION-BUTTON",{id:!0,style:!0,disabled:!0});var _=m(e);t=c(_,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=me(_,`
                        Salida`),_.forEach(a),this.h()},h(){g(t,"icon",bn),g(t,"slot","start"),g(e,"id","checkOutBtn"),k(e,"flex","1"),g(e,"disabled",n=i[5]===!1)},m(u,_){J(u,e,_),o(e,t),o(e,l),r||(d=ue(e,"click",i[23]),r=!0)},p(u,_){_[0]&32&&n!==(n=u[5]===!1)&&g(e,"disabled",n)},d(u){u&&a(e),r=!1,d()}}}function lo(i){let e,t,l,n,r,d="Subir Evidencia",u,_,T,b;return{c(){e=s("section"),t=s("ion-button"),l=s("ion-icon"),n=y(),r=s("label"),r.textContent=d,u=y(),_=s("input"),this.h()},l(h){e=c(h,"SECTION",{style:!0});var f=m(e);t=c(f,"ION-BUTTON",{fill:!0,class:!0,style:!0});var v=m(t);l=c(v,"ION-ICON",{icon:!0,slot:!0}),m(l).forEach(a),n=w(v),r=c(v,"LABEL",{for:!0,"data-svelte-h":!0}),te(r)!=="svelte-1wg51s6"&&(r.textContent=d),u=w(v),_=c(v,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0,capture:!0}),v.forEach(a),f.forEach(a),this.h()},h(){g(l,"icon",Yt),g(l,"slot","start"),W(r,"for","eventEvidence"),k(_,"display","none"),W(_,"id","eventEvidence"),W(_,"name","fileToUpload"),W(_,"type","file"),_.multiple=!0,W(_,"accept","image/*"),W(_,"capture","environment"),g(t,"fill","outline"),g(t,"class","loadEvidence"),k(t,"flex","1"),k(e,"display","flex"),k(e,"gap","8px"),k(e,"padding","0px 16px")},m(h,f){J(h,e,f),o(e,t),o(t,l),o(t,n),o(t,r),o(t,u),o(t,_),T||(b=[ue(_,"change",i[16]),ue(_,"click",i[17])],T=!0)},p:Le,d(h){h&&a(e),T=!1,He(b)}}}function Tt(i){let e,t,l=Be(i[2]),n=[];for(let r=0;r<l.length;r+=1)n[r]=Ct(Et(i,l,r));return{c(){e=s("section"),t=s("div");for(let r=0;r<n.length;r+=1)n[r].c();this.h()},l(r){e=c(r,"SECTION",{});var d=m(e);t=c(d,"DIV",{class:!0,style:!0});var u=m(t);for(let _=0;_<n.length;_+=1)n[_].l(u);u.forEach(a),d.forEach(a),this.h()},h(){W(t,"class","image-grid"),k(t,"display","grid"),k(t,"grid-template-columns","repeat(auto-fill, minmax(100px, 1fr))"),k(t,"gap","10px"),k(t,"padding","0px 10px")},m(r,d){J(r,e,d),o(e,t);for(let u=0;u<n.length;u+=1)n[u]&&n[u].m(t,null)},p(r,d){if(d[0]&17301508){l=Be(r[2]);let u;for(u=0;u<l.length;u+=1){const _=Et(r,l,u);n[u]?n[u].p(_,d):(n[u]=Ct(_),n[u].c(),n[u].m(t,null))}for(;u<n.length;u+=1)n[u].d(1);n.length=l.length}},d(r){r&&a(e),en(n,r)}}}function Ct(i){let e,t,l,n,r,d=`<ion-icon icon="${kn}"></ion-icon>`,u,_,T;function b(){return i[29](i[49])}function h(){return i[30](i[51])}return{c(){e=s("div"),t=s("ion-img"),n=y(),r=s("button"),r.innerHTML=d,u=y(),this.h()},l(f){e=c(f,"DIV",{class:!0,style:!0});var v=m(e);t=c(v,"ION-IMG",{src:!0,alt:!0,style:!0}),m(t).forEach(a),n=w(v),r=c(v,"BUTTON",{class:!0,style:!0,"data-svelte-h":!0}),te(r)!=="svelte-zguiov"&&(r.innerHTML=d),u=w(v),v.forEach(a),this.h()},h(){Ke(t.src,l=i[49])||g(t,"src",l),g(t,"alt","Evidencia fotográfica"),k(t,"width","100%"),k(t,"height","100px"),k(t,"object-fit","cover"),k(t,"cursor","pointer"),k(t,"border","1px solid #ccc"),k(t,"border-radius","4px"),k(t,"margin-top","16px"),W(r,"class","remove-button"),k(r,"position","absolute"),k(r,"top","5px"),k(r,"right","5px"),k(r,"border","none"),k(r,"cursor","pointer"),k(r,"font-size","18px"),k(r,"background","white"),k(r,"border-radius","50%"),k(r,"padding","3px 4px 0px"),k(r,"box-shadow","2px 2px 6px rgba(0, 0, 0, 0.3)"),k(r,"color","#0000008f"),W(e,"class","image-container"),k(e,"position","relative")},m(f,v){J(f,e,v),o(e,t),o(e,n),o(e,r),o(e,u),_||(T=[ue(t,"click",b),ue(r,"click",h)],_=!0)},p(f,v){i=f,v[0]&4&&!Ke(t.src,l=i[49])&&g(t,"src",l)},d(f){f&&a(e),_=!1,He(T)}}}function yt(i){let e,t='<ion-spinner name="dots" style="color:white;"></ion-spinner>';return{c(){e=s("div"),e.innerHTML=t,this.h()},l(l){e=c(l,"DIV",{class:!0,style:!0,"data-svelte-h":!0}),te(e)!=="svelte-h8s7r2"&&(e.innerHTML=t),this.h()},h(){W(e,"class","overlay"),k(e,"position","fixed"),k(e,"top","0"),k(e,"left","0"),k(e,"width","100vw"),k(e,"height","100vh"),k(e,"background","rgba(0, 0, 0, 0.5)"),k(e,"display","flex"),k(e,"align-items","center"),k(e,"justify-content","center"),k(e,"z-index","9999")},m(l,n){J(l,e,n)},d(l){l&&a(e)}}}function wt(i){let e,t,l,n,r,d,u=`<ion-icon icon="${On}"></ion-icon>`,_,T;return{c(){e=s("div"),t=s("div"),l=s("ion-img"),r=y(),d=s("button"),d.innerHTML=u,this.h()},l(b){e=c(b,"DIV",{class:!0,style:!0});var h=m(e);t=c(h,"DIV",{class:!0,style:!0});var f=m(t);l=c(f,"ION-IMG",{src:!0,alt:!0,style:!0}),m(l).forEach(a),r=w(f),d=c(f,"BUTTON",{class:!0,style:!0,"data-svelte-h":!0}),te(d)!=="svelte-g0qr0o"&&(d.innerHTML=u),f.forEach(a),h.forEach(a),this.h()},h(){Ke(l.src,n=i[9])||g(l,"src",n),g(l,"alt","Evidencia fotográfica"),k(l,"width","100%"),k(l,"height","auto"),W(d,"class","close-button"),k(d,"position","absolute"),k(d,"top","5px"),k(d,"right","5px"),k(d,"background","white"),k(d,"color","#444444d1"),k(d,"border","none"),k(d,"cursor","pointer"),k(d,"padding","2px 2px 0px 6px"),k(d,"border-radius","50%"),k(d,"font-size","20px"),W(t,"class","modal-content"),k(t,"position","relative"),k(t,"background","white"),k(t,"padding","20px"),k(t,"border-radius","8px"),k(t,"max-width","90vw"),k(t,"max-height","90vh"),k(t,"overflow","auto"),W(e,"class","modal-overlay"),k(e,"position","fixed"),k(e,"top","0"),k(e,"left","0"),k(e,"width","100vw"),k(e,"height","100vh"),k(e,"background","rgba(0, 0, 0, 0.8)"),k(e,"display","flex"),k(e,"justify-content","center"),k(e,"align-items","center"),k(e,"z-index","1000")},m(b,h){J(b,e,h),o(e,t),o(t,l),o(t,r),o(t,d),_||(T=[ue(d,"click",i[25]),ue(t,"click",tn(i[26])),ue(e,"click",i[25])],_=!0)},p(b,h){h[0]&512&&!Ke(l.src,n=b[9])&&g(l,"src",n)},d(b){b&&a(e),_=!1,He(T)}}}function io(i){let e,t,l,n,r="Cerrar",d,u,_=i[11].title+"",T,b,h,f,v,E,N,L,U,S,j="Negocio",K,F,A=i[11].client_name+"",B,I,D=i[11].client_phone&&i[11].client_phone.trim().length,H,R,M,G,q=i[11].schedule&&i[11].schedule.trim().length,$,ne,oe=i[11].logistic_comments&&i[11].logistic_comments.trim().length,he,ce,ae,Te,Ee,_e,Ie,Ce,Oe,ke=(!i[12]&&!i[13]||i[12]&&i[13])&&Xn(i),ve=D&&Wn(i);function Ne(z,X){if(z[11].line1&&z[11].line1.trim().length)return Yn;if(z[11].line2&&z[11].line2.trim().length)return Jn}let ze=Ne(i),be=ze&&ze(i),re=i[6]&&It(i),ee=i[7]&&i[7]!=="<br>"&&kt(i),le=q&&xn(i),Z=i[11].driver_comments&&$n(i),p=oe&&eo(i),O=i[11].tag&&i[11].tag_color&&no(i),C=!i[13]&&oo(i),V=(i[12]&&i[13]||!i[12]&&!i[13])&&lo(i),Q=i[1]&&Tt(i),Y=i[3]&&yt(),P=i[8]&&wt(i);return{c(){e=s("ion-header"),t=s("ion-toolbar"),l=s("ion-buttons"),n=s("ion-button"),n.textContent=r,d=y(),u=s("ion-title"),T=pe(_),b=y(),ke&&ke.c(),h=y(),f=s("ion-content"),v=s("ion-list"),E=s("ion-item"),N=s("ion-icon"),L=y(),U=s("ion-label"),S=s("p"),S.textContent=j,K=y(),F=s("h2"),B=pe(A),I=y(),ve&&ve.c(),H=y(),be&&be.c(),R=y(),re&&re.c(),M=y(),ee&&ee.c(),G=y(),le&&le.c(),$=y(),Z&&Z.c(),ne=y(),p&&p.c(),he=y(),O&&O.c(),ce=y(),C&&C.c(),ae=y(),V&&V.c(),Te=y(),Q&&Q.c(),Ee=y(),Y&&Y.c(),_e=y(),P&&P.c(),Ie=Me(),this.h()},l(z){e=c(z,"ION-HEADER",{translucent:!0});var X=m(e);t=c(X,"ION-TOOLBAR",{});var x=m(t);l=c(x,"ION-BUTTONS",{slot:!0});var ie=m(l);n=c(ie,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),te(n)!=="svelte-2ks32x"&&(n.textContent=r),ie.forEach(a),d=w(x),u=c(x,"ION-TITLE",{style:!0,title:!0});var fe=m(u);T=me(fe,_),fe.forEach(a),b=w(x),ke&&ke.l(x),x.forEach(a),X.forEach(a),h=w(z),f=c(z,"ION-CONTENT",{fullscreen:!0});var ye=m(f);v=c(ye,"ION-LIST",{});var se=m(v);E=c(se,"ION-ITEM",{});var ge=m(E);N=c(ge,"ION-ICON",{icon:!0,slot:!0}),m(N).forEach(a),L=w(ge),U=c(ge,"ION-LABEL",{});var de=m(U);S=c(de,"P",{"data-svelte-h":!0}),te(S)!=="svelte-57b1dg"&&(S.textContent=j),K=w(de),F=c(de,"H2",{});var Se=m(F);B=me(Se,A),Se.forEach(a),de.forEach(a),ge.forEach(a),I=w(se),ve&&ve.l(se),H=w(se),be&&be.l(se),R=w(se),re&&re.l(se),M=w(se),ee&&ee.l(se),G=w(se),le&&le.l(se),$=w(se),Z&&Z.l(se),ne=w(se),p&&p.l(se),he=w(se),O&&O.l(se),ce=w(se),C&&C.l(se),ae=w(se),V&&V.l(se),Te=w(se),Q&&Q.l(se),se.forEach(a),ye.forEach(a),Ee=w(z),Y&&Y.l(z),_e=w(z),P&&P.l(z),Ie=Me(),this.h()},h(){g(n,"color","medium"),g(l,"slot","start"),k(u,"text-align","center"),g(u,"title",i[11].title),g(e,"translucent",""),g(N,"icon",_n),g(N,"slot","start"),g(f,"fullscreen","")},m(z,X){J(z,e,X),o(e,t),o(t,l),o(l,n),o(t,d),o(t,u),o(u,T),o(t,b),ke&&ke.m(t,null),J(z,h,X),J(z,f,X),o(f,v),o(v,E),o(E,N),o(E,L),o(E,U),o(U,S),o(U,K),o(U,F),o(F,B),o(v,I),ve&&ve.m(v,null),o(v,H),be&&be.m(v,null),o(v,R),re&&re.m(v,null),o(v,M),ee&&ee.m(v,null),o(v,G),le&&le.m(v,null),o(v,$),Z&&Z.m(v,null),o(v,ne),p&&p.m(v,null),o(v,he),O&&O.m(v,null),o(v,ce),C&&C.m(v,null),o(v,ae),V&&V.m(v,null),o(v,Te),Q&&Q.m(v,null),J(z,Ee,X),Y&&Y.m(z,X),J(z,_e,X),P&&P.m(z,X),J(z,Ie,X),Ce||(Oe=ue(n,"click",i[18]),Ce=!0)},p(z,X){(!z[12]&&!z[13]||z[12]&&z[13])&&ke.p(z,X),D&&ve.p(z,X),be&&be.p(z,X),z[6]?re?re.p(z,X):(re=It(z),re.c(),re.m(v,M)):re&&(re.d(1),re=null),z[7]&&z[7]!=="<br>"?ee?ee.p(z,X):(ee=kt(z),ee.c(),ee.m(v,G)):ee&&(ee.d(1),ee=null),q&&le.p(z,X),z[11].driver_comments&&Z.p(z,X),oe&&p.p(z,X),z[11].tag&&z[11].tag_color&&O.p(z,X),z[13]||C.p(z,X),(z[12]&&z[13]||!z[12]&&!z[13])&&V.p(z,X),z[1]?Q?Q.p(z,X):(Q=Tt(z),Q.c(),Q.m(v,null)):Q&&(Q.d(1),Q=null),z[3]?Y||(Y=yt(),Y.c(),Y.m(_e.parentNode,_e)):Y&&(Y.d(1),Y=null),z[8]?P?P.p(z,X):(P=wt(z),P.c(),P.m(Ie.parentNode,Ie)):P&&(P.d(1),P=null)},i:Le,o:Le,d(z){z&&(a(e),a(h),a(f),a(Ee),a(_e),a(Ie)),ke&&ke.d(),ve&&ve.d(),be&&be.d(),re&&re.d(),ee&&ee.d(),le&&le.d(),Z&&Z.d(),p&&p.d(),O&&O.d(),C&&C.d(),V&&V.d(),Q&&Q.d(),Y&&Y.d(z),P&&P.d(z),Ce=!1,Oe()}}}const Lt=/Teléfono:\s*(\d{10,})/;function lt(i=""){return i.split(",").map(t=>t.trim())}function ro(i,e,t){let l=rt,n=document.querySelector("ion-modal"),r=n.componentProps.delivery,d=n.componentProps.isLast||!1,u=n.componentProps.flag||!1,_=r.driver_comments?r.driver_comments:"",T=r.deliver_status?r.deliver_status:"",b=r.img?r.img:"",h=r.img_id?r.img_id:"",f=b?lt(b):new Array,v=h?lt(h):new Array,E={latitude:null,longitude:null},N=r.stopsApproval,L=r.smsActive,U=!1,S=!0,j=!1,K="",F=r.comments_ext,A=!1,B="",I=new Object,D="";Ze(()=>{I=JSON.parse(localStorage.getItem("userSession")),R()});async function H(p="",O,C={}){let V=new FormData;t(3,U=!0);for(const[Q,Y]of Object.entries(C))V.append(Q,Y);V=Ne(V);try{const Q=await fetch(p,{method:"POST",body:V});if(Q.ok){const Y=await Q.json();O(Y)}else console.error("Request failed:",Q.statusText)}catch(Q){console.error("Error during file upload:",Q)}finally{t(3,U=!1)}}function R(){r.date_service?r.date_service&&!r.date_completed&&!r.service_time?(t(4,S=!1),t(5,j=!0)):r.date_service&&r.date_completed&&r.service_time&&(t(4,S=!1),t(5,j=!1)):(t(4,S=!0),t(5,j=!1))}if(r.comments_ext){const p=r.comments_ext.match(Lt);p&&(K=p[1],F=r.comments_ext.replace(Lt,"").trim())}const M=async(p,O)=>{await(await je.create({header:p||"Error",message:O||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()},G=async(p="",O="",C="",V,Q={})=>{await(await je.create({header:p||"Error",message:O||"Vuelva a intentar",buttons:[{text:"No",role:"cancel",handler:()=>{}},{text:"Sí",handler:()=>{H(C,V,Q)}}]})).present()},q=async p=>{if(f.length>=5){M("Límite de evidencias","Solo se permite subir 5 fotos por parada");return}if(u&&d&&f.length>=1){M("Límite de evidencias","Para el final de la ruta solo se permite subir 1 foto");return}const C=p.target.files[0];if(C)try{t(3,U=!0);const V=await oe(C);if(V){const Q=new FormData;Q.append("fileToUpload",V),fetch(`${l}api/admin/manager/upload_img_driver.php`,{method:"POST",body:Q}).then(Y=>Y.json()).then(Y=>{t(1,b=b?`${b},${Y.img}`:Y.img),h=h?`${h},${Y.img_id}`:Y.img_id,t(2,f=lt(b)),v=lt(h)}).catch(Y=>console.error("Upload error:",Y))}}catch(V){console.error("Compression error:",V)}finally{t(3,U=!1)}};function $(p){var O=r.service_time;!O&&S&&!d&&!u&&(p.preventDefault(),M("Registrar Ingreso","Antes de subir la evidencia registra el ingreso a la actual parada."))}function ne(){var p=u?r.date_completed:!1;if(!p&&!S&&j&&!d&&!u){var O=new Object;O.id_event=r.id_event,O.type="checkout",G("Registrar Salida","¿Completaste tu entrega?",l+"api/admin/route/record_check_date.php",function(C){C.minutes&&M("Tiempo por parada","Completaste la parada en "+C.minutes+" minutos.")},O)}}const oe=async p=>new Promise(O=>{const C=new Image;C.src=URL.createObjectURL(p),C.onload=()=>{const V=document.createElement("canvas"),Q=V.getContext("2d"),Y=800,P=600;let z=C.width,X=C.height;z>Y&&(X*=Y/z,z=Y),X>P&&(z*=P/X,X=P),V.width=z,V.height=X,Q.drawImage(C,0,0,z,X),V.toBlob(x=>{O(x),URL.revokeObjectURL(C.src),Q.clearRect(0,0,V.width,V.height)},"image/jpeg",.7)}}),he=()=>{n.dismiss({data:Date.now()})};function ce(p){t(2,f=f.filter((O,C)=>C!==p))}const ae=async()=>{try{if(t(3,U=!0),t(1,b=f.join(",")),h=v.join(","),ne(),await Ee())if(D.value=="delivered"||D.value!=="delivered"&&(_.value||r.driver_comments)||u&&d){const O={id_route:r.id_route,...!u&&!d&&{id_event:r.id_event},...!u&&!d&&{comments:_.value},...!u&&!d&&{deliver_status:D.value},img:b,img_id:h,lat:E.latitude,lon:E.longitude,...N==="0"&&{approve:"0"},...d&&{isLast:!0},...u&&d&&{destiny:!0}};O.img&&O.img_id||b?H(`${l}api/admin/evidence/send_evidence.php`,function(C){if(C.success==!0){const V=O.id_route;he(),d&&(Te("","",V,d),N=="0"&&ze(V,"completed"))}else M("Carga fallida","Actualiza la página y vuelve a intentar cargar la información!")},O):M("Información incompleta","Cargar evidencia fotográfica faltante para completar parada.")}else M("Motivo de status de entrega","Favor de ingresar en notas el motivo por el que la entrega no fue entregada correctamente");else M("Ubicación faltante","Asegúrate darle permisos a Rutaflow para acceder a tu ubicación")}catch(p){console.error("Error fetching data:",p)}finally{t(3,U=!1)}},Te=(p,O,C,V)=>{n.componentProps.routeId=C,n.componentProps.driverId=r.id_driver,Ue("modal-km-gas",Zt,{checklist:p,driverId:O,routeId:C,isLast:V}).then(Q=>{})},Ee=async()=>navigator.geolocation?new Promise((p,O)=>{navigator.geolocation.getCurrentPosition(C=>{E.latitude=C.coords.latitude,E.longitude=C.coords.longitude,p(!0)},C=>{console.error("Error getting location:",C),p(!1)})}):(console.error("Geolocation is not supported by your browser"),!1);async function _e(p){p.stopPropagation();let O=new FormData;O.append("client_phone",K),O.append("client_name",r.title),O.append("delivery_phone",r.client_phone),O.append("enterprise_name",r.enterprise_name),O=Ne(O);try{const C=await fetch(`${l}api/admin/message_central/send_sms.php`,{method:"POST",body:O});if(C.ok){const V=await C.json();M("SMS enviado","Se envío correctamente un SMS a "+r.title+" con número de teléfono: "+K)}else M("SMS no enviado","Hubo un error al enviar SMS a "+r.title+" con número de teléfono: "+phoneNumber0+". Por favor contacte a soporte.")}catch(C){console.error("Error during file upload:",C)}}function Ie(){t(4,S=!1),t(5,j=!0),Oe(r.id_event,"checkin")}function Ce(){t(5,j=!1),t(4,S=!1),Oe(r.id_event,"checkout")}async function Oe(p,O){if(O){let C=new FormData;C.append("type",O),C.append("id_event",p),C=Ne(C);try{const V=await fetch(`${l}api/admin/route/record_check_date.php`,{method:"POST",body:C});if(V.ok){const Q=await V.json();Q.minutes&&M("Tiempo por parada","Completaste la parada en "+Q.minutes+" minutos.")}else console.error("File upload failed:",V.statusText)}catch(V){console.error("Error during file upload:",V)}finally{}}}const ke=p=>{t(9,B=p),t(8,A=!0)},ve=()=>{t(8,A=!1),t(9,B="")};function Ne(p){return p.append("token",I.token),p.append("id_user_over",I.id_user),p}function ze(p,O){let C=new FormData;return C.append("id_route",p),C.append("status",O),C=Ne(C),fetch(`${l}api/admin/route/change_status.php`,{method:"POST",body:C}).then(V=>V.json()).then(V=>{}).catch(V=>{console.error("Error fetching data:",V)}),""}function be(p){nn.call(this,i,p)}function re(p){De[p?"unshift":"push"](()=>{D=p,t(10,D)})}function ee(p){De[p?"unshift":"push"](()=>{_=p,t(0,_)})}return[_,b,f,U,S,j,K,F,A,B,D,r,d,u,T,L,q,$,he,ce,ae,_e,Ie,Ce,ke,ve,be,re,ee,p=>ke(p),p=>ce(p)]}class zt extends Je{constructor(e){super(),Ye(this,e,ro,io,We,{},null,[-1,-1])}}function At(i){let e,t,l;return{c(){e=s("section"),t=s("ion-img"),this.h()},l(n){e=c(n,"SECTION",{});var r=m(e);t=c(r,"ION-IMG",{src:!0,alt:!0,style:!0}),m(t).forEach(a),r.forEach(a),this.h()},h(){Ke(t.src,l=i[0])||g(t,"src",l),g(t,"alt","Evidencia fotográfica"),k(t,"max-width","100%"),k(t,"margin-top","16px")},m(n,r){J(n,e,r),o(e,t)},p(n,r){r&1&&!Ke(t.src,l=n[0])&&g(t,"src",l)},d(n){n&&a(e)}}}function Mt(i){let e,t='<ion-spinner name="dots" style="color:white;"></ion-spinner>';return{c(){e=s("div"),e.innerHTML=t,this.h()},l(l){e=c(l,"DIV",{class:!0,style:!0,"data-svelte-h":!0}),te(e)!=="svelte-h8s7r2"&&(e.innerHTML=t),this.h()},h(){W(e,"class","overlay"),k(e,"position","fixed"),k(e,"top","0"),k(e,"left","0"),k(e,"width","100vw"),k(e,"height","100vh"),k(e,"background","rgba(0, 0, 0, 0.5)"),k(e,"display","flex"),k(e,"align-items","center"),k(e,"justify-content","center"),k(e,"z-index","9999")},m(l,n){J(l,e,n)},d(l){l&&a(e)}}}function ao(i){let e,t,l,n,r="Cancelar",d,u,_="AGREGAR GASTO",T,b,h,f="Confirmar",v,E,N,L,U,S,j,K,F,A,B,I,D,H,R,M,G,q,$='Tipo de pago <ion-text color="danger">(Obligatorio)</ion-text>',ne,oe,he="Efectivo",ce,ae,Te="Tarjeta",Ee,_e,Ie="Transferencia",Ce,Oe,ke,ve,Ne,ze,be,re,ee,le,Z=`<ion-icon icon="${Yt}" slot="start"></ion-icon>
                        Subir Evidencia`,p,O,C,V,Q,Y,P,z=i[0]&&At(i),X=i[5]&&Mt();return{c(){e=s("ion-header"),t=s("ion-toolbar"),l=s("ion-buttons"),n=s("ion-button"),n.textContent=r,d=y(),u=s("ion-title"),u.textContent=_,T=y(),b=s("ion-buttons"),h=s("ion-button"),h.textContent=f,v=y(),E=s("ion-content"),N=s("ion-list"),L=s("ion-item"),U=s("ion-icon"),S=y(),j=s("ion-input"),K=y(),F=s("ion-item"),A=s("ion-icon"),B=y(),I=s("ion-input"),D=y(),H=s("ion-item"),R=s("ion-icon"),M=y(),G=s("ion-select"),q=s("div"),q.innerHTML=$,ne=y(),oe=s("ion-select-option"),oe.textContent=he,ce=y(),ae=s("ion-select-option"),ae.textContent=Te,Ee=y(),_e=s("ion-select-option"),_e.textContent=Ie,Ce=y(),Oe=s("ion-item"),ke=s("ion-icon"),ve=y(),Ne=s("ion-textarea"),ze=y(),be=s("section"),re=s("label"),ee=s("ion-button"),le=s("label"),le.innerHTML=Z,p=y(),O=s("input"),C=y(),z&&z.c(),V=y(),X&&X.c(),Q=Me(),this.h()},l(x){e=c(x,"ION-HEADER",{translucent:!0});var ie=m(e);t=c(ie,"ION-TOOLBAR",{});var fe=m(t);l=c(fe,"ION-BUTTONS",{slot:!0});var ye=m(l);n=c(ye,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),te(n)!=="svelte-1f8rjcf"&&(n.textContent=r),ye.forEach(a),d=w(fe),u=c(fe,"ION-TITLE",{title:!0,"data-svelte-h":!0}),te(u)!=="svelte-efps2s"&&(u.textContent=_),T=w(fe),b=c(fe,"ION-BUTTONS",{slot:!0});var se=m(b);h=c(se,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),te(h)!=="svelte-k5zoz0"&&(h.textContent=f),se.forEach(a),fe.forEach(a),ie.forEach(a),v=w(x),E=c(x,"ION-CONTENT",{fullscreen:!0});var ge=m(E);N=c(ge,"ION-LIST",{});var de=m(N);L=c(de,"ION-ITEM",{});var Se=m(L);U=c(Se,"ION-ICON",{icon:!0,slot:!0}),m(U).forEach(a),S=w(Se),j=c(Se,"ION-INPUT",{label:!0,type:!0,placeholder:!0,value:!0}),m(j).forEach(a),Se.forEach(a),K=w(de),F=c(de,"ION-ITEM",{});var qe=m(F);A=c(qe,"ION-ICON",{icon:!0,slot:!0}),m(A).forEach(a),B=w(qe),I=c(qe,"ION-INPUT",{label:!0,type:!0,value:!0}),m(I).forEach(a),qe.forEach(a),D=w(de),H=c(de,"ION-ITEM",{});var tt=m(H);R=c(tt,"ION-ICON",{icon:!0,slot:!0}),m(R).forEach(a),M=w(tt),G=c(tt,"ION-SELECT",{placeholder:!0,value:!0});var Ve=m(G);q=c(Ve,"DIV",{slot:!0,"data-svelte-h":!0}),te(q)!=="svelte-wl764p"&&(q.innerHTML=$),ne=w(Ve),oe=c(Ve,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),te(oe)!=="svelte-i9crym"&&(oe.textContent=he),ce=w(Ve),ae=c(Ve,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),te(ae)!=="svelte-fx0z11"&&(ae.textContent=Te),Ee=w(Ve),_e=c(Ve,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),te(_e)!=="svelte-1c24jf2"&&(_e.textContent=Ie),Ve.forEach(a),tt.forEach(a),Ce=w(de),Oe=c(de,"ION-ITEM",{});var nt=m(Oe);ke=c(nt,"ION-ICON",{icon:!0,slot:!0}),m(ke).forEach(a),ve=w(nt),Ne=c(nt,"ION-TEXTAREA",{label:!0,placeholder:!0}),m(Ne).forEach(a),nt.forEach(a),ze=w(de),be=c(de,"SECTION",{});var mt=m(be);re=c(mt,"LABEL",{for:!0,style:!0});var vt=m(re);ee=c(vt,"ION-BUTTON",{fill:!0,size:!0,class:!0,expand:!0});var ot=m(ee);le=c(ot,"LABEL",{for:!0,style:!0,"data-svelte-h":!0}),te(le)!=="svelte-1m9yw22"&&(le.innerHTML=Z),p=w(ot),O=c(ot,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0,capture:!0}),ot.forEach(a),vt.forEach(a),mt.forEach(a),C=w(de),z&&z.l(de),de.forEach(a),ge.forEach(a),V=w(x),X&&X.l(x),Q=Me(),this.h()},h(){g(n,"color","medium"),g(l,"slot","start"),g(u,"title",""),g(h,"strong",""),g(b,"slot","end"),g(e,"translucent",""),g(U,"icon",Jt),g(U,"slot","start"),g(j,"label","Concepto"),g(j,"type","text"),g(j,"placeholder","Escribe aquí..."),g(j,"value",i[6]?i[6]:""),g(A,"icon",ut),g(A,"slot","start"),g(I,"label","Cantidad"),g(I,"type","number"),g(I,"value",i[7]?i[7]:""),g(R,"icon",Nn),g(R,"slot","start"),W(q,"slot","label"),g(oe,"value","cash"),g(ae,"value","card"),g(_e,"value","transfer"),g(G,"placeholder","Tipo de pago"),g(G,"value",i[8]?i[8]:""),g(ke,"icon",ut),g(ke,"slot","start"),g(Ne,"label","Comentarios"),g(Ne,"placeholder","Escribe aquí..."),W(le,"for","eventEvidence"),k(le,"width","100%"),k(le,"padding","8px"),k(O,"display","none"),W(O,"id","eventEvidence"),W(O,"name","fileToUpload"),W(O,"type","file"),W(O,"accept","image/*"),W(O,"capture","environment"),g(ee,"fill","outline"),g(ee,"size","small"),g(ee,"class","loadEvidence"),g(ee,"expand","block"),W(re,"for","eventEvidence"),k(re,"display","block"),k(re,"width","100%"),g(E,"fullscreen","")},m(x,ie){J(x,e,ie),o(e,t),o(t,l),o(l,n),o(t,d),o(t,u),o(t,T),o(t,b),o(b,h),J(x,v,ie),J(x,E,ie),o(E,N),o(N,L),o(L,U),o(L,S),o(L,j),i[12](j),o(N,K),o(N,F),o(F,A),o(F,B),o(F,I),i[13](I),o(N,D),o(N,H),o(H,R),o(H,M),o(H,G),o(G,q),o(G,ne),o(G,oe),o(G,ce),o(G,ae),o(G,Ee),o(G,_e),i[14](G),o(N,Ce),o(N,Oe),o(Oe,ke),o(Oe,ve),o(Oe,Ne),i[15](Ne),o(N,ze),o(N,be),o(be,re),o(re,ee),o(ee,le),o(ee,p),o(ee,O),o(N,C),z&&z.m(N,null),J(x,V,ie),X&&X.m(x,ie),J(x,Q,ie),Y||(P=[ue(n,"click",i[10]),ue(h,"click",i[11]),ue(O,"change",i[9])],Y=!0)},p(x,[ie]){x[0]?z?z.p(x,ie):(z=At(x),z.c(),z.m(N,null)):z&&(z.d(1),z=null),x[5]?X||(X=Mt(),X.c(),X.m(Q.parentNode,Q)):X&&(X.d(1),X=null)},i:Le,o:Le,d(x){x&&(a(e),a(v),a(E),a(V),a(Q)),i[12](null),i[13](null),i[14](null),i[15](null),z&&z.d(),X&&X.d(x),Y=!1,He(P)}}}function so(i,e,t){let l=rt,n=document.querySelector("ion-modal"),r=n.componentProps.routeId,d=n.componentProps.ex_concept,u=n.componentProps.ex_amount,_=n.componentProps.ex_type,T=n.componentProps.id_expense,b="",h="",f="",v=0,E="",N="",L=!1,U=new Object;Ze(()=>{U=JSON.parse(localStorage.getItem("userSession"))});const S=async(M,G)=>{await(await je.create({header:M||"Error",message:G||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()},j=async M=>{t(5,L=!0);const q=M.target.files[0],$=await K(q);if($){let ne=new FormData;ne.append("fileToUpload",$),ne=B(ne);try{const oe=await fetch(`${l}api/admin/manager/upload_img_driver.php`,{method:"POST",body:ne});if(oe.ok){const he=await oe.json();t(0,b=he.img),h=he.img_id}else console.error("File upload failed:",oe.statusText)}catch(oe){console.error("Error during file upload:",oe)}finally{t(5,L=!1)}}},K=async M=>new Promise(G=>{const q=new Image;q.src=URL.createObjectURL(M),q.onload=()=>{const $=document.createElement("canvas"),ne=$.getContext("2d"),oe=800,he=600;let ce=q.width,ae=q.height;ce>oe&&(ae*=oe/ce,ce=oe),ae>he&&(ce*=he/ae,ae=he),$.width=ce,$.height=ae,ne.drawImage(q,0,0,ce,ae),$.toBlob(Te=>{G(Te),URL.revokeObjectURL(q.src),ne.clearRect(0,0,$.width,$.height)},"image/jpeg",.7)}}),F=()=>{et.dismiss()},A=()=>{var M=new Object;M.id_route=r,M.comments=E.value,M.type=f.value,M.img=b,M.img_id=h,M.amount=v.value,M.concept=N.value,M.status="done",M.id_expense=T||"null";let G=new FormData;for(const q in M)G.append(q,M[q]);G=B(G),!h||!b||!E.value||!v.value||!N.value?S("Datos incompletos","Llena los datos requeridos para completar el registro"):fetch(`${l}api/admin/expenses/add_expense.php`,{method:"POST",body:G}).then(q=>q.json()).then(q=>{F()}).catch(q=>{console.error("Error fetching data:",q)})};function B(M){return M.append("token",U.token),M.append("id_user_over",U.id_user),M}function I(M){De[M?"unshift":"push"](()=>{N=M,t(4,N)})}function D(M){De[M?"unshift":"push"](()=>{v=M,t(2,v)})}function H(M){De[M?"unshift":"push"](()=>{f=M,t(1,f)})}function R(M){De[M?"unshift":"push"](()=>{E=M,t(3,E)})}return[b,f,v,E,N,L,d,u,_,j,F,A,I,D,H,R]}class dt extends Je{constructor(e){super(),Ye(this,e,so,ao,We,{})}}function St(i,e,t){const l=i.slice();return l[7]=e[t],l}function co(i){let e,t="Cargar gasto",l,n;function r(...d){return i[4](i[7],...d)}return{c(){e=s("ion-button"),e.textContent=t,this.h()},l(d){e=c(d,"ION-BUTTON",{fill:!0,size:!0,"aria-selected":!0,"data-svelte-h":!0}),te(e)!=="svelte-175aelj"&&(e.textContent=t),this.h()},h(){g(e,"fill","outline"),g(e,"size","small"),g(e,"aria-selected","")},m(d,u){J(d,e,u),l||(n=ue(e,"click",r),l=!0)},p(d,u){i=d},d(d){d&&a(e),l=!1,n()}}}function uo(i){let e,t="Gasto completado";return{c(){e=s("ion-button"),e.textContent=t,this.h()},l(l){e=c(l,"ION-BUTTON",{fill:!0,size:!0,"aria-selected":!0,"data-svelte-h":!0}),te(e)!=="svelte-tlger7"&&(e.textContent=t),this.h()},h(){g(e,"fill","solid"),g(e,"size","small"),g(e,"aria-selected","")},m(l,n){J(l,e,n)},p:Le,d(l){l&&a(e)}}}function Dt(i,e){let t,l,n,r=e[7].concept+"",d,u,_;function T(f,v){return f[7].status=="done"?uo:co}let h=T(e)(e);return{key:i,first:null,c(){t=s("ion-item"),l=s("ion-label"),n=s("p"),d=pe(r),u=y(),h.c(),_=y(),this.h()},l(f){t=c(f,"ION-ITEM",{});var v=m(t);l=c(v,"ION-LABEL",{style:!0});var E=m(l);n=c(E,"P",{style:!0});var N=m(n);d=me(N,r),N.forEach(a),E.forEach(a),u=w(v),h.l(v),_=w(v),v.forEach(a),this.h()},h(){k(n,"margin-left","10px"),k(l,"display","flex"),this.first=t},m(f,v){J(f,t,v),o(t,l),o(l,n),o(n,d),o(t,u),h.m(t,null),o(t,_)},p(f,v){e=f,h.p(e,v)},d(f){f&&a(t),h.d()}}}function fo(i){let e,t,l,n,r=`<ion-icon style="font-size: 25px!important;" icon="${Tn}"></ion-icon>`,d,u,_="LISTA DE GASTOS",T,b,h,f=[],v=new Map,E,N,L,U="Cerrar",S,j,K=Be(i[0]);const F=A=>A[7].id_expenses;for(let A=0;A<K.length;A+=1){let B=St(i,K,A),I=F(B);v.set(I,f[A]=Dt(I,B))}return{c(){e=s("ion-header"),t=s("ion-toolbar"),l=s("ion-buttons"),n=s("ion-button"),n.innerHTML=r,d=y(),u=s("ion-title"),u.textContent=_,T=y(),b=s("ion-content"),h=s("ion-list");for(let A=0;A<f.length;A+=1)f[A].c();E=y(),N=s("ion-footer"),L=s("ion-button"),L.textContent=U,this.h()},l(A){e=c(A,"ION-HEADER",{translucent:!0});var B=m(e);t=c(B,"ION-TOOLBAR",{});var I=m(t);l=c(I,"ION-BUTTONS",{slot:!0});var D=m(l);n=c(D,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),te(n)!=="svelte-160xz3i"&&(n.innerHTML=r),D.forEach(a),d=w(I),u=c(I,"ION-TITLE",{"data-svelte-h":!0}),te(u)!=="svelte-1phn90x"&&(u.textContent=_),I.forEach(a),B.forEach(a),T=w(A),b=c(A,"ION-CONTENT",{fullscreen:!0});var H=m(b);h=c(H,"ION-LIST",{});var R=m(h);for(let G=0;G<f.length;G+=1)f[G].l(R);R.forEach(a),H.forEach(a),E=w(A),N=c(A,"ION-FOOTER",{});var M=m(N);L=c(M,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),te(L)!=="svelte-zv7v83"&&(L.textContent=U),M.forEach(a),this.h()},h(){g(n,"color","medium"),g(l,"slot","end"),g(e,"translucent",""),g(b,"fullscreen",""),g(L,"fill","outline"),g(L,"color","tertiary"),g(L,"strong",""),k(L,"width","99%"),k(L,"height","auto")},m(A,B){J(A,e,B),o(e,t),o(t,l),o(l,n),o(t,d),o(t,u),J(A,T,B),J(A,b,B),o(b,h);for(let I=0;I<f.length;I+=1)f[I]&&f[I].m(h,null);J(A,E,B),J(A,N,B),o(N,L),S||(j=[ue(n,"click",i[3]),ue(L,"click",i[1])],S=!0)},p(A,[B]){B&5&&(K=Be(A[0]),f=xe(f,B,F,1,A,K,v,h,$e,Dt,null,St))},i:Le,o:Le,d(A){A&&(a(e),a(T),a(b),a(E),a(N));for(let B=0;B<f.length;B+=1)f[B].d();S=!1,He(j)}}}function _o(i){let e=document.querySelector("ion-modal");e.componentProps.routeId;let t=e.componentProps.expenses;Ze(()=>{});const l=()=>{et.dismiss()};function n(u,_,T,b,h){e.componentProps.ex_amount=T,e.componentProps.ex_concept=_,e.componentProps.ex_type=b,e.componentProps.id_expense=h,Ue("modal-expense",dt,{amount:T,concept:_,type:b,id_expense:h}).then(()=>{}),l()}return[t,l,n,u=>{Ue("modal-expense",dt,{routeId:u}).then(_=>{}),l()},(u,_)=>n(_,u.concept,u.amount,u.type,u.id_expenses)]}class ho extends Je{constructor(e){super(),Ye(this,e,_o,fo,We,{})}}const{document:Pt}=Mn;function Ht(i,e,t){const l=i.slice();return l[49]=e[t],l[51]=t,l}function Bt(i,e,t){const l=i.slice();return l[49]=e[t],l[51]=t,l}function Rt(i,e,t){const l=i.slice();return l[49]=e[t],l[51]=t,l}function Ut(i){let e,t;return e=new Ln({props:{$$slots:{default:[Io]},$$scope:{ctx:i}}}),{c(){sn(e.$$.fragment)},l(l){cn(e.$$.fragment,l)},m(l,n){un(e,l,n),t=!0},p(l,n){const r={};n[0]&2043|n[1]&8388608&&(r.$$scope={dirty:n,ctx:l}),e.$set(r)},i(l){t||(it(e.$$.fragment,l),t=!0)},o(l){ct(e.$$.fragment,l),t=!1},d(l){fn(e,l)}}}function po(i){let e,t='<div id="g_map" style="width: 100%; height: 100vh;"></div>';return{c(){e=s("ion-content"),e.innerHTML=t},l(l){e=c(l,"ION-CONTENT",{"data-svelte-h":!0}),te(e)!=="svelte-1ydw6i9"&&(e.innerHTML=t)},m(l,n){J(l,e,n)},p:Le,d(l){l&&a(e)}}}function mo(i){let e;function t(r,d){if(r[7].length>0)return go;if(!r[3])return vo}let l=t(i),n=l&&l(i);return{c(){n&&n.c(),e=Me()},l(r){n&&n.l(r),e=Me()},m(r,d){n&&n.m(r,d),J(r,e,d)},p(r,d){l===(l=t(r))&&n?n.p(r,d):(n&&n.d(1),n=l&&l(r),n&&(n.c(),n.m(e.parentNode,e)))},d(r){r&&a(e),n&&n.d(r)}}}function vo(i){let e,t,l,n='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Jala para actualizar" refreshing-spinner="circles" refreshing-text="Actualizando..."></ion-refresher-content>',r,d,u,_,T,b,h="0",f,v,E,N,L,U=i[6].origin+"",S,j,K,F="",A,B,I,D=[],H=new Map,R,M,G,q,$,ne=i[5].length+1+"",oe,he,ce,ae,Te,Ee,_e=i[6].destination+"",Ie,Ce,Oe,ke="",ve,Ne,ze,be,re=i[4]&&Vt(i),ee=Be(i[5]);const le=Z=>Z[49].id_event;for(let Z=0;Z<ee.length;Z+=1){let p=Ht(i,ee,Z),O=le(p);H.set(O,D[Z]=jt(O,p))}return{c(){re&&re.c(),e=y(),t=s("ion-content"),l=s("ion-refresher"),l.innerHTML=n,r=y(),d=s("ion-list"),u=s("ion-item"),_=s("ion-avatar"),T=s("div"),b=s("div"),b.textContent=h,v=y(),E=s("ion-label"),N=s("ion-text"),L=s("h3"),S=pe(U),j=y(),K=s("div"),K.innerHTML=F,A=y(),B=s("ion-icon"),I=y();for(let Z=0;Z<D.length;Z+=1)D[Z].c();R=y(),M=s("ion-item"),G=s("ion-avatar"),q=s("div"),$=s("div"),oe=pe(ne),ce=y(),ae=s("ion-label"),Te=s("ion-text"),Ee=s("h3"),Ie=pe(_e),Ce=y(),Oe=s("div"),Oe.innerHTML=ke,ve=y(),Ne=s("ion-icon"),this.h()},l(Z){re&&re.l(Z),e=w(Z),t=c(Z,"ION-CONTENT",{});var p=m(t);l=c(p,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),te(l)!=="svelte-1srnbs3"&&(l.innerHTML=n),r=w(p),d=c(p,"ION-LIST",{});var O=m(d);u=c(O,"ION-ITEM",{});var C=m(u);_=c(C,"ION-AVATAR",{slot:!0});var V=m(_);T=c(V,"DIV",{class:!0,title:!0,style:!0});var Q=m(T);b=c(Q,"DIV",{class:!0,"data-svelte-h":!0}),te(b)!=="svelte-3lvlrb"&&(b.textContent=h),Q.forEach(a),V.forEach(a),v=w(C),E=c(C,"ION-LABEL",{button:!0});var Y=m(E);N=c(Y,"ION-TEXT",{color:!0});var P=m(N);L=c(P,"H3",{});var z=m(L);S=me(z,U),z.forEach(a),P.forEach(a),j=w(Y),K=c(Y,"DIV",{class:!0,"data-svelte-h":!0}),te(K)!=="svelte-gz9kb"&&(K.innerHTML=F),Y.forEach(a),A=w(C),B=c(C,"ION-ICON",{icon:!0,slot:!0}),m(B).forEach(a),C.forEach(a),I=w(O);for(let de=0;de<D.length;de+=1)D[de].l(O);R=w(O),M=c(O,"ION-ITEM",{});var X=m(M);G=c(X,"ION-AVATAR",{slot:!0});var x=m(G);q=c(x,"DIV",{class:!0,title:!0,style:!0});var ie=m(q);$=c(ie,"DIV",{class:!0});var fe=m($);oe=me(fe,ne),fe.forEach(a),ie.forEach(a),x.forEach(a),ce=w(X),ae=c(X,"ION-LABEL",{button:!0});var ye=m(ae);Te=c(ye,"ION-TEXT",{color:!0});var se=m(Te);Ee=c(se,"H3",{});var ge=m(Ee);Ie=me(ge,_e),ge.forEach(a),se.forEach(a),Ce=w(ye),Oe=c(ye,"DIV",{class:!0,"data-svelte-h":!0}),te(Oe)!=="svelte-130ohbs"&&(Oe.innerHTML=ke),ye.forEach(a),ve=w(X),Ne=c(X,"ION-ICON",{icon:!0,slot:!0}),m(Ne).forEach(a),X.forEach(a),O.forEach(a),p.forEach(a),this.h()},h(){g(l,"slot","fixed"),W(b,"class","order svelte-egzizz"),W(T,"class","order-wrapper svelte-egzizz"),W(T,"title",f="$"+i[6].origin),k(T,"background-color",i[6].color),k(T,"color",Ae(i[6].color)),g(_,"slot","start"),g(N,"color","#2e2e2e"),W(K,"class","sub svelte-egzizz"),g(E,"button",""),g(B,"icon",Re),g(B,"slot","end"),W($,"class","order svelte-egzizz"),W(q,"class","order-wrapper svelte-egzizz"),W(q,"title",he="$"+i[6].destination),k(q,"background-color",i[6].color),k(q,"color",Ae(i[6].color)),g(G,"slot","start"),g(Te,"color","#2e2e2e"),W(Oe,"class","sub svelte-egzizz"),g(ae,"button",""),g(Ne,"icon",Re),g(Ne,"slot","end")},m(Z,p){re&&re.m(Z,p),J(Z,e,p),J(Z,t,p),o(t,l),i[31](l),o(t,r),o(t,d),o(d,u),o(u,_),o(_,T),o(T,b),o(u,v),o(u,E),o(E,N),o(N,L),o(L,S),o(E,j),o(E,K),o(u,A),o(u,B),o(d,I);for(let O=0;O<D.length;O+=1)D[O]&&D[O].m(d,null);o(d,R),o(d,M),o(M,G),o(G,q),o(q,$),o($,oe),o(M,ce),o(M,ae),o(ae,Te),o(Te,Ee),o(Ee,Ie),o(ae,Ce),o(ae,Oe),o(M,ve),o(M,Ne),ze||(be=[ue(l,"ionRefresh",i[11]),ue(E,"click",i[32]),ue(ae,"click",i[34])],ze=!0)},p(Z,p){Z[4]?re?re.p(Z,p):(re=Vt(Z),re.c(),re.m(e.parentNode,e)):re&&(re.d(1),re=null),p[0]&64&&f!==(f="$"+Z[6].origin)&&W(T,"title",f),p[0]&64&&k(T,"background-color",Z[6].color),p[0]&64&&k(T,"color",Ae(Z[6].color)),p[0]&64&&U!==(U=Z[6].origin+"")&&we(S,U),p[0]&664608&&(ee=Be(Z[5]),D=xe(D,p,le,1,Z,ee,H,d,$e,jt,R,Ht)),p[0]&32&&ne!==(ne=Z[5].length+1+"")&&we(oe,ne),p[0]&64&&he!==(he="$"+Z[6].destination)&&W(q,"title",he),p[0]&64&&k(q,"background-color",Z[6].color),p[0]&64&&k(q,"color",Ae(Z[6].color)),p[0]&64&&_e!==(_e=Z[6].destination+"")&&we(Ie,_e)},d(Z){Z&&(a(e),a(t)),re&&re.d(Z),i[31](null);for(let p=0;p<D.length;p+=1)D[p].d();ze=!1,He(be)}}}function go(i){let e,t;function l(d,u){return u[0]&144&&(e=null),e==null&&(e=!!(d[7].filter(Oo).every(No)&&!d[4])),e?Eo:bo}let n=l(i,[-1,-1]),r=n(i);return{c(){r.c(),t=Me()},l(d){r.l(d),t=Me()},m(d,u){r.m(d,u),J(d,t,u)},p(d,u){n===(n=l(d,u))&&r?r.p(d,u):(r.d(1),r=n(d),r&&(r.c(),r.m(t.parentNode,t)))},d(d){d&&a(t),r.d(d)}}}function Vt(i){let e=i[15]("",i[1],i[0])+"",t;return{c(){t=pe(e)},l(l){t=me(l,e)},m(l,n){J(l,t,n)},p(l,n){n[0]&3&&e!==(e=l[15]("",l[1],l[0])+"")&&we(t,e)},d(l){l&&a(t)}}}function Ft(i){let e;return{c(){e=s("span"),this.h()},l(t){e=c(t,"SPAN",{class:!0}),m(e).forEach(a),this.h()},h(){W(e,"class","notes svelte-egzizz")},m(t,l){J(t,e,l)},d(t){t&&a(e)}}}function jt(i,e){let t,l,n,r,d=parseInt(e[49].pos)+1+"",u,_,T,b,h,f,v=e[49].title+"",E,N,L=e[49].support_list&&e[49].support_list.length||e[17](e[49]),U,S,j,K,F=L&&Ft();function A(){return e[33](e[49])}return{key:i,first:null,c(){t=s("ion-item"),l=s("ion-avatar"),n=s("div"),r=s("div"),u=pe(d),T=y(),b=s("ion-label"),h=s("ion-text"),f=s("h3"),E=pe(v),N=y(),F&&F.c(),U=y(),S=s("ion-icon"),this.h()},l(B){t=c(B,"ION-ITEM",{});var I=m(t);l=c(I,"ION-AVATAR",{slot:!0});var D=m(l);n=c(D,"DIV",{class:!0,title:!0,style:!0});var H=m(n);r=c(H,"DIV",{class:!0});var R=m(r);u=me(R,d),R.forEach(a),H.forEach(a),D.forEach(a),T=w(I),b=c(I,"ION-LABEL",{button:!0});var M=m(b);h=c(M,"ION-TEXT",{color:!0});var G=m(h);f=c(G,"H3",{});var q=m(f);E=me(q,v),N=w(q),F&&F.l(q),q.forEach(a),G.forEach(a),M.forEach(a),U=w(I),S=c(I,"ION-ICON",{icon:!0,slot:!0,style:!0}),m(S).forEach(a),I.forEach(a),this.h()},h(){W(r,"class","order svelte-egzizz"),W(n,"class","order-wrapper svelte-egzizz"),W(n,"title",_=Xe(e[49].status)),k(n,"background-color",Pe(e[49].status,e[49].date_service)),k(n,"color",Ae(Pe(e[49].status))),g(l,"slot","start"),g(h,"color","#2e2e2e"),g(b,"button",""),g(S,"icon",Re),g(S,"slot","end"),k(S,"color",Pe(e[49].status,e[49].date_service)),this.first=t},m(B,I){J(B,t,I),o(t,l),o(l,n),o(n,r),o(r,u),o(t,T),o(t,b),o(b,h),o(h,f),o(f,E),o(f,N),F&&F.m(f,null),o(t,U),o(t,S),j||(K=ue(b,"click",A),j=!0)},p(B,I){e=B,I[0]&32&&d!==(d=parseInt(e[49].pos)+1+"")&&we(u,d),I[0]&32&&_!==(_=Xe(e[49].status))&&W(n,"title",_),I[0]&32&&k(n,"background-color",Pe(e[49].status,e[49].date_service)),I[0]&32&&k(n,"color",Ae(Pe(e[49].status))),I[0]&32&&v!==(v=e[49].title+"")&&we(E,v),I[0]&32&&(L=e[49].support_list&&e[49].support_list.length||e[17](e[49])),L?F||(F=Ft(),F.c(),F.m(f,null)):F&&(F.d(1),F=null),I[0]&32&&k(S,"color",Pe(e[49].status,e[49].date_service))},d(B){B&&a(t),F&&F.d(),j=!1,K()}}}function bo(i){let e=i[15](i[7],i[1],i[0])+"",t,l,n,r,d='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Pull to refresh" refreshing-spinner="circles" refreshing-text="Refreshing..."></ion-refresher-content>',u,_,T,b,h,f,v="0",E,N,L,U,S,j=i[6].origin+"",K,F,A,B="",I,D,H,R=[],M=new Map,G,q,$,ne,oe,he=i[5].length+1+"",ce,ae,Te,Ee,_e,Ie,Ce=i[6].destination+"",Oe,ke,ve,Ne="",ze,be,re,ee,le=Be(i[5]);const Z=p=>p[49].id_event;for(let p=0;p<le.length;p+=1){let O=Bt(i,le,p),C=Z(O);M.set(C,R[p]=Gt(C,O))}return{c(){t=pe(e),l=y(),n=s("ion-content"),r=s("ion-refresher"),r.innerHTML=d,u=y(),_=s("ion-list"),T=s("ion-item"),b=s("ion-avatar"),h=s("div"),f=s("div"),f.textContent=v,N=y(),L=s("ion-label"),U=s("ion-text"),S=s("h3"),K=pe(j),F=y(),A=s("div"),A.innerHTML=B,I=y(),D=s("ion-icon"),H=y();for(let p=0;p<R.length;p+=1)R[p].c();G=y(),q=s("ion-item"),$=s("ion-avatar"),ne=s("div"),oe=s("div"),ce=pe(he),Te=y(),Ee=s("ion-label"),_e=s("ion-text"),Ie=s("h3"),Oe=pe(Ce),ke=y(),ve=s("div"),ve.innerHTML=Ne,ze=y(),be=s("ion-icon"),this.h()},l(p){t=me(p,e),l=w(p),n=c(p,"ION-CONTENT",{});var O=m(n);r=c(O,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),te(r)!=="svelte-dvt1s"&&(r.innerHTML=d),u=w(O),_=c(O,"ION-LIST",{});var C=m(_);T=c(C,"ION-ITEM",{});var V=m(T);b=c(V,"ION-AVATAR",{slot:!0});var Q=m(b);h=c(Q,"DIV",{class:!0,title:!0,style:!0});var Y=m(h);f=c(Y,"DIV",{class:!0,"data-svelte-h":!0}),te(f)!=="svelte-3lvlrb"&&(f.textContent=v),Y.forEach(a),Q.forEach(a),N=w(V),L=c(V,"ION-LABEL",{button:!0});var P=m(L);U=c(P,"ION-TEXT",{color:!0});var z=m(U);S=c(z,"H3",{});var X=m(S);K=me(X,j),X.forEach(a),z.forEach(a),F=w(P),A=c(P,"DIV",{class:!0,"data-svelte-h":!0}),te(A)!=="svelte-gz9kb"&&(A.innerHTML=B),P.forEach(a),I=w(V),D=c(V,"ION-ICON",{icon:!0,slot:!0}),m(D).forEach(a),V.forEach(a),H=w(C);for(let Se=0;Se<R.length;Se+=1)R[Se].l(C);G=w(C),q=c(C,"ION-ITEM",{});var x=m(q);$=c(x,"ION-AVATAR",{slot:!0});var ie=m($);ne=c(ie,"DIV",{class:!0,title:!0,style:!0});var fe=m(ne);oe=c(fe,"DIV",{class:!0});var ye=m(oe);ce=me(ye,he),ye.forEach(a),fe.forEach(a),ie.forEach(a),Te=w(x),Ee=c(x,"ION-LABEL",{button:!0});var se=m(Ee);_e=c(se,"ION-TEXT",{color:!0});var ge=m(_e);Ie=c(ge,"H3",{});var de=m(Ie);Oe=me(de,Ce),de.forEach(a),ge.forEach(a),ke=w(se),ve=c(se,"DIV",{class:!0,"data-svelte-h":!0}),te(ve)!=="svelte-130ohbs"&&(ve.innerHTML=Ne),se.forEach(a),ze=w(x),be=c(x,"ION-ICON",{icon:!0,slot:!0}),m(be).forEach(a),x.forEach(a),C.forEach(a),O.forEach(a),this.h()},h(){g(r,"slot","fixed"),W(f,"class","order svelte-egzizz"),W(h,"class","order-wrapper svelte-egzizz"),W(h,"title",E="$"+i[6].origin),k(h,"background-color",i[6].color),k(h,"color",Ae(i[6].color)),g(b,"slot","start"),g(U,"color","#2e2e2e"),W(A,"class","sub svelte-egzizz"),g(L,"button",""),g(D,"icon",Re),g(D,"slot","end"),W(oe,"class","order svelte-egzizz"),W(ne,"class","order-wrapper svelte-egzizz"),W(ne,"title",ae="$"+i[6].destination),k(ne,"background-color",i[6].color),k(ne,"color",Ae(i[6].color)),g($,"slot","start"),g(_e,"color","#2e2e2e"),W(ve,"class","sub svelte-egzizz"),g(Ee,"button",""),g(be,"icon",Re),g(be,"slot","end")},m(p,O){J(p,t,O),J(p,l,O),J(p,n,O),o(n,r),i[27](r),o(n,u),o(n,_),o(_,T),o(T,b),o(b,h),o(h,f),o(T,N),o(T,L),o(L,U),o(U,S),o(S,K),o(L,F),o(L,A),o(T,I),o(T,D),o(_,H);for(let C=0;C<R.length;C+=1)R[C]&&R[C].m(_,null);o(_,G),o(_,q),o(q,$),o($,ne),o(ne,oe),o(oe,ce),o(q,Te),o(q,Ee),o(Ee,_e),o(_e,Ie),o(Ie,Oe),o(Ee,ke),o(Ee,ve),o(q,ze),o(q,be),re||(ee=[ue(r,"ionRefresh",i[11]),ue(L,"click",i[28]),ue(Ee,"click",i[30])],re=!0)},p(p,O){O[0]&131&&e!==(e=p[15](p[7],p[1],p[0])+"")&&we(t,e),O[0]&64&&E!==(E="$"+p[6].origin)&&W(h,"title",E),O[0]&64&&k(h,"background-color",p[6].color),O[0]&64&&k(h,"color",Ae(p[6].color)),O[0]&64&&j!==(j=p[6].origin+"")&&we(K,j),O[0]&664608&&(le=Be(p[5]),R=xe(R,O,Z,1,p,le,M,_,$e,Gt,G,Bt)),O[0]&32&&he!==(he=p[5].length+1+"")&&we(ce,he),O[0]&64&&ae!==(ae="$"+p[6].destination)&&W(ne,"title",ae),O[0]&64&&k(ne,"background-color",p[6].color),O[0]&64&&k(ne,"color",Ae(p[6].color)),O[0]&64&&Ce!==(Ce=p[6].destination+"")&&we(Oe,Ce)},d(p){p&&(a(t),a(l),a(n)),i[27](null);for(let O=0;O<R.length;O+=1)R[O].d();re=!1,He(ee)}}}function Eo(i){let e,t,l='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Jale para actualizar" refreshing-spinner="circles" refreshing-text="Actualizando..."></ion-refresher-content>',n,r,d,u,_,T,b="0",h,f,v,E,N,L=i[6].origin+"",U,S,j,K="",F,A,B,I=[],D=new Map,H,R,M,G,q,$=i[5].length+1+"",ne,oe,he,ce,ae,Te,Ee=i[6].destination+"",_e,Ie,Ce,Oe="",ke,ve,Ne,ze,be=Be(i[5]);const re=ee=>ee[49].id_event;for(let ee=0;ee<be.length;ee+=1){let le=Rt(i,be,ee),Z=re(le);D.set(Z,I[ee]=Xt(Z,le))}return{c(){e=s("ion-content"),t=s("ion-refresher"),t.innerHTML=l,n=y(),r=s("ion-list"),d=s("ion-item"),u=s("ion-avatar"),_=s("div"),T=s("div"),T.textContent=b,f=y(),v=s("ion-label"),E=s("ion-text"),N=s("h3"),U=pe(L),S=y(),j=s("div"),j.innerHTML=K,F=y(),A=s("ion-icon"),B=y();for(let ee=0;ee<I.length;ee+=1)I[ee].c();H=y(),R=s("ion-item"),M=s("ion-avatar"),G=s("div"),q=s("div"),ne=pe($),he=y(),ce=s("ion-label"),ae=s("ion-text"),Te=s("h3"),_e=pe(Ee),Ie=y(),Ce=s("div"),Ce.innerHTML=Oe,ke=y(),ve=s("ion-icon"),this.h()},l(ee){e=c(ee,"ION-CONTENT",{});var le=m(e);t=c(le,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),te(t)!=="svelte-15ukrgn"&&(t.innerHTML=l),n=w(le),r=c(le,"ION-LIST",{});var Z=m(r);d=c(Z,"ION-ITEM",{});var p=m(d);u=c(p,"ION-AVATAR",{slot:!0});var O=m(u);_=c(O,"DIV",{class:!0,title:!0,style:!0});var C=m(_);T=c(C,"DIV",{class:!0,"data-svelte-h":!0}),te(T)!=="svelte-3lvlrb"&&(T.textContent=b),C.forEach(a),O.forEach(a),f=w(p),v=c(p,"ION-LABEL",{button:!0});var V=m(v);E=c(V,"ION-TEXT",{color:!0});var Q=m(E);N=c(Q,"H3",{});var Y=m(N);U=me(Y,L),Y.forEach(a),Q.forEach(a),S=w(V),j=c(V,"DIV",{class:!0,"data-svelte-h":!0}),te(j)!=="svelte-gz9kb"&&(j.innerHTML=K),V.forEach(a),F=w(p),A=c(p,"ION-ICON",{icon:!0,slot:!0}),m(A).forEach(a),p.forEach(a),B=w(Z);for(let se=0;se<I.length;se+=1)I[se].l(Z);H=w(Z),R=c(Z,"ION-ITEM",{});var P=m(R);M=c(P,"ION-AVATAR",{slot:!0});var z=m(M);G=c(z,"DIV",{class:!0,title:!0,style:!0});var X=m(G);q=c(X,"DIV",{class:!0});var x=m(q);ne=me(x,$),x.forEach(a),X.forEach(a),z.forEach(a),he=w(P),ce=c(P,"ION-LABEL",{button:!0});var ie=m(ce);ae=c(ie,"ION-TEXT",{color:!0});var fe=m(ae);Te=c(fe,"H3",{});var ye=m(Te);_e=me(ye,Ee),ye.forEach(a),fe.forEach(a),Ie=w(ie),Ce=c(ie,"DIV",{class:!0,"data-svelte-h":!0}),te(Ce)!=="svelte-130ohbs"&&(Ce.innerHTML=Oe),ie.forEach(a),ke=w(P),ve=c(P,"ION-ICON",{icon:!0,slot:!0}),m(ve).forEach(a),P.forEach(a),Z.forEach(a),le.forEach(a),this.h()},h(){g(t,"slot","fixed"),W(T,"class","order svelte-egzizz"),W(_,"class","order-wrapper svelte-egzizz"),W(_,"title",h="$"+i[6].origin),k(_,"background-color",i[6].color),k(_,"color",Ae(i[6].color)),g(u,"slot","start"),g(E,"color","#2e2e2e"),W(j,"class","sub svelte-egzizz"),g(v,"button",""),g(A,"icon",Re),g(A,"slot","end"),W(q,"class","order svelte-egzizz"),W(G,"class","order-wrapper svelte-egzizz"),W(G,"title",oe="$"+i[6].destination),k(G,"background-color",i[6].color),k(G,"color",Ae(i[6].color)),g(M,"slot","start"),g(ae,"color","#2e2e2e"),W(Ce,"class","sub svelte-egzizz"),g(ce,"button",""),g(ve,"icon",Re),g(ve,"slot","end")},m(ee,le){J(ee,e,le),o(e,t),i[23](t),o(e,n),o(e,r),o(r,d),o(d,u),o(u,_),o(_,T),o(d,f),o(d,v),o(v,E),o(E,N),o(N,U),o(v,S),o(v,j),o(d,F),o(d,A),o(r,B);for(let Z=0;Z<I.length;Z+=1)I[Z]&&I[Z].m(r,null);o(r,H),o(r,R),o(R,M),o(M,G),o(G,q),o(q,ne),o(R,he),o(R,ce),o(ce,ae),o(ae,Te),o(Te,_e),o(ce,Ie),o(ce,Ce),o(R,ke),o(R,ve),Ne||(ze=[ue(t,"ionRefresh",i[11]),ue(v,"click",i[24]),ue(ce,"click",i[26])],Ne=!0)},p(ee,le){le[0]&64&&h!==(h="$"+ee[6].origin)&&W(_,"title",h),le[0]&64&&k(_,"background-color",ee[6].color),le[0]&64&&k(_,"color",Ae(ee[6].color)),le[0]&64&&L!==(L=ee[6].origin+"")&&we(U,L),le[0]&664608&&(be=Be(ee[5]),I=xe(I,le,re,1,ee,be,D,r,$e,Xt,H,Rt)),le[0]&32&&$!==($=ee[5].length+1+"")&&we(ne,$),le[0]&64&&oe!==(oe="$"+ee[6].destination)&&W(G,"title",oe),le[0]&64&&k(G,"background-color",ee[6].color),le[0]&64&&k(G,"color",Ae(ee[6].color)),le[0]&64&&Ee!==(Ee=ee[6].destination+"")&&we(_e,Ee)},d(ee){ee&&a(e),i[23](null);for(let le=0;le<I.length;le+=1)I[le].d();Ne=!1,He(ze)}}}function qt(i){let e;return{c(){e=s("span"),this.h()},l(t){e=c(t,"SPAN",{class:!0}),m(e).forEach(a),this.h()},h(){W(e,"class","notes svelte-egzizz")},m(t,l){J(t,e,l)},d(t){t&&a(e)}}}function Gt(i,e){let t,l,n,r,d=parseInt(e[49].pos)+1+"",u,_,T,b,h,f,v=e[49].title+"",E,N,L=e[49].support_list&&e[49].support_list.length||e[17](e[49]),U,S,j="",K,F,A,B,I=L&&qt();function D(){return e[29](e[49])}return{key:i,first:null,c(){t=s("ion-item"),l=s("ion-avatar"),n=s("div"),r=s("div"),u=pe(d),T=y(),b=s("ion-label"),h=s("ion-text"),f=s("h3"),E=pe(v),N=y(),I&&I.c(),U=y(),S=s("div"),S.innerHTML=j,K=y(),F=s("ion-icon"),this.h()},l(H){t=c(H,"ION-ITEM",{});var R=m(t);l=c(R,"ION-AVATAR",{slot:!0});var M=m(l);n=c(M,"DIV",{class:!0,title:!0,style:!0});var G=m(n);r=c(G,"DIV",{class:!0});var q=m(r);u=me(q,d),q.forEach(a),G.forEach(a),M.forEach(a),T=w(R),b=c(R,"ION-LABEL",{button:!0});var $=m(b);h=c($,"ION-TEXT",{color:!0});var ne=m(h);f=c(ne,"H3",{});var oe=m(f);E=me(oe,v),N=w(oe),I&&I.l(oe),oe.forEach(a),ne.forEach(a),U=w($),S=c($,"DIV",{class:!0,"data-svelte-h":!0}),te(S)!=="svelte-qaecoo"&&(S.innerHTML=j),$.forEach(a),K=w(R),F=c(R,"ION-ICON",{icon:!0,slot:!0}),m(F).forEach(a),R.forEach(a),this.h()},h(){W(r,"class","order svelte-egzizz"),W(n,"class","order-wrapper svelte-egzizz"),W(n,"title",_=Xe(e[49].status)),k(n,"background-color",Pe(e[49].status,e[49].date_service)),k(n,"color",Ae(Pe(e[49].status))),g(l,"slot","start"),g(h,"color","#2e2e2e"),W(S,"class","sub svelte-egzizz"),g(b,"button",""),g(F,"icon",Re),g(F,"slot","end"),this.first=t},m(H,R){J(H,t,R),o(t,l),o(l,n),o(n,r),o(r,u),o(t,T),o(t,b),o(b,h),o(h,f),o(f,E),o(f,N),I&&I.m(f,null),o(b,U),o(b,S),o(t,K),o(t,F),A||(B=ue(b,"click",D),A=!0)},p(H,R){e=H,R[0]&32&&d!==(d=parseInt(e[49].pos)+1+"")&&we(u,d),R[0]&32&&_!==(_=Xe(e[49].status))&&W(n,"title",_),R[0]&32&&k(n,"background-color",Pe(e[49].status,e[49].date_service)),R[0]&32&&k(n,"color",Ae(Pe(e[49].status))),R[0]&32&&v!==(v=e[49].title+"")&&we(E,v),R[0]&32&&(L=e[49].support_list&&e[49].support_list.length||e[17](e[49])),L?I||(I=qt(),I.c(),I.m(f,null)):I&&(I.d(1),I=null)},d(H){H&&a(t),I&&I.d(),A=!1,B()}}}function Kt(i){let e;return{c(){e=s("span"),this.h()},l(t){e=c(t,"SPAN",{class:!0}),m(e).forEach(a),this.h()},h(){W(e,"class","notes svelte-egzizz")},m(t,l){J(t,e,l)},d(t){t&&a(e)}}}function Xt(i,e){let t,l,n,r,d=parseInt(e[49].pos)+1+"",u,_,T,b,h,f,v=e[49].title+"",E,N,L=e[49].support_list&&e[49].support_list.length||e[17](e[49]),U,S,j="",K,F,A,B,I=L&&Kt();function D(){return e[25](e[49])}return{key:i,first:null,c(){t=s("ion-item"),l=s("ion-avatar"),n=s("div"),r=s("div"),u=pe(d),T=y(),b=s("ion-label"),h=s("ion-text"),f=s("h3"),E=pe(v),N=y(),I&&I.c(),U=y(),S=s("div"),S.innerHTML=j,K=y(),F=s("ion-icon"),this.h()},l(H){t=c(H,"ION-ITEM",{});var R=m(t);l=c(R,"ION-AVATAR",{slot:!0});var M=m(l);n=c(M,"DIV",{class:!0,title:!0,style:!0});var G=m(n);r=c(G,"DIV",{class:!0});var q=m(r);u=me(q,d),q.forEach(a),G.forEach(a),M.forEach(a),T=w(R),b=c(R,"ION-LABEL",{button:!0});var $=m(b);h=c($,"ION-TEXT",{color:!0});var ne=m(h);f=c(ne,"H3",{});var oe=m(f);E=me(oe,v),N=w(oe),I&&I.l(oe),oe.forEach(a),ne.forEach(a),U=w($),S=c($,"DIV",{class:!0,"data-svelte-h":!0}),te(S)!=="svelte-qaecoo"&&(S.innerHTML=j),$.forEach(a),K=w(R),F=c(R,"ION-ICON",{icon:!0,slot:!0}),m(F).forEach(a),R.forEach(a),this.h()},h(){W(r,"class","order svelte-egzizz"),W(n,"class","order-wrapper svelte-egzizz"),W(n,"title",_=Xe(e[49].status)),k(n,"background-color",Pe(e[49].status,e[49].date_service)),k(n,"color",Ae(Pe(e[49].status))),g(l,"slot","start"),g(h,"color","#2e2e2e"),W(S,"class","sub svelte-egzizz"),g(b,"button",""),g(F,"icon",Re),g(F,"slot","end"),this.first=t},m(H,R){J(H,t,R),o(t,l),o(l,n),o(n,r),o(r,u),o(t,T),o(t,b),o(b,h),o(h,f),o(f,E),o(f,N),I&&I.m(f,null),o(b,U),o(b,S),o(t,K),o(t,F),A||(B=ue(b,"click",D),A=!0)},p(H,R){e=H,R[0]&32&&d!==(d=parseInt(e[49].pos)+1+"")&&we(u,d),R[0]&32&&_!==(_=Xe(e[49].status))&&W(n,"title",_),R[0]&32&&k(n,"background-color",Pe(e[49].status,e[49].date_service)),R[0]&32&&k(n,"color",Ae(Pe(e[49].status))),R[0]&32&&v!==(v=e[49].title+"")&&we(E,v),R[0]&32&&(L=e[49].support_list&&e[49].support_list.length||e[17](e[49])),L?I||(I=Kt(),I.c(),I.m(f,null)):I&&(I.d(1),I=null)},d(H){H&&a(t),I&&I.d(),A=!1,B()}}}function Io(i){let e,t,l,n,r=`<ion-icon icon="${Cn}"></ion-icon>`,d,u,_,T=`<ion-icon icon="${yn}"></ion-icon>`,b,h,f=(i[6].name?i[6].name.toUpperCase():"")+"",v,E,N,L='<ion-segment-button value="list"><ion-label>Paradas</ion-label></ion-segment-button> <ion-segment-button value="map"><ion-label>Mapa</ion-label></ion-segment-button>',U,S,j,K;function F(I,D){if(I[9]==="list")return mo;if(I[9]==="map")return po}let A=F(i),B=A&&A(i);return{c(){e=s("ion-header"),t=s("ion-toolbar"),l=s("ion-buttons"),n=s("ion-button"),n.innerHTML=r,d=y(),u=s("ion-buttons"),_=s("ion-button"),_.innerHTML=T,b=y(),h=s("ion-title"),v=pe(f),E=y(),N=s("ion-segment"),N.innerHTML=L,U=y(),B&&B.c(),S=Me(),this.h()},l(I){e=c(I,"ION-HEADER",{translucent:!0});var D=m(e);t=c(D,"ION-TOOLBAR",{});var H=m(t);l=c(H,"ION-BUTTONS",{slot:!0});var R=m(l);n=c(R,"ION-BUTTON",{title:!0,alt:!0,"data-svelte-h":!0}),te(n)!=="svelte-7ppz3r"&&(n.innerHTML=r),R.forEach(a),d=w(H),u=c(H,"ION-BUTTONS",{slot:!0});var M=m(u);_=c(M,"ION-BUTTON",{"data-svelte-h":!0}),te(_)!=="svelte-nf50hj"&&(_.innerHTML=T),M.forEach(a),b=w(H),h=c(H,"ION-TITLE",{});var G=m(h);v=me(G,f),G.forEach(a),H.forEach(a),E=w(D),N=c(D,"ION-SEGMENT",{value:!0,"data-svelte-h":!0}),te(N)!=="svelte-lue4c9"&&(N.innerHTML=L),D.forEach(a),U=w(I),B&&B.l(I),S=Me(),this.h()},h(){g(n,"title","Atrás"),g(n,"alt","Atrás"),g(l,"slot","start"),g(u,"slot","end"),g(N,"value","list"),g(e,"translucent","")},m(I,D){J(I,e,D),o(e,t),o(t,l),o(l,n),o(t,d),o(t,u),o(u,_),o(t,b),o(t,h),o(h,v),o(e,E),o(e,N),J(I,U,D),B&&B.m(I,D),J(I,S,D),j||(K=[ue(n,"click",i[18]),ue(_,"click",i[21]),ue(N,"ionChange",i[22])],j=!0)},p(I,D){D[0]&64&&f!==(f=(I[6].name?I[6].name.toUpperCase():"")+"")&&we(v,f),A===(A=F(I))&&B?B.p(I,D):(B&&B.d(1),B=A&&A(I),B&&(B.c(),B.m(S.parentNode,S)))},d(I){I&&(a(e),a(U),a(S)),B&&B.d(I),j=!1,He(K)}}}function ko(i){let e,t,l,n=i[2]&&Ut(i);return{c(){e=y(),n&&n.c(),t=Me(),this.h()},l(r){on("svelte-kn0kph",Pt.head).forEach(a),e=w(r),n&&n.l(r),t=Me(),this.h()},h(){Pt.title="Rutaflow - Detalles de ruta"},m(r,d){J(r,e,d),n&&n.m(r,d),J(r,t,d),l=!0},p(r,d){r[2]?n?(n.p(r,d),d[0]&4&&it(n,1)):(n=Ut(r),n.c(),it(n,1),n.m(t.parentNode,t)):n&&(dn(),ct(n,1,1,()=>{n=null}),an())},i(r){l||(it(n),l=!0)},o(r){ct(n),l=!1},d(r){r&&(a(e),a(t)),n&&n.d(r)}}}function Pe(i,e=""){let t="#ffffff";return i==="pending"&&!e?t="#f2e300":i=="pending"&&e?t="#F6A833":i==="completed"&&(t="#44d900"),t}function Xe(i){let e="";return i=="pending"?e="Pendiente":i=="completed"&&(e="Completado"),e}function Ae(i){i.slice(0,1)==="#"&&(i=i.slice(1)),i.length===3&&(i=i.split("").map(function(r){return r+r}).join(""));const e=parseInt(i.substr(0,2),16),t=parseInt(i.substr(2,2),16),l=parseInt(i.substr(4,2),16);return(e*299+t*587+l*114)/1e3>=128?"#414040":"#fff"}function st(i,e){for(let t=0;t<e.length;t++)if(e[t].alias===i)return e[t].val;return""}const Oo=i=>i.mandatory==="1",No=i=>i.img;function To(i,e,t){let l;ln(i,wn,p=>t(20,l=p));var n=this&&this.__awaiter||function(p,O,C,V){function Q(Y){return Y instanceof C?Y:new C(function(P){P(Y)})}return new(C||(C=Promise))(function(Y,P){function z(ie){try{x(V.next(ie))}catch(fe){P(fe)}}function X(ie){try{x(V.throw(ie))}catch(fe){P(fe)}}function x(ie){ie.done?Y(ie.value):Q(ie.value).then(z,X)}x((V=V.apply(p,O||[])).next())})};let{routeId:r}=e,{driverId:d}=e,u=rt,_=new Object,T=!0,b=!1,h=[],f={},v=[],E=[],N,L=!1,U="list",S,j="",K="",F="0",A=new Object;const B=()=>n(void 0,void 0,void 0,function*(){yield H(r),N.complete()});Ze(()=>n(void 0,void 0,void 0,function*(){Te(),yield H(r)}));function I(p){return n(this,void 0,void 0,function*(){if(t(9,U=p),U==="map"){yield rn(),S=document.getElementById("g_map");const O=new google.maps.Map(S,{zoom:8,center:{lat:20.6745683,lng:-103.3986104},mapId:"4504f8b37365c3d0"}),C=new google.maps.LatLngBounds,{AdvancedMarkerElement:V,PinElement:Q}=yield google.maps.importLibrary("marker");navigator.geolocation?navigator.geolocation.getCurrentPosition(function(Y){const P=new google.maps.LatLng(Y.coords.latitude,Y.coords.longitude);new google.maps.Marker({position:P,map:O,icon:{path:google.maps.SymbolPath.CIRCLE,fillColor:"#0062ff",fillOpacity:1,scale:6,strokeColor:"#ffffff",strokeWeight:2}}),new google.maps.Circle({strokeColor:"#00BFFF",strokeOpacity:.5,strokeWeight:1,fillColor:"#00BFFF",fillOpacity:.2,map:O,center:P,radius:Y.coords.accuracy}),C.extend(P)},function(Y){console.error("Error retrieving location:",Y)}):console.error("Geolocation not supported by this browser."),f.lat1===f.lat2&&f.lon1===f.lon2?D(C,O,{lat:f.lat2,lon:f.lon2,color:f.color,title:f.destination},{type:"icon",iconClass:"icon-home",title:"Origen/Destino",glyph:`0,${String(h.length+1)}`}):(D(C,O,{lat:f.lat1,lon:f.lon1,color:f.color,title:f.origin},{type:"icon",iconClass:"icon-home",title:"Origen",glyph:"0"}),D(C,O,{lat:f.lat2,lon:f.lon2,color:f.color,title:f.destination},{type:"icon",iconClass:"icon-flag",title:"Destino",glyph:String(h.length+1)})),h.forEach((Y,P)=>{const z=parseFloat(Y.lat),X=parseFloat(Y.lon),x=new google.maps.LatLng(z,X),ie=new google.maps.Marker({position:{lat:z,lng:X},map:O,title:Y.title}),fe=new Q({background:Pe(Y.status,Y.date_service),borderColor:"#000",glyphColor:"#000",glyph:(parseInt(Y.pos)+1).toString()});new V({map:O,position:x,content:fe.element,title:"Parada "+(parseInt(Y.pos)+1).toString()+": "+Y.title}).addListener("click",function(se){M(Y,!1)}),C.extend(ie.getPosition())}),O.fitBounds(C)}})}function D(p,O,C,V){return n(this,void 0,void 0,function*(){let Q;const Y=parseFloat(C.lat),P=parseFloat(C.lon),z=new google.maps.LatLng(Y,P),{AdvancedMarkerElement:X,PinElement:x}=yield google.maps.importLibrary("marker");V.type=="icon"?(Q=document.createElement("i"),Q.className=`${V.iconClass} icon`,Q.style.fontSize="14px",Q.style.color=Ae(C.color),Q.style.fontWeight="600"):V.type=="text";const ie=new google.maps.Marker({position:{lat:Y,lng:P},map:O,title:`${V.title}. ${C.title}`}),fe=new x({background:C.color,borderColor:"#000",glyphColor:Ae(C.color),glyph:V.glyph});return new X({map:O,position:z,content:fe.element,title:V.title+": "+C.title}).addListener("click",function(se){G(f,V.title=="Destino"||V.title=="Origen/Destino")}),ie})}function H(p){return n(this,void 0,void 0,function*(){let O=new FormData;O.append("id_route",p),O=ae(O);try{const V=yield(yield fetch(`${u}api/admin/report/seguimiento_list.php`,{method:"POST",body:O})).json();t(6,f=V.data.seguimiento_list[0]),t(5,h=V.data.event_list),t(7,v=V.data.checklist),E=V.data.expenses,f&&t(4,b=f.km_inicial=="0"&&f.gas_inicial=="0"),t(3,T=!1)}catch(C){t(3,T=!1),console.error("Error fetching data:",C)}})}const R=p=>new Promise((O,C)=>{let V=new FormData;V.append("id_route",p.id_route),V.append("id_event",p.id_event),V=ae(V),fetch(`${u}api/admin/evidence/evidence_by_event.php`,{method:"POST",body:V}).then(Q=>Q.json()).then(Q=>{O(Q.data.event_evidence[0])}).catch(Q=>{console.error("Error fetching data:",Q),C(Q)})}),M=(p,O)=>{R(p).then(C=>{p.stopsApproval=j,p.smsActive=K,C&&(p.img=C.img,p.driver_comments=C.driver_comments,p.comments=C.comments),Ue("modal-delivery-info",zt,{delivery:p,isLast:O}).then(V=>{}).finally(()=>{H(r)})})},G=(p,O)=>{var C=new Object;O?C={title:p.destination,line1:p.dest_address}:C={title:p.origin,line1:p.origin_address},C.client_name=p.client_name,C.client_phone=p.tel,C.id_route=p.id_route,C.stopsApproval=j,C.smsActive=K;var V=!0;Ue("modal-delivery-info",zt,{delivery:C,isLast:O,flag:V})},q=(p,O,C)=>{var V=!1;return L||(L=!0,Ue("modal-checklist",Zt,{checklist:p,driverId:O,routeId:C,isLast:V}).then(Q=>{L=!1}),oe(C,"checklist")),""},$=p=>n(void 0,void 0,void 0,function*(){return yield H(p),E.length>0?Ue("modal-expense-detail",ho,{routeId:p,expenses:E}).then(O=>{}):Ue("modal-expense",dt,{routeId:p}).then(O=>{}),""}),ne=p=>{if(p.tracking_type=="subscription"){if(p.subscriber_info&&p.payment_type==="cash"&&new Date(p.subscriber_info.payment_next)<new Date)return!0}else if(p.tracking_type=="ecommerce"&&Number(p.payment_pending)>0)return!0;return!1};function oe(p,O){let C=new FormData;return C.append("id_route",p),C.append("status",O),C=ae(C),fetch(`${u}api/admin/route/change_status.php`,{method:"POST",body:C}).then(V=>V.json()).then(V=>{}).catch(V=>{console.error("Error fetching data:",V)}),""}const he=()=>{_.type=="super"||_.type=="admin"?Fe("/drivers/me"):_.id_driver&&Fe(`/drivers/${_.id_driver}`)},ce=(p,O)=>n(void 0,void 0,void 0,function*(){yield(yield je.create({header:p||"Error",message:O||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()});function ae(p){return p.append("token",_.token),p.append("id_user_over",_.id_user),p}const Te=()=>n(void 0,void 0,void 0,function*(){if(_.id_enterprise){let p=new FormData;p.append("id_enterprise",_.id_enterprise),p=ae(p);try{const O=yield fetch(`${u}api/admin/enterprise/enterprise_settings.php`,{method:"POST",body:p});O.ok?(A=(yield O.json()).nodos,j=st("stops_wait_approval",A),K=st("sms_active",A),t(10,F=st("stops_order_restriction",A))):console.error("File upload failed:",O.statusText)}catch(O){console.error("Error during file upload:",O)}}}),Ee=()=>$(r),_e=p=>I(p.detail.value);function Ie(p){De[p?"unshift":"push"](()=>{N=p,t(8,N)})}const Ce=()=>{G(f,!1)},Oe=p=>{const O=h.findIndex(P=>P.id_event===p.id_event),C=O===0,V=O>0?h[O-1]:null,Q=C||V&&V.img!==null,Y=p.img!==null&&p.img!=="";Q||C&&!Y||F=="1"?M(p,!1):ce("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")},ke=()=>{G(f,!0)};function ve(p){De[p?"unshift":"push"](()=>{N=p,t(8,N)})}const Ne=()=>{G(f,!1)},ze=p=>{const O=h.findIndex(P=>P.id_event===p.id_event),C=O===0,V=O>0?h[O-1]:null,Q=C||V&&V.img!==null,Y=p.img!==null&&p.img!=="";Q||C&&!Y||F=="1"?M(p,!1):ce("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")},be=()=>{G(f,!0)};function re(p){De[p?"unshift":"push"](()=>{N=p,t(8,N)})}const ee=()=>{G(f,!1)},le=p=>{const O=h.findIndex(P=>P.id_event===p.id_event),C=O===0,V=O>0?h[O-1]:null,Q=C||V&&V.img!==null,Y=p.img!==null&&p.img!=="";Q||C&&!Y||F=="1"?M(p,!1):ce("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")},Z=()=>{G(f,!0)};return i.$$set=p=>{"routeId"in p&&t(0,r=p.routeId),"driverId"in p&&t(1,d=p.driverId)},i.$$.update=()=>{i.$$.dirty[0]&1048581&&(t(0,{routeId:r,driverId:d}=l.params,r,(t(1,d),t(20,l),t(2,_),t(0,r))),t(2,_=JSON.parse(localStorage.getItem("userSession"))),_?_.id_user&&(_.type=="admin"||_.type=="super")?(H(r),Fe(`/drivers/me/routes/${r}`)):_.id_user&&_.id_driver&&(H(r),Fe(`/drivers/${_.id_driver}/routes/${r}`)):Fe("/"))},[r,d,_,T,b,h,f,v,N,U,F,B,I,M,G,q,$,ne,he,ce,l,Ee,_e,Ie,Ce,Oe,ke,ve,Ne,ze,be,re,ee,le,Z]}class So extends Je{constructor(e){super(),Ye(this,e,To,ko,We,{routeId:0,driverId:1},null,[-1,-1])}}export{So as component};

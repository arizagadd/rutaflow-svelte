import{s as ve,j as R,k as S,l as be,h as c,m as C,i as k,p as ke,o as ge,e as p,t as H,b as h,q as I,r as M,d as X,v as F,w as f,x as $,y as Y,z as Ee,A as Ie,n as le,f as U,B as J,C as _e}from"../chunks/index.CdEBkEwf.js";import{S as ye,i as Ne,t as Z,a as ne,c as Ae,b as Oe,d as Te,m as De,e as Se,g as we}from"../chunks/index.c2pjNB5R.js";import{l as Le,p as Re,e as x,u as de,d as pe}from"../chunks/index.S9nXQbqE.js";import"../chunks/index-48209844.IIRtDZyg.js";import{I as Ce,a as Be,D as He}from"../chunks/IonPage.ChDy1LXu.js";import{g as K}from"../chunks/entry.B-LPgbXi.js";function re(t,e,n){const l=t.slice();return l[19]=e[n],l}function se(t,e,n){const l=t.slice();return l[19]=e[n],l}function ae(t){let e,n;return e=new Ce({props:{$$slots:{default:[Ye]},$$scope:{ctx:t}}}),{c(){Oe(e.$$.fragment)},l(l){Te(e.$$.fragment,l)},m(l,i){De(e,l,i),n=!0},p(l,i){const u={};i&16777279&&(u.$$scope={dirty:i,ctx:l}),e.$set(u)},i(l){n||(Z(e.$$.fragment,l),n=!0)},o(l){ne(e.$$.fragment,l),n=!1},d(l){Se(e,l)}}}function Me(t){let e=[],n=new Map,l,i=x(t[2].filter(t[13]));const u=s=>s[19].id_route;for(let s=0;s<i.length;s+=1){let r=re(t,i,s),o=u(r);n.set(o,e[s]=ue(o,r))}return{c(){for(let s=0;s<e.length;s+=1)e[s].c();l=S()},l(s){for(let r=0;r<e.length;r+=1)e[r].l(s);l=S()},m(s,r){for(let o=0;o<e.length;o+=1)e[o]&&e[o].m(s,r);k(s,l,r)},p(s,r){r&901&&(i=x(s[2].filter(s[13])),e=de(e,r,u,1,s,i,n,l.parentNode,pe,ue,l,re))},d(s){s&&c(l);for(let r=0;r<e.length;r+=1)e[r].d(s)}}}function Pe(t){let e=[],n=new Map,l,i=x(t[2]);const u=s=>s[19].id_route;for(let s=0;s<i.length;s+=1){let r=se(t,i,s),o=u(r);n.set(o,e[s]=ce(o,r))}return{c(){for(let s=0;s<e.length;s+=1)e[s].c();l=S()},l(s){for(let r=0;r<e.length;r+=1)e[r].l(s);l=S()},m(s,r){for(let o=0;o<e.length;o+=1)e[o]&&e[o].m(s,r);k(s,l,r)},p(s,r){r&900&&(i=x(s[2]),e=de(e,r,u,1,s,i,n,l.parentNode,pe,ce,l,se))},d(s){s&&c(l);for(let r=0;r<e.length;r+=1)e[r].d(s)}}}function Ue(t){let e=t[8]("false")+"",n;return{c(){n=H(e)},l(l){n=M(l,e)},m(l,i){k(l,n,i)},p:le,d(l){l&&c(n)}}}function Ve(t){let e=t[8]("true")+"",n,l,i;function u(o,a){return o[19].status!="completed"&&o[19].status!="cancelled"&&o[19].status!="finished"?ze:qe}let s=u(t),r=s(t);return{c(){n=H(e),l=R(),r.c(),i=S()},l(o){n=M(o,e),l=C(o),r.l(o),i=S()},m(o,a){k(o,n,a),k(o,l,a),r.m(o,a),k(o,i,a)},p(o,a){s===(s=u(o))&&r?r.p(o,a):(r.d(1),r=s(o),r&&(r.c(),r.m(i.parentNode,i)))},d(o){o&&(c(n),c(l),c(i)),r.d(o)}}}function qe(t){let e=t[8]("false")+"",n;return{c(){n=H(e)},l(l){n=M(l,e)},m(l,i){k(l,n,i)},p:le,d(l){l&&c(n)}}}function ze(t){let e,n,l,i,u=t[9](t[19].name.charAt(0))+"",s,r,o,a,O,N=t[19].name+"",g,q,y,D,m=t[19].date_start+"",P,V,E,d,w,B;return{c(){e=p("ion-item"),n=p("ion-avatar"),l=p("div"),i=p("div"),s=H(u),o=R(),a=p("ion-label"),O=p("h2"),g=H(N),q=R(),y=p("h3"),D=H("Inicio: "),P=H(m),V=R(),E=p("div"),d=R(),this.h()},l(v){e=h(v,"ION-ITEM",{button:!0});var _=I(e);n=h(_,"ION-AVATAR",{slot:!0});var L=I(n);l=h(L,"DIV",{class:!0,style:!0,title:!0});var A=I(l);i=h(A,"DIV",{class:!0,style:!0});var b=I(i);s=M(b,u),b.forEach(c),A.forEach(c),L.forEach(c),o=C(_),a=h(_,"ION-LABEL",{});var T=I(a);O=h(T,"H2",{});var z=I(O);g=M(z,N),z.forEach(c),q=C(T),y=h(T,"H3",{class:!0});var j=I(y);D=M(j,"Inicio: "),P=M(j,m),j.forEach(c),T.forEach(c),V=C(_),E=h(_,"DIV",{slot:!0}),I(E).forEach(c),d=C(_),_.forEach(c),this.h()},h(){U(i,"class","route-symbol svelte-1xh3ip"),U(i,"style",""),U(l,"class","route-color svelte-1xh3ip"),J(l,"background-color",G(t[19].status)),J(l,"color",te(G(t[19].status))),U(l,"title",r=ee(t[19].status)),F(n,"slot","start"),U(y,"class","text-muted svelte-1xh3ip"),U(E,"slot","end"),F(e,"button","")},m(v,_){k(v,e,_),f(e,n),f(n,l),f(l,i),f(i,s),f(e,o),f(e,a),f(a,O),f(O,g),f(a,q),f(a,y),f(y,D),f(y,P),f(e,V),f(e,E),f(e,d),w||(B=$(e,"click",function(){_e(t[7](t[19].id_route,t[19].status))&&t[7](t[19].id_route,t[19].status).apply(this,arguments)}),w=!0)},p(v,_){t=v,_&5&&u!==(u=t[9](t[19].name.charAt(0))+"")&&Y(s,u),_&5&&J(l,"background-color",G(t[19].status)),_&5&&J(l,"color",te(G(t[19].status))),_&5&&r!==(r=ee(t[19].status))&&U(l,"title",r),_&5&&N!==(N=t[19].name+"")&&Y(g,N),_&5&&m!==(m=t[19].date_start+"")&&Y(P,m)},d(v){v&&c(e),w=!1,B()}}}function ue(t,e){let n,l,i;function u(o,a){return a&5&&(l=null),l==null&&(l=!!he(o[19].date_start)),l?Ve:Ue}let s=u(e,-1),r=s(e);return{key:t,first:null,c(){n=S(),r.c(),i=S(),this.h()},l(o){n=S(),r.l(o),i=S(),this.h()},h(){this.first=n},m(o,a){k(o,n,a),r.m(o,a),k(o,i,a)},p(o,a){e=o,s===(s=u(e,a))&&r?r.p(e,a):(r.d(1),r=s(e),r&&(r.c(),r.m(i.parentNode,i)))},d(o){o&&(c(n),c(i)),r.d(o)}}}function Fe(t){let e=t[8]("false")+"",n;return{c(){n=H(e)},l(l){n=M(l,e)},m(l,i){k(l,n,i)},p:le,d(l){l&&c(n)}}}function je(t){let e=t[8]("true")+"",n,l,i;function u(o,a){return o[19].status!="completed"&&o[19].status!="cancelled"&&o[19].status!="finished"?Ge:Je}let s=u(t),r=s(t);return{c(){n=H(e),l=R(),r.c(),i=S()},l(o){n=M(o,e),l=C(o),r.l(o),i=S()},m(o,a){k(o,n,a),k(o,l,a),r.m(o,a),k(o,i,a)},p(o,a){s===(s=u(o))&&r?r.p(o,a):(r.d(1),r=s(o),r&&(r.c(),r.m(i.parentNode,i)))},d(o){o&&(c(n),c(l),c(i)),r.d(o)}}}function Je(t){let e=t[8]("false")+"",n;return{c(){n=H(e)},l(l){n=M(l,e)},m(l,i){k(l,n,i)},p:le,d(l){l&&c(n)}}}function Ge(t){let e,n,l,i,u=t[9](t[19].name.charAt(0))+"",s,r,o,a,O,N=(t[19].name?t[19].name.toUpperCase():"")+"",g,q,y,D,m=t[19].date_start+"",P,V,E,d,w,B;return{c(){e=p("ion-item"),n=p("ion-avatar"),l=p("div"),i=p("div"),s=H(u),o=R(),a=p("ion-label"),O=p("h2"),g=H(N),q=R(),y=p("h3"),D=H("Inicio: "),P=H(m),V=R(),E=p("div"),d=R(),this.h()},l(v){e=h(v,"ION-ITEM",{button:!0});var _=I(e);n=h(_,"ION-AVATAR",{slot:!0});var L=I(n);l=h(L,"DIV",{class:!0,style:!0,title:!0});var A=I(l);i=h(A,"DIV",{class:!0,style:!0});var b=I(i);s=M(b,u),b.forEach(c),A.forEach(c),L.forEach(c),o=C(_),a=h(_,"ION-LABEL",{});var T=I(a);O=h(T,"H2",{});var z=I(O);g=M(z,N),z.forEach(c),q=C(T),y=h(T,"H3",{class:!0});var j=I(y);D=M(j,"Inicio: "),P=M(j,m),j.forEach(c),T.forEach(c),V=C(_),E=h(_,"DIV",{slot:!0}),I(E).forEach(c),d=C(_),_.forEach(c),this.h()},h(){U(i,"class","route-symbol svelte-1xh3ip"),U(i,"style",""),U(l,"class","route-color svelte-1xh3ip"),J(l,"background-color",G(t[19].status)),J(l,"color",te(G(t[19].status))),U(l,"title",r=ee(t[19].status)),F(n,"slot","start"),U(y,"class","text-muted svelte-1xh3ip"),U(E,"slot","end"),F(e,"button","")},m(v,_){k(v,e,_),f(e,n),f(n,l),f(l,i),f(i,s),f(e,o),f(e,a),f(a,O),f(O,g),f(a,q),f(a,y),f(y,D),f(y,P),f(e,V),f(e,E),f(e,d),w||(B=$(e,"click",function(){_e(t[7](t[19].id_route,t[19].status))&&t[7](t[19].id_route,t[19].status).apply(this,arguments)}),w=!0)},p(v,_){t=v,_&4&&u!==(u=t[9](t[19].name.charAt(0))+"")&&Y(s,u),_&4&&J(l,"background-color",G(t[19].status)),_&4&&J(l,"color",te(G(t[19].status))),_&4&&r!==(r=ee(t[19].status))&&U(l,"title",r),_&4&&N!==(N=(t[19].name?t[19].name.toUpperCase():"")+"")&&Y(g,N),_&4&&m!==(m=t[19].date_start+"")&&Y(P,m)},d(v){v&&c(e),w=!1,B()}}}function ce(t,e){let n,l,i;function u(o,a){return a&4&&(l=null),l==null&&(l=!!he(o[19].date_start)),l?je:Fe}let s=u(e,-1),r=s(e);return{key:t,first:null,c(){n=S(),r.c(),i=S(),this.h()},l(o){n=S(),r.l(o),i=S(),this.h()},h(){this.first=n},m(o,a){k(o,n,a),r.m(o,a),k(o,i,a)},p(o,a){e=o,s===(s=u(e,a))&&r?r.p(e,a):(r.d(1),r=s(e),r&&(r.c(),r.m(i.parentNode,i)))},d(o){o&&(c(n),c(i)),r.d(o)}}}function fe(t){let e,n='<ion-row class="h-full items-center"><ion-col class="text-center"><h2 class="text-3xl text-muted mb-4 svelte-1xh3ip">No hay rutas pendientes para hoy</h2> <p class="text-muted svelte-1xh3ip">Espere indicaciones de su supervisor</p></ion-col></ion-row>';return{c(){e=p("ion-grid"),e.innerHTML=n,this.h()},l(l){e=h(l,"ION-GRID",{class:!0,"data-svelte-h":!0}),X(e)!=="svelte-3d9uou"&&(e.innerHTML=n),this.h()},h(){F(e,"class","ion-text-center h-full")},m(l,i){k(l,e,i)},d(l){l&&c(e)}}}function Ye(t){let e,n,l,i,u=t[1].name+"",s,r,o,a="RUTAS DEL DÍA",O,N,g,q=`<ion-icon icon="${Le}"></ion-icon>`,y,D,m,P='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Jale para actualizar" refreshing-spinner="circles" refreshing-text="Actualizando..."></ion-refresher-content>',V,E,d,w,B;function v(b,T){return b[0]=="me"&&b[4]?Pe:Me}let _=v(t),L=_(t),A=!t[3]&&fe();return{c(){e=p("ion-header"),n=p("ion-toolbar"),l=p("ion-buttons"),i=p("ion-button"),s=H(u),r=R(),o=p("ion-title"),o.textContent=a,O=R(),N=p("ion-buttons"),g=p("ion-button"),g.innerHTML=q,y=R(),D=p("ion-content"),m=p("ion-refresher"),m.innerHTML=P,V=R(),E=p("ion-list"),L.c(),d=R(),A&&A.c(),this.h()},l(b){e=h(b,"ION-HEADER",{translucent:!0});var T=I(e);n=h(T,"ION-TOOLBAR",{});var z=I(n);l=h(z,"ION-BUTTONS",{slot:!0});var j=I(l);i=h(j,"ION-BUTTON",{});var ie=I(i);s=M(ie,u),ie.forEach(c),j.forEach(c),r=C(z),o=h(z,"ION-TITLE",{"data-svelte-h":!0}),X(o)!=="svelte-1oi1i0m"&&(o.textContent=a),O=C(z),N=h(z,"ION-BUTTONS",{slot:!0});var oe=I(N);g=h(oe,"ION-BUTTON",{title:!0,alt:!0,"data-svelte-h":!0}),X(g)!=="svelte-1itonhq"&&(g.innerHTML=q),oe.forEach(c),z.forEach(c),T.forEach(c),y=C(b),D=h(b,"ION-CONTENT",{});var Q=I(D);m=h(Q,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),X(m)!=="svelte-1wkherr"&&(m.innerHTML=P),V=C(Q),E=h(Q,"ION-LIST",{});var W=I(E);L.l(W),d=C(W),A&&A.l(W),W.forEach(c),Q.forEach(c),this.h()},h(){F(l,"slot","secondary"),F(g,"title","Salir"),F(g,"alt","Salir"),F(N,"slot","primary"),F(e,"translucent",""),F(m,"slot","fixed")},m(b,T){k(b,e,T),f(e,n),f(n,l),f(l,i),f(i,s),f(n,r),f(n,o),f(n,O),f(n,N),f(N,g),k(b,y,T),k(b,D,T),f(D,m),t[12](m),f(D,V),f(D,E),L.m(E,null),f(E,d),A&&A.m(E,null),w||(B=[$(g,"click",t[10]),$(m,"ionRefresh",t[6])],w=!0)},p(b,T){T&2&&u!==(u=b[1].name+"")&&Y(s,u),_===(_=v(b))&&L?L.p(b,T):(L.d(1),L=_(b),L&&(L.c(),L.m(E,d))),b[3]?A&&(A.d(1),A=null):A||(A=fe(),A.c(),A.m(E,null))},d(b){b&&(c(e),c(y),c(D)),t[12](null),L.d(),A&&A.d(),w=!1,Ee(B)}}}function Ke(t){let e,n,l,i=t[1]&&ae(t);return{c(){e=R(),i&&i.c(),n=S(),this.h()},l(u){be("svelte-qavk4j",document.head).forEach(c),e=C(u),i&&i.l(u),n=S(),this.h()},h(){document.title="Rutas - Rutaflow"},m(u,s){k(u,e,s),i&&i.m(u,s),k(u,n,s),l=!0},p(u,[s]){u[1]?i?(i.p(u,s),s&2&&Z(i,1)):(i=ae(u),i.c(),Z(i,1),i.m(n.parentNode,n)):i&&(we(),ne(i,1,1,()=>{i=null}),Ae())},i(u){l||(Z(i),l=!0)},o(u){ne(i),l=!1},d(u){u&&(c(e),c(n)),i&&i.d(u)}}}function he(t){var e=me();const n=t.split(" ")[0];return e===n}function G(t){let e="#ffffff";return t==="pending"?e="#FAD733":t==="completed"?e="#27C24C":t=="enroute"?e="#3BBAC2":t=="paused"?e="#949DB9":t=="cancelled"?e="#F05050":t=="checklist"?e="#F6A833":t=="checklist-pending"&&(e="#E98C00"),e}function ee(t){let e="";return t==="pending"?e="Pendiente":t==="completed"?e="Completado":t=="enroute"?e="En ruta":t=="paused"?e="Pausado":t=="cancelled"?e="Cancelado":t=="checklist"?e="En checklist":t=="checklist-pending"&&(e="Pendiente de aprobar checklist"),e}function te(t){t.slice(0,1)==="#"&&(t=t.slice(1)),t.length===3&&(t=t.split("").map(function(u){return u+u}).join(""));const e=parseInt(t.substr(0,2),16),n=parseInt(t.substr(2,2),16),l=parseInt(t.substr(4,2),16);return(e*299+n*587+l*114)/1e3>=128?"#414040":"#fff"}function me(){var t=new Date,e=t.getDate(),n=t.getMonth()+1,l=t.getFullYear();return e<10&&(e="0"+e),n<10&&(n="0"+n),t=l+"-"+n+"-"+e,t}function Qe(t,e,n){let l;ke(t,Re,d=>n(11,l=d));let{driverId:i}=e,u=He,s=[],r=!1,o=!1,a=new Object,O;const N=async()=>{await g(),O.complete()};ge(async()=>{N()});function g(d){var w=me();const B=new FormData;B.append("id_enterprise",a.id_enterprise),B.append("actual_date",w),B.append("token",a.token),B.append("id_user_over",a.id_user),fetch(`${u}api/admin/report/seguimiento_list.php`,{method:"POST",body:B}).then(v=>v.json()).then(v=>{const _=v;n(2,s=_.data.seguimiento_list),_.data.event_list}).catch(v=>{console.error("Error fetching data:",v)})}function q(d,w){w=="checklist-pending"?m("Checklist Pendiente de Autorizar","La lista de requerimientos de ruta está en revisión, podrás inciar la ruta una vez autorizado el checklist."):K(`/drivers/${i}/routes/${d}`)}function y(d){return d=="true"?n(3,r=!0):n(3,r=!1),""}const D=d=>d.charAt(0).toUpperCase()+d.slice(1),m=async(d,w)=>{await(await Be.create({header:d||"Error",message:w||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()},P=()=>{K("/"),n(4,o=!1),localStorage.removeItem("userSession")};function V(d){Ie[d?"unshift":"push"](()=>{O=d,n(5,O)})}const E=d=>d.id_driver===i;return t.$$set=d=>{"driverId"in d&&n(0,i=d.driverId)},t.$$.update=()=>{t.$$.dirty&2051&&(n(0,{driverId:i}=l.params,i),n(1,a=JSON.parse(localStorage.getItem("userSession"))),a?i=="me"&&a.id_user?a.type=="admin"||a.type=="super"?(K("/drivers/me"),g(),n(4,o=!0)):(m("Usuario no autorizado","Este usuario no tiene acceso a la app de Rutaflow, entrar en contacto con soporte"),K("/")):a&&i&&(K(`/drivers/${a.id_driver}`),g()):(m("Sesión cerrada","Será redireccionado para volver a ingresar"),K("/")))},[i,a,s,r,o,O,N,q,y,D,P,l,V,E]}class tt extends ye{constructor(e){super(),Ne(this,e,Qe,Ke,ve,{driverId:0})}}export{tt as component};

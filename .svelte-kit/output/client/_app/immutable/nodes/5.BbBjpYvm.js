import{s as Ue,n as _e,r as Fe,b as pt,l as et,d as Ne,w as Et,o as It}from"../chunks/index.CP94t5tW.js";import{S as ze,i as je,e as f,s as A,q as X,c as _,r as E,g as K,f as s,k as S,u as G,v as y,b as U,A as V,d as q,w as i,x as Z,h as se,F as kt,G as Ot,y as ie,H as Nt,j as wt,t as Ce,a as Pe,l as Tt,m as yt,n as Ct,o as Lt,p as Dt,z as At}from"../chunks/index.BB8175xn.js";import{a as St,c as Ht,b as Bt,p as mt,i as Mt,f as Rt,g as Pt,s as Ve,h as ke,e as pe,u as Le,d as De,j as qt}from"../chunks/index.BONkCWMX.js";import{g as ge}from"../chunks/entry.DRKOeUpc.js";import{a as vt,m as Ut,I as Ft}from"../chunks/IonPage.bGG8reFV.js";import"../chunks/index-48209844.IIRtDZyg.js";import{q as zt,t as jt}from"../chunks/ion-modal.CsJaVgKZ.js";function Vt(r){let e,t,o,n,l,d="Domicilio 2",b,I,O=r[2].line2+"",g,m,u;return{c(){e=f("ion-item"),t=f("ion-icon"),o=A(),n=f("ion-label"),l=f("p"),l.textContent=d,b=A(),I=f("h2"),g=X(O),m=A(),u=f("ion-icon"),this.h()},l(v){e=_(v,"ION-ITEM",{href:!0});var p=E(e);t=_(p,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(s),o=S(p),n=_(p,"ION-LABEL",{class:!0});var c=E(n);l=_(c,"P",{"data-svelte-h":!0}),K(l)!=="svelte-1qy148r"&&(l.textContent=d),b=S(c),I=_(c,"H2",{});var a=E(I);g=G(a,O),a.forEach(s),c.forEach(s),m=S(p),u=_(p,"ION-ICON",{icon:!0,slot:!0}),E(u).forEach(s),p.forEach(s),this.h()},h(){y(t,"icon",Ve),y(t,"slot","start"),y(n,"class","ion-text-wrap"),y(u,"icon",ke),y(u,"slot","end"),y(e,"href","https://www.google.com/maps/searhc/?api=1&query="+r[2].line2)},m(v,p){q(v,e,p),i(e,t),i(e,o),i(e,n),i(n,l),i(n,b),i(n,I),i(I,g),i(e,m),i(e,u)},p:_e,d(v){v&&s(e)}}}function Wt(r){let e,t,o,n,l,d="Domicilio 1",b,I,O=r[2].line1+"",g,m,u,v,p=r[2].line2&&r[2].line2.trim().length,c,a=p&&Xt(r);return{c(){e=f("ion-item"),t=f("ion-icon"),o=A(),n=f("ion-label"),l=f("p"),l.textContent=d,b=A(),I=f("h2"),g=X(O),m=A(),u=f("ion-icon"),v=A(),a&&a.c(),c=se(),this.h()},l(C){e=_(C,"ION-ITEM",{href:!0});var T=E(e);t=_(T,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(s),o=S(T),n=_(T,"ION-LABEL",{class:!0});var M=E(n);l=_(M,"P",{"data-svelte-h":!0}),K(l)!=="svelte-1ehcrdm"&&(l.textContent=d),b=S(M),I=_(M,"H2",{});var R=E(I);g=G(R,O),R.forEach(s),M.forEach(s),m=S(T),u=_(T,"ION-ICON",{icon:!0,slot:!0}),E(u).forEach(s),T.forEach(s),v=S(C),a&&a.l(C),c=se(),this.h()},h(){y(t,"icon",Ve),y(t,"slot","start"),y(n,"class","ion-text-wrap"),y(u,"icon",ke),y(u,"slot","end"),y(e,"href","https://www.google.com/maps/search/?api=1&query="+r[2].line1)},m(C,T){q(C,e,T),i(e,t),i(e,o),i(e,n),i(n,l),i(n,b),i(n,I),i(I,g),i(e,m),i(e,u),q(C,v,T),a&&a.m(C,T),q(C,c,T)},p(C,T){p&&a.p(C,T)},d(C){C&&(s(e),s(v),s(c)),a&&a.d(C)}}}function Xt(r){let e,t,o,n,l,d="Domicilio 2",b,I,O=r[2].line2+"",g,m,u;return{c(){e=f("ion-item"),t=f("ion-icon"),o=A(),n=f("ion-label"),l=f("p"),l.textContent=d,b=A(),I=f("h2"),g=X(O),m=A(),u=f("ion-icon"),this.h()},l(v){e=_(v,"ION-ITEM",{href:!0});var p=E(e);t=_(p,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(s),o=S(p),n=_(p,"ION-LABEL",{class:!0});var c=E(n);l=_(c,"P",{"data-svelte-h":!0}),K(l)!=="svelte-1qy148r"&&(l.textContent=d),b=S(c),I=_(c,"H2",{});var a=E(I);g=G(a,O),a.forEach(s),c.forEach(s),m=S(p),u=_(p,"ION-ICON",{icon:!0,slot:!0}),E(u).forEach(s),p.forEach(s),this.h()},h(){y(t,"icon",Ve),y(t,"slot","start"),y(n,"class","ion-text-wrap"),y(u,"icon",ke),y(u,"slot","end"),y(e,"href","https://www.google.com/maps/search/?api=1&query="+r[2].line2)},m(v,p){q(v,e,p),i(e,t),i(e,o),i(e,n),i(n,l),i(n,b),i(n,I),i(I,g),i(e,m),i(e,u)},p:_e,d(v){v&&s(e)}}}function Gt(r){let e,t=r[2].comments!="<br>"&&Jt(r);return{c(){t&&t.c(),e=se()},l(o){t&&t.l(o),e=se()},m(o,n){t&&t.m(o,n),q(o,e,n)},p(o,n){o[2].comments!="<br>"&&t.p(o,n)},d(o){o&&s(e),t&&t.d(o)}}}function Jt(r){let e,t,o,n,l,d="Notas de ubicación",b,I,O=r[2].comments+"",g;return{c(){e=f("ion-item"),t=f("ion-icon"),o=A(),n=f("ion-label"),l=f("p"),l.textContent=d,b=A(),I=f("h2"),g=X(O),this.h()},l(m){e=_(m,"ION-ITEM",{});var u=E(e);t=_(u,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(s),o=S(u),n=_(u,"ION-LABEL",{class:!0});var v=E(n);l=_(v,"P",{"data-svelte-h":!0}),K(l)!=="svelte-nhm2ft"&&(l.textContent=d),b=S(v),I=_(v,"H2",{});var p=E(I);g=G(p,O),p.forEach(s),v.forEach(s),u.forEach(s),this.h()},h(){y(t,"icon",Mt),y(t,"slot","start"),y(n,"class","ion-text-wrap")},m(m,u){q(m,e,u),i(e,t),i(e,o),i(e,n),i(n,l),i(n,b),i(n,I),i(I,g)},p:_e,d(m){m&&s(e)}}}function Kt(r){let e,t,o,n,l,d="Horarios",b,I,O=r[2].schedule+"",g;return{c(){e=f("ion-item"),t=f("ion-icon"),o=A(),n=f("ion-label"),l=f("p"),l.textContent=d,b=A(),I=f("h2"),g=X(O),this.h()},l(m){e=_(m,"ION-ITEM",{});var u=E(e);t=_(u,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(s),o=S(u),n=_(u,"ION-LABEL",{});var v=E(n);l=_(v,"P",{"data-svelte-h":!0}),K(l)!=="svelte-11q7hm5"&&(l.textContent=d),b=S(v),I=_(v,"H2",{});var p=E(I);g=G(p,O),p.forEach(s),v.forEach(s),u.forEach(s),this.h()},h(){y(t,"icon",Rt),y(t,"slot","start")},m(m,u){q(m,e,u),i(e,t),i(e,o),i(e,n),i(n,l),i(n,b),i(n,I),i(I,g)},p:_e,d(m){m&&s(e)}}}function Qt(r){let e,t,o,n,l,d="Notas del operador",b,I,O=r[2].driver_comments+"",g;return{c(){e=f("ion-item"),t=f("ion-icon"),o=A(),n=f("ion-label"),l=f("p"),l.textContent=d,b=A(),I=f("h2"),g=X(O),this.h()},l(m){e=_(m,"ION-ITEM",{});var u=E(e);t=_(u,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(s),o=S(u),n=_(u,"ION-LABEL",{});var v=E(n);l=_(v,"P",{"data-svelte-h":!0}),K(l)!=="svelte-1yk9qp4"&&(l.textContent=d),b=S(v),I=_(v,"H2",{});var p=E(I);g=G(p,O),p.forEach(s),v.forEach(s),u.forEach(s),this.h()},h(){y(t,"icon",Pt),y(t,"slot","start")},m(m,u){q(m,e,u),i(e,t),i(e,o),i(e,n),i(n,l),i(n,b),i(n,I),i(I,g)},p:_e,d(m){m&&s(e)}}}function tt(r){let e,t,o;return{c(){e=f("section"),t=f("ion-img"),this.h()},l(n){e=_(n,"SECTION",{});var l=E(e);t=_(l,"ION-IMG",{src:!0,alt:!0,style:!0}),E(t).forEach(s),l.forEach(s),this.h()},h(){et(t.src,o=r[1])||y(t,"src",o),y(t,"alt","Evidencia fotográfica"),V(t,"max-width","100%"),V(t,"margin-top","16px")},m(n,l){q(n,e,l),i(e,t)},p(n,l){l&2&&!et(t.src,o=n[1])&&y(t,"src",o)},d(n){n&&s(e)}}}function Yt(r){let e,t,o,n,l="Cancelar",d,b,I=r[2].title+"",O,g,m,u,v="Confirmar",p,c,a,C,T,M,R,B,h="Cliente",L,D,w=r[2].client_name+"",k,H,N,P=r[2].comments&&r[2].comments.trim().length,F,z=r[2].schedule&&r[2].schedule.trim().length,j,x,J,le,ne,oe,Ae,Oe,he,te,me,Se,de,We="Subir Evidencia",He,ae,Be,Me,Xe;function gt(W,ee){if(W[2].line1&&W[2].line1.trim().length)return Wt;if(W[2].line2&&W[2].line2.trim().length)return Vt}let Ge=gt(r),re=Ge&&Ge(r),ce=P&&Gt(r),ue=z&&Kt(r),fe=r[2].driver_comments&&Qt(r),Q=r[1]&&tt(r);return{c(){e=f("ion-header"),t=f("ion-toolbar"),o=f("ion-buttons"),n=f("ion-button"),n.textContent=l,d=A(),b=f("ion-title"),O=X(I),g=A(),m=f("ion-buttons"),u=f("ion-button"),u.textContent=v,p=A(),c=f("ion-content"),a=f("ion-list"),C=f("ion-item"),T=f("ion-icon"),M=A(),R=f("ion-label"),B=f("p"),B.textContent=h,L=A(),D=f("h2"),k=X(w),H=A(),re&&re.c(),N=A(),ce&&ce.c(),F=A(),ue&&ue.c(),j=A(),fe&&fe.c(),x=A(),J=f("ion-item"),le=f("ion-icon"),ne=A(),oe=f("ion-textarea"),Ae=A(),Oe=f("section"),he=f("label"),te=f("ion-button"),me=f("ion-icon"),Se=A(),de=f("label"),de.textContent=We,He=A(),ae=f("input"),Be=A(),Q&&Q.c(),this.h()},l(W){e=_(W,"ION-HEADER",{translucent:!0});var ee=E(e);t=_(ee,"ION-TOOLBAR",{});var ve=E(t);o=_(ve,"ION-BUTTONS",{slot:!0});var Je=E(o);n=_(Je,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),K(n)!=="svelte-1dnmkxs"&&(n.textContent=l),Je.forEach(s),d=S(ve),b=_(ve,"ION-TITLE",{title:!0});var Ke=E(b);O=G(Ke,I),Ke.forEach(s),g=S(ve),m=_(ve,"ION-BUTTONS",{slot:!0});var Qe=E(m);u=_(Qe,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),K(u)!=="svelte-1ida0il"&&(u.textContent=v),Qe.forEach(s),ve.forEach(s),ee.forEach(s),p=S(W),c=_(W,"ION-CONTENT",{fullscreen:!0});var Ye=E(c);a=_(Ye,"ION-LIST",{});var Y=E(a);C=_(Y,"ION-ITEM",{});var we=E(C);T=_(we,"ION-ICON",{icon:!0,slot:!0}),E(T).forEach(s),M=S(we),R=_(we,"ION-LABEL",{});var Te=E(R);B=_(Te,"P",{"data-svelte-h":!0}),K(B)!=="svelte-jrq7ei"&&(B.textContent=h),L=S(Te),D=_(Te,"H2",{});var Ze=E(D);k=G(Ze,w),Ze.forEach(s),Te.forEach(s),we.forEach(s),H=S(Y),re&&re.l(Y),N=S(Y),ce&&ce.l(Y),F=S(Y),ue&&ue.l(Y),j=S(Y),fe&&fe.l(Y),x=S(Y),J=_(Y,"ION-ITEM",{});var ye=E(J);le=_(ye,"ION-ICON",{icon:!0,slot:!0}),E(le).forEach(s),ne=S(ye),oe=_(ye,"ION-TEXTAREA",{label:!0,placeholder:!0}),E(oe).forEach(s),ye.forEach(s),Ae=S(Y),Oe=_(Y,"SECTION",{});var $e=E(Oe);he=_($e,"LABEL",{for:!0,style:!0});var xe=E(he);te=_(xe,"ION-BUTTON",{fill:!0,class:!0,expand:!0});var be=E(te);me=_(be,"ION-ICON",{icon:!0,slot:!0}),E(me).forEach(s),Se=S(be),de=_(be,"LABEL",{for:!0,style:!0,"data-svelte-h":!0}),K(de)!=="svelte-1as0od8"&&(de.textContent=We),He=S(be),ae=_(be,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0}),be.forEach(s),xe.forEach(s),$e.forEach(s),Be=S(Y),Q&&Q.l(Y),Y.forEach(s),Ye.forEach(s),this.h()},h(){y(n,"color","medium"),y(o,"slot","start"),y(b,"title",r[2].title),y(u,"strong",""),y(m,"slot","end"),y(e,"translucent",""),y(T,"icon",St),y(T,"slot","start"),y(le,"icon",Ht),y(le,"slot","start"),y(oe,"label","Notas"),y(oe,"placeholder","Escribe aquí..."),y(me,"icon",Bt),y(me,"slot","start"),U(de,"for","eventEvidence"),V(de,"padding","8px 10px"),V(ae,"display","none"),U(ae,"id","eventEvidence"),U(ae,"name","fileToUpload"),U(ae,"type","file"),U(ae,"accept","image/*"),y(te,"fill","outline"),y(te,"class","loadEvidence"),y(te,"expand","block"),U(he,"for","eventEvidence"),V(he,"display","block"),V(he,"width","100%"),y(c,"fullscreen","")},m(W,ee){q(W,e,ee),i(e,t),i(t,o),i(o,n),i(t,d),i(t,b),i(b,O),i(t,g),i(t,m),i(m,u),q(W,p,ee),q(W,c,ee),i(c,a),i(a,C),i(C,T),i(C,M),i(C,R),i(R,B),i(R,L),i(R,D),i(D,k),i(a,H),re&&re.m(a,null),i(a,N),ce&&ce.m(a,null),i(a,F),ue&&ue.m(a,null),i(a,j),fe&&fe.m(a,null),i(a,x),i(a,J),i(J,le),i(J,ne),i(J,oe),r[7](oe),i(a,Ae),i(a,Oe),i(Oe,he),i(he,te),i(te,me),i(te,Se),i(te,de),i(te,He),i(te,ae),i(a,Be),Q&&Q.m(a,null),Me||(Xe=[Z(n,"click",r[4]),Z(u,"click",r[5]),Z(ae,"change",r[3])],Me=!0)},p(W,[ee]){re&&re.p(W,ee),P&&ce.p(W,ee),z&&ue.p(W,ee),W[2].driver_comments&&fe.p(W,ee),W[1]?Q?Q.p(W,ee):(Q=tt(W),Q.c(),Q.m(a,null)):Q&&(Q.d(1),Q=null)},i:_e,o:_e,d(W){W&&(s(e),s(p),s(c)),re&&re.d(),ce&&ce.d(),ue&&ue.d(),fe&&fe.d(),r[7](null),Q&&Q.d(),Me=!1,Fe(Xe)}}}function Zt(r,e,t){let o;pt(r,mt,p=>t(6,o=p));let n=document.querySelector("ion-modal"),l=n.componentProps.delivery,d=l.driver_comments?l.driver_comments:"",b=l.img?l.img:"",I="";const O=async p=>{const a=p.target.files[0],C=await g(a);if(C){const T=new FormData;T.append("fileToUpload",C);try{const M=await fetch("https://rutaflow-app-production.up.railway.app/api/admin/manager/upload_img_driver.php",{method:"POST",body:T});if(M.ok){const R=await M.json();t(1,b=R.img),I=R.img_id}else console.error("File upload failed:",M.statusText)}catch(M){console.error("Error during file upload:",M)}}},g=async p=>new Promise(c=>{const a=new FileReader;a.onload=C=>{const T=new Image;T.src=C.target.result,T.onload=()=>{const M=document.createElement("canvas"),R=M.getContext("2d"),B=800,h=600;let L=T.width,D=T.height;L>B&&(D*=B/L,L=B),D>h&&(L*=h/D,D=h),M.width=L,M.height=D,R.drawImage(T,0,0,L,D),M.toBlob(w=>{c(w)},"image/jpeg",.7)}},a.readAsDataURL(p)}),m=()=>{n.dismiss({data:Date.now()})},u=()=>{var p=new Object;p.id_route=l.id_route,p.id_event=l.id_event,p.comments=d.value,p.img=b,p.img_id=I;const c=new FormData;for(const a in p)c.append(a,p[a]);fetch("https://rutaflow-app-production.up.railway.app/api/admin/evidence/send_evidence.php",{method:"POST",body:c}).then(a=>a.json()).then(a=>{m()}).catch(a=>{console.error("Error fetching data:",a)})};function v(p){Ne[p?"unshift":"push"](()=>{d=p,t(0,d)})}return r.$$.update=()=>{r.$$.dirty&64&&o.params},[d,b,l,O,m,u,o,v]}class $t extends ze{constructor(e){super(),je(this,e,Zt,Yt,Ue,{})}}const Re=Et({items:[],checkedIndices:[]});function nt(r,e,t){const o=r.slice();return o[19]=e[t],o}function ot(r,e){let t,o,n,l,d,b=e[19].item+"",I,O,g,m,u=(e[2][e[19].id_checklist_event]?e[2][e[19].id_checklist_event]:"Cargar evidencia")+"",v,p,c,a,C,T,M;function R(){return e[10](e[19])}function B(...h){return e[12](e[19],...h)}return C=kt(e[9][0]),{key:r,first:null,c(){t=f("ion-item"),o=f("ion-label"),n=f("input"),l=A(),d=f("p"),I=X(b),O=A(),g=f("ion-button"),m=f("label"),v=X(u),p=A(),c=f("input"),a=A(),this.h()},l(h){t=_(h,"ION-ITEM",{});var L=E(t);o=_(L,"ION-LABEL",{style:!0});var D=E(o);n=_(D,"INPUT",{id:!0,style:!0,type:!0}),l=S(D),d=_(D,"P",{style:!0});var w=E(d);I=G(w,b),w.forEach(s),D.forEach(s),O=S(L),g=_(L,"ION-BUTTON",{fill:!0,class:!0});var k=E(g);m=_(k,"LABEL",{for:!0,style:!0});var H=E(m);v=G(H,u),H.forEach(s),p=S(k),c=_(k,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0}),k.forEach(s),a=S(L),L.forEach(s),this.h()},h(){U(n,"id",`chkbox-${e[19].id_checklist_event}`),V(n,"pointer-events","auto"),U(n,"type","checkbox"),n.__value=e[19].id_checklist_event,Ot(n,n.__value),n.required=!0,V(d,"margin-left","10px"),V(o,"display","flex"),U(m,"for","chklist-"+e[19].id_checklist_event),V(m,"padding","8px 10px"),V(c,"display","none"),U(c,"id","chklist-"+e[19].id_checklist_event),U(c,"name","fileToUpload"),U(c,"type","file"),U(c,"accept","image/*"),y(g,"fill","outline"),y(g,"class","loadEvidence svelte-4jkdim"),C.p(n),this.first=t},m(h,L){q(h,t,L),i(t,o),i(o,n),n.checked=~(e[0]||[]).indexOf(n.__value),i(o,l),i(o,d),i(d,I),i(t,O),i(t,g),i(g,m),i(m,v),i(g,p),i(g,c),e[11](c),i(t,a),T||(M=[Z(n,"change",e[8]),Z(n,"change",R),Z(c,"change",B)],T=!0)},p(h,L){e=h,L&1&&(n.checked=~(e[0]||[]).indexOf(n.__value)),L&4&&u!==(u=(e[2][e[19].id_checklist_event]?e[2][e[19].id_checklist_event]:"Cargar evidencia")+"")&&ie(v,u)},d(h){h&&s(t),e[11](null),C.r(),T=!1,Fe(M)}}}function xt(r){let e,t,o,n,l="Cancelar",d,b,I="Requerimientos de ruta",O,g,m,u="Confirmar",v,p,c,a=[],C=new Map,T,M,R=pe(r[3]);const B=h=>h[19].id_checklist_event;for(let h=0;h<R.length;h+=1){let L=nt(r,R,h),D=B(L);C.set(D,a[h]=ot(D,L))}return{c(){e=f("ion-header"),t=f("ion-toolbar"),o=f("ion-buttons"),n=f("ion-button"),n.textContent=l,d=A(),b=f("ion-title"),b.textContent=I,O=A(),g=f("ion-buttons"),m=f("ion-button"),m.textContent=u,v=A(),p=f("ion-content"),c=f("ion-list");for(let h=0;h<a.length;h+=1)a[h].c();this.h()},l(h){e=_(h,"ION-HEADER",{translucent:!0});var L=E(e);t=_(L,"ION-TOOLBAR",{});var D=E(t);o=_(D,"ION-BUTTONS",{slot:!0});var w=E(o);n=_(w,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),K(n)!=="svelte-1dnmkxs"&&(n.textContent=l),w.forEach(s),d=S(D),b=_(D,"ION-TITLE",{"data-svelte-h":!0}),K(b)!=="svelte-ucox25"&&(b.textContent=I),O=S(D),g=_(D,"ION-BUTTONS",{slot:!0});var k=E(g);m=_(k,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),K(m)!=="svelte-1ida0il"&&(m.textContent=u),k.forEach(s),D.forEach(s),L.forEach(s),v=S(h),p=_(h,"ION-CONTENT",{fullscreen:!0});var H=E(p);c=_(H,"ION-LIST",{});var N=E(c);for(let P=0;P<a.length;P+=1)a[P].l(N);N.forEach(s),H.forEach(s),this.h()},h(){y(n,"color","medium"),y(o,"slot","start"),y(m,"strong",""),y(g,"slot","end"),y(e,"translucent",""),y(p,"fullscreen","")},m(h,L){q(h,e,L),i(e,t),i(t,o),i(o,n),i(t,d),i(t,b),i(t,O),i(t,g),i(g,m),q(h,v,L),q(h,p,L),i(p,c);for(let D=0;D<a.length;D+=1)a[D]&&a[D].m(c,null);T||(M=[Z(n,"click",r[4]),Z(m,"click",r[5])],T=!0)},p(h,[L]){L&207&&(R=pe(h[3]),a=Le(a,L,B,1,h,R,C,c,De,ot,null,nt))},i:_e,o:_e,d(h){h&&(s(e),s(v),s(p));for(let L=0;L<a.length;L+=1)a[L].d();T=!1,Fe(M)}}}function bt(r){return typeof r=="object"&&r!==null||Array.isArray(r)?Array.isArray(r)?r.map(e=>bt(e)).flat():Object.keys(r).filter(n=>n.toLowerCase().includes("id_checklist_event")).map(n=>r[n]):(console.error("Invalid input. Please provide a valid object or array."),[])}function en(r,e){let t=new FormData;t.append("id_route",r),t.append("status",e),fetch("https://rutaflow-app-production.up.railway.app/api/admin/route/change_status.php",{method:"POST",body:t}).then(o=>o.json()).then(o=>{}).catch(o=>{console.error("Error fetching data:",o)})}function tn(r,e,t){let o=document.querySelector("ion-modal");const n=o.componentProps.checklist,l=o.componentProps.driverId,d=o.componentProps.routeId;let b=[],I=null,O={},g={};It(()=>{Re.update(h=>(h.items=bt(n),h))});const m=async()=>{await(await vt.create({header:"Datos o checklist incompletos",message:"Carga la evidencia requerida y marca todas las casillas para confirmar",buttons:[{text:"Cerrar"}]})).present()},u=()=>{o.dismiss({data:Date.now()}),ge(`/drivers/${l}`)},v=()=>{Re.update(h=>{if(h.items.every(w=>h.checkedIndices.includes(w))){u();const w=new FormData;for(const k in O)if(O.hasOwnProperty(k)){const{img:H,img_id:N}=O[k];w.append(`selectedImages[${k}][img]`,H),w.append(`selectedImages[${k}][img_id]`,N)}fetch("https://rutaflow-app-production.up.railway.app/api/admin/checklist/add_evidence.php",{method:"POST",body:w}).then(k=>k.json()).then(k=>{en(d,"enroute")}).catch(k=>{console.error("Error fetching data:",k)})}else m();return h})},p=async(h,L)=>{const w=h.target.files[0],k=await c(w);if(k){const H=new FormData;H.append("fileToUpload",k);try{const N=await fetch("https://rutaflow-app-production.up.railway.app/api/admin/manager/upload_img_driver.php",{method:"POST",body:H});if(N.ok){const P=await N.json();O={...O,[L]:{img:P.img,img_id:P.img_id}},t(2,g={...g,[L]:P.filename})}else console.error("File upload failed:",N.statusText)}catch(N){console.error("Error during file upload:",N)}}},c=async h=>new Promise(L=>{const D=new FileReader;D.onload=w=>{const k=new Image;k.src=w.target.result,k.onload=()=>{const H=document.createElement("canvas"),N=H.getContext("2d"),P=800,F=600;let z=k.width,j=k.height;z>P&&(j*=P/z,z=P),j>F&&(z*=F/j,j=F),H.width=z,H.height=j,N.drawImage(k,0,0,z,j),H.toBlob(x=>{L(x)},"image/jpeg",.7)}},D.readAsDataURL(h)}),a=h=>{Re.update(L=>(L.checkedIndices.indexOf(h)===-1?L.checkedIndices.push(h):console.error(`ID ${h} is already checked.`),L.items.forEach(w=>{w.id_checklist_event===h&&(w.checked=!0)}),L))},C=[[]];function T(){b=Nt(C[0],this.__value,this.checked),t(0,b)}const M=h=>a(h.id_checklist_event);function R(h){Ne[h?"unshift":"push"](()=>{I=h,t(1,I)})}return[b,I,g,n,u,v,p,a,T,C,M,R,(h,L)=>p(L,h.id_checklist_event)]}class nn extends ze{constructor(e){super(),je(this,e,tn,xt,Ue,{})}}const on=(r,e)=>{if(!customElements.get(r)){class t extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const n={};for(const l of this.attributes)n[l.name]=l.value;new e({target:this.shadowRoot,props:n})}}customElements.define(r,t)}},ln=function(r){return document.createElement(r).constructor!==HTMLElement},rn=(r,e)=>{ln(r)||on(r,e)},it=async(r,e,t)=>{zt(),jt(),rn(r,e);const o=await Ut.create({component:r,componentProps:t});return o.present(),await o.onWillDismiss()};function lt(r,e,t){const o=r.slice();return o[25]=e[t],o}function rt(r,e,t){const o=r.slice();return o[25]=e[t],o}function st(r,e,t){const o=r.slice();return o[25]=e[t],o}function at(r){let e,t;return e=new Ft({props:{$$slots:{default:[fn]},$$scope:{ctx:r}}}),{c(){yt(e.$$.fragment)},l(o){Ct(e.$$.fragment,o)},m(o,n){Lt(e,o,n),t=!0},p(o,n){const l={};n[0]&127|n[1]&2&&(l.$$scope={dirty:n,ctx:o}),e.$set(l)},i(o){t||(Ce(e.$$.fragment,o),t=!0)},o(o){Pe(e.$$.fragment,o),t=!1},d(o){Dt(e,o)}}}function sn(r){let e=qe(r[0],"enroute")+"",t,o,n,l,d='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Jala para actualizar" refreshing-spinner="circles" refreshing-text="Actualizando..."></ion-refresher-content>',b,I,O=[],g=new Map,m,u,v=pe(r[3]);const p=c=>c[25].id_event;for(let c=0;c<v.length;c+=1){let a=lt(r,v,c),C=p(a);g.set(C,O[c]=ut(C,a))}return{c(){t=X(e),o=A(),n=f("ion-content"),l=f("ion-refresher"),l.innerHTML=d,b=A(),I=f("ion-list");for(let c=0;c<O.length;c+=1)O[c].c();this.h()},l(c){t=G(c,e),o=S(c),n=_(c,"ION-CONTENT",{});var a=E(n);l=_(a,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),K(l)!=="svelte-1jkndk3"&&(l.innerHTML=d),b=S(a),I=_(a,"ION-LIST",{});var C=E(I);for(let T=0;T<O.length;T+=1)O[T].l(C);C.forEach(s),a.forEach(s),this.h()},h(){y(l,"slot","fixed")},m(c,a){q(c,t,a),q(c,o,a),q(c,n,a),i(n,l),r[18](l),i(n,b),i(n,I);for(let C=0;C<O.length;C+=1)O[C]&&O[C].m(I,null);m||(u=Z(l,"ionRefresh",r[7]),m=!0)},p(c,a){a[0]&1&&e!==(e=qe(c[0],"enroute")+"")&&ie(t,e),a[0]&5384&&(v=pe(c[3]),O=Le(O,a,p,1,c,v,g,I,De,ut,null,lt))},d(c){c&&(s(t),s(o),s(n)),r[18](null);for(let a=0;a<O.length;a+=1)O[a].d();m=!1,u()}}}function an(r){let e,t;function o(d,b){return b[0]&32&&(e=null),e==null&&(e=!!d[5].every(hn)),e?un:cn}let n=o(r,[-1,-1]),l=n(r);return{c(){l.c(),t=se()},l(d){l.l(d),t=se()},m(d,b){l.m(d,b),q(d,t,b)},p(d,b){n===(n=o(d,b))&&l?l.p(d,b):(l.d(1),l=n(d),l&&(l.c(),l.m(t.parentNode,t)))},d(d){d&&s(t),l.d(d)}}}function ct(r){let e;return{c(){e=f("span"),this.h()},l(t){e=_(t,"SPAN",{class:!0}),E(e).forEach(s),this.h()},h(){U(e,"class","notes svelte-ziybgw")},m(t,o){q(t,e,o)},d(t){t&&s(e)}}}function ut(r,e){let t,o,n,l,d=parseInt(e[25].pos)+1+"",b,I,O,g,m,u,v=e[25].title+"",p,c,a=e[25].support_list&&e[25].support_list.length||e[10](e[25]),C,T,M,R,B,h=a&&ct();function L(){return e[19](e[25])}return{key:r,first:null,c(){t=f("ion-item"),o=f("ion-avatar"),n=f("div"),l=f("div"),b=X(d),O=A(),g=f("ion-label"),m=f("ion-text"),u=f("h3"),p=X(v),c=A(),h&&h.c(),C=A(),T=f("ion-icon"),M=A(),this.h()},l(D){t=_(D,"ION-ITEM",{});var w=E(t);o=_(w,"ION-AVATAR",{slot:!0});var k=E(o);n=_(k,"DIV",{class:!0,title:!0,style:!0});var H=E(n);l=_(H,"DIV",{class:!0});var N=E(l);b=G(N,d),N.forEach(s),H.forEach(s),k.forEach(s),O=S(w),g=_(w,"ION-LABEL",{button:!0});var P=E(g);m=_(P,"ION-TEXT",{color:!0});var F=E(m);u=_(F,"H3",{});var z=E(u);p=G(z,v),c=S(z),h&&h.l(z),z.forEach(s),F.forEach(s),P.forEach(s),C=S(w),T=_(w,"ION-ICON",{icon:!0,slot:!0,style:!0}),E(T).forEach(s),M=S(w),w.forEach(s),this.h()},h(){U(l,"class","order svelte-ziybgw"),U(n,"class","order-wrapper svelte-ziybgw"),U(n,"title",I=Ee(e[25].status)),V(n,"background-color",$(e[25])),V(n,"color",Ie($(e[25]))),y(o,"slot","start"),y(m,"color","#2e2e2e"),y(g,"button",""),y(T,"icon",ke),y(T,"slot","end"),V(T,"color",$(e[25])),this.first=t},m(D,w){q(D,t,w),i(t,o),i(o,n),i(n,l),i(l,b),i(t,O),i(t,g),i(g,m),i(m,u),i(u,p),i(u,c),h&&h.m(u,null),i(t,C),i(t,T),i(t,M),R||(B=Z(g,"click",L),R=!0)},p(D,w){e=D,w[0]&8&&d!==(d=parseInt(e[25].pos)+1+"")&&ie(b,d),w[0]&8&&I!==(I=Ee(e[25].status))&&U(n,"title",I),w[0]&8&&V(n,"background-color",$(e[25])),w[0]&8&&V(n,"color",Ie($(e[25]))),w[0]&8&&v!==(v=e[25].title+"")&&ie(p,v),w[0]&8&&(a=e[25].support_list&&e[25].support_list.length||e[10](e[25])),a?h||(h=ct(),h.c(),h.m(u,null)):h&&(h.d(1),h=null),w[0]&8&&V(T,"color",$(e[25]))},d(D){D&&s(t),h&&h.d(),R=!1,B()}}}function cn(r){let e=r[9](r[5],r[1],r[0])+"",t,o,n,l,d='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Pull to refresh" refreshing-spinner="circles" refreshing-text="Refreshing..."></ion-refresher-content>',b,I,O=[],g=new Map,m,u,v=pe(r[3]);const p=c=>c[25].id_event;for(let c=0;c<v.length;c+=1){let a=rt(r,v,c),C=p(a);g.set(C,O[c]=_t(C,a))}return{c(){t=X(e),o=A(),n=f("ion-content"),l=f("ion-refresher"),l.innerHTML=d,b=A(),I=f("ion-list");for(let c=0;c<O.length;c+=1)O[c].c();this.h()},l(c){t=G(c,e),o=S(c),n=_(c,"ION-CONTENT",{});var a=E(n);l=_(a,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),K(l)!=="svelte-1poui8g"&&(l.innerHTML=d),b=S(a),I=_(a,"ION-LIST",{});var C=E(I);for(let T=0;T<O.length;T+=1)O[T].l(C);C.forEach(s),a.forEach(s),this.h()},h(){y(l,"slot","fixed")},m(c,a){q(c,t,a),q(c,o,a),q(c,n,a),i(n,l),r[16](l),i(n,b),i(n,I);for(let C=0;C<O.length;C+=1)O[C]&&O[C].m(I,null);m||(u=Z(l,"ionRefresh",r[7]),m=!0)},p(c,a){a[0]&35&&e!==(e=c[9](c[5],c[1],c[0])+"")&&ie(t,e),a[0]&1288&&(v=pe(c[3]),O=Le(O,a,p,1,c,v,g,I,De,_t,null,rt))},d(c){c&&(s(t),s(o),s(n)),r[16](null);for(let a=0;a<O.length;a+=1)O[a].d();m=!1,u()}}}function un(r){let e,t,o='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Pull to refresh" refreshing-spinner="circles" refreshing-text="Refreshing..."></ion-refresher-content>',n,l,d=[],b=new Map,I,O,g=pe(r[3]);const m=u=>u[25].id_event;for(let u=0;u<g.length;u+=1){let v=st(r,g,u),p=m(v);b.set(p,d[u]=dt(p,v))}return{c(){e=f("ion-content"),t=f("ion-refresher"),t.innerHTML=o,n=A(),l=f("ion-list");for(let u=0;u<d.length;u+=1)d[u].c();this.h()},l(u){e=_(u,"ION-CONTENT",{});var v=E(e);t=_(v,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),K(t)!=="svelte-1poui8g"&&(t.innerHTML=o),n=S(v),l=_(v,"ION-LIST",{});var p=E(l);for(let c=0;c<d.length;c+=1)d[c].l(p);p.forEach(s),v.forEach(s),this.h()},h(){y(t,"slot","fixed")},m(u,v){q(u,e,v),i(e,t),r[14](t),i(e,n),i(e,l);for(let p=0;p<d.length;p+=1)d[p]&&d[p].m(l,null);I||(O=Z(t,"ionRefresh",r[7]),I=!0)},p(u,v){v[0]&1288&&(g=pe(u[3]),d=Le(d,v,m,1,u,g,b,l,De,dt,null,st))},d(u){u&&s(e),r[14](null);for(let v=0;v<d.length;v+=1)d[v].d();I=!1,O()}}}function ft(r){let e;return{c(){e=f("span"),this.h()},l(t){e=_(t,"SPAN",{class:!0}),E(e).forEach(s),this.h()},h(){U(e,"class","notes svelte-ziybgw")},m(t,o){q(t,e,o)},d(t){t&&s(e)}}}function _t(r,e){let t,o,n,l,d=parseInt(e[25].pos)+1+"",b,I,O,g,m,u,v=e[25].title+"",p,c,a=e[25].support_list&&e[25].support_list.length||e[10](e[25]),C,T,M="",R,B,h,L,D,w=a&&ft();function k(){return e[17](e[25])}return{key:r,first:null,c(){t=f("ion-item"),o=f("ion-avatar"),n=f("div"),l=f("div"),b=X(d),O=A(),g=f("ion-label"),m=f("ion-text"),u=f("h3"),p=X(v),c=A(),w&&w.c(),C=A(),T=f("div"),T.innerHTML=M,R=A(),B=f("ion-icon"),h=A(),this.h()},l(H){t=_(H,"ION-ITEM",{});var N=E(t);o=_(N,"ION-AVATAR",{slot:!0});var P=E(o);n=_(P,"DIV",{class:!0,title:!0,style:!0});var F=E(n);l=_(F,"DIV",{class:!0});var z=E(l);b=G(z,d),z.forEach(s),F.forEach(s),P.forEach(s),O=S(N),g=_(N,"ION-LABEL",{button:!0});var j=E(g);m=_(j,"ION-TEXT",{color:!0});var x=E(m);u=_(x,"H3",{});var J=E(u);p=G(J,v),c=S(J),w&&w.l(J),J.forEach(s),x.forEach(s),C=S(j),T=_(j,"DIV",{class:!0,"data-svelte-h":!0}),K(T)!=="svelte-130ohbs"&&(T.innerHTML=M),j.forEach(s),R=S(N),B=_(N,"ION-ICON",{icon:!0,slot:!0}),E(B).forEach(s),h=S(N),N.forEach(s),this.h()},h(){U(l,"class","order svelte-ziybgw"),U(n,"class","order-wrapper svelte-ziybgw"),U(n,"title",I=Ee(e[25].status)),V(n,"background-color",$(e[25])),V(n,"color",Ie($(e[25]))),y(o,"slot","start"),y(m,"color","#2e2e2e"),U(T,"class","sub svelte-ziybgw"),y(g,"button",""),y(B,"icon",ke),y(B,"slot","end"),this.first=t},m(H,N){q(H,t,N),i(t,o),i(o,n),i(n,l),i(l,b),i(t,O),i(t,g),i(g,m),i(m,u),i(u,p),i(u,c),w&&w.m(u,null),i(g,C),i(g,T),i(t,R),i(t,B),i(t,h),L||(D=Z(g,"click",k),L=!0)},p(H,N){e=H,N[0]&8&&d!==(d=parseInt(e[25].pos)+1+"")&&ie(b,d),N[0]&8&&I!==(I=Ee(e[25].status))&&U(n,"title",I),N[0]&8&&V(n,"background-color",$(e[25])),N[0]&8&&V(n,"color",Ie($(e[25]))),N[0]&8&&v!==(v=e[25].title+"")&&ie(p,v),N[0]&8&&(a=e[25].support_list&&e[25].support_list.length||e[10](e[25])),a?w||(w=ft(),w.c(),w.m(u,null)):w&&(w.d(1),w=null)},d(H){H&&s(t),w&&w.d(),L=!1,D()}}}function ht(r){let e;return{c(){e=f("span"),this.h()},l(t){e=_(t,"SPAN",{class:!0}),E(e).forEach(s),this.h()},h(){U(e,"class","notes svelte-ziybgw")},m(t,o){q(t,e,o)},d(t){t&&s(e)}}}function dt(r,e){let t,o,n,l,d=parseInt(e[25].pos)+1+"",b,I,O,g,m,u,v=e[25].title+"",p,c,a=e[25].support_list&&e[25].support_list.length||e[10](e[25]),C,T,M="",R,B,h,L,D,w=a&&ht();function k(){return e[15](e[25])}return{key:r,first:null,c(){t=f("ion-item"),o=f("ion-avatar"),n=f("div"),l=f("div"),b=X(d),O=A(),g=f("ion-label"),m=f("ion-text"),u=f("h3"),p=X(v),c=A(),w&&w.c(),C=A(),T=f("div"),T.innerHTML=M,R=A(),B=f("ion-icon"),h=A(),this.h()},l(H){t=_(H,"ION-ITEM",{});var N=E(t);o=_(N,"ION-AVATAR",{slot:!0});var P=E(o);n=_(P,"DIV",{class:!0,title:!0,style:!0});var F=E(n);l=_(F,"DIV",{class:!0});var z=E(l);b=G(z,d),z.forEach(s),F.forEach(s),P.forEach(s),O=S(N),g=_(N,"ION-LABEL",{button:!0});var j=E(g);m=_(j,"ION-TEXT",{color:!0});var x=E(m);u=_(x,"H3",{});var J=E(u);p=G(J,v),c=S(J),w&&w.l(J),J.forEach(s),x.forEach(s),C=S(j),T=_(j,"DIV",{class:!0,"data-svelte-h":!0}),K(T)!=="svelte-130ohbs"&&(T.innerHTML=M),j.forEach(s),R=S(N),B=_(N,"ION-ICON",{icon:!0,slot:!0}),E(B).forEach(s),h=S(N),N.forEach(s),this.h()},h(){U(l,"class","order svelte-ziybgw"),U(n,"class","order-wrapper svelte-ziybgw"),U(n,"title",I=Ee(e[25].status)),V(n,"background-color",$(e[25])),V(n,"color",Ie($(e[25]))),y(o,"slot","start"),y(m,"color","#2e2e2e"),U(T,"class","sub svelte-ziybgw"),y(g,"button",""),y(B,"icon",ke),y(B,"slot","end"),this.first=t},m(H,N){q(H,t,N),i(t,o),i(o,n),i(n,l),i(l,b),i(t,O),i(t,g),i(g,m),i(m,u),i(u,p),i(u,c),w&&w.m(u,null),i(g,C),i(g,T),i(t,R),i(t,B),i(t,h),L||(D=Z(g,"click",k),L=!0)},p(H,N){e=H,N[0]&8&&d!==(d=parseInt(e[25].pos)+1+"")&&ie(b,d),N[0]&8&&I!==(I=Ee(e[25].status))&&U(n,"title",I),N[0]&8&&V(n,"background-color",$(e[25])),N[0]&8&&V(n,"color",Ie($(e[25]))),N[0]&8&&v!==(v=e[25].title+"")&&ie(p,v),N[0]&8&&(a=e[25].support_list&&e[25].support_list.length||e[10](e[25])),a?w||(w=ht(),w.c(),w.m(u,null)):w&&(w.d(1),w=null)},d(H){H&&s(t),w&&w.d(),L=!1,D()}}}function fn(r){let e,t,o,n,l=`<ion-icon icon="${qt}"></ion-icon>`,d,b,I,O=r[2].name+"",g,m,u,v=r[4].name+"",p,c,a,C,T;function M(h,L){return h[5].length>0?an:sn}let R=M(r),B=R(r);return{c(){e=f("ion-header"),t=f("ion-toolbar"),o=f("ion-buttons"),n=f("ion-button"),n.innerHTML=l,d=A(),b=f("ion-buttons"),I=f("ion-button"),g=X(O),m=A(),u=f("ion-title"),p=X(v),c=A(),B.c(),a=se(),this.h()},l(h){e=_(h,"ION-HEADER",{translucent:!0});var L=E(e);t=_(L,"ION-TOOLBAR",{});var D=E(t);o=_(D,"ION-BUTTONS",{slot:!0});var w=E(o);n=_(w,"ION-BUTTON",{title:!0,alt:!0,"data-svelte-h":!0}),K(n)!=="svelte-7ppz3r"&&(n.innerHTML=l),w.forEach(s),d=S(D),b=_(D,"ION-BUTTONS",{slot:!0});var k=E(b);I=_(k,"ION-BUTTON",{});var H=E(I);g=G(H,O),H.forEach(s),k.forEach(s),m=S(D),u=_(D,"ION-TITLE",{});var N=E(u);p=G(N,v),N.forEach(s),D.forEach(s),L.forEach(s),c=S(h),B.l(h),a=se(),this.h()},h(){y(n,"title","Atrás"),y(n,"alt","Atrás"),y(o,"slot","start"),y(b,"slot","secondary"),y(e,"translucent","")},m(h,L){q(h,e,L),i(e,t),i(t,o),i(o,n),i(t,d),i(t,b),i(b,I),i(I,g),i(t,m),i(t,u),i(u,p),q(h,c,L),B.m(h,L),q(h,a,L),C||(T=Z(n,"click",r[11]),C=!0)},p(h,L){L[0]&4&&O!==(O=h[2].name+"")&&ie(g,O),L[0]&16&&v!==(v=h[4].name+"")&&ie(p,v),R===(R=M(h))&&B?B.p(h,L):(B.d(1),B=R(h),B&&(B.c(),B.m(a.parentNode,a)))},d(h){h&&(s(e),s(c),s(a)),B.d(h),C=!1,T()}}}function _n(r){let e,t,o,n=r[2]&&at(r);return{c(){e=A(),n&&n.c(),t=se(),this.h()},l(l){wt("svelte-kn0kph",document.head).forEach(s),e=S(l),n&&n.l(l),t=se(),this.h()},h(){document.title="Rutaflow - Detalles de ruta"},m(l,d){q(l,e,d),n&&n.m(l,d),q(l,t,d),o=!0},p(l,d){l[2]?n?(n.p(l,d),d[0]&4&&Ce(n,1)):(n=at(l),n.c(),Ce(n,1),n.m(t.parentNode,t)):n&&(At(),Pe(n,1,1,()=>{n=null}),Tt())},i(l){o||(Ce(n),o=!0)},o(l){Pe(n),o=!1},d(l){l&&(s(e),s(t)),n&&n.d(l)}}}function $(r){let e="#ffffff";return r.status==="pending"?e="#f2e300":r.status==="completed"&&(e="#44d900"),e}function Ee(r){let e="";return r=="pending"?e="Pendiente":r=="completed"&&(e="Completado"),e}function Ie(r){r.slice(0,1)==="#"&&(r=r.slice(1)),r.length===3&&(r=r.split("").map(function(l){return l+l}).join(""));const e=parseInt(r.substr(0,2),16),t=parseInt(r.substr(2,2),16),o=parseInt(r.substr(4,2),16);return(e*299+t*587+o*114)/1e3>=128?"#414040":"#fff"}function qe(r,e){let t=new FormData;return t.append("id_route",r),t.append("status",e),fetch("https://rutaflow-app-production.up.railway.app/api/admin/route/change_status.php",{method:"POST",body:t}).then(o=>o.json()).then(o=>{}).catch(o=>{console.error("Error fetching data:",o)}),""}const hn=r=>r.img;function dn(r,e,t){let o;pt(r,mt,k=>t(13,o=k));var n=this&&this.__awaiter||function(k,H,N,P){function F(z){return z instanceof N?z:new N(function(j){j(z)})}return new(N||(N=Promise))(function(z,j){function x(ne){try{le(P.next(ne))}catch(oe){j(oe)}}function J(ne){try{le(P.throw(ne))}catch(oe){j(oe)}}function le(ne){ne.done?z(ne.value):F(ne.value).then(x,J)}le((P=P.apply(k,H||[])).next())})};let{routeId:l}=e,{driverId:d}=e,b=new Object,I=[],O={},g={},m;const u=()=>n(void 0,void 0,void 0,function*(){yield v(l),m.complete()});function v(k){const H=new FormData;H.append("id_route",k),fetch("https://rutaflow-app-production.up.railway.app/api/admin/report/seguimiento_list.php",{method:"POST",body:H}).then(N=>N.json()).then(N=>{t(4,O=N.data.seguimiento_list[0]),t(3,I=N.data.event_list),t(5,g=N.data.checklist)}).catch(N=>{console.error("Error fetching data:",N)})}const p=k=>new Promise((H,N)=>{const P=new FormData;P.append("id_route",k.id_route),P.append("id_event",k.id_event),fetch("https://rutaflow-app-production.up.railway.app/api/admin/evidence/evidence_by_event.php",{method:"POST",body:P}).then(F=>F.json()).then(F=>{H(F.data.event_evidence[0])}).catch(F=>{console.error("Error fetching data:",F),N(F)})}),c=(k,H,N)=>{p(k).then(P=>{k.client_name=O.client_name,P&&(k.img=P.img,k.driver_comments=P.driver_comments,k.comments=P.comments),it("modal-delivery-info",$t,{delivery:k}).then(F=>{})})},a=(k,H,N)=>(it("modal-checklist",nn,{checklist:k,driverId:H,routeId:N}).then(P=>{}),qe(N,"checklist"),""),C=k=>{if(k.tracking_type=="subscription"){if(k.subscriber_info&&k.payment_type==="cash"&&new Date(k.subscriber_info.payment_next)<new Date)return!0}else if(k.tracking_type=="ecommerce"&&Number(k.payment_pending)>0)return!0;return!1},T=()=>{b.id_driver?ge(`/drivers/${b.id_driver}`):ge("/drivers/me")},M=(k,H)=>n(void 0,void 0,void 0,function*(){yield(yield vt.create({header:k||"Error",message:H||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()});function R(k){Ne[k?"unshift":"push"](()=>{m=k,t(6,m)})}const B=k=>c(k);function h(k){Ne[k?"unshift":"push"](()=>{m=k,t(6,m)})}const L=k=>c(k);function D(k){Ne[k?"unshift":"push"](()=>{m=k,t(6,m)})}const w=k=>{const H=I.findIndex(z=>z.id_event===k.id_event),N=H===0,P=H>0?I[H-1]:null;N||P&&P.img;const F=k.img!==null&&k.img!=="";F||N&&!F?c(k):M("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")};return r.$$set=k=>{"routeId"in k&&t(0,l=k.routeId),"driverId"in k&&t(1,d=k.driverId)},r.$$.update=()=>{r.$$.dirty[0]&8197&&(t(0,{routeId:l,driverId:d}=o.params,l,(t(1,d),t(13,o),t(2,b),t(0,l))),t(2,b=JSON.parse(localStorage.getItem("userSession"))),b?b.id_user&&(b.type=="admin"||b.type=="super")?(ge(`/drivers/me/routes/${l}`),v(l)):b.id_user&&b.id_driver&&(v(l),ge(`/drivers/${b.id_driver}/routes/${l}`)):ge("/"))},[l,d,b,I,O,g,m,u,c,a,C,T,M,o,R,B,h,L,D,w]}class kn extends ze{constructor(e){super(),je(this,e,dn,_n,Ue,{routeId:0,driverId:1},null,[-1,-1])}}export{kn as component};

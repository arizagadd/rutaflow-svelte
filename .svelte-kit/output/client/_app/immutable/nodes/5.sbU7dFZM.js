import{Z as xe,s as Ke,e as u,j as L,b as f,q as g,d as X,h as a,m as A,v as O,i as U,w as o,x as Z,n as me,z as Se,_ as Lt,o as At,k as ue,$ as et,t as Q,r as $,f as q,B as F,a0 as Bt,y as ae,a1 as Re,A as He,a2 as ft,l as Dt,p as St}from"../chunks/index.BYLndrM5.js";import{S as Ge,i as Xe,t as ze,a as Qe,c as Pt,b as Mt,d as Rt,m as Ht,e as Ut,g as qt}from"../chunks/index.BNHbygFo.js";import{e as Te,u as We,d as Je,a as Ft,c as zt,b as Vt,i as Tt,f as jt,g as Kt,s as tt,h as Pe,j as Gt,p as Xt}from"../chunks/index.DKf8U_Zb.js";import{g as ye}from"../chunks/entry.LWUGkaEy.js";import"../chunks/index-48209844.IIRtDZyg.js";import{m as nt,a as Ve,I as Wt}from"../chunks/IonPage.KvUD72q2.js";import{q as Jt,t as Yt}from"../chunks/ion-modal.CsJaVgKZ.js";const Zt=(i,e)=>{if(!customElements.get(i)){class t extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const n={};for(const r of this.attributes)n[r.name]=r.value;new e({target:this.shadowRoot,props:n})}}customElements.define(i,t)}},Qt=function(i){return document.createElement(i).constructor!==HTMLElement},$t=(i,e)=>{Qt(i)||Zt(i,e)},je=async(i,e,t)=>{Jt(),Yt(),$t(i,e);const l=await nt.create({component:i,componentProps:t});return l.present(),await l.onWillDismiss()};let Ae=xe({km_inicial:[],gas_inicial:[],km_final:[],gas_final:[]}),yt=xe({flag:[]});function xt(i){let e,t,l,n,r="Cancelar",_,d,p="Captura de Km/Gas",I,k,v,c="Confirmar",b,m,s,h,N,C,H;return{c(){e=u("ion-header"),t=u("ion-toolbar"),l=u("ion-buttons"),n=u("ion-button"),n.textContent=r,_=L(),d=u("ion-title"),d.textContent=p,I=L(),k=u("ion-buttons"),v=u("ion-button"),v.textContent=c,b=L(),m=u("ion-content"),s=u("ion-item"),h=u("ion-input"),this.h()},l(S){e=f(S,"ION-HEADER",{translucent:!0});var B=g(e);t=f(B,"ION-TOOLBAR",{});var y=g(t);l=f(y,"ION-BUTTONS",{slot:!0});var D=g(l);n=f(D,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),X(n)!=="svelte-17pq4f4"&&(n.textContent=r),D.forEach(a),_=A(y),d=f(y,"ION-TITLE",{"data-svelte-h":!0}),X(d)!=="svelte-1yhkaq7"&&(d.textContent=p),I=A(y),k=f(y,"ION-BUTTONS",{slot:!0});var P=g(k);v=f(P,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),X(v)!=="svelte-cm6j4s"&&(v.textContent=c),P.forEach(a),y.forEach(a),B.forEach(a),b=A(S),m=f(S,"ION-CONTENT",{fullscreen:!0});var w=g(m);s=f(w,"ION-ITEM",{});var j=g(s);h=f(j,"ION-INPUT",{class:!0,type:!0,placeholder:!0,value:!0,required:!0});var E=g(h);E.forEach(a),j.forEach(a),w.forEach(a),this.h()},h(){O(n,"color","medium"),O(l,"slot","start"),O(v,"strong",""),O(k,"slot","end"),O(e,"translucent",""),O(h,"class","fin-km"),O(h,"type","number"),O(h,"placeholder",N="Ingresa "+i[0]+" actual"),O(h,"value",i[1]),O(h,"required",""),O(m,"fullscreen","")},m(S,B){U(S,e,B),o(e,t),o(t,l),o(l,n),o(t,_),o(t,d),o(t,I),o(t,k),o(k,v),U(S,b,B),U(S,m,B),o(m,s),o(s,h),C||(H=[Z(n,"click",i[2]),Z(v,"click",i[3]),Z(h,"input",i[4])],C=!0)},p(S,[B]){B&1&&N!==(N="Ingresa "+S[0]+" actual")&&O(h,"placeholder",N),B&2&&O(h,"value",S[1])},i:me,o:me,d(S){S&&(a(e),a(b),a(m)),C=!1,Se(H)}}}function en(i,e,t){const l=Lt();let n=document.querySelector("ion-modal"),r=n.componentProps.data_type;n.componentProps.isLast;let _;yt.subscribe(v=>{r=v.flag[0],r=="km_final"||r=="km_inicial"?t(0,_="kilometraje"):t(0,_="litros de gasolina")});let d=0;function p(){nt.dismiss()}function I(){l("modalResult",{data:"Your data",role:"confirm"}),r=="km_inicial"?Ae.update(c=>({...c,km_inicial:[d]})):r=="gas_inicial"?Ae.update(c=>({...c,gas_inicial:[d]})):r=="km_final"?Ae.update(c=>({...c,km_final:[d]})):r=="gas_final"&&Ae.update(c=>({...c,gas_final:[d]})),p()}return[_,d,p,I,v=>t(1,d=v.target.value)]}class tn extends Ge{constructor(e){super(),Xe(this,e,en,xt,Ke,{})}}const Ze=xe({items:[],checkedIndices:[]});function _t(i,e,t){const l=i.slice();return l[39]=e[t],l}function nn(i){let e,t,l,n,r,_="Kilometraje inicial",d,p,I,k=i[0]?i[0]+" km.":"Cargar km",v,c,b,m,s,h,N,C="Gasolina inicial (litros)",H,S,B,y=i[1]?i[1]+" litros":"Cargar gas",D,P,w,j;return P=et(i[15][0]),{c(){e=u("ion-item"),t=u("ion-label"),l=u("input"),n=L(),r=u("p"),r.textContent=_,d=L(),p=u("ion-button"),I=u("label"),v=Q(k),c=L(),b=u("ion-item"),m=u("ion-label"),s=u("input"),h=L(),N=u("p"),N.textContent=C,H=L(),S=u("ion-button"),B=u("label"),D=Q(y),this.h()},l(E){e=f(E,"ION-ITEM",{});var T=g(e);t=f(T,"ION-LABEL",{style:!0});var M=g(t);l=f(M,"INPUT",{id:!0,style:!0,type:!0}),n=A(M),r=f(M,"P",{style:!0,"data-svelte-h":!0}),X(r)!=="svelte-88twxi"&&(r.textContent=_),M.forEach(a),d=A(T),p=f(T,"ION-BUTTON",{fill:!0,class:!0,"aria-selected":!0});var V=g(p);I=f(V,"LABEL",{for:!0,style:!0});var K=g(I);v=$(K,k),K.forEach(a),V.forEach(a),T.forEach(a),c=A(E),b=f(E,"ION-ITEM",{});var G=g(b);m=f(G,"ION-LABEL",{style:!0});var W=g(m);s=f(W,"INPUT",{id:!0,style:!0,type:!0}),h=A(W),N=f(W,"P",{style:!0,"data-svelte-h":!0}),X(N)!=="svelte-1ux30eb"&&(N.textContent=C),W.forEach(a),H=A(G),S=f(G,"ION-BUTTON",{fill:!0,class:!0});var ee=g(S);B=f(ee,"LABEL",{for:!0,style:!0});var fe=g(B);D=$(fe,y),fe.forEach(a),ee.forEach(a),G.forEach(a),this.h()},h(){q(l,"id","chkbox-km-ini"),F(l,"pointer-events","auto"),q(l,"type","checkbox"),l.required=!0,F(r,"margin-left","10px"),F(t,"display","flex"),q(I,"for","chklist-km-ini"),F(I,"padding","8px 10px"),O(p,"fill","outline"),O(p,"class","loadKmInicial"),O(p,"aria-selected",""),q(s,"id","chkbox-gas-ini"),F(s,"pointer-events","auto"),q(s,"type","checkbox"),s.required=!0,F(N,"margin-left","10px"),F(m,"display","flex"),q(B,"for","chklist-gas-ini"),F(B,"padding","8px 10px"),O(S,"fill","outline"),O(S,"class","loadGasInicial"),P.p(l,s)},m(E,T){U(E,e,T),o(e,t),o(t,l),l.checked=~(i[4]||[]).indexOf(l.__value),o(t,n),o(t,r),o(e,d),o(e,p),o(p,I),o(I,v),U(E,c,T),U(E,b,T),o(b,m),o(m,s),s.checked=~(i[4]||[]).indexOf(s.__value),o(m,h),o(m,N),o(b,H),o(b,S),o(S,B),o(B,D),w||(j=[Z(l,"change",i[19]),Z(p,"click",i[20]),Z(s,"change",i[21]),Z(S,"click",i[22])],w=!0)},p(E,T){T[0]&16&&(l.checked=~(E[4]||[]).indexOf(l.__value)),T[0]&1&&k!==(k=E[0]?E[0]+" km.":"Cargar km")&&ae(v,k),T[0]&16&&(s.checked=~(E[4]||[]).indexOf(s.__value)),T[0]&2&&y!==(y=E[1]?E[1]+" litros":"Cargar gas")&&ae(D,y)},d(E){E&&(a(e),a(c),a(b)),P.r(),w=!1,Se(j)}}}function ln(i){let e,t,l,n,r,_="Kilometraje final",d,p,I,k=i[2]?i[2]+" km.":"Cargar km",v,c,b,m,s,h,N,C="Gasolina final (litros)",H,S,B,y=i[3]?i[3]+" litros":"Cargar gas",D,P,w,j;return P=et(i[15][0]),{c(){e=u("ion-item"),t=u("ion-label"),l=u("input"),n=L(),r=u("p"),r.textContent=_,d=L(),p=u("ion-button"),I=u("label"),v=Q(k),c=L(),b=u("ion-item"),m=u("ion-label"),s=u("input"),h=L(),N=u("p"),N.textContent=C,H=L(),S=u("ion-button"),B=u("label"),D=Q(y),this.h()},l(E){e=f(E,"ION-ITEM",{});var T=g(e);t=f(T,"ION-LABEL",{style:!0});var M=g(t);l=f(M,"INPUT",{id:!0,style:!0,type:!0}),n=A(M),r=f(M,"P",{style:!0,"data-svelte-h":!0}),X(r)!=="svelte-ccmu71"&&(r.textContent=_),M.forEach(a),d=A(T),p=f(T,"ION-BUTTON",{fill:!0,class:!0,"aria-selected":!0});var V=g(p);I=f(V,"LABEL",{for:!0,style:!0});var K=g(I);v=$(K,k),K.forEach(a),V.forEach(a),T.forEach(a),c=A(E),b=f(E,"ION-ITEM",{});var G=g(b);m=f(G,"ION-LABEL",{style:!0});var W=g(m);s=f(W,"INPUT",{id:!0,style:!0,type:!0}),h=A(W),N=f(W,"P",{style:!0,"data-svelte-h":!0}),X(N)!=="svelte-wsoyd2"&&(N.textContent=C),W.forEach(a),H=A(G),S=f(G,"ION-BUTTON",{fill:!0,class:!0});var ee=g(S);B=f(ee,"LABEL",{for:!0,style:!0});var fe=g(B);D=$(fe,y),fe.forEach(a),ee.forEach(a),G.forEach(a),this.h()},h(){q(l,"id","chkbox-km-fin"),F(l,"pointer-events","auto"),q(l,"type","checkbox"),l.required=!0,F(r,"margin-left","10px"),F(t,"display","flex"),q(I,"for","chkbox-km-fin"),F(I,"padding","8px 10px"),O(p,"fill","outline"),O(p,"class","loadKmInicial"),O(p,"aria-selected",""),q(s,"id","chkbox-gas-fin"),F(s,"pointer-events","auto"),q(s,"type","checkbox"),s.required=!0,F(N,"margin-left","10px"),F(m,"display","flex"),q(B,"for","chklist-gas-fin"),F(B,"padding","8px 10px"),O(S,"fill","outline"),O(S,"class","loadGasInicial"),P.p(l,s)},m(E,T){U(E,e,T),o(e,t),o(t,l),l.checked=~(i[4]||[]).indexOf(l.__value),o(t,n),o(t,r),o(e,d),o(e,p),o(p,I),o(I,v),U(E,c,T),U(E,b,T),o(b,m),o(m,s),s.checked=~(i[4]||[]).indexOf(s.__value),o(m,h),o(m,N),o(b,H),o(b,S),o(S,B),o(B,D),w||(j=[Z(l,"change",i[14]),Z(p,"click",i[16]),Z(s,"change",i[17]),Z(S,"click",i[18])],w=!0)},p(E,T){T[0]&16&&(l.checked=~(E[4]||[]).indexOf(l.__value)),T[0]&4&&k!==(k=E[2]?E[2]+" km.":"Cargar km")&&ae(v,k),T[0]&16&&(s.checked=~(E[4]||[]).indexOf(s.__value)),T[0]&8&&y!==(y=E[3]?E[3]+" litros":"Cargar gas")&&ae(D,y)},d(E){E&&(a(e),a(c),a(b)),P.r(),w=!1,Se(j)}}}function on(i){let e=[],t=new Map,l,n=Te(i[7]);const r=_=>_[39].id_checklist_event;for(let _=0;_<n.length;_+=1){let d=_t(i,n,_),p=r(d);t.set(p,e[_]=dt(p,d))}return{c(){for(let _=0;_<e.length;_+=1)e[_].c();l=ue()},l(_){for(let d=0;d<e.length;d+=1)e[d].l(_);l=ue()},m(_,d){for(let p=0;p<e.length;p+=1)e[p]&&e[p].m(_,d);U(_,l,d)},p(_,d){d[0]&6384&&(n=Te(_[7]),e=We(e,d,r,1,_,n,t,l.parentNode,Je,dt,l,_t))},d(_){_&&a(l);for(let d=0;d<e.length;d+=1)e[d].d(_)}}}function dt(i,e){let t,l,n,r,_,d=e[39].item+"",p,I,k,v,c=(e[6][e[39].id_checklist_event]?e[6][e[39].id_checklist_event]:"Cargar evidencia")+"",b,m,s,h,N,C,H;function S(){return e[24](e[39])}function B(...y){return e[26](e[39],...y)}return N=et(e[15][0]),{key:i,first:null,c(){t=u("ion-item"),l=u("ion-label"),n=u("input"),r=L(),_=u("p"),p=Q(d),I=L(),k=u("ion-button"),v=u("label"),b=Q(c),m=L(),s=u("input"),h=L(),this.h()},l(y){t=f(y,"ION-ITEM",{});var D=g(t);l=f(D,"ION-LABEL",{style:!0});var P=g(l);n=f(P,"INPUT",{id:!0,style:!0,type:!0}),r=A(P),_=f(P,"P",{style:!0});var w=g(_);p=$(w,d),w.forEach(a),P.forEach(a),I=A(D),k=f(D,"ION-BUTTON",{fill:!0,class:!0});var j=g(k);v=f(j,"LABEL",{for:!0,style:!0});var E=g(v);b=$(E,c),E.forEach(a),m=A(j),s=f(j,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0}),j.forEach(a),h=A(D),D.forEach(a),this.h()},h(){q(n,"id",`chkbox-${e[39].id_checklist_event}`),F(n,"pointer-events","auto"),q(n,"type","checkbox"),n.__value=e[39].id_checklist_event,Bt(n,n.__value),n.required=!0,F(_,"margin-left","10px"),F(l,"display","flex"),q(v,"for","chklist-"+e[39].id_checklist_event),F(v,"padding","8px 10px"),F(s,"display","none"),q(s,"id","chklist-"+e[39].id_checklist_event),q(s,"name","fileToUpload"),q(s,"type","file"),q(s,"accept","image/*"),O(k,"fill","outline"),O(k,"class","loadEvidence svelte-1kg2bry"),N.p(n),this.first=t},m(y,D){U(y,t,D),o(t,l),o(l,n),n.checked=~(e[4]||[]).indexOf(n.__value),o(l,r),o(l,_),o(_,p),o(t,I),o(t,k),o(k,v),o(v,b),o(k,m),o(k,s),e[25](s),o(t,h),C||(H=[Z(n,"change",e[23]),Z(n,"change",S),Z(s,"change",B)],C=!0)},p(y,D){e=y,D[0]&16&&(n.checked=~(e[4]||[]).indexOf(n.__value)),D[0]&64&&c!==(c=(e[6][e[39].id_checklist_event]?e[6][e[39].id_checklist_event]:"Cargar evidencia")+"")&&ae(b,c)},d(y){y&&a(t),e[25](null),N.r(),C=!1,Se(H)}}}function rn(i){let e,t,l,n,r="Cancelar",_,d,p="Requerimientos de ruta",I,k,v,c="Confirmar",b,m,s,h,N,C;function H(D,P){return D[8]?ln:nn}let B=H(i)(i),y=i[7]&&on(i);return{c(){e=u("ion-header"),t=u("ion-toolbar"),l=u("ion-buttons"),n=u("ion-button"),n.textContent=r,_=L(),d=u("ion-title"),d.textContent=p,I=L(),k=u("ion-buttons"),v=u("ion-button"),v.textContent=c,b=L(),m=u("ion-content"),s=u("ion-list"),B.c(),h=L(),y&&y.c(),this.h()},l(D){e=f(D,"ION-HEADER",{translucent:!0});var P=g(e);t=f(P,"ION-TOOLBAR",{});var w=g(t);l=f(w,"ION-BUTTONS",{slot:!0});var j=g(l);n=f(j,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),X(n)!=="svelte-1dnmkxs"&&(n.textContent=r),j.forEach(a),_=A(w),d=f(w,"ION-TITLE",{"data-svelte-h":!0}),X(d)!=="svelte-ucox25"&&(d.textContent=p),I=A(w),k=f(w,"ION-BUTTONS",{slot:!0});var E=g(k);v=f(E,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),X(v)!=="svelte-1ida0il"&&(v.textContent=c),E.forEach(a),w.forEach(a),P.forEach(a),b=A(D),m=f(D,"ION-CONTENT",{fullscreen:!0});var T=g(m);s=f(T,"ION-LIST",{});var M=g(s);B.l(M),h=A(M),y&&y.l(M),M.forEach(a),T.forEach(a),this.h()},h(){O(n,"color","medium"),O(l,"slot","start"),O(v,"strong",""),O(k,"slot","end"),O(e,"translucent",""),O(m,"fullscreen","")},m(D,P){U(D,e,P),o(e,t),o(t,l),o(l,n),o(t,_),o(t,d),o(t,I),o(t,k),o(k,v),U(D,b,P),U(D,m,P),o(m,s),B.m(s,null),o(s,h),y&&y.m(s,null),N||(C=[Z(n,"click",i[9]),Z(v,"click",i[10])],N=!0)},p(D,P){B.p(D,P),D[7]&&y.p(D,P)},i:me,o:me,d(D){D&&(a(e),a(b),a(m)),B.d(),y&&y.d(),N=!1,Se(C)}}}function Ct(i){return typeof i=="object"&&i!==null||Array.isArray(i)?Array.isArray(i)?i.map(e=>Ct(e)).flat():Object.keys(i).filter(n=>n.toLowerCase().includes("id_checklist_event")).map(n=>i[n]):(console.error("Invalid input. Please provide a valid object or array."),[])}function an(i,e){let t=new FormData;t.append("id_route",i),t.append("status",e),fetch("https://rutaflow-app-development.up.railway.app/api/admin/route/change_status.php",{method:"POST",body:t}).then(l=>l.json()).then(l=>{}).catch(l=>{console.error("Error fetching data:",l)})}function sn(i,e,t){let l=document.querySelector("ion-modal");const n=l.componentProps.checklist,r=l.componentProps.driverId,_=l.componentProps.routeId,d=l.componentProps.isLast;let p,I,k,v,c=[],b=null,m={},s={};At(()=>{d?console.log("Último checklist"):Ze.update(R=>(R.items=Ct(n),R))});const h=async()=>{await(await Ve.create({header:"Datos o checklist incompletos",message:"Carga la evidencia requerida y marca todas las casillas para confirmar",buttons:[{text:"Cerrar"}]})).present()},N=async()=>{await(await Ve.create({header:"Datos capturados",message:"El kilometraje y gasolina final fueron registrados correctamente, espere aprobación para finalizar ruta",buttons:[{text:"Cerrar"}]})).present()},C=async R=>{await(await Ve.create({header:"Datos inválidos",message:R=="km"?"Llena correctamente el campo de kilometraje inicial":"Llena correctamente el campo de gasolina inicial",buttons:[{text:"Cerrar"}]})).present()},H=()=>{nt.dismiss(),r?ye(`/drivers/${r}`):ye("/drivers/me")},S=()=>{if(d){var R=P(k,"km"),z=P(v,"gas");const J=new FormData;J.append("km_final",R),J.append("gas_final",z),J.append("id_route",_),R&&z?(H(),fetch("https://rutaflow-app-development.up.railway.app/api/admin/checklist/add_evidence.php",{method:"POST",body:J}).then(ie=>ie.json()).then(ie=>{N()}).catch(ie=>{console.error("Error fetching data:",ie)})):h()}else{var ne=P(p,"km"),de=P(I,"gas");Ze.update(J=>{if(J.items.every(Y=>J.checkedIndices.includes(Y))&&ne&&de){H();const Y=new FormData;for(const le in m)if(m.hasOwnProperty(le)){const{img:pe,img_id:ve}=m[le];Y.append(`selectedImages[${le}][img]`,pe),Y.append(`selectedImages[${le}][img_id]`,ve)}Y.append("km_inicial",ne),Y.append("gas_inicial",de),Y.append("id_route",_),fetch("https://rutaflow-app-development.up.railway.app/api/admin/checklist/add_evidence.php",{method:"POST",body:Y}).then(le=>le.json()).then(le=>{an(_,"enroute")}).catch(le=>{console.error("Error fetching data:",le)})}else h();return J})}T()},B=async(R,z)=>{const de=R.target.files[0],J=await y(de);if(J){const ie=new FormData;ie.append("fileToUpload",J);try{const he=await fetch("https://rutaflow-app-development.up.railway.app/api/admin/manager/upload_img_driver.php",{method:"POST",body:ie});if(he.ok){const Y=await he.json();m={...m,[z]:{img:Y.img,img_id:Y.img_id}},t(6,s={...s,[z]:Y.filename})}else console.error("File upload failed:",he.statusText)}catch(he){console.error("Error during file upload:",he)}}},y=async R=>new Promise(z=>{const ne=new FileReader;ne.onload=de=>{const J=new Image;J.src=de.target.result,J.onload=()=>{const ie=document.createElement("canvas"),he=ie.getContext("2d"),Y=800,le=600;let pe=J.width,ve=J.height;pe>Y&&(ve*=Y/pe,pe=Y),ve>le&&(pe*=le/ve,ve=le),ie.width=pe,ie.height=ve,he.drawImage(J,0,0,pe,ve),ie.toBlob(Ye=>{z(Ye)},"image/jpeg",.7)}},ne.readAsDataURL(R)}),D=R=>{Ze.update(z=>(z.checkedIndices.indexOf(R)===-1?z.checkedIndices.push(R):console.error(`ID ${R} is already checked.`),z.items.forEach(de=>{de.id_checklist_event===R&&(de.checked=!0)}),z))};function P(R,z){return/^\d+$/.test(R)?parseInt(R,10):(C(z),null)}function w(R,z){j(z),l.componentProps.data_type=z,je("modal-gas-km",tn,{r:z}).then(()=>{Ae.subscribe(ne=>{E(ne)})})}function j(R){yt.update(z=>({...z,flag:[R]}))}function E(R){t(0,p=R.km_inicial?R.km_inicial:null),t(1,I=R.gas_inicial?R.gas_inicial:null),t(2,k=R.km_final?R.km_final:null),t(3,v=R.gas_final?R.gas_final:null)}function T(){Ae.set({km_inicial:[],gas_inicial:[],km_final:[],gas_final:[]})}const M=[[]];function V(){c=Re(M[0],this.__value,this.checked),t(4,c)}const K=R=>w(R,"km_final");function G(){c=Re(M[0],this.__value,this.checked),t(4,c)}const W=R=>w(R,"gas_final");function ee(){c=Re(M[0],this.__value,this.checked),t(4,c)}const fe=R=>w(R,"km_inicial");function _e(){c=Re(M[0],this.__value,this.checked),t(4,c)}const oe=R=>w(R,"gas_inicial");function ge(){c=Re(M[0],this.__value,this.checked),t(4,c)}const ke=R=>D(R.id_checklist_event);function Me(R){He[R?"unshift":"push"](()=>{b=R,t(5,b)})}return[p,I,k,v,c,b,s,n,d,H,S,B,D,w,V,M,K,G,W,ee,fe,_e,oe,ge,ke,Me,(R,z)=>B(z,R.id_checklist_event)]}class wt extends Ge{constructor(e){super(),Xe(this,e,sn,rn,Ke,{},null,[-1,-1])}}function cn(i){let e,t,l,n,r,_="Domicilio 2",d,p,I=i[2].line2+"",k,v,c;return{c(){e=u("ion-item"),t=u("ion-icon"),l=L(),n=u("ion-label"),r=u("p"),r.textContent=_,d=L(),p=u("h2"),k=Q(I),v=L(),c=u("ion-icon"),this.h()},l(b){e=f(b,"ION-ITEM",{href:!0});var m=g(e);t=f(m,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(a),l=A(m),n=f(m,"ION-LABEL",{class:!0});var s=g(n);r=f(s,"P",{"data-svelte-h":!0}),X(r)!=="svelte-1qy148r"&&(r.textContent=_),d=A(s),p=f(s,"H2",{});var h=g(p);k=$(h,I),h.forEach(a),s.forEach(a),v=A(m),c=f(m,"ION-ICON",{icon:!0,slot:!0}),g(c).forEach(a),m.forEach(a),this.h()},h(){O(t,"icon",tt),O(t,"slot","start"),O(n,"class","ion-text-wrap"),O(c,"icon",Pe),O(c,"slot","end"),O(e,"href","https://www.google.com/maps/searhc/?api=1&query="+i[2].line2)},m(b,m){U(b,e,m),o(e,t),o(e,l),o(e,n),o(n,r),o(n,d),o(n,p),o(p,k),o(e,v),o(e,c)},p:me,d(b){b&&a(e)}}}function un(i){let e,t,l,n,r,_="Domicilio 1",d,p,I=i[2].line1+"",k,v,c,b,m=i[2].line2&&i[2].line2.trim().length,s,h=m&&fn(i);return{c(){e=u("ion-item"),t=u("ion-icon"),l=L(),n=u("ion-label"),r=u("p"),r.textContent=_,d=L(),p=u("h2"),k=Q(I),v=L(),c=u("ion-icon"),b=L(),h&&h.c(),s=ue(),this.h()},l(N){e=f(N,"ION-ITEM",{href:!0});var C=g(e);t=f(C,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(a),l=A(C),n=f(C,"ION-LABEL",{class:!0});var H=g(n);r=f(H,"P",{"data-svelte-h":!0}),X(r)!=="svelte-1ehcrdm"&&(r.textContent=_),d=A(H),p=f(H,"H2",{});var S=g(p);k=$(S,I),S.forEach(a),H.forEach(a),v=A(C),c=f(C,"ION-ICON",{icon:!0,slot:!0}),g(c).forEach(a),C.forEach(a),b=A(N),h&&h.l(N),s=ue(),this.h()},h(){O(t,"icon",tt),O(t,"slot","start"),O(n,"class","ion-text-wrap"),O(c,"icon",Pe),O(c,"slot","end"),O(e,"href","https://www.google.com/maps/search/?api=1&query="+i[2].line1)},m(N,C){U(N,e,C),o(e,t),o(e,l),o(e,n),o(n,r),o(n,d),o(n,p),o(p,k),o(e,v),o(e,c),U(N,b,C),h&&h.m(N,C),U(N,s,C)},p(N,C){m&&h.p(N,C)},d(N){N&&(a(e),a(b),a(s)),h&&h.d(N)}}}function fn(i){let e,t,l,n,r,_="Domicilio 2",d,p,I=i[2].line2+"",k,v,c;return{c(){e=u("ion-item"),t=u("ion-icon"),l=L(),n=u("ion-label"),r=u("p"),r.textContent=_,d=L(),p=u("h2"),k=Q(I),v=L(),c=u("ion-icon"),this.h()},l(b){e=f(b,"ION-ITEM",{href:!0});var m=g(e);t=f(m,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(a),l=A(m),n=f(m,"ION-LABEL",{class:!0});var s=g(n);r=f(s,"P",{"data-svelte-h":!0}),X(r)!=="svelte-1qy148r"&&(r.textContent=_),d=A(s),p=f(s,"H2",{});var h=g(p);k=$(h,I),h.forEach(a),s.forEach(a),v=A(m),c=f(m,"ION-ICON",{icon:!0,slot:!0}),g(c).forEach(a),m.forEach(a),this.h()},h(){O(t,"icon",tt),O(t,"slot","start"),O(n,"class","ion-text-wrap"),O(c,"icon",Pe),O(c,"slot","end"),O(e,"href","https://www.google.com/maps/search/?api=1&query="+i[2].line2)},m(b,m){U(b,e,m),o(e,t),o(e,l),o(e,n),o(n,r),o(n,d),o(n,p),o(p,k),o(e,v),o(e,c)},p:me,d(b){b&&a(e)}}}function _n(i){let e,t=i[2].comments!="<br>"&&dn(i);return{c(){t&&t.c(),e=ue()},l(l){t&&t.l(l),e=ue()},m(l,n){t&&t.m(l,n),U(l,e,n)},p(l,n){l[2].comments!="<br>"&&t.p(l,n)},d(l){l&&a(e),t&&t.d(l)}}}function dn(i){let e,t,l,n,r,_="Notas de ubicación",d,p,I=i[2].comments+"",k;return{c(){e=u("ion-item"),t=u("ion-icon"),l=L(),n=u("ion-label"),r=u("p"),r.textContent=_,d=L(),p=u("h2"),k=Q(I),this.h()},l(v){e=f(v,"ION-ITEM",{});var c=g(e);t=f(c,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(a),l=A(c),n=f(c,"ION-LABEL",{class:!0});var b=g(n);r=f(b,"P",{"data-svelte-h":!0}),X(r)!=="svelte-nhm2ft"&&(r.textContent=_),d=A(b),p=f(b,"H2",{});var m=g(p);k=$(m,I),m.forEach(a),b.forEach(a),c.forEach(a),this.h()},h(){O(t,"icon",Tt),O(t,"slot","start"),O(n,"class","ion-text-wrap")},m(v,c){U(v,e,c),o(e,t),o(e,l),o(e,n),o(n,r),o(n,d),o(n,p),o(p,k)},p:me,d(v){v&&a(e)}}}function hn(i){let e,t,l,n,r,_="Horarios",d,p,I=i[2].schedule+"",k;return{c(){e=u("ion-item"),t=u("ion-icon"),l=L(),n=u("ion-label"),r=u("p"),r.textContent=_,d=L(),p=u("h2"),k=Q(I),this.h()},l(v){e=f(v,"ION-ITEM",{});var c=g(e);t=f(c,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(a),l=A(c),n=f(c,"ION-LABEL",{});var b=g(n);r=f(b,"P",{"data-svelte-h":!0}),X(r)!=="svelte-11q7hm5"&&(r.textContent=_),d=A(b),p=f(b,"H2",{});var m=g(p);k=$(m,I),m.forEach(a),b.forEach(a),c.forEach(a),this.h()},h(){O(t,"icon",jt),O(t,"slot","start")},m(v,c){U(v,e,c),o(e,t),o(e,l),o(e,n),o(n,r),o(n,d),o(n,p),o(p,k)},p:me,d(v){v&&a(e)}}}function pn(i){let e,t,l,n,r,_="Notas del operador",d,p,I=i[2].driver_comments+"",k;return{c(){e=u("ion-item"),t=u("ion-icon"),l=L(),n=u("ion-label"),r=u("p"),r.textContent=_,d=L(),p=u("h2"),k=Q(I),this.h()},l(v){e=f(v,"ION-ITEM",{});var c=g(e);t=f(c,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(a),l=A(c),n=f(c,"ION-LABEL",{});var b=g(n);r=f(b,"P",{"data-svelte-h":!0}),X(r)!=="svelte-1yk9qp4"&&(r.textContent=_),d=A(b),p=f(b,"H2",{});var m=g(p);k=$(m,I),m.forEach(a),b.forEach(a),c.forEach(a),this.h()},h(){O(t,"icon",Kt),O(t,"slot","start")},m(v,c){U(v,e,c),o(e,t),o(e,l),o(e,n),o(n,r),o(n,d),o(n,p),o(p,k)},p:me,d(v){v&&a(e)}}}function mn(i){let e,t=i[2].logistic_comments!="<br>"&&vn(i);return{c(){t&&t.c(),e=ue()},l(l){t&&t.l(l),e=ue()},m(l,n){t&&t.m(l,n),U(l,e,n)},p(l,n){l[2].logistic_comments!="<br>"&&t.p(l,n)},d(l){l&&a(e),t&&t.d(l)}}}function vn(i){let e,t,l,n,r,_="Comentarios logísticos",d,p,I=i[2].logistic_comments+"",k;return{c(){e=u("ion-item"),t=u("ion-icon"),l=L(),n=u("ion-label"),r=u("p"),r.textContent=_,d=L(),p=u("h2"),k=Q(I),this.h()},l(v){e=f(v,"ION-ITEM",{});var c=g(e);t=f(c,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(a),l=A(c),n=f(c,"ION-LABEL",{class:!0});var b=g(n);r=f(b,"P",{"data-svelte-h":!0}),X(r)!=="svelte-1iz85r6"&&(r.textContent=_),d=A(b),p=f(b,"H2",{});var m=g(p);k=$(m,I),m.forEach(a),b.forEach(a),c.forEach(a),this.h()},h(){O(t,"icon",Tt),O(t,"slot","start"),O(n,"class","ion-text-wrap")},m(v,c){U(v,e,c),o(e,t),o(e,l),o(e,n),o(n,r),o(n,d),o(n,p),o(p,k)},p:me,d(v){v&&a(e)}}}function ht(i){let e,t,l;return{c(){e=u("section"),t=u("ion-img"),this.h()},l(n){e=f(n,"SECTION",{});var r=g(e);t=f(r,"ION-IMG",{src:!0,alt:!0,style:!0}),g(t).forEach(a),r.forEach(a),this.h()},h(){ft(t.src,l=i[1])||O(t,"src",l),O(t,"alt","Evidencia fotográfica"),F(t,"max-width","100%"),F(t,"margin-top","16px")},m(n,r){U(n,e,r),o(e,t)},p(n,r){r&2&&!ft(t.src,l=n[1])&&O(t,"src",l)},d(n){n&&a(e)}}}function bn(i){let e,t,l,n,r="Cancelar",_,d,p=i[2].title+"",I,k,v,c,b="Confirmar",m,s,h,N,C,H,S,B,y="Cliente",D,P,w=i[2].client_name+"",j,E,T,M=i[2].comments&&i[2].comments.trim().length,V,K=i[2].schedule&&i[2].schedule.trim().length,G,W,ee=i[2].logistic_comments&&i[2].logistic_comments.trim().length,fe,_e,oe,ge,ke,Me,Ce,R,z,ne,de,J,ie="Subir Evidencia",he,Y,le,pe,ve;function Ye(x,se){if(x[2].line1&&x[2].line1.trim().length)return un;if(x[2].line2&&x[2].line2.trim().length)return cn}let lt=Ye(i),be=lt&&lt(i),Ee=M&&_n(i),Ie=K&&hn(i),Oe=i[2].driver_comments&&pn(i),Ne=ee&&mn(i),re=i[1]&&ht(i);return{c(){e=u("ion-header"),t=u("ion-toolbar"),l=u("ion-buttons"),n=u("ion-button"),n.textContent=r,_=L(),d=u("ion-title"),I=Q(p),k=L(),v=u("ion-buttons"),c=u("ion-button"),c.textContent=b,m=L(),s=u("ion-content"),h=u("ion-list"),N=u("ion-item"),C=u("ion-icon"),H=L(),S=u("ion-label"),B=u("p"),B.textContent=y,D=L(),P=u("h2"),j=Q(w),E=L(),be&&be.c(),T=L(),Ee&&Ee.c(),V=L(),Ie&&Ie.c(),G=L(),Oe&&Oe.c(),W=L(),Ne&&Ne.c(),fe=L(),_e=u("ion-item"),oe=u("ion-icon"),ge=L(),ke=u("ion-textarea"),Me=L(),Ce=u("section"),R=u("label"),z=u("ion-button"),ne=u("ion-icon"),de=L(),J=u("label"),J.textContent=ie,he=L(),Y=u("input"),le=L(),re&&re.c(),this.h()},l(x){e=f(x,"ION-HEADER",{translucent:!0});var se=g(e);t=f(se,"ION-TOOLBAR",{});var we=g(t);l=f(we,"ION-BUTTONS",{slot:!0});var ot=g(l);n=f(ot,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),X(n)!=="svelte-1f8rjcf"&&(n.textContent=r),ot.forEach(a),_=A(we),d=f(we,"ION-TITLE",{title:!0});var it=g(d);I=$(it,p),it.forEach(a),k=A(we),v=f(we,"ION-BUTTONS",{slot:!0});var rt=g(v);c=f(rt,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),X(c)!=="svelte-1ida0il"&&(c.textContent=b),rt.forEach(a),we.forEach(a),se.forEach(a),m=A(x),s=f(x,"ION-CONTENT",{fullscreen:!0});var at=g(s);h=f(at,"ION-LIST",{});var te=g(h);N=f(te,"ION-ITEM",{});var Ue=g(N);C=f(Ue,"ION-ICON",{icon:!0,slot:!0}),g(C).forEach(a),H=A(Ue),S=f(Ue,"ION-LABEL",{});var qe=g(S);B=f(qe,"P",{"data-svelte-h":!0}),X(B)!=="svelte-jrq7ei"&&(B.textContent=y),D=A(qe),P=f(qe,"H2",{});var st=g(P);j=$(st,w),st.forEach(a),qe.forEach(a),Ue.forEach(a),E=A(te),be&&be.l(te),T=A(te),Ee&&Ee.l(te),V=A(te),Ie&&Ie.l(te),G=A(te),Oe&&Oe.l(te),W=A(te),Ne&&Ne.l(te),fe=A(te),_e=f(te,"ION-ITEM",{});var Fe=g(_e);oe=f(Fe,"ION-ICON",{icon:!0,slot:!0}),g(oe).forEach(a),ge=A(Fe),ke=f(Fe,"ION-TEXTAREA",{label:!0,placeholder:!0}),g(ke).forEach(a),Fe.forEach(a),Me=A(te),Ce=f(te,"SECTION",{});var ct=g(Ce);R=f(ct,"LABEL",{for:!0,style:!0});var ut=g(R);z=f(ut,"ION-BUTTON",{fill:!0,class:!0,expand:!0});var Le=g(z);ne=f(Le,"ION-ICON",{icon:!0,slot:!0}),g(ne).forEach(a),de=A(Le),J=f(Le,"LABEL",{for:!0,style:!0,"data-svelte-h":!0}),X(J)!=="svelte-1as0od8"&&(J.textContent=ie),he=A(Le),Y=f(Le,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0}),Le.forEach(a),ut.forEach(a),ct.forEach(a),le=A(te),re&&re.l(te),te.forEach(a),at.forEach(a),this.h()},h(){O(n,"color","medium"),O(l,"slot","start"),O(d,"title",i[2].title),O(c,"strong",""),O(v,"slot","end"),O(e,"translucent",""),O(C,"icon",Ft),O(C,"slot","start"),O(oe,"icon",zt),O(oe,"slot","start"),O(ke,"label","Notas"),O(ke,"placeholder","Escribe aquí..."),O(ne,"icon",Vt),O(ne,"slot","start"),q(J,"for","eventEvidence"),F(J,"padding","8px 10px"),F(Y,"display","none"),q(Y,"id","eventEvidence"),q(Y,"name","fileToUpload"),q(Y,"type","file"),q(Y,"accept","image/*"),O(z,"fill","outline"),O(z,"class","loadEvidence"),O(z,"expand","block"),q(R,"for","eventEvidence"),F(R,"display","block"),F(R,"width","100%"),O(s,"fullscreen","")},m(x,se){U(x,e,se),o(e,t),o(t,l),o(l,n),o(t,_),o(t,d),o(d,I),o(t,k),o(t,v),o(v,c),U(x,m,se),U(x,s,se),o(s,h),o(h,N),o(N,C),o(N,H),o(N,S),o(S,B),o(S,D),o(S,P),o(P,j),o(h,E),be&&be.m(h,null),o(h,T),Ee&&Ee.m(h,null),o(h,V),Ie&&Ie.m(h,null),o(h,G),Oe&&Oe.m(h,null),o(h,W),Ne&&Ne.m(h,null),o(h,fe),o(h,_e),o(_e,oe),o(_e,ge),o(_e,ke),i[6](ke),o(h,Me),o(h,Ce),o(Ce,R),o(R,z),o(z,ne),o(z,de),o(z,J),o(z,he),o(z,Y),o(h,le),re&&re.m(h,null),pe||(ve=[Z(n,"click",i[4]),Z(c,"click",i[5]),Z(Y,"change",i[3])],pe=!0)},p(x,[se]){be&&be.p(x,se),M&&Ee.p(x,se),K&&Ie.p(x,se),x[2].driver_comments&&Oe.p(x,se),ee&&Ne.p(x,se),x[1]?re?re.p(x,se):(re=ht(x),re.c(),re.m(h,null)):re&&(re.d(1),re=null)},i:me,o:me,d(x){x&&(a(e),a(m),a(s)),be&&be.d(),Ee&&Ee.d(),Ie&&Ie.d(),Oe&&Oe.d(),Ne&&Ne.d(),i[6](null),re&&re.d(),pe=!1,Se(ve)}}}function gn(i,e,t){let l=document.querySelector("ion-modal"),n=l.componentProps.delivery,r=l.componentProps.isLast,_=n.driver_comments?n.driver_comments:"",d=n.img?n.img:"",p="";const I=async m=>{const h=m.target.files[0];if(h){const N=new FormData;N.append("fileToUpload",h);try{const C=await fetch("https://rutaflow-app-development.up.railway.app/api/admin/manager/upload_img_driver.php",{method:"POST",body:N});if(C.ok){const H=await C.json();t(1,d=H.img),p=H.img_id,console.log(H)}else console.error("File upload failed:",C.statusText)}catch(C){console.error("Error during file upload:",C)}}},k=()=>{l.dismiss({data:Date.now()})},v=()=>{var m=new Object;m.id_route=n.id_route,m.id_event=n.id_event,m.comments=_.value,m.img=d,m.img_id=p;const s=new FormData;for(const h in m)s.append(h,m[h]);fetch("https://rutaflow-app-development.up.railway.app/api/admin/evidence/send_evidence.php",{method:"POST",body:s}).then(h=>h.json()).then(h=>{k();var N=m.id_route;r&&c("","",N,r)}).catch(h=>{console.error("Error fetching data:",h)})},c=(m,s,h,N)=>{l.componentProps.routeId=h,l.componentProps.driverId=n.id_driver,je("modal-km-gas",wt,{checklist:m,driverId:s,routeId:h,isLast:N}).then(C=>{})};function b(m){He[m?"unshift":"push"](()=>{_=m,t(0,_)})}return[_,d,n,I,k,v,b]}class kn extends Ge{constructor(e){super(),Xe(this,e,gn,bn,Ke,{})}}function pt(i,e,t){const l=i.slice();return l[26]=e[t],l}function mt(i,e,t){const l=i.slice();return l[26]=e[t],l[28]=t,l}function vt(i,e,t){const l=i.slice();return l[26]=e[t],l[28]=t,l}function bt(i){let e,t;return e=new Wt({props:{$$slots:{default:[Tn]},$$scope:{ctx:i}}}),{c(){Mt(e.$$.fragment)},l(l){Rt(e.$$.fragment,l)},m(l,n){Ht(e,l,n),t=!0},p(l,n){const r={};n[0]&127|n[1]&2&&(r.$$scope={dirty:n,ctx:l}),e.$set(r)},i(l){t||(ze(e.$$.fragment,l),t=!0)},o(l){Qe(e.$$.fragment,l),t=!1},d(l){Ut(e,l)}}}function En(i){let e=$e(i[0],"enroute")+"",t,l,n,r,_='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Jala para actualizar" refreshing-spinner="circles" refreshing-text="Actualizando..."></ion-refresher-content>',d,p,I=[],k=new Map,v,c,b=Te(i[3]);const m=s=>s[26].id_event;for(let s=0;s<b.length;s+=1){let h=pt(i,b,s),N=m(h);k.set(N,I[s]=kt(N,h))}return{c(){t=Q(e),l=L(),n=u("ion-content"),r=u("ion-refresher"),r.innerHTML=_,d=L(),p=u("ion-list");for(let s=0;s<I.length;s+=1)I[s].c();this.h()},l(s){t=$(s,e),l=A(s),n=f(s,"ION-CONTENT",{});var h=g(n);r=f(h,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),X(r)!=="svelte-1jkndk3"&&(r.innerHTML=_),d=A(h),p=f(h,"ION-LIST",{});var N=g(p);for(let C=0;C<I.length;C+=1)I[C].l(N);N.forEach(a),h.forEach(a),this.h()},h(){O(r,"slot","fixed")},m(s,h){U(s,t,h),U(s,l,h),U(s,n,h),o(n,r),i[19](r),o(n,d),o(n,p);for(let N=0;N<I.length;N+=1)I[N]&&I[N].m(p,null);v||(c=Z(r,"ionRefresh",i[7]),v=!0)},p(s,h){h[0]&1&&e!==(e=$e(s[0],"enroute")+"")&&ae(t,e),h[0]&5384&&(b=Te(s[3]),I=We(I,h,m,1,s,b,k,p,Je,kt,null,pt))},d(s){s&&(a(t),a(l),a(n)),i[19](null);for(let h=0;h<I.length;h+=1)I[h].d();v=!1,c()}}}function In(i){let e,t;function l(_,d){return d[0]&32&&(e=null),e==null&&(e=!!_[5].every(Cn)),e?Nn:On}let n=l(i,[-1,-1]),r=n(i);return{c(){r.c(),t=ue()},l(_){r.l(_),t=ue()},m(_,d){r.m(_,d),U(_,t,d)},p(_,d){n===(n=l(_,d))&&r?r.p(_,d):(r.d(1),r=n(_),r&&(r.c(),r.m(t.parentNode,t)))},d(_){_&&a(t),r.d(_)}}}function gt(i){let e;return{c(){e=u("span"),this.h()},l(t){e=f(t,"SPAN",{class:!0}),g(e).forEach(a),this.h()},h(){q(e,"class","notes svelte-ziybgw")},m(t,l){U(t,e,l)},d(t){t&&a(e)}}}function kt(i,e){let t,l,n,r,_=parseInt(e[26].pos)+1+"",d,p,I,k,v,c,b=e[26].title+"",m,s,h=e[26].support_list&&e[26].support_list.length||e[10](e[26]),N,C,H,S,B,y=h&&gt();function D(){return e[20](e[26])}return{key:i,first:null,c(){t=u("ion-item"),l=u("ion-avatar"),n=u("div"),r=u("div"),d=Q(_),I=L(),k=u("ion-label"),v=u("ion-text"),c=u("h3"),m=Q(b),s=L(),y&&y.c(),N=L(),C=u("ion-icon"),H=L(),this.h()},l(P){t=f(P,"ION-ITEM",{});var w=g(t);l=f(w,"ION-AVATAR",{slot:!0});var j=g(l);n=f(j,"DIV",{class:!0,title:!0,style:!0});var E=g(n);r=f(E,"DIV",{class:!0});var T=g(r);d=$(T,_),T.forEach(a),E.forEach(a),j.forEach(a),I=A(w),k=f(w,"ION-LABEL",{button:!0});var M=g(k);v=f(M,"ION-TEXT",{color:!0});var V=g(v);c=f(V,"H3",{});var K=g(c);m=$(K,b),s=A(K),y&&y.l(K),K.forEach(a),V.forEach(a),M.forEach(a),N=A(w),C=f(w,"ION-ICON",{icon:!0,slot:!0,style:!0}),g(C).forEach(a),H=A(w),w.forEach(a),this.h()},h(){q(r,"class","order svelte-ziybgw"),q(n,"class","order-wrapper svelte-ziybgw"),q(n,"title",p=Be(e[26].status)),F(n,"background-color",ce(e[26])),F(n,"color",De(ce(e[26]))),O(l,"slot","start"),O(v,"color","#2e2e2e"),O(k,"button",""),O(C,"icon",Pe),O(C,"slot","end"),F(C,"color",ce(e[26])),this.first=t},m(P,w){U(P,t,w),o(t,l),o(l,n),o(n,r),o(r,d),o(t,I),o(t,k),o(k,v),o(v,c),o(c,m),o(c,s),y&&y.m(c,null),o(t,N),o(t,C),o(t,H),S||(B=Z(k,"click",D),S=!0)},p(P,w){e=P,w[0]&8&&_!==(_=parseInt(e[26].pos)+1+"")&&ae(d,_),w[0]&8&&p!==(p=Be(e[26].status))&&q(n,"title",p),w[0]&8&&F(n,"background-color",ce(e[26])),w[0]&8&&F(n,"color",De(ce(e[26]))),w[0]&8&&b!==(b=e[26].title+"")&&ae(m,b),w[0]&8&&(h=e[26].support_list&&e[26].support_list.length||e[10](e[26])),h?y||(y=gt(),y.c(),y.m(c,null)):y&&(y.d(1),y=null),w[0]&8&&F(C,"color",ce(e[26]))},d(P){P&&a(t),y&&y.d(),S=!1,B()}}}function On(i){let e=i[9](i[5],i[1],i[0])+"",t,l,n,r,_='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Pull to refresh" refreshing-spinner="circles" refreshing-text="Refreshing..."></ion-refresher-content>',d,p,I=[],k=new Map,v,c,b=Te(i[3]);const m=s=>s[26].id_event;for(let s=0;s<b.length;s+=1){let h=mt(i,b,s),N=m(h);k.set(N,I[s]=It(N,h))}return{c(){t=Q(e),l=L(),n=u("ion-content"),r=u("ion-refresher"),r.innerHTML=_,d=L(),p=u("ion-list");for(let s=0;s<I.length;s+=1)I[s].c();this.h()},l(s){t=$(s,e),l=A(s),n=f(s,"ION-CONTENT",{});var h=g(n);r=f(h,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),X(r)!=="svelte-1poui8g"&&(r.innerHTML=_),d=A(h),p=f(h,"ION-LIST",{});var N=g(p);for(let C=0;C<I.length;C+=1)I[C].l(N);N.forEach(a),h.forEach(a),this.h()},h(){O(r,"slot","fixed")},m(s,h){U(s,t,h),U(s,l,h),U(s,n,h),o(n,r),i[17](r),o(n,d),o(n,p);for(let N=0;N<I.length;N+=1)I[N]&&I[N].m(p,null);v||(c=Z(r,"ionRefresh",i[7]),v=!0)},p(s,h){h[0]&35&&e!==(e=s[9](s[5],s[1],s[0])+"")&&ae(t,e),h[0]&9480&&(b=Te(s[3]),I=We(I,h,m,1,s,b,k,p,Je,It,null,mt))},d(s){s&&(a(t),a(l),a(n)),i[17](null);for(let h=0;h<I.length;h+=1)I[h].d();v=!1,c()}}}function Nn(i){let e,t,l='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Pull to refresh" refreshing-spinner="circles" refreshing-text="Refreshing..."></ion-refresher-content>',n,r,_=[],d=new Map,p,I,k=Te(i[3]);const v=c=>c[26].id_event;for(let c=0;c<k.length;c+=1){let b=vt(i,k,c),m=v(b);d.set(m,_[c]=Nt(m,b))}return{c(){e=u("ion-content"),t=u("ion-refresher"),t.innerHTML=l,n=L(),r=u("ion-list");for(let c=0;c<_.length;c+=1)_[c].c();this.h()},l(c){e=f(c,"ION-CONTENT",{});var b=g(e);t=f(b,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),X(t)!=="svelte-1poui8g"&&(t.innerHTML=l),n=A(b),r=f(b,"ION-LIST",{});var m=g(r);for(let s=0;s<_.length;s+=1)_[s].l(m);m.forEach(a),b.forEach(a),this.h()},h(){O(t,"slot","fixed")},m(c,b){U(c,e,b),o(e,t),i[15](t),o(e,n),o(e,r);for(let m=0;m<_.length;m+=1)_[m]&&_[m].m(r,null);p||(I=Z(t,"ionRefresh",i[7]),p=!0)},p(c,b){b[0]&9480&&(k=Te(c[3]),_=We(_,b,v,1,c,k,d,r,Je,Nt,null,vt))},d(c){c&&a(e),i[15](null);for(let b=0;b<_.length;b+=1)_[b].d();p=!1,I()}}}function Et(i){let e;return{c(){e=u("span"),this.h()},l(t){e=f(t,"SPAN",{class:!0}),g(e).forEach(a),this.h()},h(){q(e,"class","notes svelte-ziybgw")},m(t,l){U(t,e,l)},d(t){t&&a(e)}}}function It(i,e){let t,l,n,r,_=parseInt(e[26].pos)+1+"",d,p,I,k,v,c,b=e[26].title+"",m,s,h=e[26].support_list&&e[26].support_list.length||e[10](e[26]),N,C,H="",S,B,y,D,P,w=h&&Et();function j(){return e[18](e[26],e[28])}return{key:i,first:null,c(){t=u("ion-item"),l=u("ion-avatar"),n=u("div"),r=u("div"),d=Q(_),I=L(),k=u("ion-label"),v=u("ion-text"),c=u("h3"),m=Q(b),s=L(),w&&w.c(),N=L(),C=u("div"),C.innerHTML=H,S=L(),B=u("ion-icon"),y=L(),this.h()},l(E){t=f(E,"ION-ITEM",{});var T=g(t);l=f(T,"ION-AVATAR",{slot:!0});var M=g(l);n=f(M,"DIV",{class:!0,title:!0,style:!0});var V=g(n);r=f(V,"DIV",{class:!0});var K=g(r);d=$(K,_),K.forEach(a),V.forEach(a),M.forEach(a),I=A(T),k=f(T,"ION-LABEL",{button:!0});var G=g(k);v=f(G,"ION-TEXT",{color:!0});var W=g(v);c=f(W,"H3",{});var ee=g(c);m=$(ee,b),s=A(ee),w&&w.l(ee),ee.forEach(a),W.forEach(a),N=A(G),C=f(G,"DIV",{class:!0,"data-svelte-h":!0}),X(C)!=="svelte-130ohbs"&&(C.innerHTML=H),G.forEach(a),S=A(T),B=f(T,"ION-ICON",{icon:!0,slot:!0}),g(B).forEach(a),y=A(T),T.forEach(a),this.h()},h(){q(r,"class","order svelte-ziybgw"),q(n,"class","order-wrapper svelte-ziybgw"),q(n,"title",p=Be(e[26].status)),F(n,"background-color",ce(e[26])),F(n,"color",De(ce(e[26]))),O(l,"slot","start"),O(v,"color","#2e2e2e"),q(C,"class","sub svelte-ziybgw"),O(k,"button",""),O(B,"icon",Pe),O(B,"slot","end"),this.first=t},m(E,T){U(E,t,T),o(t,l),o(l,n),o(n,r),o(r,d),o(t,I),o(t,k),o(k,v),o(v,c),o(c,m),o(c,s),w&&w.m(c,null),o(k,N),o(k,C),o(t,S),o(t,B),o(t,y),D||(P=Z(k,"click",j),D=!0)},p(E,T){e=E,T[0]&8&&_!==(_=parseInt(e[26].pos)+1+"")&&ae(d,_),T[0]&8&&p!==(p=Be(e[26].status))&&q(n,"title",p),T[0]&8&&F(n,"background-color",ce(e[26])),T[0]&8&&F(n,"color",De(ce(e[26]))),T[0]&8&&b!==(b=e[26].title+"")&&ae(m,b),T[0]&8&&(h=e[26].support_list&&e[26].support_list.length||e[10](e[26])),h?w||(w=Et(),w.c(),w.m(c,null)):w&&(w.d(1),w=null)},d(E){E&&a(t),w&&w.d(),D=!1,P()}}}function Ot(i){let e;return{c(){e=u("span"),this.h()},l(t){e=f(t,"SPAN",{class:!0}),g(e).forEach(a),this.h()},h(){q(e,"class","notes svelte-ziybgw")},m(t,l){U(t,e,l)},d(t){t&&a(e)}}}function Nt(i,e){let t,l,n,r,_=parseInt(e[26].pos)+1+"",d,p,I,k,v,c,b=e[26].title+"",m,s,h=e[26].support_list&&e[26].support_list.length||e[10](e[26]),N,C,H="",S,B,y,D,P,w=h&&Ot();function j(){return e[16](e[26],e[28])}return{key:i,first:null,c(){t=u("ion-item"),l=u("ion-avatar"),n=u("div"),r=u("div"),d=Q(_),I=L(),k=u("ion-label"),v=u("ion-text"),c=u("h3"),m=Q(b),s=L(),w&&w.c(),N=L(),C=u("div"),C.innerHTML=H,S=L(),B=u("ion-icon"),y=L(),this.h()},l(E){t=f(E,"ION-ITEM",{});var T=g(t);l=f(T,"ION-AVATAR",{slot:!0});var M=g(l);n=f(M,"DIV",{class:!0,title:!0,style:!0});var V=g(n);r=f(V,"DIV",{class:!0});var K=g(r);d=$(K,_),K.forEach(a),V.forEach(a),M.forEach(a),I=A(T),k=f(T,"ION-LABEL",{button:!0});var G=g(k);v=f(G,"ION-TEXT",{color:!0});var W=g(v);c=f(W,"H3",{});var ee=g(c);m=$(ee,b),s=A(ee),w&&w.l(ee),ee.forEach(a),W.forEach(a),N=A(G),C=f(G,"DIV",{class:!0,"data-svelte-h":!0}),X(C)!=="svelte-130ohbs"&&(C.innerHTML=H),G.forEach(a),S=A(T),B=f(T,"ION-ICON",{icon:!0,slot:!0}),g(B).forEach(a),y=A(T),T.forEach(a),this.h()},h(){q(r,"class","order svelte-ziybgw"),q(n,"class","order-wrapper svelte-ziybgw"),q(n,"title",p=Be(e[26].status)),F(n,"background-color",ce(e[26])),F(n,"color",De(ce(e[26]))),O(l,"slot","start"),O(v,"color","#2e2e2e"),q(C,"class","sub svelte-ziybgw"),O(k,"button",""),O(B,"icon",Pe),O(B,"slot","end"),this.first=t},m(E,T){U(E,t,T),o(t,l),o(l,n),o(n,r),o(r,d),o(t,I),o(t,k),o(k,v),o(v,c),o(c,m),o(c,s),w&&w.m(c,null),o(k,N),o(k,C),o(t,S),o(t,B),o(t,y),D||(P=Z(k,"click",j),D=!0)},p(E,T){e=E,T[0]&8&&_!==(_=parseInt(e[26].pos)+1+"")&&ae(d,_),T[0]&8&&p!==(p=Be(e[26].status))&&q(n,"title",p),T[0]&8&&F(n,"background-color",ce(e[26])),T[0]&8&&F(n,"color",De(ce(e[26]))),T[0]&8&&b!==(b=e[26].title+"")&&ae(m,b),T[0]&8&&(h=e[26].support_list&&e[26].support_list.length||e[10](e[26])),h?w||(w=Ot(),w.c(),w.m(c,null)):w&&(w.d(1),w=null)},d(E){E&&a(t),w&&w.d(),D=!1,P()}}}function Tn(i){let e,t,l,n,r=`<ion-icon icon="${Gt}"></ion-icon>`,_,d,p,I=i[2].name+"",k,v,c,b=i[4].name+"",m,s,h,N,C;function H(y,D){return y[5].length>0?In:En}let S=H(i),B=S(i);return{c(){e=u("ion-header"),t=u("ion-toolbar"),l=u("ion-buttons"),n=u("ion-button"),n.innerHTML=r,_=L(),d=u("ion-buttons"),p=u("ion-button"),k=Q(I),v=L(),c=u("ion-title"),m=Q(b),s=L(),B.c(),h=ue(),this.h()},l(y){e=f(y,"ION-HEADER",{translucent:!0});var D=g(e);t=f(D,"ION-TOOLBAR",{});var P=g(t);l=f(P,"ION-BUTTONS",{slot:!0});var w=g(l);n=f(w,"ION-BUTTON",{title:!0,alt:!0,"data-svelte-h":!0}),X(n)!=="svelte-7ppz3r"&&(n.innerHTML=r),w.forEach(a),_=A(P),d=f(P,"ION-BUTTONS",{slot:!0});var j=g(d);p=f(j,"ION-BUTTON",{});var E=g(p);k=$(E,I),E.forEach(a),j.forEach(a),v=A(P),c=f(P,"ION-TITLE",{});var T=g(c);m=$(T,b),T.forEach(a),P.forEach(a),D.forEach(a),s=A(y),B.l(y),h=ue(),this.h()},h(){O(n,"title","Atrás"),O(n,"alt","Atrás"),O(l,"slot","start"),O(d,"slot","secondary"),O(e,"translucent","")},m(y,D){U(y,e,D),o(e,t),o(t,l),o(l,n),o(t,_),o(t,d),o(d,p),o(p,k),o(t,v),o(t,c),o(c,m),U(y,s,D),B.m(y,D),U(y,h,D),N||(C=Z(n,"click",i[11]),N=!0)},p(y,D){D[0]&4&&I!==(I=y[2].name+"")&&ae(k,I),D[0]&16&&b!==(b=y[4].name+"")&&ae(m,b),S===(S=H(y))&&B?B.p(y,D):(B.d(1),B=S(y),B&&(B.c(),B.m(h.parentNode,h)))},d(y){y&&(a(e),a(s),a(h)),B.d(y),N=!1,C()}}}function yn(i){let e,t,l,n=i[2]&&bt(i);return{c(){e=L(),n&&n.c(),t=ue(),this.h()},l(r){Dt("svelte-kn0kph",document.head).forEach(a),e=A(r),n&&n.l(r),t=ue(),this.h()},h(){document.title="Rutaflow - Detalles de ruta"},m(r,_){U(r,e,_),n&&n.m(r,_),U(r,t,_),l=!0},p(r,_){r[2]?n?(n.p(r,_),_[0]&4&&ze(n,1)):(n=bt(r),n.c(),ze(n,1),n.m(t.parentNode,t)):n&&(qt(),Qe(n,1,1,()=>{n=null}),Pt())},i(r){l||(ze(n),l=!0)},o(r){Qe(n),l=!1},d(r){r&&(a(e),a(t)),n&&n.d(r)}}}function ce(i){let e="#ffffff";return i.status==="pending"?e="#f2e300":i.status==="completed"&&(e="#44d900"),e}function Be(i){let e="";return i=="pending"?e="Pendiente":i=="completed"&&(e="Completado"),e}function De(i){i.slice(0,1)==="#"&&(i=i.slice(1)),i.length===3&&(i=i.split("").map(function(r){return r+r}).join(""));const e=parseInt(i.substr(0,2),16),t=parseInt(i.substr(2,2),16),l=parseInt(i.substr(4,2),16);return(e*299+t*587+l*114)/1e3>=128?"#414040":"#fff"}function $e(i,e){let t=new FormData;return t.append("id_route",i),t.append("status",e),fetch("https://rutaflow-app-development.up.railway.app/api/admin/route/change_status.php",{method:"POST",body:t}).then(l=>l.json()).then(l=>{}).catch(l=>{console.error("Error fetching data:",l)}),""}const Cn=i=>i.img;function wn(i,e,t){let l;St(i,Xt,E=>t(14,l=E));var n=this&&this.__awaiter||function(E,T,M,V){function K(G){return G instanceof M?G:new M(function(W){W(G)})}return new(M||(M=Promise))(function(G,W){function ee(oe){try{_e(V.next(oe))}catch(ge){W(ge)}}function fe(oe){try{_e(V.throw(oe))}catch(ge){W(ge)}}function _e(oe){oe.done?G(oe.value):K(oe.value).then(ee,fe)}_e((V=V.apply(E,T||[])).next())})};let{routeId:r}=e,{driverId:_}=e,d=new Object,p=[],I={},k={},v;const c=()=>n(void 0,void 0,void 0,function*(){yield b(r),v.complete()});function b(E){const T=new FormData;T.append("id_route",E),fetch("https://rutaflow-app-development.up.railway.app/api/admin/report/seguimiento_list.php",{method:"POST",body:T}).then(M=>M.json()).then(M=>{t(4,I=M.data.seguimiento_list[0]),t(3,p=M.data.event_list),t(5,k=M.data.checklist)}).catch(M=>{console.error("Error fetching data:",M)})}const m=E=>new Promise((T,M)=>{const V=new FormData;V.append("id_route",E.id_route),V.append("id_event",E.id_event),fetch("https://rutaflow-app-development.up.railway.app/api/admin/evidence/evidence_by_event.php",{method:"POST",body:V}).then(K=>K.json()).then(K=>{T(K.data.event_evidence[0])}).catch(K=>{console.error("Error fetching data:",K),M(K)})}),s=(E,T)=>{m(E).then(M=>{E.client_name=I.client_name,M&&(E.img=M.img,E.driver_comments=M.driver_comments,E.comments=M.comments),je("modal-delivery-info",kn,{delivery:E,isLast:T}).then(V=>{})})},h=(E,T,M)=>{var V=!1;return je("modal-checklist",wt,{checklist:E,driverId:T,routeId:M,isLast:V}).then(K=>{}),$e(M,"checklist"),""},N=E=>{if(E.tracking_type=="subscription"){if(E.subscriber_info&&E.payment_type==="cash"&&new Date(E.subscriber_info.payment_next)<new Date)return!0}else if(E.tracking_type=="ecommerce"&&Number(E.payment_pending)>0)return!0;return!1},C=()=>{d.id_driver?ye(`/drivers/${d.id_driver}`):ye("/drivers/me")},H=(E,T)=>n(void 0,void 0,void 0,function*(){yield(yield Ve.create({header:E||"Error",message:T||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()});function S(E){return E===p.length-1}function B(E){He[E?"unshift":"push"](()=>{v=E,t(6,v)})}const y=(E,T)=>s(E,S(T));function D(E){He[E?"unshift":"push"](()=>{v=E,t(6,v)})}const P=(E,T)=>s(E,S(T));function w(E){He[E?"unshift":"push"](()=>{v=E,t(6,v)})}const j=E=>{const T=p.findIndex(G=>G.id_event===E.id_event),M=T===0,V=T>0?p[T-1]:null;M||V&&V.img;const K=E.img!==null&&E.img!=="";K||M&&!K?s(E):H("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")};return i.$$set=E=>{"routeId"in E&&t(0,r=E.routeId),"driverId"in E&&t(1,_=E.driverId)},i.$$.update=()=>{i.$$.dirty[0]&16389&&(t(0,{routeId:r,driverId:_}=l.params,r,(t(1,_),t(14,l),t(2,d),t(0,r))),t(2,d=JSON.parse(localStorage.getItem("userSession"))),d?d.id_user&&(d.type=="admin"||d.type=="superadmin")?(ye(`/drivers/me/routes/${r}`),b(r)):d.id_user&&d.id_driver&&(b(r),ye(`/drivers/${d.id_driver}/routes/${r}`)):ye("/"))},[r,_,d,p,I,k,v,c,s,h,N,C,H,S,l,B,y,D,P,w,j]}class Rn extends Ge{constructor(e){super(),Xe(this,e,wn,yn,Ke,{routeId:0,driverId:1},null,[-1,-1])}}export{Rn as component};

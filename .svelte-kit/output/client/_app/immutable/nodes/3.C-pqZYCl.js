import{s as oe,e as f,b as _,q as y,h,v,i as ae,x as H,n as X,z as ue,A as Y,j as L,d as Z,m as R,f as ce,w as d,G as x}from"../chunks/index.BYLndrM5.js";import{S as re,i as ie,b as P,d as j,m as k,t as A,a as W,e as B,f as ee}from"../chunks/index.BNHbygFo.js";import"../chunks/index-48209844.IIRtDZyg.js";import{I as de,a as te}from"../chunks/IonPage.KvUD72q2.js";import{a as pe}from"../chunks/authStore.Dl96eK1q.js";import{g as C}from"../chunks/entry.CeogqmVd.js";function me(a){let e,o,n;return{c(){e=f("ion-input"),this.h()},l(t){e=_(t,"ION-INPUT",{type:!0,name:!0,placeholder:!0,value:!0}),y(e).forEach(h),this.h()},h(){v(e,"type",a[2]),v(e,"name",a[1]),v(e,"placeholder",a[3]),v(e,"value",a[0])},m(t,r){ae(t,e,r),o||(n=[H(e,"ionBlur",a[5]),H(e,"ionChange",a[4])],o=!0)},p(t,[r]){r&4&&v(e,"type",t[2]),r&2&&v(e,"name",t[1]),r&8&&v(e,"placeholder",t[3]),r&1&&v(e,"value",t[0])},i:X,o:X,d(t){t&&h(e),o=!1,ue(n)}}}function fe(a,e,o){let{name:n=""}=e,{type:t="text"}=e,{placeholder:r=""}=e,{value:u}=e;function g(i){o(0,u=i.target.value)}function l(){}return a.$$set=i=>{"name"in i&&o(1,n=i.name),"type"in i&&o(2,t=i.type),"placeholder"in i&&o(3,r=i.placeholder),"value"in i&&o(0,u=i.value)},[u,n,t,r,g,l]}class ne extends re{constructor(e){super(),ie(this,e,fe,me,oe,{name:1,type:2,placeholder:3,value:0})}}function _e(a){let e,o,n='<ion-col></ion-col> <ion-col class="w-80 text-center svelte-19nd3yu"><img src="/rutaflow.png" alt="Rutaflow" class="svelte-19nd3yu"/></ion-col> <ion-col></ion-col>',t,r,u,g,l,i,I,c,p,m,S,w,q,D,N,F='<ion-col class="signup-col"><ion-button class="submit-btn svelte-19nd3yu" color="#2c83d3" expand="block" type="submit">Ingresar</ion-button></ion-col>',T,M,J;function se(s){a[3](s)}let U={type:"text",placeholder:"Correo o Usuario",name:"email",required:!0};a[0].email!==void 0&&(U.value=a[0].email),c=new ne({props:U}),Y.push(()=>ee(c,"value",se));function le(s){a[4](s)}let z={type:"password",placeholder:"Contraseña",name:"password",required:!0};return a[0].password!==void 0&&(z.value=a[0].password),w=new ne({props:z}),Y.push(()=>ee(w,"value",le)),{c(){e=f("ion-content"),o=f("ion-row"),o.innerHTML=n,t=L(),r=f("div"),u=f("form"),g=f("ion-row"),l=f("ion-col"),i=f("ion-list"),I=f("ion-item"),P(c.$$.fragment),m=L(),S=f("ion-item"),P(w.$$.fragment),D=L(),N=f("ion-row"),N.innerHTML=F,this.h()},l(s){e=_(s,"ION-CONTENT",{class:!0,padding:!0});var b=y(e);o=_(b,"ION-ROW",{class:!0,"data-svelte-h":!0}),Z(o)!=="svelte-1mi73el"&&(o.innerHTML=n),t=R(b),r=_(b,"DIV",{class:!0});var E=y(r);u=_(E,"FORM",{});var O=y(u);g=_(O,"ION-ROW",{});var G=y(g);l=_(G,"ION-COL",{});var V=y(l);i=_(V,"ION-LIST",{});var $=y(i);I=_($,"ION-ITEM",{});var K=y(I);j(c.$$.fragment,K),K.forEach(h),m=R($),S=_($,"ION-ITEM",{});var Q=y(S);j(w.$$.fragment,Q),Q.forEach(h),$.forEach(h),V.forEach(h),G.forEach(h),D=R(O),N=_(O,"ION-ROW",{"data-svelte-h":!0}),Z(N)!=="svelte-19dro8s"&&(N.innerHTML=F),O.forEach(h),E.forEach(h),b.forEach(h),this.h()},h(){v(o,"class","logo-row svelte-19nd3yu"),ce(r,"class","login-box svelte-19nd3yu"),v(e,"class","login-content"),v(e,"padding","")},m(s,b){ae(s,e,b),d(e,o),d(e,t),d(e,r),d(r,u),d(u,g),d(g,l),d(l,i),d(i,I),k(c,I,null),d(i,m),d(i,S),k(w,S,null),d(u,D),d(u,N),T=!0,M||(J=H(u,"submit",a[1]),M=!0)},p(s,b){const E={};!p&&b&1&&(p=!0,E.value=s[0].email,x(()=>p=!1)),c.$set(E);const O={};!q&&b&1&&(q=!0,O.value=s[0].password,x(()=>q=!1)),w.$set(O)},i(s){T||(A(c.$$.fragment,s),A(w.$$.fragment,s),T=!0)},o(s){W(c.$$.fragment,s),W(w.$$.fragment,s),T=!1},d(s){s&&h(e),B(c),B(w),M=!1,J()}}}function he(a){let e,o;return e=new de({props:{$$slots:{default:[_e]},$$scope:{ctx:a}}}),{c(){P(e.$$.fragment)},l(n){j(e.$$.fragment,n)},m(n,t){k(e,n,t),o=!0},p(n,[t]){const r={};t&33&&(r.$$scope={dirty:t,ctx:n}),e.$set(r)},i(n){o||(A(e.$$.fragment,n),o=!0)},o(n){W(e.$$.fragment,n),o=!1},d(n){B(e,n)}}}function ve(a,e,o){let n={},t=new Object;const r=l=>{l.preventDefault(),console.log("submit",n);const i=async()=>{await(await te.create({header:"Datos inválidos",message:"El correo o la contraseña son incorrectos, vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()},I=async()=>{await(await te.create({header:"Sin perfil de operador",message:"Su cuenta no cuenta con un perfil de operador creado",buttons:[{text:"Cerrar"}]})).present()},c=new FormData;return c.append("email",n.email),c.append("pass",n.password),fetch("https://rutaflow-app-development.up.railway.app/api/admin/user/user_login.php",{method:"POST",body:c}).then(p=>p.json()).then(p=>{if(p.nodos.length){const m=p.nodos[0];localStorage.setItem("userSession",JSON.stringify(m)),pe.set({resolved:!0,id:m.id_driver?m.id_driver:"me",user:{userData:m}}),console.log(m),m.id_driver?C(`/drivers/${m.id_driver}`):(C("/drivers/me"),I())}else i()}).catch(p=>{i()})};function u(l){a.$$.not_equal(n.email,l)&&(n.email=l,o(0,n))}function g(l){a.$$.not_equal(n.password,l)&&(n.password=l,o(0,n))}return a.$$.update=()=>{a.$$.dirty&4&&(o(2,t=JSON.parse(localStorage.getItem("userSession"))),t?t.id_user&&(t.type=="admin"||t.type=="superadmin")?C("/drivers/me"):t.id_user&&t.id_driver&&C(`/drivers/${t.id_driver}`):C("/"))},[n,r,t,u,g]}class Ne extends re{constructor(e){super(),ie(this,e,ve,he,oe,{})}}export{Ne as component};

import{w as Ot,s as Ge,n as _e,r as Ke,o as Nt,d as Ie,l as it,b as wt}from"../chunks/index.CP94t5tW.js";import{S as Xe,i as We,e as f,s as L,c as _,r as g,g as oe,f as s,k as D,v as I,d as H,w as i,x as se,h as fe,F as Tt,q as x,u as ee,b as U,A as z,G as yt,y as he,H as Ct,j as Lt,t as Se,a as je,l as Dt,m as Pt,n as At,o as St,p as Mt,z as Bt}from"../chunks/index.BB8175xn.js";import{e as ke,u as Be,d as He,a as Ht,c as qt,b as Rt,i as gt,f as Ut,g as Vt,s as Je,h as Ce,j as jt,p as Ft}from"../chunks/index.CCBs-qbP.js";import{g as Oe}from"../chunks/entry.By4lVSh9.js";import"../chunks/index-48209844.IIRtDZyg.js";import{m as zt,a as Me,I as Gt}from"../chunks/IonPage.bGG8reFV.js";import{q as Kt,t as Xt}from"../chunks/ion-modal.CsJaVgKZ.js";const Wt=(r,e)=>{if(!customElements.get(r)){class t extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const n={};for(const l of this.attributes)n[l.name]=l.value;new e({target:this.shadowRoot,props:n})}}customElements.define(r,t)}},Jt=function(r){return document.createElement(r).constructor!==HTMLElement},Qt=(r,e)=>{Jt(r)||Wt(r,e)},Fe=async(r,e,t)=>{Kt(),Xt(),Qt(r,e);const o=await zt.create({component:r,componentProps:t});return o.present(),await o.onWillDismiss()},Ve=Ot({items:[],checkedIndices:[]});function rt(r,e,t){const o=r.slice();return o[31]=e[t],o}function Yt(r){let e,t,o,n,l;return{c(){e=f("ion-item"),t=f("ion-input"),o=L(),n=f("ion-item"),l=f("ion-input"),this.h()},l(a){e=_(a,"ION-ITEM",{});var c=g(e);t=_(c,"ION-INPUT",{class:!0,type:!0,label:!0,labelPlacement:!0,placeholder:!0,required:!0}),g(t).forEach(s),c.forEach(s),o=D(a),n=_(a,"ION-ITEM",{});var p=g(n);l=_(p,"ION-INPUT",{class:!0,type:!0,label:!0,labelPlacement:!0,placeholder:!0,required:!0}),g(l).forEach(s),p.forEach(s),this.h()},h(){I(t,"class","ini-km svelte-1kg2bry"),I(t,"type","number"),I(t,"label","Kilometraje inicial"),I(t,"labelPlacement","stacked"),I(t,"placeholder","Ingresa kilometraje actual"),I(t,"required",""),I(l,"class","gas-km"),I(l,"type","number"),I(l,"label","Gasolina inicial (litros)"),I(l,"labelPlacement","stacked"),I(l,"placeholder","Ingresa la gas actual"),I(l,"required","")},m(a,c){H(a,e,c),i(e,t),r[15](t),H(a,o,c),H(a,n,c),i(n,l),r[16](l)},p:_e,d(a){a&&(s(e),s(o),s(n)),r[15](null),r[16](null)}}}function Zt(r){let e,t,o,n,l;return{c(){e=f("ion-item"),t=f("ion-input"),o=L(),n=f("ion-item"),l=f("ion-input"),this.h()},l(a){e=_(a,"ION-ITEM",{});var c=g(e);t=_(c,"ION-INPUT",{class:!0,type:!0,label:!0,labelPlacement:!0,placeholder:!0,required:!0}),g(t).forEach(s),c.forEach(s),o=D(a),n=_(a,"ION-ITEM",{});var p=g(n);l=_(p,"ION-INPUT",{class:!0,type:!0,label:!0,labelPlacement:!0,placeholder:!0,required:!0}),g(l).forEach(s),p.forEach(s),this.h()},h(){I(t,"class","fin-km"),I(t,"type","number"),I(t,"label","Kilometraje final"),I(t,"labelPlacement","stacked"),I(t,"placeholder","Ingresa kilometraje actual"),I(t,"required",""),I(l,"class","fin-km"),I(l,"type","number"),I(l,"label","Gasolina final (litros)"),I(l,"labelPlacement","stacked"),I(l,"placeholder","Ingresa la gas actual"),I(l,"required","")},m(a,c){H(a,e,c),i(e,t),r[13](t),H(a,o,c),H(a,n,c),i(n,l),r[14](l)},p:_e,d(a){a&&(s(e),s(o),s(n)),r[13](null),r[14](null)}}}function $t(r){let e=[],t=new Map,o,n=ke(r[7]);const l=a=>a[31].id_checklist_event;for(let a=0;a<n.length;a+=1){let c=rt(r,n,a),p=l(c);t.set(p,e[a]=at(p,c))}return{c(){for(let a=0;a<e.length;a+=1)e[a].c();o=fe()},l(a){for(let c=0;c<e.length;c+=1)e[c].l(a);o=fe()},m(a,c){for(let p=0;p<e.length;p+=1)e[p]&&e[p].m(a,c);H(a,o,c)},p(a,c){c[0]&6384&&(n=ke(a[7]),e=Be(e,c,l,1,a,n,t,o.parentNode,He,at,o,rt))},d(a){a&&s(o);for(let c=0;c<e.length;c+=1)e[c].d(a)}}}function at(r,e){let t,o,n,l,a,c=e[31].item+"",p,k,E,v,u=(e[6][e[31].id_checklist_event]?e[6][e[31].id_checklist_event]:"Cargar evidencia")+"",b,m,h,d,N,w,q;function R(){return e[19](e[31])}function M(...T){return e[21](e[31],...T)}return N=Tt(e[18][0]),{key:r,first:null,c(){t=f("ion-item"),o=f("ion-label"),n=f("input"),l=L(),a=f("p"),p=x(c),k=L(),E=f("ion-button"),v=f("label"),b=x(u),m=L(),h=f("input"),d=L(),this.h()},l(T){t=_(T,"ION-ITEM",{});var P=g(t);o=_(P,"ION-LABEL",{style:!0});var S=g(o);n=_(S,"INPUT",{id:!0,style:!0,type:!0}),l=D(S),a=_(S,"P",{style:!0});var y=g(a);p=ee(y,c),y.forEach(s),S.forEach(s),k=D(P),E=_(P,"ION-BUTTON",{fill:!0,class:!0});var F=g(E);v=_(F,"LABEL",{for:!0,style:!0});var O=g(v);b=ee(O,u),O.forEach(s),m=D(F),h=_(F,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0}),F.forEach(s),d=D(P),P.forEach(s),this.h()},h(){U(n,"id",`chkbox-${e[31].id_checklist_event}`),z(n,"pointer-events","auto"),U(n,"type","checkbox"),n.__value=e[31].id_checklist_event,yt(n,n.__value),n.required=!0,z(a,"margin-left","10px"),z(o,"display","flex"),U(v,"for","chklist-"+e[31].id_checklist_event),z(v,"padding","8px 10px"),z(h,"display","none"),U(h,"id","chklist-"+e[31].id_checklist_event),U(h,"name","fileToUpload"),U(h,"type","file"),U(h,"accept","image/*"),I(E,"fill","outline"),I(E,"class","loadEvidence svelte-1kg2bry"),N.p(n),this.first=t},m(T,P){H(T,t,P),i(t,o),i(o,n),n.checked=~(e[4]||[]).indexOf(n.__value),i(o,l),i(o,a),i(a,p),i(t,k),i(t,E),i(E,v),i(v,b),i(E,m),i(E,h),e[20](h),i(t,d),w||(q=[se(n,"change",e[17]),se(n,"change",R),se(h,"change",M)],w=!0)},p(T,P){e=T,P[0]&16&&(n.checked=~(e[4]||[]).indexOf(n.__value)),P[0]&64&&u!==(u=(e[6][e[31].id_checklist_event]?e[6][e[31].id_checklist_event]:"Cargar evidencia")+"")&&he(b,u)},d(T){T&&s(t),e[20](null),N.r(),w=!1,Ke(q)}}}function xt(r){let e,t,o,n,l="Cancelar",a,c,p="Requerimientos de ruta",k,E,v,u="Confirmar",b,m,h,d,N,w;function q(P,S){return P[8]?Zt:Yt}let M=q(r)(r),T=r[7]&&$t(r);return{c(){e=f("ion-header"),t=f("ion-toolbar"),o=f("ion-buttons"),n=f("ion-button"),n.textContent=l,a=L(),c=f("ion-title"),c.textContent=p,k=L(),E=f("ion-buttons"),v=f("ion-button"),v.textContent=u,b=L(),m=f("ion-content"),h=f("ion-list"),M.c(),d=L(),T&&T.c(),this.h()},l(P){e=_(P,"ION-HEADER",{translucent:!0});var S=g(e);t=_(S,"ION-TOOLBAR",{});var y=g(t);o=_(y,"ION-BUTTONS",{slot:!0});var F=g(o);n=_(F,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),oe(n)!=="svelte-1dnmkxs"&&(n.textContent=l),F.forEach(s),a=D(y),c=_(y,"ION-TITLE",{"data-svelte-h":!0}),oe(c)!=="svelte-ucox25"&&(c.textContent=p),k=D(y),E=_(y,"ION-BUTTONS",{slot:!0});var O=g(E);v=_(O,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),oe(v)!=="svelte-1ida0il"&&(v.textContent=u),O.forEach(s),y.forEach(s),S.forEach(s),b=D(P),m=_(P,"ION-CONTENT",{fullscreen:!0});var C=g(m);h=_(C,"ION-LIST",{});var B=g(h);M.l(B),d=D(B),T&&T.l(B),B.forEach(s),C.forEach(s),this.h()},h(){I(n,"color","medium"),I(o,"slot","start"),I(v,"strong",""),I(E,"slot","end"),I(e,"translucent",""),I(m,"fullscreen","")},m(P,S){H(P,e,S),i(e,t),i(t,o),i(o,n),i(t,a),i(t,c),i(t,k),i(t,E),i(E,v),H(P,b,S),H(P,m,S),i(m,h),M.m(h,null),i(h,d),T&&T.m(h,null),N||(w=[se(n,"click",r[9]),se(v,"click",r[10])],N=!0)},p(P,S){M.p(P,S),P[7]&&T.p(P,S)},i:_e,o:_e,d(P){P&&(s(e),s(b),s(m)),M.d(),T&&T.d(),N=!1,Ke(w)}}}function It(r){return typeof r=="object"&&r!==null||Array.isArray(r)?Array.isArray(r)?r.map(e=>It(e)).flat():Object.keys(r).filter(n=>n.toLowerCase().includes("id_checklist_event")).map(n=>r[n]):(console.error("Invalid input. Please provide a valid object or array."),[])}function en(r,e){let t=new FormData;t.append("id_route",r),t.append("status",e),fetch("https://rutaflow-app-development.up.railway.app/api/admin/route/change_status.php",{method:"POST",body:t}).then(o=>o.json()).then(o=>{}).catch(o=>{console.error("Error fetching data:",o)})}function tn(r,e,t){let o=document.querySelector("ion-modal");const n=o.componentProps.checklist,l=o.componentProps.driverId,a=o.componentProps.routeId,c=o.componentProps.isLast;let p=null,k=null,E=null,v=null,u=[],b=null,m={},h={};Nt(()=>{c?console.log(a):Ve.update(A=>(A.items=It(n),A))});const d=async()=>{await(await Me.create({header:"Datos o checklist incompletos",message:"Carga la evidencia requerida y marca todas las casillas para confirmar",buttons:[{text:"Cerrar"}]})).present()},N=async()=>{await(await Me.create({header:"Datos capturados",message:"El kilometraje y gasolina final fueron registrados correctamente, espere aprobación para finalizar ruta",buttons:[{text:"Cerrar"}]})).present()},w=async A=>{await(await Me.create({header:"Datos inválidos",message:A=="km"?"Llena correctamente el campo de kilometraje inicial":"Llena correctamente el campo de gasolina inicial",buttons:[{text:"Cerrar"}]})).present()},q=()=>{o.dismiss({data:Date.now()}),l?Oe(`/drivers/${l}`):Oe("/drivers/me")},R=()=>{if(c){var A=S(E.focusedValue,"km"),Y=S(v.focusedValue,"gas");const K=new FormData;if(K.append("km_final",A),K.append("gas_final",Y),K.append("id_route",a),A&&Y){q();const ne=new FormData;for(const Z in m)if(m.hasOwnProperty(Z)){const{img:X,img_id:W}=m[Z];ne.append(`selectedImages[${Z}][img]`,X),ne.append(`selectedImages[${Z}][img_id]`,W)}fetch("https://rutaflow-app-development.up.railway.app/api/admin/checklist/add_evidence.php",{method:"POST",body:ne}).then(Z=>Z.json()).then(Z=>{N()}).catch(Z=>{console.error("Error fetching data:",Z)})}else d()}else{var te=S(p.focusedValue,"km"),G=S(k.focusedValue,"gas");Ve.update(K=>{if(K.items.every(X=>K.checkedIndices.includes(X))&&te&&G){q();const X=new FormData;for(const W in m)if(m.hasOwnProperty(W)){const{img:$,img_id:ae}=m[W];X.append(`selectedImages[${W}][img]`,$),X.append(`selectedImages[${W}][img_id]`,ae)}X.append("km_inicial",te),X.append("gas_inicial",G),X.append("id_route",a),fetch("https://rutaflow-app-development.up.railway.app/api/admin/checklist/add_evidence.php",{method:"POST",body:X}).then(W=>W.json()).then(W=>{en(a,"enroute")}).catch(W=>{console.error("Error fetching data:",W)})}else d();return K})}},M=async(A,Y)=>{const G=A.target.files[0],K=await T(G);if(K){const ne=new FormData;ne.append("fileToUpload",K);try{const Z=await fetch("https://rutaflow-app-development.up.railway.app/api/admin/manager/upload_img_driver.php",{method:"POST",body:ne});if(Z.ok){const X=await Z.json();m={...m,[Y]:{img:X.img,img_id:X.img_id}},t(6,h={...h,[Y]:X.filename}),console.log(m)}else console.error("File upload failed:",Z.statusText)}catch(Z){console.error("Error during file upload:",Z)}}},T=async A=>new Promise(Y=>{const te=new FileReader;te.onload=G=>{const K=new Image;K.src=G.target.result,K.onload=()=>{const ne=document.createElement("canvas"),Z=ne.getContext("2d"),X=800,W=600;let $=K.width,ae=K.height;$>X&&(ae*=X/$,$=X),ae>W&&($*=W/ae,ae=W),ne.width=$,ne.height=ae,Z.drawImage(K,0,0,$,ae),ne.toBlob(Le=>{Y(Le)},"image/jpeg",.7)}},te.readAsDataURL(A)}),P=A=>{Ve.update(Y=>(Y.checkedIndices.indexOf(A)===-1?Y.checkedIndices.push(A):console.error(`ID ${A} is already checked.`),Y.items.forEach(G=>{G.id_checklist_event===A&&(G.checked=!0)}),Y))};function S(A,Y){return/^\d+$/.test(A)?parseInt(A,10):(w(Y),null)}const y=[[]];function F(A){Ie[A?"unshift":"push"](()=>{E=A,t(2,E)})}function O(A){Ie[A?"unshift":"push"](()=>{v=A,t(3,v)})}function C(A){Ie[A?"unshift":"push"](()=>{p=A,t(0,p)})}function B(A){Ie[A?"unshift":"push"](()=>{k=A,t(1,k)})}function V(){u=Ct(y[0],this.__value,this.checked),t(4,u)}const j=A=>P(A.id_checklist_event);function Q(A){Ie[A?"unshift":"push"](()=>{b=A,t(5,b)})}return[p,k,E,v,u,b,h,n,c,q,R,M,P,F,O,C,B,V,y,j,Q,(A,Y)=>M(Y,A.id_checklist_event)]}class Et extends Xe{constructor(e){super(),We(this,e,tn,xt,Ge,{},null,[-1,-1])}}function nn(r){let e,t,o,n,l,a="Domicilio 2",c,p,k=r[2].line2+"",E,v,u;return{c(){e=f("ion-item"),t=f("ion-icon"),o=L(),n=f("ion-label"),l=f("p"),l.textContent=a,c=L(),p=f("h2"),E=x(k),v=L(),u=f("ion-icon"),this.h()},l(b){e=_(b,"ION-ITEM",{href:!0});var m=g(e);t=_(m,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(s),o=D(m),n=_(m,"ION-LABEL",{class:!0});var h=g(n);l=_(h,"P",{"data-svelte-h":!0}),oe(l)!=="svelte-1qy148r"&&(l.textContent=a),c=D(h),p=_(h,"H2",{});var d=g(p);E=ee(d,k),d.forEach(s),h.forEach(s),v=D(m),u=_(m,"ION-ICON",{icon:!0,slot:!0}),g(u).forEach(s),m.forEach(s),this.h()},h(){I(t,"icon",Je),I(t,"slot","start"),I(n,"class","ion-text-wrap"),I(u,"icon",Ce),I(u,"slot","end"),I(e,"href","https://www.google.com/maps/searhc/?api=1&query="+r[2].line2)},m(b,m){H(b,e,m),i(e,t),i(e,o),i(e,n),i(n,l),i(n,c),i(n,p),i(p,E),i(e,v),i(e,u)},p:_e,d(b){b&&s(e)}}}function on(r){let e,t,o,n,l,a="Domicilio 1",c,p,k=r[2].line1+"",E,v,u,b,m=r[2].line2&&r[2].line2.trim().length,h,d=m&&ln(r);return{c(){e=f("ion-item"),t=f("ion-icon"),o=L(),n=f("ion-label"),l=f("p"),l.textContent=a,c=L(),p=f("h2"),E=x(k),v=L(),u=f("ion-icon"),b=L(),d&&d.c(),h=fe(),this.h()},l(N){e=_(N,"ION-ITEM",{href:!0});var w=g(e);t=_(w,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(s),o=D(w),n=_(w,"ION-LABEL",{class:!0});var q=g(n);l=_(q,"P",{"data-svelte-h":!0}),oe(l)!=="svelte-1ehcrdm"&&(l.textContent=a),c=D(q),p=_(q,"H2",{});var R=g(p);E=ee(R,k),R.forEach(s),q.forEach(s),v=D(w),u=_(w,"ION-ICON",{icon:!0,slot:!0}),g(u).forEach(s),w.forEach(s),b=D(N),d&&d.l(N),h=fe(),this.h()},h(){I(t,"icon",Je),I(t,"slot","start"),I(n,"class","ion-text-wrap"),I(u,"icon",Ce),I(u,"slot","end"),I(e,"href","https://www.google.com/maps/search/?api=1&query="+r[2].line1)},m(N,w){H(N,e,w),i(e,t),i(e,o),i(e,n),i(n,l),i(n,c),i(n,p),i(p,E),i(e,v),i(e,u),H(N,b,w),d&&d.m(N,w),H(N,h,w)},p(N,w){m&&d.p(N,w)},d(N){N&&(s(e),s(b),s(h)),d&&d.d(N)}}}function ln(r){let e,t,o,n,l,a="Domicilio 2",c,p,k=r[2].line2+"",E,v,u;return{c(){e=f("ion-item"),t=f("ion-icon"),o=L(),n=f("ion-label"),l=f("p"),l.textContent=a,c=L(),p=f("h2"),E=x(k),v=L(),u=f("ion-icon"),this.h()},l(b){e=_(b,"ION-ITEM",{href:!0});var m=g(e);t=_(m,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(s),o=D(m),n=_(m,"ION-LABEL",{class:!0});var h=g(n);l=_(h,"P",{"data-svelte-h":!0}),oe(l)!=="svelte-1qy148r"&&(l.textContent=a),c=D(h),p=_(h,"H2",{});var d=g(p);E=ee(d,k),d.forEach(s),h.forEach(s),v=D(m),u=_(m,"ION-ICON",{icon:!0,slot:!0}),g(u).forEach(s),m.forEach(s),this.h()},h(){I(t,"icon",Je),I(t,"slot","start"),I(n,"class","ion-text-wrap"),I(u,"icon",Ce),I(u,"slot","end"),I(e,"href","https://www.google.com/maps/search/?api=1&query="+r[2].line2)},m(b,m){H(b,e,m),i(e,t),i(e,o),i(e,n),i(n,l),i(n,c),i(n,p),i(p,E),i(e,v),i(e,u)},p:_e,d(b){b&&s(e)}}}function rn(r){let e,t=r[2].comments!="<br>"&&an(r);return{c(){t&&t.c(),e=fe()},l(o){t&&t.l(o),e=fe()},m(o,n){t&&t.m(o,n),H(o,e,n)},p(o,n){o[2].comments!="<br>"&&t.p(o,n)},d(o){o&&s(e),t&&t.d(o)}}}function an(r){let e,t,o,n,l,a="Notas de ubicación",c,p,k=r[2].comments+"",E;return{c(){e=f("ion-item"),t=f("ion-icon"),o=L(),n=f("ion-label"),l=f("p"),l.textContent=a,c=L(),p=f("h2"),E=x(k),this.h()},l(v){e=_(v,"ION-ITEM",{});var u=g(e);t=_(u,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(s),o=D(u),n=_(u,"ION-LABEL",{class:!0});var b=g(n);l=_(b,"P",{"data-svelte-h":!0}),oe(l)!=="svelte-nhm2ft"&&(l.textContent=a),c=D(b),p=_(b,"H2",{});var m=g(p);E=ee(m,k),m.forEach(s),b.forEach(s),u.forEach(s),this.h()},h(){I(t,"icon",gt),I(t,"slot","start"),I(n,"class","ion-text-wrap")},m(v,u){H(v,e,u),i(e,t),i(e,o),i(e,n),i(n,l),i(n,c),i(n,p),i(p,E)},p:_e,d(v){v&&s(e)}}}function sn(r){let e,t,o,n,l,a="Horarios",c,p,k=r[2].schedule+"",E;return{c(){e=f("ion-item"),t=f("ion-icon"),o=L(),n=f("ion-label"),l=f("p"),l.textContent=a,c=L(),p=f("h2"),E=x(k),this.h()},l(v){e=_(v,"ION-ITEM",{});var u=g(e);t=_(u,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(s),o=D(u),n=_(u,"ION-LABEL",{});var b=g(n);l=_(b,"P",{"data-svelte-h":!0}),oe(l)!=="svelte-11q7hm5"&&(l.textContent=a),c=D(b),p=_(b,"H2",{});var m=g(p);E=ee(m,k),m.forEach(s),b.forEach(s),u.forEach(s),this.h()},h(){I(t,"icon",Ut),I(t,"slot","start")},m(v,u){H(v,e,u),i(e,t),i(e,o),i(e,n),i(n,l),i(n,c),i(n,p),i(p,E)},p:_e,d(v){v&&s(e)}}}function cn(r){let e,t,o,n,l,a="Notas del operador",c,p,k=r[2].driver_comments+"",E;return{c(){e=f("ion-item"),t=f("ion-icon"),o=L(),n=f("ion-label"),l=f("p"),l.textContent=a,c=L(),p=f("h2"),E=x(k),this.h()},l(v){e=_(v,"ION-ITEM",{});var u=g(e);t=_(u,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(s),o=D(u),n=_(u,"ION-LABEL",{});var b=g(n);l=_(b,"P",{"data-svelte-h":!0}),oe(l)!=="svelte-1yk9qp4"&&(l.textContent=a),c=D(b),p=_(b,"H2",{});var m=g(p);E=ee(m,k),m.forEach(s),b.forEach(s),u.forEach(s),this.h()},h(){I(t,"icon",Vt),I(t,"slot","start")},m(v,u){H(v,e,u),i(e,t),i(e,o),i(e,n),i(n,l),i(n,c),i(n,p),i(p,E)},p:_e,d(v){v&&s(e)}}}function un(r){let e,t=r[2].logistic_comments!="<br>"&&fn(r);return{c(){t&&t.c(),e=fe()},l(o){t&&t.l(o),e=fe()},m(o,n){t&&t.m(o,n),H(o,e,n)},p(o,n){o[2].logistic_comments!="<br>"&&t.p(o,n)},d(o){o&&s(e),t&&t.d(o)}}}function fn(r){let e,t,o,n,l,a="Comentarios logísticos",c,p,k=r[2].logistic_comments+"",E;return{c(){e=f("ion-item"),t=f("ion-icon"),o=L(),n=f("ion-label"),l=f("p"),l.textContent=a,c=L(),p=f("h2"),E=x(k),this.h()},l(v){e=_(v,"ION-ITEM",{});var u=g(e);t=_(u,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(s),o=D(u),n=_(u,"ION-LABEL",{class:!0});var b=g(n);l=_(b,"P",{"data-svelte-h":!0}),oe(l)!=="svelte-1iz85r6"&&(l.textContent=a),c=D(b),p=_(b,"H2",{});var m=g(p);E=ee(m,k),m.forEach(s),b.forEach(s),u.forEach(s),this.h()},h(){I(t,"icon",gt),I(t,"slot","start"),I(n,"class","ion-text-wrap")},m(v,u){H(v,e,u),i(e,t),i(e,o),i(e,n),i(n,l),i(n,c),i(n,p),i(p,E)},p:_e,d(v){v&&s(e)}}}function st(r){let e,t,o;return{c(){e=f("section"),t=f("ion-img"),this.h()},l(n){e=_(n,"SECTION",{});var l=g(e);t=_(l,"ION-IMG",{src:!0,alt:!0,style:!0}),g(t).forEach(s),l.forEach(s),this.h()},h(){it(t.src,o=r[1])||I(t,"src",o),I(t,"alt","Evidencia fotográfica"),z(t,"max-width","100%"),z(t,"margin-top","16px")},m(n,l){H(n,e,l),i(e,t)},p(n,l){l&2&&!it(t.src,o=n[1])&&I(t,"src",o)},d(n){n&&s(e)}}}function _n(r){let e,t,o,n,l="Cancelar",a,c,p=r[2].title+"",k,E,v,u,b="Confirmar",m,h,d,N,w,q,R,M,T="Cliente",P,S,y=r[2].client_name+"",F,O,C,B=r[2].comments&&r[2].comments.trim().length,V,j=r[2].schedule&&r[2].schedule.trim().length,Q,re,A=r[2].logistic_comments&&r[2].logistic_comments.trim().length,Y,te,G,K,ne,Z,X,W,$,ae,Le,Ee,Qe="Subir Evidencia",qe,pe,Re,Ue,Ye;function kt(J,ce){if(J[2].line1&&J[2].line1.trim().length)return on;if(J[2].line2&&J[2].line2.trim().length)return nn}let Ze=kt(r),de=Ze&&Ze(r),me=B&&rn(r),ve=j&&sn(r),be=r[2].driver_comments&&cn(r),ge=A&&un(r),ie=r[1]&&st(r);return{c(){e=f("ion-header"),t=f("ion-toolbar"),o=f("ion-buttons"),n=f("ion-button"),n.textContent=l,a=L(),c=f("ion-title"),k=x(p),E=L(),v=f("ion-buttons"),u=f("ion-button"),u.textContent=b,m=L(),h=f("ion-content"),d=f("ion-list"),N=f("ion-item"),w=f("ion-icon"),q=L(),R=f("ion-label"),M=f("p"),M.textContent=T,P=L(),S=f("h2"),F=x(y),O=L(),de&&de.c(),C=L(),me&&me.c(),V=L(),ve&&ve.c(),Q=L(),be&&be.c(),re=L(),ge&&ge.c(),Y=L(),te=f("ion-item"),G=f("ion-icon"),K=L(),ne=f("ion-textarea"),Z=L(),X=f("section"),W=f("label"),$=f("ion-button"),ae=f("ion-icon"),Le=L(),Ee=f("label"),Ee.textContent=Qe,qe=L(),pe=f("input"),Re=L(),ie&&ie.c(),this.h()},l(J){e=_(J,"ION-HEADER",{translucent:!0});var ce=g(e);t=_(ce,"ION-TOOLBAR",{});var Ne=g(t);o=_(Ne,"ION-BUTTONS",{slot:!0});var $e=g(o);n=_($e,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),oe(n)!=="svelte-1f8rjcf"&&(n.textContent=l),$e.forEach(s),a=D(Ne),c=_(Ne,"ION-TITLE",{title:!0});var xe=g(c);k=ee(xe,p),xe.forEach(s),E=D(Ne),v=_(Ne,"ION-BUTTONS",{slot:!0});var et=g(v);u=_(et,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),oe(u)!=="svelte-1ida0il"&&(u.textContent=b),et.forEach(s),Ne.forEach(s),ce.forEach(s),m=D(J),h=_(J,"ION-CONTENT",{fullscreen:!0});var tt=g(h);d=_(tt,"ION-LIST",{});var le=g(d);N=_(le,"ION-ITEM",{});var De=g(N);w=_(De,"ION-ICON",{icon:!0,slot:!0}),g(w).forEach(s),q=D(De),R=_(De,"ION-LABEL",{});var Pe=g(R);M=_(Pe,"P",{"data-svelte-h":!0}),oe(M)!=="svelte-jrq7ei"&&(M.textContent=T),P=D(Pe),S=_(Pe,"H2",{});var nt=g(S);F=ee(nt,y),nt.forEach(s),Pe.forEach(s),De.forEach(s),O=D(le),de&&de.l(le),C=D(le),me&&me.l(le),V=D(le),ve&&ve.l(le),Q=D(le),be&&be.l(le),re=D(le),ge&&ge.l(le),Y=D(le),te=_(le,"ION-ITEM",{});var Ae=g(te);G=_(Ae,"ION-ICON",{icon:!0,slot:!0}),g(G).forEach(s),K=D(Ae),ne=_(Ae,"ION-TEXTAREA",{label:!0,placeholder:!0}),g(ne).forEach(s),Ae.forEach(s),Z=D(le),X=_(le,"SECTION",{});var ot=g(X);W=_(ot,"LABEL",{for:!0,style:!0});var lt=g(W);$=_(lt,"ION-BUTTON",{fill:!0,class:!0,expand:!0});var we=g($);ae=_(we,"ION-ICON",{icon:!0,slot:!0}),g(ae).forEach(s),Le=D(we),Ee=_(we,"LABEL",{for:!0,style:!0,"data-svelte-h":!0}),oe(Ee)!=="svelte-1as0od8"&&(Ee.textContent=Qe),qe=D(we),pe=_(we,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0}),we.forEach(s),lt.forEach(s),ot.forEach(s),Re=D(le),ie&&ie.l(le),le.forEach(s),tt.forEach(s),this.h()},h(){I(n,"color","medium"),I(o,"slot","start"),I(c,"title",r[2].title),I(u,"strong",""),I(v,"slot","end"),I(e,"translucent",""),I(w,"icon",Ht),I(w,"slot","start"),I(G,"icon",qt),I(G,"slot","start"),I(ne,"label","Notas"),I(ne,"placeholder","Escribe aquí..."),I(ae,"icon",Rt),I(ae,"slot","start"),U(Ee,"for","eventEvidence"),z(Ee,"padding","8px 10px"),z(pe,"display","none"),U(pe,"id","eventEvidence"),U(pe,"name","fileToUpload"),U(pe,"type","file"),U(pe,"accept","image/*"),I($,"fill","outline"),I($,"class","loadEvidence"),I($,"expand","block"),U(W,"for","eventEvidence"),z(W,"display","block"),z(W,"width","100%"),I(h,"fullscreen","")},m(J,ce){H(J,e,ce),i(e,t),i(t,o),i(o,n),i(t,a),i(t,c),i(c,k),i(t,E),i(t,v),i(v,u),H(J,m,ce),H(J,h,ce),i(h,d),i(d,N),i(N,w),i(N,q),i(N,R),i(R,M),i(R,P),i(R,S),i(S,F),i(d,O),de&&de.m(d,null),i(d,C),me&&me.m(d,null),i(d,V),ve&&ve.m(d,null),i(d,Q),be&&be.m(d,null),i(d,re),ge&&ge.m(d,null),i(d,Y),i(d,te),i(te,G),i(te,K),i(te,ne),r[6](ne),i(d,Z),i(d,X),i(X,W),i(W,$),i($,ae),i($,Le),i($,Ee),i($,qe),i($,pe),i(d,Re),ie&&ie.m(d,null),Ue||(Ye=[se(n,"click",r[4]),se(u,"click",r[5]),se(pe,"change",r[3])],Ue=!0)},p(J,[ce]){de&&de.p(J,ce),B&&me.p(J,ce),j&&ve.p(J,ce),J[2].driver_comments&&be.p(J,ce),A&&ge.p(J,ce),J[1]?ie?ie.p(J,ce):(ie=st(J),ie.c(),ie.m(d,null)):ie&&(ie.d(1),ie=null)},i:_e,o:_e,d(J){J&&(s(e),s(m),s(h)),de&&de.d(),me&&me.d(),ve&&ve.d(),be&&be.d(),ge&&ge.d(),r[6](null),ie&&ie.d(),Ue=!1,Ke(Ye)}}}function hn(r,e,t){let o=document.querySelector("ion-modal"),n=o.componentProps.delivery,l=o.componentProps.isLast,a=n.driver_comments?n.driver_comments:"",c=n.img?n.img:"",p="";const k=async m=>{const d=m.target.files[0];if(d){const N=new FormData;N.append("fileToUpload",d);try{const w=await fetch("https://rutaflow-app-development.up.railway.app/api/admin/manager/upload_img_driver.php",{method:"POST",body:N});if(w.ok){const q=await w.json();t(1,c=q.img),p=q.img_id,console.log(q)}else console.error("File upload failed:",w.statusText)}catch(w){console.error("Error during file upload:",w)}}},E=()=>{o.dismiss({data:Date.now()})},v=()=>{var m=new Object;m.id_route=n.id_route,m.id_event=n.id_event,m.comments=a.value,m.img=c,m.img_id=p;const h=new FormData;for(const d in m)h.append(d,m[d]);fetch("https://rutaflow-app-development.up.railway.app/api/admin/evidence/send_evidence.php",{method:"POST",body:h}).then(d=>d.json()).then(d=>{E();var N=m.id_route;l&&u("","",N,l)}).catch(d=>{console.error("Error fetching data:",d)})},u=(m,h,d,N)=>{o.componentProps.routeId=d,o.componentProps.driverId=n.id_driver,Fe("modal-km-gas",Et,{checklist:m,driverId:h,routeId:d,isLast:N}).then(w=>{})};function b(m){Ie[m?"unshift":"push"](()=>{a=m,t(0,a)})}return[a,c,n,k,E,v,b]}class dn extends Xe{constructor(e){super(),We(this,e,hn,_n,Ge,{})}}function ct(r,e,t){const o=r.slice();return o[26]=e[t],o}function ut(r,e,t){const o=r.slice();return o[26]=e[t],o[28]=t,o}function ft(r,e,t){const o=r.slice();return o[26]=e[t],o[28]=t,o}function _t(r){let e,t;return e=new Gt({props:{$$slots:{default:[gn]},$$scope:{ctx:r}}}),{c(){Pt(e.$$.fragment)},l(o){At(e.$$.fragment,o)},m(o,n){St(e,o,n),t=!0},p(o,n){const l={};n[0]&127|n[1]&2&&(l.$$scope={dirty:n,ctx:o}),e.$set(l)},i(o){t||(Se(e.$$.fragment,o),t=!0)},o(o){je(e.$$.fragment,o),t=!1},d(o){Mt(e,o)}}}function pn(r){let e=ze(r[0],"enroute")+"",t,o,n,l,a='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Jala para actualizar" refreshing-spinner="circles" refreshing-text="Actualizando..."></ion-refresher-content>',c,p,k=[],E=new Map,v,u,b=ke(r[3]);const m=h=>h[26].id_event;for(let h=0;h<b.length;h+=1){let d=ct(r,b,h),N=m(d);E.set(N,k[h]=dt(N,d))}return{c(){t=x(e),o=L(),n=f("ion-content"),l=f("ion-refresher"),l.innerHTML=a,c=L(),p=f("ion-list");for(let h=0;h<k.length;h+=1)k[h].c();this.h()},l(h){t=ee(h,e),o=D(h),n=_(h,"ION-CONTENT",{});var d=g(n);l=_(d,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),oe(l)!=="svelte-1jkndk3"&&(l.innerHTML=a),c=D(d),p=_(d,"ION-LIST",{});var N=g(p);for(let w=0;w<k.length;w+=1)k[w].l(N);N.forEach(s),d.forEach(s),this.h()},h(){I(l,"slot","fixed")},m(h,d){H(h,t,d),H(h,o,d),H(h,n,d),i(n,l),r[19](l),i(n,c),i(n,p);for(let N=0;N<k.length;N+=1)k[N]&&k[N].m(p,null);v||(u=se(l,"ionRefresh",r[7]),v=!0)},p(h,d){d[0]&1&&e!==(e=ze(h[0],"enroute")+"")&&he(t,e),d[0]&5384&&(b=ke(h[3]),k=Be(k,d,m,1,h,b,E,p,He,dt,null,ct))},d(h){h&&(s(t),s(o),s(n)),r[19](null);for(let d=0;d<k.length;d+=1)k[d].d();v=!1,u()}}}function mn(r){let e,t;function o(a,c){return c[0]&32&&(e=null),e==null&&(e=!!a[5].every(En)),e?bn:vn}let n=o(r,[-1,-1]),l=n(r);return{c(){l.c(),t=fe()},l(a){l.l(a),t=fe()},m(a,c){l.m(a,c),H(a,t,c)},p(a,c){n===(n=o(a,c))&&l?l.p(a,c):(l.d(1),l=n(a),l&&(l.c(),l.m(t.parentNode,t)))},d(a){a&&s(t),l.d(a)}}}function ht(r){let e;return{c(){e=f("span"),this.h()},l(t){e=_(t,"SPAN",{class:!0}),g(e).forEach(s),this.h()},h(){U(e,"class","notes svelte-ziybgw")},m(t,o){H(t,e,o)},d(t){t&&s(e)}}}function dt(r,e){let t,o,n,l,a=parseInt(e[26].pos)+1+"",c,p,k,E,v,u,b=e[26].title+"",m,h,d=e[26].support_list&&e[26].support_list.length||e[10](e[26]),N,w,q,R,M,T=d&&ht();function P(){return e[20](e[26])}return{key:r,first:null,c(){t=f("ion-item"),o=f("ion-avatar"),n=f("div"),l=f("div"),c=x(a),k=L(),E=f("ion-label"),v=f("ion-text"),u=f("h3"),m=x(b),h=L(),T&&T.c(),N=L(),w=f("ion-icon"),q=L(),this.h()},l(S){t=_(S,"ION-ITEM",{});var y=g(t);o=_(y,"ION-AVATAR",{slot:!0});var F=g(o);n=_(F,"DIV",{class:!0,title:!0,style:!0});var O=g(n);l=_(O,"DIV",{class:!0});var C=g(l);c=ee(C,a),C.forEach(s),O.forEach(s),F.forEach(s),k=D(y),E=_(y,"ION-LABEL",{button:!0});var B=g(E);v=_(B,"ION-TEXT",{color:!0});var V=g(v);u=_(V,"H3",{});var j=g(u);m=ee(j,b),h=D(j),T&&T.l(j),j.forEach(s),V.forEach(s),B.forEach(s),N=D(y),w=_(y,"ION-ICON",{icon:!0,slot:!0,style:!0}),g(w).forEach(s),q=D(y),y.forEach(s),this.h()},h(){U(l,"class","order svelte-ziybgw"),U(n,"class","order-wrapper svelte-ziybgw"),U(n,"title",p=Te(e[26].status)),z(n,"background-color",ue(e[26])),z(n,"color",ye(ue(e[26]))),I(o,"slot","start"),I(v,"color","#2e2e2e"),I(E,"button",""),I(w,"icon",Ce),I(w,"slot","end"),z(w,"color",ue(e[26])),this.first=t},m(S,y){H(S,t,y),i(t,o),i(o,n),i(n,l),i(l,c),i(t,k),i(t,E),i(E,v),i(v,u),i(u,m),i(u,h),T&&T.m(u,null),i(t,N),i(t,w),i(t,q),R||(M=se(E,"click",P),R=!0)},p(S,y){e=S,y[0]&8&&a!==(a=parseInt(e[26].pos)+1+"")&&he(c,a),y[0]&8&&p!==(p=Te(e[26].status))&&U(n,"title",p),y[0]&8&&z(n,"background-color",ue(e[26])),y[0]&8&&z(n,"color",ye(ue(e[26]))),y[0]&8&&b!==(b=e[26].title+"")&&he(m,b),y[0]&8&&(d=e[26].support_list&&e[26].support_list.length||e[10](e[26])),d?T||(T=ht(),T.c(),T.m(u,null)):T&&(T.d(1),T=null),y[0]&8&&z(w,"color",ue(e[26]))},d(S){S&&s(t),T&&T.d(),R=!1,M()}}}function vn(r){let e=r[9](r[5],r[1],r[0])+"",t,o,n,l,a='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Pull to refresh" refreshing-spinner="circles" refreshing-text="Refreshing..."></ion-refresher-content>',c,p,k=[],E=new Map,v,u,b=ke(r[3]);const m=h=>h[26].id_event;for(let h=0;h<b.length;h+=1){let d=ut(r,b,h),N=m(d);E.set(N,k[h]=mt(N,d))}return{c(){t=x(e),o=L(),n=f("ion-content"),l=f("ion-refresher"),l.innerHTML=a,c=L(),p=f("ion-list");for(let h=0;h<k.length;h+=1)k[h].c();this.h()},l(h){t=ee(h,e),o=D(h),n=_(h,"ION-CONTENT",{});var d=g(n);l=_(d,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),oe(l)!=="svelte-1poui8g"&&(l.innerHTML=a),c=D(d),p=_(d,"ION-LIST",{});var N=g(p);for(let w=0;w<k.length;w+=1)k[w].l(N);N.forEach(s),d.forEach(s),this.h()},h(){I(l,"slot","fixed")},m(h,d){H(h,t,d),H(h,o,d),H(h,n,d),i(n,l),r[17](l),i(n,c),i(n,p);for(let N=0;N<k.length;N+=1)k[N]&&k[N].m(p,null);v||(u=se(l,"ionRefresh",r[7]),v=!0)},p(h,d){d[0]&35&&e!==(e=h[9](h[5],h[1],h[0])+"")&&he(t,e),d[0]&9480&&(b=ke(h[3]),k=Be(k,d,m,1,h,b,E,p,He,mt,null,ut))},d(h){h&&(s(t),s(o),s(n)),r[17](null);for(let d=0;d<k.length;d+=1)k[d].d();v=!1,u()}}}function bn(r){let e,t,o='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Pull to refresh" refreshing-spinner="circles" refreshing-text="Refreshing..."></ion-refresher-content>',n,l,a=[],c=new Map,p,k,E=ke(r[3]);const v=u=>u[26].id_event;for(let u=0;u<E.length;u+=1){let b=ft(r,E,u),m=v(b);c.set(m,a[u]=bt(m,b))}return{c(){e=f("ion-content"),t=f("ion-refresher"),t.innerHTML=o,n=L(),l=f("ion-list");for(let u=0;u<a.length;u+=1)a[u].c();this.h()},l(u){e=_(u,"ION-CONTENT",{});var b=g(e);t=_(b,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),oe(t)!=="svelte-1poui8g"&&(t.innerHTML=o),n=D(b),l=_(b,"ION-LIST",{});var m=g(l);for(let h=0;h<a.length;h+=1)a[h].l(m);m.forEach(s),b.forEach(s),this.h()},h(){I(t,"slot","fixed")},m(u,b){H(u,e,b),i(e,t),r[15](t),i(e,n),i(e,l);for(let m=0;m<a.length;m+=1)a[m]&&a[m].m(l,null);p||(k=se(t,"ionRefresh",r[7]),p=!0)},p(u,b){b[0]&9480&&(E=ke(u[3]),a=Be(a,b,v,1,u,E,c,l,He,bt,null,ft))},d(u){u&&s(e),r[15](null);for(let b=0;b<a.length;b+=1)a[b].d();p=!1,k()}}}function pt(r){let e;return{c(){e=f("span"),this.h()},l(t){e=_(t,"SPAN",{class:!0}),g(e).forEach(s),this.h()},h(){U(e,"class","notes svelte-ziybgw")},m(t,o){H(t,e,o)},d(t){t&&s(e)}}}function mt(r,e){let t,o,n,l,a=parseInt(e[26].pos)+1+"",c,p,k,E,v,u,b=e[26].title+"",m,h,d=e[26].support_list&&e[26].support_list.length||e[10](e[26]),N,w,q="",R,M,T,P,S,y=d&&pt();function F(){return e[18](e[26],e[28])}return{key:r,first:null,c(){t=f("ion-item"),o=f("ion-avatar"),n=f("div"),l=f("div"),c=x(a),k=L(),E=f("ion-label"),v=f("ion-text"),u=f("h3"),m=x(b),h=L(),y&&y.c(),N=L(),w=f("div"),w.innerHTML=q,R=L(),M=f("ion-icon"),T=L(),this.h()},l(O){t=_(O,"ION-ITEM",{});var C=g(t);o=_(C,"ION-AVATAR",{slot:!0});var B=g(o);n=_(B,"DIV",{class:!0,title:!0,style:!0});var V=g(n);l=_(V,"DIV",{class:!0});var j=g(l);c=ee(j,a),j.forEach(s),V.forEach(s),B.forEach(s),k=D(C),E=_(C,"ION-LABEL",{button:!0});var Q=g(E);v=_(Q,"ION-TEXT",{color:!0});var re=g(v);u=_(re,"H3",{});var A=g(u);m=ee(A,b),h=D(A),y&&y.l(A),A.forEach(s),re.forEach(s),N=D(Q),w=_(Q,"DIV",{class:!0,"data-svelte-h":!0}),oe(w)!=="svelte-130ohbs"&&(w.innerHTML=q),Q.forEach(s),R=D(C),M=_(C,"ION-ICON",{icon:!0,slot:!0}),g(M).forEach(s),T=D(C),C.forEach(s),this.h()},h(){U(l,"class","order svelte-ziybgw"),U(n,"class","order-wrapper svelte-ziybgw"),U(n,"title",p=Te(e[26].status)),z(n,"background-color",ue(e[26])),z(n,"color",ye(ue(e[26]))),I(o,"slot","start"),I(v,"color","#2e2e2e"),U(w,"class","sub svelte-ziybgw"),I(E,"button",""),I(M,"icon",Ce),I(M,"slot","end"),this.first=t},m(O,C){H(O,t,C),i(t,o),i(o,n),i(n,l),i(l,c),i(t,k),i(t,E),i(E,v),i(v,u),i(u,m),i(u,h),y&&y.m(u,null),i(E,N),i(E,w),i(t,R),i(t,M),i(t,T),P||(S=se(E,"click",F),P=!0)},p(O,C){e=O,C[0]&8&&a!==(a=parseInt(e[26].pos)+1+"")&&he(c,a),C[0]&8&&p!==(p=Te(e[26].status))&&U(n,"title",p),C[0]&8&&z(n,"background-color",ue(e[26])),C[0]&8&&z(n,"color",ye(ue(e[26]))),C[0]&8&&b!==(b=e[26].title+"")&&he(m,b),C[0]&8&&(d=e[26].support_list&&e[26].support_list.length||e[10](e[26])),d?y||(y=pt(),y.c(),y.m(u,null)):y&&(y.d(1),y=null)},d(O){O&&s(t),y&&y.d(),P=!1,S()}}}function vt(r){let e;return{c(){e=f("span"),this.h()},l(t){e=_(t,"SPAN",{class:!0}),g(e).forEach(s),this.h()},h(){U(e,"class","notes svelte-ziybgw")},m(t,o){H(t,e,o)},d(t){t&&s(e)}}}function bt(r,e){let t,o,n,l,a=parseInt(e[26].pos)+1+"",c,p,k,E,v,u,b=e[26].title+"",m,h,d=e[26].support_list&&e[26].support_list.length||e[10](e[26]),N,w,q="",R,M,T,P,S,y=d&&vt();function F(){return e[16](e[26],e[28])}return{key:r,first:null,c(){t=f("ion-item"),o=f("ion-avatar"),n=f("div"),l=f("div"),c=x(a),k=L(),E=f("ion-label"),v=f("ion-text"),u=f("h3"),m=x(b),h=L(),y&&y.c(),N=L(),w=f("div"),w.innerHTML=q,R=L(),M=f("ion-icon"),T=L(),this.h()},l(O){t=_(O,"ION-ITEM",{});var C=g(t);o=_(C,"ION-AVATAR",{slot:!0});var B=g(o);n=_(B,"DIV",{class:!0,title:!0,style:!0});var V=g(n);l=_(V,"DIV",{class:!0});var j=g(l);c=ee(j,a),j.forEach(s),V.forEach(s),B.forEach(s),k=D(C),E=_(C,"ION-LABEL",{button:!0});var Q=g(E);v=_(Q,"ION-TEXT",{color:!0});var re=g(v);u=_(re,"H3",{});var A=g(u);m=ee(A,b),h=D(A),y&&y.l(A),A.forEach(s),re.forEach(s),N=D(Q),w=_(Q,"DIV",{class:!0,"data-svelte-h":!0}),oe(w)!=="svelte-130ohbs"&&(w.innerHTML=q),Q.forEach(s),R=D(C),M=_(C,"ION-ICON",{icon:!0,slot:!0}),g(M).forEach(s),T=D(C),C.forEach(s),this.h()},h(){U(l,"class","order svelte-ziybgw"),U(n,"class","order-wrapper svelte-ziybgw"),U(n,"title",p=Te(e[26].status)),z(n,"background-color",ue(e[26])),z(n,"color",ye(ue(e[26]))),I(o,"slot","start"),I(v,"color","#2e2e2e"),U(w,"class","sub svelte-ziybgw"),I(E,"button",""),I(M,"icon",Ce),I(M,"slot","end"),this.first=t},m(O,C){H(O,t,C),i(t,o),i(o,n),i(n,l),i(l,c),i(t,k),i(t,E),i(E,v),i(v,u),i(u,m),i(u,h),y&&y.m(u,null),i(E,N),i(E,w),i(t,R),i(t,M),i(t,T),P||(S=se(E,"click",F),P=!0)},p(O,C){e=O,C[0]&8&&a!==(a=parseInt(e[26].pos)+1+"")&&he(c,a),C[0]&8&&p!==(p=Te(e[26].status))&&U(n,"title",p),C[0]&8&&z(n,"background-color",ue(e[26])),C[0]&8&&z(n,"color",ye(ue(e[26]))),C[0]&8&&b!==(b=e[26].title+"")&&he(m,b),C[0]&8&&(d=e[26].support_list&&e[26].support_list.length||e[10](e[26])),d?y||(y=vt(),y.c(),y.m(u,null)):y&&(y.d(1),y=null)},d(O){O&&s(t),y&&y.d(),P=!1,S()}}}function gn(r){let e,t,o,n,l=`<ion-icon icon="${jt}"></ion-icon>`,a,c,p,k=r[2].name+"",E,v,u,b=r[4].name+"",m,h,d,N,w;function q(T,P){return T[5].length>0?mn:pn}let R=q(r),M=R(r);return{c(){e=f("ion-header"),t=f("ion-toolbar"),o=f("ion-buttons"),n=f("ion-button"),n.innerHTML=l,a=L(),c=f("ion-buttons"),p=f("ion-button"),E=x(k),v=L(),u=f("ion-title"),m=x(b),h=L(),M.c(),d=fe(),this.h()},l(T){e=_(T,"ION-HEADER",{translucent:!0});var P=g(e);t=_(P,"ION-TOOLBAR",{});var S=g(t);o=_(S,"ION-BUTTONS",{slot:!0});var y=g(o);n=_(y,"ION-BUTTON",{title:!0,alt:!0,"data-svelte-h":!0}),oe(n)!=="svelte-7ppz3r"&&(n.innerHTML=l),y.forEach(s),a=D(S),c=_(S,"ION-BUTTONS",{slot:!0});var F=g(c);p=_(F,"ION-BUTTON",{});var O=g(p);E=ee(O,k),O.forEach(s),F.forEach(s),v=D(S),u=_(S,"ION-TITLE",{});var C=g(u);m=ee(C,b),C.forEach(s),S.forEach(s),P.forEach(s),h=D(T),M.l(T),d=fe(),this.h()},h(){I(n,"title","Atrás"),I(n,"alt","Atrás"),I(o,"slot","start"),I(c,"slot","secondary"),I(e,"translucent","")},m(T,P){H(T,e,P),i(e,t),i(t,o),i(o,n),i(t,a),i(t,c),i(c,p),i(p,E),i(t,v),i(t,u),i(u,m),H(T,h,P),M.m(T,P),H(T,d,P),N||(w=se(n,"click",r[11]),N=!0)},p(T,P){P[0]&4&&k!==(k=T[2].name+"")&&he(E,k),P[0]&16&&b!==(b=T[4].name+"")&&he(m,b),R===(R=q(T))&&M?M.p(T,P):(M.d(1),M=R(T),M&&(M.c(),M.m(d.parentNode,d)))},d(T){T&&(s(e),s(h),s(d)),M.d(T),N=!1,w()}}}function In(r){let e,t,o,n=r[2]&&_t(r);return{c(){e=L(),n&&n.c(),t=fe(),this.h()},l(l){Lt("svelte-kn0kph",document.head).forEach(s),e=D(l),n&&n.l(l),t=fe(),this.h()},h(){document.title="Rutaflow - Detalles de ruta"},m(l,a){H(l,e,a),n&&n.m(l,a),H(l,t,a),o=!0},p(l,a){l[2]?n?(n.p(l,a),a[0]&4&&Se(n,1)):(n=_t(l),n.c(),Se(n,1),n.m(t.parentNode,t)):n&&(Bt(),je(n,1,1,()=>{n=null}),Dt())},i(l){o||(Se(n),o=!0)},o(l){je(n),o=!1},d(l){l&&(s(e),s(t)),n&&n.d(l)}}}function ue(r){let e="#ffffff";return r.status==="pending"?e="#f2e300":r.status==="completed"&&(e="#44d900"),e}function Te(r){let e="";return r=="pending"?e="Pendiente":r=="completed"&&(e="Completado"),e}function ye(r){r.slice(0,1)==="#"&&(r=r.slice(1)),r.length===3&&(r=r.split("").map(function(l){return l+l}).join(""));const e=parseInt(r.substr(0,2),16),t=parseInt(r.substr(2,2),16),o=parseInt(r.substr(4,2),16);return(e*299+t*587+o*114)/1e3>=128?"#414040":"#fff"}function ze(r,e){let t=new FormData;return t.append("id_route",r),t.append("status",e),fetch("https://rutaflow-app-development.up.railway.app/api/admin/route/change_status.php",{method:"POST",body:t}).then(o=>o.json()).then(o=>{}).catch(o=>{console.error("Error fetching data:",o)}),""}const En=r=>r.img;function kn(r,e,t){let o;wt(r,Ft,O=>t(14,o=O));var n=this&&this.__awaiter||function(O,C,B,V){function j(Q){return Q instanceof B?Q:new B(function(re){re(Q)})}return new(B||(B=Promise))(function(Q,re){function A(G){try{te(V.next(G))}catch(K){re(K)}}function Y(G){try{te(V.throw(G))}catch(K){re(K)}}function te(G){G.done?Q(G.value):j(G.value).then(A,Y)}te((V=V.apply(O,C||[])).next())})};let{routeId:l}=e,{driverId:a}=e,c=new Object,p=[],k={},E={},v;const u=()=>n(void 0,void 0,void 0,function*(){yield b(l),v.complete()});function b(O){const C=new FormData;C.append("id_route",O),fetch("https://rutaflow-app-development.up.railway.app/api/admin/report/seguimiento_list.php",{method:"POST",body:C}).then(B=>B.json()).then(B=>{t(4,k=B.data.seguimiento_list[0]),t(3,p=B.data.event_list),t(5,E=B.data.checklist)}).catch(B=>{console.error("Error fetching data:",B)})}const m=O=>new Promise((C,B)=>{const V=new FormData;V.append("id_route",O.id_route),V.append("id_event",O.id_event),fetch("https://rutaflow-app-development.up.railway.app/api/admin/evidence/evidence_by_event.php",{method:"POST",body:V}).then(j=>j.json()).then(j=>{C(j.data.event_evidence[0])}).catch(j=>{console.error("Error fetching data:",j),B(j)})}),h=(O,C)=>{m(O).then(B=>{O.client_name=k.client_name,B&&(O.img=B.img,O.driver_comments=B.driver_comments,O.comments=B.comments),Fe("modal-delivery-info",dn,{delivery:O,isLast:C}).then(V=>{})})},d=(O,C,B)=>{var V=!1;return Fe("modal-checklist",Et,{checklist:O,driverId:C,routeId:B,isLast:V}).then(j=>{}),ze(B,"checklist"),""},N=O=>{if(O.tracking_type=="subscription"){if(O.subscriber_info&&O.payment_type==="cash"&&new Date(O.subscriber_info.payment_next)<new Date)return!0}else if(O.tracking_type=="ecommerce"&&Number(O.payment_pending)>0)return!0;return!1},w=()=>{c.id_driver?Oe(`/drivers/${c.id_driver}`):Oe("/drivers/me")},q=(O,C)=>n(void 0,void 0,void 0,function*(){yield(yield Me.create({header:O||"Error",message:C||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()});function R(O){return O===p.length-1}function M(O){Ie[O?"unshift":"push"](()=>{v=O,t(6,v)})}const T=(O,C)=>h(O,R(C));function P(O){Ie[O?"unshift":"push"](()=>{v=O,t(6,v)})}const S=(O,C)=>h(O,R(C));function y(O){Ie[O?"unshift":"push"](()=>{v=O,t(6,v)})}const F=O=>{const C=p.findIndex(Q=>Q.id_event===O.id_event),B=C===0,V=C>0?p[C-1]:null;B||V&&V.img;const j=O.img!==null&&O.img!=="";j||B&&!j?h(O):q("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")};return r.$$set=O=>{"routeId"in O&&t(0,l=O.routeId),"driverId"in O&&t(1,a=O.driverId)},r.$$.update=()=>{r.$$.dirty[0]&16389&&(t(0,{routeId:l,driverId:a}=o.params,l,(t(1,a),t(14,o),t(2,c),t(0,l))),t(2,c=JSON.parse(localStorage.getItem("userSession"))),c?c.id_user&&(c.type=="admin"||c.type=="superadmin")?(Oe(`/drivers/me/routes/${l}`),b(l)):c.id_user&&c.id_driver&&(b(l),Oe(`/drivers/${c.id_driver}/routes/${l}`)):Oe("/"))},[l,a,c,p,k,E,v,u,h,d,N,w,q,R,o,M,T,P,S,y,F]}class Dn extends Xe{constructor(e){super(),We(this,e,kn,In,Ge,{routeId:0,driverId:1},null,[-1,-1])}}export{Dn as component};

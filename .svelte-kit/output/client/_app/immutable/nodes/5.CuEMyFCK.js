import{Z as kt,s as Je,e as d,j as N,b as f,q as g,d as ie,h as u,m as T,v as b,i as W,w as r,x as he,n as Le,z as He,_ as Cn,k as Pe,B as c,o as et,$ as It,t as Ie,r as Oe,f as j,a0 as Ln,a1 as rt,A as xe,y as Se,F as Ot,J as Mn,a2 as mt,a3 as Fe,a4 as yt,a5 as wt,l as Sn,p as Pn}from"../chunks/index.CdEBkEwf.js";import{S as Ye,i as Qe,t as $e,a as ot,b as gn,d as bn,m as En,e as kn,c as An,g as Dn}from"../chunks/index.Dw8w8a4z.js";import{e as Re,u as st,d as at,g as Ve,a as Ke,h as ze,b as xn,c as Bn,i as In,f as Un,j as On,k as Hn,m as Rn,n as ht,t as vt,s as zn,o as Vn,q as Nt,r as yn,v as wn,w as Tt,x as je,y as Fn,z as jn,A as Ct,B as Wn,C as qn,I as Gn,D as Kn,E as Xn,F as Jn,p as Yn}from"../chunks/index.DwNrThwN.js";import"../chunks/index-6e05b96e.C_9q9BoX.js";import{m as tt,D as ct,a as Ge,W as Qn,b as Zn}from"../chunks/overlays-b874c3c3.D6ebfl60.js";import{q as $n,t as ei}from"../chunks/ion-modal.BYMRzj9z.js";import{g as Ze}from"../chunks/entry.KrXTcCyY.js";const ti=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global,ni=(l,e)=>{if(!customElements.get(l)){class t extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const i={};for(const o of this.attributes)i[o.name]=o.value;new e({target:this.shadowRoot,props:i})}}customElements.define(l,t)}},ii=function(l){return document.createElement(l).constructor!==HTMLElement},oi=(l,e)=>{ii(l)||ni(l,e)},qe=async(l,e,t)=>{$n(),ei(),oi(l,e);const n=await tt.create({component:l,componentProps:t});return n.present(),await n.onWillDismiss()};let it=kt({km_inicial:[],gas_inicial:[],km_final:[],gas_final:[]}),Nn=kt({flag:[]});function li(l){let e,t,n,i,o="Cancelar",a,s,h="Captura de Km/Gas",E,m,_,v="Confirmar",p,k,y,w,B,S,z;return{c(){e=d("ion-header"),t=d("ion-toolbar"),n=d("ion-buttons"),i=d("ion-button"),i.textContent=o,a=N(),s=d("ion-title"),s.textContent=h,E=N(),m=d("ion-buttons"),_=d("ion-button"),_.textContent=v,p=N(),k=d("ion-content"),y=d("ion-item"),w=d("ion-input"),this.h()},l(H){e=f(H,"ION-HEADER",{translucent:!0});var Q=g(e);t=f(Q,"ION-TOOLBAR",{});var G=g(t);n=f(G,"ION-BUTTONS",{slot:!0});var L=g(n);i=f(L,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),ie(i)!=="svelte-17pq4f4"&&(i.textContent=o),L.forEach(u),a=T(G),s=f(G,"ION-TITLE",{"data-svelte-h":!0}),ie(s)!=="svelte-1yhkaq7"&&(s.textContent=h),E=T(G),m=f(G,"ION-BUTTONS",{slot:!0});var R=g(m);_=f(R,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),ie(_)!=="svelte-cm6j4s"&&(_.textContent=v),R.forEach(u),G.forEach(u),Q.forEach(u),p=T(H),k=f(H,"ION-CONTENT",{fullscreen:!0});var x=g(k);y=f(x,"ION-ITEM",{});var I=g(y);w=f(I,"ION-INPUT",{class:!0,inputmode:!0,pattern:!0,type:!0,placeholder:!0,value:!0,required:!0});var A=g(w);A.forEach(u),I.forEach(u),x.forEach(u),this.h()},h(){b(i,"color","medium"),b(n,"slot","start"),b(_,"strong",""),b(m,"slot","end"),b(e,"translucent",""),b(w,"class","fin-km"),b(w,"inputmode","numeric"),b(w,"pattern","[0-9]*"),b(w,"type","number"),b(w,"placeholder",B="Ingresa "+l[0]+" actual"),b(w,"value",l[1]),b(w,"required",""),b(k,"fullscreen","")},m(H,Q){W(H,e,Q),r(e,t),r(t,n),r(n,i),r(t,a),r(t,s),r(t,E),r(t,m),r(m,_),W(H,p,Q),W(H,k,Q),r(k,y),r(y,w),S||(z=[he(i,"click",l[2]),he(_,"click",l[3]),he(w,"input",l[4])],S=!0)},p(H,[Q]){Q&1&&B!==(B="Ingresa "+H[0]+" actual")&&b(w,"placeholder",B),Q&2&&b(w,"value",H[1])},i:Le,o:Le,d(H){H&&(u(e),u(p),u(k)),S=!1,He(z)}}}function ri(l,e,t){const n=Cn();let o=document.querySelector("ion-modal").componentProps.data_type,a="";Nn.subscribe(_=>{o=_.flag[0],o=="km_final"||o=="km_inicial"?t(0,a="kilometraje"):t(0,a="litros de gasolina")});let s=0;function h(){tt.dismiss()}function E(){n("modalResult",{data:"Your data",role:"confirm"}),o=="km_inicial"?it.update(v=>({...v,km_inicial:[s]})):o=="gas_inicial"?it.update(v=>({...v,gas_inicial:[s]})):o=="km_final"?it.update(v=>({...v,km_final:[s]})):o=="gas_final"&&it.update(v=>({...v,gas_final:[s]})),h()}return[a,s,h,E,_=>t(1,s=_.target.value)]}class si extends Ye{constructor(e){super(),Qe(this,e,ri,li,Je,{})}}const gt=kt({items:[],checkedIndices:[],mandatory:[]});function Pt(l,e,t){const n=l.slice();return n[56]=e[t],n[57]=e,n[58]=t,n}function ai(l){let e,t,n,i,o,a="Kilometraje inicial",s,h,E=l[0]?l[0]+" km.":"Cargar km",m,_,v,p,k,y,w,B="Gasolina inicial (litros)",S,z,H=l[1]?l[1]+" litros":"Cargar gas",Q,G,L,R;return G=It(l[22][0]),{c(){e=d("ion-item"),t=d("ion-label"),n=d("input"),i=N(),o=d("p"),o.textContent=a,s=N(),h=d("ion-button"),m=Ie(E),_=N(),v=d("ion-item"),p=d("ion-label"),k=d("input"),y=N(),w=d("p"),w.textContent=B,S=N(),z=d("ion-button"),Q=Ie(H),this.h()},l(x){e=f(x,"ION-ITEM",{});var I=g(e);t=f(I,"ION-LABEL",{style:!0});var A=g(t);n=f(A,"INPUT",{id:!0,style:!0,type:!0}),i=T(A),o=f(A,"P",{style:!0,"data-svelte-h":!0}),ie(o)!=="svelte-88twxi"&&(o.textContent=a),A.forEach(u),s=T(I),h=f(I,"ION-BUTTON",{fill:!0,size:!0,class:!0,"aria-selected":!0});var F=g(h);m=Oe(F,E),F.forEach(u),I.forEach(u),_=T(x),v=f(x,"ION-ITEM",{});var M=g(v);p=f(M,"ION-LABEL",{style:!0});var Y=g(p);k=f(Y,"INPUT",{id:!0,style:!0,type:!0}),y=T(Y),w=f(Y,"P",{style:!0,"data-svelte-h":!0}),ie(w)!=="svelte-1ux30eb"&&(w.textContent=B),Y.forEach(u),S=T(M),z=f(M,"ION-BUTTON",{fill:!0,class:!0,size:!0,style:!0});var K=g(z);Q=Oe(K,H),K.forEach(u),M.forEach(u),this.h()},h(){j(n,"id","chkbox-km-ini"),c(n,"pointer-events","auto"),j(n,"type","checkbox"),n.required=!0,c(o,"margin-left","10px"),c(t,"display","flex"),b(h,"fill","outline"),b(h,"size","small"),b(h,"class","loadKmInicial"),b(h,"aria-selected",""),j(k,"id","chkbox-gas-ini"),c(k,"pointer-events","auto"),j(k,"type","checkbox"),k.required=!0,c(w,"margin-left","10px"),c(p,"display","flex"),b(z,"fill","outline"),b(z,"class","loadGasInicial"),b(z,"size","small"),c(z,"height","16px "),G.p(n,k)},m(x,I){W(x,e,I),r(e,t),r(t,n),n.checked=~(l[4]||[]).indexOf(n.__value),l[29](n),r(t,i),r(t,o),r(e,s),r(e,h),r(h,m),W(x,_,I),W(x,v,I),r(v,p),r(p,k),l[31](k),k.checked=~(l[4]||[]).indexOf(k.__value),r(p,y),r(p,w),r(v,S),r(v,z),r(z,Q),L||(R=[he(n,"change",l[28]),he(h,"click",l[30]),he(k,"change",l[32]),he(z,"click",l[33])],L=!0)},p(x,I){I[0]&16&&(n.checked=~(x[4]||[]).indexOf(n.__value)),I[0]&1&&E!==(E=x[0]?x[0]+" km.":"Cargar km")&&Se(m,E),I[0]&16&&(k.checked=~(x[4]||[]).indexOf(k.__value)),I[0]&2&&H!==(H=x[1]?x[1]+" litros":"Cargar gas")&&Se(Q,H)},d(x){x&&(u(e),u(_),u(v)),l[29](null),l[31](null),G.r(),L=!1,He(R)}}}function ci(l){let e,t,n,i,o,a="Kilometraje final",s,h,E=l[2]?l[2]+" km.":"Cargar km",m,_,v,p,k,y,w,B="Gasolina final (litros)",S,z,H=l[3]?l[3]+" litros":"Cargar gas",Q,G,L,R;return G=It(l[22][0]),{c(){e=d("ion-item"),t=d("ion-label"),n=d("input"),i=N(),o=d("p"),o.textContent=a,s=N(),h=d("ion-button"),m=Ie(E),_=N(),v=d("ion-item"),p=d("ion-label"),k=d("input"),y=N(),w=d("p"),w.textContent=B,S=N(),z=d("ion-button"),Q=Ie(H),this.h()},l(x){e=f(x,"ION-ITEM",{});var I=g(e);t=f(I,"ION-LABEL",{style:!0});var A=g(t);n=f(A,"INPUT",{id:!0,style:!0,type:!0}),i=T(A),o=f(A,"P",{style:!0,"data-svelte-h":!0}),ie(o)!=="svelte-ccmu71"&&(o.textContent=a),A.forEach(u),s=T(I),h=f(I,"ION-BUTTON",{fill:!0,size:!0,class:!0,"aria-selected":!0});var F=g(h);m=Oe(F,E),F.forEach(u),I.forEach(u),_=T(x),v=f(x,"ION-ITEM",{});var M=g(v);p=f(M,"ION-LABEL",{style:!0});var Y=g(p);k=f(Y,"INPUT",{id:!0,style:!0,type:!0}),y=T(Y),w=f(Y,"P",{style:!0,"data-svelte-h":!0}),ie(w)!=="svelte-wsoyd2"&&(w.textContent=B),Y.forEach(u),S=T(M),z=f(M,"ION-BUTTON",{fill:!0,size:!0,class:!0});var K=g(z);Q=Oe(K,H),K.forEach(u),M.forEach(u),this.h()},h(){j(n,"id","chkbox-km-fin"),c(n,"pointer-events","auto"),j(n,"type","checkbox"),n.required=!0,c(o,"margin-left","10px"),c(t,"display","flex"),b(h,"fill","outline"),b(h,"size","small"),b(h,"class","loadKmInicial"),b(h,"aria-selected",""),j(k,"id","chkbox-gas-fin"),c(k,"pointer-events","auto"),j(k,"type","checkbox"),k.required=!0,c(w,"margin-left","10px"),c(p,"display","flex"),b(z,"fill","outline"),b(z,"size","small"),b(z,"class","loadGasInicial"),G.p(n,k)},m(x,I){W(x,e,I),r(e,t),r(t,n),n.checked=~(l[4]||[]).indexOf(n.__value),l[23](n),r(t,i),r(t,o),r(e,s),r(e,h),r(h,m),W(x,_,I),W(x,v,I),r(v,p),r(p,k),k.checked=~(l[4]||[]).indexOf(k.__value),l[26](k),r(p,y),r(p,w),r(v,S),r(v,z),r(z,Q),L||(R=[he(n,"change",l[21]),he(h,"click",l[24]),he(k,"change",l[25]),he(z,"click",l[27])],L=!0)},p(x,I){I[0]&16&&(n.checked=~(x[4]||[]).indexOf(n.__value)),I[0]&4&&E!==(E=x[2]?x[2]+" km.":"Cargar km")&&Se(m,E),I[0]&16&&(k.checked=~(x[4]||[]).indexOf(k.__value)),I[0]&8&&H!==(H=x[3]?x[3]+" litros":"Cargar gas")&&Se(Q,H)},d(x){x&&(u(e),u(_),u(v)),l[23](null),l[26](null),G.r(),L=!1,He(R)}}}function ui(l){let e=[],t=new Map,n,i=Re(l[14]);const o=a=>a[56].id_checklist_event;for(let a=0;a<i.length;a+=1){let s=Pt(l,i,a),h=o(s);t.set(h,e[a]=At(h,s))}return{c(){for(let a=0;a<e.length;a+=1)e[a].c();n=Pe()},l(a){for(let s=0;s<e.length;s+=1)e[s].l(a);n=Pe()},m(a,s){for(let h=0;h<e.length;h+=1)e[h]&&e[h].m(a,s);W(a,n,s)},p(a,s){s[0]&813168&&(i=Re(a[14]),e=st(e,s,o,1,a,i,t,n.parentNode,at,At,n,Pt))},d(a){a&&u(n);for(let s=0;s<e.length;s+=1)e[s].d(a)}}}function di(l){let e,t=(l[13][l[56].id_checklist_event]?l[13][l[56].id_checklist_event]:"Cargar evidencia")+"",n;return{c(){e=d("label"),n=Ie(t),this.h()},l(i){e=f(i,"LABEL",{for:!0,class:!0});var o=g(e);n=Oe(o,t),o.forEach(u),this.h()},h(){j(e,"for","chklist-"+l[56].id_checklist_event),j(e,"class","button-label")},m(i,o){W(i,e,o),r(e,n)},p(i,o){o[0]&8192&&t!==(t=(i[13][i[56].id_checklist_event]?i[13][i[56].id_checklist_event]:"Cargar evidencia")+"")&&Se(n,t)},d(i){i&&u(e)}}}function fi(l){let e;return{c(){e=d("ion-spinner"),this.h()},l(t){e=f(t,"ION-SPINNER",{name:!0,class:!0}),g(e).forEach(u),this.h()},h(){b(e,"name","dots"),b(e,"class","button-spinner")},m(t,n){W(t,e,n)},p:Le,d(t){t&&u(e)}}}function At(l,e){let t,n,i,o=e[56],a,s,h=e[56].item+"",E,m,_,v=e[56].mandatory=="1"?" * ":"",p,k,y,w,B,S,z,H,Q,G;const L=()=>e[35](i,o),R=()=>e[35](null,o);function x(){return e[36](e[56])}function I(Y,K){return Y[11][Y[56].id_checklist_event]?fi:di}let A=I(e),F=A(e);function M(...Y){return e[38](e[56],...Y)}return H=It(e[22][0]),{key:l,first:null,c(){t=d("ion-item"),n=d("ion-label"),i=d("input"),a=N(),s=d("p"),E=Ie(h),m=N(),_=d("b"),p=Ie(v),k=N(),y=d("ion-button"),w=d("div"),F.c(),B=N(),S=d("input"),z=N(),this.h()},l(Y){t=f(Y,"ION-ITEM",{});var K=g(t);n=f(K,"ION-LABEL",{style:!0});var J=g(n);i=f(J,"INPUT",{id:!0,style:!0,type:!0}),a=T(J),s=f(J,"P",{style:!0});var ne=g(s);E=Oe(ne,h),ne.forEach(u),m=T(J),_=f(J,"B",{style:!0});var re=g(_);p=Oe(re,v),re.forEach(u),J.forEach(u),k=T(K),y=f(K,"ION-BUTTON",{fill:!0,class:!0,size:!0});var D=g(y);w=f(D,"DIV",{class:!0});var le=g(w);F.l(le),B=T(le),S=f(le,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0,capture:!0}),le.forEach(u),D.forEach(u),z=T(K),K.forEach(u),this.h()},h(){j(i,"id",`chkbox-${e[56].id_checklist_event}`),c(i,"pointer-events","auto"),j(i,"type","checkbox"),i.__value=e[56].id_checklist_event,Ln(i,i.__value),i.required=!0,c(s,"margin-left","10px"),c(_,"margin-left","5px"),c(n,"display","flex"),c(S,"display","none"),j(S,"id","chklist-"+e[56].id_checklist_event),j(S,"name","fileToUpload"),j(S,"type","file"),j(S,"accept","image/*"),j(S,"capture","environment"),j(w,"class","button-content"),b(y,"fill","outline"),b(y,"class","loadEvidence"),b(y,"size","small"),H.p(i),this.first=t},m(Y,K){W(Y,t,K),r(t,n),r(n,i),i.checked=~(e[4]||[]).indexOf(i.__value),L(),r(n,a),r(n,s),r(s,E),r(n,m),r(n,_),r(_,p),r(t,k),r(t,y),r(y,w),F.m(w,null),r(w,B),r(w,S),e[37](S),r(t,z),Q||(G=[he(i,"change",e[34]),he(i,"change",x),he(S,"change",M)],Q=!0)},p(Y,K){e=Y,K[0]&16&&(i.checked=~(e[4]||[]).indexOf(i.__value)),o!==e[56]&&(R(),o=e[56],L()),A===(A=I(e))&&F?F.p(e,K):(F.d(1),F=A(e),F&&(F.c(),F.m(w,B)))},d(Y){Y&&u(t),R(),F.d(),e[37](null),H.r(),Q=!1,He(G)}}}function Dt(l){let e,t='<ion-spinner name="dots" style="color:white;"></ion-spinner>';return{c(){e=d("div"),e.innerHTML=t,this.h()},l(n){e=f(n,"DIV",{class:!0,style:!0,"data-svelte-h":!0}),ie(e)!=="svelte-1aosxw0"&&(e.innerHTML=t),this.h()},h(){j(e,"class","overlay"),c(e,"position","fixed"),c(e,"top","0"),c(e,"left","0"),c(e,"width","100vw"),c(e,"height","100vh"),c(e,"background","rgba(0, 0, 0, 0.5)"),c(e,"display","flex"),c(e,"align-items","center"),c(e,"justify-content","center"),c(e,"z-index","9999")},m(n,i){W(n,e,i)},d(n){n&&u(e)}}}function hi(l){let e,t,n,i,o="Cancelar",a,s,h="REQUERIMIENTOS DE RUTA",E,m,_,v,p,k,y,w="Confirmar",B,S,z,H;function Q(I,A){return I[15]?ci:ai}let L=Q(l)(l),R=l[14]&&ui(l),x=l[12]&&Dt();return{c(){e=d("ion-header"),t=d("ion-toolbar"),n=d("ion-buttons"),i=d("ion-button"),i.textContent=o,a=N(),s=d("ion-title"),s.textContent=h,E=N(),m=d("ion-content"),_=d("ion-list"),L.c(),v=N(),R&&R.c(),p=N(),k=d("ion-footer"),y=d("ion-button"),y.textContent=w,B=N(),x&&x.c(),S=Pe(),this.h()},l(I){e=f(I,"ION-HEADER",{translucent:!0});var A=g(e);t=f(A,"ION-TOOLBAR",{});var F=g(t);n=f(F,"ION-BUTTONS",{slot:!0});var M=g(n);i=f(M,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),ie(i)!=="svelte-1yhpw6u"&&(i.textContent=o),M.forEach(u),a=T(F),s=f(F,"ION-TITLE",{"data-svelte-h":!0}),ie(s)!=="svelte-19bar5p"&&(s.textContent=h),F.forEach(u),A.forEach(u),E=T(I),m=f(I,"ION-CONTENT",{fullscreen:!0});var Y=g(m);_=f(Y,"ION-LIST",{});var K=g(_);L.l(K),v=T(K),R&&R.l(K),K.forEach(u),Y.forEach(u),p=T(I),k=f(I,"ION-FOOTER",{});var J=g(k);y=f(J,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),ie(y)!=="svelte-1k4i1so"&&(y.textContent=w),J.forEach(u),B=T(I),x&&x.l(I),S=Pe(),this.h()},h(){b(i,"color","medium"),b(n,"slot","start"),b(e,"translucent",""),b(m,"fullscreen",""),b(y,"fill","outline"),b(y,"color","tertiary"),b(y,"strong",""),c(y,"width","99%"),c(y,"height","auto")},m(I,A){W(I,e,A),r(e,t),r(t,n),r(n,i),r(t,a),r(t,s),W(I,E,A),W(I,m,A),r(m,_),L.m(_,null),r(_,v),R&&R.m(_,null),W(I,p,A),W(I,k,A),r(k,y),W(I,B,A),x&&x.m(I,A),W(I,S,A),z||(H=[he(i,"click",l[16]),he(y,"click",l[17])],z=!0)},p(I,A){L.p(I,A),I[14]&&R.p(I,A),I[12]?x||(x=Dt(),x.c(),x.m(S.parentNode,S)):x&&(x.d(1),x=null)},i:Le,o:Le,d(I){I&&(u(e),u(E),u(m),u(p),u(k),u(B),u(S)),L.d(),R&&R.d(),x&&x.d(I),z=!1,He(H)}}}function bt(l,e){if(typeof l=="object"&&l!==null||Array.isArray(l)){if(Array.isArray(l))return l.map(t=>bt(t,e)).flat();{const t=Object.keys(l);let n;return e=="id_checklist_event"?n=t.filter(o=>o.toLowerCase().includes("id_checklist_event")).map(o=>l[o]):e=="mandatory"?n=t.filter(o=>o.toLowerCase().includes("mandatory")).map(o=>l[o]):(console.error("Tipo de dato no reconocido."),n=!1),n}}else return console.error("Invalid input. Please provide a valid object or array."),[]}function _i(){return new Promise((l,e)=>{if(!navigator.geolocation)return e("Geoloc no soportada");navigator.geolocation.getCurrentPosition(t=>l({lat:+t.coords.latitude.toFixed(6),lng:+t.coords.longitude.toFixed(6)}),t=>e(t),{enableHighAccuracy:!0,maximumAge:0,timeout:8e3})})}function pi(l,e,t){let n=ct,i=document.querySelector("ion-modal");const o=i.componentProps.checklist,a=i.componentProps.driverId,s=i.componentProps.routeId,h=i.componentProps.isLast;let E,m,_,v,p=[],k=null,y={},w,B,S,z,H={},Q=new Object,G=!1,L={},R={};et(()=>{Q=JSON.parse(localStorage.getItem("userSession")),h?console.log("Último checklist"):gt.update(O=>(O.mandatory=bt(o,"mandatory"),O.items=bt(o,"id_checklist_event"),O))});function x(O){t(11,H[O]=!0,H)}const I=async()=>{await(await Ge.create({header:"Datos o checklist incompletos",message:"Carga la evidencia requerida y marca todas las casillas para confirmar",buttons:[{text:"Cerrar"}]})).present()},A=async(O,V)=>{await(await Ge.create({header:O||"Error",message:V||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()},F=async O=>{await(await Ge.create({header:"Datos inválidos",message:O=="km"?"Llena correctamente el campo de kilometraje inicial":"Llena correctamente el campo de gasolina inicial",buttons:[{text:"Cerrar"}]})).present()},M=()=>{tt.dismiss(),a?Ze(`/drivers/${a}`):Ze("/drivers/me")},Y=async()=>{if(t(12,G=!0),h){var O=D(_,"km"),V=D(v,"gas");let U=new Object;U.km_final=O,U.gas_final=V,U.id_route=s,U.id_user_over=Q.id_user,U.token=Q.token,O&&V?(M(),Ve(`${n}api/admin/checklist/add_evidence.php`,function(q){q.success?(t(12,G=!1),A("Datos capturados","El kilometraje y gasolina final fueron registrados correctamente, espere aprobación para finalizar ruta")):(t(12,G=!1),A("Error","Vuelva a intentar capturar los datos solicitados"))},U)):I()}else{var C=D(E,"km"),P=D(m,"gas");let U=null;try{U=await _i()}catch(q){console.warn("GPS no disponible:",q)}gt.update(q=>{q.items;const me=q.mandatory;if(q.items.filter((ye,be)=>q.mandatory[be]==="1").every(ye=>q.checkedIndices.includes(ye))&&C&&P){let ye=new FormData;ye=ae(ye),ye.append("km_inicial",C),ye.append("gas_inicial",P),ye.append("id_route",s),U&&(ye.append("lat",U.lat),ye.append("lng",U.lng));for(const be in L)if(L.hasOwnProperty(be)){const{img:De,img_id:We}=L[be];ye.append(`selectedImages[${be}][img]`,De),ye.append(`selectedImages[${be}][img_id]`,We)}fetch(`${n}api/admin/checklist/add_evidence.php`,{method:"POST",body:ye}).then(be=>be.json()).then(be=>{me&&me.some(De=>De==="1")?re(s,"checklist-pending"):re(s,"enroute")}).catch(be=>{console.error("Error fetching data:",be)}).finally(()=>{t(12,G=!1),M()})}else if(!me&&C&&P){let ye=new FormData;U&&(ye.append("lat",U.lat),ye.append("lng",U.lng)),ye.append("km_inicial",C),ye.append("gas_inicial",P),ye=ae(ye),fetch(`${n}api/admin/checklist/add_evidence.php`,{method:"POST",body:ye}).then(be=>be.json()).then(be=>{re(s,"enroute")}).catch(be=>{console.error("Error fetching data:",be)}).finally(()=>{t(12,G=!1),M()})}else I();return q})}fe()},K=async(O,V)=>{x(V);const P=O.target.files[0],U=await J(P);if(U){let q=new FormData;q.append("fileToUpload",U),q=ae(q);try{const me=await fetch(`${n}api/admin/manager/upload_img_driver.php`,{method:"POST",body:q});if(me.ok){const we=await me.json();L={...L,[V]:{img:we.img,img_id:we.img_id}},t(13,R={...R,[V]:we.filename}),ne(V),t(6,y[V].checked=!0,y),t(11,H[V]=!1,H)}else console.error("File upload failed:",me.statusText)}catch(me){console.error("Error during file upload:",me)}}},J=async O=>new Promise(V=>{const C=new Image;C.src=URL.createObjectURL(O),C.onload=()=>{const P=document.createElement("canvas"),U=P.getContext("2d"),q=800,me=600;let we=C.width,Te=C.height;we>q&&(Te*=q/we,we=q),Te>me&&(we*=me/Te,Te=me),P.width=we,P.height=Te,U.drawImage(C,0,0,we,Te),P.toBlob(ye=>{V(ye),URL.revokeObjectURL(C.src),U.clearRect(0,0,P.width,P.height)},"image/jpeg",.7)}}),ne=O=>{gt.update(V=>(V.checkedIndices.indexOf(O)===-1?V.checkedIndices.push(O):console.error(`ID ${O} is already checked.`),V.items.forEach(P=>{P.id_checklist_event===O&&(P.checked=!0)}),V))};function re(O,V){let C=new FormData;C.append("id_route",O),C.append("status",V),C=ae(C),fetch(`${n}api/admin/route/change_status.php`,{method:"POST",body:C}).then(P=>P.json()).then(P=>{}).catch(P=>{console.error("Error fetching data:",P)})}function D(O,V){return/^\d+$/.test(O)?parseInt(O,10):(F(V),null)}function le(O,V){pe(V),i.componentProps.data_type=V,qe("modal-gas-km",si,{r:V}).then(()=>{it.subscribe(C=>{ue(C,V)})})}function pe(O){Nn.update(V=>({...V,flag:[O]}))}function ue(O,V){t(0,E=O.km_inicial?O.km_inicial:null),t(1,m=O.gas_inicial?O.gas_inicial:null),t(2,_=O.km_final?O.km_final:null),t(3,v=O.gas_final?O.gas_final:null),V=="km_inicial"&&w&&t(7,w.checked=!0,w),V=="gas_inicial"&&B&&t(8,B.checked=!0,B),V=="km_final"&&S&&t(9,S.checked=!0,S),V=="gas_final"&&z&&t(10,z.checked=!0,z)}function fe(){it.set({km_inicial:[],gas_inicial:[],km_final:[],gas_final:[]})}function ae(O){return O.append("token",Q.token),O.append("id_user_over",Q.id_user),O}const se=[[]];function ce(){p=rt(se[0],this.__value,this.checked),t(4,p)}function oe(O){xe[O?"unshift":"push"](()=>{S=O,t(9,S)})}const ee=O=>le(O,"km_final");function Ee(){p=rt(se[0],this.__value,this.checked),t(4,p)}function ve(O){xe[O?"unshift":"push"](()=>{z=O,t(10,z)})}const ke=O=>le(O,"gas_final");function de(){p=rt(se[0],this.__value,this.checked),t(4,p)}function _e(O){xe[O?"unshift":"push"](()=>{w=O,t(7,w)})}const $=O=>le(O,"km_inicial");function Z(O){xe[O?"unshift":"push"](()=>{B=O,t(8,B)})}function te(){p=rt(se[0],this.__value,this.checked),t(4,p)}const X=O=>le(O,"gas_inicial");function ge(){p=rt(se[0],this.__value,this.checked),t(4,p)}function Me(O,V){xe[O?"unshift":"push"](()=>{y[V.id_checklist_event]=O,t(6,y)})}const Ce=O=>ne(O.id_checklist_event);function Ne(O){xe[O?"unshift":"push"](()=>{k=O,t(5,k)})}return[E,m,_,v,p,k,y,w,B,S,z,H,G,R,o,h,M,Y,K,ne,le,ce,se,oe,ee,Ee,ve,ke,de,_e,$,Z,te,X,ge,Me,Ce,Ne,(O,V)=>K(V,O.id_checklist_event)]}class Tn extends Ye{constructor(e){super(),Qe(this,e,pi,hi,Je,{},null,[-1,-1])}}/*!
 * Signature Pad v5.0.10 | https://github.com/szimek/signature_pad
 * (c) 2025 Szymon Nowak | Released under the MIT license
 */class _t{constructor(e,t,n,i){if(isNaN(e)||isNaN(t))throw new Error(`Point is invalid: (${e}, ${t})`);this.x=+e,this.y=+t,this.pressure=n||0,this.time=i||Date.now()}distanceTo(e){return Math.sqrt(Math.pow(this.x-e.x,2)+Math.pow(this.y-e.y,2))}equals(e){return this.x===e.x&&this.y===e.y&&this.pressure===e.pressure&&this.time===e.time}velocityFrom(e){return this.time!==e.time?this.distanceTo(e)/(this.time-e.time):0}}class Lt{static fromPoints(e,t){const n=this.calculateControlPoints(e[0],e[1],e[2]).c2,i=this.calculateControlPoints(e[1],e[2],e[3]).c1;return new Lt(e[1],n,i,e[2],t.start,t.end)}static calculateControlPoints(e,t,n){const i=e.x-t.x,o=e.y-t.y,a=t.x-n.x,s=t.y-n.y,h={x:(e.x+t.x)/2,y:(e.y+t.y)/2},E={x:(t.x+n.x)/2,y:(t.y+n.y)/2},m=Math.sqrt(i*i+o*o),_=Math.sqrt(a*a+s*s),v=h.x-E.x,p=h.y-E.y,k=m+_==0?0:_/(m+_),y={x:E.x+v*k,y:E.y+p*k},w=t.x-y.x,B=t.y-y.y;return{c1:new _t(h.x+w,h.y+B),c2:new _t(E.x+w,E.y+B)}}constructor(e,t,n,i,o,a){this.startPoint=e,this.control2=t,this.control1=n,this.endPoint=i,this.startWidth=o,this.endWidth=a}length(){let t=0,n,i;for(let o=0;o<=10;o+=1){const a=o/10,s=this.point(a,this.startPoint.x,this.control1.x,this.control2.x,this.endPoint.x),h=this.point(a,this.startPoint.y,this.control1.y,this.control2.y,this.endPoint.y);if(o>0){const E=s-n,m=h-i;t+=Math.sqrt(E*E+m*m)}n=s,i=h}return t}point(e,t,n,i,o){return t*(1-e)*(1-e)*(1-e)+3*n*(1-e)*(1-e)*e+3*i*(1-e)*e*e+o*e*e*e}}class mi{constructor(){try{this._et=new EventTarget}catch{this._et=document}}addEventListener(e,t,n){this._et.addEventListener(e,t,n)}dispatchEvent(e){return this._et.dispatchEvent(e)}removeEventListener(e,t,n){this._et.removeEventListener(e,t,n)}}function vi(l,e=250){let t=0,n=null,i,o,a;const s=()=>{t=Date.now(),n=null,i=l.apply(o,a),n||(o=null,a=[])};return function(...E){const m=Date.now(),_=e-(m-t);return o=this,a=E,_<=0||_>e?(n&&(clearTimeout(n),n=null),t=m,i=l.apply(o,a),n||(o=null,a=[])):n||(n=window.setTimeout(s,_)),i}}class pt extends mi{constructor(e,t={}){var n,i,o;super(),this.canvas=e,this._drawingStroke=!1,this._isEmpty=!0,this._lastPoints=[],this._data=[],this._lastVelocity=0,this._lastWidth=0,this.velocityFilterWeight=t.velocityFilterWeight||.7,this.minWidth=t.minWidth||.5,this.maxWidth=t.maxWidth||2.5,this.throttle=(n=t.throttle)!==null&&n!==void 0?n:16,this.minDistance=(i=t.minDistance)!==null&&i!==void 0?i:5,this.dotSize=t.dotSize||0,this.penColor=t.penColor||"black",this.backgroundColor=t.backgroundColor||"rgba(0,0,0,0)",this.compositeOperation=t.compositeOperation||"source-over",this.canvasContextOptions=(o=t.canvasContextOptions)!==null&&o!==void 0?o:{},this._strokeMoveUpdate=this.throttle?vi(pt.prototype._strokeUpdate,this.throttle):pt.prototype._strokeUpdate,this._handleMouseDown=this._handleMouseDown.bind(this),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this._handleTouchStart=this._handleTouchStart.bind(this),this._handleTouchMove=this._handleTouchMove.bind(this),this._handleTouchEnd=this._handleTouchEnd.bind(this),this._handlePointerDown=this._handlePointerDown.bind(this),this._handlePointerMove=this._handlePointerMove.bind(this),this._handlePointerUp=this._handlePointerUp.bind(this),this._ctx=e.getContext("2d",this.canvasContextOptions),this.clear(),this.on()}clear(){const{_ctx:e,canvas:t}=this;e.fillStyle=this.backgroundColor,e.clearRect(0,0,t.width,t.height),e.fillRect(0,0,t.width,t.height),this._data=[],this._reset(this._getPointGroupOptions()),this._isEmpty=!0,this._strokePointerId=void 0}fromDataURL(e,t={}){return new Promise((n,i)=>{const o=new Image,a=t.ratio||window.devicePixelRatio||1,s=t.width||this.canvas.width/a,h=t.height||this.canvas.height/a,E=t.xOffset||0,m=t.yOffset||0;this._reset(this._getPointGroupOptions()),o.onload=()=>{this._ctx.drawImage(o,E,m,s,h),n()},o.onerror=_=>{i(_)},o.crossOrigin="anonymous",o.src=e,this._isEmpty=!1})}toDataURL(e="image/png",t){switch(e){case"image/svg+xml":return typeof t!="object"&&(t=void 0),`data:image/svg+xml;base64,${btoa(this.toSVG(t))}`;default:return typeof t!="number"&&(t=void 0),this.canvas.toDataURL(e,t)}}on(){this.canvas.style.touchAction="none",this.canvas.style.msTouchAction="none",this.canvas.style.userSelect="none";const e=/Macintosh/.test(navigator.userAgent)&&"ontouchstart"in document;window.PointerEvent&&!e?this._handlePointerEvents():(this._handleMouseEvents(),"ontouchstart"in window&&this._handleTouchEvents())}off(){this.canvas.style.touchAction="auto",this.canvas.style.msTouchAction="auto",this.canvas.style.userSelect="auto",this.canvas.removeEventListener("pointerdown",this._handlePointerDown),this.canvas.removeEventListener("mousedown",this._handleMouseDown),this.canvas.removeEventListener("touchstart",this._handleTouchStart),this._removeMoveUpEventListeners()}_getListenerFunctions(){var e;const t=window.document===this.canvas.ownerDocument?window:(e=this.canvas.ownerDocument.defaultView)!==null&&e!==void 0?e:this.canvas.ownerDocument;return{addEventListener:t.addEventListener.bind(t),removeEventListener:t.removeEventListener.bind(t)}}_removeMoveUpEventListeners(){const{removeEventListener:e}=this._getListenerFunctions();e("pointermove",this._handlePointerMove),e("pointerup",this._handlePointerUp),e("mousemove",this._handleMouseMove),e("mouseup",this._handleMouseUp),e("touchmove",this._handleTouchMove),e("touchend",this._handleTouchEnd)}isEmpty(){return this._isEmpty}fromData(e,{clear:t=!0}={}){t&&this.clear(),this._fromData(e,this._drawCurve.bind(this),this._drawDot.bind(this)),this._data=this._data.concat(e)}toData(){return this._data}_isLeftButtonPressed(e,t){return t?e.buttons===1:(e.buttons&1)===1}_pointerEventToSignatureEvent(e){return{event:e,type:e.type,x:e.clientX,y:e.clientY,pressure:"pressure"in e?e.pressure:0}}_touchEventToSignatureEvent(e){const t=e.changedTouches[0];return{event:e,type:e.type,x:t.clientX,y:t.clientY,pressure:t.force}}_handleMouseDown(e){!this._isLeftButtonPressed(e,!0)||this._drawingStroke||this._strokeBegin(this._pointerEventToSignatureEvent(e))}_handleMouseMove(e){if(!this._isLeftButtonPressed(e,!0)||!this._drawingStroke){this._strokeEnd(this._pointerEventToSignatureEvent(e),!1);return}this._strokeMoveUpdate(this._pointerEventToSignatureEvent(e))}_handleMouseUp(e){this._isLeftButtonPressed(e)||this._strokeEnd(this._pointerEventToSignatureEvent(e))}_handleTouchStart(e){e.targetTouches.length!==1||this._drawingStroke||(e.cancelable&&e.preventDefault(),this._strokeBegin(this._touchEventToSignatureEvent(e)))}_handleTouchMove(e){if(e.targetTouches.length===1){if(e.cancelable&&e.preventDefault(),!this._drawingStroke){this._strokeEnd(this._touchEventToSignatureEvent(e),!1);return}this._strokeMoveUpdate(this._touchEventToSignatureEvent(e))}}_handleTouchEnd(e){e.targetTouches.length===0&&(e.cancelable&&e.preventDefault(),this._strokeEnd(this._touchEventToSignatureEvent(e)))}_getPointerId(e){return e.persistentDeviceId||e.pointerId}_allowPointerId(e,t=!1){return typeof this._strokePointerId>"u"?t:this._getPointerId(e)===this._strokePointerId}_handlePointerDown(e){this._drawingStroke||!this._isLeftButtonPressed(e)||!this._allowPointerId(e,!0)||(this._strokePointerId=this._getPointerId(e),e.preventDefault(),this._strokeBegin(this._pointerEventToSignatureEvent(e)))}_handlePointerMove(e){if(this._allowPointerId(e)){if(!this._isLeftButtonPressed(e,!0)||!this._drawingStroke){this._strokeEnd(this._pointerEventToSignatureEvent(e),!1);return}e.preventDefault(),this._strokeMoveUpdate(this._pointerEventToSignatureEvent(e))}}_handlePointerUp(e){this._isLeftButtonPressed(e)||!this._allowPointerId(e)||(e.preventDefault(),this._strokeEnd(this._pointerEventToSignatureEvent(e)))}_getPointGroupOptions(e){return{penColor:e&&"penColor"in e?e.penColor:this.penColor,dotSize:e&&"dotSize"in e?e.dotSize:this.dotSize,minWidth:e&&"minWidth"in e?e.minWidth:this.minWidth,maxWidth:e&&"maxWidth"in e?e.maxWidth:this.maxWidth,velocityFilterWeight:e&&"velocityFilterWeight"in e?e.velocityFilterWeight:this.velocityFilterWeight,compositeOperation:e&&"compositeOperation"in e?e.compositeOperation:this.compositeOperation}}_strokeBegin(e){if(!this.dispatchEvent(new CustomEvent("beginStroke",{detail:e,cancelable:!0})))return;const{addEventListener:n}=this._getListenerFunctions();switch(e.event.type){case"mousedown":n("mousemove",this._handleMouseMove,{passive:!1}),n("mouseup",this._handleMouseUp,{passive:!1});break;case"touchstart":n("touchmove",this._handleTouchMove,{passive:!1}),n("touchend",this._handleTouchEnd,{passive:!1});break;case"pointerdown":n("pointermove",this._handlePointerMove,{passive:!1}),n("pointerup",this._handlePointerUp,{passive:!1});break}this._drawingStroke=!0;const i=this._getPointGroupOptions(),o=Object.assign(Object.assign({},i),{points:[]});this._data.push(o),this._reset(i),this._strokeUpdate(e)}_strokeUpdate(e){if(!this._drawingStroke)return;if(this._data.length===0){this._strokeBegin(e);return}this.dispatchEvent(new CustomEvent("beforeUpdateStroke",{detail:e}));const t=this._createPoint(e.x,e.y,e.pressure),n=this._data[this._data.length-1],i=n.points,o=i.length>0&&i[i.length-1],a=o?t.distanceTo(o)<=this.minDistance:!1,s=this._getPointGroupOptions(n);if(!o||!(o&&a)){const h=this._addPoint(t,s);o?h&&this._drawCurve(h,s):this._drawDot(t,s),i.push({time:t.time,x:t.x,y:t.y,pressure:t.pressure})}this.dispatchEvent(new CustomEvent("afterUpdateStroke",{detail:e}))}_strokeEnd(e,t=!0){this._removeMoveUpEventListeners(),this._drawingStroke&&(t&&this._strokeUpdate(e),this._drawingStroke=!1,this._strokePointerId=void 0,this.dispatchEvent(new CustomEvent("endStroke",{detail:e})))}_handlePointerEvents(){this._drawingStroke=!1,this.canvas.addEventListener("pointerdown",this._handlePointerDown,{passive:!1})}_handleMouseEvents(){this._drawingStroke=!1,this.canvas.addEventListener("mousedown",this._handleMouseDown,{passive:!1})}_handleTouchEvents(){this.canvas.addEventListener("touchstart",this._handleTouchStart,{passive:!1})}_reset(e){this._lastPoints=[],this._lastVelocity=0,this._lastWidth=(e.minWidth+e.maxWidth)/2,this._ctx.fillStyle=e.penColor,this._ctx.globalCompositeOperation=e.compositeOperation}_createPoint(e,t,n){const i=this.canvas.getBoundingClientRect();return new _t(e-i.left,t-i.top,n,new Date().getTime())}_addPoint(e,t){const{_lastPoints:n}=this;if(n.push(e),n.length>2){n.length===3&&n.unshift(n[0]);const i=this._calculateCurveWidths(n[1],n[2],t),o=Lt.fromPoints(n,i);return n.shift(),o}return null}_calculateCurveWidths(e,t,n){const i=n.velocityFilterWeight*t.velocityFrom(e)+(1-n.velocityFilterWeight)*this._lastVelocity,o=this._strokeWidth(i,n),a={end:o,start:this._lastWidth};return this._lastVelocity=i,this._lastWidth=o,a}_strokeWidth(e,t){return Math.max(t.maxWidth/(e+1),t.minWidth)}_drawCurveSegment(e,t,n){const i=this._ctx;i.moveTo(e,t),i.arc(e,t,n,0,2*Math.PI,!1),this._isEmpty=!1}_drawCurve(e,t){const n=this._ctx,i=e.endWidth-e.startWidth,o=Math.ceil(e.length())*2;n.beginPath(),n.fillStyle=t.penColor;for(let a=0;a<o;a+=1){const s=a/o,h=s*s,E=h*s,m=1-s,_=m*m,v=_*m;let p=v*e.startPoint.x;p+=3*_*s*e.control1.x,p+=3*m*h*e.control2.x,p+=E*e.endPoint.x;let k=v*e.startPoint.y;k+=3*_*s*e.control1.y,k+=3*m*h*e.control2.y,k+=E*e.endPoint.y;const y=Math.min(e.startWidth+E*i,t.maxWidth);this._drawCurveSegment(p,k,y)}n.closePath(),n.fill()}_drawDot(e,t){const n=this._ctx,i=t.dotSize>0?t.dotSize:(t.minWidth+t.maxWidth)/2;n.beginPath(),this._drawCurveSegment(e.x,e.y,i),n.closePath(),n.fillStyle=t.penColor,n.fill()}_fromData(e,t,n){for(const i of e){const{points:o}=i,a=this._getPointGroupOptions(i);if(o.length>1)for(let s=0;s<o.length;s+=1){const h=o[s],E=new _t(h.x,h.y,h.pressure,h.time);s===0&&this._reset(a);const m=this._addPoint(E,a);m&&t(m,a)}else this._reset(a),n(o[0],a)}}toSVG({includeBackgroundColor:e=!1}={}){const t=this._data,n=Math.max(window.devicePixelRatio||1,1),i=0,o=0,a=this.canvas.width/n,s=this.canvas.height/n,h=document.createElementNS("http://www.w3.org/2000/svg","svg");if(h.setAttribute("xmlns","http://www.w3.org/2000/svg"),h.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),h.setAttribute("viewBox",`${i} ${o} ${a} ${s}`),h.setAttribute("width",a.toString()),h.setAttribute("height",s.toString()),e&&this.backgroundColor){const E=document.createElement("rect");E.setAttribute("width","100%"),E.setAttribute("height","100%"),E.setAttribute("fill",this.backgroundColor),h.appendChild(E)}return this._fromData(t,(E,{penColor:m})=>{const _=document.createElement("path");if(!isNaN(E.control1.x)&&!isNaN(E.control1.y)&&!isNaN(E.control2.x)&&!isNaN(E.control2.y)){const v=`M ${E.startPoint.x.toFixed(3)},${E.startPoint.y.toFixed(3)} C ${E.control1.x.toFixed(3)},${E.control1.y.toFixed(3)} ${E.control2.x.toFixed(3)},${E.control2.y.toFixed(3)} ${E.endPoint.x.toFixed(3)},${E.endPoint.y.toFixed(3)}`;_.setAttribute("d",v),_.setAttribute("stroke-width",(E.endWidth*2.25).toFixed(3)),_.setAttribute("stroke",m),_.setAttribute("fill","none"),_.setAttribute("stroke-linecap","round"),h.appendChild(_)}},(E,{penColor:m,dotSize:_,minWidth:v,maxWidth:p})=>{const k=document.createElement("circle"),y=_>0?_:(v+p)/2;k.setAttribute("r",y.toString()),k.setAttribute("cx",E.x.toString()),k.setAttribute("cy",E.y.toString()),k.setAttribute("fill",m),h.appendChild(k)}),h.outerHTML}}function gi(l){let e,t;return{c(){e=d("div"),t=d("canvas"),this.h()},l(n){e=f(n,"DIV",{class:!0,style:!0});var i=g(e);t=f(i,"CANVAS",{class:!0,style:!0}),g(t).forEach(u),i.forEach(u),this.h()},h(){j(t,"class","signature-canvas"),c(t,"position","absolute"),c(t,"top","0"),c(t,"left","0"),c(t,"width","100%"),c(t,"height","100%"),c(t,"display","block"),j(e,"class","signature-container"),c(e,"position","relative"),c(e,"width","100%"),c(e,"height","150px"),c(e,"border","1px solid #ccc"),c(e,"border-radius","4px"),c(e,"touch-action","none"),c(e,"-ms-touch-action","none")},m(n,i){W(n,e,i),r(e,t),l[5](t),l[6](e)},p:Le,i:Le,o:Le,d(n){n&&u(e),l[5](null),l[6](null)}}}function bi(l,e,t){let n,i,o,a;function s(){o&&o.clear()}async function h(p="image/png"){return!o||o.isEmpty()?(await(await Ge.create({header:"Firma vacía",message:"No existe firma por guardar",buttons:[{text:"Cerrar"}]})).present(),null):o.toDataURL(p)}function E(){m(),o&&o.clear()}function m(){const p=Math.max(window.devicePixelRatio||1,1),k=i.clientWidth,y=i.clientHeight;if(!k||!y)return;const w=32767,B=Math.min(p,w/k,w/y);t(0,n.width=Math.floor(k*B),n),t(0,n.height=Math.floor(y*B),n);const S=n.getContext("2d");try{S.scale(B,B)}catch(z){console.warn("Canvas scale failed:",z)}}et(async()=>{await Ot(),m(),o=new pt(n,{backgroundColor:"rgba(255, 255, 255, 0)",penColor:"black"}),a=new ResizeObserver(m),a.observe(i)}),Mn(()=>{a&&a.disconnect()});function _(p){xe[p?"unshift":"push"](()=>{n=p,t(0,n)})}function v(p){xe[p?"unshift":"push"](()=>{i=p,t(1,i)})}return[n,i,s,h,E,_,v]}class Ei extends Ye{constructor(e){super(),Qe(this,e,bi,gi,Je,{clear:2,save:3,reset:4})}get clear(){return this.$$.ctx[2]}get save(){return this.$$.ctx[3]}get reset(){return this.$$.ctx[4]}}function xt(l,e,t){const n=l.slice();return n[58]=e[t],n[60]=t,n}function ki(l){let e,t,n,i,o;return{c(){e=d("ion-buttons"),t=d("ion-button"),n=Ie("Confirmar"),this.h()},l(a){e=f(a,"ION-BUTTONS",{slot:!0});var s=g(e);t=f(s,"ION-BUTTON",{strong:!0,disabled:!0});var h=g(t);n=Oe(h,"Confirmar"),h.forEach(u),s.forEach(u),this.h()},h(){b(t,"strong",""),b(t,"disabled",l[12].status=="completed"),b(e,"slot","end")},m(a,s){W(a,e,s),r(e,t),r(t,n),i||(o=he(t,"click",l[24]),i=!0)},p:Le,d(a){a&&u(e),i=!1,o()}}}function Ii(l){let e,t,n,i,o,a="Empresa",s,h,E=l[12].enterprise_name+"",m;return{c(){e=d("ion-item"),t=d("ion-icon"),n=N(),i=d("ion-label"),o=d("p"),o.textContent=a,s=N(),h=d("h2"),m=Ie(E),this.h()},l(_){e=f(_,"ION-ITEM",{});var v=g(e);t=f(v,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(u),n=T(v),i=f(v,"ION-LABEL",{});var p=g(i);o=f(p,"P",{"data-svelte-h":!0}),ie(o)!=="svelte-6noid3"&&(o.textContent=a),s=T(p),h=f(p,"H2",{});var k=g(h);m=Oe(k,E),k.forEach(u),p.forEach(u),v.forEach(u),this.h()},h(){b(t,"icon",wn),b(t,"slot","start")},m(_,v){W(_,e,v),r(e,t),r(e,n),r(e,i),r(i,o),r(i,s),r(i,h),r(h,m)},p:Le,d(_){_&&u(e)}}}function Oi(l){let e,t,n,i,o,a="Negocio",s,h,E=l[12].client_name+"",m;return{c(){e=d("ion-item"),t=d("ion-icon"),n=N(),i=d("ion-label"),o=d("p"),o.textContent=a,s=N(),h=d("h2"),m=Ie(E),this.h()},l(_){e=f(_,"ION-ITEM",{});var v=g(e);t=f(v,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(u),n=T(v),i=f(v,"ION-LABEL",{});var p=g(i);o=f(p,"P",{"data-svelte-h":!0}),ie(o)!=="svelte-57b1dg"&&(o.textContent=a),s=T(p),h=f(p,"H2",{});var k=g(h);m=Oe(k,E),k.forEach(u),p.forEach(u),v.forEach(u),this.h()},h(){b(t,"icon",wn),b(t,"slot","start")},m(_,v){W(_,e,v),r(e,t),r(e,n),r(e,i),r(i,o),r(i,s),r(i,h),r(h,m)},p:Le,d(_){_&&u(e)}}}function yi(l){let e,t,n,i,o,a="Teléfono de Negocio",s,h,E=l[12].client_phone+"",m;return{c(){e=d("ion-item"),t=d("ion-icon"),n=N(),i=d("ion-label"),o=d("p"),o.textContent=a,s=N(),h=d("h2"),m=Ie(E),this.h()},l(_){e=f(_,"ION-ITEM",{href:!0});var v=g(e);t=f(v,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(u),n=T(v),i=f(v,"ION-LABEL",{class:!0});var p=g(i);o=f(p,"P",{"data-svelte-h":!0}),ie(o)!=="svelte-1u5l7fz"&&(o.textContent=a),s=T(p),h=f(p,"H2",{});var k=g(h);m=Oe(k,E),k.forEach(u),p.forEach(u),v.forEach(u),this.h()},h(){b(t,"icon",xn),b(t,"slot","start"),b(i,"class","ion-text-wrap"),b(e,"href","tel:"+l[12].client_phone)},m(_,v){W(_,e,v),r(e,t),r(e,n),r(e,i),r(i,o),r(i,s),r(i,h),r(h,m)},p:Le,d(_){_&&u(e)}}}function wi(l){let e,t,n,i,o,a="Domicilio Alternativo",s,h,E=l[12].line2+"",m,_,v;return{c(){e=d("ion-item"),t=d("ion-icon"),n=N(),i=d("ion-label"),o=d("p"),o.textContent=a,s=N(),h=d("h2"),m=Ie(E),_=N(),v=d("ion-icon"),this.h()},l(p){e=f(p,"ION-ITEM",{href:!0});var k=g(e);t=f(k,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(u),n=T(k),i=f(k,"ION-LABEL",{class:!0});var y=g(i);o=f(y,"P",{"data-svelte-h":!0}),ie(o)!=="svelte-1ub9uzw"&&(o.textContent=a),s=T(y),h=f(y,"H2",{});var w=g(h);m=Oe(w,E),w.forEach(u),y.forEach(u),_=T(k),v=f(k,"ION-ICON",{icon:!0,slot:!0}),g(v).forEach(u),k.forEach(u),this.h()},h(){b(t,"icon",Tt),b(t,"slot","start"),b(i,"class","ion-text-wrap"),b(v,"icon",je),b(v,"slot","end"),b(e,"href","https://www.google.com/maps/searhc/?api=1&query="+l[12].line2)},m(p,k){W(p,e,k),r(e,t),r(e,n),r(e,i),r(i,o),r(i,s),r(i,h),r(h,m),r(e,_),r(e,v)},p:Le,d(p){p&&u(e)}}}function Ni(l){let e,t,n,i,o,a="Domicilio",s,h,E=l[12].line1+"",m,_,v,p,k=l[12].line2&&l[12].line2.trim().length,y,w=k&&Ti(l);return{c(){e=d("ion-item"),t=d("ion-icon"),n=N(),i=d("ion-label"),o=d("p"),o.textContent=a,s=N(),h=d("h2"),m=Ie(E),_=N(),v=d("ion-icon"),p=N(),w&&w.c(),y=Pe(),this.h()},l(B){e=f(B,"ION-ITEM",{href:!0});var S=g(e);t=f(S,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(u),n=T(S),i=f(S,"ION-LABEL",{class:!0});var z=g(i);o=f(z,"P",{"data-svelte-h":!0}),ie(o)!=="svelte-cbm7q1"&&(o.textContent=a),s=T(z),h=f(z,"H2",{});var H=g(h);m=Oe(H,E),H.forEach(u),z.forEach(u),_=T(S),v=f(S,"ION-ICON",{icon:!0,slot:!0}),g(v).forEach(u),S.forEach(u),p=T(B),w&&w.l(B),y=Pe(),this.h()},h(){b(t,"icon",Tt),b(t,"slot","start"),b(i,"class","ion-text-wrap"),b(v,"icon",je),b(v,"slot","end"),b(e,"href","https://www.google.com/maps/search/?api=1&query="+l[12].line1)},m(B,S){W(B,e,S),r(e,t),r(e,n),r(e,i),r(i,o),r(i,s),r(i,h),r(h,m),r(e,_),r(e,v),W(B,p,S),w&&w.m(B,S),W(B,y,S)},p(B,S){k&&w.p(B,S)},d(B){B&&(u(e),u(p),u(y)),w&&w.d(B)}}}function Ti(l){let e,t,n,i,o,a="Domicilio Alternativo",s,h,E=l[12].line2+"",m,_,v;return{c(){e=d("ion-item"),t=d("ion-icon"),n=N(),i=d("ion-label"),o=d("p"),o.textContent=a,s=N(),h=d("h2"),m=Ie(E),_=N(),v=d("ion-icon"),this.h()},l(p){e=f(p,"ION-ITEM",{href:!0});var k=g(e);t=f(k,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(u),n=T(k),i=f(k,"ION-LABEL",{class:!0});var y=g(i);o=f(y,"P",{"data-svelte-h":!0}),ie(o)!=="svelte-1ub9uzw"&&(o.textContent=a),s=T(y),h=f(y,"H2",{});var w=g(h);m=Oe(w,E),w.forEach(u),y.forEach(u),_=T(k),v=f(k,"ION-ICON",{icon:!0,slot:!0}),g(v).forEach(u),k.forEach(u),this.h()},h(){b(t,"icon",Tt),b(t,"slot","start"),b(i,"class","ion-text-wrap"),b(v,"icon",je),b(v,"slot","end"),b(e,"href","https://www.google.com/maps/search/?api=1&query="+l[12].line2)},m(p,k){W(p,e,k),r(e,t),r(e,n),r(e,i),r(i,o),r(i,s),r(i,h),r(h,m),r(e,_),r(e,v)},p:Le,d(p){p&&u(e)}}}function Ci(l){let e,t,n,i,o,a="Contacto del Cliente",s,h,E,m,_=l[16]&&l[16]==="1"&&Li(l);return{c(){e=d("ion-item"),t=d("ion-icon"),n=N(),i=d("ion-label"),o=d("p"),o.textContent=a,s=N(),h=d("h2"),E=Ie(l[18]),m=N(),_&&_.c(),this.h()},l(v){e=f(v,"ION-ITEM",{});var p=g(e);t=f(p,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(u),n=T(p),i=f(p,"ION-LABEL",{class:!0});var k=g(i);o=f(k,"P",{"data-svelte-h":!0}),ie(o)!=="svelte-1utsyb6"&&(o.textContent=a),s=T(k),h=f(k,"H2",{});var y=g(h);E=Oe(y,l[18]),y.forEach(u),k.forEach(u),m=T(p),_&&_.l(p),p.forEach(u),this.h()},h(){b(t,"icon",Bn),b(t,"slot","start"),b(i,"class","ion-text-wrap")},m(v,p){W(v,e,p),r(e,t),r(e,n),r(e,i),r(i,o),r(i,s),r(i,h),r(h,E),r(e,m),_&&_.m(e,null)},p(v,p){v[16]&&v[16]==="1"&&_.p(v,p)},d(v){v&&u(e),_&&_.d()}}}function Li(l){let e,t=`<ion-icon icon="${Fn}" slot="start"></ion-icon>
                        Notificar Cliente`,n,i;return{c(){e=d("ion-button"),e.innerHTML=t,this.h()},l(o){e=f(o,"ION-BUTTON",{fill:!0,style:!0,"data-svelte-h":!0}),ie(e)!=="svelte-149vhpt"&&(e.innerHTML=t),this.h()},h(){b(e,"fill","outline"),c(e,"margin-left","16px")},m(o,a){W(o,e,a),n||(i=he(e,"click",l[25]),n=!0)},p:Le,d(o){o&&u(e),n=!1,i()}}}function Mi(l){let e,t,n,i,o,a="Notas de ubicación",s,h,E;return{c(){e=d("ion-item"),t=d("ion-icon"),n=N(),i=d("ion-label"),o=d("p"),o.textContent=a,s=N(),h=d("h2"),E=Ie(l[19]),this.h()},l(m){e=f(m,"ION-ITEM",{});var _=g(e);t=f(_,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(u),n=T(_),i=f(_,"ION-LABEL",{class:!0});var v=g(i);o=f(v,"P",{"data-svelte-h":!0}),ie(o)!=="svelte-nhm2ft"&&(o.textContent=a),s=T(v),h=f(v,"H2",{});var p=g(h);E=Oe(p,l[19]),p.forEach(u),v.forEach(u),_.forEach(u),this.h()},h(){b(t,"icon",In),b(t,"slot","start"),b(i,"class","ion-text-wrap")},m(m,_){W(m,e,_),r(e,t),r(e,n),r(e,i),r(i,o),r(i,s),r(i,h),r(h,E)},p:Le,d(m){m&&u(e)}}}function Si(l){let e,t,n,i,o,a="Horarios",s,h,E=l[12].schedule+"",m;return{c(){e=d("ion-item"),t=d("ion-icon"),n=N(),i=d("ion-label"),o=d("p"),o.textContent=a,s=N(),h=d("h2"),m=Ie(E),this.h()},l(_){e=f(_,"ION-ITEM",{});var v=g(e);t=f(v,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(u),n=T(v),i=f(v,"ION-LABEL",{});var p=g(i);o=f(p,"P",{"data-svelte-h":!0}),ie(o)!=="svelte-11q7hm5"&&(o.textContent=a),s=T(p),h=f(p,"H2",{});var k=g(h);m=Oe(k,E),k.forEach(u),p.forEach(u),v.forEach(u),this.h()},h(){b(t,"icon",Un),b(t,"slot","start")},m(_,v){W(_,e,v),r(e,t),r(e,n),r(e,i),r(i,o),r(i,s),r(i,h),r(h,m)},p:Le,d(_){_&&u(e)}}}function Pi(l){let e,t,n,i,o,a="Notas del operador",s,h,E=l[12].driver_comments+"",m;return{c(){e=d("ion-item"),t=d("ion-icon"),n=N(),i=d("ion-label"),o=d("p"),o.textContent=a,s=N(),h=d("h2"),m=Ie(E),this.h()},l(_){e=f(_,"ION-ITEM",{});var v=g(e);t=f(v,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(u),n=T(v),i=f(v,"ION-LABEL",{});var p=g(i);o=f(p,"P",{"data-svelte-h":!0}),ie(o)!=="svelte-1yk9qp4"&&(o.textContent=a),s=T(p),h=f(p,"H2",{});var k=g(h);m=Oe(k,E),k.forEach(u),p.forEach(u),v.forEach(u),this.h()},h(){b(t,"icon",On),b(t,"slot","start")},m(_,v){W(_,e,v),r(e,t),r(e,n),r(e,i),r(i,o),r(i,s),r(i,h),r(h,m)},p:Le,d(_){_&&u(e)}}}function Ai(l){let e,t=l[12].logistic_comments!="<br>"&&Di(l);return{c(){t&&t.c(),e=Pe()},l(n){t&&t.l(n),e=Pe()},m(n,i){t&&t.m(n,i),W(n,e,i)},p(n,i){n[12].logistic_comments!="<br>"&&t.p(n,i)},d(n){n&&u(e),t&&t.d(n)}}}function Di(l){let e,t,n,i,o,a="Comentarios logísticos",s,h,E=l[12].logistic_comments+"",m;return{c(){e=d("ion-item"),t=d("ion-icon"),n=N(),i=d("ion-label"),o=d("p"),o.textContent=a,s=N(),h=d("h2"),m=Ie(E),this.h()},l(_){e=f(_,"ION-ITEM",{});var v=g(e);t=f(v,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(u),n=T(v),i=f(v,"ION-LABEL",{class:!0});var p=g(i);o=f(p,"P",{"data-svelte-h":!0}),ie(o)!=="svelte-1iz85r6"&&(o.textContent=a),s=T(p),h=f(p,"H2",{});var k=g(h);m=Oe(k,E),k.forEach(u),p.forEach(u),v.forEach(u),this.h()},h(){b(t,"icon",In),b(t,"slot","start"),b(i,"class","ion-text-wrap")},m(_,v){W(_,e,v),r(e,t),r(e,n),r(e,i),r(i,o),r(i,s),r(i,h),r(h,m)},p:Le,d(_){_&&u(e)}}}function xi(l){let e,t,n,i,o="<p>Etiqueta</p>",a,s,h=(l[12].tag?l[12].tag:"")+"",E;return{c(){e=d("ion-item"),t=d("ion-icon"),n=N(),i=d("ion-label"),i.innerHTML=o,a=N(),s=d("div"),E=Ie(h),this.h()},l(m){e=f(m,"ION-ITEM",{});var _=g(e);t=f(_,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(u),n=T(_),i=f(_,"ION-LABEL",{class:!0,"data-svelte-h":!0}),ie(i)!=="svelte-50rr6d"&&(i.innerHTML=o),a=T(_),s=f(_,"DIV",{class:!0,style:!0});var v=g(s);E=Oe(v,h),v.forEach(u),_.forEach(u),this.h()},h(){b(t,"icon",Hn),b(t,"slot","start"),b(i,"class","ion-text-wrap"),j(s,"class","stop-tag"),c(s,"background-color",l[20]),c(s,"border","1px solid "+l[21]),c(s,"color",l[12].tag_color),c(s,"font-size","14px"),c(s,"text-align","center"),c(s,"align-content","center"),c(s,"border-radius","20px"),c(s,"white-space","normal"),c(s,"padding","4px 8px"),c(s,"width","auto",1),c(s,"display","inline-block")},m(m,_){W(m,e,_),r(e,t),r(e,n),r(e,i),r(e,a),r(e,s),r(s,E)},p:Le,d(m){m&&u(e)}}}function Bi(l){let e,t,n,i,o="<p>Estado de entrega</p>",a,s,h,E="Entregado",m,_,v="No Entregado",p,k,y="Entrega Parcial",w,B,S,z,H,Q="<p>Notas</p>",G,L,R,x,I,A,F,M=l[12].status!=="completed"&&l[17]==="1"&&Ui(l),Y=l[5]===!0&&Bt(l),K=(l[6]===!0||l[6]===!1&&l[5]===!1)&&Ut(l);return{c(){e=d("ion-item"),t=d("ion-icon"),n=N(),i=d("ion-label"),i.innerHTML=o,a=N(),s=d("ion-select"),h=d("ion-select-option"),h.textContent=E,m=N(),_=d("ion-select-option"),_.textContent=v,p=N(),k=d("ion-select-option"),k.textContent=y,w=N(),B=d("ion-item"),S=d("ion-icon"),z=N(),H=d("ion-label"),H.innerHTML=Q,G=N(),L=d("ion-textarea"),R=N(),M&&M.c(),x=N(),I=d("section"),Y&&Y.c(),A=N(),K&&K.c(),this.h()},l(J){e=f(J,"ION-ITEM",{});var ne=g(e);t=f(ne,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(u),n=T(ne),i=f(ne,"ION-LABEL",{class:!0,"data-svelte-h":!0}),ie(i)!=="svelte-1ql9csq"&&(i.innerHTML=o),a=T(ne),s=f(ne,"ION-SELECT",{value:!0});var re=g(s);h=f(re,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),ie(h)!=="svelte-1nhq8vd"&&(h.textContent=E),m=T(re),_=f(re,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),ie(_)!=="svelte-dhd4r3"&&(_.textContent=v),p=T(re),k=f(re,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),ie(k)!=="svelte-17taxwo"&&(k.textContent=y),re.forEach(u),ne.forEach(u),w=T(J),B=f(J,"ION-ITEM",{});var D=g(B);S=f(D,"ION-ICON",{icon:!0,slot:!0}),g(S).forEach(u),z=T(D),H=f(D,"ION-LABEL",{class:!0,"data-svelte-h":!0}),ie(H)!=="svelte-c9yniu"&&(H.innerHTML=Q),G=T(D),L=f(D,"ION-TEXTAREA",{placeholder:!0}),g(L).forEach(u),D.forEach(u),R=T(J),M&&M.l(J),x=T(J),I=f(J,"SECTION",{style:!0});var le=g(I);Y&&Y.l(le),A=T(le),K&&K.l(le),le.forEach(u),this.h()},h(){b(t,"icon",Rn),b(t,"slot","start"),b(i,"class","ion-text-wrap"),b(h,"value","delivered"),b(_,"value","notdelivered"),b(k,"value","partialdeliver"),b(s,"value",l[15]?l[15]:"delivered"),b(S,"icon",ht),b(S,"slot","start"),b(H,"class","ion-text-wrap"),b(L,"placeholder","Escribe aquí..."),c(I,"display","flex"),c(I,"gap","8px"),c(I,"padding","16px 16px 6px")},m(J,ne){W(J,e,ne),r(e,t),r(e,n),r(e,i),r(e,a),r(e,s),r(s,h),r(s,m),r(s,_),r(s,p),r(s,k),l[34](s),W(J,w,ne),W(J,B,ne),r(B,S),r(B,z),r(B,H),r(B,G),r(B,L),l[35](L),W(J,R,ne),M&&M.m(J,ne),W(J,x,ne),W(J,I,ne),Y&&Y.m(I,null),r(I,A),K&&K.m(I,null),F=!0},p(J,ne){J[12].status!=="completed"&&J[17]==="1"&&M.p(J,ne),J[5]===!0?Y?Y.p(J,ne):(Y=Bt(J),Y.c(),Y.m(I,A)):Y&&(Y.d(1),Y=null),J[6]===!0||J[6]===!1&&J[5]===!1?K?K.p(J,ne):(K=Ut(J),K.c(),K.m(I,null)):K&&(K.d(1),K=null)},i(J){F||($e(M),F=!0)},o(J){ot(M),F=!1},d(J){J&&(u(e),u(w),u(B),u(R),u(x),u(I)),l[34](null),l[35](null),M&&M.d(J),Y&&Y.d(),K&&K.d()}}}function Ui(l){let e,t,n="<p>Firma de entregado</p>",i,o,a,s,h,E,m,_,v,p,k,y,w,B,S,z,H,Q,G={};return s=new Ei({props:G}),l[36](s),{c(){e=d("section"),t=d("ion-label"),t.innerHTML=n,i=N(),o=d("br"),a=N(),gn(s.$$.fragment),h=N(),E=d("section"),m=d("ion-button"),_=d("ion-icon"),v=Ie(`
                        Borrar`),k=N(),y=d("ion-button"),w=d("ion-icon"),B=Ie(`
                        Guardar`),this.h()},l(L){e=f(L,"SECTION",{style:!0});var R=g(e);t=f(R,"ION-LABEL",{class:!0,style:!0,"data-svelte-h":!0}),ie(t)!=="svelte-1lie3gz"&&(t.innerHTML=n),i=T(R),o=f(R,"BR",{}),a=T(R),bn(s.$$.fragment,R),R.forEach(u),h=T(L),E=f(L,"SECTION",{style:!0});var x=g(E);m=f(x,"ION-BUTTON",{style:!0,fill:!0,disabled:!0});var I=g(m);_=f(I,"ION-ICON",{icon:!0,slot:!0}),g(_).forEach(u),v=Oe(I,`
                        Borrar`),I.forEach(u),k=T(x),y=f(x,"ION-BUTTON",{style:!0,disabled:!0});var A=g(y);w=f(A,"ION-ICON",{icon:!0,slot:!0}),g(w).forEach(u),B=Oe(A,`
                        Guardar`),A.forEach(u),x.forEach(u),this.h()},h(){b(t,"class","ion-text-wrap"),c(t,"padding","10px 0px"),c(e,"display","flex"),c(e,"flex-direction","column"),c(e,"align-items","center"),c(e,"padding","0px 16px 16px"),b(_,"icon",vt),b(_,"slot","start"),c(m,"flex","1"),b(m,"fill","outline"),b(m,"disabled",p=l[11]||l[12].status=="completed"),b(w,"icon",zn),b(w,"slot","start"),c(y,"flex","1"),b(y,"disabled",S=l[11]||l[12].status=="completed"),c(E,"display","flex"),c(E,"gap","8px"),c(E,"padding","0px 16px")},m(L,R){W(L,e,R),r(e,t),r(e,i),r(e,o),r(e,a),En(s,e,null),W(L,h,R),W(L,E,R),r(E,m),r(m,_),r(m,v),r(E,k),r(E,y),r(y,w),r(y,B),z=!0,H||(Q=[he(m,"click",l[32]),he(y,"click",l[31])],H=!0)},p(L,R){const x={};s.$set(x),(!z||R[0]&2048&&p!==(p=L[11]||L[12].status=="completed"))&&b(m,"disabled",p),(!z||R[0]&2048&&S!==(S=L[11]||L[12].status=="completed"))&&b(y,"disabled",S)},i(L){z||($e(s.$$.fragment,L),z=!0)},o(L){ot(s.$$.fragment,L),z=!1},d(L){L&&(u(e),u(h),u(E)),l[36](null),kn(s),H=!1,He(Q)}}}function Bt(l){let e,t=`<ion-icon icon="${jn}" slot="start"></ion-icon>
                        Ingreso`,n,i;return{c(){e=d("ion-button"),e.innerHTML=t,this.h()},l(o){e=f(o,"ION-BUTTON",{id:!0,style:!0,"data-svelte-h":!0}),ie(e)!=="svelte-izs0s1"&&(e.innerHTML=t),this.h()},h(){b(e,"id","checkInBtn"),c(e,"flex","1")},m(o,a){W(o,e,a),n||(i=he(e,"click",l[26]),n=!0)},p:Le,d(o){o&&u(e),n=!1,i()}}}function Ut(l){let e,t,n,i,o,a;return{c(){e=d("ion-button"),t=d("ion-icon"),n=Ie(`
                        Salida`),this.h()},l(s){e=f(s,"ION-BUTTON",{id:!0,style:!0,disabled:!0});var h=g(e);t=f(h,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(u),n=Oe(h,`
                        Salida`),h.forEach(u),this.h()},h(){b(t,"icon",Vn),b(t,"slot","start"),b(e,"id","checkOutBtn"),c(e,"flex","1"),b(e,"disabled",i=l[6]===!1)},m(s,h){W(s,e,h),r(e,t),r(e,n),o||(a=he(e,"click",l[27]),o=!0)},p(s,h){h[0]&64&&i!==(i=s[6]===!1)&&b(e,"disabled",i)},d(s){s&&u(e),o=!1,a()}}}function Hi(l){let e,t,n,i,o,a,s,h;return{c(){e=d("section"),t=d("ion-button"),n=d("label"),i=d("ion-icon"),o=Ie(`
                        Subir Evidencia
                        `),a=d("input"),this.h()},l(E){e=f(E,"SECTION",{style:!0});var m=g(e);t=f(m,"ION-BUTTON",{fill:!0,class:!0,style:!0,disabled:!0});var _=g(t);n=f(_,"LABEL",{for:!0,style:!0});var v=g(n);i=f(v,"ION-ICON",{icon:!0,slot:!0,style:!0}),g(i).forEach(u),o=Oe(v,`
                        Subir Evidencia
                        `),a=f(v,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0,capture:!0}),v.forEach(u),_.forEach(u),m.forEach(u),this.h()},h(){b(i,"icon",Nt),b(i,"slot","start"),c(i,"vertical-align","middle"),c(a,"display","none"),j(a,"id","eventEvidence"),j(a,"name","fileToUpload"),j(a,"type","file"),a.multiple=!0,j(a,"accept","image/*"),j(a,"capture","environment"),j(n,"for","eventEvidence"),c(n,"width","100%"),c(n,"height","100%"),b(t,"fill","outline"),b(t,"class","loadEvidence"),c(t,"flex","1"),c(t,"display","flex"),c(t,"align-items","center"),c(t,"gap","8px"),b(t,"disabled",l[12].status=="completed"),c(e,"display","flex"),c(e,"gap","8px"),c(e,"padding","0px 16px")},m(E,m){W(E,e,m),r(e,t),r(t,n),r(n,i),r(n,o),r(n,a),s||(h=[he(a,"change",l[22]),he(a,"click",l[23])],s=!0)},p:Le,d(E){E&&u(e),s=!1,He(h)}}}function Ht(l){let e,t,n=Re(l[3]),i=[];for(let o=0;o<n.length;o+=1)i[o]=Rt(xt(l,n,o));return{c(){e=d("section"),t=d("div");for(let o=0;o<i.length;o+=1)i[o].c();this.h()},l(o){e=f(o,"SECTION",{});var a=g(e);t=f(a,"DIV",{class:!0,style:!0});var s=g(t);for(let h=0;h<i.length;h+=1)i[h].l(s);s.forEach(u),a.forEach(u),this.h()},h(){j(t,"class","image-grid"),c(t,"display","grid"),c(t,"grid-template-columns","repeat(auto-fill, minmax(100px, 1fr))"),c(t,"gap","10px"),c(t,"padding","0px 10px")},m(o,a){W(o,e,a),r(e,t);for(let s=0;s<i.length;s+=1)i[s]&&i[s].m(t,null)},p(o,a){if(a[0]&1342181384){n=Re(o[3]);let s;for(s=0;s<n.length;s+=1){const h=xt(o,n,s);i[s]?i[s].p(h,a):(i[s]=Rt(h),i[s].c(),i[s].m(t,null))}for(;s<i.length;s+=1)i[s].d(1);i.length=n.length}},d(o){o&&u(e),mt(i,o)}}}function Ri(l){let e,t=`<ion-icon icon="${vt}"></ion-icon>`,n,i;function o(){return l[38](l[60])}return{c(){e=d("button"),e.innerHTML=t,this.h()},l(a){e=f(a,"BUTTON",{class:!0,style:!0,"data-svelte-h":!0}),ie(e)!=="svelte-mf38w5"&&(e.innerHTML=t),this.h()},h(){j(e,"class","remove-button"),c(e,"position","absolute"),c(e,"top","5px"),c(e,"right","5px"),c(e,"border","none"),c(e,"cursor","pointer"),c(e,"font-size","18px"),c(e,"background","white"),c(e,"border-radius","50%"),c(e,"padding","3px 4px 0px"),c(e,"box-shadow","2px 2px 6px rgba(0, 0, 0, 0.3)"),c(e,"color","#0000008f")},m(a,s){W(a,e,s),n||(i=he(e,"click",o),n=!0)},p(a,s){l=a},d(a){a&&u(e),n=!1,i()}}}function Rt(l){let e,t,n,i,o,a,s;function h(){return l[37](l[58])}let E=l[12].status!=="completed"&&Ri(l);return{c(){e=d("div"),t=d("ion-img"),i=N(),E&&E.c(),o=N(),this.h()},l(m){e=f(m,"DIV",{class:!0,style:!0});var _=g(e);t=f(_,"ION-IMG",{src:!0,alt:!0,style:!0}),g(t).forEach(u),i=T(_),E&&E.l(_),o=T(_),_.forEach(u),this.h()},h(){Fe(t.src,n=l[58])||b(t,"src",n),b(t,"alt","Evidencia fotográfica"),c(t,"width","100%"),c(t,"height","100px"),c(t,"object-fit","cover"),c(t,"cursor","pointer"),c(t,"border","1px solid #ccc"),c(t,"border-radius","4px"),c(t,"margin-top","16px"),j(e,"class","image-container"),c(e,"position","relative")},m(m,_){W(m,e,_),r(e,t),r(e,i),E&&E.m(e,null),r(e,o),a||(s=he(t,"click",h),a=!0)},p(m,_){l=m,_[0]&8&&!Fe(t.src,n=l[58])&&b(t,"src",n),l[12].status!=="completed"&&E.p(l,_)},d(m){m&&u(e),E&&E.d(),a=!1,s()}}}function zt(l){let e,t='<ion-spinner name="dots" style="color:white;"></ion-spinner>';return{c(){e=d("div"),e.innerHTML=t,this.h()},l(n){e=f(n,"DIV",{class:!0,style:!0,"data-svelte-h":!0}),ie(e)!=="svelte-1aosxw0"&&(e.innerHTML=t),this.h()},h(){j(e,"class","overlay"),c(e,"position","fixed"),c(e,"top","0"),c(e,"left","0"),c(e,"width","100vw"),c(e,"height","100vh"),c(e,"background","rgba(0, 0, 0, 0.5)"),c(e,"display","flex"),c(e,"align-items","center"),c(e,"justify-content","center"),c(e,"z-index","9999")},m(n,i){W(n,e,i)},d(n){n&&u(e)}}}function Vt(l){let e,t,n,i,o,a,s=`<ion-icon icon="${Ct}"></ion-icon>`,h,E;return{c(){e=d("div"),t=d("div"),n=d("ion-img"),o=N(),a=d("button"),a.innerHTML=s,this.h()},l(m){e=f(m,"DIV",{class:!0,style:!0});var _=g(e);t=f(_,"DIV",{class:!0,style:!0});var v=g(t);n=f(v,"ION-IMG",{src:!0,alt:!0,style:!0}),g(n).forEach(u),o=T(v),a=f(v,"BUTTON",{class:!0,style:!0,"data-svelte-h":!0}),ie(a)!=="svelte-183t4ti"&&(a.innerHTML=s),v.forEach(u),_.forEach(u),this.h()},h(){Fe(n.src,i=l[8])||b(n,"src",i),b(n,"alt","Evidencia fotográfica"),c(n,"width","100%"),c(n,"height","auto"),j(a,"class","close-button"),c(a,"position","absolute"),c(a,"top","5px"),c(a,"right","5px"),c(a,"background","white"),c(a,"color","#444444d1"),c(a,"border","none"),c(a,"cursor","pointer"),c(a,"padding","2px 2px 0px 6px"),c(a,"border-radius","50%"),c(a,"font-size","20px"),j(t,"class","modal-content"),c(t,"position","relative"),c(t,"background","white"),c(t,"padding","20px"),c(t,"border-radius","8px"),c(t,"max-width","90vw"),c(t,"max-height","90vh"),c(t,"overflow","auto"),j(e,"class","modal-overlay"),c(e,"position","fixed"),c(e,"top","0"),c(e,"left","0"),c(e,"width","100vw"),c(e,"height","100vh"),c(e,"background","rgba(0, 0, 0, 0.8)"),c(e,"display","flex"),c(e,"justify-content","center"),c(e,"align-items","center"),c(e,"z-index","1000")},m(m,_){W(m,e,_),r(e,t),r(t,n),r(t,o),r(t,a),h||(E=[he(a,"click",l[29]),he(t,"click",yt(l[33])),he(e,"click",l[29])],h=!0)},p(m,_){_[0]&256&&!Fe(n.src,i=m[8])&&b(n,"src",i)},d(m){m&&u(e),h=!1,He(E)}}}function zi(l){let e,t,n,i,o="Cerrar",a,s,h=l[12].title+"",E,m,_,v,p,k,y=l[12].client_phone&&l[12].client_phone.trim().length,w,B,S,z,H=l[12].schedule&&l[12].schedule.trim().length,Q,G,L=l[12].logistic_comments&&l[12].logistic_comments.trim().length,R,x,I,A,F,M,Y,K,J,ne,re=(!l[13]&&!l[14]||l[13]&&l[14])&&ki(l);function D(X,ge){return X[12].client_name!=null?Oi:Ii}let pe=D(l)(l),ue=y&&yi(l);function fe(X,ge){if(X[12].line1&&X[12].line1.trim().length)return Ni;if(X[12].line2&&X[12].line2.trim().length)return wi}let ae=fe(l),se=ae&&ae(l),ce=l[18]&&Ci(l),oe=l[19]&&l[19]!=="<br>"&&Mi(l),ee=H&&Si(l),Ee=l[12].driver_comments&&Pi(l),ve=L&&Ai(l),ke=l[12].tag&&l[12].tag_color&&xi(l),de=!l[14]&&Bi(l),_e=(l[13]&&l[14]||!l[13]&&!l[14])&&Hi(l),$=l[2]&&Ht(l),Z=l[4]&&zt(),te=l[7]&&Vt(l);return{c(){e=d("ion-header"),t=d("ion-toolbar"),n=d("ion-buttons"),i=d("ion-button"),i.textContent=o,a=N(),s=d("ion-title"),E=Ie(h),m=N(),re&&re.c(),_=N(),v=d("ion-content"),p=d("ion-list"),pe.c(),k=N(),ue&&ue.c(),w=N(),se&&se.c(),B=N(),ce&&ce.c(),S=N(),oe&&oe.c(),z=N(),ee&&ee.c(),Q=N(),Ee&&Ee.c(),G=N(),ve&&ve.c(),R=N(),ke&&ke.c(),x=N(),de&&de.c(),I=N(),_e&&_e.c(),A=N(),$&&$.c(),F=N(),Z&&Z.c(),M=N(),te&&te.c(),Y=Pe(),this.h()},l(X){e=f(X,"ION-HEADER",{translucent:!0});var ge=g(e);t=f(ge,"ION-TOOLBAR",{});var Me=g(t);n=f(Me,"ION-BUTTONS",{slot:!0});var Ce=g(n);i=f(Ce,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),ie(i)!=="svelte-2ks32x"&&(i.textContent=o),Ce.forEach(u),a=T(Me),s=f(Me,"ION-TITLE",{style:!0,title:!0});var Ne=g(s);E=Oe(Ne,h),Ne.forEach(u),m=T(Me),re&&re.l(Me),Me.forEach(u),ge.forEach(u),_=T(X),v=f(X,"ION-CONTENT",{fullscreen:!0});var Ae=g(v);p=f(Ae,"ION-LIST",{});var O=g(p);pe.l(O),k=T(O),ue&&ue.l(O),w=T(O),se&&se.l(O),B=T(O),ce&&ce.l(O),S=T(O),oe&&oe.l(O),z=T(O),ee&&ee.l(O),Q=T(O),Ee&&Ee.l(O),G=T(O),ve&&ve.l(O),R=T(O),ke&&ke.l(O),x=T(O),de&&de.l(O),I=T(O),_e&&_e.l(O),A=T(O),$&&$.l(O),O.forEach(u),Ae.forEach(u),F=T(X),Z&&Z.l(X),M=T(X),te&&te.l(X),Y=Pe(),this.h()},h(){b(i,"color","medium"),b(n,"slot","start"),c(s,"text-align","center"),b(s,"title",l[12].title),b(e,"translucent",""),b(v,"fullscreen","")},m(X,ge){W(X,e,ge),r(e,t),r(t,n),r(n,i),r(t,a),r(t,s),r(s,E),r(t,m),re&&re.m(t,null),W(X,_,ge),W(X,v,ge),r(v,p),pe.m(p,null),r(p,k),ue&&ue.m(p,null),r(p,w),se&&se.m(p,null),r(p,B),ce&&ce.m(p,null),r(p,S),oe&&oe.m(p,null),r(p,z),ee&&ee.m(p,null),r(p,Q),Ee&&Ee.m(p,null),r(p,G),ve&&ve.m(p,null),r(p,R),ke&&ke.m(p,null),r(p,x),de&&de.m(p,null),r(p,I),_e&&_e.m(p,null),r(p,A),$&&$.m(p,null),W(X,F,ge),Z&&Z.m(X,ge),W(X,M,ge),te&&te.m(X,ge),W(X,Y,ge),K=!0,J||(ne=he(i,"click",l[0]),J=!0)},p(X,ge){(!X[13]&&!X[14]||X[13]&&X[14])&&re.p(X,ge),pe.p(X,ge),y&&ue.p(X,ge),se&&se.p(X,ge),X[18]&&ce.p(X,ge),X[19]&&X[19]!=="<br>"&&oe.p(X,ge),H&&ee.p(X,ge),X[12].driver_comments&&Ee.p(X,ge),L&&ve.p(X,ge),X[12].tag&&X[12].tag_color&&ke.p(X,ge),X[14]||de.p(X,ge),(X[13]&&X[14]||!X[13]&&!X[14])&&_e.p(X,ge),X[2]?$?$.p(X,ge):($=Ht(X),$.c(),$.m(p,null)):$&&($.d(1),$=null),X[4]?Z||(Z=zt(),Z.c(),Z.m(M.parentNode,M)):Z&&(Z.d(1),Z=null),X[7]?te?te.p(X,ge):(te=Vt(X),te.c(),te.m(Y.parentNode,Y)):te&&(te.d(1),te=null)},i(X){K||($e(de),K=!0)},o(X){ot(de),K=!1},d(X){X&&(u(e),u(_),u(v),u(F),u(M),u(Y)),re&&re.d(),pe.d(),ue&&ue.d(),se&&se.d(),ce&&ce.d(),oe&&oe.d(),ee&&ee.d(),Ee&&Ee.d(),ve&&ve.d(),ke&&ke.d(),de&&de.d(),_e&&_e.d(),$&&$.d(),Z&&Z.d(X),te&&te.d(X),J=!1,ne()}}}function Vi(l){const[e,t]=l.split(","),n=e.match(/:(.*?);/)[1],i=atob(t),o=i.length,a=new Uint8Array(o);for(let s=0;s<o;s++)a[s]=i.charCodeAt(s);return new Blob([a],{type:n})}function Fi(l,e,t){let n=ct,i=document.querySelector("ion-modal"),o=i.componentProps.delivery,a=i.componentProps.isLast||!1,s=i.componentProps.flag||!1,h=o.driver_comments?o.driver_comments:"",E=o.deliver_status?o.deliver_status:"",m=o.img?o.img:"",_=o.img_id?o.img_id:"",v=m?Ke(m):new Array,p=_?Ke(_):new Array,k={latitude:null,longitude:null},y=o.stopsApproval,w=o.smsActive,B=o.signatureActive,S=!1,z=!0,H=!1,Q=o.phone_notification,G=o.comments_ext,L=!1,R="",x=new Object,I="",A=o.tag_color?ze(o.tag_color,.2):"",F=o.tag_color?ze(o.tag_color,.3):"",M,Y=!1;et(()=>{x=JSON.parse(localStorage.getItem("userSession")),K()});function K(){o.date_service?o.date_service&&!o.date_completed&&!o.service_time?(t(5,z=!1),t(6,H=!0)):o.date_service&&o.date_completed&&o.service_time&&(t(5,z=!1),t(6,H=!1)):(t(5,z=!0),t(6,H=!1))}const J=async(C,P)=>{await(await Ge.create({header:C||"Error",message:P||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()},ne=async(C="",P="",U="",q=function(we={}){},me={})=>{await(await Ge.create({header:C||"Error",message:P||"Vuelva a intentar",buttons:[{text:"No",role:"cancel",handler:()=>{}},{text:"Sí",handler:()=>{t(4,S=!0),Ve(U,function(Te={}){t(4,S=!1),q(Te)},me)}}]})).present()};async function re(C,P){await(await Ge.create({header:"¿Cómo quieres notificar?",message:`Elige el medio para enviar mensaje a ${C.title} (${P})`,buttons:[{text:"SMS",handler:()=>oe("sms",C,P)},{text:"WhatsApp",handler:()=>oe("whatsapp",C,P)}]})).present()}const D=async C=>{if(v.length>=5){J("Límite de evidencias","Solo se permite subir 5 fotos por parada");return}if(s&&a&&v.length>=1){J("Límite de evidencias","Para el final de la ruta solo se permite subir 1 foto");return}const U=C.target.files[0];if(U)try{t(4,S=!0);const q=await ue(U);q&&Ve(`${n}api/admin/manager/upload_img_driver.php`,function(me){me.success?(t(2,m=m?`${m},${me.img}`:me.img),_=_?`${_},${me.img_id}`:me.img_id,t(3,v=Ke(m)),p=Ke(_)):J("Carga fallida","Actualiza la página y vuelve a intentar. Si el problema persiste, contacta a soporte.")},{fileToUpload:q})}catch(q){console.error("Compression error:",q)}finally{t(4,S=!1)}};function le(C){var P=o.service_time;!P&&z&&!a&&!s&&(C.preventDefault(),J("Registrar Ingreso","Antes de subir la evidencia registra el ingreso a la actual parada."))}function pe(){var C=s?o.date_completed:!1;if(!C&&!z&&H&&!a&&!s){var P=new Object;P.id_event=o.id_event,P.type="checkout",P.id_user_over=x.id_user,P.token=x.token,ne("Registrar Salida","¿Completaste tu entrega?",n+"api/admin/route/record_check_date.php",function(U){U.minutes&&J("Tiempo por parada","Completaste la parada en "+U.minutes+" minutos.")},P)}}const ue=async C=>new Promise(P=>{const U=new Image;U.src=URL.createObjectURL(C),U.onload=()=>{const q=document.createElement("canvas"),me=q.getContext("2d"),we=800,Te=600;let ye=U.width,be=U.height;ye>we&&(be*=we/ye,ye=we),be>Te&&(ye*=Te/be,be=Te),q.width=ye,q.height=be,me.drawImage(U,0,0,ye,be),q.toBlob(De=>{P(De),URL.revokeObjectURL(U.src),me.clearRect(0,0,q.width,q.height)},"image/jpeg",.7)}});async function fe(){try{if(i!=null&&i.isConnected){await i.dismiss({data:Date.now()});return}const C=await tt.getTop();C&&await C.dismiss({data:Date.now()})}catch{console.warn("Close Modal Safe: modal ya cerrado o inexistente")}}const ae=async()=>{if(!S){t(4,S=!0);try{if(t(2,m=v.join(",")),_=p.join(","),pe(),await ce())if(I.value=="delivered"||I.value!=="delivered"&&(h.value||o.driver_comments)||s&&a){const P={id_route:o.id_route,...!s&&!a&&{id_event:o.id_event},...!s&&!a&&{comments:h.value},...!s&&!a&&{deliver_status:I.value},img:m,img_id:_,lat:k.latitude,lon:k.longitude,...y==="0"&&{approve:"0"},...a&&{isLast:!0},...s&&a&&{destiny:!0},id_user_over:x.id_user,token:x.token};P.img&&P.img_id||m?Ve(`${n}api/admin/evidence/send_evidence.php`,function(U){if(U.success==!0){fe();const q=P.id_route;a&&(se("","",q,a),y=="0"&&Z(q,"completed"))}else t(4,S=!1),J("Carga fallida","Actualiza la página y vuelve a intentar cargar la información!")},P):J("Información incompleta","Cargar evidencia fotográfica faltante para completar parada.")}else J("Motivo de status de entrega","Favor de ingresar en notas el motivo por el que la entrega no fue entregada correctamente");else J("Ubicación faltante","Asegúrate darle permisos a Rutaflow para acceder a tu ubicación")}catch(C){console.error("Error fetching data:",C)}finally{t(4,S=!1)}}},se=(C,P,U,q)=>{i.componentProps.routeId=U,i.componentProps.driverId=o.id_driver,qe("modal-km-gas",Tn,{checklist:C,driverId:P,routeId:U,isLast:q}).then(me=>{})},ce=async()=>navigator.geolocation?new Promise((C,P)=>{navigator.geolocation.getCurrentPosition(U=>{k.latitude=U.coords.latitude,k.longitude=U.coords.longitude,C(!0)},U=>{console.error("Error getting location:",U),C(!1)})}):(console.error("Geolocation is not supported by your browser"),!1);async function oe(C,P,U){const q={};if(C==="sms"){q.id_user_over=x.id_user,q.token=x.token,q.client_phone=U,q.client_name=P.title,q.delivery_phone=P.client_phone,q.enterprise_name=P.enterprise_name,Ve(`${n}api/admin/message_central/send_sms.php`,ee("SMS",P.title,U),q);return}try{var me=P.client_phone?`
Si deseas contactarnos, entra al siguiente link: https://wa.me/${P.client_phone}.`:".";q.text=`*Rutaflow*

El repartidor va en camino a tu domicilio ${P.title}${me}

Enviado por _${P.enterprise_name}_`,q.phone=U;const Te=await(await fetch(`${Qn}`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`${Zn}`},body:JSON.stringify(q)})).json();ee("WHATSAPP",P.title,U)(Te)}catch(we){console.error(we),J("WHATSAPP no enviado","Ocurrió un error de red.")}}function ee(C,P,U){return q=>{q.success?J(`${C} enviado`,`Se envió correctamente un ${C} a ${P} con número ${U}.`):J(`${C} no enviado`,`Hubo un error al enviar ${C} a ${P} (${U}).`)}}function Ee(C){C.stopPropagation(),re(o,Q)}function ve(){t(5,z=!1),t(6,H=!0),de(o.id_event,"checkin")}function ke(){t(6,H=!1),t(5,z=!1),de(o.id_event,"checkout")}async function de(C,P){if(P){let U=new Object;U.type=P,U.id_event=C,U.id_user_over=x.id_user,U.token=x.token;try{Ve(`${n}api/admin/route/record_check_date.php`,function(q){q.minutes&&J("Tiempo por parada","Completaste la parada en "+q.minutes+" minutos.")},U)}catch(q){console.error("Error during file upload:",q)}finally{}}}const _e=C=>{t(8,R=C),t(7,L=!0)},$=()=>{t(7,L=!1),t(8,R="")};function Z(C,P){let U=new Object;return U.id_route=C,U.status=P,U.id_user_over=x.id_user,U.token=x.token,Ve(`${n}api/admin/route/change_status.php`,function(){},U),""}function te(C=0){var P=yn(C,v,p,m);t(3,v=P.files),p=P.img_ids,t(2,m=P.selectedImages)}async function X(){const C=await M.save();if(C){t(11,Y=!0);let P=Vi(C);Ve(`${n}api/admin/manager/upload_img_driver.php`,function(U){U.success?(t(2,m=m?`${m},${U.img}`:U.img),_=_?`${_},${U.img_id}`:U.img_id,t(3,v=Ke(m)),p=Ke(_)):J("Carga fallida","Actualiza la página y vuelve a intentar. Si el problema persiste, contacta a soporte.")},{fileToUpload:P})}}function ge(){M.clear()}function Me(C){wt.call(this,l,C)}function Ce(C){xe[C?"unshift":"push"](()=>{I=C,t(9,I)})}function Ne(C){xe[C?"unshift":"push"](()=>{h=C,t(1,h)})}function Ae(C){xe[C?"unshift":"push"](()=>{M=C,t(10,M)})}return[fe,h,m,v,S,z,H,L,R,I,M,Y,o,a,s,E,w,B,Q,G,A,F,D,le,ae,Ee,ve,ke,_e,$,te,X,ge,Me,Ce,Ne,Ae,C=>_e(C),C=>te(C)]}class Ft extends Ye{constructor(e){super(),Qe(this,e,Fi,zi,Je,{closeModal:0},null,[-1,-1])}get closeModal(){return this.$$.ctx[0]}}function jt(l,e,t){const n=l.slice();return n[32]=e[t],n[34]=t,n}function Wt(l){let e,t,n=Re(l[1]),i=[];for(let o=0;o<n.length;o+=1)i[o]=qt(jt(l,n,o));return{c(){e=d("section"),t=d("div");for(let o=0;o<i.length;o+=1)i[o].c();this.h()},l(o){e=f(o,"SECTION",{});var a=g(e);t=f(a,"DIV",{class:!0,style:!0});var s=g(t);for(let h=0;h<i.length;h+=1)i[h].l(s);s.forEach(u),a.forEach(u),this.h()},h(){j(t,"class","image-grid"),c(t,"display","grid"),c(t,"grid-template-columns","repeat(auto-fill, minmax(100px, 1fr))"),c(t,"gap","10px"),c(t,"padding","0px 10px")},m(o,a){W(o,e,a),r(e,t);for(let s=0;s<i.length;s+=1)i[s]&&i[s].m(t,null)},p(o,a){if(a[0]&32770){n=Re(o[1]);let s;for(s=0;s<n.length;s+=1){const h=jt(o,n,s);i[s]?i[s].p(h,a):(i[s]=qt(h),i[s].c(),i[s].m(t,null))}for(;s<i.length;s+=1)i[s].d(1);i.length=n.length}},d(o){o&&u(e),mt(i,o)}}}function qt(l){let e,t,n,i,o,a=`<ion-icon icon="${vt}"></ion-icon>`,s,h,E;function m(){return l[22](l[32])}function _(){return l[23](l[34])}return{c(){e=d("div"),t=d("ion-img"),i=N(),o=d("button"),o.innerHTML=a,s=N(),this.h()},l(v){e=f(v,"DIV",{class:!0,style:!0});var p=g(e);t=f(p,"ION-IMG",{src:!0,alt:!0,style:!0}),g(t).forEach(u),i=T(p),o=f(p,"BUTTON",{class:!0,style:!0,"data-svelte-h":!0}),ie(o)!=="svelte-zguiov"&&(o.innerHTML=a),s=T(p),p.forEach(u),this.h()},h(){Fe(t.src,n=l[32])||b(t,"src",n),b(t,"alt","Evidencia fotográfica"),c(t,"width","100%"),c(t,"height","100px"),c(t,"object-fit","cover"),c(t,"cursor","pointer"),c(t,"border","1px solid #ccc"),c(t,"border-radius","4px"),c(t,"margin-top","16px"),j(o,"class","remove-button"),c(o,"position","absolute"),c(o,"top","5px"),c(o,"right","5px"),c(o,"border","none"),c(o,"cursor","pointer"),c(o,"font-size","18px"),c(o,"background","white"),c(o,"border-radius","50%"),c(o,"padding","3px 4px 0px"),c(o,"box-shadow","2px 2px 6px rgba(0, 0, 0, 0.3)"),c(o,"color","#0000008f"),j(e,"class","image-container"),c(e,"position","relative")},m(v,p){W(v,e,p),r(e,t),r(e,i),r(e,o),r(e,s),h||(E=[he(t,"click",m),he(o,"click",_)],h=!0)},p(v,p){l=v,p[0]&2&&!Fe(t.src,n=l[32])&&b(t,"src",n)},d(v){v&&u(e),h=!1,He(E)}}}function Gt(l){let e,t='<ion-spinner name="dots" style="color:white;"></ion-spinner>';return{c(){e=d("div"),e.innerHTML=t,this.h()},l(n){e=f(n,"DIV",{class:!0,style:!0,"data-svelte-h":!0}),ie(e)!=="svelte-h8s7r2"&&(e.innerHTML=t),this.h()},h(){j(e,"class","overlay"),c(e,"position","fixed"),c(e,"top","0"),c(e,"left","0"),c(e,"width","100vw"),c(e,"height","100vh"),c(e,"background","rgba(0, 0, 0, 0.5)"),c(e,"display","flex"),c(e,"align-items","center"),c(e,"justify-content","center"),c(e,"z-index","9999")},m(n,i){W(n,e,i)},d(n){n&&u(e)}}}function Kt(l){let e,t,n,i,o,a,s=`<ion-icon icon="${Ct}"></ion-icon>`,h,E;return{c(){e=d("div"),t=d("div"),n=d("ion-img"),o=N(),a=d("button"),a.innerHTML=s,this.h()},l(m){e=f(m,"DIV",{class:!0,style:!0});var _=g(e);t=f(_,"DIV",{class:!0,style:!0});var v=g(t);n=f(v,"ION-IMG",{src:!0,alt:!0,style:!0}),g(n).forEach(u),o=T(v),a=f(v,"BUTTON",{class:!0,style:!0,"data-svelte-h":!0}),ie(a)!=="svelte-g0qr0o"&&(a.innerHTML=s),v.forEach(u),_.forEach(u),this.h()},h(){Fe(n.src,i=l[8])||b(n,"src",i),b(n,"alt","Evidencia fotográfica"),c(n,"width","100%"),c(n,"height","auto"),j(a,"class","close-button"),c(a,"position","absolute"),c(a,"top","5px"),c(a,"right","5px"),c(a,"background","white"),c(a,"color","#444444d1"),c(a,"border","none"),c(a,"cursor","pointer"),c(a,"padding","2px 2px 0px 6px"),c(a,"border-radius","50%"),c(a,"font-size","20px"),j(t,"class","modal-content"),c(t,"position","relative"),c(t,"background","white"),c(t,"padding","20px"),c(t,"border-radius","8px"),c(t,"max-width","90vw"),c(t,"max-height","90vh"),c(t,"overflow","auto"),j(e,"class","modal-overlay"),c(e,"position","fixed"),c(e,"top","0"),c(e,"left","0"),c(e,"width","100vw"),c(e,"height","100vh"),c(e,"background","rgba(0, 0, 0, 0.8)"),c(e,"display","flex"),c(e,"justify-content","center"),c(e,"align-items","center"),c(e,"z-index","1000")},m(m,_){W(m,e,_),r(e,t),r(t,n),r(t,o),r(t,a),h||(E=[he(a,"click",l[16]),he(t,"click",yt(l[17])),he(e,"click",l[16])],h=!0)},p(m,_){_[0]&256&&!Fe(n.src,i=m[8])&&b(n,"src",i)},d(m){m&&u(e),h=!1,He(E)}}}function ji(l){let e,t,n,i,o="Cancelar",a,s,h="AGREGAR GASTO",E,m,_,v="Confirmar",p,k,y,w,B,S,z,H,Q,G,L,R,x,I,A,F,M,Y,K='Tipo de pago <ion-text color="danger">(Obligatorio)</ion-text>',J,ne,re="Efectivo",D,le,pe="Tarjeta",ue,fe,ae="Transferencia",se,ce,oe,ee,Ee,ve,ke,de,_e,$,Z=`<ion-icon icon="${Nt}" slot="start"></ion-icon>
                        Subir Evidencia`,te,X,ge,Me,Ce,Ne,Ae,O,V=l[0]&&Wt(l),C=l[6]&&Gt(),P=l[7]&&Kt(l);return{c(){e=d("ion-header"),t=d("ion-toolbar"),n=d("ion-buttons"),i=d("ion-button"),i.textContent=o,a=N(),s=d("ion-title"),s.textContent=h,E=N(),m=d("ion-buttons"),_=d("ion-button"),_.textContent=v,p=N(),k=d("ion-content"),y=d("ion-list"),w=d("ion-item"),B=d("ion-icon"),S=N(),z=d("ion-input"),H=N(),Q=d("ion-item"),G=d("ion-icon"),L=N(),R=d("ion-input"),x=N(),I=d("ion-item"),A=d("ion-icon"),F=N(),M=d("ion-select"),Y=d("div"),Y.innerHTML=K,J=N(),ne=d("ion-select-option"),ne.textContent=re,D=N(),le=d("ion-select-option"),le.textContent=pe,ue=N(),fe=d("ion-select-option"),fe.textContent=ae,se=N(),ce=d("ion-item"),oe=d("ion-icon"),ee=N(),Ee=d("ion-textarea"),ve=N(),ke=d("section"),de=d("label"),_e=d("ion-button"),$=d("label"),$.innerHTML=Z,te=N(),X=d("input"),ge=N(),V&&V.c(),Me=N(),C&&C.c(),Ce=N(),P&&P.c(),Ne=Pe(),this.h()},l(U){e=f(U,"ION-HEADER",{translucent:!0});var q=g(e);t=f(q,"ION-TOOLBAR",{});var me=g(t);n=f(me,"ION-BUTTONS",{slot:!0});var we=g(n);i=f(we,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),ie(i)!=="svelte-1f8rjcf"&&(i.textContent=o),we.forEach(u),a=T(me),s=f(me,"ION-TITLE",{title:!0,"data-svelte-h":!0}),ie(s)!=="svelte-efps2s"&&(s.textContent=h),E=T(me),m=f(me,"ION-BUTTONS",{slot:!0});var Te=g(m);_=f(Te,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),ie(_)!=="svelte-k5zoz0"&&(_.textContent=v),Te.forEach(u),me.forEach(u),q.forEach(u),p=T(U),k=f(U,"ION-CONTENT",{fullscreen:!0});var ye=g(k);y=f(ye,"ION-LIST",{});var be=g(y);w=f(be,"ION-ITEM",{});var De=g(w);B=f(De,"ION-ICON",{icon:!0,slot:!0}),g(B).forEach(u),S=T(De),z=f(De,"ION-INPUT",{label:!0,type:!0,placeholder:!0,value:!0}),g(z).forEach(u),De.forEach(u),H=T(be),Q=f(be,"ION-ITEM",{});var We=g(Q);G=f(We,"ION-ICON",{icon:!0,slot:!0}),g(G).forEach(u),L=T(We),R=f(We,"ION-INPUT",{label:!0,type:!0,value:!0}),g(R).forEach(u),We.forEach(u),x=T(be),I=f(be,"ION-ITEM",{});var nt=g(I);A=f(nt,"ION-ICON",{icon:!0,slot:!0}),g(A).forEach(u),F=T(nt),M=f(nt,"ION-SELECT",{placeholder:!0,value:!0});var Xe=g(M);Y=f(Xe,"DIV",{slot:!0,"data-svelte-h":!0}),ie(Y)!=="svelte-wl764p"&&(Y.innerHTML=K),J=T(Xe),ne=f(Xe,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),ie(ne)!=="svelte-i9crym"&&(ne.textContent=re),D=T(Xe),le=f(Xe,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),ie(le)!=="svelte-fx0z11"&&(le.textContent=pe),ue=T(Xe),fe=f(Xe,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),ie(fe)!=="svelte-1c24jf2"&&(fe.textContent=ae),Xe.forEach(u),nt.forEach(u),se=T(be),ce=f(be,"ION-ITEM",{});var ut=g(ce);oe=f(ut,"ION-ICON",{icon:!0,slot:!0}),g(oe).forEach(u),ee=T(ut),Ee=f(ut,"ION-TEXTAREA",{label:!0,placeholder:!0}),g(Ee).forEach(u),ut.forEach(u),ve=T(be),ke=f(be,"SECTION",{});var Mt=g(ke);de=f(Mt,"LABEL",{for:!0,style:!0});var St=g(de);_e=f(St,"ION-BUTTON",{fill:!0,size:!0,class:!0,expand:!0});var dt=g(_e);$=f(dt,"LABEL",{for:!0,style:!0,"data-svelte-h":!0}),ie($)!=="svelte-1m9yw22"&&($.innerHTML=Z),te=T(dt),X=f(dt,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0,capture:!0}),dt.forEach(u),St.forEach(u),Mt.forEach(u),ge=T(be),V&&V.l(be),be.forEach(u),ye.forEach(u),Me=T(U),C&&C.l(U),Ce=T(U),P&&P.l(U),Ne=Pe(),this.h()},h(){b(i,"color","medium"),b(n,"slot","start"),b(s,"title",""),b(_,"strong",""),b(m,"slot","end"),b(e,"translucent",""),b(B,"icon",On),b(B,"slot","start"),b(z,"label","Concepto"),b(z,"type","text"),b(z,"placeholder","Escribe aquí..."),b(z,"value",l[9]?l[9]:""),b(G,"icon",ht),b(G,"slot","start"),b(R,"label","Monto $"),b(R,"type","number"),b(R,"value",l[10]?l[10]:""),b(A,"icon",Wn),b(A,"slot","start"),j(Y,"slot","label"),b(ne,"value","cash"),b(le,"value","card"),b(fe,"value","transfer"),b(M,"placeholder","Tipo de pago"),b(M,"value",l[11]?l[11]:""),b(oe,"icon",ht),b(oe,"slot","start"),b(Ee,"label","Comentarios"),b(Ee,"placeholder","Escribe aquí..."),j($,"for","eventEvidence"),c($,"width","100%"),c($,"padding","8px"),c(X,"display","none"),j(X,"id","eventEvidence"),j(X,"name","fileToUpload"),j(X,"type","file"),j(X,"accept","image/*"),j(X,"capture","environment"),b(_e,"fill","outline"),b(_e,"size","small"),b(_e,"class","loadEvidence"),b(_e,"expand","block"),j(de,"for","eventEvidence"),c(de,"display","block"),c(de,"width","100%"),b(k,"fullscreen","")},m(U,q){W(U,e,q),r(e,t),r(t,n),r(n,i),r(t,a),r(t,s),r(t,E),r(t,m),r(m,_),W(U,p,q),W(U,k,q),r(k,y),r(y,w),r(w,B),r(w,S),r(w,z),l[18](z),r(y,H),r(y,Q),r(Q,G),r(Q,L),r(Q,R),l[19](R),r(y,x),r(y,I),r(I,A),r(I,F),r(I,M),r(M,Y),r(M,J),r(M,ne),r(M,D),r(M,le),r(M,ue),r(M,fe),l[20](M),r(y,se),r(y,ce),r(ce,oe),r(ce,ee),r(ce,Ee),l[21](Ee),r(y,ve),r(y,ke),r(ke,de),r(de,_e),r(_e,$),r(_e,te),r(_e,X),r(y,ge),V&&V.m(y,null),W(U,Me,q),C&&C.m(U,q),W(U,Ce,q),P&&P.m(U,q),W(U,Ne,q),Ae||(O=[he(i,"click",l[13]),he(_,"click",l[14]),he(X,"change",l[12])],Ae=!0)},p(U,q){U[0]?V?V.p(U,q):(V=Wt(U),V.c(),V.m(y,null)):V&&(V.d(1),V=null),U[6]?C||(C=Gt(),C.c(),C.m(Ce.parentNode,Ce)):C&&(C.d(1),C=null),U[7]?P?P.p(U,q):(P=Kt(U),P.c(),P.m(Ne.parentNode,Ne)):P&&(P.d(1),P=null)},i:Le,o:Le,d(U){U&&(u(e),u(p),u(k),u(Me),u(Ce),u(Ne)),l[18](null),l[19](null),l[20](null),l[21](null),V&&V.d(),C&&C.d(U),P&&P.d(U),Ae=!1,He(O)}}}function Wi(l,e,t){let n=ct,i=document.querySelector("ion-modal"),o=i.componentProps.routeId,a=i.componentProps.ex_concept,s=i.componentProps.ex_amount,h=i.componentProps.ex_type,E=i.componentProps.id_expense,m="",_=new Array,v="",p="",k=0,y="",w="",B=!1,S=new Object,z=!1,H="";et(()=>{S=JSON.parse(localStorage.getItem("userSession"))});const Q=async(D,le)=>{await(await Ge.create({header:D||"Error",message:le||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()},G=async D=>{t(6,B=!0);const pe=D.target.files[0],ue=await L(pe);if(ue){var fe=new Object;fe.fileToUpload=ue,fe.id_user_over=S.id_user,fe.token=S.token;try{Ve(`${n}api/admin/manager/upload_img_driver.php`,function(ae){ae.success?(t(0,m=ae.img),t(1,_=Ke(m)),v=ae.img_id):Q("Error","No se pudo subir la imagen"),t(6,B=!1)},fe)}catch(ae){console.error("Error during file upload:",ae)}finally{t(6,B=!1)}}},L=async D=>new Promise(le=>{const pe=new Image;pe.src=URL.createObjectURL(D),pe.onload=()=>{const ue=document.createElement("canvas"),fe=ue.getContext("2d"),ae=800,se=600;let ce=pe.width,oe=pe.height;ce>ae&&(oe*=ae/ce,ce=ae),oe>se&&(ce*=se/oe,oe=se),ue.width=ce,ue.height=oe,fe.drawImage(pe,0,0,ce,oe),ue.toBlob(ee=>{le(ee),URL.revokeObjectURL(pe.src),fe.clearRect(0,0,ue.width,ue.height)},"image/jpeg",.7)}}),R=()=>{tt.dismiss()},x=()=>{var D=new Object;D.id_route=o,D.comments=y.value,D.type=p.value,D.img=m,D.img_id=v,D.amount=k.value,D.concept=w.value,D.status="done",D.id_expense=E||"null",D.id_user_over=S.id_user,D.token=S.token,!v||!m||!k.value||!w.value?Q("Datos incompletos","Llena los datos requeridos para completar el registro"):Ve(`${n}api/admin/expenses/add_expense.php`,function(le){R()},D)},I=D=>{t(8,H=D),t(7,z=!0)},A=()=>{t(7,z=!1),t(8,H="")};function F(D){wt.call(this,l,D)}function M(D){xe[D?"unshift":"push"](()=>{w=D,t(5,w)})}function Y(D){xe[D?"unshift":"push"](()=>{k=D,t(3,k)})}function K(D){xe[D?"unshift":"push"](()=>{p=D,t(2,p)})}function J(D){xe[D?"unshift":"push"](()=>{y=D,t(4,y)})}return[m,_,p,k,y,w,B,z,H,a,s,h,G,R,x,I,A,F,M,Y,K,J,D=>I(D),D=>removeFile(D)]}class Et extends Ye{constructor(e){super(),Qe(this,e,Wi,ji,Je,{},null,[-1,-1])}}function Xt(l,e,t){const n=l.slice();return n[32]=e[t],n[34]=t,n}function Jt(l,e,t){const n=l.slice();return n[35]=e[t],n}function Yt(l){let e,t,n,i,o,a,s=l[35].label+"",h,E,m,_;function v(){return l[18](l[35])}return{c(){e=d("div"),t=d("ion-button"),n=d("ion-icon"),o=N(),a=d("div"),h=Ie(s),E=N(),this.h()},l(p){e=f(p,"DIV",{class:!0});var k=g(e);t=f(k,"ION-BUTTON",{color:!0,fill:!0,size:!0});var y=g(t);n=f(y,"ION-ICON",{slot:!0,icon:!0}),g(n).forEach(u),y.forEach(u),o=T(k),a=f(k,"DIV",{class:!0,style:!0});var w=g(a);h=Oe(w,s),w.forEach(u),E=T(k),k.forEach(u),this.h()},h(){b(n,"slot","icon-only"),b(n,"icon",l[35].icon),b(t,"color",i=l[6]===l[35].id?"primary":"medium"),b(t,"fill","clear"),b(t,"size","small"),j(a,"class","motive-caption"),c(a,"font-size","11px"),c(a,"margin-top","2px"),c(a,"text-align","center"),c(a,"line-height","1.1"),j(e,"class","motive-button")},m(p,k){W(p,e,k),r(e,t),r(t,n),r(e,o),r(e,a),r(a,h),r(e,E),m||(_=he(t,"click",v),m=!0)},p(p,k){l=p,k[0]&64&&i!==(i=l[6]===l[35].id?"primary":"medium")&&b(t,"color",i)},d(p){p&&u(e),m=!1,_()}}}function Qt(l){let e;return{c(){e=d("div"),this.h()},l(t){e=f(t,"DIV",{id:!0,style:!0}),g(e).forEach(u),this.h()},h(){j(e,"id","motive-map"),c(e,"height","220px"),c(e,"margin","12px 16px"),c(e,"border-radius","8px")},m(t,n){W(t,e,n),l[19](e)},p:Le,d(t){t&&u(e),l[19](null)}}}function Zt(l){let e,t,n=Re(l[1]),i=[];for(let o=0;o<n.length;o+=1)i[o]=$t(Xt(l,n,o));return{c(){e=d("section"),t=d("div");for(let o=0;o<i.length;o+=1)i[o].c();this.h()},l(o){e=f(o,"SECTION",{});var a=g(e);t=f(a,"DIV",{class:!0,style:!0});var s=g(t);for(let h=0;h<i.length;h+=1)i[h].l(s);s.forEach(u),a.forEach(u),this.h()},h(){j(t,"class","image-grid"),c(t,"display","grid"),c(t,"grid-template-columns","repeat(auto-fill, minmax(100px, 1fr))"),c(t,"gap","10px"),c(t,"padding","0px 10px")},m(o,a){W(o,e,a),r(e,t);for(let s=0;s<i.length;s+=1)i[s]&&i[s].m(t,null)},p(o,a){if(a[0]&73730){n=Re(o[1]);let s;for(s=0;s<n.length;s+=1){const h=Xt(o,n,s);i[s]?i[s].p(h,a):(i[s]=$t(h),i[s].c(),i[s].m(t,null))}for(;s<i.length;s+=1)i[s].d(1);i.length=n.length}},d(o){o&&u(e),mt(i,o)}}}function $t(l){let e,t,n,i,o,a=`<ion-icon icon="${vt}"></ion-icon>`,s,h,E;function m(){return l[21](l[32])}function _(){return l[22](l[34])}return{c(){e=d("div"),t=d("ion-img"),i=N(),o=d("button"),o.innerHTML=a,s=N(),this.h()},l(v){e=f(v,"DIV",{class:!0,style:!0});var p=g(e);t=f(p,"ION-IMG",{src:!0,alt:!0,style:!0}),g(t).forEach(u),i=T(p),o=f(p,"BUTTON",{class:!0,style:!0,"data-svelte-h":!0}),ie(o)!=="svelte-ulzohx"&&(o.innerHTML=a),s=T(p),p.forEach(u),this.h()},h(){Fe(t.src,n=l[32])||b(t,"src",n),b(t,"alt","Evidencia fotográfica"),c(t,"width","100%"),c(t,"height","100px"),c(t,"object-fit","cover"),c(t,"cursor","pointer"),c(t,"border","1px solid #ccc"),c(t,"border-radius","4px"),c(t,"margin-top","16px"),j(o,"class","remove-button"),c(o,"position","absolute"),c(o,"top","5px"),c(o,"right","5px"),c(o,"border","none"),c(o,"cursor","pointer"),c(o,"font-size","18px"),c(o,"background","white"),c(o,"border-radius","50%"),c(o,"padding","3px 4px 0px"),c(o,"box-shadow","2px 2px 6px rgba(0, 0, 0, 0.3)"),c(o,"color","#0000008f"),j(e,"class","image-container"),c(e,"position","relative")},m(v,p){W(v,e,p),r(e,t),r(e,i),r(e,o),r(e,s),h||(E=[he(t,"click",m),he(o,"click",_)],h=!0)},p(v,p){l=v,p[0]&2&&!Fe(t.src,n=l[32])&&b(t,"src",n)},d(v){v&&u(e),h=!1,He(E)}}}function en(l){let e,t,n,i,o,a,s=`<ion-icon icon="${Ct}"></ion-icon>`,h,E;return{c(){e=d("div"),t=d("div"),n=d("ion-img"),o=N(),a=d("button"),a.innerHTML=s,this.h()},l(m){e=f(m,"DIV",{class:!0,style:!0});var _=g(e);t=f(_,"DIV",{class:!0,style:!0});var v=g(t);n=f(v,"ION-IMG",{src:!0,alt:!0,style:!0}),g(n).forEach(u),o=T(v),a=f(v,"BUTTON",{class:!0,style:!0,"data-svelte-h":!0}),ie(a)!=="svelte-1fdruw6"&&(a.innerHTML=s),v.forEach(u),_.forEach(u),this.h()},h(){Fe(n.src,i=l[5])||b(n,"src",i),b(n,"alt","Evidencia fotográfica"),c(n,"width","100%"),c(n,"height","auto"),j(a,"class","close-button"),c(a,"position","absolute"),c(a,"top","5px"),c(a,"right","5px"),c(a,"background","white"),c(a,"color","#444444d1"),c(a,"border","none"),c(a,"cursor","pointer"),c(a,"padding","2px 2px 0px 6px"),c(a,"border-radius","50%"),c(a,"font-size","20px"),j(t,"class","modal-content"),c(t,"position","relative"),c(t,"background","white"),c(t,"padding","20px"),c(t,"border-radius","8px"),c(t,"max-width","90vw"),c(t,"max-height","90vh"),c(t,"overflow","auto"),j(e,"class","modal-overlay"),c(e,"position","fixed"),c(e,"top","0"),c(e,"left","0"),c(e,"width","100vw"),c(e,"height","100vh"),c(e,"background","rgba(0, 0, 0, 0.8)"),c(e,"display","flex"),c(e,"justify-content","center"),c(e,"align-items","center"),c(e,"z-index","1000")},m(m,_){W(m,e,_),r(e,t),r(t,n),r(t,o),r(t,a),h||(E=[he(a,"click",l[14]),he(t,"click",yt(l[17])),he(e,"click",l[14])],h=!0)},p(m,_){_[0]&32&&!Fe(n.src,i=m[5])&&b(n,"src",i)},d(m){m&&u(e),h=!1,He(E)}}}function tn(l){let e,t='<ion-spinner name="dots" style="color:white;"></ion-spinner>';return{c(){e=d("div"),e.innerHTML=t,this.h()},l(n){e=f(n,"DIV",{class:!0,style:!0,"data-svelte-h":!0}),ie(e)!=="svelte-1mz0rrk"&&(e.innerHTML=t),this.h()},h(){j(e,"class","overlay"),c(e,"position","fixed"),c(e,"top","0"),c(e,"left","0"),c(e,"width","100vw"),c(e,"height","100vh"),c(e,"background","rgba(0, 0, 0, 0.5)"),c(e,"display","flex"),c(e,"align-items","center"),c(e,"justify-content","center"),c(e,"z-index","9999")},m(n,i){W(n,e,i)},d(n){n&&u(e)}}}function qi(l){let e,t,n,i,o="Cancelar",a,s,h="AGREGAR INCIDENCIA",E,m,_,v="Confirmar",p,k,y,w,B,S,z,H,Q,G,L,R,x,I,A,F,M=`<ion-icon icon="${Nt}" slot="start"></ion-icon>
            Subir Evidencia`,Y,K,J,ne,re,D,le,pe,ue=Re(l[9]),fe=[];for(let ee=0;ee<ue.length;ee+=1)fe[ee]=Yt(Jt(l,ue,ee));let ae=l[7].lat&&Qt(l),se=l[0]&&Zt(l),ce=l[4]&&en(l),oe=l[3]&&tn();return{c(){e=d("ion-header"),t=d("ion-toolbar"),n=d("ion-buttons"),i=d("ion-button"),i.textContent=o,a=N(),s=d("ion-title"),s.textContent=h,E=N(),m=d("ion-buttons"),_=d("ion-button"),_.textContent=v,p=N(),k=d("ion-content"),y=d("ion-list"),w=d("ion-item"),B=d("div");for(let ee=0;ee<fe.length;ee+=1)fe[ee].c();S=N(),ae&&ae.c(),z=N(),H=d("ion-item"),Q=d("ion-icon"),G=N(),L=d("ion-textarea"),R=N(),x=d("section"),I=d("label"),A=d("ion-button"),F=d("label"),F.innerHTML=M,Y=N(),K=d("input"),J=N(),se&&se.c(),ne=N(),ce&&ce.c(),re=N(),oe&&oe.c(),D=Pe(),this.h()},l(ee){e=f(ee,"ION-HEADER",{translucent:!0});var Ee=g(e);t=f(Ee,"ION-TOOLBAR",{});var ve=g(t);n=f(ve,"ION-BUTTONS",{slot:!0});var ke=g(n);i=f(ke,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),ie(i)!=="svelte-1f8rjcf"&&(i.textContent=o),ke.forEach(u),a=T(ve),s=f(ve,"ION-TITLE",{title:!0,"data-svelte-h":!0}),ie(s)!=="svelte-zr4yw3"&&(s.textContent=h),E=T(ve),m=f(ve,"ION-BUTTONS",{slot:!0});var de=g(m);_=f(de,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),ie(_)!=="svelte-1afq5zm"&&(_.textContent=v),de.forEach(u),ve.forEach(u),Ee.forEach(u),p=T(ee),k=f(ee,"ION-CONTENT",{fullscreen:!0});var _e=g(k);y=f(_e,"ION-LIST",{});var $=g(y);w=f($,"ION-ITEM",{lines:!0,class:!0,style:!0});var Z=g(w);B=f(Z,"DIV",{class:!0,style:!0});var te=g(B);for(let Ne=0;Ne<fe.length;Ne+=1)fe[Ne].l(te);te.forEach(u),Z.forEach(u),S=T($),ae&&ae.l($),z=T($),H=f($,"ION-ITEM",{});var X=g(H);Q=f(X,"ION-ICON",{icon:!0,slot:!0}),g(Q).forEach(u),G=T(X),L=f(X,"ION-TEXTAREA",{label:!0,placeholder:!0}),g(L).forEach(u),X.forEach(u),R=T($),x=f($,"SECTION",{});var ge=g(x);I=f(ge,"LABEL",{for:!0,style:!0});var Me=g(I);A=f(Me,"ION-BUTTON",{fill:!0,size:!0,class:!0,expand:!0});var Ce=g(A);F=f(Ce,"LABEL",{for:!0,style:!0,"data-svelte-h":!0}),ie(F)!=="svelte-1tbnglg"&&(F.innerHTML=M),Y=T(Ce),K=f(Ce,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0,capture:!0}),Ce.forEach(u),Me.forEach(u),ge.forEach(u),J=T($),se&&se.l($),$.forEach(u),_e.forEach(u),ne=T(ee),ce&&ce.l(ee),re=T(ee),oe&&oe.l(ee),D=Pe(),this.h()},h(){b(i,"color","medium"),b(n,"slot","start"),b(s,"title",""),b(_,"strong",""),b(m,"slot","end"),b(e,"translucent",""),j(B,"class","motive-grid"),c(B,"display","flex"),c(B,"gap","8px"),c(B,"flex-wrap","wrap"),c(B,"justify-content","center"),c(B,"margin-top","6px"),b(w,"lines","none"),b(w,"class","motive-item"),c(w,"display","grid"),c(w,"justify-content","center"),c(w,"margin-bottom","15px"),b(Q,"icon",ht),b(Q,"slot","start"),b(L,"label","Comentarios"),b(L,"placeholder","Escribe aquí..."),j(F,"for","eventEvidence"),c(F,"width","100%"),c(F,"padding","8px"),c(K,"display","none"),j(K,"id","eventEvidence"),j(K,"name","fileToUpload"),j(K,"type","file"),j(K,"accept","image/*"),j(K,"capture","environment"),b(A,"fill","outline"),b(A,"size","small"),b(A,"class","loadEvidence"),b(A,"expand","block"),j(I,"for","eventEvidence"),c(I,"display","block"),c(I,"width","100%"),b(k,"fullscreen","")},m(ee,Ee){W(ee,e,Ee),r(e,t),r(t,n),r(n,i),r(t,a),r(t,s),r(t,E),r(t,m),r(m,_),W(ee,p,Ee),W(ee,k,Ee),r(k,y),r(y,w),r(w,B);for(let ve=0;ve<fe.length;ve+=1)fe[ve]&&fe[ve].m(B,null);r(y,S),ae&&ae.m(y,null),r(y,z),r(y,H),r(H,Q),r(H,G),r(H,L),l[20](L),r(y,R),r(y,x),r(x,I),r(I,A),r(A,F),r(A,Y),r(A,K),r(y,J),se&&se.m(y,null),W(ee,ne,Ee),ce&&ce.m(ee,Ee),W(ee,re,Ee),oe&&oe.m(ee,Ee),W(ee,D,Ee),le||(pe=[he(i,"click",l[11]),he(_,"click",l[12]),he(K,"change",l[10])],le=!0)},p(ee,Ee){if(Ee[0]&33344){ue=Re(ee[9]);let ve;for(ve=0;ve<ue.length;ve+=1){const ke=Jt(ee,ue,ve);fe[ve]?fe[ve].p(ke,Ee):(fe[ve]=Yt(ke),fe[ve].c(),fe[ve].m(B,null))}for(;ve<fe.length;ve+=1)fe[ve].d(1);fe.length=ue.length}ee[7].lat?ae?ae.p(ee,Ee):(ae=Qt(ee),ae.c(),ae.m(y,z)):ae&&(ae.d(1),ae=null),ee[0]?se?se.p(ee,Ee):(se=Zt(ee),se.c(),se.m(y,null)):se&&(se.d(1),se=null),ee[4]?ce?ce.p(ee,Ee):(ce=en(ee),ce.c(),ce.m(re.parentNode,re)):ce&&(ce.d(1),ce=null),ee[3]?oe||(oe=tn(),oe.c(),oe.m(D.parentNode,D)):oe&&(oe.d(1),oe=null)},i:Le,o:Le,d(ee){ee&&(u(e),u(p),u(k),u(ne),u(re),u(D)),mt(fe,ee),ae&&ae.d(),l[20](null),se&&se.d(),ce&&ce.d(ee),oe&&oe.d(ee),le=!1,He(pe)}}}function Gi(l,e,t){let n=ct,o=document.querySelector("ion-modal").componentProps.routeId,a="",s=a?Ke(a):new Array,h="",E=!1,m=new Object,_=!1,v="",p="",k={lat:null,lng:null},y,w,B;const S=[{id:"car_accident",icon:"/car-accident.svg",label:"Accidente"},{id:"hospital",icon:"/hospital.svg",label:"Hospital"},{id:"wc",icon:"/toilet.svg",label:"Baño"},{id:"restaurant",icon:"/restaurant.svg",label:"Restaurant"},{id:"parking",icon:"/parking.svg",label:"Parking"},{id:"traffic",icon:"/traffic.svg",label:"Tráfico"}];et(()=>{m=JSON.parse(localStorage.getItem("userSession"))});const z=async(D,le)=>{await(await Ge.create({header:D||"Error",message:le||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()},H=async D=>{t(3,E=!0);try{if(s.length>=5){z("Límite de evidencias","Solo se permite subir 5 fotos por parada");return}const pe=D.target.files[0],ue=await Q(pe);if(!ue){z("Error","No se pudo comprimir la imagen");return}const fe={fileToUpload:ue,id_user_over:m.id_user,token:m.token},ae=await new Promise((se,ce)=>{Ve(`${n}api/admin/manager/upload_img_driver.php`,oe=>se(oe),fe)});ae.success?(t(0,a=a?`${a},${ae.img}`:ae.img),t(1,s=Ke(a))):z("Error","No se pudo subir la imagen")}catch(le){console.error("Error during file upload:",le),z("Error","Algo salió mal al subir la imagen.")}finally{t(3,E=!1)}},Q=async D=>new Promise(le=>{const pe=new Image;pe.src=URL.createObjectURL(D),pe.onload=()=>{const ue=document.createElement("canvas"),fe=ue.getContext("2d"),ae=800,se=600;let ce=pe.width,oe=pe.height;ce>ae&&(oe*=ae/ce,ce=ae),oe>se&&(ce*=se/oe,oe=se),ue.width=ce,ue.height=oe,fe.drawImage(pe,0,0,ce,oe),ue.toBlob(ee=>{le(ee),URL.revokeObjectURL(pe.src),fe.clearRect(0,0,ue.width,ue.height)},"image/jpeg",.7)}}),G=()=>{tt.dismiss()},L=()=>{t(3,E=!0);var D=new Object;t(0,a=s.join(",")),D.id_route=o,D.comments=h.value,D.lat=k.lat,D.lng=k.lng,D.type=p,D.img=a,D.id_user_over=m.id_user,D.token=m.token,D.id_driver=m.id_driver,!p||!a||!D.comments||!D.img?(t(3,E=!1),z("Datos incompletos","Llena los datos requeridos para completar el registro")):!D.lat||!D.lng?(t(3,E=!1),z("Ubicación no disponible","Por favor, asegúrate de que la ubicación está activada en tu dispositivo.")):Ve(`${n}api/admin/incidence/add_incidence.php`,function(le){le?(t(3,E=!1),z("Éxito","Incidencia registrada correctamente")):(t(3,E=!1),z("Error","No se pudo registrar la incidencia. Por favor, inténtalo de nuevo.")),G()},D)},R=D=>{t(5,v=D),t(4,_=!0)},x=()=>{t(4,_=!1),t(5,v="")};async function I(D){t(6,p=D),t(3,E=!0),navigator.geolocation&&navigator.geolocation.getCurrentPosition(async le=>{t(7,k.lat=le.coords.latitude,k),t(7,k.lng=le.coords.longitude,k),await A()},()=>console.log("Geolocalización denegada"))}async function A(){if(await Ot(),!y)return;const{Map:D}=await google.maps.importLibrary("maps"),{AdvancedMarkerElement:le}=await google.maps.importLibrary("marker");w?w.setCenter(k):w=new D(y,{zoom:15,center:k,mapId:"4504f8b37365c3d0"});const pe=S.find(ae=>ae.id===p);if(!pe)return;B&&B.setMap(null);const ue=document.createElement("div");ue.style.cssText=`
      display:flex;align-items:center;justify-content:center;
      width:38px;height:38px;border-radius:50%;
      background:#ffffff;border:2px solid #d13434;
      box-shadow:0 0 4px rgba(0,0,0,.3);
  `;const fe=document.createElement("ion-icon");fe.setAttribute("icon",pe.icon),fe.style.cssText="font-size:24px;color:#d13434;",ue.appendChild(fe),B=new le({map:w,position:k,title:pe.label,content:ue}),t(3,E=!1)}function F(D=0){var le=yn(D,s,[""],a);t(1,s=le.files),t(0,a=le.selectedImages)}function M(D){wt.call(this,l,D)}const Y=D=>I(D.id);function K(D){xe[D?"unshift":"push"](()=>{y=D,t(8,y)})}function J(D){xe[D?"unshift":"push"](()=>{h=D,t(2,h)})}return[a,s,h,E,_,v,p,k,y,S,H,G,L,R,x,I,F,M,Y,K,J,D=>R(D),D=>F(D)]}class Ki extends Ye{constructor(e){super(),Qe(this,e,Gi,qi,Je,{},null,[-1,-1])}}function nn(l,e,t){const n=l.slice();return n[7]=e[t],n}function Xi(l){let e,t="Cargar gasto",n,i;function o(...a){return l[4](l[7],...a)}return{c(){e=d("ion-button"),e.textContent=t,this.h()},l(a){e=f(a,"ION-BUTTON",{fill:!0,size:!0,"aria-selected":!0,"data-svelte-h":!0}),ie(e)!=="svelte-175aelj"&&(e.textContent=t),this.h()},h(){b(e,"fill","outline"),b(e,"size","small"),b(e,"aria-selected","")},m(a,s){W(a,e,s),n||(i=he(e,"click",o),n=!0)},p(a,s){l=a},d(a){a&&u(e),n=!1,i()}}}function Ji(l){let e,t="Gasto completado";return{c(){e=d("ion-button"),e.textContent=t,this.h()},l(n){e=f(n,"ION-BUTTON",{fill:!0,size:!0,"aria-selected":!0,"data-svelte-h":!0}),ie(e)!=="svelte-tlger7"&&(e.textContent=t),this.h()},h(){b(e,"fill","solid"),b(e,"size","small"),b(e,"aria-selected","")},m(n,i){W(n,e,i)},p:Le,d(n){n&&u(e)}}}function on(l,e){let t,n,i,o=e[7].concept+"",a,s,h;function E(v,p){return v[7].status=="done"?Ji:Xi}let _=E(e)(e);return{key:l,first:null,c(){t=d("ion-item"),n=d("ion-label"),i=d("p"),a=Ie(o),s=N(),_.c(),h=N(),this.h()},l(v){t=f(v,"ION-ITEM",{});var p=g(t);n=f(p,"ION-LABEL",{style:!0});var k=g(n);i=f(k,"P",{style:!0});var y=g(i);a=Oe(y,o),y.forEach(u),k.forEach(u),s=T(p),_.l(p),h=T(p),p.forEach(u),this.h()},h(){c(i,"margin-left","10px"),c(n,"display","flex"),this.first=t},m(v,p){W(v,t,p),r(t,n),r(n,i),r(i,a),r(t,s),_.m(t,null),r(t,h)},p(v,p){e=v,_.p(e,p)},d(v){v&&u(t),_.d()}}}function Yi(l){let e,t,n,i,o=`<ion-icon style="font-size: 25px!important;" icon="${qn}"></ion-icon>`,a,s,h="LISTA DE GASTOS",E,m,_,v=[],p=new Map,k,y,w,B="Cerrar",S,z,H=Re(l[0]);const Q=G=>G[7].id_expenses;for(let G=0;G<H.length;G+=1){let L=nn(l,H,G),R=Q(L);p.set(R,v[G]=on(R,L))}return{c(){e=d("ion-header"),t=d("ion-toolbar"),n=d("ion-buttons"),i=d("ion-button"),i.innerHTML=o,a=N(),s=d("ion-title"),s.textContent=h,E=N(),m=d("ion-content"),_=d("ion-list");for(let G=0;G<v.length;G+=1)v[G].c();k=N(),y=d("ion-footer"),w=d("ion-button"),w.textContent=B,this.h()},l(G){e=f(G,"ION-HEADER",{translucent:!0});var L=g(e);t=f(L,"ION-TOOLBAR",{});var R=g(t);n=f(R,"ION-BUTTONS",{slot:!0});var x=g(n);i=f(x,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),ie(i)!=="svelte-160xz3i"&&(i.innerHTML=o),x.forEach(u),a=T(R),s=f(R,"ION-TITLE",{"data-svelte-h":!0}),ie(s)!=="svelte-1phn90x"&&(s.textContent=h),R.forEach(u),L.forEach(u),E=T(G),m=f(G,"ION-CONTENT",{fullscreen:!0});var I=g(m);_=f(I,"ION-LIST",{});var A=g(_);for(let M=0;M<v.length;M+=1)v[M].l(A);A.forEach(u),I.forEach(u),k=T(G),y=f(G,"ION-FOOTER",{});var F=g(y);w=f(F,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),ie(w)!=="svelte-zv7v83"&&(w.textContent=B),F.forEach(u),this.h()},h(){b(i,"color","medium"),b(n,"slot","end"),b(e,"translucent",""),b(m,"fullscreen",""),b(w,"fill","outline"),b(w,"color","tertiary"),b(w,"strong",""),c(w,"width","99%"),c(w,"height","auto")},m(G,L){W(G,e,L),r(e,t),r(t,n),r(n,i),r(t,a),r(t,s),W(G,E,L),W(G,m,L),r(m,_);for(let R=0;R<v.length;R+=1)v[R]&&v[R].m(_,null);W(G,k,L),W(G,y,L),r(y,w),S||(z=[he(i,"click",l[3]),he(w,"click",l[1])],S=!0)},p(G,[L]){L&5&&(H=Re(G[0]),v=st(v,L,Q,1,G,H,p,_,at,on,null,nn))},i:Le,o:Le,d(G){G&&(u(e),u(E),u(m),u(k),u(y));for(let L=0;L<v.length;L+=1)v[L].d();S=!1,He(z)}}}function Qi(l){let e=document.querySelector("ion-modal");e.componentProps.routeId;let t=e.componentProps.expenses;et(()=>{});const n=()=>{tt.dismiss()};function i(s,h,E,m,_){e.componentProps.ex_amount=E,e.componentProps.ex_concept=h,e.componentProps.ex_type=m,e.componentProps.id_expense=_,qe("modal-expense",Et,{amount:E,concept:h,type:m,id_expense:_}).then(()=>{}),n()}return[t,n,i,s=>{qe("modal-expense",Et,{routeId:s}).then(h=>{}),n()},(s,h)=>i(h,s.concept,s.amount,s.type,s.id_expenses)]}class Zi extends Ye{constructor(e){super(),Qe(this,e,Qi,Yi,Je,{})}}const{document:ln}=ti;function rn(l,e,t){const n=l.slice();return n[56]=e[t],n[58]=t,n}function sn(l,e,t){const n=l.slice();return n[56]=e[t],n[58]=t,n}function an(l,e,t){const n=l.slice();return n[56]=e[t],n[58]=t,n}function cn(l){let e,t;return e=new Gn({props:{$$slots:{default:[fo]},$$scope:{ctx:l}}}),{c(){gn(e.$$.fragment)},l(n){bn(e.$$.fragment,n)},m(n,i){En(e,n,i),t=!0},p(n,i){const o={};i[0]&2043|i[1]&1073741824&&(o.$$scope={dirty:i,ctx:n}),e.$set(o)},i(n){t||($e(e.$$.fragment,n),t=!0)},o(n){ot(e.$$.fragment,n),t=!1},d(n){kn(e,n)}}}function $i(l){let e,t='<div id="g_map" style="width: 100%; height: 100vh;"></div>';return{c(){e=d("ion-content"),e.innerHTML=t},l(n){e=f(n,"ION-CONTENT",{"data-svelte-h":!0}),ie(e)!=="svelte-h8v4nk"&&(e.innerHTML=t)},m(n,i){W(n,e,i)},p:Le,d(n){n&&u(e)}}}function eo(l){let e;function t(o,a){if(o[7].length>0)return no;if(!o[3])return to}let n=t(l),i=n&&n(l);return{c(){i&&i.c(),e=Pe()},l(o){i&&i.l(o),e=Pe()},m(o,a){i&&i.m(o,a),W(o,e,a)},p(o,a){n===(n=t(o))&&i?i.p(o,a):(i&&i.d(1),i=n&&n(o),i&&(i.c(),i.m(e.parentNode,e)))},d(o){o&&u(e),i&&i.d(o)}}}function to(l){let e,t,n,i='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Jala para actualizar" refreshing-spinner="circles" refreshing-text="Actualizando..."></ion-refresher-content>',o,a,s,h,E,m,_="0",v,p,k,y,w,B=l[6].origin+"",S,z,H,Q,G,L,R=[],x=new Map,I,A,F,M,Y,K=l[5].length+1+"",J,ne,re,D,le,pe,ue=l[6].destination+"",fe,ae,se,ce="",oe,ee,Ee,ve,ke=l[4]&&un(l),de=Re(l[5]);const _e=$=>$[56].id_event;for(let $=0;$<de.length;$+=1){let Z=rn(l,de,$),te=_e(Z);x.set(te,R[$]=fn(te,Z))}return{c(){ke&&ke.c(),e=N(),t=d("ion-content"),n=d("ion-refresher"),n.innerHTML=i,o=N(),a=d("ion-list"),s=d("ion-item"),h=d("ion-avatar"),E=d("div"),m=d("div"),m.textContent=_,p=N(),k=d("ion-label"),y=d("ion-text"),w=d("h3"),S=Ie(B),z=N(),H=d("div"),Q=N(),G=d("ion-icon"),L=N();for(let $=0;$<R.length;$+=1)R[$].c();I=N(),A=d("ion-item"),F=d("ion-avatar"),M=d("div"),Y=d("div"),J=Ie(K),re=N(),D=d("ion-label"),le=d("ion-text"),pe=d("h3"),fe=Ie(ue),ae=N(),se=d("div"),se.innerHTML=ce,oe=N(),ee=d("ion-icon"),this.h()},l($){ke&&ke.l($),e=T($),t=f($,"ION-CONTENT",{});var Z=g(t);n=f(Z,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),ie(n)!=="svelte-1mlmyg"&&(n.innerHTML=i),o=T(Z),a=f(Z,"ION-LIST",{});var te=g(a);s=f(te,"ION-ITEM",{});var X=g(s);h=f(X,"ION-AVATAR",{slot:!0});var ge=g(h);E=f(ge,"DIV",{class:!0,title:!0,style:!0});var Me=g(E);m=f(Me,"DIV",{class:!0,"data-svelte-h":!0}),ie(m)!=="svelte-b78non"&&(m.textContent=_),Me.forEach(u),ge.forEach(u),p=T(X),k=f(X,"ION-LABEL",{button:!0});var Ce=g(k);y=f(Ce,"ION-TEXT",{color:!0});var Ne=g(y);w=f(Ne,"H3",{});var Ae=g(w);S=Oe(Ae,B),Ae.forEach(u),Ne.forEach(u),z=T(Ce),H=f(Ce,"DIV",{class:!0}),g(H).forEach(u),Ce.forEach(u),Q=T(X),G=f(X,"ION-ICON",{icon:!0,slot:!0}),g(G).forEach(u),X.forEach(u),L=T(te);for(let we=0;we<R.length;we+=1)R[we].l(te);I=T(te),A=f(te,"ION-ITEM",{});var O=g(A);F=f(O,"ION-AVATAR",{slot:!0});var V=g(F);M=f(V,"DIV",{class:!0,title:!0,style:!0});var C=g(M);Y=f(C,"DIV",{class:!0});var P=g(Y);J=Oe(P,K),P.forEach(u),C.forEach(u),V.forEach(u),re=T(O),D=f(O,"ION-LABEL",{button:!0});var U=g(D);le=f(U,"ION-TEXT",{color:!0});var q=g(le);pe=f(q,"H3",{});var me=g(pe);fe=Oe(me,ue),me.forEach(u),q.forEach(u),ae=T(U),se=f(U,"DIV",{class:!0,"data-svelte-h":!0}),ie(se)!=="svelte-17oqe78"&&(se.innerHTML=ce),U.forEach(u),oe=T(O),ee=f(O,"ION-ICON",{icon:!0,slot:!0}),g(ee).forEach(u),O.forEach(u),te.forEach(u),Z.forEach(u),this.h()},h(){b(n,"slot","fixed"),j(m,"class","order svelte-1ita8l7"),j(E,"class","order-wrapper svelte-1ita8l7"),j(E,"title",v="$"+l[6].origin),c(E,"background-color",l[6].color),c(E,"color",Be(l[6].color)),b(h,"slot","start"),b(y,"color","#2e2e2e"),j(H,"class","sub svelte-1ita8l7"),b(k,"button",""),b(G,"icon",je),b(G,"slot","end"),j(Y,"class","order svelte-1ita8l7"),j(M,"class","order-wrapper svelte-1ita8l7"),j(M,"title",ne="$"+l[6].destination),c(M,"background-color",l[6].color),c(M,"color",Be(l[6].color)),b(F,"slot","start"),b(le,"color","#2e2e2e"),j(se,"class","sub svelte-1ita8l7"),b(D,"button",""),b(ee,"icon",je),b(ee,"slot","end")},m($,Z){ke&&ke.m($,Z),W($,e,Z),W($,t,Z),r(t,n),l[34](n),r(t,o),r(t,a),r(a,s),r(s,h),r(h,E),r(E,m),r(s,p),r(s,k),r(k,y),r(y,w),r(w,S),r(k,z),r(k,H),r(s,Q),r(s,G),r(a,L);for(let te=0;te<R.length;te+=1)R[te]&&R[te].m(a,null);r(a,I),r(a,A),r(A,F),r(F,M),r(M,Y),r(Y,J),r(A,re),r(A,D),r(D,le),r(le,pe),r(pe,fe),r(D,ae),r(D,se),r(A,oe),r(A,ee),Ee||(ve=[he(n,"ionRefresh",l[12]),he(k,"click",l[35]),he(D,"click",l[37])],Ee=!0)},p($,Z){$[4]?ke?ke.p($,Z):(ke=un($),ke.c(),ke.m(e.parentNode,e)):ke&&(ke.d(1),ke=null),Z[0]&64&&v!==(v="$"+$[6].origin)&&j(E,"title",v),Z[0]&64&&c(E,"background-color",$[6].color),Z[0]&64&&c(E,"color",Be($[6].color)),Z[0]&64&&B!==(B=$[6].origin+"")&&Se(S,B),Z[0]&2638880&&(de=Re($[5]),R=st(R,Z,_e,1,$,de,x,a,at,fn,I,rn)),Z[0]&32&&K!==(K=$[5].length+1+"")&&Se(J,K),Z[0]&64&&ne!==(ne="$"+$[6].destination)&&j(M,"title",ne),Z[0]&64&&c(M,"background-color",$[6].color),Z[0]&64&&c(M,"color",Be($[6].color)),Z[0]&64&&ue!==(ue=$[6].destination+"")&&Se(fe,ue)},d($){$&&(u(e),u(t)),ke&&ke.d($),l[34](null);for(let Z=0;Z<R.length;Z+=1)R[Z].d();Ee=!1,He(ve)}}}function no(l){let e,t;function n(a,s){return s[0]&144&&(e=null),e==null&&(e=!!(a[7].filter(_o).every(po)&&!a[4])),e?ro:lo}let i=n(l,[-1,-1]),o=i(l);return{c(){o.c(),t=Pe()},l(a){o.l(a),t=Pe()},m(a,s){o.m(a,s),W(a,t,s)},p(a,s){i===(i=n(a,s))&&o?o.p(a,s):(o.d(1),o=i(a),o&&(o.c(),o.m(t.parentNode,t)))},d(a){a&&u(t),o.d(a)}}}function un(l){let e=l[16]("",l[1],l[0])+"",t;return{c(){t=Ie(e)},l(n){t=Oe(n,e)},m(n,i){W(n,t,i)},p(n,i){i[0]&3&&e!==(e=n[16]("",n[1],n[0])+"")&&Se(t,e)},d(n){n&&u(t)}}}function dn(l){let e;return{c(){e=d("span"),this.h()},l(t){e=f(t,"SPAN",{class:!0}),g(e).forEach(u),this.h()},h(){j(e,"class","notes svelte-1ita8l7")},m(t,n){W(t,e,n)},d(t){t&&u(e)}}}function io(l){let e;return{c(){e=d("ion-icon"),this.h()},l(t){e=f(t,"ION-ICON",{icon:!0,slot:!0,style:!0}),g(e).forEach(u),this.h()},h(){b(e,"icon",je),b(e,"slot","end"),c(e,"color",Ue(l[56].status,l[56].date_service))},m(t,n){W(t,e,n)},p(t,n){n[0]&32&&c(e,"color",Ue(t[56].status,t[56].date_service))},d(t){t&&u(e)}}}function oo(l){let e,t=(l[56].tag?l[56].tag:"")+"",n;return{c(){e=d("div"),n=Ie(t),this.h()},l(i){e=f(i,"DIV",{class:!0,slot:!0,style:!0});var o=g(e);n=Oe(o,t),o.forEach(u),this.h()},h(){j(e,"class","stop-tag"),j(e,"slot","end"),c(e,"background-color",ze(l[56].tag_color,.3)),c(e,"border","1px solid "+ze(l[56].tag_color,.4)),c(e,"color",l[56].tag_color),c(e,"font-size","10px"),c(e,"text-align","center"),c(e,"align-content","center"),c(e,"border-radius","20px"),c(e,"white-space","normal"),c(e,"padding","3px 6px"),c(e,"width","auto",1),c(e,"display","inline-block"),c(e,"font-weight","500")},m(i,o){W(i,e,o),r(e,n)},p(i,o){o[0]&32&&t!==(t=(i[56].tag?i[56].tag:"")+"")&&Se(n,t),o[0]&32&&c(e,"background-color",ze(i[56].tag_color,.3)),o[0]&32&&c(e,"border","1px solid "+ze(i[56].tag_color,.4)),o[0]&32&&c(e,"color",i[56].tag_color)},d(i){i&&u(e)}}}function fn(l,e){let t,n,i,o,a=parseInt(e[56].pos)+1+"",s,h,E,m,_,v,p=e[56].title+"",k,y,w=e[56].support_list&&e[56].support_list.length||e[19](e[56]),B,S,z,H=w&&dn();function Q(){return e[36](e[56])}function G(x,I){return x[56].tag_color&&x[56].tag?oo:io}let L=G(e),R=L(e);return{key:l,first:null,c(){t=d("ion-item"),n=d("ion-avatar"),i=d("div"),o=d("div"),s=Ie(a),E=N(),m=d("ion-label"),_=d("ion-text"),v=d("h3"),k=Ie(p),y=N(),H&&H.c(),B=N(),R.c(),this.h()},l(x){t=f(x,"ION-ITEM",{});var I=g(t);n=f(I,"ION-AVATAR",{slot:!0});var A=g(n);i=f(A,"DIV",{class:!0,title:!0,style:!0});var F=g(i);o=f(F,"DIV",{class:!0});var M=g(o);s=Oe(M,a),M.forEach(u),F.forEach(u),A.forEach(u),E=T(I),m=f(I,"ION-LABEL",{button:!0});var Y=g(m);_=f(Y,"ION-TEXT",{color:!0});var K=g(_);v=f(K,"H3",{});var J=g(v);k=Oe(J,p),y=T(J),H&&H.l(J),J.forEach(u),K.forEach(u),Y.forEach(u),B=T(I),R.l(I),I.forEach(u),this.h()},h(){j(o,"class","order svelte-1ita8l7"),j(i,"class","order-wrapper svelte-1ita8l7"),j(i,"title",h=lt(e[56].status)),c(i,"background-color",Ue(e[56].status,e[56].date_service)),c(i,"color",Be(Ue(e[56].status))),b(n,"slot","start"),b(_,"color","#2e2e2e"),b(m,"button",""),this.first=t},m(x,I){W(x,t,I),r(t,n),r(n,i),r(i,o),r(o,s),r(t,E),r(t,m),r(m,_),r(_,v),r(v,k),r(v,y),H&&H.m(v,null),r(t,B),R.m(t,null),S||(z=he(m,"click",Q),S=!0)},p(x,I){e=x,I[0]&32&&a!==(a=parseInt(e[56].pos)+1+"")&&Se(s,a),I[0]&32&&h!==(h=lt(e[56].status))&&j(i,"title",h),I[0]&32&&c(i,"background-color",Ue(e[56].status,e[56].date_service)),I[0]&32&&c(i,"color",Be(Ue(e[56].status))),I[0]&32&&p!==(p=e[56].title+"")&&Se(k,p),I[0]&32&&(w=e[56].support_list&&e[56].support_list.length||e[19](e[56])),w?H||(H=dn(),H.c(),H.m(v,null)):H&&(H.d(1),H=null),L===(L=G(e))&&R?R.p(e,I):(R.d(1),R=L(e),R&&(R.c(),R.m(t,null)))},d(x){x&&u(t),H&&H.d(),R.d(),S=!1,z()}}}function lo(l){let e=l[16](l[7],l[1],l[0])+"",t,n,i,o,a='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Pull to refresh" refreshing-spinner="circles" refreshing-text="Refreshing..."></ion-refresher-content>',s,h,E,m,_,v,p="0",k,y,w,B,S,z=l[6].origin+"",H,Q,G,L,R,x,I=[],A=new Map,F,M,Y,K,J,ne=l[5].length+1+"",re,D,le,pe,ue,fe,ae=l[6].destination+"",se,ce,oe,ee="",Ee,ve,ke,de,_e=Re(l[5]);const $=Z=>Z[56].id_event;for(let Z=0;Z<_e.length;Z+=1){let te=sn(l,_e,Z),X=$(te);A.set(X,I[Z]=_n(X,te))}return{c(){t=Ie(e),n=N(),i=d("ion-content"),o=d("ion-refresher"),o.innerHTML=a,s=N(),h=d("ion-list"),E=d("ion-item"),m=d("ion-avatar"),_=d("div"),v=d("div"),v.textContent=p,y=N(),w=d("ion-label"),B=d("ion-text"),S=d("h3"),H=Ie(z),Q=N(),G=d("div"),L=N(),R=d("ion-icon"),x=N();for(let Z=0;Z<I.length;Z+=1)I[Z].c();F=N(),M=d("ion-item"),Y=d("ion-avatar"),K=d("div"),J=d("div"),re=Ie(ne),le=N(),pe=d("ion-label"),ue=d("ion-text"),fe=d("h3"),se=Ie(ae),ce=N(),oe=d("div"),oe.innerHTML=ee,Ee=N(),ve=d("ion-icon"),this.h()},l(Z){t=Oe(Z,e),n=T(Z),i=f(Z,"ION-CONTENT",{});var te=g(i);o=f(te,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),ie(o)!=="svelte-1l8nqqz"&&(o.innerHTML=a),s=T(te),h=f(te,"ION-LIST",{});var X=g(h);E=f(X,"ION-ITEM",{});var ge=g(E);m=f(ge,"ION-AVATAR",{slot:!0});var Me=g(m);_=f(Me,"DIV",{class:!0,title:!0,style:!0});var Ce=g(_);v=f(Ce,"DIV",{class:!0,"data-svelte-h":!0}),ie(v)!=="svelte-b78non"&&(v.textContent=p),Ce.forEach(u),Me.forEach(u),y=T(ge),w=f(ge,"ION-LABEL",{button:!0});var Ne=g(w);B=f(Ne,"ION-TEXT",{color:!0});var Ae=g(B);S=f(Ae,"H3",{});var O=g(S);H=Oe(O,z),O.forEach(u),Ae.forEach(u),Q=T(Ne),G=f(Ne,"DIV",{class:!0}),g(G).forEach(u),Ne.forEach(u),L=T(ge),R=f(ge,"ION-ICON",{icon:!0,slot:!0}),g(R).forEach(u),ge.forEach(u),x=T(X);for(let Te=0;Te<I.length;Te+=1)I[Te].l(X);F=T(X),M=f(X,"ION-ITEM",{});var V=g(M);Y=f(V,"ION-AVATAR",{slot:!0});var C=g(Y);K=f(C,"DIV",{class:!0,title:!0,style:!0});var P=g(K);J=f(P,"DIV",{class:!0});var U=g(J);re=Oe(U,ne),U.forEach(u),P.forEach(u),C.forEach(u),le=T(V),pe=f(V,"ION-LABEL",{button:!0});var q=g(pe);ue=f(q,"ION-TEXT",{color:!0});var me=g(ue);fe=f(me,"H3",{});var we=g(fe);se=Oe(we,ae),we.forEach(u),me.forEach(u),ce=T(q),oe=f(q,"DIV",{class:!0,"data-svelte-h":!0}),ie(oe)!=="svelte-1c76q1w"&&(oe.innerHTML=ee),q.forEach(u),Ee=T(V),ve=f(V,"ION-ICON",{icon:!0,slot:!0}),g(ve).forEach(u),V.forEach(u),X.forEach(u),te.forEach(u),this.h()},h(){b(o,"slot","fixed"),j(v,"class","order svelte-1ita8l7"),j(_,"class","order-wrapper svelte-1ita8l7"),j(_,"title",k="$"+l[6].origin),c(_,"background-color",l[6].color),c(_,"color",Be(l[6].color)),b(m,"slot","start"),b(B,"color","#2e2e2e"),j(G,"class","sub svelte-1ita8l7"),b(w,"button",""),b(R,"icon",je),b(R,"slot","end"),j(J,"class","order svelte-1ita8l7"),j(K,"class","order-wrapper svelte-1ita8l7"),j(K,"title",D="$"+l[6].destination),c(K,"background-color",l[6].color),c(K,"color",Be(l[6].color)),b(Y,"slot","start"),b(ue,"color","#2e2e2e"),j(oe,"class","sub svelte-1ita8l7"),b(pe,"button",""),b(ve,"icon",je),b(ve,"slot","end")},m(Z,te){W(Z,t,te),W(Z,n,te),W(Z,i,te),r(i,o),l[30](o),r(i,s),r(i,h),r(h,E),r(E,m),r(m,_),r(_,v),r(E,y),r(E,w),r(w,B),r(B,S),r(S,H),r(w,Q),r(w,G),r(E,L),r(E,R),r(h,x);for(let X=0;X<I.length;X+=1)I[X]&&I[X].m(h,null);r(h,F),r(h,M),r(M,Y),r(Y,K),r(K,J),r(J,re),r(M,le),r(M,pe),r(pe,ue),r(ue,fe),r(fe,se),r(pe,ce),r(pe,oe),r(M,Ee),r(M,ve),ke||(de=[he(o,"ionRefresh",l[12]),he(w,"click",l[31]),he(pe,"click",l[33])],ke=!0)},p(Z,te){te[0]&131&&e!==(e=Z[16](Z[7],Z[1],Z[0])+"")&&Se(t,e),te[0]&64&&k!==(k="$"+Z[6].origin)&&j(_,"title",k),te[0]&64&&c(_,"background-color",Z[6].color),te[0]&64&&c(_,"color",Be(Z[6].color)),te[0]&64&&z!==(z=Z[6].origin+"")&&Se(H,z),te[0]&2638880&&(_e=Re(Z[5]),I=st(I,te,$,1,Z,_e,A,h,at,_n,F,sn)),te[0]&32&&ne!==(ne=Z[5].length+1+"")&&Se(re,ne),te[0]&64&&D!==(D="$"+Z[6].destination)&&j(K,"title",D),te[0]&64&&c(K,"background-color",Z[6].color),te[0]&64&&c(K,"color",Be(Z[6].color)),te[0]&64&&ae!==(ae=Z[6].destination+"")&&Se(se,ae)},d(Z){Z&&(u(t),u(n),u(i)),l[30](null);for(let te=0;te<I.length;te+=1)I[te].d();ke=!1,He(de)}}}function ro(l){let e,t,n='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Jale para actualizar" refreshing-spinner="circles" refreshing-text="Actualizando..."></ion-refresher-content>',i,o,a,s,h,E,m="0",_,v,p,k,y,w=l[6].origin+"",B,S,z,H,Q,G,L=[],R=new Map,x,I,A,F,M,Y=l[5].length+1+"",K,J,ne,re,D,le,pe=l[6].destination+"",ue,fe,ae,se="",ce,oe,ee,Ee,ve=Re(l[5]);const ke=de=>de[56].id_event;for(let de=0;de<ve.length;de+=1){let _e=an(l,ve,de),$=ke(_e);R.set($,L[de]=mn($,_e))}return{c(){e=d("ion-content"),t=d("ion-refresher"),t.innerHTML=n,i=N(),o=d("ion-list"),a=d("ion-item"),s=d("ion-avatar"),h=d("div"),E=d("div"),E.textContent=m,v=N(),p=d("ion-label"),k=d("ion-text"),y=d("h3"),B=Ie(w),S=N(),z=d("div"),H=N(),Q=d("ion-icon"),G=N();for(let de=0;de<L.length;de+=1)L[de].c();x=N(),I=d("ion-item"),A=d("ion-avatar"),F=d("div"),M=d("div"),K=Ie(Y),ne=N(),re=d("ion-label"),D=d("ion-text"),le=d("h3"),ue=Ie(pe),fe=N(),ae=d("div"),ae.innerHTML=se,ce=N(),oe=d("ion-icon"),this.h()},l(de){e=f(de,"ION-CONTENT",{});var _e=g(e);t=f(_e,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),ie(t)!=="svelte-vjbhg4"&&(t.innerHTML=n),i=T(_e),o=f(_e,"ION-LIST",{});var $=g(o);a=f($,"ION-ITEM",{});var Z=g(a);s=f(Z,"ION-AVATAR",{slot:!0});var te=g(s);h=f(te,"DIV",{class:!0,title:!0,style:!0});var X=g(h);E=f(X,"DIV",{class:!0,"data-svelte-h":!0}),ie(E)!=="svelte-b78non"&&(E.textContent=m),X.forEach(u),te.forEach(u),v=T(Z),p=f(Z,"ION-LABEL",{button:!0});var ge=g(p);k=f(ge,"ION-TEXT",{color:!0});var Me=g(k);y=f(Me,"H3",{});var Ce=g(y);B=Oe(Ce,w),Ce.forEach(u),Me.forEach(u),S=T(ge),z=f(ge,"DIV",{class:!0}),g(z).forEach(u),ge.forEach(u),H=T(Z),Q=f(Z,"ION-ICON",{icon:!0,slot:!0}),g(Q).forEach(u),Z.forEach(u),G=T($);for(let q=0;q<L.length;q+=1)L[q].l($);x=T($),I=f($,"ION-ITEM",{});var Ne=g(I);A=f(Ne,"ION-AVATAR",{slot:!0});var Ae=g(A);F=f(Ae,"DIV",{class:!0,title:!0,style:!0});var O=g(F);M=f(O,"DIV",{class:!0});var V=g(M);K=Oe(V,Y),V.forEach(u),O.forEach(u),Ae.forEach(u),ne=T(Ne),re=f(Ne,"ION-LABEL",{button:!0});var C=g(re);D=f(C,"ION-TEXT",{color:!0});var P=g(D);le=f(P,"H3",{});var U=g(le);ue=Oe(U,pe),U.forEach(u),P.forEach(u),fe=T(C),ae=f(C,"DIV",{class:!0,"data-svelte-h":!0}),ie(ae)!=="svelte-1c76q1w"&&(ae.innerHTML=se),C.forEach(u),ce=T(Ne),oe=f(Ne,"ION-ICON",{icon:!0,slot:!0}),g(oe).forEach(u),Ne.forEach(u),$.forEach(u),_e.forEach(u),this.h()},h(){b(t,"slot","fixed"),j(E,"class","order svelte-1ita8l7"),j(h,"class","order-wrapper svelte-1ita8l7"),j(h,"title",_="$"+l[6].origin),c(h,"background-color",l[6].color),c(h,"color",Be(l[6].color)),b(s,"slot","start"),b(k,"color","#2e2e2e"),j(z,"class","sub svelte-1ita8l7"),b(p,"button",""),b(Q,"icon",je),b(Q,"slot","end"),j(M,"class","order svelte-1ita8l7"),j(F,"class","order-wrapper svelte-1ita8l7"),j(F,"title",J="$"+l[6].destination),c(F,"background-color",l[6].color),c(F,"color",Be(l[6].color)),b(A,"slot","start"),b(D,"color","#2e2e2e"),j(ae,"class","sub svelte-1ita8l7"),b(re,"button",""),b(oe,"icon",je),b(oe,"slot","end")},m(de,_e){W(de,e,_e),r(e,t),l[26](t),r(e,i),r(e,o),r(o,a),r(a,s),r(s,h),r(h,E),r(a,v),r(a,p),r(p,k),r(k,y),r(y,B),r(p,S),r(p,z),r(a,H),r(a,Q),r(o,G);for(let $=0;$<L.length;$+=1)L[$]&&L[$].m(o,null);r(o,x),r(o,I),r(I,A),r(A,F),r(F,M),r(M,K),r(I,ne),r(I,re),r(re,D),r(D,le),r(le,ue),r(re,fe),r(re,ae),r(I,ce),r(I,oe),ee||(Ee=[he(t,"ionRefresh",l[12]),he(p,"click",l[27]),he(re,"click",l[29])],ee=!0)},p(de,_e){_e[0]&64&&_!==(_="$"+de[6].origin)&&j(h,"title",_),_e[0]&64&&c(h,"background-color",de[6].color),_e[0]&64&&c(h,"color",Be(de[6].color)),_e[0]&64&&w!==(w=de[6].origin+"")&&Se(B,w),_e[0]&2638880&&(ve=Re(de[5]),L=st(L,_e,ke,1,de,ve,R,o,at,mn,x,an)),_e[0]&32&&Y!==(Y=de[5].length+1+"")&&Se(K,Y),_e[0]&64&&J!==(J="$"+de[6].destination)&&j(F,"title",J),_e[0]&64&&c(F,"background-color",de[6].color),_e[0]&64&&c(F,"color",Be(de[6].color)),_e[0]&64&&pe!==(pe=de[6].destination+"")&&Se(ue,pe)},d(de){de&&u(e),l[26](null);for(let _e=0;_e<L.length;_e+=1)L[_e].d();ee=!1,He(Ee)}}}function hn(l){let e;return{c(){e=d("span"),this.h()},l(t){e=f(t,"SPAN",{class:!0}),g(e).forEach(u),this.h()},h(){j(e,"class","notes svelte-1ita8l7")},m(t,n){W(t,e,n)},d(t){t&&u(e)}}}function so(l){let e;return{c(){e=d("ion-icon"),this.h()},l(t){e=f(t,"ION-ICON",{icon:!0,slot:!0,style:!0}),g(e).forEach(u),this.h()},h(){b(e,"icon",je),b(e,"slot","end"),c(e,"color",Ue(l[56].status,l[56].date_service))},m(t,n){W(t,e,n)},p(t,n){n[0]&32&&c(e,"color",Ue(t[56].status,t[56].date_service))},d(t){t&&u(e)}}}function ao(l){let e,t=(l[56].tag?l[56].tag:"")+"",n;return{c(){e=d("div"),n=Ie(t),this.h()},l(i){e=f(i,"DIV",{class:!0,slot:!0,style:!0});var o=g(e);n=Oe(o,t),o.forEach(u),this.h()},h(){j(e,"class","stop-tag"),j(e,"slot","end"),c(e,"background-color",ze(l[56].tag_color,.3)),c(e,"border","1px solid "+ze(l[56].tag_color,.4)),c(e,"color",l[56].tag_color),c(e,"font-size","10px"),c(e,"text-align","center"),c(e,"align-content","center"),c(e,"border-radius","20px"),c(e,"white-space","normal"),c(e,"padding","3px 6px"),c(e,"width","auto",1),c(e,"display","inline-block"),c(e,"font-weight","500")},m(i,o){W(i,e,o),r(e,n)},p(i,o){o[0]&32&&t!==(t=(i[56].tag?i[56].tag:"")+"")&&Se(n,t),o[0]&32&&c(e,"background-color",ze(i[56].tag_color,.3)),o[0]&32&&c(e,"border","1px solid "+ze(i[56].tag_color,.4)),o[0]&32&&c(e,"color",i[56].tag_color)},d(i){i&&u(e)}}}function _n(l,e){let t,n,i,o,a=parseInt(e[56].pos)+1+"",s,h,E,m,_,v,p=e[56].title+"",k,y,w=e[56].support_list&&e[56].support_list.length||e[19](e[56]),B,S,z="",H,Q,G,L=w&&hn();function R(){return e[32](e[56])}function x(F,M){return F[56].tag_color&&F[56].tag?ao:so}let I=x(e),A=I(e);return{key:l,first:null,c(){t=d("ion-item"),n=d("ion-avatar"),i=d("div"),o=d("div"),s=Ie(a),E=N(),m=d("ion-label"),_=d("ion-text"),v=d("h3"),k=Ie(p),y=N(),L&&L.c(),B=N(),S=d("div"),S.innerHTML=z,H=N(),A.c(),this.h()},l(F){t=f(F,"ION-ITEM",{});var M=g(t);n=f(M,"ION-AVATAR",{slot:!0});var Y=g(n);i=f(Y,"DIV",{class:!0,title:!0,style:!0});var K=g(i);o=f(K,"DIV",{class:!0});var J=g(o);s=Oe(J,a),J.forEach(u),K.forEach(u),Y.forEach(u),E=T(M),m=f(M,"ION-LABEL",{button:!0});var ne=g(m);_=f(ne,"ION-TEXT",{color:!0});var re=g(_);v=f(re,"H3",{});var D=g(v);k=Oe(D,p),y=T(D),L&&L.l(D),D.forEach(u),re.forEach(u),B=T(ne),S=f(ne,"DIV",{class:!0,"data-svelte-h":!0}),ie(S)!=="svelte-1cx9r38"&&(S.innerHTML=z),ne.forEach(u),H=T(M),A.l(M),M.forEach(u),this.h()},h(){j(o,"class","order svelte-1ita8l7"),j(i,"class","order-wrapper svelte-1ita8l7"),j(i,"title",h=lt(e[56].status)),c(i,"background-color",Ue(e[56].status,e[56].date_service)),c(i,"color",Be(Ue(e[56].status))),b(n,"slot","start"),b(_,"color","#2e2e2e"),j(S,"class","sub svelte-1ita8l7"),b(m,"button",""),this.first=t},m(F,M){W(F,t,M),r(t,n),r(n,i),r(i,o),r(o,s),r(t,E),r(t,m),r(m,_),r(_,v),r(v,k),r(v,y),L&&L.m(v,null),r(m,B),r(m,S),r(t,H),A.m(t,null),Q||(G=he(m,"click",R),Q=!0)},p(F,M){e=F,M[0]&32&&a!==(a=parseInt(e[56].pos)+1+"")&&Se(s,a),M[0]&32&&h!==(h=lt(e[56].status))&&j(i,"title",h),M[0]&32&&c(i,"background-color",Ue(e[56].status,e[56].date_service)),M[0]&32&&c(i,"color",Be(Ue(e[56].status))),M[0]&32&&p!==(p=e[56].title+"")&&Se(k,p),M[0]&32&&(w=e[56].support_list&&e[56].support_list.length||e[19](e[56])),w?L||(L=hn(),L.c(),L.m(v,null)):L&&(L.d(1),L=null),I===(I=x(e))&&A?A.p(e,M):(A.d(1),A=I(e),A&&(A.c(),A.m(t,null)))},d(F){F&&u(t),L&&L.d(),A.d(),Q=!1,G()}}}function pn(l){let e;return{c(){e=d("span"),this.h()},l(t){e=f(t,"SPAN",{class:!0}),g(e).forEach(u),this.h()},h(){j(e,"class","notes svelte-1ita8l7")},m(t,n){W(t,e,n)},d(t){t&&u(e)}}}function co(l){let e;return{c(){e=d("ion-icon"),this.h()},l(t){e=f(t,"ION-ICON",{icon:!0,slot:!0,style:!0}),g(e).forEach(u),this.h()},h(){b(e,"icon",je),b(e,"slot","end"),c(e,"color",Ue(l[56].status,l[56].date_service))},m(t,n){W(t,e,n)},p(t,n){n[0]&32&&c(e,"color",Ue(t[56].status,t[56].date_service))},d(t){t&&u(e)}}}function uo(l){let e,t=(l[56].tag?l[56].tag:"")+"",n;return{c(){e=d("div"),n=Ie(t),this.h()},l(i){e=f(i,"DIV",{class:!0,slot:!0,style:!0});var o=g(e);n=Oe(o,t),o.forEach(u),this.h()},h(){j(e,"class","stop-tag"),j(e,"slot","end"),c(e,"background-color",ze(l[56].tag_color,.3)),c(e,"border","1px solid "+ze(l[56].tag_color,.4)),c(e,"color",l[56].tag_color),c(e,"font-size","10px"),c(e,"text-align","center"),c(e,"align-content","center"),c(e,"border-radius","20px"),c(e,"white-space","normal"),c(e,"padding","3px 6px"),c(e,"width","auto",1),c(e,"display","inline-block"),c(e,"font-weight","500")},m(i,o){W(i,e,o),r(e,n)},p(i,o){o[0]&32&&t!==(t=(i[56].tag?i[56].tag:"")+"")&&Se(n,t),o[0]&32&&c(e,"background-color",ze(i[56].tag_color,.3)),o[0]&32&&c(e,"border","1px solid "+ze(i[56].tag_color,.4)),o[0]&32&&c(e,"color",i[56].tag_color)},d(i){i&&u(e)}}}function mn(l,e){let t,n,i,o,a=parseInt(e[56].pos)+1+"",s,h,E,m,_,v,p=e[56].title+"",k,y,w=e[56].support_list&&e[56].support_list.length||e[19](e[56]),B,S,z="",H,Q,G,L=w&&pn();function R(){return e[28](e[56])}function x(F,M){return F[56].tag_color&&F[56].tag?uo:co}let I=x(e),A=I(e);return{key:l,first:null,c(){t=d("ion-item"),n=d("ion-avatar"),i=d("div"),o=d("div"),s=Ie(a),E=N(),m=d("ion-label"),_=d("ion-text"),v=d("h3"),k=Ie(p),y=N(),L&&L.c(),B=N(),S=d("div"),S.innerHTML=z,H=N(),A.c(),this.h()},l(F){t=f(F,"ION-ITEM",{});var M=g(t);n=f(M,"ION-AVATAR",{slot:!0});var Y=g(n);i=f(Y,"DIV",{class:!0,title:!0,style:!0});var K=g(i);o=f(K,"DIV",{class:!0});var J=g(o);s=Oe(J,a),J.forEach(u),K.forEach(u),Y.forEach(u),E=T(M),m=f(M,"ION-LABEL",{button:!0});var ne=g(m);_=f(ne,"ION-TEXT",{color:!0});var re=g(_);v=f(re,"H3",{});var D=g(v);k=Oe(D,p),y=T(D),L&&L.l(D),D.forEach(u),re.forEach(u),B=T(ne),S=f(ne,"DIV",{class:!0,"data-svelte-h":!0}),ie(S)!=="svelte-1cx9r38"&&(S.innerHTML=z),ne.forEach(u),H=T(M),A.l(M),M.forEach(u),this.h()},h(){j(o,"class","order svelte-1ita8l7"),j(i,"class","order-wrapper svelte-1ita8l7"),j(i,"title",h=lt(e[56].status)),c(i,"background-color",Ue(e[56].status,e[56].date_service)),c(i,"color",Be(Ue(e[56].status))),b(n,"slot","start"),b(_,"color","#2e2e2e"),j(S,"class","sub svelte-1ita8l7"),b(m,"button",""),this.first=t},m(F,M){W(F,t,M),r(t,n),r(n,i),r(i,o),r(o,s),r(t,E),r(t,m),r(m,_),r(_,v),r(v,k),r(v,y),L&&L.m(v,null),r(m,B),r(m,S),r(t,H),A.m(t,null),Q||(G=he(m,"click",R),Q=!0)},p(F,M){e=F,M[0]&32&&a!==(a=parseInt(e[56].pos)+1+"")&&Se(s,a),M[0]&32&&h!==(h=lt(e[56].status))&&j(i,"title",h),M[0]&32&&c(i,"background-color",Ue(e[56].status,e[56].date_service)),M[0]&32&&c(i,"color",Be(Ue(e[56].status))),M[0]&32&&p!==(p=e[56].title+"")&&Se(k,p),M[0]&32&&(w=e[56].support_list&&e[56].support_list.length||e[19](e[56])),w?L||(L=pn(),L.c(),L.m(v,null)):L&&(L.d(1),L=null),I===(I=x(e))&&A?A.p(e,M):(A.d(1),A=I(e),A&&(A.c(),A.m(t,null)))},d(F){F&&u(t),L&&L.d(),A.d(),Q=!1,G()}}}function fo(l){let e,t,n,i,o=`<ion-icon icon="${Kn}"></ion-icon>`,a,s,h,E=`<ion-icon icon="${Xn}"></ion-icon>`,m,_,v=`<ion-icon icon="${Jn}"></ion-icon>`,p,k,y=(l[6].name?l[6].name.toUpperCase():"")+"",w,B,S,z='<ion-segment-button value="list"><ion-label>Paradas</ion-label></ion-segment-button> <ion-segment-button value="map"><ion-label>Mapa</ion-label></ion-segment-button>',H,Q,G,L;function R(A,F){if(A[9]==="list")return eo;if(A[9]==="map")return $i}let x=R(l),I=x&&x(l);return{c(){e=d("ion-header"),t=d("ion-toolbar"),n=d("ion-buttons"),i=d("ion-button"),i.innerHTML=o,a=N(),s=d("ion-buttons"),h=d("ion-button"),h.innerHTML=E,m=N(),_=d("ion-button"),_.innerHTML=v,p=N(),k=d("ion-title"),w=Ie(y),B=N(),S=d("ion-segment"),S.innerHTML=z,H=N(),I&&I.c(),Q=Pe(),this.h()},l(A){e=f(A,"ION-HEADER",{translucent:!0});var F=g(e);t=f(F,"ION-TOOLBAR",{});var M=g(t);n=f(M,"ION-BUTTONS",{slot:!0});var Y=g(n);i=f(Y,"ION-BUTTON",{title:!0,alt:!0,"data-svelte-h":!0}),ie(i)!=="svelte-1a21unf"&&(i.innerHTML=o),Y.forEach(u),a=T(M),s=f(M,"ION-BUTTONS",{slot:!0});var K=g(s);h=f(K,"ION-BUTTON",{"data-svelte-h":!0}),ie(h)!=="svelte-dy3728"&&(h.innerHTML=E),m=T(K),_=f(K,"ION-BUTTON",{"data-svelte-h":!0}),ie(_)!=="svelte-1omw1hr"&&(_.innerHTML=v),K.forEach(u),p=T(M),k=f(M,"ION-TITLE",{});var J=g(k);w=Oe(J,y),J.forEach(u),M.forEach(u),B=T(F),S=f(F,"ION-SEGMENT",{value:!0,"data-svelte-h":!0}),ie(S)!=="svelte-1rseadq"&&(S.innerHTML=z),F.forEach(u),H=T(A),I&&I.l(A),Q=Pe(),this.h()},h(){b(i,"title","Atrás"),b(i,"alt","Atrás"),b(n,"slot","start"),b(s,"slot","end"),b(S,"value","list"),b(e,"translucent","")},m(A,F){W(A,e,F),r(e,t),r(t,n),r(n,i),r(t,a),r(t,s),r(s,h),r(s,m),r(s,_),r(t,p),r(t,k),r(k,w),r(e,B),r(e,S),W(A,H,F),I&&I.m(A,F),W(A,Q,F),G||(L=[he(i,"click",l[20]),he(h,"click",l[23]),he(_,"click",l[24]),he(S,"ionChange",l[25])],G=!0)},p(A,F){F[0]&64&&y!==(y=(A[6].name?A[6].name.toUpperCase():"")+"")&&Se(w,y),x===(x=R(A))&&I?I.p(A,F):(I&&I.d(1),I=x&&x(A),I&&(I.c(),I.m(Q.parentNode,Q)))},d(A){A&&(u(e),u(H),u(Q)),I&&I.d(A),G=!1,He(L)}}}function vn(l){let e,t='<ion-spinner name="dots" style="color:white;"></ion-spinner>';return{c(){e=d("div"),e.innerHTML=t,this.h()},l(n){e=f(n,"DIV",{class:!0,style:!0,"data-svelte-h":!0}),ie(e)!=="svelte-1aosxw0"&&(e.innerHTML=t),this.h()},h(){j(e,"class","overlay"),c(e,"position","fixed"),c(e,"top","0"),c(e,"left","0"),c(e,"width","100vw"),c(e,"height","100vh"),c(e,"background","rgba(0, 0, 0, 0.5)"),c(e,"display","flex"),c(e,"align-items","center"),c(e,"justify-content","center"),c(e,"z-index","9999")},m(n,i){W(n,e,i)},d(n){n&&u(e)}}}function ho(l){let e,t,n,i,o=l[2]&&cn(l),a=l[11]&&vn();return{c(){e=N(),o&&o.c(),t=N(),a&&a.c(),n=Pe(),this.h()},l(s){Sn("svelte-kn0kph",ln.head).forEach(u),e=T(s),o&&o.l(s),t=T(s),a&&a.l(s),n=Pe(),this.h()},h(){ln.title="Rutaflow - Detalles de ruta"},m(s,h){W(s,e,h),o&&o.m(s,h),W(s,t,h),a&&a.m(s,h),W(s,n,h),i=!0},p(s,h){s[2]?o?(o.p(s,h),h[0]&4&&$e(o,1)):(o=cn(s),o.c(),$e(o,1),o.m(t.parentNode,t)):o&&(Dn(),ot(o,1,1,()=>{o=null}),An()),s[11]?a||(a=vn(),a.c(),a.m(n.parentNode,n)):a&&(a.d(1),a=null)},i(s){i||($e(o),i=!0)},o(s){ot(o),i=!1},d(s){s&&(u(e),u(t),u(n)),o&&o.d(s),a&&a.d(s)}}}function Ue(l,e=""){let t="#ffffff";return l==="pending"&&!e?t="#f2e300":l=="pending"&&e?t="#F6A833":l==="completed"&&(t="#44d900"),t}function lt(l){let e="";return l=="pending"?e="Pendiente":l=="completed"&&(e="Completado"),e}function Be(l){l.slice(0,1)==="#"&&(l=l.slice(1)),l.length===3&&(l=l.split("").map(function(o){return o+o}).join(""));const e=parseInt(l.substr(0,2),16),t=parseInt(l.substr(2,2),16),n=parseInt(l.substr(4,2),16);return(e*299+t*587+n*114)/1e3>=128?"#414040":"#fff"}function ft(l,e){for(let t=0;t<e.length;t++)if(e[t].alias===l)return e[t].val;return""}const _o=l=>l.mandatory==="1",po=l=>l.img;function mo(l,e,t){let n;Pn(l,Yn,O=>t(22,n=O));var i=this&&this.__awaiter||function(O,V,C,P){function U(q){return q instanceof C?q:new C(function(me){me(q)})}return new(C||(C=Promise))(function(q,me){function we(be){try{ye(P.next(be))}catch(De){me(De)}}function Te(be){try{ye(P.throw(be))}catch(De){me(De)}}function ye(be){be.done?q(be.value):U(be.value).then(we,Te)}ye((P=P.apply(O,V||[])).next())})};let{routeId:o}=e,{driverId:a}=e,s=ct,h=new Object,E=!0,m=!1,_=[],v=[],p={},k=[],y=[],w,B=!1,S="list",z,H="",Q="",G="",L="0",R=new Object,x="",I=!1;const A={car_accident:"/car-accident.svg",restaurant:"/restaurant.svg",parking:"/parking.svg",hospital:"/hospital.svg",wc:"/toilet.svg",traffic:"/traffic.svg"},F=()=>i(void 0,void 0,void 0,function*(){yield K(o),w.complete()});et(()=>i(void 0,void 0,void 0,function*(){oe(),yield K(o)}));function M(O){return i(this,void 0,void 0,function*(){if(t(9,S=O),S==="map"){yield Ot(),z=document.getElementById("g_map");const V=new google.maps.Map(z,{zoom:8,center:{lat:20.6745683,lng:-103.3986104},mapId:"4504f8b37365c3d0"}),C=new google.maps.LatLngBounds,{AdvancedMarkerElement:P,PinElement:U}=yield google.maps.importLibrary("marker");navigator.geolocation?navigator.geolocation.getCurrentPosition(function(q){const me=new google.maps.LatLng(q.coords.latitude,q.coords.longitude);new google.maps.Marker({position:me,map:V,icon:{path:google.maps.SymbolPath.CIRCLE,fillColor:"#0062ff",fillOpacity:1,scale:6,strokeColor:"#ffffff",strokeWeight:2}}),new google.maps.Circle({strokeColor:"#00BFFF",strokeOpacity:.5,strokeWeight:1,fillColor:"#00BFFF",fillOpacity:.2,map:V,center:me,radius:q.coords.accuracy}),C.extend(me)},function(q){console.error("Error retrieving location:",q)}):console.error("Geolocation not supported by this browser."),p.lat1===p.lat2&&p.lon1===p.lon2?Y(C,V,{lat:p.lat2,lon:p.lon2,color:p.color,title:p.destination},{type:"icon",iconClass:"icon-home",title:"Origen/Destino",glyph:`0,${String(_.length+1)}`}):(Y(C,V,{lat:p.lat1,lon:p.lon1,color:p.color,title:p.origin},{type:"icon",iconClass:"icon-home",title:"Origen",glyph:"0"}),Y(C,V,{lat:p.lat2,lon:p.lon2,color:p.color,title:p.destination},{type:"icon",iconClass:"icon-flag",title:"Destino",glyph:String(_.length+1)})),_.forEach((q,me)=>{const we=parseFloat(q.lat),Te=parseFloat(q.lon),ye=new google.maps.LatLng(we,Te),be=new google.maps.Marker({position:{lat:we,lng:Te},map:V,title:q.title}),De=new U({background:Ue(q.status,q.date_service),borderColor:"#000",glyphColor:"#000",glyph:(parseInt(q.pos)+1).toString()});new P({map:V,position:ye,content:De.element,title:"Parada "+(parseInt(q.pos)+1).toString()+": "+q.title}).addListener("click",function(nt){ne(q,!1)}),C.extend(be.getPosition())}),v.forEach(q=>{const me=+q.lat,we=+q.lng;if(isNaN(me)||isNaN(we))return;const Te=A[q.type]||"alert-sharp",ye=document.createElement("div");ye.style.cssText="display:flex;align-items:center;justify-content:center;transform:scale(.85);";const be=document.createElement("ion-icon");Te.startsWith("/")?be.setAttribute("src",Te):be.setAttribute("icon",Te),be.style.cssText="font-size:20px;color:#d13434;",ye.appendChild(be);const De=new U({background:"#fff",borderColor:"#000",glyph:ye}),We=new P({map:V,position:{lat:me,lng:we},content:De.element,title:q.motive||q.type});C.extend(We.position)}),V.fitBounds(C)}})}function Y(O,V,C,P){return i(this,void 0,void 0,function*(){let U;const q=parseFloat(C.lat),me=parseFloat(C.lon),we=new google.maps.LatLng(q,me),{AdvancedMarkerElement:Te,PinElement:ye}=yield google.maps.importLibrary("marker");P.type=="icon"?(U=document.createElement("i"),U.className=`${P.iconClass} icon`,U.style.fontSize="14px",U.style.color=Be(C.color),U.style.fontWeight="600"):P.type=="text";const be=new google.maps.Marker({position:{lat:q,lng:me},map:V,title:`${P.title}. ${C.title}`}),De=new ye({background:C.color,borderColor:"#000",glyphColor:Be(C.color),glyph:P.glyph});return new Te({map:V,position:we,content:De.element,title:P.title+": "+C.title}).addListener("click",function(nt){re(p,P.title=="Destino"||P.title=="Origen/Destino")}),be})}function K(O){return i(this,void 0,void 0,function*(){let V=new FormData;V.append("id_route",O),V=ce(V),V.append("id_enterprise",h.id_enterprise);try{const P=yield(yield fetch(`${s}api/admin/report/seguimiento_list.php`,{method:"POST",body:V})).json();t(6,p=P.data.seguimiento_list[0]),t(5,_=P.data.event_list),t(7,k=P.data.checklist),y=P.data.expenses,v=P.data.incidence_list,p&&t(4,m=p.km_inicial=="0"&&p.gas_inicial=="0"),t(3,E=!1)}catch(C){t(3,E=!1),console.error("Error fetching data:",C)}})}const J=O=>new Promise((V,C)=>{let P=new FormData;P.append("id_route",O.id_route),P.append("id_event",O.id_event),P=ce(P),fetch(`${s}api/admin/evidence/evidence_by_event.php`,{method:"POST",body:P}).then(U=>U.json()).then(U=>{V(U.data.event_evidence[0])}).catch(U=>{console.error("Error fetching data:",U),C(U)})});function ne(O,V){return x||(x=i(this,void 0,void 0,function*(){let C=null;try{C=yield J(O)}catch{}const P=Object.assign(Object.assign(Object.assign({},O),{stopsApproval:H,smsActive:Q,signatureActive:G}),C||{});try{yield qe("modal-delivery-info",Ft,{delivery:P,isLast:V})}finally{x=null,K(o)}}),x)}const re=(O,V)=>{var C=new Object;V?C={title:O.destination,line1:O.dest_address}:C={title:O.origin,line1:O.origin_address},C.enterprise_name=O.enterprise_name,C.client_name=O.client_name,C.client_phone=O.tel,C.id_route=O.id_route,C.stopsApproval=H,C.smsActive=Q;var P=!0;qe("modal-delivery-info",Ft,{delivery:C,isLast:V,flag:P})},D=(O,V,C)=>{var P=!1;return t(11,I=!0),B||(B=!0,qe("modal-checklist",Tn,{checklist:O,driverId:V,routeId:C,isLast:P}).then(U=>{t(11,I=!1),B=!1}),fe(C,"checklist")),""},le=O=>i(void 0,void 0,void 0,function*(){return t(11,I=!0),yield K(O),y.length>0?qe("modal-expense-detail",Zi,{routeId:O,expenses:y}).then(V=>{t(11,I=!1)}):qe("modal-expense",Et,{routeId:O}).then(V=>{t(11,I=!1)}),""}),pe=O=>i(void 0,void 0,void 0,function*(){return t(11,I=!0),yield K(O),qe("modal-incidence",Ki,{routeId:O}).then(V=>{t(11,I=!1)}),""}),ue=O=>{if(O.tracking_type=="subscription"){if(O.subscriber_info&&O.payment_type==="cash"&&new Date(O.subscriber_info.payment_next)<new Date)return!0}else if(O.tracking_type=="ecommerce"&&Number(O.payment_pending)>0)return!0;return!1};function fe(O,V){let C=new FormData;return C.append("id_route",O),C.append("status",V),C=ce(C),fetch(`${s}api/admin/route/change_status.php`,{method:"POST",body:C}).then(P=>P.json()).then(P=>{}).catch(P=>{console.error("Error fetching data:",P)}),""}const ae=()=>{h.type=="super"||h.type=="admin"?Ze("/drivers/me"):h.id_driver&&Ze(`/drivers/${h.id_driver}`)},se=(O,V)=>i(void 0,void 0,void 0,function*(){yield(yield Ge.create({header:O||"Error",message:V||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()});function ce(O){return O.append("token",h.token),O.append("id_user_over",h.id_user),O}const oe=()=>i(void 0,void 0,void 0,function*(){if(h.id_enterprise){let O=new FormData;O.append("id_enterprise",h.id_enterprise),O=ce(O);try{const V=yield fetch(`${s}api/admin/enterprise/enterprise_settings.php`,{method:"POST",body:O});V.ok?(R=(yield V.json()).nodos,H=ft("stops_wait_approval",R),Q=ft("sms_active",R),t(10,L=ft("stops_order_restriction",R)),G=ft("signature_active",R)):console.error("File upload failed:",V.statusText)}catch(V){console.error("Error during file upload:",V)}}}),ee=()=>pe(o),Ee=()=>le(o),ve=O=>M(O.detail.value);function ke(O){xe[O?"unshift":"push"](()=>{w=O,t(8,w)})}const de=()=>{re(p,!1)},_e=O=>{const V=_.findIndex(me=>me.id_event===O.id_event),C=V===0,P=V>0?_[V-1]:null,U=C||P&&P.img!==null,q=O.img!==null&&O.img!=="";U||C&&!q||L=="1"?ne(O,!1):se("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")},$=()=>{re(p,!0)};function Z(O){xe[O?"unshift":"push"](()=>{w=O,t(8,w)})}const te=()=>{re(p,!1)},X=O=>{const V=_.findIndex(me=>me.id_event===O.id_event),C=V===0,P=V>0?_[V-1]:null,U=C||P&&P.img!==null,q=O.img!==null&&O.img!=="";U||C&&!q||L=="1"?ne(O,!1):se("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")},ge=()=>{re(p,!0)};function Me(O){xe[O?"unshift":"push"](()=>{w=O,t(8,w)})}const Ce=()=>{re(p,!1)},Ne=O=>{const V=_.findIndex(me=>me.id_event===O.id_event),C=V===0,P=V>0?_[V-1]:null,U=C||P&&P.img!==null,q=O.img!==null&&O.img!=="";U||C&&!q||L=="1"?ne(O,!1):se("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")},Ae=()=>{re(p,!0)};return l.$$set=O=>{"routeId"in O&&t(0,o=O.routeId),"driverId"in O&&t(1,a=O.driverId)},l.$$.update=()=>{l.$$.dirty[0]&4194309&&(t(0,{routeId:o,driverId:a}=n.params,o,(t(1,a),t(22,n),t(2,h),t(0,o))),t(2,h=JSON.parse(localStorage.getItem("userSession"))),h?h.id_user&&(h.type=="admin"||h.type=="super")?(K(o),Ze(`/drivers/me/routes/${o}`)):h.id_user&&h.id_driver&&(K(o),Ze(`/drivers/${h.id_driver}/routes/${o}`)):Ze("/"))},[o,a,h,E,m,_,p,k,w,S,L,I,F,M,ne,re,D,le,pe,ue,ae,se,n,ee,Ee,ve,ke,de,_e,$,Z,te,X,ge,Me,Ce,Ne,Ae]}class yo extends Ye{constructor(e){super(),Qe(this,e,mo,ho,Je,{routeId:0,driverId:1},null,[-1,-1])}}export{yo as component};

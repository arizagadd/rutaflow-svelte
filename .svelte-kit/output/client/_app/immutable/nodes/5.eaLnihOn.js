<<<<<<<< HEAD:.svelte-kit/output/client/_app/immutable/nodes/5.BekgpHgO.js
import{Z as Ot,s as nt,e as f,j as O,b as h,q as g,d as te,h as u,m as N,v as E,i as q,w as r,x as ae,n as Me,z as Fe,_ as Bn,k as Ue,B as c,o as rt,$ as Nt,t as Ne,r as Te,f as W,a0 as Dt,y as De,a1 as ct,A as He,F as Tt,J as Un,a2 as bt,a3 as Ye,a4 as Ct,a5 as Lt,a6 as Bt,a7 as Ut,l as zn,p as Hn}from"../chunks/index.BgXu2Isl.js";import{S as it,i as ot,b as Nn,d as Tn,m as Cn,t as ut,a as pt,e as Ln,c as Rn,g as Vn}from"../chunks/index.Dk8PUFqT.js";import{e as We,u as dt,d as ft,g as Je,a as et,h as Ge,b as Fn,c as qn,i as Mn,f as Wn,j as Sn,k as jn,m as Gn,n as mt,o as Kn,q as Mt,r as xn,s as Pn,t as St,v as Qe,w as Xn,x as Jn,y as xt,z as Pt,A as Yn,B as Qn,I as Zn,C as $n,D as ei,E as ti,p as ni}from"../chunks/index.BtmbPM9x.js";import"../chunks/index-6e05b96e.C_9q9BoX.js";import{m as tt,D as ht,a as $e,W as ii,b as oi}from"../chunks/overlays-b874c3c3.Cx2RvPDD.js";import{q as li,t as ri}from"../chunks/ion-modal.BYMRzj9z.js";import{g as lt}from"../chunks/entry.ajYgCYmH.js";const si=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global,ai=(l,e)=>{if(!customElements.get(l)){class t extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){new e({target:this.shadowRoot,props:this.componentProps||{}})}}customElements.define(l,t)}},ci=l=>document.createElement(l).constructor!==HTMLElement,ui=(l,e)=>{ci(l)||ai(l,e)},Ze=async(l,e,t={},n={})=>{li(),ri(),ui(l,e);const i=await tt.create({component:l,componentProps:t,...n});return i.addEventListener("ionModalDidPresent",()=>{const o=i.querySelector(l);o&&(o.componentProps=t)}),await i.present(),i.onWillDismiss()};let st=Ot({km_inicial:[],gas_inicial:[],km_final:[],gas_final:[]}),An=Ot({flag:[]});function di(l){let e,t,n,i,o="Cancelar",s,a,d="Captura de Km/Gas",k,v,p,m="Confirmar",_,b,y,w,R,P,D;return{c(){e=f("ion-header"),t=f("ion-toolbar"),n=f("ion-buttons"),i=f("ion-button"),i.textContent=o,s=O(),a=f("ion-title"),a.textContent=d,k=O(),v=f("ion-buttons"),p=f("ion-button"),p.textContent=m,_=O(),b=f("ion-content"),y=f("ion-item"),w=f("ion-input"),this.h()},l(x){e=h(x,"ION-HEADER",{translucent:!0});var V=g(e);t=h(V,"ION-TOOLBAR",{});var U=g(t);n=h(U,"ION-BUTTONS",{slot:!0});var C=g(n);i=h(C,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),te(i)!=="svelte-17pq4f4"&&(i.textContent=o),C.forEach(u),s=N(U),a=h(U,"ION-TITLE",{"data-svelte-h":!0}),te(a)!=="svelte-1yhkaq7"&&(a.textContent=d),k=N(U),v=h(U,"ION-BUTTONS",{slot:!0});var H=g(v);p=h(H,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),te(p)!=="svelte-cm6j4s"&&(p.textContent=m),H.forEach(u),U.forEach(u),V.forEach(u),_=N(x),b=h(x,"ION-CONTENT",{fullscreen:!0});var B=g(b);y=h(B,"ION-ITEM",{});var I=g(y);w=h(I,"ION-INPUT",{class:!0,inputmode:!0,pattern:!0,type:!0,placeholder:!0,value:!0,required:!0});var T=g(w);T.forEach(u),I.forEach(u),B.forEach(u),this.h()},h(){E(i,"color","medium"),E(n,"slot","start"),E(p,"strong",""),E(v,"slot","end"),E(e,"translucent",""),E(w,"class","fin-km"),E(w,"inputmode","numeric"),E(w,"pattern","[0-9]*"),E(w,"type","number"),E(w,"placeholder",R="Ingresa "+l[0]+" actual"),E(w,"value",l[1]),E(w,"required",""),E(b,"fullscreen","")},m(x,V){q(x,e,V),r(e,t),r(t,n),r(n,i),r(t,s),r(t,a),r(t,k),r(t,v),r(v,p),q(x,_,V),q(x,b,V),r(b,y),r(y,w),P||(D=[ae(i,"click",l[2]),ae(p,"click",l[3]),ae(w,"input",l[4])],P=!0)},p(x,[V]){V&1&&R!==(R="Ingresa "+x[0]+" actual")&&E(w,"placeholder",R),V&2&&E(w,"value",x[1])},i:Me,o:Me,d(x){x&&(u(e),u(_),u(b)),P=!1,Fe(D)}}}function fi(l,e,t){const n=Bn();let o=document.querySelector("ion-modal").componentProps.data_type,s="";An.subscribe(p=>{o=p.flag[0],o=="km_final"||o=="km_inicial"?t(0,s="kilometraje"):t(0,s="litros de gasolina")});let a=0;function d(){tt.dismiss()}function k(){n("modalResult",{data:"Your data",role:"confirm"}),o=="km_inicial"?st.update(m=>({...m,km_inicial:[a]})):o=="gas_inicial"?st.update(m=>({...m,gas_inicial:[a]})):o=="km_final"?st.update(m=>({...m,km_final:[a]})):o=="gas_final"&&st.update(m=>({...m,gas_final:[a]})),d()}return[s,a,d,k,p=>t(1,a=p.target.value)]}class hi extends it{constructor(e){super(),ot(this,e,fi,di,nt,{})}}const It=Ot({items:[],checkedIndices:[],mandatory:[]});function zt(l,e,t){const n=l.slice();return n[57]=e[t],n[58]=e,n[59]=t,n}function _i(l){let e,t,n,i,o,s="Kilometraje inicial",a,d,k=l[2]?l[2]+" km.":"Cargar km",v,p,m,_,b,y,w,R="Gasolina inicial (litros)",P,D,x=l[3]?l[3]+" litros":"Cargar gas",V,U,C,H;return U=Nt(l[22][0]),{c(){e=f("ion-item"),t=f("ion-label"),n=f("input"),i=O(),o=f("p"),o.textContent=s,a=O(),d=f("ion-button"),v=Ne(k),p=O(),m=f("ion-item"),_=f("ion-label"),b=f("input"),y=O(),w=f("p"),w.textContent=R,P=O(),D=f("ion-button"),V=Ne(x),this.h()},l(B){e=h(B,"ION-ITEM",{});var I=g(e);t=h(I,"ION-LABEL",{style:!0});var T=g(t);n=h(T,"INPUT",{id:!0,style:!0,type:!0}),i=N(T),o=h(T,"P",{style:!0,"data-svelte-h":!0}),te(o)!=="svelte-88twxi"&&(o.textContent=s),T.forEach(u),a=N(I),d=h(I,"ION-BUTTON",{fill:!0,size:!0,class:!0,"aria-selected":!0});var A=g(d);v=Te(A,k),A.forEach(u),I.forEach(u),p=N(B),m=h(B,"ION-ITEM",{});var S=g(m);_=h(S,"ION-LABEL",{style:!0});var X=g(_);b=h(X,"INPUT",{id:!0,style:!0,type:!0}),y=N(X),w=h(X,"P",{style:!0,"data-svelte-h":!0}),te(w)!=="svelte-1ux30eb"&&(w.textContent=R),X.forEach(u),P=N(S),D=h(S,"ION-BUTTON",{fill:!0,class:!0,size:!0,style:!0});var ne=g(D);V=Te(ne,x),ne.forEach(u),S.forEach(u),this.h()},h(){W(n,"id","chkbox-km-ini"),c(n,"pointer-events","auto"),W(n,"type","checkbox"),n.required=!0,c(o,"margin-left","10px"),c(t,"display","flex"),E(d,"fill","outline"),E(d,"size","small"),E(d,"class","loadKmInicial"),E(d,"aria-selected",""),W(b,"id","chkbox-gas-ini"),c(b,"pointer-events","auto"),W(b,"type","checkbox"),b.required=!0,c(w,"margin-left","10px"),c(_,"display","flex"),E(D,"fill","outline"),E(D,"class","loadGasInicial"),E(D,"size","small"),c(D,"height","16px "),U.p(n,b)},m(B,I){q(B,e,I),r(e,t),r(t,n),n.checked=~(l[6]||[]).indexOf(n.__value),l[29](n),r(t,i),r(t,o),r(e,a),r(e,d),r(d,v),q(B,p,I),q(B,m,I),r(m,_),r(_,b),l[31](b),b.checked=~(l[6]||[]).indexOf(b.__value),r(_,y),r(_,w),r(m,P),r(m,D),r(D,V),C||(H=[ae(n,"change",l[28]),ae(d,"click",l[30]),ae(b,"change",l[32]),ae(D,"click",l[33])],C=!0)},p(B,I){I[0]&65&&(n.checked=~(B[6]||[]).indexOf(n.__value)),I[0]&4&&k!==(k=B[2]?B[2]+" km.":"Cargar km")&&De(v,k),I[0]&65&&(b.checked=~(B[6]||[]).indexOf(b.__value)),I[0]&8&&x!==(x=B[3]?B[3]+" litros":"Cargar gas")&&De(V,x)},d(B){B&&(u(e),u(p),u(m)),l[29](null),l[31](null),U.r(),C=!1,Fe(H)}}}function pi(l){let e,t,n,i,o,s="Kilometraje final",a,d,k=l[4]?l[4]+" km.":"Cargar km",v,p,m,_,b,y,w,R="Gasolina final (litros)",P,D,x=l[5]?l[5]+" litros":"Cargar gas",V,U,C,H;return U=Nt(l[22][0]),{c(){e=f("ion-item"),t=f("ion-label"),n=f("input"),i=O(),o=f("p"),o.textContent=s,a=O(),d=f("ion-button"),v=Ne(k),p=O(),m=f("ion-item"),_=f("ion-label"),b=f("input"),y=O(),w=f("p"),w.textContent=R,P=O(),D=f("ion-button"),V=Ne(x),this.h()},l(B){e=h(B,"ION-ITEM",{});var I=g(e);t=h(I,"ION-LABEL",{style:!0});var T=g(t);n=h(T,"INPUT",{id:!0,style:!0,type:!0}),i=N(T),o=h(T,"P",{style:!0,"data-svelte-h":!0}),te(o)!=="svelte-ccmu71"&&(o.textContent=s),T.forEach(u),a=N(I),d=h(I,"ION-BUTTON",{fill:!0,size:!0,class:!0,"aria-selected":!0});var A=g(d);v=Te(A,k),A.forEach(u),I.forEach(u),p=N(B),m=h(B,"ION-ITEM",{});var S=g(m);_=h(S,"ION-LABEL",{style:!0});var X=g(_);b=h(X,"INPUT",{id:!0,style:!0,type:!0}),y=N(X),w=h(X,"P",{style:!0,"data-svelte-h":!0}),te(w)!=="svelte-wsoyd2"&&(w.textContent=R),X.forEach(u),P=N(S),D=h(S,"ION-BUTTON",{fill:!0,size:!0,class:!0});var ne=g(D);V=Te(ne,x),ne.forEach(u),S.forEach(u),this.h()},h(){W(n,"id","chkbox-km-fin"),c(n,"pointer-events","auto"),W(n,"type","checkbox"),n.required=!0,c(o,"margin-left","10px"),c(t,"display","flex"),E(d,"fill","outline"),E(d,"size","small"),E(d,"class","loadKmInicial"),E(d,"aria-selected",""),W(b,"id","chkbox-gas-fin"),c(b,"pointer-events","auto"),W(b,"type","checkbox"),b.required=!0,c(w,"margin-left","10px"),c(_,"display","flex"),E(D,"fill","outline"),E(D,"size","small"),E(D,"class","loadGasInicial"),U.p(n,b)},m(B,I){q(B,e,I),r(e,t),r(t,n),n.checked=~(l[6]||[]).indexOf(n.__value),l[23](n),r(t,i),r(t,o),r(e,a),r(e,d),r(d,v),q(B,p,I),q(B,m,I),r(m,_),r(_,b),b.checked=~(l[6]||[]).indexOf(b.__value),l[26](b),r(_,y),r(_,w),r(m,P),r(m,D),r(D,V),C||(H=[ae(n,"change",l[21]),ae(d,"click",l[24]),ae(b,"change",l[25]),ae(D,"click",l[27])],C=!0)},p(B,I){I[0]&65&&(n.checked=~(B[6]||[]).indexOf(n.__value)),I[0]&16&&k!==(k=B[4]?B[4]+" km.":"Cargar km")&&De(v,k),I[0]&65&&(b.checked=~(B[6]||[]).indexOf(b.__value)),I[0]&32&&x!==(x=B[5]?B[5]+" litros":"Cargar gas")&&De(V,x)},d(B){B&&(u(e),u(p),u(m)),l[23](null),l[26](null),U.r(),C=!1,Fe(H)}}}function Ht(l){let e=[],t=new Map,n,i=We(l[0]);const o=s=>s[57].id_checklist_event;for(let s=0;s<i.length;s+=1){let a=zt(l,i,s),d=o(a);t.set(d,e[s]=Rt(d,a))}return{c(){for(let s=0;s<e.length;s+=1)e[s].c();n=Ue()},l(s){for(let a=0;a<e.length;a+=1)e[a].l(s);n=Ue()},m(s,a){for(let d=0;d<e.length;d+=1)e[d]&&e[d].m(s,a);q(s,n,a)},p(s,a){a[0]&827841&&(i=We(s[0]),e=dt(e,a,o,1,s,i,t,n.parentNode,ft,Rt,n,zt))},d(s){s&&u(n);for(let a=0;a<e.length;a+=1)e[a].d(s)}}}function mi(l){let e,t=(l[15][l[57].id_checklist_event]?l[15][l[57].id_checklist_event]:"Cargar evidencia")+"",n,i;return{c(){e=f("label"),n=Ne(t),this.h()},l(o){e=h(o,"LABEL",{for:!0,class:!0});var s=g(e);n=Te(s,t),s.forEach(u),this.h()},h(){W(e,"for",i="chklist-"+l[57].id_checklist_event),W(e,"class","button-label")},m(o,s){q(o,e,s),r(e,n)},p(o,s){s[0]&32769&&t!==(t=(o[15][o[57].id_checklist_event]?o[15][o[57].id_checklist_event]:"Cargar evidencia")+"")&&De(n,t),s[0]&1&&i!==(i="chklist-"+o[57].id_checklist_event)&&W(e,"for",i)},d(o){o&&u(e)}}}function vi(l){let e;return{c(){e=f("ion-spinner"),this.h()},l(t){e=h(t,"ION-SPINNER",{name:!0,class:!0}),g(e).forEach(u),this.h()},h(){E(e,"name","dots"),E(e,"class","button-spinner")},m(t,n){q(t,e,n)},p:Me,d(t){t&&u(e)}}}function Rt(l,e){let t,n,i,o,s,a=!1,d=e[57],k,v,p=e[57].item+"",m,_,b,y=e[57].mandatory=="1"?" * ":"",w,R,P,D,x,V,U,C,H,B,I;const T=()=>e[35](i,d),A=()=>e[35](null,d);function S(){return e[36](e[57])}function X(Z,L){return Z[13][Z[57].id_checklist_event]?vi:mi}let ne=X(e),re=ne(e);function Ee(...Z){return e[38](e[57],...Z)}return H=Nt(e[22][0]),{key:l,first:null,c(){t=f("ion-item"),n=f("ion-label"),i=f("input"),k=O(),v=f("p"),m=Ne(p),_=O(),b=f("b"),w=Ne(y),R=O(),P=f("ion-button"),D=f("div"),re.c(),x=O(),V=f("input"),C=O(),this.h()},l(Z){t=h(Z,"ION-ITEM",{});var L=g(t);n=h(L,"ION-LABEL",{style:!0});var $=g(n);i=h($,"INPUT",{id:!0,style:!0,type:!0}),k=N($),v=h($,"P",{style:!0});var ue=g(v);m=Te(ue,p),ue.forEach(u),_=N($),b=h($,"B",{style:!0});var pe=g(b);w=Te(pe,y),pe.forEach(u),$.forEach(u),R=N(L),P=h(L,"ION-BUTTON",{fill:!0,class:!0,size:!0});var fe=g(P);D=h(fe,"DIV",{class:!0});var ce=g(D);re.l(ce),x=N(ce),V=h(ce,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0,capture:!0}),ce.forEach(u),fe.forEach(u),C=N(L),L.forEach(u),this.h()},h(){W(i,"id",o=`chkbox-${e[57].id_checklist_event}`),c(i,"pointer-events","auto"),W(i,"type","checkbox"),i.__value=s=e[57].id_checklist_event,Dt(i,i.__value),i.required=!0,c(v,"margin-left","10px"),c(b,"margin-left","5px"),c(n,"display","flex"),c(V,"display","none"),W(V,"id",U="chklist-"+e[57].id_checklist_event),W(V,"name","fileToUpload"),W(V,"type","file"),W(V,"accept","image/*"),W(V,"capture","environment"),W(D,"class","button-content"),E(P,"fill","outline"),E(P,"class","loadEvidence"),E(P,"size","small"),H.p(i),this.first=t},m(Z,L){q(Z,t,L),r(t,n),r(n,i),i.checked=~(e[6]||[]).indexOf(i.__value),T(),r(n,k),r(n,v),r(v,m),r(n,_),r(n,b),r(b,w),r(t,R),r(t,P),r(P,D),re.m(D,null),r(D,x),r(D,V),e[37](V),r(t,C),B||(I=[ae(i,"change",e[34]),ae(i,"change",S),ae(V,"change",Ee)],B=!0)},p(Z,L){e=Z,L[0]&1&&o!==(o=`chkbox-${e[57].id_checklist_event}`)&&W(i,"id",o),L[0]&1&&s!==(s=e[57].id_checklist_event)&&(i.__value=s,Dt(i,i.__value),a=!0),(a||L[0]&65)&&(i.checked=~(e[6]||[]).indexOf(i.__value)),d!==e[57]&&(A(),d=e[57],T()),L[0]&1&&p!==(p=e[57].item+"")&&De(m,p),L[0]&1&&y!==(y=e[57].mandatory=="1"?" * ":"")&&De(w,y),ne===(ne=X(e))&&re?re.p(e,L):(re.d(1),re=ne(e),re&&(re.c(),re.m(D,x))),L[0]&1&&U!==(U="chklist-"+e[57].id_checklist_event)&&W(V,"id",U)},d(Z){Z&&u(t),A(),re.d(),e[37](null),H.r(),B=!1,Fe(I)}}}function Vt(l){let e,t='<ion-spinner name="dots" style="color:white;"></ion-spinner>';return{c(){e=f("div"),e.innerHTML=t,this.h()},l(n){e=h(n,"DIV",{class:!0,style:!0,"data-svelte-h":!0}),te(e)!=="svelte-1muo9sg"&&(e.innerHTML=t),this.h()},h(){W(e,"class","overlay"),c(e,"position","fixed"),c(e,"top","0"),c(e,"left","0"),c(e,"width","100vw"),c(e,"height","100vh"),c(e,"background","rgba(0, 0, 0, 0.5)"),c(e,"display","flex"),c(e,"align-items","center"),c(e,"justify-content","center"),c(e,"z-index","9999")},m(n,i){q(n,e,i)},d(n){n&&u(e)}}}function gi(l){let e,t,n,i,o="Cancelar",s,a,d="REQUERIMIENTOS DE RUTA",k,v,p,m,_,b,y,w="Confirmar",R,P,D,x;function V(I,T){return I[1]?pi:_i}let U=V(l),C=U(l),H=l[0]&&Ht(l),B=l[14]&&Vt();return{c(){e=f("ion-header"),t=f("ion-toolbar"),n=f("ion-buttons"),i=f("ion-button"),i.textContent=o,s=O(),a=f("ion-title"),a.textContent=d,k=O(),v=f("ion-content"),p=f("ion-list"),C.c(),m=O(),H&&H.c(),_=O(),b=f("ion-footer"),y=f("ion-button"),y.textContent=w,R=O(),B&&B.c(),P=Ue(),this.h()},l(I){e=h(I,"ION-HEADER",{translucent:!0});var T=g(e);t=h(T,"ION-TOOLBAR",{});var A=g(t);n=h(A,"ION-BUTTONS",{slot:!0});var S=g(n);i=h(S,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),te(i)!=="svelte-18837zq"&&(i.textContent=o),S.forEach(u),s=N(A),a=h(A,"ION-TITLE",{"data-svelte-h":!0}),te(a)!=="svelte-19bar5p"&&(a.textContent=d),A.forEach(u),T.forEach(u),k=N(I),v=h(I,"ION-CONTENT",{fullscreen:!0});var X=g(v);p=h(X,"ION-LIST",{});var ne=g(p);C.l(ne),m=N(ne),H&&H.l(ne),ne.forEach(u),X.forEach(u),_=N(I),b=h(I,"ION-FOOTER",{});var re=g(b);y=h(re,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),te(y)!=="svelte-1vqzxem"&&(y.textContent=w),re.forEach(u),R=N(I),B&&B.l(I),P=Ue(),this.h()},h(){E(i,"color","medium"),E(n,"slot","start"),E(e,"translucent",""),E(v,"fullscreen",""),E(y,"fill","outline"),E(y,"color","tertiary"),E(y,"strong",""),c(y,"width","99%"),c(y,"height","auto"),c(y,"margin-bottom","120px")},m(I,T){q(I,e,T),r(e,t),r(t,n),r(n,i),r(t,s),r(t,a),q(I,k,T),q(I,v,T),r(v,p),C.m(p,null),r(p,m),H&&H.m(p,null),q(I,_,T),q(I,b,T),r(b,y),q(I,R,T),B&&B.m(I,T),q(I,P,T),D||(x=[ae(i,"click",l[16]),ae(y,"click",l[17])],D=!0)},p(I,T){U===(U=V(I))&&C?C.p(I,T):(C.d(1),C=U(I),C&&(C.c(),C.m(p,m))),I[0]?H?H.p(I,T):(H=Ht(I),H.c(),H.m(p,null)):H&&(H.d(1),H=null),I[14]?B||(B=Vt(),B.c(),B.m(P.parentNode,P)):B&&(B.d(1),B=null)},i:Me,o:Me,d(I){I&&(u(e),u(k),u(v),u(_),u(b),u(R),u(P)),C.d(),H&&H.d(),B&&B.d(I),D=!1,Fe(x)}}}function yt(l,e){if(typeof l=="object"&&l!==null||Array.isArray(l)){if(Array.isArray(l))return l.map(t=>yt(t,e)).flat();{const t=Object.keys(l);let n;return e=="id_checklist_event"?n=t.filter(o=>o.toLowerCase().includes("id_checklist_event")).map(o=>l[o]):e=="mandatory"?n=t.filter(o=>o.toLowerCase().includes("mandatory")).map(o=>l[o]):(console.error("Tipo de dato no reconocido."),n=!1),n}}else return console.error("Invalid input. Please provide a valid object or array."),[]}function bi(){return new Promise((l,e)=>{if(!navigator.geolocation)return e("Geoloc no soportada");navigator.geolocation.getCurrentPosition(t=>l({lat:+t.coords.latitude.toFixed(6),lng:+t.coords.longitude.toFixed(6)}),t=>e(t),{enableHighAccuracy:!0,maximumAge:0,timeout:8e3})})}function ki(l,e,t){let n=ht,i,o=[],s,a=!1,d,k,v,p,m=[],_=null,b={},y,w,R,P,D={},x=new Object,V=!1,U={},C={};rt(()=>{i=document.querySelector("ion-modal");const K=(i==null?void 0:i.componentProps)||{};if(t(0,o=K.checklist||[]),K.driverId,s=K.routeId,t(1,a=!!K.isLast),x=JSON.parse(localStorage.getItem("userSession")),a||It.update(ee=>(ee.mandatory=yt(o,"mandatory"),ee.items=yt(o,"id_checklist_event"),ee)),i){i.breakpoints=[.25,.85,1],i.initialBreakpoint=.85;const ee=he=>{var Ie;const ge=(Ie=he.detail)==null?void 0:Ie.breakpoint;ge&&ge>=.6&&i.setCurrentBreakpoint(.95)};i.addEventListener("ionBreakpointDidChange",ee)}});function H(K){t(13,D[K]=!0,D)}const B=async()=>{await(await $e.create({header:"Datos o checklist incompletos",message:"Carga la evidencia requerida y marca todas las casillas para confirmar",buttons:[{text:"Cerrar"}]})).present()},I=async(K,ee,he=null)=>{await(await $e.create({header:K||"Error",message:ee||"Vuelva a intentar",buttons:[{text:"Cerrar",handler:()=>(he&&typeof he=="function"&&he(),!0)}]})).present()},T=async K=>{await(await $e.create({header:"Datos inválidos",message:K=="km"?"Llena correctamente el campo de kilometraje inicial":"Llena correctamente el campo de gasolina inicial",buttons:[{text:"Cerrar"}]})).present()},A=()=>{tt.dismiss()},S=async()=>{if(t(14,V=!0),a){const K=Z(v,"km"),ee=Z(p,"gas"),he={km_final:K,gas_final:ee,id_route:s,id_user_over:x.id_user,token:x.token};K&&ee?(A(),Je(`${n}api/admin/checklist/add_evidence.php`,function(ge){ge.success?(t(14,V=!1),I("Datos capturados","El kilometraje y gasolina final fueron registrados correctamente, espere aprobación para finalizar ruta",ce)):(t(14,V=!1),I("Error","Vuelva a intentar capturar los datos solicitados"))},he)):B()}else{const K=Z(d,"km"),ee=Z(k,"gas");let he=null;try{he=await bi()}catch(ge){console.warn("GPS no disponible:",ge)}It.update(ge=>{const Ie=ge.mandatory,oe=ge.items.filter((J,Q)=>ge.mandatory[Q]==="1").every(J=>ge.checkedIndices.includes(J)),M=Array.isArray(Ie)&&Ie.some(J=>J==="1")&&!oe?"checklist-pending":"enroute";if(K&&ee){let J=new FormData;J=fe(J),J.append("km_inicial",K),J.append("gas_inicial",ee),J.append("id_route",s),he&&(J.append("lat",he.lat),J.append("lng",he.lng));for(const Q in U)if(Object.prototype.hasOwnProperty.call(U,Q)){const{img:_e,img_id:Le}=U[Q];J.append(`selectedImages[${Q}][img]`,_e),J.append(`selectedImages[${Q}][img_id]`,Le)}fetch(`${n}api/admin/checklist/add_evidence.php`,{method:"POST",body:J}).then(Q=>Q.json()).then(()=>{Ee(s,M),console.log("✅ Evidencia enviada, estado actualizado:",M)}).catch(Q=>{console.error("Error fetching data:",Q)}).finally(()=>{t(14,V=!1),A()})}else(!K||!ee)&&B();return ge})}pe()},X=async(K,ee)=>{H(ee);const ge=K.target.files[0],Ie=await ne(ge);if(Ie){let j=new FormData;j.append("fileToUpload",Ie),j=fe(j);try{const oe=await fetch(`${n}api/admin/manager/upload_img_driver.php`,{method:"POST",body:j});if(oe.ok){const se=await oe.json();U={...U,[ee]:{img:se.img,img_id:se.img_id}},t(15,C={...C,[ee]:se.filename}),re(ee),t(8,b[ee].checked=!0,b),t(13,D[ee]=!1,D)}else console.error("File upload failed:",oe.statusText)}catch(oe){console.error("Error durante la carga del archivo:",oe)}}},ne=async K=>new Promise(ee=>{const he=new Image;he.src=URL.createObjectURL(K),he.onload=()=>{const ge=document.createElement("canvas"),Ie=ge.getContext("2d"),j=800,oe=600;let se=he.width,M=he.height;se>j&&(M*=j/se,se=j),M>oe&&(se*=oe/M,M=oe),ge.width=se,ge.height=M,Ie.drawImage(he,0,0,se,M),ge.toBlob(J=>{ee(J),URL.revokeObjectURL(he.src),Ie.clearRect(0,0,ge.width,ge.height)},"image/jpeg",.7)}}),re=K=>{It.update(ee=>(ee.checkedIndices.indexOf(K)===-1?ee.checkedIndices.push(K):console.error(`ID ${K} is already checked.`),ee.items.forEach(ge=>{ge.id_checklist_event===K&&(ge.checked=!0)}),ee))};function Ee(K,ee){let he=new FormData;he.append("id_route",K),he.append("status",ee),he=fe(he),fetch(`${n}api/admin/route/change_status.php`,{method:"POST",body:he}).then(ge=>ge.json()).then(ge=>{}).catch(ge=>{console.error("Error fetching data:",ge)})}function Z(K,ee){return/^\d+$/.test(K)?parseInt(K,10):(T(ee),null)}function L(K,ee){$(ee),i||(i=document.querySelector("ion-modal")),i&&(i.componentProps.data_type=ee),Ze("modal-gas-km",hi,{r:ee},{breakpoints:[.25,.85,1],initialBreakpoint:.85,backdropBreakpoint:.25,handle:!0,handleBehavior:"cycle",canDismiss:!0,showBackdrop:!0}).then(()=>{st.subscribe(he=>ue(he,ee))})}function $(K){An.update(ee=>({...ee,flag:[K]}))}function ue(K,ee){t(2,d=K.km_inicial?K.km_inicial:null),t(3,k=K.gas_inicial?K.gas_inicial:null),t(4,v=K.km_final?K.km_final:null),t(5,p=K.gas_final?K.gas_final:null),ee=="km_inicial"&&y&&t(9,y.checked=!0,y),ee=="gas_inicial"&&w&&t(10,w.checked=!0,w),ee=="km_final"&&R&&t(11,R.checked=!0,R),ee=="gas_final"&&P&&t(12,P.checked=!0,P)}function pe(){st.set({km_inicial:[],gas_inicial:[],km_final:[],gas_final:[]})}function fe(K){return K.append("token",x.token),K.append("id_user_over",x.id_user),K}const ce=()=>{Ee(s,"completed"),x.type=="super"||x.type=="admin"?lt("/drivers/me"):x.id_driver?lt(`/drivers/${x.id_driver}`):lt("/drivers")},be=[[]];function me(){m=ct(be[0],this.__value,this.checked),t(6,m)}function ie(K){He[K?"unshift":"push"](()=>{R=K,t(11,R)})}const ke=K=>L(K,"km_final");function ye(){m=ct(be[0],this.__value,this.checked),t(6,m)}function we(K){He[K?"unshift":"push"](()=>{P=K,t(12,P)})}const ve=K=>L(K,"gas_final");function z(){m=ct(be[0],this.__value,this.checked),t(6,m)}function G(K){He[K?"unshift":"push"](()=>{y=K,t(9,y)})}const F=K=>L(K,"km_inicial");function le(K){He[K?"unshift":"push"](()=>{w=K,t(10,w)})}function Y(){m=ct(be[0],this.__value,this.checked),t(6,m)}const de=K=>L(K,"gas_inicial");function xe(){m=ct(be[0],this.__value,this.checked),t(6,m)}function Be(K,ee){He[K?"unshift":"push"](()=>{b[ee.id_checklist_event]=K,t(8,b)})}const Ae=K=>re(K.id_checklist_event);function Pe(K){He[K?"unshift":"push"](()=>{_=K,t(7,_)})}return[o,a,d,k,v,p,m,_,b,y,w,R,P,D,V,C,A,S,X,re,L,me,be,ie,ke,ye,we,ve,z,G,F,le,Y,de,xe,Be,Ae,Pe,(K,ee)=>X(ee,K.id_checklist_event)]}class Dn extends it{constructor(e){super(),ot(this,e,ki,gi,nt,{},null,[-1,-1])}}/*!
========
import{Z as Ot,s as nt,e as f,j as O,b as h,q as g,d as te,h as u,m as N,v as E,i as q,w as r,x as ae,n as Me,z as Fe,_ as Bn,k as Ue,B as c,o as rt,$ as Nt,t as Ne,r as Te,f as W,a0 as Dt,y as De,a1 as ct,A as He,F as Tt,J as Un,a2 as bt,a3 as Ye,a4 as Ct,a5 as Lt,a6 as Bt,a7 as Ut,l as zn,p as Hn}from"../chunks/index.BgXu2Isl.js";import{S as it,i as ot,b as Nn,d as Tn,m as Cn,t as ut,a as pt,e as Ln,c as Rn,g as Vn}from"../chunks/index.Dk8PUFqT.js";import{e as We,u as dt,d as ft,g as Je,a as et,h as Ge,b as Fn,c as qn,i as Mn,f as Wn,j as Sn,k as jn,m as Gn,n as mt,o as Kn,q as Mt,r as xn,s as Pn,t as St,v as Qe,w as Xn,x as Jn,y as xt,z as Pt,A as Yn,B as Qn,I as Zn,C as $n,D as ei,E as ti,p as ni}from"../chunks/index.DAxZdQiN.js";import"../chunks/index-6e05b96e.C_9q9BoX.js";import{m as tt,D as ht,a as $e,W as ii,b as oi}from"../chunks/overlays-b874c3c3.CjdQ6POc.js";import{q as li,t as ri}from"../chunks/ion-modal.BYMRzj9z.js";import{g as lt}from"../chunks/entry.O-PURUYZ.js";const si=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global,ai=(l,e)=>{if(!customElements.get(l)){class t extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){new e({target:this.shadowRoot,props:this.componentProps||{}})}}customElements.define(l,t)}},ci=l=>document.createElement(l).constructor!==HTMLElement,ui=(l,e)=>{ci(l)||ai(l,e)},Ze=async(l,e,t={},n={})=>{li(),ri(),ui(l,e);const i=await tt.create({component:l,componentProps:t,...n});return i.addEventListener("ionModalDidPresent",()=>{const o=i.querySelector(l);o&&(o.componentProps=t)}),await i.present(),i.onWillDismiss()};let st=Ot({km_inicial:[],gas_inicial:[],km_final:[],gas_final:[]}),An=Ot({flag:[]});function di(l){let e,t,n,i,o="Cancelar",s,a,d="Captura de Km/Gas",k,v,p,m="Confirmar",_,b,y,w,R,P,D;return{c(){e=f("ion-header"),t=f("ion-toolbar"),n=f("ion-buttons"),i=f("ion-button"),i.textContent=o,s=O(),a=f("ion-title"),a.textContent=d,k=O(),v=f("ion-buttons"),p=f("ion-button"),p.textContent=m,_=O(),b=f("ion-content"),y=f("ion-item"),w=f("ion-input"),this.h()},l(x){e=h(x,"ION-HEADER",{translucent:!0});var V=g(e);t=h(V,"ION-TOOLBAR",{});var U=g(t);n=h(U,"ION-BUTTONS",{slot:!0});var C=g(n);i=h(C,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),te(i)!=="svelte-17pq4f4"&&(i.textContent=o),C.forEach(u),s=N(U),a=h(U,"ION-TITLE",{"data-svelte-h":!0}),te(a)!=="svelte-1yhkaq7"&&(a.textContent=d),k=N(U),v=h(U,"ION-BUTTONS",{slot:!0});var H=g(v);p=h(H,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),te(p)!=="svelte-cm6j4s"&&(p.textContent=m),H.forEach(u),U.forEach(u),V.forEach(u),_=N(x),b=h(x,"ION-CONTENT",{fullscreen:!0});var B=g(b);y=h(B,"ION-ITEM",{});var I=g(y);w=h(I,"ION-INPUT",{class:!0,inputmode:!0,pattern:!0,type:!0,placeholder:!0,value:!0,required:!0});var T=g(w);T.forEach(u),I.forEach(u),B.forEach(u),this.h()},h(){E(i,"color","medium"),E(n,"slot","start"),E(p,"strong",""),E(v,"slot","end"),E(e,"translucent",""),E(w,"class","fin-km"),E(w,"inputmode","numeric"),E(w,"pattern","[0-9]*"),E(w,"type","number"),E(w,"placeholder",R="Ingresa "+l[0]+" actual"),E(w,"value",l[1]),E(w,"required",""),E(b,"fullscreen","")},m(x,V){q(x,e,V),r(e,t),r(t,n),r(n,i),r(t,s),r(t,a),r(t,k),r(t,v),r(v,p),q(x,_,V),q(x,b,V),r(b,y),r(y,w),P||(D=[ae(i,"click",l[2]),ae(p,"click",l[3]),ae(w,"input",l[4])],P=!0)},p(x,[V]){V&1&&R!==(R="Ingresa "+x[0]+" actual")&&E(w,"placeholder",R),V&2&&E(w,"value",x[1])},i:Me,o:Me,d(x){x&&(u(e),u(_),u(b)),P=!1,Fe(D)}}}function fi(l,e,t){const n=Bn();let o=document.querySelector("ion-modal").componentProps.data_type,s="";An.subscribe(p=>{o=p.flag[0],o=="km_final"||o=="km_inicial"?t(0,s="kilometraje"):t(0,s="litros de gasolina")});let a=0;function d(){tt.dismiss()}function k(){n("modalResult",{data:"Your data",role:"confirm"}),o=="km_inicial"?st.update(m=>({...m,km_inicial:[a]})):o=="gas_inicial"?st.update(m=>({...m,gas_inicial:[a]})):o=="km_final"?st.update(m=>({...m,km_final:[a]})):o=="gas_final"&&st.update(m=>({...m,gas_final:[a]})),d()}return[s,a,d,k,p=>t(1,a=p.target.value)]}class hi extends it{constructor(e){super(),ot(this,e,fi,di,nt,{})}}const It=Ot({items:[],checkedIndices:[],mandatory:[]});function zt(l,e,t){const n=l.slice();return n[57]=e[t],n[58]=e,n[59]=t,n}function _i(l){let e,t,n,i,o,s="Kilometraje inicial",a,d,k=l[2]?l[2]+" km.":"Cargar km",v,p,m,_,b,y,w,R="Gasolina inicial (litros)",P,D,x=l[3]?l[3]+" litros":"Cargar gas",V,U,C,H;return U=Nt(l[22][0]),{c(){e=f("ion-item"),t=f("ion-label"),n=f("input"),i=O(),o=f("p"),o.textContent=s,a=O(),d=f("ion-button"),v=Ne(k),p=O(),m=f("ion-item"),_=f("ion-label"),b=f("input"),y=O(),w=f("p"),w.textContent=R,P=O(),D=f("ion-button"),V=Ne(x),this.h()},l(B){e=h(B,"ION-ITEM",{});var I=g(e);t=h(I,"ION-LABEL",{style:!0});var T=g(t);n=h(T,"INPUT",{id:!0,style:!0,type:!0}),i=N(T),o=h(T,"P",{style:!0,"data-svelte-h":!0}),te(o)!=="svelte-88twxi"&&(o.textContent=s),T.forEach(u),a=N(I),d=h(I,"ION-BUTTON",{fill:!0,size:!0,class:!0,"aria-selected":!0});var A=g(d);v=Te(A,k),A.forEach(u),I.forEach(u),p=N(B),m=h(B,"ION-ITEM",{});var S=g(m);_=h(S,"ION-LABEL",{style:!0});var X=g(_);b=h(X,"INPUT",{id:!0,style:!0,type:!0}),y=N(X),w=h(X,"P",{style:!0,"data-svelte-h":!0}),te(w)!=="svelte-1ux30eb"&&(w.textContent=R),X.forEach(u),P=N(S),D=h(S,"ION-BUTTON",{fill:!0,class:!0,size:!0,style:!0});var ne=g(D);V=Te(ne,x),ne.forEach(u),S.forEach(u),this.h()},h(){W(n,"id","chkbox-km-ini"),c(n,"pointer-events","auto"),W(n,"type","checkbox"),n.required=!0,c(o,"margin-left","10px"),c(t,"display","flex"),E(d,"fill","outline"),E(d,"size","small"),E(d,"class","loadKmInicial"),E(d,"aria-selected",""),W(b,"id","chkbox-gas-ini"),c(b,"pointer-events","auto"),W(b,"type","checkbox"),b.required=!0,c(w,"margin-left","10px"),c(_,"display","flex"),E(D,"fill","outline"),E(D,"class","loadGasInicial"),E(D,"size","small"),c(D,"height","16px "),U.p(n,b)},m(B,I){q(B,e,I),r(e,t),r(t,n),n.checked=~(l[6]||[]).indexOf(n.__value),l[29](n),r(t,i),r(t,o),r(e,a),r(e,d),r(d,v),q(B,p,I),q(B,m,I),r(m,_),r(_,b),l[31](b),b.checked=~(l[6]||[]).indexOf(b.__value),r(_,y),r(_,w),r(m,P),r(m,D),r(D,V),C||(H=[ae(n,"change",l[28]),ae(d,"click",l[30]),ae(b,"change",l[32]),ae(D,"click",l[33])],C=!0)},p(B,I){I[0]&65&&(n.checked=~(B[6]||[]).indexOf(n.__value)),I[0]&4&&k!==(k=B[2]?B[2]+" km.":"Cargar km")&&De(v,k),I[0]&65&&(b.checked=~(B[6]||[]).indexOf(b.__value)),I[0]&8&&x!==(x=B[3]?B[3]+" litros":"Cargar gas")&&De(V,x)},d(B){B&&(u(e),u(p),u(m)),l[29](null),l[31](null),U.r(),C=!1,Fe(H)}}}function pi(l){let e,t,n,i,o,s="Kilometraje final",a,d,k=l[4]?l[4]+" km.":"Cargar km",v,p,m,_,b,y,w,R="Gasolina final (litros)",P,D,x=l[5]?l[5]+" litros":"Cargar gas",V,U,C,H;return U=Nt(l[22][0]),{c(){e=f("ion-item"),t=f("ion-label"),n=f("input"),i=O(),o=f("p"),o.textContent=s,a=O(),d=f("ion-button"),v=Ne(k),p=O(),m=f("ion-item"),_=f("ion-label"),b=f("input"),y=O(),w=f("p"),w.textContent=R,P=O(),D=f("ion-button"),V=Ne(x),this.h()},l(B){e=h(B,"ION-ITEM",{});var I=g(e);t=h(I,"ION-LABEL",{style:!0});var T=g(t);n=h(T,"INPUT",{id:!0,style:!0,type:!0}),i=N(T),o=h(T,"P",{style:!0,"data-svelte-h":!0}),te(o)!=="svelte-ccmu71"&&(o.textContent=s),T.forEach(u),a=N(I),d=h(I,"ION-BUTTON",{fill:!0,size:!0,class:!0,"aria-selected":!0});var A=g(d);v=Te(A,k),A.forEach(u),I.forEach(u),p=N(B),m=h(B,"ION-ITEM",{});var S=g(m);_=h(S,"ION-LABEL",{style:!0});var X=g(_);b=h(X,"INPUT",{id:!0,style:!0,type:!0}),y=N(X),w=h(X,"P",{style:!0,"data-svelte-h":!0}),te(w)!=="svelte-wsoyd2"&&(w.textContent=R),X.forEach(u),P=N(S),D=h(S,"ION-BUTTON",{fill:!0,size:!0,class:!0});var ne=g(D);V=Te(ne,x),ne.forEach(u),S.forEach(u),this.h()},h(){W(n,"id","chkbox-km-fin"),c(n,"pointer-events","auto"),W(n,"type","checkbox"),n.required=!0,c(o,"margin-left","10px"),c(t,"display","flex"),E(d,"fill","outline"),E(d,"size","small"),E(d,"class","loadKmInicial"),E(d,"aria-selected",""),W(b,"id","chkbox-gas-fin"),c(b,"pointer-events","auto"),W(b,"type","checkbox"),b.required=!0,c(w,"margin-left","10px"),c(_,"display","flex"),E(D,"fill","outline"),E(D,"size","small"),E(D,"class","loadGasInicial"),U.p(n,b)},m(B,I){q(B,e,I),r(e,t),r(t,n),n.checked=~(l[6]||[]).indexOf(n.__value),l[23](n),r(t,i),r(t,o),r(e,a),r(e,d),r(d,v),q(B,p,I),q(B,m,I),r(m,_),r(_,b),b.checked=~(l[6]||[]).indexOf(b.__value),l[26](b),r(_,y),r(_,w),r(m,P),r(m,D),r(D,V),C||(H=[ae(n,"change",l[21]),ae(d,"click",l[24]),ae(b,"change",l[25]),ae(D,"click",l[27])],C=!0)},p(B,I){I[0]&65&&(n.checked=~(B[6]||[]).indexOf(n.__value)),I[0]&16&&k!==(k=B[4]?B[4]+" km.":"Cargar km")&&De(v,k),I[0]&65&&(b.checked=~(B[6]||[]).indexOf(b.__value)),I[0]&32&&x!==(x=B[5]?B[5]+" litros":"Cargar gas")&&De(V,x)},d(B){B&&(u(e),u(p),u(m)),l[23](null),l[26](null),U.r(),C=!1,Fe(H)}}}function Ht(l){let e=[],t=new Map,n,i=We(l[0]);const o=s=>s[57].id_checklist_event;for(let s=0;s<i.length;s+=1){let a=zt(l,i,s),d=o(a);t.set(d,e[s]=Rt(d,a))}return{c(){for(let s=0;s<e.length;s+=1)e[s].c();n=Ue()},l(s){for(let a=0;a<e.length;a+=1)e[a].l(s);n=Ue()},m(s,a){for(let d=0;d<e.length;d+=1)e[d]&&e[d].m(s,a);q(s,n,a)},p(s,a){a[0]&827841&&(i=We(s[0]),e=dt(e,a,o,1,s,i,t,n.parentNode,ft,Rt,n,zt))},d(s){s&&u(n);for(let a=0;a<e.length;a+=1)e[a].d(s)}}}function mi(l){let e,t=(l[15][l[57].id_checklist_event]?l[15][l[57].id_checklist_event]:"Cargar evidencia")+"",n,i;return{c(){e=f("label"),n=Ne(t),this.h()},l(o){e=h(o,"LABEL",{for:!0,class:!0});var s=g(e);n=Te(s,t),s.forEach(u),this.h()},h(){W(e,"for",i="chklist-"+l[57].id_checklist_event),W(e,"class","button-label")},m(o,s){q(o,e,s),r(e,n)},p(o,s){s[0]&32769&&t!==(t=(o[15][o[57].id_checklist_event]?o[15][o[57].id_checklist_event]:"Cargar evidencia")+"")&&De(n,t),s[0]&1&&i!==(i="chklist-"+o[57].id_checklist_event)&&W(e,"for",i)},d(o){o&&u(e)}}}function vi(l){let e;return{c(){e=f("ion-spinner"),this.h()},l(t){e=h(t,"ION-SPINNER",{name:!0,class:!0}),g(e).forEach(u),this.h()},h(){E(e,"name","dots"),E(e,"class","button-spinner")},m(t,n){q(t,e,n)},p:Me,d(t){t&&u(e)}}}function Rt(l,e){let t,n,i,o,s,a=!1,d=e[57],k,v,p=e[57].item+"",m,_,b,y=e[57].mandatory=="1"?" * ":"",w,R,P,D,x,V,U,C,H,B,I;const T=()=>e[35](i,d),A=()=>e[35](null,d);function S(){return e[36](e[57])}function X(Z,L){return Z[13][Z[57].id_checklist_event]?vi:mi}let ne=X(e),re=ne(e);function Ee(...Z){return e[38](e[57],...Z)}return H=Nt(e[22][0]),{key:l,first:null,c(){t=f("ion-item"),n=f("ion-label"),i=f("input"),k=O(),v=f("p"),m=Ne(p),_=O(),b=f("b"),w=Ne(y),R=O(),P=f("ion-button"),D=f("div"),re.c(),x=O(),V=f("input"),C=O(),this.h()},l(Z){t=h(Z,"ION-ITEM",{});var L=g(t);n=h(L,"ION-LABEL",{style:!0});var $=g(n);i=h($,"INPUT",{id:!0,style:!0,type:!0}),k=N($),v=h($,"P",{style:!0});var ue=g(v);m=Te(ue,p),ue.forEach(u),_=N($),b=h($,"B",{style:!0});var pe=g(b);w=Te(pe,y),pe.forEach(u),$.forEach(u),R=N(L),P=h(L,"ION-BUTTON",{fill:!0,class:!0,size:!0});var fe=g(P);D=h(fe,"DIV",{class:!0});var ce=g(D);re.l(ce),x=N(ce),V=h(ce,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0,capture:!0}),ce.forEach(u),fe.forEach(u),C=N(L),L.forEach(u),this.h()},h(){W(i,"id",o=`chkbox-${e[57].id_checklist_event}`),c(i,"pointer-events","auto"),W(i,"type","checkbox"),i.__value=s=e[57].id_checklist_event,Dt(i,i.__value),i.required=!0,c(v,"margin-left","10px"),c(b,"margin-left","5px"),c(n,"display","flex"),c(V,"display","none"),W(V,"id",U="chklist-"+e[57].id_checklist_event),W(V,"name","fileToUpload"),W(V,"type","file"),W(V,"accept","image/*"),W(V,"capture","environment"),W(D,"class","button-content"),E(P,"fill","outline"),E(P,"class","loadEvidence"),E(P,"size","small"),H.p(i),this.first=t},m(Z,L){q(Z,t,L),r(t,n),r(n,i),i.checked=~(e[6]||[]).indexOf(i.__value),T(),r(n,k),r(n,v),r(v,m),r(n,_),r(n,b),r(b,w),r(t,R),r(t,P),r(P,D),re.m(D,null),r(D,x),r(D,V),e[37](V),r(t,C),B||(I=[ae(i,"change",e[34]),ae(i,"change",S),ae(V,"change",Ee)],B=!0)},p(Z,L){e=Z,L[0]&1&&o!==(o=`chkbox-${e[57].id_checklist_event}`)&&W(i,"id",o),L[0]&1&&s!==(s=e[57].id_checklist_event)&&(i.__value=s,Dt(i,i.__value),a=!0),(a||L[0]&65)&&(i.checked=~(e[6]||[]).indexOf(i.__value)),d!==e[57]&&(A(),d=e[57],T()),L[0]&1&&p!==(p=e[57].item+"")&&De(m,p),L[0]&1&&y!==(y=e[57].mandatory=="1"?" * ":"")&&De(w,y),ne===(ne=X(e))&&re?re.p(e,L):(re.d(1),re=ne(e),re&&(re.c(),re.m(D,x))),L[0]&1&&U!==(U="chklist-"+e[57].id_checklist_event)&&W(V,"id",U)},d(Z){Z&&u(t),A(),re.d(),e[37](null),H.r(),B=!1,Fe(I)}}}function Vt(l){let e,t='<ion-spinner name="dots" style="color:white;"></ion-spinner>';return{c(){e=f("div"),e.innerHTML=t,this.h()},l(n){e=h(n,"DIV",{class:!0,style:!0,"data-svelte-h":!0}),te(e)!=="svelte-1muo9sg"&&(e.innerHTML=t),this.h()},h(){W(e,"class","overlay"),c(e,"position","fixed"),c(e,"top","0"),c(e,"left","0"),c(e,"width","100vw"),c(e,"height","100vh"),c(e,"background","rgba(0, 0, 0, 0.5)"),c(e,"display","flex"),c(e,"align-items","center"),c(e,"justify-content","center"),c(e,"z-index","9999")},m(n,i){q(n,e,i)},d(n){n&&u(e)}}}function gi(l){let e,t,n,i,o="Cancelar",s,a,d="REQUERIMIENTOS DE RUTA",k,v,p,m,_,b,y,w="Confirmar",R,P,D,x;function V(I,T){return I[1]?pi:_i}let U=V(l),C=U(l),H=l[0]&&Ht(l),B=l[14]&&Vt();return{c(){e=f("ion-header"),t=f("ion-toolbar"),n=f("ion-buttons"),i=f("ion-button"),i.textContent=o,s=O(),a=f("ion-title"),a.textContent=d,k=O(),v=f("ion-content"),p=f("ion-list"),C.c(),m=O(),H&&H.c(),_=O(),b=f("ion-footer"),y=f("ion-button"),y.textContent=w,R=O(),B&&B.c(),P=Ue(),this.h()},l(I){e=h(I,"ION-HEADER",{translucent:!0});var T=g(e);t=h(T,"ION-TOOLBAR",{});var A=g(t);n=h(A,"ION-BUTTONS",{slot:!0});var S=g(n);i=h(S,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),te(i)!=="svelte-18837zq"&&(i.textContent=o),S.forEach(u),s=N(A),a=h(A,"ION-TITLE",{"data-svelte-h":!0}),te(a)!=="svelte-19bar5p"&&(a.textContent=d),A.forEach(u),T.forEach(u),k=N(I),v=h(I,"ION-CONTENT",{fullscreen:!0});var X=g(v);p=h(X,"ION-LIST",{});var ne=g(p);C.l(ne),m=N(ne),H&&H.l(ne),ne.forEach(u),X.forEach(u),_=N(I),b=h(I,"ION-FOOTER",{});var re=g(b);y=h(re,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),te(y)!=="svelte-1vqzxem"&&(y.textContent=w),re.forEach(u),R=N(I),B&&B.l(I),P=Ue(),this.h()},h(){E(i,"color","medium"),E(n,"slot","start"),E(e,"translucent",""),E(v,"fullscreen",""),E(y,"fill","outline"),E(y,"color","tertiary"),E(y,"strong",""),c(y,"width","99%"),c(y,"height","auto"),c(y,"margin-bottom","120px")},m(I,T){q(I,e,T),r(e,t),r(t,n),r(n,i),r(t,s),r(t,a),q(I,k,T),q(I,v,T),r(v,p),C.m(p,null),r(p,m),H&&H.m(p,null),q(I,_,T),q(I,b,T),r(b,y),q(I,R,T),B&&B.m(I,T),q(I,P,T),D||(x=[ae(i,"click",l[16]),ae(y,"click",l[17])],D=!0)},p(I,T){U===(U=V(I))&&C?C.p(I,T):(C.d(1),C=U(I),C&&(C.c(),C.m(p,m))),I[0]?H?H.p(I,T):(H=Ht(I),H.c(),H.m(p,null)):H&&(H.d(1),H=null),I[14]?B||(B=Vt(),B.c(),B.m(P.parentNode,P)):B&&(B.d(1),B=null)},i:Me,o:Me,d(I){I&&(u(e),u(k),u(v),u(_),u(b),u(R),u(P)),C.d(),H&&H.d(),B&&B.d(I),D=!1,Fe(x)}}}function yt(l,e){if(typeof l=="object"&&l!==null||Array.isArray(l)){if(Array.isArray(l))return l.map(t=>yt(t,e)).flat();{const t=Object.keys(l);let n;return e=="id_checklist_event"?n=t.filter(o=>o.toLowerCase().includes("id_checklist_event")).map(o=>l[o]):e=="mandatory"?n=t.filter(o=>o.toLowerCase().includes("mandatory")).map(o=>l[o]):(console.error("Tipo de dato no reconocido."),n=!1),n}}else return console.error("Invalid input. Please provide a valid object or array."),[]}function bi(){return new Promise((l,e)=>{if(!navigator.geolocation)return e("Geoloc no soportada");navigator.geolocation.getCurrentPosition(t=>l({lat:+t.coords.latitude.toFixed(6),lng:+t.coords.longitude.toFixed(6)}),t=>e(t),{enableHighAccuracy:!0,maximumAge:0,timeout:8e3})})}function ki(l,e,t){let n=ht,i,o=[],s,a=!1,d,k,v,p,m=[],_=null,b={},y,w,R,P,D={},x=new Object,V=!1,U={},C={};rt(()=>{i=document.querySelector("ion-modal");const K=(i==null?void 0:i.componentProps)||{};if(t(0,o=K.checklist||[]),K.driverId,s=K.routeId,t(1,a=!!K.isLast),x=JSON.parse(localStorage.getItem("userSession")),a||It.update(ee=>(ee.mandatory=yt(o,"mandatory"),ee.items=yt(o,"id_checklist_event"),ee)),i){i.breakpoints=[.25,.85,1],i.initialBreakpoint=.85;const ee=he=>{var Ie;const ge=(Ie=he.detail)==null?void 0:Ie.breakpoint;ge&&ge>=.6&&i.setCurrentBreakpoint(.95)};i.addEventListener("ionBreakpointDidChange",ee)}});function H(K){t(13,D[K]=!0,D)}const B=async()=>{await(await $e.create({header:"Datos o checklist incompletos",message:"Carga la evidencia requerida y marca todas las casillas para confirmar",buttons:[{text:"Cerrar"}]})).present()},I=async(K,ee,he=null)=>{await(await $e.create({header:K||"Error",message:ee||"Vuelva a intentar",buttons:[{text:"Cerrar",handler:()=>(he&&typeof he=="function"&&he(),!0)}]})).present()},T=async K=>{await(await $e.create({header:"Datos inválidos",message:K=="km"?"Llena correctamente el campo de kilometraje inicial":"Llena correctamente el campo de gasolina inicial",buttons:[{text:"Cerrar"}]})).present()},A=()=>{tt.dismiss()},S=async()=>{if(t(14,V=!0),a){const K=Z(v,"km"),ee=Z(p,"gas"),he={km_final:K,gas_final:ee,id_route:s,id_user_over:x.id_user,token:x.token};K&&ee?(A(),Je(`${n}api/admin/checklist/add_evidence.php`,function(ge){ge.success?(t(14,V=!1),I("Datos capturados","El kilometraje y gasolina final fueron registrados correctamente, espere aprobación para finalizar ruta",ce)):(t(14,V=!1),I("Error","Vuelva a intentar capturar los datos solicitados"))},he)):B()}else{const K=Z(d,"km"),ee=Z(k,"gas");let he=null;try{he=await bi()}catch(ge){console.warn("GPS no disponible:",ge)}It.update(ge=>{const Ie=ge.mandatory,oe=ge.items.filter((J,Q)=>ge.mandatory[Q]==="1").every(J=>ge.checkedIndices.includes(J)),M=Array.isArray(Ie)&&Ie.some(J=>J==="1")&&!oe?"checklist-pending":"enroute";if(K&&ee){let J=new FormData;J=fe(J),J.append("km_inicial",K),J.append("gas_inicial",ee),J.append("id_route",s),he&&(J.append("lat",he.lat),J.append("lng",he.lng));for(const Q in U)if(Object.prototype.hasOwnProperty.call(U,Q)){const{img:_e,img_id:Le}=U[Q];J.append(`selectedImages[${Q}][img]`,_e),J.append(`selectedImages[${Q}][img_id]`,Le)}fetch(`${n}api/admin/checklist/add_evidence.php`,{method:"POST",body:J}).then(Q=>Q.json()).then(()=>{Ee(s,M),console.log("✅ Evidencia enviada, estado actualizado:",M)}).catch(Q=>{console.error("Error fetching data:",Q)}).finally(()=>{t(14,V=!1),A()})}else(!K||!ee)&&B();return ge})}pe()},X=async(K,ee)=>{H(ee);const ge=K.target.files[0],Ie=await ne(ge);if(Ie){let j=new FormData;j.append("fileToUpload",Ie),j=fe(j);try{const oe=await fetch(`${n}api/admin/manager/upload_img_driver.php`,{method:"POST",body:j});if(oe.ok){const se=await oe.json();U={...U,[ee]:{img:se.img,img_id:se.img_id}},t(15,C={...C,[ee]:se.filename}),re(ee),t(8,b[ee].checked=!0,b),t(13,D[ee]=!1,D)}else console.error("File upload failed:",oe.statusText)}catch(oe){console.error("Error durante la carga del archivo:",oe)}}},ne=async K=>new Promise(ee=>{const he=new Image;he.src=URL.createObjectURL(K),he.onload=()=>{const ge=document.createElement("canvas"),Ie=ge.getContext("2d"),j=800,oe=600;let se=he.width,M=he.height;se>j&&(M*=j/se,se=j),M>oe&&(se*=oe/M,M=oe),ge.width=se,ge.height=M,Ie.drawImage(he,0,0,se,M),ge.toBlob(J=>{ee(J),URL.revokeObjectURL(he.src),Ie.clearRect(0,0,ge.width,ge.height)},"image/jpeg",.7)}}),re=K=>{It.update(ee=>(ee.checkedIndices.indexOf(K)===-1?ee.checkedIndices.push(K):console.error(`ID ${K} is already checked.`),ee.items.forEach(ge=>{ge.id_checklist_event===K&&(ge.checked=!0)}),ee))};function Ee(K,ee){let he=new FormData;he.append("id_route",K),he.append("status",ee),he=fe(he),fetch(`${n}api/admin/route/change_status.php`,{method:"POST",body:he}).then(ge=>ge.json()).then(ge=>{}).catch(ge=>{console.error("Error fetching data:",ge)})}function Z(K,ee){return/^\d+$/.test(K)?parseInt(K,10):(T(ee),null)}function L(K,ee){$(ee),i||(i=document.querySelector("ion-modal")),i&&(i.componentProps.data_type=ee),Ze("modal-gas-km",hi,{r:ee},{breakpoints:[.25,.85,1],initialBreakpoint:.85,backdropBreakpoint:.25,handle:!0,handleBehavior:"cycle",canDismiss:!0,showBackdrop:!0}).then(()=>{st.subscribe(he=>ue(he,ee))})}function $(K){An.update(ee=>({...ee,flag:[K]}))}function ue(K,ee){t(2,d=K.km_inicial?K.km_inicial:null),t(3,k=K.gas_inicial?K.gas_inicial:null),t(4,v=K.km_final?K.km_final:null),t(5,p=K.gas_final?K.gas_final:null),ee=="km_inicial"&&y&&t(9,y.checked=!0,y),ee=="gas_inicial"&&w&&t(10,w.checked=!0,w),ee=="km_final"&&R&&t(11,R.checked=!0,R),ee=="gas_final"&&P&&t(12,P.checked=!0,P)}function pe(){st.set({km_inicial:[],gas_inicial:[],km_final:[],gas_final:[]})}function fe(K){return K.append("token",x.token),K.append("id_user_over",x.id_user),K}const ce=()=>{Ee(s,"completed"),x.type=="super"||x.type=="admin"?lt("/drivers/me"):x.id_driver?lt(`/drivers/${x.id_driver}`):lt("/drivers")},be=[[]];function me(){m=ct(be[0],this.__value,this.checked),t(6,m)}function ie(K){He[K?"unshift":"push"](()=>{R=K,t(11,R)})}const ke=K=>L(K,"km_final");function ye(){m=ct(be[0],this.__value,this.checked),t(6,m)}function we(K){He[K?"unshift":"push"](()=>{P=K,t(12,P)})}const ve=K=>L(K,"gas_final");function z(){m=ct(be[0],this.__value,this.checked),t(6,m)}function G(K){He[K?"unshift":"push"](()=>{y=K,t(9,y)})}const F=K=>L(K,"km_inicial");function le(K){He[K?"unshift":"push"](()=>{w=K,t(10,w)})}function Y(){m=ct(be[0],this.__value,this.checked),t(6,m)}const de=K=>L(K,"gas_inicial");function xe(){m=ct(be[0],this.__value,this.checked),t(6,m)}function Be(K,ee){He[K?"unshift":"push"](()=>{b[ee.id_checklist_event]=K,t(8,b)})}const Ae=K=>re(K.id_checklist_event);function Pe(K){He[K?"unshift":"push"](()=>{_=K,t(7,_)})}return[o,a,d,k,v,p,m,_,b,y,w,R,P,D,V,C,A,S,X,re,L,me,be,ie,ke,ye,we,ve,z,G,F,le,Y,de,xe,Be,Ae,Pe,(K,ee)=>X(ee,K.id_checklist_event)]}class Dn extends it{constructor(e){super(),ot(this,e,ki,gi,nt,{},null,[-1,-1])}}/*!
>>>>>>>> dev:.svelte-kit/output/client/_app/immutable/nodes/5.eaLnihOn.js
 * Signature Pad v5.0.10 | https://github.com/szimek/signature_pad
 * (c) 2025 Szymon Nowak | Released under the MIT license
 */class vt{constructor(e,t,n,i){if(isNaN(e)||isNaN(t))throw new Error(`Point is invalid: (${e}, ${t})`);this.x=+e,this.y=+t,this.pressure=n||0,this.time=i||Date.now()}distanceTo(e){return Math.sqrt(Math.pow(this.x-e.x,2)+Math.pow(this.y-e.y,2))}equals(e){return this.x===e.x&&this.y===e.y&&this.pressure===e.pressure&&this.time===e.time}velocityFrom(e){return this.time!==e.time?this.distanceTo(e)/(this.time-e.time):0}}class At{static fromPoints(e,t){const n=this.calculateControlPoints(e[0],e[1],e[2]).c2,i=this.calculateControlPoints(e[1],e[2],e[3]).c1;return new At(e[1],n,i,e[2],t.start,t.end)}static calculateControlPoints(e,t,n){const i=e.x-t.x,o=e.y-t.y,s=t.x-n.x,a=t.y-n.y,d={x:(e.x+t.x)/2,y:(e.y+t.y)/2},k={x:(t.x+n.x)/2,y:(t.y+n.y)/2},v=Math.sqrt(i*i+o*o),p=Math.sqrt(s*s+a*a),m=d.x-k.x,_=d.y-k.y,b=v+p==0?0:p/(v+p),y={x:k.x+m*b,y:k.y+_*b},w=t.x-y.x,R=t.y-y.y;return{c1:new vt(d.x+w,d.y+R),c2:new vt(k.x+w,k.y+R)}}constructor(e,t,n,i,o,s){this.startPoint=e,this.control2=t,this.control1=n,this.endPoint=i,this.startWidth=o,this.endWidth=s}length(){let t=0,n,i;for(let o=0;o<=10;o+=1){const s=o/10,a=this.point(s,this.startPoint.x,this.control1.x,this.control2.x,this.endPoint.x),d=this.point(s,this.startPoint.y,this.control1.y,this.control2.y,this.endPoint.y);if(o>0){const k=a-n,v=d-i;t+=Math.sqrt(k*k+v*v)}n=a,i=d}return t}point(e,t,n,i,o){return t*(1-e)*(1-e)*(1-e)+3*n*(1-e)*(1-e)*e+3*i*(1-e)*e*e+o*e*e*e}}class Ei{constructor(){try{this._et=new EventTarget}catch{this._et=document}}addEventListener(e,t,n){this._et.addEventListener(e,t,n)}dispatchEvent(e){return this._et.dispatchEvent(e)}removeEventListener(e,t,n){this._et.removeEventListener(e,t,n)}}function Ii(l,e=250){let t=0,n=null,i,o,s;const a=()=>{t=Date.now(),n=null,i=l.apply(o,s),n||(o=null,s=[])};return function(...k){const v=Date.now(),p=e-(v-t);return o=this,s=k,p<=0||p>e?(n&&(clearTimeout(n),n=null),t=v,i=l.apply(o,s),n||(o=null,s=[])):n||(n=window.setTimeout(a,p)),i}}class gt extends Ei{constructor(e,t={}){var n,i,o;super(),this.canvas=e,this._drawingStroke=!1,this._isEmpty=!0,this._lastPoints=[],this._data=[],this._lastVelocity=0,this._lastWidth=0,this.velocityFilterWeight=t.velocityFilterWeight||.7,this.minWidth=t.minWidth||.5,this.maxWidth=t.maxWidth||2.5,this.throttle=(n=t.throttle)!==null&&n!==void 0?n:16,this.minDistance=(i=t.minDistance)!==null&&i!==void 0?i:5,this.dotSize=t.dotSize||0,this.penColor=t.penColor||"black",this.backgroundColor=t.backgroundColor||"rgba(0,0,0,0)",this.compositeOperation=t.compositeOperation||"source-over",this.canvasContextOptions=(o=t.canvasContextOptions)!==null&&o!==void 0?o:{},this._strokeMoveUpdate=this.throttle?Ii(gt.prototype._strokeUpdate,this.throttle):gt.prototype._strokeUpdate,this._handleMouseDown=this._handleMouseDown.bind(this),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this._handleTouchStart=this._handleTouchStart.bind(this),this._handleTouchMove=this._handleTouchMove.bind(this),this._handleTouchEnd=this._handleTouchEnd.bind(this),this._handlePointerDown=this._handlePointerDown.bind(this),this._handlePointerMove=this._handlePointerMove.bind(this),this._handlePointerUp=this._handlePointerUp.bind(this),this._ctx=e.getContext("2d",this.canvasContextOptions),this.clear(),this.on()}clear(){const{_ctx:e,canvas:t}=this;e.fillStyle=this.backgroundColor,e.clearRect(0,0,t.width,t.height),e.fillRect(0,0,t.width,t.height),this._data=[],this._reset(this._getPointGroupOptions()),this._isEmpty=!0,this._strokePointerId=void 0}fromDataURL(e,t={}){return new Promise((n,i)=>{const o=new Image,s=t.ratio||window.devicePixelRatio||1,a=t.width||this.canvas.width/s,d=t.height||this.canvas.height/s,k=t.xOffset||0,v=t.yOffset||0;this._reset(this._getPointGroupOptions()),o.onload=()=>{this._ctx.drawImage(o,k,v,a,d),n()},o.onerror=p=>{i(p)},o.crossOrigin="anonymous",o.src=e,this._isEmpty=!1})}toDataURL(e="image/png",t){switch(e){case"image/svg+xml":return typeof t!="object"&&(t=void 0),`data:image/svg+xml;base64,${btoa(this.toSVG(t))}`;default:return typeof t!="number"&&(t=void 0),this.canvas.toDataURL(e,t)}}on(){this.canvas.style.touchAction="none",this.canvas.style.msTouchAction="none",this.canvas.style.userSelect="none";const e=/Macintosh/.test(navigator.userAgent)&&"ontouchstart"in document;window.PointerEvent&&!e?this._handlePointerEvents():(this._handleMouseEvents(),"ontouchstart"in window&&this._handleTouchEvents())}off(){this.canvas.style.touchAction="auto",this.canvas.style.msTouchAction="auto",this.canvas.style.userSelect="auto",this.canvas.removeEventListener("pointerdown",this._handlePointerDown),this.canvas.removeEventListener("mousedown",this._handleMouseDown),this.canvas.removeEventListener("touchstart",this._handleTouchStart),this._removeMoveUpEventListeners()}_getListenerFunctions(){var e;const t=window.document===this.canvas.ownerDocument?window:(e=this.canvas.ownerDocument.defaultView)!==null&&e!==void 0?e:this.canvas.ownerDocument;return{addEventListener:t.addEventListener.bind(t),removeEventListener:t.removeEventListener.bind(t)}}_removeMoveUpEventListeners(){const{removeEventListener:e}=this._getListenerFunctions();e("pointermove",this._handlePointerMove),e("pointerup",this._handlePointerUp),e("mousemove",this._handleMouseMove),e("mouseup",this._handleMouseUp),e("touchmove",this._handleTouchMove),e("touchend",this._handleTouchEnd)}isEmpty(){return this._isEmpty}fromData(e,{clear:t=!0}={}){t&&this.clear(),this._fromData(e,this._drawCurve.bind(this),this._drawDot.bind(this)),this._data=this._data.concat(e)}toData(){return this._data}_isLeftButtonPressed(e,t){return t?e.buttons===1:(e.buttons&1)===1}_pointerEventToSignatureEvent(e){return{event:e,type:e.type,x:e.clientX,y:e.clientY,pressure:"pressure"in e?e.pressure:0}}_touchEventToSignatureEvent(e){const t=e.changedTouches[0];return{event:e,type:e.type,x:t.clientX,y:t.clientY,pressure:t.force}}_handleMouseDown(e){!this._isLeftButtonPressed(e,!0)||this._drawingStroke||this._strokeBegin(this._pointerEventToSignatureEvent(e))}_handleMouseMove(e){if(!this._isLeftButtonPressed(e,!0)||!this._drawingStroke){this._strokeEnd(this._pointerEventToSignatureEvent(e),!1);return}this._strokeMoveUpdate(this._pointerEventToSignatureEvent(e))}_handleMouseUp(e){this._isLeftButtonPressed(e)||this._strokeEnd(this._pointerEventToSignatureEvent(e))}_handleTouchStart(e){e.targetTouches.length!==1||this._drawingStroke||(e.cancelable&&e.preventDefault(),this._strokeBegin(this._touchEventToSignatureEvent(e)))}_handleTouchMove(e){if(e.targetTouches.length===1){if(e.cancelable&&e.preventDefault(),!this._drawingStroke){this._strokeEnd(this._touchEventToSignatureEvent(e),!1);return}this._strokeMoveUpdate(this._touchEventToSignatureEvent(e))}}_handleTouchEnd(e){e.targetTouches.length===0&&(e.cancelable&&e.preventDefault(),this._strokeEnd(this._touchEventToSignatureEvent(e)))}_getPointerId(e){return e.persistentDeviceId||e.pointerId}_allowPointerId(e,t=!1){return typeof this._strokePointerId>"u"?t:this._getPointerId(e)===this._strokePointerId}_handlePointerDown(e){this._drawingStroke||!this._isLeftButtonPressed(e)||!this._allowPointerId(e,!0)||(this._strokePointerId=this._getPointerId(e),e.preventDefault(),this._strokeBegin(this._pointerEventToSignatureEvent(e)))}_handlePointerMove(e){if(this._allowPointerId(e)){if(!this._isLeftButtonPressed(e,!0)||!this._drawingStroke){this._strokeEnd(this._pointerEventToSignatureEvent(e),!1);return}e.preventDefault(),this._strokeMoveUpdate(this._pointerEventToSignatureEvent(e))}}_handlePointerUp(e){this._isLeftButtonPressed(e)||!this._allowPointerId(e)||(e.preventDefault(),this._strokeEnd(this._pointerEventToSignatureEvent(e)))}_getPointGroupOptions(e){return{penColor:e&&"penColor"in e?e.penColor:this.penColor,dotSize:e&&"dotSize"in e?e.dotSize:this.dotSize,minWidth:e&&"minWidth"in e?e.minWidth:this.minWidth,maxWidth:e&&"maxWidth"in e?e.maxWidth:this.maxWidth,velocityFilterWeight:e&&"velocityFilterWeight"in e?e.velocityFilterWeight:this.velocityFilterWeight,compositeOperation:e&&"compositeOperation"in e?e.compositeOperation:this.compositeOperation}}_strokeBegin(e){if(!this.dispatchEvent(new CustomEvent("beginStroke",{detail:e,cancelable:!0})))return;const{addEventListener:n}=this._getListenerFunctions();switch(e.event.type){case"mousedown":n("mousemove",this._handleMouseMove,{passive:!1}),n("mouseup",this._handleMouseUp,{passive:!1});break;case"touchstart":n("touchmove",this._handleTouchMove,{passive:!1}),n("touchend",this._handleTouchEnd,{passive:!1});break;case"pointerdown":n("pointermove",this._handlePointerMove,{passive:!1}),n("pointerup",this._handlePointerUp,{passive:!1});break}this._drawingStroke=!0;const i=this._getPointGroupOptions(),o=Object.assign(Object.assign({},i),{points:[]});this._data.push(o),this._reset(i),this._strokeUpdate(e)}_strokeUpdate(e){if(!this._drawingStroke)return;if(this._data.length===0){this._strokeBegin(e);return}this.dispatchEvent(new CustomEvent("beforeUpdateStroke",{detail:e}));const t=this._createPoint(e.x,e.y,e.pressure),n=this._data[this._data.length-1],i=n.points,o=i.length>0&&i[i.length-1],s=o?t.distanceTo(o)<=this.minDistance:!1,a=this._getPointGroupOptions(n);if(!o||!(o&&s)){const d=this._addPoint(t,a);o?d&&this._drawCurve(d,a):this._drawDot(t,a),i.push({time:t.time,x:t.x,y:t.y,pressure:t.pressure})}this.dispatchEvent(new CustomEvent("afterUpdateStroke",{detail:e}))}_strokeEnd(e,t=!0){this._removeMoveUpEventListeners(),this._drawingStroke&&(t&&this._strokeUpdate(e),this._drawingStroke=!1,this._strokePointerId=void 0,this.dispatchEvent(new CustomEvent("endStroke",{detail:e})))}_handlePointerEvents(){this._drawingStroke=!1,this.canvas.addEventListener("pointerdown",this._handlePointerDown,{passive:!1})}_handleMouseEvents(){this._drawingStroke=!1,this.canvas.addEventListener("mousedown",this._handleMouseDown,{passive:!1})}_handleTouchEvents(){this.canvas.addEventListener("touchstart",this._handleTouchStart,{passive:!1})}_reset(e){this._lastPoints=[],this._lastVelocity=0,this._lastWidth=(e.minWidth+e.maxWidth)/2,this._ctx.fillStyle=e.penColor,this._ctx.globalCompositeOperation=e.compositeOperation}_createPoint(e,t,n){const i=this.canvas.getBoundingClientRect();return new vt(e-i.left,t-i.top,n,new Date().getTime())}_addPoint(e,t){const{_lastPoints:n}=this;if(n.push(e),n.length>2){n.length===3&&n.unshift(n[0]);const i=this._calculateCurveWidths(n[1],n[2],t),o=At.fromPoints(n,i);return n.shift(),o}return null}_calculateCurveWidths(e,t,n){const i=n.velocityFilterWeight*t.velocityFrom(e)+(1-n.velocityFilterWeight)*this._lastVelocity,o=this._strokeWidth(i,n),s={end:o,start:this._lastWidth};return this._lastVelocity=i,this._lastWidth=o,s}_strokeWidth(e,t){return Math.max(t.maxWidth/(e+1),t.minWidth)}_drawCurveSegment(e,t,n){const i=this._ctx;i.moveTo(e,t),i.arc(e,t,n,0,2*Math.PI,!1),this._isEmpty=!1}_drawCurve(e,t){const n=this._ctx,i=e.endWidth-e.startWidth,o=Math.ceil(e.length())*2;n.beginPath(),n.fillStyle=t.penColor;for(let s=0;s<o;s+=1){const a=s/o,d=a*a,k=d*a,v=1-a,p=v*v,m=p*v;let _=m*e.startPoint.x;_+=3*p*a*e.control1.x,_+=3*v*d*e.control2.x,_+=k*e.endPoint.x;let b=m*e.startPoint.y;b+=3*p*a*e.control1.y,b+=3*v*d*e.control2.y,b+=k*e.endPoint.y;const y=Math.min(e.startWidth+k*i,t.maxWidth);this._drawCurveSegment(_,b,y)}n.closePath(),n.fill()}_drawDot(e,t){const n=this._ctx,i=t.dotSize>0?t.dotSize:(t.minWidth+t.maxWidth)/2;n.beginPath(),this._drawCurveSegment(e.x,e.y,i),n.closePath(),n.fillStyle=t.penColor,n.fill()}_fromData(e,t,n){for(const i of e){const{points:o}=i,s=this._getPointGroupOptions(i);if(o.length>1)for(let a=0;a<o.length;a+=1){const d=o[a],k=new vt(d.x,d.y,d.pressure,d.time);a===0&&this._reset(s);const v=this._addPoint(k,s);v&&t(v,s)}else this._reset(s),n(o[0],s)}}toSVG({includeBackgroundColor:e=!1}={}){const t=this._data,n=Math.max(window.devicePixelRatio||1,1),i=0,o=0,s=this.canvas.width/n,a=this.canvas.height/n,d=document.createElementNS("http://www.w3.org/2000/svg","svg");if(d.setAttribute("xmlns","http://www.w3.org/2000/svg"),d.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),d.setAttribute("viewBox",`${i} ${o} ${s} ${a}`),d.setAttribute("width",s.toString()),d.setAttribute("height",a.toString()),e&&this.backgroundColor){const k=document.createElement("rect");k.setAttribute("width","100%"),k.setAttribute("height","100%"),k.setAttribute("fill",this.backgroundColor),d.appendChild(k)}return this._fromData(t,(k,{penColor:v})=>{const p=document.createElement("path");if(!isNaN(k.control1.x)&&!isNaN(k.control1.y)&&!isNaN(k.control2.x)&&!isNaN(k.control2.y)){const m=`M ${k.startPoint.x.toFixed(3)},${k.startPoint.y.toFixed(3)} C ${k.control1.x.toFixed(3)},${k.control1.y.toFixed(3)} ${k.control2.x.toFixed(3)},${k.control2.y.toFixed(3)} ${k.endPoint.x.toFixed(3)},${k.endPoint.y.toFixed(3)}`;p.setAttribute("d",m),p.setAttribute("stroke-width",(k.endWidth*2.25).toFixed(3)),p.setAttribute("stroke",v),p.setAttribute("fill","none"),p.setAttribute("stroke-linecap","round"),d.appendChild(p)}},(k,{penColor:v,dotSize:p,minWidth:m,maxWidth:_})=>{const b=document.createElement("circle"),y=p>0?p:(m+_)/2;b.setAttribute("r",y.toString()),b.setAttribute("cx",k.x.toString()),b.setAttribute("cy",k.y.toString()),b.setAttribute("fill",v),d.appendChild(b)}),d.outerHTML}}function yi(l){let e,t;return{c(){e=f("div"),t=f("canvas"),this.h()},l(n){e=h(n,"DIV",{class:!0,style:!0});var i=g(e);t=h(i,"CANVAS",{class:!0,style:!0}),g(t).forEach(u),i.forEach(u),this.h()},h(){W(t,"class","signature-canvas"),c(t,"position","absolute"),c(t,"top","0"),c(t,"left","0"),c(t,"width","100%"),c(t,"height","100%"),c(t,"display","block"),W(e,"class","signature-container"),c(e,"position","relative"),c(e,"width","100%"),c(e,"height","150px"),c(e,"border","1px solid #ccc"),c(e,"border-radius","4px"),c(e,"touch-action","none"),c(e,"-ms-touch-action","none")},m(n,i){q(n,e,i),r(e,t),l[5](t),l[6](e)},p:Me,i:Me,o:Me,d(n){n&&u(e),l[5](null),l[6](null)}}}function wi(l,e,t){let n,i,o,s;function a(){o&&o.clear()}async function d(_="image/png"){return!o||o.isEmpty()?(await(await $e.create({header:"Firma vacía",message:"No existe firma por guardar",buttons:[{text:"Cerrar"}]})).present(),null):o.toDataURL(_)}function k(){v(),o&&o.clear()}function v(){const _=Math.max(window.devicePixelRatio||1,1),b=i.clientWidth,y=i.clientHeight;if(!b||!y)return;const w=32767,R=Math.min(_,w/b,w/y);t(0,n.width=Math.floor(b*R),n),t(0,n.height=Math.floor(y*R),n);const P=n.getContext("2d");try{P.scale(R,R)}catch(D){console.warn("Canvas scale failed:",D)}}rt(async()=>{await Tt(),v(),o=new gt(n,{backgroundColor:"rgba(255, 255, 255, 0)",penColor:"black"}),s=new ResizeObserver(v),s.observe(i)}),Un(()=>{s&&s.disconnect()});function p(_){He[_?"unshift":"push"](()=>{n=_,t(0,n)})}function m(_){He[_?"unshift":"push"](()=>{i=_,t(1,i)})}return[n,i,a,d,k,p,m]}class Oi extends it{constructor(e){super(),ot(this,e,wi,yi,nt,{clear:2,save:3,reset:4})}get clear(){return this.$$.ctx[2]}get save(){return this.$$.ctx[3]}get reset(){return this.$$.ctx[4]}}function Ni(l){let e,t,n,i,o="Cancelar",s,a,d="Firmar",k,v,p,m,_,b,y,w="Borrar",R,P,D="Guardar",x,V,U,C={};return m=new Oi({props:C}),l[4](m),{c(){e=f("ion-header"),t=f("ion-toolbar"),n=f("ion-buttons"),i=f("ion-button"),i.textContent=o,s=O(),a=f("ion-title"),a.textContent=d,k=O(),v=f("ion-content"),p=f("section"),Nn(m.$$.fragment),_=O(),b=f("div"),y=f("ion-button"),y.textContent=w,R=O(),P=f("ion-button"),P.textContent=D,this.h()},l(H){e=h(H,"ION-HEADER",{translucent:!0});var B=g(e);t=h(B,"ION-TOOLBAR",{});var I=g(t);n=h(I,"ION-BUTTONS",{slot:!0});var T=g(n);i=h(T,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),te(i)!=="svelte-sam1rw"&&(i.textContent=o),T.forEach(u),s=N(I),a=h(I,"ION-TITLE",{"data-svelte-h":!0}),te(a)!=="svelte-1ibb3l9"&&(a.textContent=d),I.forEach(u),B.forEach(u),k=N(H),v=h(H,"ION-CONTENT",{fullscreen:!0,scrollY:!0,class:!0});var A=g(v);p=h(A,"SECTION",{style:!0});var S=g(p);Tn(m.$$.fragment,S),_=N(S),b=h(S,"DIV",{style:!0});var X=g(b);y=h(X,"ION-BUTTON",{fill:!0,style:!0,"data-svelte-h":!0}),te(y)!=="svelte-1rt6y6r"&&(y.textContent=w),R=N(X),P=h(X,"ION-BUTTON",{style:!0,"data-svelte-h":!0}),te(P)!=="svelte-7uw5bf"&&(P.textContent=D),X.forEach(u),S.forEach(u),A.forEach(u),this.h()},h(){E(i,"color","medium"),E(n,"slot","start"),E(e,"translucent",""),E(y,"fill","outline"),c(y,"flex","1"),c(P,"flex","1"),c(b,"display","flex"),c(b,"gap","8px"),c(p,"display","flex"),c(p,"flex-direction","column"),c(p,"gap","12px"),c(p,"padding","16px"),E(v,"fullscreen",""),E(v,"scrollY",!1),E(v,"class","no-scroll svelte-1mh8gy4")},m(H,B){q(H,e,B),r(e,t),r(t,n),r(n,i),r(t,s),r(t,a),q(H,k,B),q(H,v,B),r(v,p),Cn(m,p,null),r(p,_),r(p,b),r(b,y),r(b,R),r(b,P),x=!0,V||(U=[ae(i,"click",l[1]),ae(y,"click",l[3]),ae(P,"click",l[2])],V=!0)},p(H,[B]){const I={};m.$set(I)},i(H){x||(ut(m.$$.fragment,H),x=!0)},o(H){pt(m.$$.fragment,H),x=!1},d(H){H&&(u(e),u(k),u(v)),l[4](null),Ln(m),V=!1,Fe(U)}}}function Ti(l,e,t){let n;function i(){tt.dismiss(void 0,"cancel")}async function o(){const d=await n.save();d&&tt.dismiss({dataUrl:d},"confirm")}function s(){n.clear()}function a(d){He[d?"unshift":"push"](()=>{n=d,t(0,n)})}return[n,i,o,s,a]}class Ci extends it{constructor(e){super(),ot(this,e,Ti,Ni,nt,{})}}function Ft(l,e,t){const n=l.slice();return n[64]=e[t],n[66]=t,n}function Li(l){let e,t,n,i,o;return{c(){e=f("ion-buttons"),t=f("ion-button"),n=Ne("Confirmar"),this.h()},l(s){e=h(s,"ION-BUTTONS",{slot:!0});var a=g(e);t=h(a,"ION-BUTTON",{strong:!0,disabled:!0});var d=g(t);n=Te(d,"Confirmar"),d.forEach(u),a.forEach(u),this.h()},h(){E(t,"strong",""),E(t,"disabled",l[22]()),E(e,"slot","end")},m(s,a){q(s,e,a),r(e,t),r(t,n),i||(o=ae(t,"click",l[25]),i=!0)},p:Me,d(s){s&&u(e),i=!1,o()}}}function Mi(l){let e,t,n,i,o,s="Empresa",a,d,k=l[10].enterprise_name+"",v;return{c(){e=f("ion-item"),t=f("ion-icon"),n=O(),i=f("ion-label"),o=f("p"),o.textContent=s,a=O(),d=f("h2"),v=Ne(k),this.h()},l(p){e=h(p,"ION-ITEM",{});var m=g(e);t=h(m,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(u),n=N(m),i=h(m,"ION-LABEL",{});var _=g(i);o=h(_,"P",{"data-svelte-h":!0}),te(o)!=="svelte-6noid3"&&(o.textContent=s),a=N(_),d=h(_,"H2",{});var b=g(d);v=Te(b,k),b.forEach(u),_.forEach(u),m.forEach(u),this.h()},h(){E(t,"icon",Pn),E(t,"slot","start")},m(p,m){q(p,e,m),r(e,t),r(e,n),r(e,i),r(i,o),r(i,a),r(i,d),r(d,v)},p:Me,d(p){p&&u(e)}}}function Si(l){let e,t,n,i,o,s="Negocio",a,d,k=l[10].client_name+"",v;return{c(){e=f("ion-item"),t=f("ion-icon"),n=O(),i=f("ion-label"),o=f("p"),o.textContent=s,a=O(),d=f("h2"),v=Ne(k),this.h()},l(p){e=h(p,"ION-ITEM",{});var m=g(e);t=h(m,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(u),n=N(m),i=h(m,"ION-LABEL",{});var _=g(i);o=h(_,"P",{"data-svelte-h":!0}),te(o)!=="svelte-57b1dg"&&(o.textContent=s),a=N(_),d=h(_,"H2",{});var b=g(d);v=Te(b,k),b.forEach(u),_.forEach(u),m.forEach(u),this.h()},h(){E(t,"icon",Pn),E(t,"slot","start")},m(p,m){q(p,e,m),r(e,t),r(e,n),r(e,i),r(i,o),r(i,a),r(i,d),r(d,v)},p:Me,d(p){p&&u(e)}}}function xi(l){let e,t,n,i,o,s="Teléfono de Negocio",a,d,k=l[10].client_phone+"",v;return{c(){e=f("ion-item"),t=f("ion-icon"),n=O(),i=f("ion-label"),o=f("p"),o.textContent=s,a=O(),d=f("h2"),v=Ne(k),this.h()},l(p){e=h(p,"ION-ITEM",{href:!0});var m=g(e);t=h(m,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(u),n=N(m),i=h(m,"ION-LABEL",{class:!0});var _=g(i);o=h(_,"P",{"data-svelte-h":!0}),te(o)!=="svelte-1u5l7fz"&&(o.textContent=s),a=N(_),d=h(_,"H2",{});var b=g(d);v=Te(b,k),b.forEach(u),_.forEach(u),m.forEach(u),this.h()},h(){E(t,"icon",Fn),E(t,"slot","start"),E(i,"class","ion-text-wrap"),E(e,"href","tel:"+l[10].client_phone)},m(p,m){q(p,e,m),r(e,t),r(e,n),r(e,i),r(i,o),r(i,a),r(i,d),r(d,v)},p:Me,d(p){p&&u(e)}}}function Pi(l){let e,t,n,i,o,s="Domicilio Alternativo",a,d,k=l[10].line2+"",v,p,m,_,b;return{c(){e=f("ion-item"),t=f("ion-icon"),n=O(),i=f("ion-label"),o=f("p"),o.textContent=s,a=O(),d=f("h2"),v=Ne(k),p=O(),m=f("ion-icon"),this.h()},l(y){e=h(y,"ION-ITEM",{button:!0});var w=g(e);t=h(w,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(u),n=N(w),i=h(w,"ION-LABEL",{class:!0});var R=g(i);o=h(R,"P",{"data-svelte-h":!0}),te(o)!=="svelte-1ub9uzw"&&(o.textContent=s),a=N(R),d=h(R,"H2",{});var P=g(d);v=Te(P,k),P.forEach(u),R.forEach(u),p=N(w),m=h(w,"ION-ICON",{icon:!0,slot:!0}),g(m).forEach(u),w.forEach(u),this.h()},h(){E(t,"icon",St),E(t,"slot","start"),E(i,"class","ion-text-wrap"),E(m,"icon",Qe),E(m,"slot","end"),E(e,"button","")},m(y,w){q(y,e,w),r(e,t),r(e,n),r(e,i),r(i,o),r(i,a),r(i,d),r(d,v),r(e,p),r(e,m),_||(b=ae(e,"click",l[36]),_=!0)},p:Me,d(y){y&&u(e),_=!1,b()}}}function Ai(l){let e,t,n,i,o,s="Domicilio",a,d,k=l[10].line1+"",v,p,m,_,b=l[10].line2&&l[10].line2.trim().length,y,w,R,P=b&&Di(l);return{c(){e=f("ion-item"),t=f("ion-icon"),n=O(),i=f("ion-label"),o=f("p"),o.textContent=s,a=O(),d=f("h2"),v=Ne(k),p=O(),m=f("ion-icon"),_=O(),P&&P.c(),y=Ue(),this.h()},l(D){e=h(D,"ION-ITEM",{button:!0});var x=g(e);t=h(x,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(u),n=N(x),i=h(x,"ION-LABEL",{class:!0});var V=g(i);o=h(V,"P",{"data-svelte-h":!0}),te(o)!=="svelte-cbm7q1"&&(o.textContent=s),a=N(V),d=h(V,"H2",{});var U=g(d);v=Te(U,k),U.forEach(u),V.forEach(u),p=N(x),m=h(x,"ION-ICON",{icon:!0,slot:!0}),g(m).forEach(u),x.forEach(u),_=N(D),P&&P.l(D),y=Ue(),this.h()},h(){E(t,"icon",St),E(t,"slot","start"),E(i,"class","ion-text-wrap"),E(m,"icon",Qe),E(m,"slot","end"),E(e,"button","")},m(D,x){q(D,e,x),r(e,t),r(e,n),r(e,i),r(i,o),r(i,a),r(i,d),r(d,v),r(e,p),r(e,m),q(D,_,x),P&&P.m(D,x),q(D,y,x),w||(R=ae(e,"click",l[34]),w=!0)},p(D,x){b&&P.p(D,x)},d(D){D&&(u(e),u(_),u(y)),P&&P.d(D),w=!1,R()}}}function Di(l){let e,t,n,i,o,s="Domicilio Alternativo",a,d,k=l[10].line2+"",v,p,m,_,b;return{c(){e=f("ion-item"),t=f("ion-icon"),n=O(),i=f("ion-label"),o=f("p"),o.textContent=s,a=O(),d=f("h2"),v=Ne(k),p=O(),m=f("ion-icon"),this.h()},l(y){e=h(y,"ION-ITEM",{button:!0});var w=g(e);t=h(w,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(u),n=N(w),i=h(w,"ION-LABEL",{class:!0});var R=g(i);o=h(R,"P",{"data-svelte-h":!0}),te(o)!=="svelte-1ub9uzw"&&(o.textContent=s),a=N(R),d=h(R,"H2",{});var P=g(d);v=Te(P,k),P.forEach(u),R.forEach(u),p=N(w),m=h(w,"ION-ICON",{icon:!0,slot:!0}),g(m).forEach(u),w.forEach(u),this.h()},h(){E(t,"icon",St),E(t,"slot","start"),E(i,"class","ion-text-wrap"),E(m,"icon",Qe),E(m,"slot","end"),E(e,"button","")},m(y,w){q(y,e,w),r(e,t),r(e,n),r(e,i),r(i,o),r(i,a),r(i,d),r(d,v),r(e,p),r(e,m),_||(b=ae(e,"click",l[35]),_=!0)},p:Me,d(y){y&&u(e),_=!1,b()}}}function Bi(l){let e,t,n,i,o,s="Contacto del Cliente",a,d,k,v,p=l[16]&&l[16]==="1"&&Ui(l);return{c(){e=f("ion-item"),t=f("ion-icon"),n=O(),i=f("ion-label"),o=f("p"),o.textContent=s,a=O(),d=f("h2"),k=Ne(l[18]),v=O(),p&&p.c(),this.h()},l(m){e=h(m,"ION-ITEM",{});var _=g(e);t=h(_,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(u),n=N(_),i=h(_,"ION-LABEL",{class:!0});var b=g(i);o=h(b,"P",{"data-svelte-h":!0}),te(o)!=="svelte-1utsyb6"&&(o.textContent=s),a=N(b),d=h(b,"H2",{});var y=g(d);k=Te(y,l[18]),y.forEach(u),b.forEach(u),v=N(_),p&&p.l(_),_.forEach(u),this.h()},h(){E(t,"icon",qn),E(t,"slot","start"),E(i,"class","ion-text-wrap")},m(m,_){q(m,e,_),r(e,t),r(e,n),r(e,i),r(i,o),r(i,a),r(i,d),r(d,k),r(e,v),p&&p.m(e,null)},p(m,_){m[16]&&m[16]==="1"&&p.p(m,_)},d(m){m&&u(e),p&&p.d()}}}function Ui(l){let e,t=`<ion-icon icon="${Xn}" slot="start"></ion-icon>
                        Notificar Cliente`,n,i;return{c(){e=f("ion-button"),e.innerHTML=t,this.h()},l(o){e=h(o,"ION-BUTTON",{fill:!0,style:!0,"data-svelte-h":!0}),te(e)!=="svelte-149vhpt"&&(e.innerHTML=t),this.h()},h(){E(e,"fill","outline"),c(e,"margin-left","16px")},m(o,s){q(o,e,s),n||(i=ae(e,"click",l[26]),n=!0)},p:Me,d(o){o&&u(e),n=!1,i()}}}function zi(l){let e,t,n,i,o,s="Notas de ubicación",a,d,k;return{c(){e=f("ion-item"),t=f("ion-icon"),n=O(),i=f("ion-label"),o=f("p"),o.textContent=s,a=O(),d=f("h2"),k=Ne(l[19]),this.h()},l(v){e=h(v,"ION-ITEM",{});var p=g(e);t=h(p,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(u),n=N(p),i=h(p,"ION-LABEL",{class:!0});var m=g(i);o=h(m,"P",{"data-svelte-h":!0}),te(o)!=="svelte-nhm2ft"&&(o.textContent=s),a=N(m),d=h(m,"H2",{});var _=g(d);k=Te(_,l[19]),_.forEach(u),m.forEach(u),p.forEach(u),this.h()},h(){E(t,"icon",Mn),E(t,"slot","start"),E(i,"class","ion-text-wrap")},m(v,p){q(v,e,p),r(e,t),r(e,n),r(e,i),r(i,o),r(i,a),r(i,d),r(d,k)},p:Me,d(v){v&&u(e)}}}function Hi(l){let e,t,n,i,o,s="Horarios",a,d,k=l[10].schedule+"",v;return{c(){e=f("ion-item"),t=f("ion-icon"),n=O(),i=f("ion-label"),o=f("p"),o.textContent=s,a=O(),d=f("h2"),v=Ne(k),this.h()},l(p){e=h(p,"ION-ITEM",{});var m=g(e);t=h(m,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(u),n=N(m),i=h(m,"ION-LABEL",{});var _=g(i);o=h(_,"P",{"data-svelte-h":!0}),te(o)!=="svelte-11q7hm5"&&(o.textContent=s),a=N(_),d=h(_,"H2",{});var b=g(d);v=Te(b,k),b.forEach(u),_.forEach(u),m.forEach(u),this.h()},h(){E(t,"icon",Wn),E(t,"slot","start")},m(p,m){q(p,e,m),r(e,t),r(e,n),r(e,i),r(i,o),r(i,a),r(i,d),r(d,v)},p:Me,d(p){p&&u(e)}}}function Ri(l){let e,t,n,i,o,s="Notas del operador",a,d,k=l[10].driver_comments+"",v;return{c(){e=f("ion-item"),t=f("ion-icon"),n=O(),i=f("ion-label"),o=f("p"),o.textContent=s,a=O(),d=f("h2"),v=Ne(k),this.h()},l(p){e=h(p,"ION-ITEM",{});var m=g(e);t=h(m,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(u),n=N(m),i=h(m,"ION-LABEL",{});var _=g(i);o=h(_,"P",{"data-svelte-h":!0}),te(o)!=="svelte-1yk9qp4"&&(o.textContent=s),a=N(_),d=h(_,"H2",{});var b=g(d);v=Te(b,k),b.forEach(u),_.forEach(u),m.forEach(u),this.h()},h(){E(t,"icon",Sn),E(t,"slot","start")},m(p,m){q(p,e,m),r(e,t),r(e,n),r(e,i),r(i,o),r(i,a),r(i,d),r(d,v)},p:Me,d(p){p&&u(e)}}}function Vi(l){let e,t=l[10].logistic_comments!="<br>"&&Fi(l);return{c(){t&&t.c(),e=Ue()},l(n){t&&t.l(n),e=Ue()},m(n,i){t&&t.m(n,i),q(n,e,i)},p(n,i){n[10].logistic_comments!="<br>"&&t.p(n,i)},d(n){n&&u(e),t&&t.d(n)}}}function Fi(l){let e,t,n,i,o,s="Comentarios logísticos",a,d,k=l[10].logistic_comments+"",v;return{c(){e=f("ion-item"),t=f("ion-icon"),n=O(),i=f("ion-label"),o=f("p"),o.textContent=s,a=O(),d=f("h2"),v=Ne(k),this.h()},l(p){e=h(p,"ION-ITEM",{});var m=g(e);t=h(m,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(u),n=N(m),i=h(m,"ION-LABEL",{class:!0});var _=g(i);o=h(_,"P",{"data-svelte-h":!0}),te(o)!=="svelte-1iz85r6"&&(o.textContent=s),a=N(_),d=h(_,"H2",{});var b=g(d);v=Te(b,k),b.forEach(u),_.forEach(u),m.forEach(u),this.h()},h(){E(t,"icon",Mn),E(t,"slot","start"),E(i,"class","ion-text-wrap")},m(p,m){q(p,e,m),r(e,t),r(e,n),r(e,i),r(i,o),r(i,a),r(i,d),r(d,v)},p:Me,d(p){p&&u(e)}}}function qi(l){let e,t,n,i,o="<p>Etiqueta</p>",s,a,d=(l[10].tag?l[10].tag:"")+"",k;return{c(){e=f("ion-item"),t=f("ion-icon"),n=O(),i=f("ion-label"),i.innerHTML=o,s=O(),a=f("div"),k=Ne(d),this.h()},l(v){e=h(v,"ION-ITEM",{});var p=g(e);t=h(p,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(u),n=N(p),i=h(p,"ION-LABEL",{class:!0,"data-svelte-h":!0}),te(i)!=="svelte-50rr6d"&&(i.innerHTML=o),s=N(p),a=h(p,"DIV",{class:!0,style:!0});var m=g(a);k=Te(m,d),m.forEach(u),p.forEach(u),this.h()},h(){E(t,"icon",jn),E(t,"slot","start"),E(i,"class","ion-text-wrap"),W(a,"class","stop-tag"),c(a,"background-color",l[20]),c(a,"border","1px solid "+l[21]),c(a,"color",l[10].tag_color),c(a,"font-size","14px"),c(a,"text-align","center"),c(a,"align-content","center"),c(a,"border-radius","20px"),c(a,"white-space","normal"),c(a,"padding","4px 8px"),c(a,"width","auto",1),c(a,"display","inline-block")},m(v,p){q(v,e,p),r(e,t),r(e,n),r(e,i),r(e,s),r(e,a),r(a,k)},p:Me,d(v){v&&u(e)}}}function Wi(l){let e,t,n,i,o="<p>Estado de entrega</p>",s,a,d,k="Entregado",v,p,m="No Entregado",_,b,y="Entrega Parcial",w,R,P,D,x,V="<p>Notas</p>",U,C,H,B,I=!l[13]&&ji(l);return{c(){e=f("ion-item"),t=f("ion-icon"),n=O(),i=f("ion-label"),i.innerHTML=o,s=O(),a=f("ion-select"),d=f("ion-select-option"),d.textContent=k,v=O(),p=f("ion-select-option"),p.textContent=m,_=O(),b=f("ion-select-option"),b.textContent=y,w=O(),R=f("ion-item"),P=f("ion-icon"),D=O(),x=f("ion-label"),x.innerHTML=V,U=O(),C=f("ion-textarea"),H=O(),I&&I.c(),B=Ue(),this.h()},l(T){e=h(T,"ION-ITEM",{});var A=g(e);t=h(A,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(u),n=N(A),i=h(A,"ION-LABEL",{class:!0,"data-svelte-h":!0}),te(i)!=="svelte-1ql9csq"&&(i.innerHTML=o),s=N(A),a=h(A,"ION-SELECT",{value:!0,disabled:!0});var S=g(a);d=h(S,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),te(d)!=="svelte-1nhq8vd"&&(d.textContent=k),v=N(S),p=h(S,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),te(p)!=="svelte-dhd4r3"&&(p.textContent=m),_=N(S),b=h(S,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),te(b)!=="svelte-17taxwo"&&(b.textContent=y),S.forEach(u),A.forEach(u),w=N(T),R=h(T,"ION-ITEM",{});var X=g(R);P=h(X,"ION-ICON",{icon:!0,slot:!0}),g(P).forEach(u),D=N(X),x=h(X,"ION-LABEL",{class:!0,"data-svelte-h":!0}),te(x)!=="svelte-c9yniu"&&(x.innerHTML=V),U=N(X),C=h(X,"ION-TEXTAREA",{placeholder:!0,readonly:!0,disabled:!0}),g(C).forEach(u),X.forEach(u),H=N(T),I&&I.l(T),B=Ue(),this.h()},h(){E(t,"icon",Gn),E(t,"slot","start"),E(i,"class","ion-text-wrap"),E(d,"value","delivered"),E(p,"value","notdelivered"),E(b,"value","partialdeliver"),E(a,"value",l[15]?l[15]:"delivered"),E(a,"disabled",l[13]),E(P,"icon",mt),E(P,"slot","start"),E(x,"class","ion-text-wrap"),E(C,"placeholder","Escribe aquí..."),E(C,"readonly",l[13]),E(C,"disabled",l[13])},m(T,A){q(T,e,A),r(e,t),r(e,n),r(e,i),r(e,s),r(e,a),r(a,d),r(a,v),r(a,p),r(a,_),r(a,b),l[37](a),q(T,w,A),q(T,R,A),r(R,P),r(R,D),r(R,x),r(R,U),r(R,C),l[38](C),q(T,H,A),I&&I.m(T,A),q(T,B,A)},p(T,A){T[13]||I.p(T,A)},d(T){T&&(u(e),u(w),u(R),u(H),u(B)),l[37](null),l[38](null),I&&I.d(T)}}}function ji(l){let e,t,n=l[5]===!0&&qt(l),i=(l[6]===!0||l[6]===!1&&l[5]===!1)&&Wt(l);return{c(){e=f("section"),n&&n.c(),t=O(),i&&i.c(),this.h()},l(o){e=h(o,"SECTION",{style:!0});var s=g(e);n&&n.l(s),t=N(s),i&&i.l(s),s.forEach(u),this.h()},h(){c(e,"display","flex"),c(e,"gap","8px"),c(e,"padding","16px 16px 6px")},m(o,s){q(o,e,s),n&&n.m(e,null),r(e,t),i&&i.m(e,null)},p(o,s){o[5]===!0?n?n.p(o,s):(n=qt(o),n.c(),n.m(e,t)):n&&(n.d(1),n=null),o[6]===!0||o[6]===!1&&o[5]===!1?i?i.p(o,s):(i=Wt(o),i.c(),i.m(e,null)):i&&(i.d(1),i=null)},d(o){o&&u(e),n&&n.d(),i&&i.d()}}}function qt(l){let e,t=`<ion-icon icon="${Jn}" slot="start"></ion-icon>
                        Ingreso`,n,i;return{c(){e=f("ion-button"),e.innerHTML=t,this.h()},l(o){e=h(o,"ION-BUTTON",{id:!0,style:!0,"data-svelte-h":!0}),te(e)!=="svelte-izs0s1"&&(e.innerHTML=t),this.h()},h(){E(e,"id","checkInBtn"),c(e,"flex","1")},m(o,s){q(o,e,s),n||(i=ae(e,"click",l[27]),n=!0)},p:Me,d(o){o&&u(e),n=!1,i()}}}function Wt(l){let e,t,n,i,o,s;return{c(){e=f("ion-button"),t=f("ion-icon"),n=Ne(`\r
                        Salida`),this.h()},l(a){e=h(a,"ION-BUTTON",{id:!0,style:!0,disabled:!0});var d=g(e);t=h(d,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(u),n=Te(d,`\r
                        Salida`),d.forEach(u),this.h()},h(){E(t,"icon",Kn),E(t,"slot","start"),E(e,"id","checkOutBtn"),c(e,"flex","1"),E(e,"disabled",i=l[6]===!1)},m(a,d){q(a,e,d),r(e,t),r(e,n),o||(s=ae(e,"click",l[28]),o=!0)},p(a,d){d[0]&64&&i!==(i=a[6]===!1)&&E(e,"disabled",i)},d(a){a&&u(e),o=!1,s()}}}function Gi(l){let e,t,n,i,o,s,a,d,k,v=l[17]==="1"&&Ki(l);return{c(){e=f("section"),t=f("ion-button"),n=f("label"),i=f("ion-icon"),o=Ne(`\r
        Evidencia\r
        `),s=f("input"),a=O(),v&&v.c(),this.h()},l(p){e=h(p,"SECTION",{style:!0});var m=g(e);t=h(m,"ION-BUTTON",{fill:!0,class:!0,style:!0,disabled:!0});var _=g(t);n=h(_,"LABEL",{for:!0,style:!0});var b=g(n);i=h(b,"ION-ICON",{icon:!0,slot:!0,style:!0}),g(i).forEach(u),o=Te(b,`\r
        Evidencia\r
        `),s=h(b,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0,capture:!0}),b.forEach(u),_.forEach(u),a=N(m),v&&v.l(m),m.forEach(u),this.h()},h(){E(i,"icon",Mt),E(i,"slot","start"),c(i,"vertical-align","middle"),c(s,"display","none"),W(s,"id","eventEvidence"),W(s,"name","fileToUpload"),W(s,"type","file"),s.multiple=!0,W(s,"accept","image/*"),W(s,"capture","environment"),s.disabled=l[22](),W(n,"for","eventEvidence"),c(n,"width","100%"),c(n,"height","100%"),c(n,"pointer-events",l[22]()?"none":"auto"),E(t,"fill","outline"),E(t,"class","loadEvidence"),c(t,"flex","1"),c(t,"display","flex"),c(t,"align-items","center"),c(t,"gap","8px"),E(t,"disabled",l[22]()),c(e,"display","flex"),c(e,"gap","8px"),c(e,"padding","0px 16px")},m(p,m){q(p,e,m),r(e,t),r(t,n),r(n,i),r(n,o),r(n,s),r(e,a),v&&v.m(e,null),d||(k=[ae(s,"change",l[23]),ae(s,"click",l[24])],d=!0)},p(p,m){p[17]==="1"&&v.p(p,m)},d(p){p&&u(e),v&&v.d(),d=!1,Fe(k)}}}function Ki(l){let e,t,n,i,o;return{c(){e=f("ion-button"),t=f("ion-icon"),n=Ne(`\r
        Firmar`),this.h()},l(s){e=h(s,"ION-BUTTON",{fill:!0,style:!0,disabled:!0});var a=g(e);t=h(a,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(u),n=Te(a,`\r
        Firmar`),a.forEach(u),this.h()},h(){E(t,"icon",mt),E(t,"slot","start"),E(e,"fill","outline"),c(e,"flex","1"),c(e,"display","flex"),c(e,"align-items","center"),c(e,"gap","8px"),E(e,"disabled",l[22]())},m(s,a){q(s,e,a),r(e,t),r(e,n),i||(o=ae(e,"click",l[32]),i=!0)},p:Me,d(s){s&&u(e),i=!1,o()}}}function jt(l){let e,t,n=We(l[3]),i=[];for(let o=0;o<n.length;o+=1)i[o]=Gt(Ft(l,n,o));return{c(){e=f("section"),t=f("div");for(let o=0;o<i.length;o+=1)i[o].c();this.h()},l(o){e=h(o,"SECTION",{});var s=g(e);t=h(s,"DIV",{class:!0,style:!0});var a=g(t);for(let d=0;d<i.length;d+=1)i[d].l(a);a.forEach(u),s.forEach(u),this.h()},h(){W(t,"class","image-grid"),c(t,"display","grid"),c(t,"grid-template-columns","repeat(auto-fill, minmax(100px, 1fr))"),c(t,"gap","10px"),c(t,"padding","0px 10px")},m(o,s){q(o,e,s),r(e,t);for(let a=0;a<i.length;a+=1)i[a]&&i[a].m(t,null)},p(o,s){if(s[0]&536880136|s[1]&1){n=We(o[3]);let a;for(a=0;a<n.length;a+=1){const d=Ft(o,n,a);i[a]?i[a].p(d,s):(i[a]=Gt(d),i[a].c(),i[a].m(t,null))}for(;a<i.length;a+=1)i[a].d(1);i.length=n.length}},d(o){o&&u(e),bt(i,o)}}}function Xi(l){let e,t=`<ion-icon icon="${Pt}"></ion-icon>`,n,i;function o(){return l[40](l[66])}return{c(){e=f("button"),e.innerHTML=t,this.h()},l(s){e=h(s,"BUTTON",{class:!0,style:!0,"data-svelte-h":!0}),te(e)!=="svelte-mf38w5"&&(e.innerHTML=t),this.h()},h(){W(e,"class","remove-button"),c(e,"position","absolute"),c(e,"top","5px"),c(e,"right","5px"),c(e,"border","none"),c(e,"cursor","pointer"),c(e,"font-size","18px"),c(e,"background","white"),c(e,"border-radius","50%"),c(e,"padding","3px 4px 0px"),c(e,"box-shadow","2px 2px 6px rgba(0, 0, 0, 0.3)"),c(e,"color","#0000008f")},m(s,a){q(s,e,a),n||(i=ae(e,"click",o),n=!0)},p(s,a){l=s},d(s){s&&u(e),n=!1,i()}}}function Gt(l){let e,t,n,i,o,s,a;function d(){return l[39](l[64])}let k=l[10].status!=="completed"&&!l[13]&&Xi(l);return{c(){e=f("div"),t=f("ion-img"),i=O(),k&&k.c(),o=O(),this.h()},l(v){e=h(v,"DIV",{class:!0,style:!0});var p=g(e);t=h(p,"ION-IMG",{src:!0,alt:!0,style:!0}),g(t).forEach(u),i=N(p),k&&k.l(p),o=N(p),p.forEach(u),this.h()},h(){Ye(t.src,n=l[64])||E(t,"src",n),E(t,"alt","Evidencia fotográfica"),c(t,"width","100%"),c(t,"height","100px"),c(t,"object-fit","cover"),c(t,"cursor","pointer"),c(t,"border","1px solid #ccc"),c(t,"border-radius","4px"),c(t,"margin-top","16px"),W(e,"class","image-container"),c(e,"position","relative")},m(v,p){q(v,e,p),r(e,t),r(e,i),k&&k.m(e,null),r(e,o),s||(a=ae(t,"click",d),s=!0)},p(v,p){l=v,p[0]&8&&!Ye(t.src,n=l[64])&&E(t,"src",n),l[10].status!=="completed"&&!l[13]&&k.p(l,p)},d(v){v&&u(e),k&&k.d(),s=!1,a()}}}function Kt(l){let e,t='<ion-spinner name="dots" style="color:white;"></ion-spinner>';return{c(){e=f("div"),e.innerHTML=t,this.h()},l(n){e=h(n,"DIV",{class:!0,style:!0,"data-svelte-h":!0}),te(e)!=="svelte-1aosxw0"&&(e.innerHTML=t),this.h()},h(){W(e,"class","overlay"),c(e,"position","fixed"),c(e,"top","0"),c(e,"left","0"),c(e,"width","100vw"),c(e,"height","100vh"),c(e,"background","rgba(0, 0, 0, 0.5)"),c(e,"display","flex"),c(e,"align-items","center"),c(e,"justify-content","center"),c(e,"z-index","9999")},m(n,i){q(n,e,i)},d(n){n&&u(e)}}}function Xt(l){let e,t,n,i,o,s,a=`<ion-icon icon="${xt}"></ion-icon>`,d,k;return{c(){e=f("div"),t=f("div"),n=f("ion-img"),o=O(),s=f("button"),s.innerHTML=a,this.h()},l(v){e=h(v,"DIV",{class:!0,style:!0});var p=g(e);t=h(p,"DIV",{class:!0,style:!0});var m=g(t);n=h(m,"ION-IMG",{src:!0,alt:!0,style:!0}),g(n).forEach(u),o=N(m),s=h(m,"BUTTON",{class:!0,style:!0,"data-svelte-h":!0}),te(s)!=="svelte-183t4ti"&&(s.innerHTML=a),m.forEach(u),p.forEach(u),this.h()},h(){Ye(n.src,i=l[8])||E(n,"src",i),E(n,"alt","Evidencia fotográfica"),c(n,"width","100%"),c(n,"height","auto"),W(s,"class","close-button"),c(s,"position","absolute"),c(s,"top","5px"),c(s,"right","5px"),c(s,"background","white"),c(s,"color","#444444d1"),c(s,"border","none"),c(s,"cursor","pointer"),c(s,"padding","2px 2px 0px 6px"),c(s,"border-radius","50%"),c(s,"font-size","20px"),W(t,"class","modal-content"),c(t,"position","relative"),c(t,"background","white"),c(t,"padding","20px"),c(t,"border-radius","8px"),c(t,"max-width","90vw"),c(t,"max-height","90vh"),c(t,"overflow","auto"),W(e,"class","modal-overlay"),c(e,"position","fixed"),c(e,"top","0"),c(e,"left","0"),c(e,"width","100vw"),c(e,"height","100vh"),c(e,"background","rgba(0, 0, 0, 0.8)"),c(e,"display","flex"),c(e,"justify-content","center"),c(e,"align-items","center"),c(e,"z-index","1000")},m(v,p){q(v,e,p),r(e,t),r(t,n),r(t,o),r(t,s),d||(k=[ae(s,"click",l[30]),ae(t,"click",Ct(l[33])),ae(e,"click",l[30])],d=!0)},p(v,p){p[0]&256&&!Ye(n.src,i=v[8])&&E(n,"src",i)},d(v){v&&u(e),d=!1,Fe(k)}}}function Ji(l){let e,t,n,i,o="Cerrar",s,a,d=l[10].title+"",k,v,p,m,_,b,y=l[10].client_phone&&l[10].client_phone.trim().length,w,R,P,D,x=l[10].schedule&&l[10].schedule.trim().length,V,U,C=l[10].logistic_comments&&l[10].logistic_comments.trim().length,H,B,I,T,A,S,X,ne,re,Ee=(!l[11]&&!l[12]||l[11]&&l[12])&&Li(l);function Z(Y,de){return Y[10].client_name!=null?Si:Mi}let $=Z(l)(l),ue=y&&xi(l);function pe(Y,de){if(Y[10].line1&&Y[10].line1.trim().length)return Ai;if(Y[10].line2&&Y[10].line2.trim().length)return Pi}let fe=pe(l),ce=fe&&fe(l),be=l[18]&&Bi(l),me=l[19]&&l[19]!=="<br>"&&zi(l),ie=x&&Hi(l),ke=l[10].driver_comments&&Ri(l),ye=C&&Vi(l),we=l[10].tag&&l[10].tag_color&&qi(l),ve=!l[12]&&Wi(l),z=(l[11]&&l[12]||!l[11]&&!l[12])&&Gi(l),G=l[2]&&jt(l),F=l[4]&&Kt(),le=l[7]&&Xt(l);return{c(){e=f("ion-header"),t=f("ion-toolbar"),n=f("ion-buttons"),i=f("ion-button"),i.textContent=o,s=O(),a=f("ion-title"),k=Ne(d),v=O(),Ee&&Ee.c(),p=O(),m=f("ion-content"),_=f("ion-list"),$.c(),b=O(),ue&&ue.c(),w=O(),ce&&ce.c(),R=O(),be&&be.c(),P=O(),me&&me.c(),D=O(),ie&&ie.c(),V=O(),ke&&ke.c(),U=O(),ye&&ye.c(),H=O(),we&&we.c(),B=O(),ve&&ve.c(),I=O(),z&&z.c(),T=O(),G&&G.c(),A=O(),F&&F.c(),S=O(),le&&le.c(),X=Ue(),this.h()},l(Y){e=h(Y,"ION-HEADER",{translucent:!0});var de=g(e);t=h(de,"ION-TOOLBAR",{});var xe=g(t);n=h(xe,"ION-BUTTONS",{slot:!0});var Be=g(n);i=h(Be,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),te(i)!=="svelte-2ks32x"&&(i.textContent=o),Be.forEach(u),s=N(xe),a=h(xe,"ION-TITLE",{style:!0,title:!0});var Ae=g(a);k=Te(Ae,d),Ae.forEach(u),v=N(xe),Ee&&Ee.l(xe),xe.forEach(u),de.forEach(u),p=N(Y),m=h(Y,"ION-CONTENT",{fullscreen:!0});var Pe=g(m);_=h(Pe,"ION-LIST",{});var Ce=g(_);$.l(Ce),b=N(Ce),ue&&ue.l(Ce),w=N(Ce),ce&&ce.l(Ce),R=N(Ce),be&&be.l(Ce),P=N(Ce),me&&me.l(Ce),D=N(Ce),ie&&ie.l(Ce),V=N(Ce),ke&&ke.l(Ce),U=N(Ce),ye&&ye.l(Ce),H=N(Ce),we&&we.l(Ce),B=N(Ce),ve&&ve.l(Ce),I=N(Ce),z&&z.l(Ce),T=N(Ce),G&&G.l(Ce),Ce.forEach(u),Pe.forEach(u),A=N(Y),F&&F.l(Y),S=N(Y),le&&le.l(Y),X=Ue(),this.h()},h(){E(i,"color","medium"),E(n,"slot","start"),c(a,"text-align","center"),E(a,"title",l[10].title),E(e,"translucent",""),E(m,"fullscreen","")},m(Y,de){q(Y,e,de),r(e,t),r(t,n),r(n,i),r(t,s),r(t,a),r(a,k),r(t,v),Ee&&Ee.m(t,null),q(Y,p,de),q(Y,m,de),r(m,_),$.m(_,null),r(_,b),ue&&ue.m(_,null),r(_,w),ce&&ce.m(_,null),r(_,R),be&&be.m(_,null),r(_,P),me&&me.m(_,null),r(_,D),ie&&ie.m(_,null),r(_,V),ke&&ke.m(_,null),r(_,U),ye&&ye.m(_,null),r(_,H),we&&we.m(_,null),r(_,B),ve&&ve.m(_,null),r(_,I),z&&z.m(_,null),r(_,T),G&&G.m(_,null),q(Y,A,de),F&&F.m(Y,de),q(Y,S,de),le&&le.m(Y,de),q(Y,X,de),ne||(re=ae(i,"click",l[0]),ne=!0)},p(Y,de){(!Y[11]&&!Y[12]||Y[11]&&Y[12])&&Ee.p(Y,de),$.p(Y,de),y&&ue.p(Y,de),ce&&ce.p(Y,de),Y[18]&&be.p(Y,de),Y[19]&&Y[19]!=="<br>"&&me.p(Y,de),x&&ie.p(Y,de),Y[10].driver_comments&&ke.p(Y,de),C&&ye.p(Y,de),Y[10].tag&&Y[10].tag_color&&we.p(Y,de),Y[12]||ve.p(Y,de),(Y[11]&&Y[12]||!Y[11]&&!Y[12])&&z.p(Y,de),Y[2]?G?G.p(Y,de):(G=jt(Y),G.c(),G.m(_,null)):G&&(G.d(1),G=null),Y[4]?F||(F=Kt(),F.c(),F.m(S.parentNode,S)):F&&(F.d(1),F=null),Y[7]?le?le.p(Y,de):(le=Xt(Y),le.c(),le.m(X.parentNode,X)):le&&(le.d(1),le=null)},i:Me,o:Me,d(Y){Y&&(u(e),u(p),u(m),u(A),u(S),u(X)),Ee&&Ee.d(),$.d(),ue&&ue.d(),ce&&ce.d(),be&&be.d(),me&&me.d(),ie&&ie.d(),ke&&ke.d(),ye&&ye.d(),we&&we.d(),ve&&ve.d(),z&&z.d(),G&&G.d(),F&&F.d(Y),le&&le.d(Y),ne=!1,re()}}}function Yi(l){const[e,t]=l.split(","),n=e.match(/:(.*?);/)[1],i=atob(t),o=i.length,s=new Uint8Array(o);for(let a=0;a<o;a++)s[a]=i.charCodeAt(a);return new Blob([s],{type:n})}function Qi(l,e,t){let n=ht,i=document.querySelector("ion-modal"),o=i.componentProps.delivery,s=i.componentProps.isLast||!1,a=i.componentProps.flag||!1,d=!!i.componentProps.readOnly,k=i.componentProps.maybeWarnChecklist,v=o.driver_comments?o.driver_comments:"",p=o.deliver_status?o.deliver_status:"",m=o.img?o.img:"",_=o.img_id?o.img_id:"",b=m?et(m):new Array,y=_?et(_):new Array,w={latitude:null,longitude:null},R=o.stopsApproval,P=o.smsActive,D=o.signatureActive,x=!1,V=!0,U=!1,C=o.phone_notification,H=o.comments_ext,B=!1,I="",T=new Object,A="",S=o.tag_color?Ge(o.tag_color,.2):"",X=o.tag_color?Ge(o.tag_color,.3):"",ne=!1;const re=()=>d||o.status=="completed";rt(()=>{T=JSON.parse(localStorage.getItem("userSession")),Ee()});function Ee(){o.date_service?o.date_service&&!o.date_completed&&!o.service_time?(t(5,V=!1),t(6,U=!0)):o.date_service&&o.date_completed&&o.service_time&&(t(5,V=!1),t(6,U=!1)):(t(5,V=!0),t(6,U=!1))}const Z=async(j,oe)=>{await(await $e.create({header:j||"Error",message:oe||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()},L=async(j="",oe="",se="",M=function(Q={}){},J={})=>{await(await $e.create({header:j||"Error",message:oe||"Vuelva a intentar",buttons:[{text:"No",role:"cancel",handler:()=>{}},{text:"Sí",handler:()=>{t(4,x=!0),Je(se,function(_e={}){t(4,x=!1),M(_e)},J)}}]})).present()};async function $(j,oe){await(await $e.create({header:"¿Cómo quieres notificar?",message:`Elige el medio para enviar mensaje a ${j.title} (${oe})`,buttons:[{text:"SMS",handler:()=>ye("sms",j,oe)},{text:"WhatsApp",handler:()=>ye("whatsapp",j,oe)}]})).present()}const ue=async j=>{if(d){Z("Solo lectura","Completa los requisitos para editar.");return}if(b.length>=5){Z("Límite de evidencias","Solo se permite subir 5 fotos por parada");return}if(a&&s&&b.length>=1){Z("Límite de evidencias","Para el final de la ruta solo se permite subir 1 foto");return}const se=j.target.files[0];if(se)try{t(4,x=!0);const M=await ce(se);M&&Je(`${n}api/admin/manager/upload_img_driver.php`,function(J){J.success?(t(2,m=m?`${m},${J.img}`:J.img),_=_?`${_},${J.img_id}`:J.img_id,t(3,b=et(m)),y=et(_)):Z("Carga fallida","Actualiza la página y vuelve a intentar. Si el problema persiste, contacta a soporte.")},{fileToUpload:M})}catch(M){console.error("Compression error:",M)}finally{t(4,x=!1)}};function pe(j){var se;if(d){(se=j==null?void 0:j.preventDefault)==null||se.call(j),Z("Solo lectura","Completa los requisitos para editar.");return}var oe=o.service_time;!oe&&V&&!s&&!a&&(j.preventDefault(),Z("Registrar Ingreso","Antes de subir la evidencia registra el ingreso a la actual parada."))}function fe(){if(d){Z("Solo lectura","Completa los requisitos para editar.");return}var j=a?o.date_completed:!1;if(!j&&!V&&U&&!s&&!a){var oe=new Object;oe.id_event=o.id_event,oe.type="checkout",oe.id_user_over=T.id_user,oe.token=T.token,L("Registrar Salida","¿Completaste tu entrega?",n+"api/admin/route/record_check_date.php",function(se){se.minutes&&Z("Tiempo por parada","Completaste la parada en "+se.minutes+" minutos.")},oe)}}const ce=async j=>new Promise(oe=>{const se=new Image;se.src=URL.createObjectURL(j),se.onload=()=>{const M=document.createElement("canvas"),J=M.getContext("2d"),Q=800,_e=600;let Le=se.width,Se=se.height;Le>Q&&(Se*=Q/Le,Le=Q),Se>_e&&(Le*=_e/Se,Se=_e),M.width=Le,M.height=Se,J.drawImage(se,0,0,Le,Se),M.toBlob(Oe=>{oe(Oe),URL.revokeObjectURL(se.src),J.clearRect(0,0,M.width,M.height)},"image/jpeg",.7)}});async function be(){try{if(i!=null&&i.isConnected){await i.dismiss({data:Date.now()});return}const j=await tt.getTop();j&&await j.dismiss({data:Date.now()})}catch{console.warn("Close Modal Safe: modal ya cerrado o inexistente")}}const me=async()=>{if(d){Z("Solo lectura","Completa los requisitos para confirmar.");return}if(!x){t(4,x=!0);try{if(t(2,m=b.join(",")),_=y.join(","),fe(),await ke())if(A.value=="delivered"||A.value!=="delivered"&&(v.value||o.driver_comments)||a&&s){const oe={id_route:o.id_route,...!a&&!s&&{id_event:o.id_event},...!a&&!s&&{comments:v.value},...!a&&!s&&{deliver_status:A.value},img:m,img_id:_,lat:w.latitude,lon:w.longitude,...R==="0"&&{approve:"0"},...s&&{isLast:!0},...a&&s&&{destiny:!0},id_user_over:T.id_user,token:T.token};oe.img&&oe.img_id||m?Je(`${n}api/admin/evidence/send_evidence.php`,function(se){if(se.success==!0){be();const M=oe.id_route;s&&(ie("","",M,s),R=="0"&&de(M,"completed"))}else t(4,x=!1),Z("Carga fallida","Actualiza la página y vuelve a intentar cargar la información!")},oe):Z("Información incompleta","Cargar evidencia fotográfica faltante para completar parada.")}else Z("Motivo de status de entrega","Favor de ingresar en notas el motivo por el que la entrega no fue entregada correctamente");else Z("Ubicación faltante","Asegúrate darle permisos a Rutaflow para acceder a tu ubicación")}catch(j){console.error("Error fetching data:",j)}finally{t(4,x=!1)}}},ie=(j,oe,se,M)=>{i.componentProps.routeId=se,i.componentProps.driverId=o.id_driver,Ze("modal-km-gas",Dn,{checklist:j,driverId:oe,routeId:se,isLast:M}).then(J=>{})},ke=async()=>navigator.geolocation?new Promise((j,oe)=>{navigator.geolocation.getCurrentPosition(se=>{w.latitude=se.coords.latitude,w.longitude=se.coords.longitude,j(!0)},se=>{console.error("Error getting location:",se),j(!1)})}):(console.error("Geolocation is not supported by your browser"),!1);async function ye(j,oe,se){const M={};if(j==="sms"){M.id_user_over=T.id_user,M.token=T.token,M.client_phone=se,M.client_name=oe.title,M.delivery_phone=oe.client_phone,M.enterprise_name=oe.enterprise_name,Je(`${n}api/admin/message_central/send_sms.php`,we("SMS",oe.title,se),M);return}try{var J=oe.client_phone?`
Si deseas contactarnos, entra al siguiente link: https://wa.me/${oe.client_phone}.`:".";M.text=`*Rutaflow*

El repartidor va en camino a tu domicilio ${oe.title}${J}

Enviado por _${oe.enterprise_name}_`,M.phone=se;const _e=await(await fetch(`${ii}`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`${oi}`},body:JSON.stringify(M)})).json();we("WHATSAPP",oe.title,se)(_e)}catch(Q){console.error(Q),Z("WHATSAPP no enviado","Ocurrió un error de red.")}}function we(j,oe,se){return M=>{M.success?Z(`${j} enviado`,`Se envió correctamente un ${j} a ${oe} con número ${se}.`):Z(`${j} no enviado`,`Hubo un error al enviar ${j} a ${oe} (${se}).`)}}function ve(j){j.stopPropagation(),$(o,C)}function z(){if(d){Z("Solo lectura","Completa los requisitos para editar.");return}t(5,V=!1),t(6,U=!0),F(o.id_event,"checkin")}function G(){if(d){Z("Solo lectura","Completa los requisitos para editar.");return}t(6,U=!1),t(5,V=!1),F(o.id_event,"checkout")}async function F(j,oe){if(!d&&oe){let se=new Object;se.type=oe,se.id_event=j,se.id_user_over=T.id_user,se.token=T.token;try{Je(`${n}api/admin/route/record_check_date.php`,function(M){M.minutes&&Z("Tiempo por parada","Completaste la parada en "+M.minutes+" minutos.")},se)}catch(M){console.error("Error during file upload:",M)}finally{}}}const le=j=>{t(8,I=j),t(7,B=!0)},Y=()=>{t(7,B=!1),t(8,I="")};function de(j,oe){let se=new Object;return se.id_route=j,se.status=oe,se.id_user_over=T.id_user,se.token=T.token,Je(`${n}api/admin/route/change_status.php`,function(){},se),""}function xe(j=0){if(!d){var oe=xn(j,b,y,m);t(3,b=oe.files),y=oe.img_ids,t(2,m=oe.selectedImages)}}async function Be(){var se;if(d){Z("Solo lectura","Completa los requisitos para firmar.");return}const j=await Ze("modal-signature-plugin",Ci,{},{backdropDismiss:!1,swipeToClose:!1,showBackdrop:!0,canDismiss:(M,J)=>J==="cancel"||J==="confirm"}),oe=((se=j==null?void 0:j.data)==null?void 0:se.dataUrl)??(j==null?void 0:j.dataUrl)??j;if(oe)try{ne=!0;const M=Yi(oe);Je(`${n}api/admin/manager/upload_img_driver.php`,function(J){J.success?(t(2,m=m?`${m},${J.img}`:J.img),_=_?`${_},${J.img_id}`:J.img_id,t(3,b=et(m)),y=et(_)):Z("Carga fallida","Actualiza la página y vuelve a intentar. Si el problema persiste, contacta a soporte.")},{fileToUpload:M})}catch(M){console.error(M)}finally{ne=!1}}function Ae(j){Lt.call(this,l,j)}const Pe=async()=>{k?await k()&&window.open(`https://www.google.com/maps/search/?api=1&query=${o.line1}`,"_blank"):window.open(`https://www.google.com/maps/search/?api=1&query=${o.line1}`,"_blank")},Ce=async()=>{k?await k()&&window.open(`https://www.google.com/maps/search/?api=1&query=${o.line2}`,"_blank"):window.open(`https://www.google.com/maps/search/?api=1&query=${o.line2}`,"_blank")},K=async()=>{k?await k()&&window.open(`https://www.google.com/maps/search/?api=1&query=${o.line2}`,"_blank"):window.open(`https://www.google.com/maps/search/?api=1&query=${o.line2}`,"_blank")};function ee(j){He[j?"unshift":"push"](()=>{A=j,t(9,A)})}function he(j){He[j?"unshift":"push"](()=>{v=j,t(1,v)})}return[be,v,m,b,x,V,U,B,I,A,o,s,a,d,k,p,P,D,C,H,S,X,re,ue,pe,me,ve,z,G,le,Y,xe,Be,Ae,Pe,Ce,K,ee,he,j=>le(j),j=>xe(j)]}class Jt extends it{constructor(e){super(),ot(this,e,Qi,Ji,nt,{closeModal:0},null,[-1,-1,-1])}get closeModal(){return this.$$.ctx[0]}}function Yt(l,e,t){const n=l.slice();return n[32]=e[t],n[34]=t,n}function Qt(l){let e,t,n=We(l[1]),i=[];for(let o=0;o<n.length;o+=1)i[o]=Zt(Yt(l,n,o));return{c(){e=f("section"),t=f("div");for(let o=0;o<i.length;o+=1)i[o].c();this.h()},l(o){e=h(o,"SECTION",{});var s=g(e);t=h(s,"DIV",{class:!0,style:!0});var a=g(t);for(let d=0;d<i.length;d+=1)i[d].l(a);a.forEach(u),s.forEach(u),this.h()},h(){W(t,"class","image-grid"),c(t,"display","grid"),c(t,"grid-template-columns","repeat(auto-fill, minmax(100px, 1fr))"),c(t,"gap","10px"),c(t,"padding","0px 10px")},m(o,s){q(o,e,s),r(e,t);for(let a=0;a<i.length;a+=1)i[a]&&i[a].m(t,null)},p(o,s){if(s[0]&32770){n=We(o[1]);let a;for(a=0;a<n.length;a+=1){const d=Yt(o,n,a);i[a]?i[a].p(d,s):(i[a]=Zt(d),i[a].c(),i[a].m(t,null))}for(;a<i.length;a+=1)i[a].d(1);i.length=n.length}},d(o){o&&u(e),bt(i,o)}}}function Zt(l){let e,t,n,i,o,s=`<ion-icon icon="${Pt}"></ion-icon>`,a,d,k;function v(){return l[22](l[32])}function p(){return l[23](l[34])}return{c(){e=f("div"),t=f("ion-img"),i=O(),o=f("button"),o.innerHTML=s,a=O(),this.h()},l(m){e=h(m,"DIV",{class:!0,style:!0});var _=g(e);t=h(_,"ION-IMG",{src:!0,alt:!0,style:!0}),g(t).forEach(u),i=N(_),o=h(_,"BUTTON",{class:!0,style:!0,"data-svelte-h":!0}),te(o)!=="svelte-zguiov"&&(o.innerHTML=s),a=N(_),_.forEach(u),this.h()},h(){Ye(t.src,n=l[32])||E(t,"src",n),E(t,"alt","Evidencia fotográfica"),c(t,"width","100%"),c(t,"height","100px"),c(t,"object-fit","cover"),c(t,"cursor","pointer"),c(t,"border","1px solid #ccc"),c(t,"border-radius","4px"),c(t,"margin-top","16px"),W(o,"class","remove-button"),c(o,"position","absolute"),c(o,"top","5px"),c(o,"right","5px"),c(o,"border","none"),c(o,"cursor","pointer"),c(o,"font-size","18px"),c(o,"background","white"),c(o,"border-radius","50%"),c(o,"padding","3px 4px 0px"),c(o,"box-shadow","2px 2px 6px rgba(0, 0, 0, 0.3)"),c(o,"color","#0000008f"),W(e,"class","image-container"),c(e,"position","relative")},m(m,_){q(m,e,_),r(e,t),r(e,i),r(e,o),r(e,a),d||(k=[ae(t,"click",v),ae(o,"click",p)],d=!0)},p(m,_){l=m,_[0]&2&&!Ye(t.src,n=l[32])&&E(t,"src",n)},d(m){m&&u(e),d=!1,Fe(k)}}}function $t(l){let e,t='<ion-spinner name="dots" style="color:white;"></ion-spinner>';return{c(){e=f("div"),e.innerHTML=t,this.h()},l(n){e=h(n,"DIV",{class:!0,style:!0,"data-svelte-h":!0}),te(e)!=="svelte-h8s7r2"&&(e.innerHTML=t),this.h()},h(){W(e,"class","overlay"),c(e,"position","fixed"),c(e,"top","0"),c(e,"left","0"),c(e,"width","100vw"),c(e,"height","100vh"),c(e,"background","rgba(0, 0, 0, 0.5)"),c(e,"display","flex"),c(e,"align-items","center"),c(e,"justify-content","center"),c(e,"z-index","9999")},m(n,i){q(n,e,i)},d(n){n&&u(e)}}}function en(l){let e,t,n,i,o,s,a=`<ion-icon icon="${xt}"></ion-icon>`,d,k;return{c(){e=f("div"),t=f("div"),n=f("ion-img"),o=O(),s=f("button"),s.innerHTML=a,this.h()},l(v){e=h(v,"DIV",{class:!0,style:!0});var p=g(e);t=h(p,"DIV",{class:!0,style:!0});var m=g(t);n=h(m,"ION-IMG",{src:!0,alt:!0,style:!0}),g(n).forEach(u),o=N(m),s=h(m,"BUTTON",{class:!0,style:!0,"data-svelte-h":!0}),te(s)!=="svelte-g0qr0o"&&(s.innerHTML=a),m.forEach(u),p.forEach(u),this.h()},h(){Ye(n.src,i=l[8])||E(n,"src",i),E(n,"alt","Evidencia fotográfica"),c(n,"width","100%"),c(n,"height","auto"),W(s,"class","close-button"),c(s,"position","absolute"),c(s,"top","5px"),c(s,"right","5px"),c(s,"background","white"),c(s,"color","#444444d1"),c(s,"border","none"),c(s,"cursor","pointer"),c(s,"padding","2px 2px 0px 6px"),c(s,"border-radius","50%"),c(s,"font-size","20px"),W(t,"class","modal-content"),c(t,"position","relative"),c(t,"background","white"),c(t,"padding","20px"),c(t,"border-radius","8px"),c(t,"max-width","90vw"),c(t,"max-height","90vh"),c(t,"overflow","auto"),W(e,"class","modal-overlay"),c(e,"position","fixed"),c(e,"top","0"),c(e,"left","0"),c(e,"width","100vw"),c(e,"height","100vh"),c(e,"background","rgba(0, 0, 0, 0.8)"),c(e,"display","flex"),c(e,"justify-content","center"),c(e,"align-items","center"),c(e,"z-index","1000")},m(v,p){q(v,e,p),r(e,t),r(t,n),r(t,o),r(t,s),d||(k=[ae(s,"click",l[16]),ae(t,"click",Ct(l[17])),ae(e,"click",l[16])],d=!0)},p(v,p){p[0]&256&&!Ye(n.src,i=v[8])&&E(n,"src",i)},d(v){v&&u(e),d=!1,Fe(k)}}}function Zi(l){let e,t,n,i,o="Cancelar",s,a,d="REGISTRAR",k,v,p,m="Confirmar",_,b,y,w,R,P,D,x,V,U,C,H,B,I,T,A,S,X,ne='Tipo de pago <ion-text color="danger">(Obligatorio)</ion-text>',re,Ee,Z="Efectivo",L,$,ue="Tarjeta",pe,fe,ce="Transferencia",be,me,ie,ke,ye,we,ve,z,G,F,le=`<ion-icon icon="${Mt}" slot="start"></ion-icon>
                        Subir Evidencia`,Y,de,xe,Be,Ae,Pe,Ce,K,ee=l[0]&&Qt(l),he=l[6]&&$t(),ge=l[7]&&en(l);return{c(){e=f("ion-header"),t=f("ion-toolbar"),n=f("ion-buttons"),i=f("ion-button"),i.textContent=o,s=O(),a=f("ion-title"),a.textContent=d,k=O(),v=f("ion-buttons"),p=f("ion-button"),p.textContent=m,_=O(),b=f("ion-content"),y=f("ion-list"),w=f("ion-item"),R=f("ion-icon"),P=O(),D=f("ion-input"),x=O(),V=f("ion-item"),U=f("ion-icon"),C=O(),H=f("ion-input"),B=O(),I=f("ion-item"),T=f("ion-icon"),A=O(),S=f("ion-select"),X=f("div"),X.innerHTML=ne,re=O(),Ee=f("ion-select-option"),Ee.textContent=Z,L=O(),$=f("ion-select-option"),$.textContent=ue,pe=O(),fe=f("ion-select-option"),fe.textContent=ce,be=O(),me=f("ion-item"),ie=f("ion-icon"),ke=O(),ye=f("ion-textarea"),we=O(),ve=f("section"),z=f("label"),G=f("ion-button"),F=f("label"),F.innerHTML=le,Y=O(),de=f("input"),xe=O(),ee&&ee.c(),Be=O(),he&&he.c(),Ae=O(),ge&&ge.c(),Pe=Ue(),this.h()},l(Ie){e=h(Ie,"ION-HEADER",{translucent:!0});var j=g(e);t=h(j,"ION-TOOLBAR",{});var oe=g(t);n=h(oe,"ION-BUTTONS",{slot:!0});var se=g(n);i=h(se,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),te(i)!=="svelte-1f8rjcf"&&(i.textContent=o),se.forEach(u),s=N(oe),a=h(oe,"ION-TITLE",{style:!0,"data-svelte-h":!0}),te(a)!=="svelte-1t4d56m"&&(a.textContent=d),k=N(oe),v=h(oe,"ION-BUTTONS",{slot:!0});var M=g(v);p=h(M,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),te(p)!=="svelte-k5zoz0"&&(p.textContent=m),M.forEach(u),oe.forEach(u),j.forEach(u),_=N(Ie),b=h(Ie,"ION-CONTENT",{fullscreen:!0});var J=g(b);y=h(J,"ION-LIST",{});var Q=g(y);w=h(Q,"ION-ITEM",{});var _e=g(w);R=h(_e,"ION-ICON",{icon:!0,slot:!0}),g(R).forEach(u),P=N(_e),D=h(_e,"ION-INPUT",{label:!0,type:!0,placeholder:!0,value:!0}),g(D).forEach(u),_e.forEach(u),x=N(Q),V=h(Q,"ION-ITEM",{});var Le=g(V);U=h(Le,"ION-ICON",{icon:!0,slot:!0}),g(U).forEach(u),C=N(Le),H=h(Le,"ION-INPUT",{label:!0,type:!0,value:!0}),g(H).forEach(u),Le.forEach(u),B=N(Q),I=h(Q,"ION-ITEM",{});var Se=g(I);T=h(Se,"ION-ICON",{icon:!0,slot:!0}),g(T).forEach(u),A=N(Se),S=h(Se,"ION-SELECT",{placeholder:!0,value:!0});var Oe=g(S);X=h(Oe,"DIV",{slot:!0,"data-svelte-h":!0}),te(X)!=="svelte-wl764p"&&(X.innerHTML=ne),re=N(Oe),Ee=h(Oe,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),te(Ee)!=="svelte-i9crym"&&(Ee.textContent=Z),L=N(Oe),$=h(Oe,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),te($)!=="svelte-fx0z11"&&($.textContent=ue),pe=N(Oe),fe=h(Oe,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),te(fe)!=="svelte-1c24jf2"&&(fe.textContent=ce),Oe.forEach(u),Se.forEach(u),be=N(Q),me=h(Q,"ION-ITEM",{});var qe=g(me);ie=h(qe,"ION-ICON",{icon:!0,slot:!0}),g(ie).forEach(u),ke=N(qe),ye=h(qe,"ION-TEXTAREA",{label:!0,placeholder:!0}),g(ye).forEach(u),qe.forEach(u),we=N(Q),ve=h(Q,"SECTION",{});var Ke=g(ve);z=h(Ke,"LABEL",{for:!0,style:!0});var je=g(z);G=h(je,"ION-BUTTON",{fill:!0,size:!0,class:!0,expand:!0});var ze=g(G);F=h(ze,"LABEL",{for:!0,style:!0,"data-svelte-h":!0}),te(F)!=="svelte-1m9yw22"&&(F.innerHTML=le),Y=N(ze),de=h(ze,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0,capture:!0}),ze.forEach(u),je.forEach(u),Ke.forEach(u),xe=N(Q),ee&&ee.l(Q),Q.forEach(u),J.forEach(u),Be=N(Ie),he&&he.l(Ie),Ae=N(Ie),ge&&ge.l(Ie),Pe=Ue(),this.h()},h(){E(i,"color","medium"),E(n,"slot","start"),c(a,"text-align","center"),E(p,"strong",""),E(v,"slot","end"),E(e,"translucent",""),E(R,"icon",Sn),E(R,"slot","start"),E(D,"label","Concepto"),E(D,"type","text"),E(D,"placeholder","Escribe aquí..."),E(D,"value",l[9]?l[9]:""),E(U,"icon",mt),E(U,"slot","start"),E(H,"label","Monto $"),E(H,"type","number"),E(H,"value",l[10]?l[10]:""),E(T,"icon",Yn),E(T,"slot","start"),W(X,"slot","label"),E(Ee,"value","cash"),E($,"value","card"),E(fe,"value","transfer"),E(S,"placeholder","Tipo de pago"),E(S,"value",l[11]?l[11]:""),E(ie,"icon",mt),E(ie,"slot","start"),E(ye,"label","Comentarios"),E(ye,"placeholder","Escribe aquí..."),W(F,"for","eventEvidence"),c(F,"width","100%"),c(F,"padding","8px"),c(de,"display","none"),W(de,"id","eventEvidence"),W(de,"name","fileToUpload"),W(de,"type","file"),W(de,"accept","image/*"),W(de,"capture","environment"),E(G,"fill","outline"),E(G,"size","small"),E(G,"class","loadEvidence"),E(G,"expand","block"),W(z,"for","eventEvidence"),c(z,"display","block"),c(z,"width","100%"),E(b,"fullscreen","")},m(Ie,j){q(Ie,e,j),r(e,t),r(t,n),r(n,i),r(t,s),r(t,a),r(t,k),r(t,v),r(v,p),q(Ie,_,j),q(Ie,b,j),r(b,y),r(y,w),r(w,R),r(w,P),r(w,D),l[18](D),r(y,x),r(y,V),r(V,U),r(V,C),r(V,H),l[19](H),r(y,B),r(y,I),r(I,T),r(I,A),r(I,S),r(S,X),r(S,re),r(S,Ee),r(S,L),r(S,$),r(S,pe),r(S,fe),l[20](S),r(y,be),r(y,me),r(me,ie),r(me,ke),r(me,ye),l[21](ye),r(y,we),r(y,ve),r(ve,z),r(z,G),r(G,F),r(G,Y),r(G,de),r(y,xe),ee&&ee.m(y,null),q(Ie,Be,j),he&&he.m(Ie,j),q(Ie,Ae,j),ge&&ge.m(Ie,j),q(Ie,Pe,j),Ce||(K=[ae(i,"click",l[13]),ae(p,"click",l[14]),ae(de,"change",l[12])],Ce=!0)},p(Ie,j){Ie[0]?ee?ee.p(Ie,j):(ee=Qt(Ie),ee.c(),ee.m(y,null)):ee&&(ee.d(1),ee=null),Ie[6]?he||(he=$t(),he.c(),he.m(Ae.parentNode,Ae)):he&&(he.d(1),he=null),Ie[7]?ge?ge.p(Ie,j):(ge=en(Ie),ge.c(),ge.m(Pe.parentNode,Pe)):ge&&(ge.d(1),ge=null)},i:Me,o:Me,d(Ie){Ie&&(u(e),u(_),u(b),u(Be),u(Ae),u(Pe)),l[18](null),l[19](null),l[20](null),l[21](null),ee&&ee.d(),he&&he.d(Ie),ge&&ge.d(Ie),Ce=!1,Fe(K)}}}function $i(l,e,t){let n=ht,i=document.querySelector("ion-modal"),o=i.componentProps.routeId,s=i.componentProps.ex_concept,a=i.componentProps.ex_amount,d=i.componentProps.ex_type,k=i.componentProps.id_expense,v="",p=new Array,m="",_="",b=0,y="",w="",R=!1,P=new Object,D=!1,x="";rt(()=>{P=JSON.parse(localStorage.getItem("userSession"))});const V=async(L,$)=>{await(await $e.create({header:L||"Error",message:$||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()},U=async L=>{t(6,R=!0);const ue=L.target.files[0],pe=await C(ue);if(pe){var fe=new Object;fe.fileToUpload=pe,fe.id_user_over=P.id_user,fe.token=P.token;try{Je(`${n}api/admin/manager/upload_img_driver.php`,function(ce){ce.success?(t(0,v=ce.img),t(1,p=et(v)),m=ce.img_id):V("Error","No se pudo subir la imagen"),t(6,R=!1)},fe)}catch(ce){console.error("Error during file upload:",ce)}finally{t(6,R=!1)}}},C=async L=>new Promise($=>{const ue=new Image;ue.src=URL.createObjectURL(L),ue.onload=()=>{const pe=document.createElement("canvas"),fe=pe.getContext("2d"),ce=800,be=600;let me=ue.width,ie=ue.height;me>ce&&(ie*=ce/me,me=ce),ie>be&&(me*=be/ie,ie=be),pe.width=me,pe.height=ie,fe.drawImage(ue,0,0,me,ie),pe.toBlob(ke=>{$(ke),URL.revokeObjectURL(ue.src),fe.clearRect(0,0,pe.width,pe.height)},"image/jpeg",.7)}}),H=()=>{tt.dismiss()},B=()=>{var L=new Object;L.id_route=o,L.comments=y.value,L.type=_.value,L.img=v,L.img_id=m,L.amount=b.value,L.concept=w.value,L.status="done",L.id_expense=k||"null",L.id_user_over=P.id_user,L.token=P.token,!m||!v||!b.value||!w.value?V("Datos incompletos","Llena los datos requeridos para completar el registro"):Je(`${n}api/admin/expenses/add_expense.php`,function($){H()},L)},I=L=>{t(8,x=L),t(7,D=!0)},T=()=>{t(7,D=!1),t(8,x="")};function A(L){Lt.call(this,l,L)}function S(L){He[L?"unshift":"push"](()=>{w=L,t(5,w)})}function X(L){He[L?"unshift":"push"](()=>{b=L,t(3,b)})}function ne(L){He[L?"unshift":"push"](()=>{_=L,t(2,_)})}function re(L){He[L?"unshift":"push"](()=>{y=L,t(4,y)})}return[v,p,_,b,y,w,R,D,x,s,a,d,U,H,B,I,T,A,S,X,ne,re,L=>I(L),L=>removeFile(L)]}class wt extends it{constructor(e){super(),ot(this,e,$i,Zi,nt,{},null,[-1,-1])}}/*!
 * Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com
 * License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License)
 * Copyright 2025 Fonticons, Inc.
 */var eo={prefix:"fas",iconName:"ellipsis",icon:[448,512,["ellipsis-h"],"f141","M0 256a56 56 0 1 1 112 0 56 56 0 1 1 -112 0zm168 0a56 56 0 1 1 112 0 56 56 0 1 1 -112 0zm224-56a56 56 0 1 1 0 112 56 56 0 1 1 0-112z"]},to={prefix:"fas",iconName:"traffic-light",icon:[320,512,[128678],"f637","M64-32C28.7-32 0-3.3 0 32L0 384c0 88.4 71.6 160 160 160s160-71.6 160-160l0-352c0-35.3-28.7-64-64-64L64-32zm96 392c30.9 0 56 25.1 56 56s-25.1 56-56 56-56-25.1-56-56 25.1-56 56-56zm56-104a56 56 0 1 1 -112 0 56 56 0 1 1 112 0zM160 152a56 56 0 1 1 0-112 56 56 0 1 1 0 112z"]},no={prefix:"fas",iconName:"hospital",icon:[576,512,[127973,62589,"hospital-alt","hospital-wide"],"f0f8","M128 64c0-35.3 28.7-64 64-64L384 0c35.3 0 64 28.7 64 64l0 64 64 0c35.3 0 64 28.7 64 64l0 256c0 35.3-28.7 64-64 64L64 512c-35.3 0-64-28.7-64-64L0 192c0-35.3 28.7-64 64-64l64 0 0-64zM272 352c-17.7 0-32 14.3-32 32l0 80 96 0 0-80c0-17.7-14.3-32-32-32l-32 0zM128 368l0-32c0-8.8-7.2-16-16-16l-32 0c-8.8 0-16 7.2-16 16l0 32c0 8.8 7.2 16 16 16l32 0c8.8 0 16-7.2 16-16zM112 256c8.8 0 16-7.2 16-16l0-32c0-8.8-7.2-16-16-16l-32 0c-8.8 0-16 7.2-16 16l0 32c0 8.8 7.2 16 16 16l32 0zM512 368l0-32c0-8.8-7.2-16-16-16l-32 0c-8.8 0-16 7.2-16 16l0 32c0 8.8 7.2 16 16 16l32 0c8.8 0 16-7.2 16-16zM496 256c8.8 0 16-7.2 16-16l0-32c0-8.8-7.2-16-16-16l-32 0c-8.8 0-16 7.2-16 16l0 32c0 8.8 7.2 16 16 16l32 0zM264 104l0 32-32 0c-8.8 0-16 7.2-16 16l0 16c0 8.8 7.2 16 16 16l32 0 0 32c0 8.8 7.2 16 16 16l16 0c8.8 0 16-7.2 16-16l0-32 32 0c8.8 0 16-7.2 16-16l0-16c0-8.8-7.2-16-16-16l-32 0 0-32c0-8.8-7.2-16-16-16l-16 0c-8.8 0-16 7.2-16 16z"]},io={prefix:"fas",iconName:"utensils",icon:[512,512,[127860,61685,"cutlery"],"f2e7","M63.9 14.4C63.1 6.2 56.2 0 48 0s-15.1 6.2-16 14.3L17.9 149.7c-1.3 6-1.9 12.1-1.9 18.2 0 45.9 35.1 83.6 80 87.7L96 480c0 17.7 14.3 32 32 32s32-14.3 32-32l0-224.4c44.9-4.1 80-41.8 80-87.7 0-6.1-.6-12.2-1.9-18.2L223.9 14.3C223.1 6.2 216.2 0 208 0s-15.1 6.2-15.9 14.4L178.5 149.9c-.6 5.7-5.4 10.1-11.1 10.1-5.8 0-10.6-4.4-11.2-10.2L143.9 14.6C143.2 6.3 136.3 0 128 0s-15.2 6.3-15.9 14.6L99.8 149.8c-.5 5.8-5.4 10.2-11.2 10.2-5.8 0-10.6-4.4-11.1-10.1L63.9 14.4zM448 0C432 0 320 32 320 176l0 112c0 35.3 28.7 64 64 64l32 0 0 128c0 17.7 14.3 32 32 32s32-14.3 32-32l0-448c0-17.7-14.3-32-32-32z"]},oo={prefix:"fas",iconName:"gas-pump",icon:[512,512,[9981],"f52f","M32 64C32 28.7 60.7 0 96 0L256 0c35.3 0 64 28.7 64 64l0 192 8 0c48.6 0 88 39.4 88 88l0 32c0 13.3 10.7 24 24 24s24-10.7 24-24l0-154c-27.6-7.1-48-32.2-48-62l0-59.5-25.8-28.3c-8.9-9.8-8.2-25 1.6-33.9s25-8.2 33.9 1.6l71.7 78.8c9.4 10.3 14.6 23.7 14.6 37.7L512 376c0 39.8-32.2 72-72 72s-72-32.2-72-72l0-32c0-22.1-17.9-40-40-40l-8 0 0 161.4c9.3 3.3 16 12.2 16 22.6 0 13.3-10.7 24-24 24L40 512c-13.3 0-24-10.7-24-24 0-10.5 6.7-19.3 16-22.6L32 64zM96 80l0 96c0 8.8 7.2 16 16 16l128 0c8.8 0 16-7.2 16-16l0-96c0-8.8-7.2-16-16-16L112 64c-8.8 0-16 7.2-16 16z"]},lo={prefix:"fas",iconName:"restroom",icon:[640,512,[],"f7bd","M80 48a48 48 0 1 1 96 0 48 48 0 1 1 -96 0zm40 304l0 128c0 17.7-14.3 32-32 32s-32-14.3-32-32l0-154.8c-8.1 9.2-21.1 13.2-33.5 9.4-16.9-5.3-26.3-23.2-21-40.1l29.7-95.2C44.4 156.9 83.6 128 128 128s83.6 28.9 96.8 71.2l29.7 95.2c5.3 16.9-4.1 34.8-21 40.1-12.4 3.9-25.4-.2-33.5-9.4L200 480c0 17.7-14.3 32-32 32s-32-14.3-32-32l0-128-16 0zM320 0c13.3 0 24 10.7 24 24l0 464c0 13.3-10.7 24-24 24s-24-10.7-24-24l0-464c0-13.3 10.7-24 24-24zM464 48a48 48 0 1 1 96 0 48 48 0 1 1 -96 0zM440 480l0-96-17.8 0c-10.9 0-18.6-10.7-15.2-21.1l9-26.9c-3.2 0-6.4-.5-9.5-1.5-16.9-5.3-26.3-23.2-21-40.1l29.7-95.2C428.4 156.9 467.6 128 512 128s83.6 28.9 96.8 71.2l29.7 95.2c5.3 16.9-4.1 34.8-21 40.1-3.2 1-6.4 1.5-9.5 1.5l9 26.9c3.5 10.4-4.3 21.1-15.2 21.1l-17.8 0 0 96c0 17.7-14.3 32-32 32s-32-14.3-32-32l0-96-16 0 0 96c0 17.7-14.3 32-32 32s-32-14.3-32-32z"]},ro={prefix:"fas",iconName:"car-burst",icon:[640,512,["car-crash"],"f5e1","M232 16.1l0-48c0-13.3-10.7-24-24-24s-24 10.7-24 24l0 48c0 13.3 10.7 24 24 24s24-10.7 24-24zM32 168.1l48 0c13.3 0 24-10.7 24-24s-10.7-24-24-24l-48 0c-13.3 0-24 10.7-24 24s10.7 24 24 24zM281.5 70.6c9.4 9.4 24.6 9.4 33.9 0l33.9-33.9c9.4-9.4 9.4-24.6 0-33.9s-24.6-9.4-33.9 0L281.5 36.6c-9.4 9.4-9.4 24.6 0 33.9zm-181 215l33.9-33.9c9.4-9.4 9.4-24.6 0-33.9s-24.6-9.4-33.9 0L66.6 251.6c-9.4 9.4-9.4 24.6 0 33.9s24.6 9.4 33.9 0zM66.6 2.7c-9.4 9.4-9.4 24.6 0 33.9l33.9 33.9c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9L100.5 2.7C91.1-6.7 76-6.7 66.6 2.7zM352.9 175.4L505 216.2c6.4 1.7 11.1 7.3 11.8 13.9l7.2 74-231.5-62 43.2-60.5c3.9-5.4 10.7-7.9 17.2-6.2zM223.6 228.5l-2.1 2.9c-21.7 5.5-39.9 22.3-46.1 45.5-4.1 15.5-12.4 46.4-24.8 92.7l-8.3 30.9c-4.6 17.1 5.6 34.6 22.6 39.2l15.5 4.1c17.1 4.6 34.6-5.6 39.2-22.6l8.3-30.9 278.2 74.5-8.3 30.9c-4.6 17.1 5.6 34.6 22.6 39.2l15.5 4.1c17.1 4.6 34.6-5.6 39.2-22.6 4.1-15.5 12.4-46.4 24.8-92.7l8.3-30.9c6.2-23.2-1.1-46.8-17.2-62.5l-.3-3.6-10-103c-3.2-33.2-26.7-60.9-58.9-69.5L369.5 113.6c-32.2-8.6-66.4 3.6-85.8 30.8l-60.2 84.2zm48.7 57.8a32 32 0 1 1 -16.6 61.8 32 32 0 1 1 16.6-61.8zm208.1 88.9a32 32 0 1 1 61.8 16.6 32 32 0 1 1 -61.8-16.6z"]},so={prefix:"fas",iconName:"square-parking",icon:[448,512,[127359,"parking"],"f540","M64 32C28.7 32 0 60.7 0 96L0 416c0 35.3 28.7 64 64 64l320 0c35.3 0 64-28.7 64-64l0-320c0-35.3-28.7-64-64-64L64 32zM192 256l48 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-48 0 0 64zm48 64l-48 0 0 32c0 17.7-14.3 32-32 32s-32-14.3-32-32l0-184c0-22.1 17.9-40 40-40l72 0c53 0 96 43 96 96s-43 96-96 96z"]},ao={prefix:"fas",iconName:"user-secret",icon:[448,512,[128373],"f21b","M171-16c-36.4 0-57.8 58.3-68.3 112L72 96c-13.3 0-24 10.7-24 24s10.7 24 24 24l24 0 0 32c0 17 3.3 33.2 9.3 48l-9.3 0 0 0-20.5 0c-15.2 0-27.5 12.3-27.5 27.5 0 3 .5 5.9 1.4 8.7l28.9 86.6C40.2 379.6 16 428.1 16 482.3 16 498.7 29.3 512 45.7 512l356.6 0c16.4 0 29.7-13.3 29.7-29.7 0-54.2-24.2-102.7-62.3-135.4l28.9-86.6c.9-2.8 1.4-5.7 1.4-8.7 0-15.2-12.3-27.5-27.5-27.5l-20.5 0 0 0-9.3 0c6-14.8 9.3-31 9.3-48l0-32 24 0c13.3 0 24-10.7 24-24s-10.7-24-24-24l-30.7 0c-10.4-53.7-31.9-112-68.3-112-9.6 0-19 3.9-27.5 8.2-8.2 4.1-18.4 7.8-25.5 7.8s-17.3-3.7-25.5-7.8C190-12.1 180.6-16 171-16zm93.7 484.4l-24.8-70.9 27.9-32.5c2.7-3.2 4.2-7.2 4.2-11.4 0-9.7-7.8-17.5-17.5-17.5l-61 0c-9.7 0-17.5 7.8-17.5 17.5 0 4.2 1.5 8.2 4.2 11.4l27.9 32.5-24.8 70.9-57-180.4 35.7 0c18.4 10.2 39.5 16 62 16s43.6-5.8 62-16l35.7 0-57 180.4zM224 256c-34.7 0-64.2-22.1-75.3-53 5.7 3.2 12.3 5 19.3 5l12.4 0c16.5 0 31.1-10.6 36.3-26.2 2.3-7 12.2-7 14.5 0 5.2 15.6 19.9 26.2 36.3 26.2l12.4 0c7 0 13.6-1.8 19.3-5-11.1 30.9-40.6 53-75.3 53z"]};function tn(l,e,t){const n=l.slice();return n[32]=e[t],n[34]=t,n}function nn(l,e,t){const n=l.slice();return n[35]=e[t],n}function on(l){let e,t,n,i,o,s,a=l[35].label+"",d,k,v,p;function m(){return l[18](l[35])}return{c(){e=f("div"),t=f("div"),n=Bt("svg"),i=Bt("path"),o=O(),s=f("span"),d=Ne(a),k=O(),this.h()},l(_){e=h(_,"DIV",{style:!0});var b=g(e);t=h(b,"DIV",{style:!0});var y=g(t);n=Ut(y,"svg",{width:!0,height:!0,viewBox:!0,style:!0});var w=g(n);i=Ut(w,"path",{fill:!0,d:!0}),g(i).forEach(u),w.forEach(u),y.forEach(u),o=N(b),s=h(b,"SPAN",{style:!0});var R=g(s);d=Te(R,a),R.forEach(u),k=N(b),b.forEach(u),this.h()},h(){W(i,"fill","currentColor"),W(i,"d",l[35].icon.icon[4]),W(n,"width","40"),W(n,"height","20"),W(n,"viewBox","0 0 512 512"),c(n,"color","#333"),c(t,"width","42px"),c(t,"height","42px"),c(t,"border-radius","50%"),c(t,"background-color",l[35].color),c(t,"display","flex"),c(t,"align-items","center"),c(t,"justify-content","center"),c(s,"font-size","11px"),c(s,"font-weight","500"),c(s,"color","#333"),c(s,"text-align","center"),c(e,"width","calc(33.333% - 7px)"),c(e,"background","white"),c(e,"border",l[6]===l[35].id?"2px solid #3880ff":"2px solid #e0e0e0"),c(e,"border-radius","10px"),c(e,"padding","10px 6px"),c(e,"display","flex"),c(e,"flex-direction","column"),c(e,"align-items","center"),c(e,"gap","6px"),c(e,"cursor","pointer"),c(e,"box-sizing","border-box"),c(e,"box-shadow",l[6]===l[35].id?"0 2px 8px rgba(56, 128, 255, 0.2)":"none")},m(_,b){q(_,e,b),r(e,t),r(t,n),r(n,i),r(e,o),r(e,s),r(s,d),r(e,k),v||(p=ae(e,"click",m),v=!0)},p(_,b){l=_,b[0]&64&&c(e,"border",l[6]===l[35].id?"2px solid #3880ff":"2px solid #e0e0e0"),b[0]&64&&c(e,"box-shadow",l[6]===l[35].id?"0 2px 8px rgba(56, 128, 255, 0.2)":"none")},d(_){_&&u(e),v=!1,p()}}}function ln(l){let e;return{c(){e=f("div"),this.h()},l(t){e=h(t,"DIV",{id:!0,style:!0}),g(e).forEach(u),this.h()},h(){W(e,"id","motive-map"),c(e,"height","140px"),c(e,"margin","0 10px 10px 10px"),c(e,"border-radius","10px"),c(e,"box-shadow","0 2px 6px rgba(0,0,0,0.1)")},m(t,n){q(t,e,n),l[19](e)},p:Me,d(t){t&&u(e),l[19](null)}}}function rn(l){let e,t,n=We(l[1]),i=[];for(let o=0;o<n.length;o+=1)i[o]=sn(tn(l,n,o));return{c(){e=f("section"),t=f("div");for(let o=0;o<i.length;o+=1)i[o].c();this.h()},l(o){e=h(o,"SECTION",{style:!0});var s=g(e);t=h(s,"DIV",{style:!0});var a=g(t);for(let d=0;d<i.length;d+=1)i[d].l(a);a.forEach(u),s.forEach(u),this.h()},h(){c(t,"display","flex"),c(t,"flex-wrap","wrap"),c(t,"gap","8px"),c(e,"padding","0 10px")},m(o,s){q(o,e,s),r(e,t);for(let a=0;a<i.length;a+=1)i[a]&&i[a].m(t,null)},p(o,s){if(s[0]&73730){n=We(o[1]);let a;for(a=0;a<n.length;a+=1){const d=tn(o,n,a);i[a]?i[a].p(d,s):(i[a]=sn(d),i[a].c(),i[a].m(t,null))}for(;a<i.length;a+=1)i[a].d(1);i.length=n.length}},d(o){o&&u(e),bt(i,o)}}}function sn(l){let e,t,n,i,o,s=`<ion-icon icon="${Pt}"></ion-icon>`,a,d,k;function v(){return l[21](l[32])}function p(){return l[22](l[34])}return{c(){e=f("div"),t=f("ion-img"),i=O(),o=f("button"),o.innerHTML=s,a=O(),this.h()},l(m){e=h(m,"DIV",{style:!0});var _=g(e);t=h(_,"ION-IMG",{src:!0,alt:!0,style:!0}),g(t).forEach(u),i=N(_),o=h(_,"BUTTON",{style:!0,"data-svelte-h":!0}),te(o)!=="svelte-yp839i"&&(o.innerHTML=s),a=N(_),_.forEach(u),this.h()},h(){Ye(t.src,n=l[32])||E(t,"src",n),E(t,"alt","Evidencia fotográfica"),c(t,"width","100%"),c(t,"height","100%"),c(t,"object-fit","cover"),c(t,"border","1px solid #ddd"),c(t,"cursor","pointer"),c(o,"position","absolute"),c(o,"top","4px"),c(o,"right","4px"),c(o,"width","24px"),c(o,"height","24px"),c(o,"background","rgba(255,255,255,0.95)"),c(o,"border","none"),c(o,"border-radius","50%"),c(o,"display","flex"),c(o,"align-items","center"),c(o,"justify-content","center"),c(o,"color","#d13434"),c(o,"box-shadow","0 1px 4px rgba(0,0,0,0.2)"),c(o,"cursor","pointer"),c(o,"font-size","16px"),c(e,"width","calc(33.333% - 6px)"),c(e,"position","relative"),c(e,"aspect-ratio","1"),c(e,"border-radius","8px"),c(e,"overflow","hidden"),c(e,"box-sizing","border-box")},m(m,_){q(m,e,_),r(e,t),r(e,i),r(e,o),r(e,a),d||(k=[ae(t,"click",v),ae(o,"click",p)],d=!0)},p(m,_){l=m,_[0]&2&&!Ye(t.src,n=l[32])&&E(t,"src",n)},d(m){m&&u(e),d=!1,Fe(k)}}}function an(l){let e,t,n,i,o,s,a=`<ion-icon icon="${xt}"></ion-icon>`,d,k;return{c(){e=f("div"),t=f("div"),n=f("ion-img"),o=O(),s=f("button"),s.innerHTML=a,this.h()},l(v){e=h(v,"DIV",{style:!0});var p=g(e);t=h(p,"DIV",{style:!0});var m=g(t);n=h(m,"ION-IMG",{src:!0,alt:!0,style:!0}),g(n).forEach(u),o=N(m),s=h(m,"BUTTON",{style:!0,"data-svelte-h":!0}),te(s)!=="svelte-24n2ej"&&(s.innerHTML=a),m.forEach(u),p.forEach(u),this.h()},h(){Ye(n.src,i=l[5])||E(n,"src",i),E(n,"alt","Evidencia fotográfica"),c(n,"width","100%"),c(n,"height","auto"),c(s,"position","absolute"),c(s,"top","10px"),c(s,"right","10px"),c(s,"width","36px"),c(s,"height","36px"),c(s,"background","rgba(255,255,255,0.95)"),c(s,"border","none"),c(s,"border-radius","50%"),c(s,"display","flex"),c(s,"align-items","center"),c(s,"justify-content","center"),c(s,"cursor","pointer"),c(t,"position","relative"),c(t,"background","white"),c(t,"padding","20px"),c(t,"border-radius","12px"),c(t,"max-width","90vw"),c(t,"max-height","90vh"),c(e,"position","fixed"),c(e,"top","0"),c(e,"left","0"),c(e,"width","100vw"),c(e,"height","100vh"),c(e,"background","rgba(0,0,0,0.85)"),c(e,"display","flex"),c(e,"align-items","center"),c(e,"justify-content","center"),c(e,"z-index","10000")},m(v,p){q(v,e,p),r(e,t),r(t,n),r(t,o),r(t,s),d||(k=[ae(s,"click",l[14]),ae(t,"click",Ct(l[17])),ae(e,"click",l[14])],d=!0)},p(v,p){p[0]&32&&!Ye(n.src,i=v[5])&&E(n,"src",i)},d(v){v&&u(e),d=!1,Fe(k)}}}function cn(l){let e,t='<ion-spinner name="dots" style="color:white;"></ion-spinner>';return{c(){e=f("div"),e.innerHTML=t,this.h()},l(n){e=h(n,"DIV",{style:!0,"data-svelte-h":!0}),te(e)!=="svelte-1is61st"&&(e.innerHTML=t),this.h()},h(){c(e,"position","fixed"),c(e,"top","0"),c(e,"left","0"),c(e,"width","100vw"),c(e,"height","100vh"),c(e,"background","rgba(0,0,0,0.5)"),c(e,"display","flex"),c(e,"align-items","center"),c(e,"justify-content","center"),c(e,"z-index","9999")},m(n,i){q(n,e,i)},d(n){n&&u(e)}}}function co(l){let e,t,n,i,o="Cancelar",s,a,d="Agregar Incidencia",k,v,p,m="Confirmar",_,b,y,w,R="Tipo de Incidencia",P,D,x,V,U,C,H="Comentarios",B,I,T,A,S,X,ne,re,Ee=`<ion-icon icon="${Mt}" slot="start"></ion-icon>
          Subir Evidencia`,Z,L,$,ue,pe,fe,ce,be,me=We(l[9]),ie=[];for(let z=0;z<me.length;z+=1)ie[z]=on(nn(l,me,z));let ke=l[7].lat&&ln(l),ye=l[0]&&rn(l),we=l[4]&&an(l),ve=l[3]&&cn();return{c(){e=f("ion-header"),t=f("ion-toolbar"),n=f("ion-buttons"),i=f("ion-button"),i.textContent=o,s=O(),a=f("ion-title"),a.textContent=d,k=O(),v=f("ion-buttons"),p=f("ion-button"),p.textContent=m,_=O(),b=f("ion-content"),y=f("div"),w=f("h3"),w.textContent=R,P=O(),D=f("div");for(let z=0;z<ie.length;z+=1)ie[z].c();x=O(),ke&&ke.c(),V=O(),U=f("div"),C=f("h3"),C.textContent=H,B=O(),I=f("ion-item"),T=f("ion-textarea"),A=O(),S=f("section"),X=f("label"),ne=f("ion-button"),re=f("label"),re.innerHTML=Ee,Z=O(),L=f("input"),$=O(),ye&&ye.c(),ue=O(),we&&we.c(),pe=O(),ve&&ve.c(),fe=Ue(),this.h()},l(z){e=h(z,"ION-HEADER",{translucent:!0});var G=g(e);t=h(G,"ION-TOOLBAR",{});var F=g(t);n=h(F,"ION-BUTTONS",{slot:!0});var le=g(n);i=h(le,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),te(i)!=="svelte-1f8rjcf"&&(i.textContent=o),le.forEach(u),s=N(F),a=h(F,"ION-TITLE",{"data-svelte-h":!0}),te(a)!=="svelte-p6dvaq"&&(a.textContent=d),k=N(F),v=h(F,"ION-BUTTONS",{slot:!0});var Y=g(v);p=h(Y,"ION-BUTTON",{color:!0,strong:!0,"data-svelte-h":!0}),te(p)!=="svelte-1chv7eq"&&(p.textContent=m),Y.forEach(u),F.forEach(u),G.forEach(u),_=N(z),b=h(z,"ION-CONTENT",{fullscreen:!0});var de=g(b);y=h(de,"DIV",{style:!0});var xe=g(y);w=h(xe,"H3",{style:!0,"data-svelte-h":!0}),te(w)!=="svelte-fci20u"&&(w.textContent=R),P=N(xe),D=h(xe,"DIV",{style:!0});var Be=g(D);for(let he=0;he<ie.length;he+=1)ie[he].l(Be);Be.forEach(u),xe.forEach(u),x=N(de),ke&&ke.l(de),V=N(de),U=h(de,"DIV",{style:!0});var Ae=g(U);C=h(Ae,"H3",{style:!0,"data-svelte-h":!0}),te(C)!=="svelte-183y9rn"&&(C.textContent=H),B=N(Ae),I=h(Ae,"ION-ITEM",{lines:!0,style:!0});var Pe=g(I);T=h(Pe,"ION-TEXTAREA",{placeholder:!0,rows:!0}),g(T).forEach(u),Pe.forEach(u),Ae.forEach(u),A=N(de),S=h(de,"SECTION",{style:!0});var Ce=g(S);X=h(Ce,"LABEL",{for:!0,style:!0});var K=g(X);ne=h(K,"ION-BUTTON",{fill:!0,color:!0,expand:!0,style:!0});var ee=g(ne);re=h(ee,"LABEL",{for:!0,style:!0,"data-svelte-h":!0}),te(re)!=="svelte-18yehmm"&&(re.innerHTML=Ee),Z=N(ee),L=h(ee,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0,capture:!0}),ee.forEach(u),K.forEach(u),Ce.forEach(u),$=N(de),ye&&ye.l(de),de.forEach(u),ue=N(z),we&&we.l(z),pe=N(z),ve&&ve.l(z),fe=Ue(),this.h()},h(){E(i,"color","medium"),E(n,"slot","start"),E(p,"color","primary"),E(p,"strong",""),E(v,"slot","end"),E(e,"translucent",""),c(w,"margin","0 0 10px 0"),c(w,"font-size","16px"),c(w,"font-weight","600"),c(D,"display","flex"),c(D,"flex-wrap","wrap"),c(D,"gap","10px"),c(y,"padding","12px"),c(y,"background","white"),c(y,"margin","10px"),c(y,"border-radius","12px"),c(C,"margin","0 0 8px 0"),c(C,"font-size","16px"),c(C,"font-weight","600"),E(T,"placeholder","Describe la incidencia aquí..."),E(T,"rows","2"),E(I,"lines","none"),c(I,"--background","#f5f5f5"),c(I,"--border-radius","10px"),c(U,"padding","12px"),c(U,"background","white"),c(U,"margin","0 10px 10px 10px"),c(U,"border-radius","12px"),W(re,"for","eventEvidence"),c(re,"width","100%"),c(re,"padding","8px"),c(re,"cursor","pointer"),c(L,"display","none"),W(L,"id","eventEvidence"),W(L,"name","fileToUpload"),W(L,"type","file"),W(L,"accept","image/*"),W(L,"capture","environment"),E(ne,"fill","outline"),E(ne,"color","primary"),E(ne,"expand","block"),c(ne,"--border-radius","10px"),c(ne,"height","40px"),c(ne,"font-size","14px"),W(X,"for","eventEvidence"),c(X,"display","block"),c(X,"width","100%"),c(S,"padding","0 10px 10px 10px"),E(b,"fullscreen","")},m(z,G){q(z,e,G),r(e,t),r(t,n),r(n,i),r(t,s),r(t,a),r(t,k),r(t,v),r(v,p),q(z,_,G),q(z,b,G),r(b,y),r(y,w),r(y,P),r(y,D);for(let F=0;F<ie.length;F+=1)ie[F]&&ie[F].m(D,null);r(b,x),ke&&ke.m(b,null),r(b,V),r(b,U),r(U,C),r(U,B),r(U,I),r(I,T),l[20](T),r(b,A),r(b,S),r(S,X),r(X,ne),r(ne,re),r(ne,Z),r(ne,L),r(b,$),ye&&ye.m(b,null),q(z,ue,G),we&&we.m(z,G),q(z,pe,G),ve&&ve.m(z,G),q(z,fe,G),ce||(be=[ae(i,"click",l[11]),ae(p,"click",l[12]),ae(L,"change",l[10])],ce=!0)},p(z,G){if(G[0]&33344){me=We(z[9]);let F;for(F=0;F<me.length;F+=1){const le=nn(z,me,F);ie[F]?ie[F].p(le,G):(ie[F]=on(le),ie[F].c(),ie[F].m(D,null))}for(;F<ie.length;F+=1)ie[F].d(1);ie.length=me.length}z[7].lat?ke?ke.p(z,G):(ke=ln(z),ke.c(),ke.m(b,V)):ke&&(ke.d(1),ke=null),z[0]?ye?ye.p(z,G):(ye=rn(z),ye.c(),ye.m(b,null)):ye&&(ye.d(1),ye=null),z[4]?we?we.p(z,G):(we=an(z),we.c(),we.m(pe.parentNode,pe)):we&&(we.d(1),we=null),z[3]?ve||(ve=cn(),ve.c(),ve.m(fe.parentNode,fe)):ve&&(ve.d(1),ve=null)},i:Me,o:Me,d(z){z&&(u(e),u(_),u(b),u(ue),u(pe),u(fe)),bt(ie,z),ke&&ke.d(),l[20](null),ye&&ye.d(),we&&we.d(z),ve&&ve.d(z),ce=!1,Fe(be)}}}function uo(l,e,t){let n=ht,o=document.querySelector("ion-modal").componentProps.routeId,s="",a=s?et(s):new Array,d="",k=!1,v=new Object,p=!1,m="",_="",b={lat:null,lng:null},y,w,R;const P=[{id:"car_accident",icon:ro,label:"Accidente",color:"#FFE4E1"},{id:"hospital",icon:no,label:"Hospital",color:"#E1F5E1"},{id:"wc",icon:lo,label:"Baño",color:"#E1E8FF"},{id:"restaurant",icon:io,label:"Restaurant",color:"#FFE8D1"},{id:"parking",icon:so,label:"Parking",color:"#F0E1FF"},{id:"traffic",icon:to,label:"Tráfico",color:"#FFF9E1"},{id:"gas",icon:oo,label:"Gasolina",color:"#FFEAA7"},{id:"robbery",icon:ao,label:"Robo",color:"#FFD1DC"},{id:"other",icon:eo,label:"Otro",color:"#E8E8E8"}];rt(()=>{v=JSON.parse(localStorage.getItem("userSession"))});const D=async(L,$)=>{await(await $e.create({header:L||"Error",message:$||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()},x=async L=>{t(3,k=!0);try{if(a.length>=5){D("Límite de evidencias","Solo se permite subir 5 fotos por parada");return}const ue=L.target.files[0],pe=await V(ue);if(!pe){D("Error","No se pudo comprimir la imagen");return}const fe={fileToUpload:pe,id_user_over:v.id_user,token:v.token},ce=await new Promise((be,me)=>{Je(`${n}api/admin/manager/upload_img_driver.php`,ie=>be(ie),fe)});ce.success?(t(0,s=s?`${s},${ce.img}`:ce.img),t(1,a=et(s))):D("Error","No se pudo subir la imagen")}catch($){console.error("Error during file upload:",$),D("Error","Algo salió mal al subir la imagen.")}finally{t(3,k=!1)}},V=async L=>new Promise($=>{const ue=new Image;ue.src=URL.createObjectURL(L),ue.onload=()=>{const pe=document.createElement("canvas"),fe=pe.getContext("2d"),ce=800,be=600;let me=ue.width,ie=ue.height;me>ce&&(ie*=ce/me,me=ce),ie>be&&(me*=be/ie,ie=be),pe.width=me,pe.height=ie,fe.drawImage(ue,0,0,me,ie),pe.toBlob(ke=>{$(ke),URL.revokeObjectURL(ue.src),fe.clearRect(0,0,pe.width,pe.height)},"image/jpeg",.7)}}),U=()=>{tt.dismiss()},C=()=>{t(3,k=!0);var L=new Object;t(0,s=a.join(",")),L.id_route=o,L.comments=d.value,L.lat=b.lat,L.lng=b.lng,L.type=_,L.img=s,L.id_user_over=v.id_user,L.token=v.token,L.id_driver=v.id_driver,!_||!s||!L.comments||!L.img?(t(3,k=!1),D("Datos incompletos","Llena los datos requeridos para completar el registro")):!L.lat||!L.lng?(t(3,k=!1),D("Ubicación no disponible","Por favor, asegúrate de que la ubicación está activada en tu dispositivo.")):Je(`${n}api/admin/incidence/add_incidence.php`,function($){$?(t(3,k=!1),D("Éxito","Incidencia registrada correctamente")):(t(3,k=!1),D("Error","No se pudo registrar la incidencia. Por favor, inténtalo de nuevo.")),U()},L)},H=L=>{t(5,m=L),t(4,p=!0)},B=()=>{t(4,p=!1),t(5,m="")};async function I(L){t(6,_=L),t(3,k=!0),navigator.geolocation&&navigator.geolocation.getCurrentPosition(async $=>{t(7,b.lat=$.coords.latitude,b),t(7,b.lng=$.coords.longitude,b),await T()},()=>{console.log("Geolocalización denegada"),t(3,k=!1)})}async function T(){if(await Tt(),!y)return;const{Map:L}=await google.maps.importLibrary("maps"),{AdvancedMarkerElement:$}=await google.maps.importLibrary("marker");w?w.setCenter(b):w=new L(y,{zoom:15,center:b,mapId:"4504f8b37365c3d0"});const ue=P.find(be=>be.id===_);if(!ue)return;R&&R.setMap(null);const pe=document.createElement("div");pe.style.cssText=`
      display:flex;align-items:center;justify-content:center;
      width:38px;height:38px;border-radius:50%;
      background:#ffffff;border:2px solid #d13434;
      box-shadow:0 0 4px rgba(0,0,0,.3);
    `;const fe=document.createElementNS("http://www.w3.org/2000/svg","svg");fe.setAttribute("width","18"),fe.setAttribute("height","18"),fe.setAttribute("viewBox","0 0 512 512"),fe.style.cssText="color:#d13434;";const ce=document.createElementNS("http://www.w3.org/2000/svg","path");ce.setAttribute("fill","currentColor"),ce.setAttribute("d",ue.icon.icon[4]),fe.appendChild(ce),pe.appendChild(fe),R=new $({map:w,position:b,title:ue.label,content:pe}),t(3,k=!1)}function A(L=0){var $=xn(L,a,[""],s);t(1,a=$.files),t(0,s=$.selectedImages)}function S(L){Lt.call(this,l,L)}const X=L=>I(L.id);function ne(L){He[L?"unshift":"push"](()=>{y=L,t(8,y)})}function re(L){He[L?"unshift":"push"](()=>{d=L,t(2,d)})}return[s,a,d,k,p,m,_,b,y,P,x,U,C,H,B,I,A,S,X,ne,re,L=>H(L),L=>A(L)]}class fo extends it{constructor(e){super(),ot(this,e,uo,co,nt,{},null,[-1,-1])}}function un(l,e,t){const n=l.slice();return n[7]=e[t],n}function ho(l){let e,t="Cargar gasto",n,i;function o(...s){return l[4](l[7],...s)}return{c(){e=f("ion-button"),e.textContent=t,this.h()},l(s){e=h(s,"ION-BUTTON",{fill:!0,size:!0,"aria-selected":!0,"data-svelte-h":!0}),te(e)!=="svelte-175aelj"&&(e.textContent=t),this.h()},h(){E(e,"fill","outline"),E(e,"size","small"),E(e,"aria-selected","")},m(s,a){q(s,e,a),n||(i=ae(e,"click",o),n=!0)},p(s,a){l=s},d(s){s&&u(e),n=!1,i()}}}function _o(l){let e,t="Gasto completado";return{c(){e=f("ion-button"),e.textContent=t,this.h()},l(n){e=h(n,"ION-BUTTON",{fill:!0,size:!0,"aria-selected":!0,"data-svelte-h":!0}),te(e)!=="svelte-tlger7"&&(e.textContent=t),this.h()},h(){E(e,"fill","solid"),E(e,"size","small"),E(e,"aria-selected","")},m(n,i){q(n,e,i)},p:Me,d(n){n&&u(e)}}}function dn(l,e){let t,n,i,o=e[7].concept+"",s,a,d;function k(m,_){return m[7].status=="done"?_o:ho}let p=k(e)(e);return{key:l,first:null,c(){t=f("ion-item"),n=f("ion-label"),i=f("p"),s=Ne(o),a=O(),p.c(),d=O(),this.h()},l(m){t=h(m,"ION-ITEM",{});var _=g(t);n=h(_,"ION-LABEL",{style:!0});var b=g(n);i=h(b,"P",{style:!0});var y=g(i);s=Te(y,o),y.forEach(u),b.forEach(u),a=N(_),p.l(_),d=N(_),_.forEach(u),this.h()},h(){c(i,"margin-left","10px"),c(n,"display","flex"),this.first=t},m(m,_){q(m,t,_),r(t,n),r(n,i),r(i,s),r(t,a),p.m(t,null),r(t,d)},p(m,_){e=m,p.p(e,_)},d(m){m&&u(t),p.d()}}}function po(l){let e,t,n,i,o=`<ion-icon style="font-size: 25px!important;" icon="${Qn}"></ion-icon>`,s,a,d="LISTA DE GASTOS",k,v,p,m=[],_=new Map,b,y,w,R="Cerrar",P,D,x=We(l[0]);const V=U=>U[7].id_expenses;for(let U=0;U<x.length;U+=1){let C=un(l,x,U),H=V(C);_.set(H,m[U]=dn(H,C))}return{c(){e=f("ion-header"),t=f("ion-toolbar"),n=f("ion-buttons"),i=f("ion-button"),i.innerHTML=o,s=O(),a=f("ion-title"),a.textContent=d,k=O(),v=f("ion-content"),p=f("ion-list");for(let U=0;U<m.length;U+=1)m[U].c();b=O(),y=f("ion-footer"),w=f("ion-button"),w.textContent=R,this.h()},l(U){e=h(U,"ION-HEADER",{translucent:!0});var C=g(e);t=h(C,"ION-TOOLBAR",{});var H=g(t);n=h(H,"ION-BUTTONS",{slot:!0});var B=g(n);i=h(B,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),te(i)!=="svelte-160xz3i"&&(i.innerHTML=o),B.forEach(u),s=N(H),a=h(H,"ION-TITLE",{"data-svelte-h":!0}),te(a)!=="svelte-1phn90x"&&(a.textContent=d),H.forEach(u),C.forEach(u),k=N(U),v=h(U,"ION-CONTENT",{fullscreen:!0});var I=g(v);p=h(I,"ION-LIST",{});var T=g(p);for(let S=0;S<m.length;S+=1)m[S].l(T);T.forEach(u),I.forEach(u),b=N(U),y=h(U,"ION-FOOTER",{});var A=g(y);w=h(A,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),te(w)!=="svelte-zv7v83"&&(w.textContent=R),A.forEach(u),this.h()},h(){E(i,"color","medium"),E(n,"slot","end"),E(e,"translucent",""),E(v,"fullscreen",""),E(w,"fill","outline"),E(w,"color","tertiary"),E(w,"strong",""),c(w,"width","99%"),c(w,"height","auto")},m(U,C){q(U,e,C),r(e,t),r(t,n),r(n,i),r(t,s),r(t,a),q(U,k,C),q(U,v,C),r(v,p);for(let H=0;H<m.length;H+=1)m[H]&&m[H].m(p,null);q(U,b,C),q(U,y,C),r(y,w),P||(D=[ae(i,"click",l[3]),ae(w,"click",l[1])],P=!0)},p(U,[C]){C&5&&(x=We(U[0]),m=dt(m,C,V,1,U,x,_,p,ft,dn,null,un))},i:Me,o:Me,d(U){U&&(u(e),u(k),u(v),u(b),u(y));for(let C=0;C<m.length;C+=1)m[C].d();P=!1,Fe(D)}}}function mo(l){let e=document.querySelector("ion-modal");e.componentProps.routeId;let t=e.componentProps.expenses;rt(()=>{});const n=()=>{tt.dismiss()};function i(a,d,k,v,p){e.componentProps.ex_amount=k,e.componentProps.ex_concept=d,e.componentProps.ex_type=v,e.componentProps.id_expense=p,Ze("modal-expense",wt,{amount:k,concept:d,type:v,id_expense:p}).then(()=>{}),n()}return[t,n,i,a=>{Ze("modal-expense",wt,{routeId:a}).then(d=>{}),n()},(a,d)=>i(d,a.concept,a.amount,a.type,a.id_expenses)]}class vo extends it{constructor(e){super(),ot(this,e,mo,po,nt,{})}}const{document:fn}=si;function hn(l,e,t){const n=l.slice();return n[65]=e[t],n[67]=t,n}function _n(l,e,t){const n=l.slice();return n[65]=e[t],n[67]=t,n}function pn(l,e,t){const n=l.slice();return n[65]=e[t],n[67]=t,n}function mn(l){let e,t;return e=new Zn({props:{$$slots:{default:[Mo]},$$scope:{ctx:l}}}),{c(){Nn(e.$$.fragment)},l(n){Tn(e.$$.fragment,n)},m(n,i){Cn(e,n,i),t=!0},p(n,i){const o={};i[0]&14331|i[2]&256&&(o.$$scope={dirty:i,ctx:n}),e.$set(o)},i(n){t||(ut(e.$$.fragment,n),t=!0)},o(n){pt(e.$$.fragment,n),t=!1},d(n){Ln(e,n)}}}function go(l){let e,t='<div id="g_map" style="width: 100%; height: 100vh;"></div>';return{c(){e=f("ion-content"),e.innerHTML=t},l(n){e=h(n,"ION-CONTENT",{"data-svelte-h":!0}),te(e)!=="svelte-h8v4nk"&&(e.innerHTML=t)},m(n,i){q(n,e,i)},p:Me,d(n){n&&u(e)}}}function bo(l){let e,t=l[9]==="list"&&l[12]&&l[15](),n;function i(d,k){if(d[7].length>0)return Eo;if(!d[3])return ko}let o=i(l),s=o&&o(l),a=t&&wn(l);return{c(){s&&s.c(),e=O(),a&&a.c(),n=Ue()},l(d){s&&s.l(d),e=N(d),a&&a.l(d),n=Ue()},m(d,k){s&&s.m(d,k),q(d,e,k),a&&a.m(d,k),q(d,n,k)},p(d,k){o===(o=i(d))&&s?s.p(d,k):(s&&s.d(1),s=o&&o(d),s&&(s.c(),s.m(e.parentNode,e))),k[0]&4608&&(t=d[9]==="list"&&d[12]&&d[15]()),t?a?a.p(d,k):(a=wn(d),a.c(),a.m(n.parentNode,n)):a&&(a.d(1),a=null)},d(d){d&&(u(e),u(n)),s&&s.d(d),a&&a.d(d)}}}function ko(l){let e,t,n,i='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Jala para actualizar" refreshing-spinner="circles" refreshing-text="Actualizando..."></ion-refresher-content>',o,s,a,d,k,v,p="0",m,_,b,y,w,R=l[6].origin+"",P,D,x,V,U,C,H=[],B=new Map,I,T,A,S,X,ne=l[5].length+1+"",re,Ee,Z,L,$,ue,pe=l[6].destination+"",fe,ce,be,me="",ie,ke,ye,we,ve=l[4]&&vn(),z=We(l[5]);const G=F=>F[65].id_event;for(let F=0;F<z.length;F+=1){let le=hn(l,z,F),Y=G(le);B.set(Y,H[F]=bn(Y,le))}return{c(){ve&&ve.c(),e=O(),t=f("ion-content"),n=f("ion-refresher"),n.innerHTML=i,o=O(),s=f("ion-list"),a=f("ion-item"),d=f("ion-avatar"),k=f("div"),v=f("div"),v.textContent=p,_=O(),b=f("ion-label"),y=f("ion-text"),w=f("h3"),P=Ne(R),D=O(),x=f("div"),V=O(),U=f("ion-icon"),C=O();for(let F=0;F<H.length;F+=1)H[F].c();I=O(),T=f("ion-item"),A=f("ion-avatar"),S=f("div"),X=f("div"),re=Ne(ne),Z=O(),L=f("ion-label"),$=f("ion-text"),ue=f("h3"),fe=Ne(pe),ce=O(),be=f("div"),be.innerHTML=me,ie=O(),ke=f("ion-icon"),this.h()},l(F){ve&&ve.l(F),e=N(F),t=h(F,"ION-CONTENT",{});var le=g(t);n=h(le,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),te(n)!=="svelte-1mlmyg"&&(n.innerHTML=i),o=N(le),s=h(le,"ION-LIST",{});var Y=g(s);a=h(Y,"ION-ITEM",{});var de=g(a);d=h(de,"ION-AVATAR",{slot:!0});var xe=g(d);k=h(xe,"DIV",{class:!0,title:!0,style:!0});var Be=g(k);v=h(Be,"DIV",{class:!0,"data-svelte-h":!0}),te(v)!=="svelte-b78non"&&(v.textContent=p),Be.forEach(u),xe.forEach(u),_=N(de),b=h(de,"ION-LABEL",{button:!0});var Ae=g(b);y=h(Ae,"ION-TEXT",{color:!0});var Pe=g(y);w=h(Pe,"H3",{});var Ce=g(w);P=Te(Ce,R),Ce.forEach(u),Pe.forEach(u),D=N(Ae),x=h(Ae,"DIV",{class:!0}),g(x).forEach(u),Ae.forEach(u),V=N(de),U=h(de,"ION-ICON",{icon:!0,slot:!0}),g(U).forEach(u),de.forEach(u),C=N(Y);for(let se=0;se<H.length;se+=1)H[se].l(Y);I=N(Y),T=h(Y,"ION-ITEM",{});var K=g(T);A=h(K,"ION-AVATAR",{slot:!0});var ee=g(A);S=h(ee,"DIV",{class:!0,title:!0,style:!0});var he=g(S);X=h(he,"DIV",{class:!0});var ge=g(X);re=Te(ge,ne),ge.forEach(u),he.forEach(u),ee.forEach(u),Z=N(K),L=h(K,"ION-LABEL",{button:!0});var Ie=g(L);$=h(Ie,"ION-TEXT",{color:!0});var j=g($);ue=h(j,"H3",{});var oe=g(ue);fe=Te(oe,pe),oe.forEach(u),j.forEach(u),ce=N(Ie),be=h(Ie,"DIV",{class:!0,"data-svelte-h":!0}),te(be)!=="svelte-1284run"&&(be.innerHTML=me),Ie.forEach(u),ie=N(K),ke=h(K,"ION-ICON",{icon:!0,slot:!0}),g(ke).forEach(u),K.forEach(u),Y.forEach(u),le.forEach(u),this.h()},h(){E(n,"slot","fixed"),W(v,"class","order svelte-1ita8l7"),W(k,"class","order-wrapper svelte-1ita8l7"),W(k,"title",m="$"+l[6].origin),c(k,"background-color",l[6].color),c(k,"color",Re(l[6].color)),E(d,"slot","start"),E(y,"color","#2e2e2e"),W(x,"class","sub svelte-1ita8l7"),E(b,"button",""),E(U,"icon",Qe),E(U,"slot","end"),W(X,"class","order svelte-1ita8l7"),W(S,"class","order-wrapper svelte-1ita8l7"),W(S,"title",Ee="$"+l[6].destination),c(S,"background-color",l[6].color),c(S,"color",Re(l[6].color)),E(A,"slot","start"),E($,"color","#2e2e2e"),W(be,"class","sub svelte-1ita8l7"),E(L,"button",""),E(ke,"icon",Qe),E(ke,"slot","end")},m(F,le){ve&&ve.m(F,le),q(F,e,le),q(F,t,le),r(t,n),l[38](n),r(t,o),r(t,s),r(s,a),r(a,d),r(d,k),r(k,v),r(a,_),r(a,b),r(b,y),r(y,w),r(w,P),r(b,D),r(b,x),r(a,V),r(a,U),r(s,C);for(let Y=0;Y<H.length;Y+=1)H[Y]&&H[Y].m(s,null);r(s,I),r(s,T),r(T,A),r(A,S),r(S,X),r(X,re),r(T,Z),r(T,L),r(L,$),r($,ue),r(ue,fe),r(L,ce),r(L,be),r(T,ie),r(T,ke),ye||(we=[ae(n,"ionRefresh",l[14]),ae(b,"click",l[39]),ae(L,"click",l[41])],ye=!0)},p(F,le){F[4]?ve||(ve=vn(),ve.c(),ve.m(e.parentNode,e)):ve&&(ve.d(1),ve=null),le[0]&64&&m!==(m="$"+F[6].origin)&&W(k,"title",m),le[0]&64&&c(k,"background-color",F[6].color),le[0]&64&&c(k,"color",Re(F[6].color)),le[0]&64&&R!==(R=F[6].origin+"")&&De(P,R),le[0]&42206240&&(z=We(F[5]),H=dt(H,le,G,1,F,z,B,s,ft,bn,I,hn)),le[0]&32&&ne!==(ne=F[5].length+1+"")&&De(re,ne),le[0]&64&&Ee!==(Ee="$"+F[6].destination)&&W(S,"title",Ee),le[0]&64&&c(S,"background-color",F[6].color),le[0]&64&&c(S,"color",Re(F[6].color)),le[0]&64&&pe!==(pe=F[6].destination+"")&&De(fe,pe)},d(F){F&&(u(e),u(t)),ve&&ve.d(F),l[38](null);for(let le=0;le<H.length;le+=1)H[le].d();ye=!1,Fe(we)}}}function Eo(l){let e,t;function n(s,a){return a[0]&144&&(e=null),e==null&&(e=!!(s[7].filter(xo).every(Po)&&!s[4])),e?Oo:wo}let i=n(l,[-1,-1,-1]),o=i(l);return{c(){o.c(),t=Ue()},l(s){o.l(s),t=Ue()},m(s,a){o.m(s,a),q(s,t,a)},p(s,a){i===(i=n(s,a))&&o?o.p(s,a):(o.d(1),o=i(s),o&&(o.c(),o.m(t.parentNode,t)))},d(s){s&&u(t),o.d(s)}}}function vn(l){return{c:Me,l:Me,m:Me,d:Me}}function gn(l){let e;return{c(){e=f("span"),this.h()},l(t){e=h(t,"SPAN",{class:!0}),g(e).forEach(u),this.h()},h(){W(e,"class","notes svelte-1ita8l7")},m(t,n){q(t,e,n)},d(t){t&&u(e)}}}function Io(l){let e;return{c(){e=f("ion-icon"),this.h()},l(t){e=h(t,"ION-ICON",{icon:!0,slot:!0,style:!0}),g(e).forEach(u),this.h()},h(){E(e,"icon",Qe),E(e,"slot","end"),c(e,"color",Ve(l[65].status,l[65].date_service))},m(t,n){q(t,e,n)},p(t,n){n[0]&32&&c(e,"color",Ve(t[65].status,t[65].date_service))},d(t){t&&u(e)}}}function yo(l){let e,t=(l[65].tag?l[65].tag:"")+"",n;return{c(){e=f("div"),n=Ne(t),this.h()},l(i){e=h(i,"DIV",{class:!0,slot:!0,style:!0});var o=g(e);n=Te(o,t),o.forEach(u),this.h()},h(){W(e,"class","stop-tag"),W(e,"slot","end"),c(e,"background-color",Ge(l[65].tag_color,.3)),c(e,"border","1px solid "+Ge(l[65].tag_color,.4)),c(e,"color",l[65].tag_color),c(e,"font-size","10px"),c(e,"text-align","center"),c(e,"align-content","center"),c(e,"border-radius","20px"),c(e,"white-space","normal"),c(e,"padding","3px 6px"),c(e,"width","auto",1),c(e,"display","inline-block"),c(e,"font-weight","500")},m(i,o){q(i,e,o),r(e,n)},p(i,o){o[0]&32&&t!==(t=(i[65].tag?i[65].tag:"")+"")&&De(n,t),o[0]&32&&c(e,"background-color",Ge(i[65].tag_color,.3)),o[0]&32&&c(e,"border","1px solid "+Ge(i[65].tag_color,.4)),o[0]&32&&c(e,"color",i[65].tag_color)},d(i){i&&u(e)}}}function bn(l,e){let t,n,i,o,s=parseInt(e[65].pos)+1+"",a,d,k,v,p,m,_=e[65].title+"",b,y,w=e[65].support_list&&e[65].support_list.length||e[23](e[65]),R,P,D,x=w&&gn();function V(){return e[40](e[65])}function U(B,I){return B[65].tag_color&&B[65].tag?yo:Io}let C=U(e),H=C(e);return{key:l,first:null,c(){t=f("ion-item"),n=f("ion-avatar"),i=f("div"),o=f("div"),a=Ne(s),k=O(),v=f("ion-label"),p=f("ion-text"),m=f("h3"),b=Ne(_),y=O(),x&&x.c(),R=O(),H.c(),this.h()},l(B){t=h(B,"ION-ITEM",{});var I=g(t);n=h(I,"ION-AVATAR",{slot:!0});var T=g(n);i=h(T,"DIV",{class:!0,title:!0,style:!0});var A=g(i);o=h(A,"DIV",{class:!0});var S=g(o);a=Te(S,s),S.forEach(u),A.forEach(u),T.forEach(u),k=N(I),v=h(I,"ION-LABEL",{button:!0});var X=g(v);p=h(X,"ION-TEXT",{color:!0});var ne=g(p);m=h(ne,"H3",{});var re=g(m);b=Te(re,_),y=N(re),x&&x.l(re),re.forEach(u),ne.forEach(u),X.forEach(u),R=N(I),H.l(I),I.forEach(u),this.h()},h(){W(o,"class","order svelte-1ita8l7"),W(i,"class","order-wrapper svelte-1ita8l7"),W(i,"title",d=at(e[65].status)),c(i,"background-color",Ve(e[65].status,e[65].date_service)),c(i,"color",Re(Ve(e[65].status))),E(n,"slot","start"),E(p,"color","#2e2e2e"),E(v,"button",""),this.first=t},m(B,I){q(B,t,I),r(t,n),r(n,i),r(i,o),r(o,a),r(t,k),r(t,v),r(v,p),r(p,m),r(m,b),r(m,y),x&&x.m(m,null),r(t,R),H.m(t,null),P||(D=ae(v,"click",V),P=!0)},p(B,I){e=B,I[0]&32&&s!==(s=parseInt(e[65].pos)+1+"")&&De(a,s),I[0]&32&&d!==(d=at(e[65].status))&&W(i,"title",d),I[0]&32&&c(i,"background-color",Ve(e[65].status,e[65].date_service)),I[0]&32&&c(i,"color",Re(Ve(e[65].status))),I[0]&32&&_!==(_=e[65].title+"")&&De(b,_),I[0]&32&&(w=e[65].support_list&&e[65].support_list.length||e[23](e[65])),w?x||(x=gn(),x.c(),x.m(m,null)):x&&(x.d(1),x=null),C===(C=U(e))&&H?H.p(e,I):(H.d(1),H=C(e),H&&(H.c(),H.m(t,null)))},d(B){B&&u(t),x&&x.d(),H.d(),P=!1,D()}}}function wo(l){let e,t,n='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Pull to refresh" refreshing-spinner="circles" refreshing-text="Refreshing..."></ion-refresher-content>',i,o,s,a,d,k,v="0",p,m,_,b,y,w=l[6].origin+"",R,P,D,x,V,U,C=[],H=new Map,B,I,T,A,S,X=l[5].length+1+"",ne,re,Ee,Z,L,$,ue=l[6].destination+"",pe,fe,ce,be="",me,ie,ke,ye,we=We(l[5]);const ve=z=>z[65].id_event;for(let z=0;z<we.length;z+=1){let G=_n(l,we,z),F=ve(G);H.set(F,C[z]=En(F,G))}return{c(){e=f("ion-content"),t=f("ion-refresher"),t.innerHTML=n,i=O(),o=f("ion-list"),s=f("ion-item"),a=f("ion-avatar"),d=f("div"),k=f("div"),k.textContent=v,m=O(),_=f("ion-label"),b=f("ion-text"),y=f("h3"),R=Ne(w),P=O(),D=f("div"),x=O(),V=f("ion-icon"),U=O();for(let z=0;z<C.length;z+=1)C[z].c();B=O(),I=f("ion-item"),T=f("ion-avatar"),A=f("div"),S=f("div"),ne=Ne(X),Ee=O(),Z=f("ion-label"),L=f("ion-text"),$=f("h3"),pe=Ne(ue),fe=O(),ce=f("div"),ce.innerHTML=be,me=O(),ie=f("ion-icon"),this.h()},l(z){e=h(z,"ION-CONTENT",{});var G=g(e);t=h(G,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),te(t)!=="svelte-1l8nqqz"&&(t.innerHTML=n),i=N(G),o=h(G,"ION-LIST",{});var F=g(o);s=h(F,"ION-ITEM",{});var le=g(s);a=h(le,"ION-AVATAR",{slot:!0});var Y=g(a);d=h(Y,"DIV",{class:!0,title:!0,style:!0});var de=g(d);k=h(de,"DIV",{class:!0,"data-svelte-h":!0}),te(k)!=="svelte-b78non"&&(k.textContent=v),de.forEach(u),Y.forEach(u),m=N(le),_=h(le,"ION-LABEL",{button:!0});var xe=g(_);b=h(xe,"ION-TEXT",{color:!0});var Be=g(b);y=h(Be,"H3",{});var Ae=g(y);R=Te(Ae,w),Ae.forEach(u),Be.forEach(u),P=N(xe),D=h(xe,"DIV",{class:!0}),g(D).forEach(u),xe.forEach(u),x=N(le),V=h(le,"ION-ICON",{icon:!0,slot:!0}),g(V).forEach(u),le.forEach(u),U=N(F);for(let j=0;j<C.length;j+=1)C[j].l(F);B=N(F),I=h(F,"ION-ITEM",{});var Pe=g(I);T=h(Pe,"ION-AVATAR",{slot:!0});var Ce=g(T);A=h(Ce,"DIV",{class:!0,title:!0,style:!0});var K=g(A);S=h(K,"DIV",{class:!0});var ee=g(S);ne=Te(ee,X),ee.forEach(u),K.forEach(u),Ce.forEach(u),Ee=N(Pe),Z=h(Pe,"ION-LABEL",{button:!0});var he=g(Z);L=h(he,"ION-TEXT",{color:!0});var ge=g(L);$=h(ge,"H3",{});var Ie=g($);pe=Te(Ie,ue),Ie.forEach(u),ge.forEach(u),fe=N(he),ce=h(he,"DIV",{class:!0,"data-svelte-h":!0}),te(ce)!=="svelte-1uxrbi7"&&(ce.innerHTML=be),he.forEach(u),me=N(Pe),ie=h(Pe,"ION-ICON",{icon:!0,slot:!0}),g(ie).forEach(u),Pe.forEach(u),F.forEach(u),G.forEach(u),this.h()},h(){E(t,"slot","fixed"),W(k,"class","order svelte-1ita8l7"),W(d,"class","order-wrapper svelte-1ita8l7"),W(d,"title",p="$"+l[6].origin),c(d,"background-color",l[6].color),c(d,"color",Re(l[6].color)),E(a,"slot","start"),E(b,"color","#2e2e2e"),W(D,"class","sub svelte-1ita8l7"),E(_,"button",""),E(V,"icon",Qe),E(V,"slot","end"),W(S,"class","order svelte-1ita8l7"),W(A,"class","order-wrapper svelte-1ita8l7"),W(A,"title",re="$"+l[6].destination),c(A,"background-color",l[6].color),c(A,"color",Re(l[6].color)),E(T,"slot","start"),E(L,"color","#2e2e2e"),W(ce,"class","sub svelte-1ita8l7"),E(Z,"button",""),E(ie,"icon",Qe),E(ie,"slot","end")},m(z,G){q(z,e,G),r(e,t),l[34](t),r(e,i),r(e,o),r(o,s),r(s,a),r(a,d),r(d,k),r(s,m),r(s,_),r(_,b),r(b,y),r(y,R),r(_,P),r(_,D),r(s,x),r(s,V),r(o,U);for(let F=0;F<C.length;F+=1)C[F]&&C[F].m(o,null);r(o,B),r(o,I),r(I,T),r(T,A),r(A,S),r(S,ne),r(I,Ee),r(I,Z),r(Z,L),r(L,$),r($,pe),r(Z,fe),r(Z,ce),r(I,me),r(I,ie),ke||(ye=[ae(t,"ionRefresh",l[14]),ae(_,"click",l[35]),ae(Z,"click",l[37])],ke=!0)},p(z,G){G[0]&64&&p!==(p="$"+z[6].origin)&&W(d,"title",p),G[0]&64&&c(d,"background-color",z[6].color),G[0]&64&&c(d,"color",Re(z[6].color)),G[0]&64&&w!==(w=z[6].origin+"")&&De(R,w),G[0]&42271776&&(we=We(z[5]),C=dt(C,G,ve,1,z,we,H,o,ft,En,B,_n)),G[0]&32&&X!==(X=z[5].length+1+"")&&De(ne,X),G[0]&64&&re!==(re="$"+z[6].destination)&&W(A,"title",re),G[0]&64&&c(A,"background-color",z[6].color),G[0]&64&&c(A,"color",Re(z[6].color)),G[0]&64&&ue!==(ue=z[6].destination+"")&&De(pe,ue)},d(z){z&&u(e),l[34](null);for(let G=0;G<C.length;G+=1)C[G].d();ke=!1,Fe(ye)}}}function Oo(l){let e,t,n='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Jale para actualizar" refreshing-spinner="circles" refreshing-text="Actualizando..."></ion-refresher-content>',i,o,s,a,d,k,v="0",p,m,_,b,y,w=l[6].origin+"",R,P,D,x,V,U,C=[],H=new Map,B,I,T,A,S,X=l[5].length+1+"",ne,re,Ee,Z,L,$,ue=l[6].destination+"",pe,fe,ce,be="",me,ie,ke,ye,we=We(l[5]);const ve=z=>z[65].id_event;for(let z=0;z<we.length;z+=1){let G=pn(l,we,z),F=ve(G);H.set(F,C[z]=yn(F,G))}return{c(){e=f("ion-content"),t=f("ion-refresher"),t.innerHTML=n,i=O(),o=f("ion-list"),s=f("ion-item"),a=f("ion-avatar"),d=f("div"),k=f("div"),k.textContent=v,m=O(),_=f("ion-label"),b=f("ion-text"),y=f("h3"),R=Ne(w),P=O(),D=f("div"),x=O(),V=f("ion-icon"),U=O();for(let z=0;z<C.length;z+=1)C[z].c();B=O(),I=f("ion-item"),T=f("ion-avatar"),A=f("div"),S=f("div"),ne=Ne(X),Ee=O(),Z=f("ion-label"),L=f("ion-text"),$=f("h3"),pe=Ne(ue),fe=O(),ce=f("div"),ce.innerHTML=be,me=O(),ie=f("ion-icon"),this.h()},l(z){e=h(z,"ION-CONTENT",{});var G=g(e);t=h(G,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),te(t)!=="svelte-vjbhg4"&&(t.innerHTML=n),i=N(G),o=h(G,"ION-LIST",{});var F=g(o);s=h(F,"ION-ITEM",{});var le=g(s);a=h(le,"ION-AVATAR",{slot:!0});var Y=g(a);d=h(Y,"DIV",{class:!0,title:!0,style:!0});var de=g(d);k=h(de,"DIV",{class:!0,"data-svelte-h":!0}),te(k)!=="svelte-b78non"&&(k.textContent=v),de.forEach(u),Y.forEach(u),m=N(le),_=h(le,"ION-LABEL",{button:!0});var xe=g(_);b=h(xe,"ION-TEXT",{color:!0});var Be=g(b);y=h(Be,"H3",{});var Ae=g(y);R=Te(Ae,w),Ae.forEach(u),Be.forEach(u),P=N(xe),D=h(xe,"DIV",{class:!0}),g(D).forEach(u),xe.forEach(u),x=N(le),V=h(le,"ION-ICON",{icon:!0,slot:!0}),g(V).forEach(u),le.forEach(u),U=N(F);for(let j=0;j<C.length;j+=1)C[j].l(F);B=N(F),I=h(F,"ION-ITEM",{});var Pe=g(I);T=h(Pe,"ION-AVATAR",{slot:!0});var Ce=g(T);A=h(Ce,"DIV",{class:!0,title:!0,style:!0});var K=g(A);S=h(K,"DIV",{class:!0});var ee=g(S);ne=Te(ee,X),ee.forEach(u),K.forEach(u),Ce.forEach(u),Ee=N(Pe),Z=h(Pe,"ION-LABEL",{button:!0});var he=g(Z);L=h(he,"ION-TEXT",{color:!0});var ge=g(L);$=h(ge,"H3",{});var Ie=g($);pe=Te(Ie,ue),Ie.forEach(u),ge.forEach(u),fe=N(he),ce=h(he,"DIV",{class:!0,"data-svelte-h":!0}),te(ce)!=="svelte-1uxrbi7"&&(ce.innerHTML=be),he.forEach(u),me=N(Pe),ie=h(Pe,"ION-ICON",{icon:!0,slot:!0}),g(ie).forEach(u),Pe.forEach(u),F.forEach(u),G.forEach(u),this.h()},h(){E(t,"slot","fixed"),W(k,"class","order svelte-1ita8l7"),W(d,"class","order-wrapper svelte-1ita8l7"),W(d,"title",p="$"+l[6].origin),c(d,"background-color",l[6].color),c(d,"color",Re(l[6].color)),E(a,"slot","start"),E(b,"color","#2e2e2e"),W(D,"class","sub svelte-1ita8l7"),E(_,"button",""),E(V,"icon",Qe),E(V,"slot","end"),W(S,"class","order svelte-1ita8l7"),W(A,"class","order-wrapper svelte-1ita8l7"),W(A,"title",re="$"+l[6].destination),c(A,"background-color",l[6].color),c(A,"color",Re(l[6].color)),E(T,"slot","start"),E(L,"color","#2e2e2e"),W(ce,"class","sub svelte-1ita8l7"),E(Z,"button",""),E(ie,"icon",Qe),E(ie,"slot","end")},m(z,G){q(z,e,G),r(e,t),l[30](t),r(e,i),r(e,o),r(o,s),r(s,a),r(a,d),r(d,k),r(s,m),r(s,_),r(_,b),r(b,y),r(y,R),r(_,P),r(_,D),r(s,x),r(s,V),r(o,U);for(let F=0;F<C.length;F+=1)C[F]&&C[F].m(o,null);r(o,B),r(o,I),r(I,T),r(T,A),r(A,S),r(S,ne),r(I,Ee),r(I,Z),r(Z,L),r(L,$),r($,pe),r(Z,fe),r(Z,ce),r(I,me),r(I,ie),ke||(ye=[ae(t,"ionRefresh",l[14]),ae(_,"click",l[31]),ae(Z,"click",l[33])],ke=!0)},p(z,G){G[0]&64&&p!==(p="$"+z[6].origin)&&W(d,"title",p),G[0]&64&&c(d,"background-color",z[6].color),G[0]&64&&c(d,"color",Re(z[6].color)),G[0]&64&&w!==(w=z[6].origin+"")&&De(R,w),G[0]&42271776&&(we=We(z[5]),C=dt(C,G,ve,1,z,we,H,o,ft,yn,B,pn)),G[0]&32&&X!==(X=z[5].length+1+"")&&De(ne,X),G[0]&64&&re!==(re="$"+z[6].destination)&&W(A,"title",re),G[0]&64&&c(A,"background-color",z[6].color),G[0]&64&&c(A,"color",Re(z[6].color)),G[0]&64&&ue!==(ue=z[6].destination+"")&&De(pe,ue)},d(z){z&&u(e),l[30](null);for(let G=0;G<C.length;G+=1)C[G].d();ke=!1,Fe(ye)}}}function kn(l){let e;return{c(){e=f("span"),this.h()},l(t){e=h(t,"SPAN",{class:!0}),g(e).forEach(u),this.h()},h(){W(e,"class","notes svelte-1ita8l7")},m(t,n){q(t,e,n)},d(t){t&&u(e)}}}function No(l){let e;return{c(){e=f("ion-icon"),this.h()},l(t){e=h(t,"ION-ICON",{icon:!0,slot:!0,style:!0}),g(e).forEach(u),this.h()},h(){E(e,"icon",Qe),E(e,"slot","end"),c(e,"color",Ve(l[65].status,l[65].date_service))},m(t,n){q(t,e,n)},p(t,n){n[0]&32&&c(e,"color",Ve(t[65].status,t[65].date_service))},d(t){t&&u(e)}}}function To(l){let e,t=(l[65].tag?l[65].tag:"")+"",n;return{c(){e=f("div"),n=Ne(t),this.h()},l(i){e=h(i,"DIV",{class:!0,slot:!0,style:!0});var o=g(e);n=Te(o,t),o.forEach(u),this.h()},h(){W(e,"class","stop-tag"),W(e,"slot","end"),c(e,"background-color",Ge(l[65].tag_color,.3)),c(e,"border","1px solid "+Ge(l[65].tag_color,.4)),c(e,"color",l[65].tag_color),c(e,"font-size","10px"),c(e,"text-align","center"),c(e,"align-content","center"),c(e,"border-radius","20px"),c(e,"white-space","normal"),c(e,"padding","3px 6px"),c(e,"width","auto",1),c(e,"display","inline-block"),c(e,"font-weight","500")},m(i,o){q(i,e,o),r(e,n)},p(i,o){o[0]&32&&t!==(t=(i[65].tag?i[65].tag:"")+"")&&De(n,t),o[0]&32&&c(e,"background-color",Ge(i[65].tag_color,.3)),o[0]&32&&c(e,"border","1px solid "+Ge(i[65].tag_color,.4)),o[0]&32&&c(e,"color",i[65].tag_color)},d(i){i&&u(e)}}}function En(l,e){let t,n,i,o,s=parseInt(e[65].pos)+1+"",a,d,k,v,p,m,_=e[65].title+"",b,y,w=e[65].support_list&&e[65].support_list.length||e[23](e[65]),R,P,D="",x,V,U,C=w&&kn();function H(){return e[36](e[65])}function B(A,S){return A[65].tag_color&&A[65].tag?To:No}let I=B(e),T=I(e);return{key:l,first:null,c(){t=f("ion-item"),n=f("ion-avatar"),i=f("div"),o=f("div"),a=Ne(s),k=O(),v=f("ion-label"),p=f("ion-text"),m=f("h3"),b=Ne(_),y=O(),C&&C.c(),R=O(),P=f("div"),P.innerHTML=D,x=O(),T.c(),this.h()},l(A){t=h(A,"ION-ITEM",{});var S=g(t);n=h(S,"ION-AVATAR",{slot:!0});var X=g(n);i=h(X,"DIV",{class:!0,title:!0,style:!0});var ne=g(i);o=h(ne,"DIV",{class:!0});var re=g(o);a=Te(re,s),re.forEach(u),ne.forEach(u),X.forEach(u),k=N(S),v=h(S,"ION-LABEL",{button:!0});var Ee=g(v);p=h(Ee,"ION-TEXT",{color:!0});var Z=g(p);m=h(Z,"H3",{});var L=g(m);b=Te(L,_),y=N(L),C&&C.l(L),L.forEach(u),Z.forEach(u),R=N(Ee),P=h(Ee,"DIV",{class:!0,"data-svelte-h":!0}),te(P)!=="svelte-4k5p1b"&&(P.innerHTML=D),Ee.forEach(u),x=N(S),T.l(S),S.forEach(u),this.h()},h(){W(o,"class","order svelte-1ita8l7"),W(i,"class","order-wrapper svelte-1ita8l7"),W(i,"title",d=at(e[65].status)),c(i,"background-color",Ve(e[65].status,e[65].date_service)),c(i,"color",Re(Ve(e[65].status))),E(n,"slot","start"),E(p,"color","#2e2e2e"),W(P,"class","sub svelte-1ita8l7"),E(v,"button",""),this.first=t},m(A,S){q(A,t,S),r(t,n),r(n,i),r(i,o),r(o,a),r(t,k),r(t,v),r(v,p),r(p,m),r(m,b),r(m,y),C&&C.m(m,null),r(v,R),r(v,P),r(t,x),T.m(t,null),V||(U=ae(v,"click",H),V=!0)},p(A,S){e=A,S[0]&32&&s!==(s=parseInt(e[65].pos)+1+"")&&De(a,s),S[0]&32&&d!==(d=at(e[65].status))&&W(i,"title",d),S[0]&32&&c(i,"background-color",Ve(e[65].status,e[65].date_service)),S[0]&32&&c(i,"color",Re(Ve(e[65].status))),S[0]&32&&_!==(_=e[65].title+"")&&De(b,_),S[0]&32&&(w=e[65].support_list&&e[65].support_list.length||e[23](e[65])),w?C||(C=kn(),C.c(),C.m(m,null)):C&&(C.d(1),C=null),I===(I=B(e))&&T?T.p(e,S):(T.d(1),T=I(e),T&&(T.c(),T.m(t,null)))},d(A){A&&u(t),C&&C.d(),T.d(),V=!1,U()}}}function In(l){let e;return{c(){e=f("span"),this.h()},l(t){e=h(t,"SPAN",{class:!0}),g(e).forEach(u),this.h()},h(){W(e,"class","notes svelte-1ita8l7")},m(t,n){q(t,e,n)},d(t){t&&u(e)}}}function Co(l){let e;return{c(){e=f("ion-icon"),this.h()},l(t){e=h(t,"ION-ICON",{icon:!0,slot:!0,style:!0}),g(e).forEach(u),this.h()},h(){E(e,"icon",Qe),E(e,"slot","end"),c(e,"color",Ve(l[65].status,l[65].date_service))},m(t,n){q(t,e,n)},p(t,n){n[0]&32&&c(e,"color",Ve(t[65].status,t[65].date_service))},d(t){t&&u(e)}}}function Lo(l){let e,t=(l[65].tag?l[65].tag:"")+"",n;return{c(){e=f("div"),n=Ne(t),this.h()},l(i){e=h(i,"DIV",{class:!0,slot:!0,style:!0});var o=g(e);n=Te(o,t),o.forEach(u),this.h()},h(){W(e,"class","stop-tag"),W(e,"slot","end"),c(e,"background-color",Ge(l[65].tag_color,.3)),c(e,"border","1px solid "+Ge(l[65].tag_color,.4)),c(e,"color",l[65].tag_color),c(e,"font-size","10px"),c(e,"text-align","center"),c(e,"align-content","center"),c(e,"border-radius","20px"),c(e,"white-space","normal"),c(e,"padding","3px 6px"),c(e,"width","auto",1),c(e,"display","inline-block"),c(e,"font-weight","500")},m(i,o){q(i,e,o),r(e,n)},p(i,o){o[0]&32&&t!==(t=(i[65].tag?i[65].tag:"")+"")&&De(n,t),o[0]&32&&c(e,"background-color",Ge(i[65].tag_color,.3)),o[0]&32&&c(e,"border","1px solid "+Ge(i[65].tag_color,.4)),o[0]&32&&c(e,"color",i[65].tag_color)},d(i){i&&u(e)}}}function yn(l,e){let t,n,i,o,s=parseInt(e[65].pos)+1+"",a,d,k,v,p,m,_=e[65].title+"",b,y,w=e[65].support_list&&e[65].support_list.length||e[23](e[65]),R,P,D="",x,V,U,C=w&&In();function H(){return e[32](e[65])}function B(A,S){return A[65].tag_color&&A[65].tag?Lo:Co}let I=B(e),T=I(e);return{key:l,first:null,c(){t=f("ion-item"),n=f("ion-avatar"),i=f("div"),o=f("div"),a=Ne(s),k=O(),v=f("ion-label"),p=f("ion-text"),m=f("h3"),b=Ne(_),y=O(),C&&C.c(),R=O(),P=f("div"),P.innerHTML=D,x=O(),T.c(),this.h()},l(A){t=h(A,"ION-ITEM",{});var S=g(t);n=h(S,"ION-AVATAR",{slot:!0});var X=g(n);i=h(X,"DIV",{class:!0,title:!0,style:!0});var ne=g(i);o=h(ne,"DIV",{class:!0});var re=g(o);a=Te(re,s),re.forEach(u),ne.forEach(u),X.forEach(u),k=N(S),v=h(S,"ION-LABEL",{button:!0});var Ee=g(v);p=h(Ee,"ION-TEXT",{color:!0});var Z=g(p);m=h(Z,"H3",{});var L=g(m);b=Te(L,_),y=N(L),C&&C.l(L),L.forEach(u),Z.forEach(u),R=N(Ee),P=h(Ee,"DIV",{class:!0,"data-svelte-h":!0}),te(P)!=="svelte-4k5p1b"&&(P.innerHTML=D),Ee.forEach(u),x=N(S),T.l(S),S.forEach(u),this.h()},h(){W(o,"class","order svelte-1ita8l7"),W(i,"class","order-wrapper svelte-1ita8l7"),W(i,"title",d=at(e[65].status)),c(i,"background-color",Ve(e[65].status,e[65].date_service)),c(i,"color",Re(Ve(e[65].status))),E(n,"slot","start"),E(p,"color","#2e2e2e"),W(P,"class","sub svelte-1ita8l7"),E(v,"button",""),this.first=t},m(A,S){q(A,t,S),r(t,n),r(n,i),r(i,o),r(o,a),r(t,k),r(t,v),r(v,p),r(p,m),r(m,b),r(m,y),C&&C.m(m,null),r(v,R),r(v,P),r(t,x),T.m(t,null),V||(U=ae(v,"click",H),V=!0)},p(A,S){e=A,S[0]&32&&s!==(s=parseInt(e[65].pos)+1+"")&&De(a,s),S[0]&32&&d!==(d=at(e[65].status))&&W(i,"title",d),S[0]&32&&c(i,"background-color",Ve(e[65].status,e[65].date_service)),S[0]&32&&c(i,"color",Re(Ve(e[65].status))),S[0]&32&&_!==(_=e[65].title+"")&&De(b,_),S[0]&32&&(w=e[65].support_list&&e[65].support_list.length||e[23](e[65])),w?C||(C=In(),C.c(),C.m(m,null)):C&&(C.d(1),C=null),I===(I=B(e))&&T?T.p(e,S):(T.d(1),T=I(e),T&&(T.c(),T.m(t,null)))},d(A){A&&u(t),C&&C.d(),T.d(),V=!1,U()}}}function wn(l){let e,t,n,i=l[13]?"Ruta iniciada ✓":"Iniciar ruta",o,s,a,d;return{c(){e=f("ion-footer"),t=f("ion-toolbar"),n=f("ion-button"),o=Ne(i),this.h()},l(k){e=h(k,"ION-FOOTER",{});var v=g(e);t=h(v,"ION-TOOLBAR",{});var p=g(t);n=h(p,"ION-BUTTON",{expand:!0,size:!0,color:!0,style:!0});var m=g(n);o=Te(m,i),m.forEach(u),p.forEach(u),v.forEach(u),this.h()},h(){E(n,"expand","block"),E(n,"size","large"),E(n,"color",s=l[13]?"success":"primary"),c(n,"margin","8px")},m(k,v){q(k,e,v),r(e,t),r(t,n),r(n,o),a||(d=ae(n,"click",l[42]),a=!0)},p(k,v){v[0]&8192&&i!==(i=k[13]?"Ruta iniciada ✓":"Iniciar ruta")&&De(o,i),v[0]&8192&&s!==(s=k[13]?"success":"primary")&&E(n,"color",s)},d(k){k&&u(e),a=!1,d()}}}function Mo(l){let e,t,n,i,o=`<ion-icon icon="${$n}"></ion-icon>`,s,a,d,k=`<ion-icon icon="${ei}"></ion-icon>`,v,p,m=`<ion-icon icon="${ti}"></ion-icon>`,_,b,y=(l[6].name?l[6].name.toUpperCase():"")+"",w,R,P,D='<ion-segment-button value="list"><ion-label>Paradas</ion-label></ion-segment-button> <ion-segment-button value="map"><ion-label>Mapa</ion-label></ion-segment-button>',x,V,U,C;function H(T,A){if(T[9]==="list")return bo;if(T[9]==="map")return go}let B=H(l),I=B&&B(l);return{c(){e=f("ion-header"),t=f("ion-toolbar"),n=f("ion-buttons"),i=f("ion-button"),i.innerHTML=o,s=O(),a=f("ion-buttons"),d=f("ion-button"),d.innerHTML=k,v=O(),p=f("ion-button"),p.innerHTML=m,_=O(),b=f("ion-title"),w=Ne(y),R=O(),P=f("ion-segment"),P.innerHTML=D,x=O(),I&&I.c(),V=Ue(),this.h()},l(T){e=h(T,"ION-HEADER",{translucent:!0});var A=g(e);t=h(A,"ION-TOOLBAR",{});var S=g(t);n=h(S,"ION-BUTTONS",{slot:!0});var X=g(n);i=h(X,"ION-BUTTON",{title:!0,alt:!0,"data-svelte-h":!0}),te(i)!=="svelte-1a21unf"&&(i.innerHTML=o),X.forEach(u),s=N(S),a=h(S,"ION-BUTTONS",{slot:!0});var ne=g(a);d=h(ne,"ION-BUTTON",{"data-svelte-h":!0}),te(d)!=="svelte-b5yj9f"&&(d.innerHTML=k),v=N(ne),p=h(ne,"ION-BUTTON",{"data-svelte-h":!0}),te(p)!=="svelte-11mnzbg"&&(p.innerHTML=m),ne.forEach(u),_=N(S),b=h(S,"ION-TITLE",{});var re=g(b);w=Te(re,y),re.forEach(u),S.forEach(u),R=N(A),P=h(A,"ION-SEGMENT",{value:!0,"data-svelte-h":!0}),te(P)!=="svelte-1rseadq"&&(P.innerHTML=D),A.forEach(u),x=N(T),I&&I.l(T),V=Ue(),this.h()},h(){E(i,"title","Atrás"),E(i,"alt","Atrás"),E(n,"slot","start"),E(a,"slot","end"),E(P,"value","list"),E(e,"translucent","")},m(T,A){q(T,e,A),r(e,t),r(t,n),r(n,i),r(t,s),r(t,a),r(a,d),r(a,v),r(a,p),r(t,_),r(t,b),r(b,w),r(e,R),r(e,P),q(T,x,A),I&&I.m(T,A),q(T,V,A),U||(C=[ae(i,"click",l[24]),ae(d,"click",l[27]),ae(p,"click",l[28]),ae(P,"ionChange",l[29])],U=!0)},p(T,A){A[0]&64&&y!==(y=(T[6].name?T[6].name.toUpperCase():"")+"")&&De(w,y),B===(B=H(T))&&I?I.p(T,A):(I&&I.d(1),I=B&&B(T),I&&(I.c(),I.m(V.parentNode,V)))},d(T){T&&(u(e),u(x),u(V)),I&&I.d(T),U=!1,Fe(C)}}}function On(l){let e,t='<ion-spinner name="dots" style="color:white;"></ion-spinner>';return{c(){e=f("div"),e.innerHTML=t,this.h()},l(n){e=h(n,"DIV",{class:!0,style:!0,"data-svelte-h":!0}),te(e)!=="svelte-1aosxw0"&&(e.innerHTML=t),this.h()},h(){W(e,"class","overlay"),c(e,"position","fixed"),c(e,"top","0"),c(e,"left","0"),c(e,"width","100vw"),c(e,"height","100vh"),c(e,"background","rgba(0, 0, 0, 0.5)"),c(e,"display","flex"),c(e,"align-items","center"),c(e,"justify-content","center"),c(e,"z-index","9999")},m(n,i){q(n,e,i)},d(n){n&&u(e)}}}function So(l){let e,t,n,i,o=l[2]&&mn(l),s=l[11]&&On();return{c(){e=O(),o&&o.c(),t=O(),s&&s.c(),n=Ue(),this.h()},l(a){zn("svelte-kn0kph",fn.head).forEach(u),e=N(a),o&&o.l(a),t=N(a),s&&s.l(a),n=Ue(),this.h()},h(){fn.title="Rutaflow - Detalles de ruta"},m(a,d){q(a,e,d),o&&o.m(a,d),q(a,t,d),s&&s.m(a,d),q(a,n,d),i=!0},p(a,d){a[2]?o?(o.p(a,d),d[0]&4&&ut(o,1)):(o=mn(a),o.c(),ut(o,1),o.m(t.parentNode,t)):o&&(Vn(),pt(o,1,1,()=>{o=null}),Rn()),a[11]?s||(s=On(),s.c(),s.m(n.parentNode,n)):s&&(s.d(1),s=null)},i(a){i||(ut(o),i=!0)},o(a){pt(o),i=!1},d(a){a&&(u(e),u(t),u(n)),o&&o.d(a),s&&s.d(a)}}}function Ve(l,e=""){let t="#ffffff";return l==="pending"&&!e?t="#f2e300":l=="pending"&&e?t="#F6A833":l==="completed"&&(t="#44d900"),t}function at(l){let e="";return l=="pending"?e="Pendiente":l=="completed"&&(e="Completado"),e}function Re(l){if(!l)return"#414040";l.slice(0,1)==="#"&&(l=l.slice(1)),l.length===3&&(l=l.split("").map(function(o){return o+o}).join(""));const e=parseInt(l.substr(0,2),16),t=parseInt(l.substr(2,2),16),n=parseInt(l.substr(4,2),16);return(e*299+t*587+n*114)/1e3>=128?"#414040":"#fff"}function _t(l,e){for(let t=0;t<e.length;t++)if(e[t].alias===l)return e[t].val;return""}const xo=l=>l.mandatory==="1",Po=l=>l.img;function Ao(l,e,t){let n;Hn(l,ni,M=>t(26,n=M));var i=this&&this.__awaiter||function(M,J,Q,_e){function Le(Se){return Se instanceof Q?Se:new Q(function(Oe){Oe(Se)})}return new(Q||(Q=Promise))(function(Se,Oe){function qe(ze){try{je(_e.next(ze))}catch(Xe){Oe(Xe)}}function Ke(ze){try{je(_e.throw(ze))}catch(Xe){Oe(Xe)}}function je(ze){ze.done?Se(ze.value):Le(ze.value).then(qe,Ke)}je((_e=_e.apply(M,J||[])).next())})};let{routeId:o}=e,{driverId:s}=e,a=ht,d=new Object,k=!0,v=!1,p=[],m=[],_={},b=[],y=[],w,R=!1,P="list",D,x="",V="",U="",C="0",H=new Object,B="",I=!1,T=!1,A=!1,S=!1,X=!1;const ne={car_accident:"/car-accident.svg",restaurant:"/restaurant.svg",parking:"/parking.svg",hospital:"/hospital.svg",wc:"/toilet.svg",traffic:"/traffic.svg"},re=()=>i(void 0,void 0,void 0,function*(){S=!1,yield fe(o),w.complete()});rt(()=>i(void 0,void 0,void 0,function*(){S=!1,F(),yield fe(o)}));function Ee(){const M=(b||[]).filter(J=>J.mandatory==="1");return M.length?!M.every(J=>!!J.img):!1}function Z(){var M,J;const Q=v||(_==null?void 0:_.km_inicial)==="0"||(_==null?void 0:_.gas_inicial)==="0",_e=Ee(),Le=Q||_e;return console.log("🔍 needsChecklistOrKmGas:",{showChecklist:v,km_inicial:_==null?void 0:_.km_inicial,gas_inicial:_==null?void 0:_.gas_inicial,kmGasMissing:Q,mandatoryIncomplete:_e,result:Le,checklist:b==null?void 0:b.length,mandatoryItems:(M=b==null?void 0:b.filter(Se=>Se.mandatory==="1"))===null||M===void 0?void 0:M.length,completedMandatory:(J=b==null?void 0:b.filter(Se=>Se.mandatory==="1"&&Se.img))===null||J===void 0?void 0:J.length}),Le}function L(){return!Z()}function $(){return i(this,void 0,void 0,function*(){return console.log("🔍 maybeWarnChecklist called:",{checklistWarnShown:S,needsChecklist:Z(),alertInProgress:X,showChecklist:v,km_inicial:_==null?void 0:_.km_inicial,gas_inicial:_==null?void 0:_.gas_inicial,checklist:b==null?void 0:b.length}),Z()?X?(console.log("⏳ Alert en progreso, continuando..."),!0):(console.log("🚨 Mostrando advertencia del checklist..."),X=!0,new Promise(M=>{$e.create({header:"Checklist",message:"Favor de completar checklist para iniciar viaje ✅",buttons:[{text:"Previsualizar",handler:()=>{S=!0,t(12,T=!0),X=!1,M(!0)}},{text:"Completar",handler:()=>{S=!0,X=!1,ie(b,s,o),M(!1)}}]}).then(J=>{J.present()}).catch(J=>{console.error("Error en maybeWarnChecklist:",J),X=!1,M(!0)})})):(console.log("✅ Checklist completado, permitiendo continuar..."),!0)})}function ue(M){return i(this,void 0,void 0,function*(){if((yield $())&&(t(9,P=M),P==="map")){yield Tt(),D=document.getElementById("g_map");const Q=new google.maps.Map(D,{zoom:8,center:{lat:20.6745683,lng:-103.3986104},mapId:"4504f8b37365c3d0"}),_e=new google.maps.LatLngBounds,{AdvancedMarkerElement:Le,PinElement:Se}=yield google.maps.importLibrary("marker");navigator.geolocation?navigator.geolocation.getCurrentPosition(function(Oe){const qe=new google.maps.LatLng(Oe.coords.latitude,Oe.coords.longitude);new google.maps.Marker({position:qe,map:Q,icon:{path:google.maps.SymbolPath.CIRCLE,fillColor:"#0062ff",fillOpacity:1,scale:6,strokeColor:"#ffffff",strokeWeight:2}}),new google.maps.Circle({strokeColor:"#00BFFF",strokeOpacity:.5,strokeWeight:1,fillColor:"#00BFFF",fillOpacity:.2,map:Q,center:qe,radius:Oe.coords.accuracy}),_e.extend(qe)},function(Oe){console.error("Error retrieving location:",Oe)}):console.error("Geolocation not supported by this browser."),_.lat1===_.lat2&&_.lon1===_.lon2?pe(_e,Q,{lat:_.lat2,lon:_.lon2,color:_.color,title:_.destination},{type:"icon",iconClass:"icon-home",title:"Origen/Destino",glyph:`0,${String(p.length+1)}`}):(pe(_e,Q,{lat:_.lat1,lon:_.lon1,color:_.color,title:_.origin},{type:"icon",iconClass:"icon-home",title:"Origen",glyph:"0"}),pe(_e,Q,{lat:_.lat2,lon:_.lon2,color:_.color,title:_.destination},{type:"icon",iconClass:"icon-flag",title:"Destino",glyph:String(p.length+1)})),p.forEach(Oe=>{const qe=parseFloat(Oe.lat),Ke=parseFloat(Oe.lon),je=new google.maps.LatLng(qe,Ke),ze=new google.maps.Marker({position:{lat:qe,lng:Ke},map:Q,title:Oe.title}),Xe=new Se({background:Ve(Oe.status,Oe.date_service),borderColor:"#000",glyphColor:"#000",glyph:(parseInt(Oe.pos)+1).toString()});new Le({map:Q,position:je,content:Xe.element,title:"Parada "+(parseInt(Oe.pos)+1).toString()+": "+Oe.title}).addListener("click",function(){return i(this,void 0,void 0,function*(){(yield $())&&be(Oe,!1)})}),_e.extend(ze.getPosition())}),m.forEach(Oe=>{const qe=+Oe.lat,Ke=+Oe.lng;if(isNaN(qe)||isNaN(Ke))return;const je=ne[Oe.type]||"alert-sharp",ze=document.createElement("div");ze.style.cssText="display:flex;align-items:center;justify-content:center;transform:scale(.85);";const Xe=document.createElement("ion-icon");je.startsWith("/")?Xe.setAttribute("src",je):Xe.setAttribute("icon",je),Xe.style.cssText="font-size:20px;color:#d13434;",ze.appendChild(Xe);const kt=new Se({background:"#fff",borderColor:"#000",glyph:ze}),Et=new Le({map:Q,position:{lat:qe,lng:Ke},content:kt.element,title:Oe.motive||Oe.type});_e.extend(Et.position)}),Q.fitBounds(_e)}})}function pe(M,J,Q,_e){return i(this,void 0,void 0,function*(){let Le;const Se=parseFloat(Q.lat),Oe=parseFloat(Q.lon),qe=new google.maps.LatLng(Se,Oe),{AdvancedMarkerElement:Ke,PinElement:je}=yield google.maps.importLibrary("marker");_e.type=="icon"?(Le=document.createElement("i"),Le.className=`${_e.iconClass} icon`,Le.style.fontSize="14px",Le.style.color=Re(Q.color),Le.style.fontWeight="600"):_e.type=="text";const ze=new google.maps.Marker({position:{lat:Se,lng:Oe},map:J,title:`${_e.title}. ${Q.title}`}),Xe=new je({background:Q.color,borderColor:"#000",glyphColor:Re(Q.color),glyph:_e.glyph});return new Ke({map:J,position:qe,content:Xe.element,title:_e.title+": "+Q.title}).addListener("click",function(){return i(this,void 0,void 0,function*(){(yield $())&&me(_,_e.title=="Destino"||_e.title=="Origen/Destino")})}),ze})}function fe(M){return i(this,void 0,void 0,function*(){let J=new FormData;J.append("id_route",M),J=G(J),J.append("id_enterprise",d.id_enterprise);try{const _e=yield(yield fetch(`${a}api/admin/report/seguimiento_list.php`,{method:"POST",body:J})).json();t(6,_=_e.data.seguimiento_list[0]),t(5,p=_e.data.event_list),t(7,b=_e.data.checklist),y=_e.data.expenses,m=_e.data.incidence_list,_&&t(4,v=_.km_inicial=="0"&&_.gas_inicial=="0"),Z()&&t(12,T=!0),!S&&Z()&&Ee()&&(yield $()),t(3,k=!1)}catch(Q){t(3,k=!1),console.error("Error fetching data:",Q)}})}const ce=M=>new Promise((J,Q)=>{let _e=new FormData;_e.append("id_route",M.id_route),_e.append("id_event",M.id_event),_e=G(_e),fetch(`${a}api/admin/evidence/evidence_by_event.php`,{method:"POST",body:_e}).then(Le=>Le.json()).then(Le=>{J(Le.data.event_evidence[0])}).catch(Le=>{console.error("Error fetching data:",Le),Q(Le)})});function be(M,J,Q){const _e=typeof Q=="boolean"?Q:!L();return B||(B=i(this,void 0,void 0,function*(){let Le=null;try{Le=yield ce(M)}catch{}const Se=Object.assign(Object.assign(Object.assign({},M),{stopsApproval:x,smsActive:V,signatureActive:U}),Le||{});try{yield Ze("modal-delivery-info",Jt,{delivery:Se,isLast:J,readOnly:_e,maybeWarnChecklist:$})}finally{B=null,fe(o)}}),B)}const me=(M,J)=>{let Q={};J?Q={title:M.destination,line1:M.dest_address}:Q={title:M.origin,line1:M.origin_address},Q.enterprise_name=M.enterprise_name,Q.client_name=M.client_name,Q.client_phone=M.tel,Q.id_route=M.id_route,Q.stopsApproval=x,Q.smsActive=V,Ze("modal-delivery-info",Jt,{delivery:Q,isLast:J,flag:!0,readOnly:!L(),maybeWarnChecklist:$})},ie=(M,J,Q)=>{if(A)return"";const _e=!1;return t(11,I=!0),R||(R=!0,Ze("modal-checklist",Dn,{checklist:M,driverId:J,routeId:Q,isLast:_e},{breakpoints:[.25,.5,.9],initialBreakpoint:.75,backdropBreakpoint:.25,handle:!0,handleBehavior:"cycle",canDismiss:!0,showBackdrop:!0}).then(()=>i(void 0,void 0,void 0,function*(){t(11,I=!1),R=!1,t(13,A=!0),yield fe(Q),S=!1,console.log("🔄 Modal cerrado, data refrescada, warnings reseteados")}))),""},ke=M=>i(void 0,void 0,void 0,function*(){return t(11,I=!0),yield fe(M),y.length>0?Ze("modal-expense-detail",vo,{routeId:M,expenses:y}).then(()=>{t(11,I=!1)}):Ze("modal-expense",wt,{routeId:M}).then(()=>{t(11,I=!1)}),""}),ye=M=>i(void 0,void 0,void 0,function*(){return t(11,I=!0),yield fe(M),Ze("modal-incidence",fo,{routeId:M}).then(()=>{t(11,I=!1)}),""}),we=M=>{if(M.tracking_type=="subscription"){if(M.subscriber_info&&M.payment_type==="cash"&&new Date(M.subscriber_info.payment_next)<new Date)return!0}else if(M.tracking_type=="ecommerce"&&Number(M.payment_pending)>0)return!0;return!1},ve=()=>{d.type=="super"||d.type=="admin"?lt("/drivers/me"):d.id_driver&&lt(`/drivers/${d.id_driver}`)},z=(M,J)=>i(void 0,void 0,void 0,function*(){yield(yield $e.create({header:M||"Error",message:J||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()});function G(M){return M.append("token",d.token),M.append("id_user_over",d.id_user),M}const F=()=>i(void 0,void 0,void 0,function*(){if(d.id_enterprise){let M=new FormData;M.append("id_enterprise",d.id_enterprise),M=G(M);try{const J=yield fetch(`${a}api/admin/enterprise/enterprise_settings.php`,{method:"POST",body:M});J.ok?(H=(yield J.json()).nodos,x=_t("stops_wait_approval",H),V=_t("sms_active",H),t(10,C=_t("stops_order_restriction",H)),U=_t("signature_active",H)):console.error("File upload failed:",J.statusText)}catch(J){console.error("Error during file upload:",J)}}}),le=async()=>{await $()&&ye(o)},Y=async()=>{await $()&&ke(o)},de=M=>ue(M.detail.value);function xe(M){He[M?"unshift":"push"](()=>{w=M,t(8,w)})}const Be=async()=>{await $()&&me(_,!1)},Ae=async M=>{const J=p.findIndex(Oe=>Oe.id_event===M.id_event),Q=J===0,_e=J>0?p[J-1]:null,Le=Q||_e&&_e.img!==null,Se=M.img!==null&&M.img!=="";Le||Q&&!Se||C=="1"?await $()&&be(M,!1):z("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")},Pe=async()=>{await $()&&me(_,!0)};function Ce(M){He[M?"unshift":"push"](()=>{w=M,t(8,w)})}const K=async()=>{await $()&&me(_,!1)},ee=async M=>{const J=p.findIndex(Oe=>Oe.id_event===M.id_event),Q=J===0,_e=J>0?p[J-1]:null,Le=Q||_e&&_e.img!==null,Se=M.img!==null&&M.img!=="";Le||Q&&!Se||C=="1"?await $()&&be(M,!1):z("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")},he=async()=>{await $()&&me(_,!0)};function ge(M){He[M?"unshift":"push"](()=>{w=M,t(8,w)})}const Ie=()=>{me(_,!1)},j=async M=>{const J=p.findIndex(Oe=>Oe.id_event===M.id_event),Q=J===0,_e=J>0?p[J-1]:null,Le=Q||_e&&_e.img!==null,Se=M.img!==null&&M.img!=="";Le||Q&&!Se||C=="1"?be(M,!1):z("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")},oe=()=>{me(_,!0)},se=()=>ie(b,s,o);return l.$$set=M=>{"routeId"in M&&t(0,o=M.routeId),"driverId"in M&&t(1,s=M.driverId)},l.$$.update=()=>{l.$$.dirty[0]&67108869&&(t(0,{routeId:o,driverId:s}=n.params,o,(t(1,s),t(26,n),t(2,d),t(0,o))),S=!1,t(2,d=JSON.parse(localStorage.getItem("userSession"))),d?d.id_user&&(d.type=="admin"||d.type=="super")?(fe(o),lt(`/drivers/me/routes/${o}`)):d.id_user&&d.id_driver&&(fe(o),lt(`/drivers/${d.id_driver}/routes/${o}`)):lt("/"))},[o,s,d,k,v,p,_,b,w,P,C,I,T,A,re,Z,$,ue,be,me,ie,ke,ye,we,ve,z,n,le,Y,de,xe,Be,Ae,Pe,Ce,K,ee,he,ge,Ie,j,oe,se]}class Fo extends it{constructor(e){super(),ot(this,e,Ao,So,nt,{routeId:0,driverId:1},null,[-1,-1,-1])}}export{Fo as component};

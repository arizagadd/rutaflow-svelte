import{Z as ft,s as Xe,e as s,j as T,b as c,q as m,d as re,h as a,m as C,v,i as W,w as o,x as ce,n as Le,z as Pe,_ as tn,B as y,o as Qe,k as Ae,$ as dt,t as me,r as ve,f as Y,a0 as nn,a1 as Ye,A as De,y as ye,a2 as on,a3 as Ge,a4 as ln,a5 as rn,l as an,p as sn,F as cn}from"../chunks/index.CdEBkEwf.js";import{S as We,i as Je,t as lt,a as at,c as un,b as fn,d as dn,m as _n,e as hn,g as pn}from"../chunks/index.c2pjNB5R.js";import{e as He,u as Ze,d as xe,a as mn,b as vn,c as gn,i as Qt,f as bn,g as Zt,h as En,j as st,k as In,m as xt,s as _t,n as Re,o as kn,q as On,t as Nn,r as Tn,v as Cn,w as yn,x as wn,y as Ln,p as zn}from"../chunks/index.BGOEMNo4.js";import"../chunks/index-48209844.IIRtDZyg.js";import{m as $e,D as it,a as qe,I as Mn}from"../chunks/IonPage.Caby0kDw.js";import{q as An,t as Dn}from"../chunks/ion-modal.CsJaVgKZ.js";import{g as Fe}from"../chunks/entry.QeUDNh-0.js";const Sn=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global,Pn=(r,e)=>{if(!customElements.get(r)){class t extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const n={};for(const i of this.attributes)n[i.name]=i.value;new e({target:this.shadowRoot,props:n})}}customElements.define(r,t)}},Bn=function(r){return document.createElement(r).constructor!==HTMLElement},Hn=(r,e)=>{Bn(r)||Pn(r,e)},Ue=async(r,e,t)=>{An(),Dn(),Hn(r,e);const l=await $e.create({component:r,componentProps:t});return l.present(),await l.onWillDismiss()};let je=ft({km_inicial:[],gas_inicial:[],km_final:[],gas_final:[]}),$t=ft({flag:[]});function Rn(r){let e,t,l,n,i="Cancelar",u,d,_="Captura de Km/Gas",b,g,h,f="Confirmar",p,E,N,w,R,z,G;return{c(){e=s("ion-header"),t=s("ion-toolbar"),l=s("ion-buttons"),n=s("ion-button"),n.textContent=i,u=T(),d=s("ion-title"),d.textContent=_,b=T(),g=s("ion-buttons"),h=s("ion-button"),h.textContent=f,p=T(),E=s("ion-content"),N=s("ion-item"),w=s("ion-input"),this.h()},l(j){e=c(j,"ION-HEADER",{translucent:!0});var F=m(e);t=c(F,"ION-TOOLBAR",{});var S=m(t);l=c(S,"ION-BUTTONS",{slot:!0});var D=m(l);n=c(D,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),re(n)!=="svelte-17pq4f4"&&(n.textContent=i),D.forEach(a),u=C(S),d=c(S,"ION-TITLE",{"data-svelte-h":!0}),re(d)!=="svelte-1yhkaq7"&&(d.textContent=_),b=C(S),g=c(S,"ION-BUTTONS",{slot:!0});var I=m(g);h=c(I,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),re(h)!=="svelte-cm6j4s"&&(h.textContent=f),I.forEach(a),S.forEach(a),F.forEach(a),p=C(j),E=c(j,"ION-CONTENT",{fullscreen:!0});var M=m(E);N=c(M,"ION-ITEM",{});var L=m(N);w=c(L,"ION-INPUT",{class:!0,inputmode:!0,pattern:!0,type:!0,placeholder:!0,value:!0,required:!0});var B=m(w);B.forEach(a),L.forEach(a),M.forEach(a),this.h()},h(){v(n,"color","medium"),v(l,"slot","start"),v(h,"strong",""),v(g,"slot","end"),v(e,"translucent",""),v(w,"class","fin-km"),v(w,"inputmode","numeric"),v(w,"pattern","[0-9]*"),v(w,"type","number"),v(w,"placeholder",R="Ingresa "+r[0]+" actual"),v(w,"value",r[1]),v(w,"required",""),v(E,"fullscreen","")},m(j,F){W(j,e,F),o(e,t),o(t,l),o(l,n),o(t,u),o(t,d),o(t,b),o(t,g),o(g,h),W(j,p,F),W(j,E,F),o(E,N),o(N,w),z||(G=[ce(n,"click",r[2]),ce(h,"click",r[3]),ce(w,"input",r[4])],z=!0)},p(j,[F]){F&1&&R!==(R="Ingresa "+j[0]+" actual")&&v(w,"placeholder",R),F&2&&v(w,"value",j[1])},i:Le,o:Le,d(j){j&&(a(e),a(p),a(E)),z=!1,Pe(G)}}}function Un(r,e,t){const l=tn();let n=document.querySelector("ion-modal"),i=n.componentProps.data_type;n.componentProps.isLast;let u;$t.subscribe(h=>{i=h.flag[0],i=="km_final"||i=="km_inicial"?t(0,u="kilometraje"):t(0,u="litros de gasolina")});let d=0;function _(){$e.dismiss()}function b(){l("modalResult",{data:"Your data",role:"confirm"}),i=="km_inicial"?je.update(f=>({...f,km_inicial:[d]})):i=="gas_inicial"?je.update(f=>({...f,gas_inicial:[d]})):i=="km_final"?je.update(f=>({...f,km_final:[d]})):i=="gas_final"&&je.update(f=>({...f,gas_final:[d]})),_()}return[u,d,_,b,h=>t(1,d=h.target.value)]}class Vn extends We{constructor(e){super(),Je(this,e,Un,Rn,Xe,{})}}const rt=ft({items:[],checkedIndices:[],mandatory:[]});function gt(r,e,t){const l=r.slice();return l[53]=e[t],l[54]=e,l[55]=t,l}function Fn(r){let e,t,l,n,i,u="Kilometraje inicial",d,_,b=r[0]?r[0]+" km.":"Cargar km",g,h,f,p,E,N,w,R="Gasolina inicial (litros)",z,G,j=r[1]?r[1]+" litros":"Cargar gas",F,S,D,I;return S=dt(r[21][0]),{c(){e=s("ion-item"),t=s("ion-label"),l=s("input"),n=T(),i=s("p"),i.textContent=u,d=T(),_=s("ion-button"),g=me(b),h=T(),f=s("ion-item"),p=s("ion-label"),E=s("input"),N=T(),w=s("p"),w.textContent=R,z=T(),G=s("ion-button"),F=me(j),this.h()},l(M){e=c(M,"ION-ITEM",{});var L=m(e);t=c(L,"ION-LABEL",{style:!0});var B=m(t);l=c(B,"INPUT",{id:!0,style:!0,type:!0}),n=C(B),i=c(B,"P",{style:!0,"data-svelte-h":!0}),re(i)!=="svelte-88twxi"&&(i.textContent=u),B.forEach(a),d=C(L),_=c(L,"ION-BUTTON",{fill:!0,size:!0,class:!0,"aria-selected":!0});var K=m(_);g=ve(K,b),K.forEach(a),L.forEach(a),h=C(M),f=c(M,"ION-ITEM",{});var Q=m(f);p=c(Q,"ION-LABEL",{style:!0});var X=m(p);E=c(X,"INPUT",{id:!0,style:!0,type:!0}),N=C(X),w=c(X,"P",{style:!0,"data-svelte-h":!0}),re(w)!=="svelte-1ux30eb"&&(w.textContent=R),X.forEach(a),z=C(Q),G=c(Q,"ION-BUTTON",{fill:!0,class:!0,size:!0,style:!0});var x=m(G);F=ve(x,j),x.forEach(a),Q.forEach(a),this.h()},h(){Y(l,"id","chkbox-km-ini"),y(l,"pointer-events","auto"),Y(l,"type","checkbox"),l.required=!0,y(i,"margin-left","10px"),y(t,"display","flex"),v(_,"fill","outline"),v(_,"size","small"),v(_,"class","loadKmInicial"),v(_,"aria-selected",""),Y(E,"id","chkbox-gas-ini"),y(E,"pointer-events","auto"),Y(E,"type","checkbox"),E.required=!0,y(w,"margin-left","10px"),y(p,"display","flex"),v(G,"fill","outline"),v(G,"class","loadGasInicial"),v(G,"size","small"),y(G,"height","16px "),S.p(l,E)},m(M,L){W(M,e,L),o(e,t),o(t,l),l.checked=~(r[4]||[]).indexOf(l.__value),r[28](l),o(t,n),o(t,i),o(e,d),o(e,_),o(_,g),W(M,h,L),W(M,f,L),o(f,p),o(p,E),r[30](E),E.checked=~(r[4]||[]).indexOf(E.__value),o(p,N),o(p,w),o(f,z),o(f,G),o(G,F),D||(I=[ce(l,"change",r[27]),ce(_,"click",r[29]),ce(E,"change",r[31]),ce(G,"click",r[32])],D=!0)},p(M,L){L[0]&16&&(l.checked=~(M[4]||[]).indexOf(l.__value)),L[0]&1&&b!==(b=M[0]?M[0]+" km.":"Cargar km")&&ye(g,b),L[0]&16&&(E.checked=~(M[4]||[]).indexOf(E.__value)),L[0]&2&&j!==(j=M[1]?M[1]+" litros":"Cargar gas")&&ye(F,j)},d(M){M&&(a(e),a(h),a(f)),r[28](null),r[30](null),S.r(),D=!1,Pe(I)}}}function qn(r){let e,t,l,n,i,u="Kilometraje final",d,_,b=r[2]?r[2]+" km.":"Cargar km",g,h,f,p,E,N,w,R="Gasolina final (litros)",z,G,j=r[3]?r[3]+" litros":"Cargar gas",F,S,D,I;return S=dt(r[21][0]),{c(){e=s("ion-item"),t=s("ion-label"),l=s("input"),n=T(),i=s("p"),i.textContent=u,d=T(),_=s("ion-button"),g=me(b),h=T(),f=s("ion-item"),p=s("ion-label"),E=s("input"),N=T(),w=s("p"),w.textContent=R,z=T(),G=s("ion-button"),F=me(j),this.h()},l(M){e=c(M,"ION-ITEM",{});var L=m(e);t=c(L,"ION-LABEL",{style:!0});var B=m(t);l=c(B,"INPUT",{id:!0,style:!0,type:!0}),n=C(B),i=c(B,"P",{style:!0,"data-svelte-h":!0}),re(i)!=="svelte-ccmu71"&&(i.textContent=u),B.forEach(a),d=C(L),_=c(L,"ION-BUTTON",{fill:!0,size:!0,class:!0,"aria-selected":!0});var K=m(_);g=ve(K,b),K.forEach(a),L.forEach(a),h=C(M),f=c(M,"ION-ITEM",{});var Q=m(f);p=c(Q,"ION-LABEL",{style:!0});var X=m(p);E=c(X,"INPUT",{id:!0,style:!0,type:!0}),N=C(X),w=c(X,"P",{style:!0,"data-svelte-h":!0}),re(w)!=="svelte-wsoyd2"&&(w.textContent=R),X.forEach(a),z=C(Q),G=c(Q,"ION-BUTTON",{fill:!0,size:!0,class:!0});var x=m(G);F=ve(x,j),x.forEach(a),Q.forEach(a),this.h()},h(){Y(l,"id","chkbox-km-fin"),y(l,"pointer-events","auto"),Y(l,"type","checkbox"),l.required=!0,y(i,"margin-left","10px"),y(t,"display","flex"),v(_,"fill","outline"),v(_,"size","small"),v(_,"class","loadKmInicial"),v(_,"aria-selected",""),Y(E,"id","chkbox-gas-fin"),y(E,"pointer-events","auto"),Y(E,"type","checkbox"),E.required=!0,y(w,"margin-left","10px"),y(p,"display","flex"),v(G,"fill","outline"),v(G,"size","small"),v(G,"class","loadGasInicial"),S.p(l,E)},m(M,L){W(M,e,L),o(e,t),o(t,l),l.checked=~(r[4]||[]).indexOf(l.__value),r[22](l),o(t,n),o(t,i),o(e,d),o(e,_),o(_,g),W(M,h,L),W(M,f,L),o(f,p),o(p,E),E.checked=~(r[4]||[]).indexOf(E.__value),r[25](E),o(p,N),o(p,w),o(f,z),o(f,G),o(G,F),D||(I=[ce(l,"change",r[20]),ce(_,"click",r[23]),ce(E,"change",r[24]),ce(G,"click",r[26])],D=!0)},p(M,L){L[0]&16&&(l.checked=~(M[4]||[]).indexOf(l.__value)),L[0]&4&&b!==(b=M[2]?M[2]+" km.":"Cargar km")&&ye(g,b),L[0]&16&&(E.checked=~(M[4]||[]).indexOf(E.__value)),L[0]&8&&j!==(j=M[3]?M[3]+" litros":"Cargar gas")&&ye(F,j)},d(M){M&&(a(e),a(h),a(f)),r[22](null),r[25](null),S.r(),D=!1,Pe(I)}}}function jn(r){let e=[],t=new Map,l,n=He(r[13]);const i=u=>u[53].id_checklist_event;for(let u=0;u<n.length;u+=1){let d=gt(r,n,u),_=i(d);t.set(_,e[u]=bt(_,d))}return{c(){for(let u=0;u<e.length;u+=1)e[u].c();l=Ae()},l(u){for(let d=0;d<e.length;d+=1)e[d].l(u);l=Ae()},m(u,d){for(let _=0;_<e.length;_+=1)e[_]&&e[_].m(u,d);W(u,l,d)},p(u,d){d[0]&407664&&(n=He(u[13]),e=Ze(e,d,i,1,u,n,t,l.parentNode,xe,bt,l,gt))},d(u){u&&a(l);for(let d=0;d<e.length;d+=1)e[d].d(u)}}}function Gn(r){let e,t=(r[12][r[53].id_checklist_event]?r[12][r[53].id_checklist_event]:"Cargar evidencia")+"",l;return{c(){e=s("label"),l=me(t),this.h()},l(n){e=c(n,"LABEL",{for:!0,class:!0});var i=m(e);l=ve(i,t),i.forEach(a),this.h()},h(){Y(e,"for","chklist-"+r[53].id_checklist_event),Y(e,"class","button-label svelte-1ruehls")},m(n,i){W(n,e,i),o(e,l)},p(n,i){i[0]&4096&&t!==(t=(n[12][n[53].id_checklist_event]?n[12][n[53].id_checklist_event]:"Cargar evidencia")+"")&&ye(l,t)},d(n){n&&a(e)}}}function Kn(r){let e;return{c(){e=s("ion-spinner"),this.h()},l(t){e=c(t,"ION-SPINNER",{name:!0,class:!0}),m(e).forEach(a),this.h()},h(){v(e,"name","dots"),v(e,"class","button-spinner svelte-1ruehls")},m(t,l){W(t,e,l)},p:Le,d(t){t&&a(e)}}}function bt(r,e){let t,l,n,i=e[53],u,d,_=e[53].item+"",b,g,h,f=e[53].mandatory=="1"?" * ":"",p,E,N,w,R,z,G,j,F,S;const D=()=>e[34](n,i),I=()=>e[34](null,i);function M(){return e[35](e[53])}function L(X,x){return X[11][X[53].id_checklist_event]?Kn:Gn}let B=L(e),K=B(e);function Q(...X){return e[37](e[53],...X)}return j=dt(e[21][0]),{key:r,first:null,c(){t=s("ion-item"),l=s("ion-label"),n=s("input"),u=T(),d=s("p"),b=me(_),g=T(),h=s("b"),p=me(f),E=T(),N=s("ion-button"),w=s("div"),K.c(),R=T(),z=s("input"),G=T(),this.h()},l(X){t=c(X,"ION-ITEM",{});var x=m(t);l=c(x,"ION-LABEL",{style:!0});var ie=m(l);n=c(ie,"INPUT",{id:!0,style:!0,type:!0}),u=C(ie),d=c(ie,"P",{style:!0});var se=m(d);b=ve(se,_),g=C(se),se.forEach(a),h=c(ie,"B",{style:!0});var pe=m(h);p=ve(pe,f),pe.forEach(a),ie.forEach(a),E=C(x),N=c(x,"ION-BUTTON",{fill:!0,class:!0,size:!0});var ue=m(N);w=c(ue,"DIV",{class:!0});var fe=m(w);K.l(fe),R=C(fe),z=c(fe,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0}),fe.forEach(a),ue.forEach(a),G=C(x),x.forEach(a),this.h()},h(){Y(n,"id",`chkbox-${e[53].id_checklist_event}`),y(n,"pointer-events","auto"),Y(n,"type","checkbox"),n.__value=e[53].id_checklist_event,nn(n,n.__value),n.required=!0,y(d,"margin-left","10px"),y(h,"margin-left","5px"),y(l,"display","flex"),y(z,"display","none"),Y(z,"id","chklist-"+e[53].id_checklist_event),Y(z,"name","fileToUpload"),Y(z,"type","file"),Y(z,"accept","image/*"),Y(w,"class","button-content svelte-1ruehls"),v(N,"fill","outline"),v(N,"class","loadEvidence svelte-1ruehls"),v(N,"size","small"),j.p(n),this.first=t},m(X,x){W(X,t,x),o(t,l),o(l,n),n.checked=~(e[4]||[]).indexOf(n.__value),D(),o(l,u),o(l,d),o(d,b),o(d,g),o(l,h),o(h,p),o(t,E),o(t,N),o(N,w),K.m(w,null),o(w,R),o(w,z),e[36](z),o(t,G),F||(S=[ce(n,"change",e[33]),ce(n,"change",M),ce(z,"change",Q)],F=!0)},p(X,x){e=X,x[0]&16&&(n.checked=~(e[4]||[]).indexOf(n.__value)),i!==e[53]&&(I(),i=e[53],D()),B===(B=L(e))&&K?K.p(e,x):(K.d(1),K=B(e),K&&(K.c(),K.m(w,R)))},d(X){X&&a(t),I(),K.d(),e[36](null),j.r(),F=!1,Pe(S)}}}function Xn(r){let e,t,l,n,i="Cancelar",u,d,_="REQUERIMIENTOS DE RUTA",b,g,h,f,p,E,N,w="Confirmar",R,z;function G(D,I){return D[14]?qn:Fn}let F=G(r)(r),S=r[13]&&jn(r);return{c(){e=s("ion-header"),t=s("ion-toolbar"),l=s("ion-buttons"),n=s("ion-button"),n.textContent=i,u=T(),d=s("ion-title"),d.textContent=_,b=T(),g=s("ion-content"),h=s("ion-list"),F.c(),f=T(),S&&S.c(),p=T(),E=s("ion-footer"),N=s("ion-button"),N.textContent=w,this.h()},l(D){e=c(D,"ION-HEADER",{translucent:!0});var I=m(e);t=c(I,"ION-TOOLBAR",{});var M=m(t);l=c(M,"ION-BUTTONS",{slot:!0});var L=m(l);n=c(L,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),re(n)!=="svelte-1dnmkxs"&&(n.textContent=i),L.forEach(a),u=C(M),d=c(M,"ION-TITLE",{"data-svelte-h":!0}),re(d)!=="svelte-19bar5p"&&(d.textContent=_),M.forEach(a),I.forEach(a),b=C(D),g=c(D,"ION-CONTENT",{fullscreen:!0});var B=m(g);h=c(B,"ION-LIST",{});var K=m(h);F.l(K),f=C(K),S&&S.l(K),K.forEach(a),B.forEach(a),p=C(D),E=c(D,"ION-FOOTER",{});var Q=m(E);N=c(Q,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),re(N)!=="svelte-g82qqw"&&(N.textContent=w),Q.forEach(a),this.h()},h(){v(n,"color","medium"),v(l,"slot","start"),v(e,"translucent",""),v(g,"fullscreen",""),v(N,"fill","outline"),v(N,"color","tertiary"),v(N,"strong",""),y(N,"width","99%"),y(N,"height","auto")},m(D,I){W(D,e,I),o(e,t),o(t,l),o(l,n),o(t,u),o(t,d),W(D,b,I),W(D,g,I),o(g,h),F.m(h,null),o(h,f),S&&S.m(h,null),W(D,p,I),W(D,E,I),o(E,N),R||(z=[ce(n,"click",r[15]),ce(N,"click",r[16])],R=!0)},p(D,I){F.p(D,I),D[13]&&S.p(D,I)},i:Le,o:Le,d(D){D&&(a(e),a(b),a(g),a(p),a(E)),F.d(),S&&S.d(),R=!1,Pe(z)}}}function ct(r,e){if(typeof r=="object"&&r!==null||Array.isArray(r)){if(Array.isArray(r))return r.map(t=>ct(t,e)).flat();{const t=Object.keys(r);let l;return e=="id_checklist_event"?l=t.filter(i=>i.toLowerCase().includes("id_checklist_event")).map(i=>r[i]):e=="mandatory"?l=t.filter(i=>i.toLowerCase().includes("mandatory")).map(i=>r[i]):(console.error("Tipo de dato no reconocido."),l=!1),l}}else return console.error("Invalid input. Please provide a valid object or array."),[]}function Wn(r,e,t){let l=it,n=document.querySelector("ion-modal");const i=n.componentProps.checklist,u=n.componentProps.driverId,d=n.componentProps.routeId,_=n.componentProps.isLast;let b,g,h,f,p=[],E=null,N={},w,R,z,G,j={},F={},S={};Qe(()=>{_?console.log("Último checklist"):rt.update(A=>(A.mandatory=ct(i,"mandatory"),A.items=ct(i,"id_checklist_event"),A))});function D(A){t(11,j[A]=!0,j)}const I=async()=>{await(await qe.create({header:"Datos o checklist incompletos",message:"Carga la evidencia requerida y marca todas las casillas para confirmar",buttons:[{text:"Cerrar"}]})).present()},M=async()=>{await(await qe.create({header:"Datos capturados",message:"El kilometraje y gasolina final fueron registrados correctamente, espere aprobación para finalizar ruta",buttons:[{text:"Cerrar"}]})).present()},L=async A=>{await(await qe.create({header:"Datos inválidos",message:A=="km"?"Llena correctamente el campo de kilometraje inicial":"Llena correctamente el campo de gasolina inicial",buttons:[{text:"Cerrar"}]})).present()},B=()=>{$e.dismiss(),u?Fe(`/drivers/${u}`):Fe("/drivers/me")},K=()=>{if(_){var A=se(h,"km"),Z=se(f,"gas");const J=new FormData;J.append("km_final",A),J.append("gas_final",Z),J.append("id_route",d),A&&Z?(B(),fetch(`${l}api/admin/checklist/add_evidence.php`,{method:"POST",body:J}).then(le=>le.json()).then(le=>{M()}).catch(le=>{console.error("Error fetching data:",le)})):I()}else{var ae=se(b,"km"),U=se(g,"gas");rt.update(J=>{J.items;const le=J.mandatory;if(J.items.filter((oe,he)=>J.mandatory[he]==="1").every(oe=>J.checkedIndices.includes(oe))&&ae&&U){B();const oe=new FormData;for(const he in F)if(F.hasOwnProperty(he)){const{img:ze,img_id:Be}=F[he];oe.append(`selectedImages[${he}][img]`,ze),oe.append(`selectedImages[${he}][img_id]`,Be)}oe.append("km_inicial",ae),oe.append("gas_inicial",U),oe.append("id_route",d),fetch(`${l}api/admin/checklist/add_evidence.php`,{method:"POST",body:oe}).then(he=>he.json()).then(he=>{le&&le.some(ze=>ze==="1")?ie(d,"checklist-pending"):ie(d,"enroute")}).catch(he=>{console.error("Error fetching data:",he)})}else if(!le&&ae&&U){var we=new FormData;we.append("km_inicial",ae),we.append("gas_inicial",U),fetch(`${l}api/admin/checklist/add_evidence.php`,{method:"POST",body:we}).then(oe=>oe.json()).then(oe=>{ie(d,"enroute")}).catch(oe=>{console.error("Error fetching data:",oe)})}else I();return J})}Oe()},Q=async(A,Z)=>{D(Z);const U=A.target.files[0],J=await X(U);if(J){const le=new FormData;le.append("fileToUpload",J);try{const Ee=await fetch(`${l}api/admin/manager/upload_img_driver.php`,{method:"POST",body:le});if(Ee.ok){const Ce=await Ee.json();F={...F,[Z]:{img:Ce.img,img_id:Ce.img_id}},t(12,S={...S,[Z]:Ce.filename}),x(Z),t(6,N[Z].checked=!0,N),t(11,j[Z]=!1,j)}else console.error("File upload failed:",Ee.statusText)}catch(Ee){console.error("Error during file upload:",Ee)}}},X=async A=>new Promise(Z=>{const ae=new FileReader;ae.onload=U=>{const J=new Image;J.src=U.target.result,J.onload=()=>{const le=document.createElement("canvas"),Ee=le.getContext("2d"),Ce=800,we=600;let oe=J.width,he=J.height;oe>Ce&&(he*=Ce/oe,oe=Ce),he>we&&(oe*=we/he,he=we),le.width=oe,le.height=he,Ee.drawImage(J,0,0,oe,he),le.toBlob(ze=>{Z(ze)},"image/jpeg",.7)}},ae.readAsDataURL(A)}),x=A=>{rt.update(Z=>(Z.checkedIndices.indexOf(A)===-1?Z.checkedIndices.push(A):console.error(`ID ${A} is already checked.`),Z.items.forEach(U=>{U.id_checklist_event===A&&(U.checked=!0)}),Z))};function ie(A,Z){let ae=new FormData;ae.append("id_route",A),ae.append("status",Z),fetch(`${l}api/admin/route/change_status.php`,{method:"POST",body:ae}).then(U=>U.json()).then(U=>{}).catch(U=>{console.error("Error fetching data:",U)})}function se(A,Z){return/^\d+$/.test(A)?parseInt(A,10):(L(Z),null)}function pe(A,Z){ue(Z),n.componentProps.data_type=Z,Ue("modal-gas-km",Vn,{r:Z}).then(()=>{je.subscribe(ae=>{fe(ae,Z)})})}function ue(A){$t.update(Z=>({...Z,flag:[A]}))}function fe(A,Z){t(0,b=A.km_inicial?A.km_inicial:null),t(1,g=A.gas_inicial?A.gas_inicial:null),t(2,h=A.km_final?A.km_final:null),t(3,f=A.gas_final?A.gas_final:null),Z=="km_inicial"&&w&&t(7,w.checked=!0,w),Z=="gas_inicial"&&R&&t(8,R.checked=!0,R),Z=="km_final"&&z&&t(9,z.checked=!0,z),Z=="gas_final"&&G&&t(10,G.checked=!0,G)}function Oe(){je.set({km_inicial:[],gas_inicial:[],km_final:[],gas_final:[]})}const de=[[]];function ge(){p=Ye(de[0],this.__value,this.checked),t(4,p)}function Ne(A){De[A?"unshift":"push"](()=>{z=A,t(9,z)})}const be=A=>pe(A,"km_final");function Te(){p=Ye(de[0],this.__value,this.checked),t(4,p)}function Ie(A){De[A?"unshift":"push"](()=>{G=A,t(10,G)})}const _e=A=>pe(A,"gas_final");function ke(){p=Ye(de[0],this.__value,this.checked),t(4,p)}function q(A){De[A?"unshift":"push"](()=>{w=A,t(7,w)})}const $=A=>pe(A,"km_inicial");function V(A){De[A?"unshift":"push"](()=>{R=A,t(8,R)})}function H(){p=Ye(de[0],this.__value,this.checked),t(4,p)}const ee=A=>pe(A,"gas_inicial");function k(){p=Ye(de[0],this.__value,this.checked),t(4,p)}function O(A,Z){De[A?"unshift":"push"](()=>{N[Z.id_checklist_event]=A,t(6,N)})}const P=A=>x(A.id_checklist_event);function te(A){De[A?"unshift":"push"](()=>{E=A,t(5,E)})}return[b,g,h,f,p,E,N,w,R,z,G,j,S,i,_,B,K,Q,x,pe,ge,de,Ne,be,Te,Ie,_e,ke,q,$,V,H,ee,k,O,P,te,(A,Z)=>Q(Z,A.id_checklist_event)]}class en extends We{constructor(e){super(),Je(this,e,Wn,Xn,Xe,{},null,[-1,-1])}}function Et(r,e,t){const l=r.slice();return l[50]=e[t],l[52]=t,l}function Jn(r){let e,t,l="Confirmar",n,i;return{c(){e=s("ion-buttons"),t=s("ion-button"),t.textContent=l,this.h()},l(u){e=c(u,"ION-BUTTONS",{slot:!0});var d=m(e);t=c(d,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),re(t)!=="svelte-1ida0il"&&(t.textContent=l),d.forEach(a),this.h()},h(){v(t,"strong",""),v(e,"slot","end")},m(u,d){W(u,e,d),o(e,t),n||(i=ce(t,"click",r[20]),n=!0)},p:Le,d(u){u&&a(e),n=!1,i()}}}function Yn(r){let e,t,l,n,i,u="Teléfono de Negocio",d,_,b=r[13].client_phone+"",g;return{c(){e=s("ion-item"),t=s("ion-icon"),l=T(),n=s("ion-label"),i=s("p"),i.textContent=u,d=T(),_=s("h2"),g=me(b),this.h()},l(h){e=c(h,"ION-ITEM",{href:!0});var f=m(e);t=c(f,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=C(f),n=c(f,"ION-LABEL",{class:!0});var p=m(n);i=c(p,"P",{"data-svelte-h":!0}),re(i)!=="svelte-1u5l7fz"&&(i.textContent=u),d=C(p),_=c(p,"H2",{});var E=m(_);g=ve(E,b),E.forEach(a),p.forEach(a),f.forEach(a),this.h()},h(){v(t,"icon",vn),v(t,"slot","start"),v(n,"class","ion-text-wrap"),v(e,"href","tel:"+r[13].client_phone)},m(h,f){W(h,e,f),o(e,t),o(e,l),o(e,n),o(n,i),o(n,d),o(n,_),o(_,g)},p:Le,d(h){h&&a(e)}}}function Qn(r){let e,t,l,n,i,u="Domicilio Alternativo",d,_,b=r[13].line2+"",g,h,f;return{c(){e=s("ion-item"),t=s("ion-icon"),l=T(),n=s("ion-label"),i=s("p"),i.textContent=u,d=T(),_=s("h2"),g=me(b),h=T(),f=s("ion-icon"),this.h()},l(p){e=c(p,"ION-ITEM",{href:!0});var E=m(e);t=c(E,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=C(E),n=c(E,"ION-LABEL",{class:!0});var N=m(n);i=c(N,"P",{"data-svelte-h":!0}),re(i)!=="svelte-1ub9uzw"&&(i.textContent=u),d=C(N),_=c(N,"H2",{});var w=m(_);g=ve(w,b),w.forEach(a),N.forEach(a),h=C(E),f=c(E,"ION-ICON",{icon:!0,slot:!0}),m(f).forEach(a),E.forEach(a),this.h()},h(){v(t,"icon",_t),v(t,"slot","start"),v(n,"class","ion-text-wrap"),v(f,"icon",Re),v(f,"slot","end"),v(e,"href","https://www.google.com/maps/searhc/?api=1&query="+r[13].line2)},m(p,E){W(p,e,E),o(e,t),o(e,l),o(e,n),o(n,i),o(n,d),o(n,_),o(_,g),o(e,h),o(e,f)},p:Le,d(p){p&&a(e)}}}function Zn(r){let e,t,l,n,i,u="Domicilio",d,_,b=r[13].line1+"",g,h,f,p,E=r[13].line2&&r[13].line2.trim().length,N,w=E&&xn(r);return{c(){e=s("ion-item"),t=s("ion-icon"),l=T(),n=s("ion-label"),i=s("p"),i.textContent=u,d=T(),_=s("h2"),g=me(b),h=T(),f=s("ion-icon"),p=T(),w&&w.c(),N=Ae(),this.h()},l(R){e=c(R,"ION-ITEM",{href:!0});var z=m(e);t=c(z,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=C(z),n=c(z,"ION-LABEL",{class:!0});var G=m(n);i=c(G,"P",{"data-svelte-h":!0}),re(i)!=="svelte-cbm7q1"&&(i.textContent=u),d=C(G),_=c(G,"H2",{});var j=m(_);g=ve(j,b),j.forEach(a),G.forEach(a),h=C(z),f=c(z,"ION-ICON",{icon:!0,slot:!0}),m(f).forEach(a),z.forEach(a),p=C(R),w&&w.l(R),N=Ae(),this.h()},h(){v(t,"icon",_t),v(t,"slot","start"),v(n,"class","ion-text-wrap"),v(f,"icon",Re),v(f,"slot","end"),v(e,"href","https://www.google.com/maps/search/?api=1&query="+r[13].line1)},m(R,z){W(R,e,z),o(e,t),o(e,l),o(e,n),o(n,i),o(n,d),o(n,_),o(_,g),o(e,h),o(e,f),W(R,p,z),w&&w.m(R,z),W(R,N,z)},p(R,z){E&&w.p(R,z)},d(R){R&&(a(e),a(p),a(N)),w&&w.d(R)}}}function xn(r){let e,t,l,n,i,u="Domicilio Alternativo",d,_,b=r[13].line2+"",g,h,f;return{c(){e=s("ion-item"),t=s("ion-icon"),l=T(),n=s("ion-label"),i=s("p"),i.textContent=u,d=T(),_=s("h2"),g=me(b),h=T(),f=s("ion-icon"),this.h()},l(p){e=c(p,"ION-ITEM",{href:!0});var E=m(e);t=c(E,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=C(E),n=c(E,"ION-LABEL",{class:!0});var N=m(n);i=c(N,"P",{"data-svelte-h":!0}),re(i)!=="svelte-1ub9uzw"&&(i.textContent=u),d=C(N),_=c(N,"H2",{});var w=m(_);g=ve(w,b),w.forEach(a),N.forEach(a),h=C(E),f=c(E,"ION-ICON",{icon:!0,slot:!0}),m(f).forEach(a),E.forEach(a),this.h()},h(){v(t,"icon",_t),v(t,"slot","start"),v(n,"class","ion-text-wrap"),v(f,"icon",Re),v(f,"slot","end"),v(e,"href","https://www.google.com/maps/search/?api=1&query="+r[13].line2)},m(p,E){W(p,e,E),o(e,t),o(e,l),o(e,n),o(n,i),o(n,d),o(n,_),o(_,g),o(e,h),o(e,f)},p:Le,d(p){p&&a(e)}}}function It(r){let e,t,l,n,i,u="Contacto del Cliente",d,_,b,g,h=r[3]&&r[3]==="1"&&kt(r);return{c(){e=s("ion-item"),t=s("ion-icon"),l=T(),n=s("ion-label"),i=s("p"),i.textContent=u,d=T(),_=s("h2"),b=me(r[7]),g=T(),h&&h.c(),this.h()},l(f){e=c(f,"ION-ITEM",{});var p=m(e);t=c(p,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=C(p),n=c(p,"ION-LABEL",{class:!0});var E=m(n);i=c(E,"P",{"data-svelte-h":!0}),re(i)!=="svelte-1utsyb6"&&(i.textContent=u),d=C(E),_=c(E,"H2",{});var N=m(_);b=ve(N,r[7]),N.forEach(a),E.forEach(a),g=C(p),h&&h.l(p),p.forEach(a),this.h()},h(){v(t,"icon",gn),v(t,"slot","start"),v(n,"class","ion-text-wrap")},m(f,p){W(f,e,p),o(e,t),o(e,l),o(e,n),o(n,i),o(n,d),o(n,_),o(_,b),o(e,g),h&&h.m(e,null)},p(f,p){p[0]&128&&ye(b,f[7]),f[3]&&f[3]==="1"?h?h.p(f,p):(h=kt(f),h.c(),h.m(e,null)):h&&(h.d(1),h=null)},d(f){f&&a(e),h&&h.d()}}}function kt(r){let e,t=`<ion-icon icon="${kn}" slot="start"></ion-icon>
                        Notificar Cliente`,l,n;return{c(){e=s("ion-button"),e.innerHTML=t,this.h()},l(i){e=c(i,"ION-BUTTON",{fill:!0,style:!0,"data-svelte-h":!0}),re(e)!=="svelte-w3qtwm"&&(e.innerHTML=t),this.h()},h(){v(e,"fill","outline"),y(e,"margin-left","16px")},m(i,u){W(i,e,u),l||(n=ce(e,"click",r[21]),l=!0)},p:Le,d(i){i&&a(e),l=!1,n()}}}function Ot(r){let e,t,l,n,i,u="Notas de ubicación",d,_,b;return{c(){e=s("ion-item"),t=s("ion-icon"),l=T(),n=s("ion-label"),i=s("p"),i.textContent=u,d=T(),_=s("h2"),b=me(r[8]),this.h()},l(g){e=c(g,"ION-ITEM",{});var h=m(e);t=c(h,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=C(h),n=c(h,"ION-LABEL",{class:!0});var f=m(n);i=c(f,"P",{"data-svelte-h":!0}),re(i)!=="svelte-nhm2ft"&&(i.textContent=u),d=C(f),_=c(f,"H2",{});var p=m(_);b=ve(p,r[8]),p.forEach(a),f.forEach(a),h.forEach(a),this.h()},h(){v(t,"icon",Qt),v(t,"slot","start"),v(n,"class","ion-text-wrap")},m(g,h){W(g,e,h),o(e,t),o(e,l),o(e,n),o(n,i),o(n,d),o(n,_),o(_,b)},p(g,h){h[0]&256&&ye(b,g[8])},d(g){g&&a(e)}}}function $n(r){let e,t,l,n,i,u="Horarios",d,_,b=r[13].schedule+"",g;return{c(){e=s("ion-item"),t=s("ion-icon"),l=T(),n=s("ion-label"),i=s("p"),i.textContent=u,d=T(),_=s("h2"),g=me(b),this.h()},l(h){e=c(h,"ION-ITEM",{});var f=m(e);t=c(f,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=C(f),n=c(f,"ION-LABEL",{});var p=m(n);i=c(p,"P",{"data-svelte-h":!0}),re(i)!=="svelte-11q7hm5"&&(i.textContent=u),d=C(p),_=c(p,"H2",{});var E=m(_);g=ve(E,b),E.forEach(a),p.forEach(a),f.forEach(a),this.h()},h(){v(t,"icon",bn),v(t,"slot","start")},m(h,f){W(h,e,f),o(e,t),o(e,l),o(e,n),o(n,i),o(n,d),o(n,_),o(_,g)},p:Le,d(h){h&&a(e)}}}function eo(r){let e,t,l,n,i,u="Notas del operador",d,_,b=r[13].driver_comments+"",g;return{c(){e=s("ion-item"),t=s("ion-icon"),l=T(),n=s("ion-label"),i=s("p"),i.textContent=u,d=T(),_=s("h2"),g=me(b),this.h()},l(h){e=c(h,"ION-ITEM",{});var f=m(e);t=c(f,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=C(f),n=c(f,"ION-LABEL",{});var p=m(n);i=c(p,"P",{"data-svelte-h":!0}),re(i)!=="svelte-1yk9qp4"&&(i.textContent=u),d=C(p),_=c(p,"H2",{});var E=m(_);g=ve(E,b),E.forEach(a),p.forEach(a),f.forEach(a),this.h()},h(){v(t,"icon",Zt),v(t,"slot","start")},m(h,f){W(h,e,f),o(e,t),o(e,l),o(e,n),o(n,i),o(n,d),o(n,_),o(_,g)},p:Le,d(h){h&&a(e)}}}function to(r){let e,t=r[13].logistic_comments!="<br>"&&no(r);return{c(){t&&t.c(),e=Ae()},l(l){t&&t.l(l),e=Ae()},m(l,n){t&&t.m(l,n),W(l,e,n)},p(l,n){l[13].logistic_comments!="<br>"&&t.p(l,n)},d(l){l&&a(e),t&&t.d(l)}}}function no(r){let e,t,l,n,i,u="Comentarios logísticos",d,_,b=r[13].logistic_comments+"",g;return{c(){e=s("ion-item"),t=s("ion-icon"),l=T(),n=s("ion-label"),i=s("p"),i.textContent=u,d=T(),_=s("h2"),g=me(b),this.h()},l(h){e=c(h,"ION-ITEM",{});var f=m(e);t=c(f,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=C(f),n=c(f,"ION-LABEL",{class:!0});var p=m(n);i=c(p,"P",{"data-svelte-h":!0}),re(i)!=="svelte-1iz85r6"&&(i.textContent=u),d=C(p),_=c(p,"H2",{});var E=m(_);g=ve(E,b),E.forEach(a),p.forEach(a),f.forEach(a),this.h()},h(){v(t,"icon",Qt),v(t,"slot","start"),v(n,"class","ion-text-wrap")},m(h,f){W(h,e,f),o(e,t),o(e,l),o(e,n),o(n,i),o(n,d),o(n,_),o(_,g)},p:Le,d(h){h&&a(e)}}}function Nt(r){let e,t,l,n;return{c(){e=s("ion-item"),t=s("ion-icon"),l=T(),n=s("ion-textarea"),this.h()},l(i){e=c(i,"ION-ITEM",{});var u=m(e);t=c(u,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=C(u),n=c(u,"ION-TEXTAREA",{placeholder:!0}),m(n).forEach(a),u.forEach(a),this.h()},h(){v(t,"icon",En),v(t,"slot","start"),v(n,"placeholder","Escribe el motivo...")},m(i,u){W(i,e,u),o(e,t),o(e,l),o(e,n),r[27](n)},p:Le,d(i){i&&a(e),r[27](null)}}}function oo(r){let e,t,l,n,i,u,d,_=r[5]===!0&&Tt(r),b=(r[6]===!0||r[6]===!1&&r[5]===!1)&&Ct(r);return{c(){e=s("ion-item"),t=s("ion-icon"),l=T(),n=s("ion-textarea"),i=T(),u=s("section"),_&&_.c(),d=T(),b&&b.c(),this.h()},l(g){e=c(g,"ION-ITEM",{});var h=m(e);t=c(h,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=C(h),n=c(h,"ION-TEXTAREA",{label:!0,placeholder:!0}),m(n).forEach(a),h.forEach(a),i=C(g),u=c(g,"SECTION",{style:!0});var f=m(u);_&&_.l(f),d=C(f),b&&b.l(f),f.forEach(a),this.h()},h(){v(t,"icon",st),v(t,"slot","start"),v(n,"label","Notas"),v(n,"placeholder","Escribe aquí..."),y(u,"display","flex"),y(u,"gap","8px"),y(u,"padding","16px 16px 6px")},m(g,h){W(g,e,h),o(e,t),o(e,l),o(e,n),r[28](n),W(g,i,h),W(g,u,h),_&&_.m(u,null),o(u,d),b&&b.m(u,null)},p(g,h){g[5]===!0?_?_.p(g,h):(_=Tt(g),_.c(),_.m(u,d)):_&&(_.d(1),_=null),g[6]===!0||g[6]===!1&&g[5]===!1?b?b.p(g,h):(b=Ct(g),b.c(),b.m(u,null)):b&&(b.d(1),b=null)},d(g){g&&(a(e),a(i),a(u)),r[28](null),_&&_.d(),b&&b.d()}}}function Tt(r){let e,t=`<ion-icon icon="${On}" slot="start"></ion-icon>
                        Ingreso`,l,n;return{c(){e=s("ion-button"),e.innerHTML=t,this.h()},l(i){e=c(i,"ION-BUTTON",{id:!0,style:!0,"data-svelte-h":!0}),re(e)!=="svelte-3onvnr"&&(e.innerHTML=t),this.h()},h(){v(e,"id","checkInBtn"),y(e,"flex","1")},m(i,u){W(i,e,u),l||(n=ce(e,"click",r[22]),l=!0)},p:Le,d(i){i&&a(e),l=!1,n()}}}function Ct(r){let e,t,l,n,i,u;return{c(){e=s("ion-button"),t=s("ion-icon"),l=me(`
                        Salida`),this.h()},l(d){e=c(d,"ION-BUTTON",{id:!0,style:!0,disabled:!0});var _=m(e);t=c(_,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=ve(_,`
                        Salida`),_.forEach(a),this.h()},h(){v(t,"icon",In),v(t,"slot","start"),v(e,"id","checkOutBtn"),y(e,"flex","1"),v(e,"disabled",n=r[6]===!1)},m(d,_){W(d,e,_),o(e,t),o(e,l),i||(u=ce(e,"click",r[23]),i=!0)},p(d,_){_[0]&64&&n!==(n=d[6]===!1)&&v(e,"disabled",n)},d(d){d&&a(e),i=!1,u()}}}function lo(r){let e,t,l,n,i,u="Subir Evidencia",d,_,b,g;return{c(){e=s("section"),t=s("ion-button"),l=s("ion-icon"),n=T(),i=s("label"),i.textContent=u,d=T(),_=s("input"),this.h()},l(h){e=c(h,"SECTION",{style:!0});var f=m(e);t=c(f,"ION-BUTTON",{fill:!0,class:!0,style:!0});var p=m(t);l=c(p,"ION-ICON",{icon:!0,slot:!0}),m(l).forEach(a),n=C(p),i=c(p,"LABEL",{for:!0,"data-svelte-h":!0}),re(i)!=="svelte-1wg51s6"&&(i.textContent=u),d=C(p),_=c(p,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0}),p.forEach(a),f.forEach(a),this.h()},h(){v(l,"icon",xt),v(l,"slot","start"),Y(i,"for","eventEvidence"),y(_,"display","none"),Y(_,"id","eventEvidence"),Y(_,"name","fileToUpload"),Y(_,"type","file"),_.multiple=!0,Y(_,"accept","image/*"),v(t,"fill","outline"),v(t,"class","loadEvidence"),y(t,"flex","1"),y(e,"display","flex"),y(e,"gap","8px"),y(e,"padding","0px 16px")},m(h,f){W(h,e,f),o(e,t),o(t,l),o(t,n),o(t,i),o(t,d),o(t,_),b||(g=[ce(_,"change",r[16]),ce(_,"click",r[17])],b=!0)},p:Le,d(h){h&&a(e),b=!1,Pe(g)}}}function yt(r){let e,t='<ion-spinner name="dots"></ion-spinner>';return{c(){e=s("section"),e.innerHTML=t,this.h()},l(l){e=c(l,"SECTION",{style:!0,"data-svelte-h":!0}),re(e)!=="svelte-1sj3e0"&&(e.innerHTML=t),this.h()},h(){y(e,"text-align","center")},m(l,n){W(l,e,n)},d(l){l&&a(e)}}}function wt(r){let e,t,l=He(r[2]),n=[];for(let i=0;i<l.length;i+=1)n[i]=Lt(Et(r,l,i));return{c(){e=s("section"),t=s("div");for(let i=0;i<n.length;i+=1)n[i].c();this.h()},l(i){e=c(i,"SECTION",{});var u=m(e);t=c(u,"DIV",{class:!0,style:!0});var d=m(t);for(let _=0;_<n.length;_+=1)n[_].l(d);d.forEach(a),u.forEach(a),this.h()},h(){Y(t,"class","image-grid"),y(t,"display","grid"),y(t,"grid-template-columns","repeat(auto-fill, minmax(100px, 1fr))"),y(t,"gap","10px"),y(t,"padding","0px 10px")},m(i,u){W(i,e,u),o(e,t);for(let d=0;d<n.length;d+=1)n[d]&&n[d].m(t,null)},p(i,u){if(u[0]&17301508){l=He(i[2]);let d;for(d=0;d<l.length;d+=1){const _=Et(i,l,d);n[d]?n[d].p(_,u):(n[d]=Lt(_),n[d].c(),n[d].m(t,null))}for(;d<n.length;d+=1)n[d].d(1);n.length=l.length}},d(i){i&&a(e),on(n,i)}}}function Lt(r){let e,t,l,n,i,u=`<ion-icon icon="${Nn}"></ion-icon>`,d,_,b;function g(){return r[29](r[50])}function h(){return r[30](r[52])}return{c(){e=s("div"),t=s("ion-img"),n=T(),i=s("button"),i.innerHTML=u,d=T(),this.h()},l(f){e=c(f,"DIV",{class:!0,style:!0});var p=m(e);t=c(p,"ION-IMG",{src:!0,alt:!0,style:!0}),m(t).forEach(a),n=C(p),i=c(p,"BUTTON",{class:!0,style:!0,"data-svelte-h":!0}),re(i)!=="svelte-zguiov"&&(i.innerHTML=u),d=C(p),p.forEach(a),this.h()},h(){Ge(t.src,l=r[50])||v(t,"src",l),v(t,"alt","Evidencia fotográfica"),y(t,"width","100%"),y(t,"height","100px"),y(t,"object-fit","cover"),y(t,"cursor","pointer"),y(t,"border","1px solid #ccc"),y(t,"border-radius","4px"),y(t,"margin-top","16px"),Y(i,"class","remove-button"),y(i,"position","absolute"),y(i,"top","5px"),y(i,"right","5px"),y(i,"border","none"),y(i,"cursor","pointer"),y(i,"font-size","18px"),y(i,"background","white"),y(i,"border-radius","50%"),y(i,"padding","3px 4px 0px"),y(i,"box-shadow","2px 2px 6px rgba(0, 0, 0, 0.3)"),y(i,"color","#0000008f"),Y(e,"class","image-container"),y(e,"position","relative")},m(f,p){W(f,e,p),o(e,t),o(e,n),o(e,i),o(e,d),_||(b=[ce(t,"click",g),ce(i,"click",h)],_=!0)},p(f,p){r=f,p[0]&4&&!Ge(t.src,l=r[50])&&v(t,"src",l)},d(f){f&&a(e),_=!1,Pe(b)}}}function zt(r){let e,t,l,n,i,u,d=`<ion-icon icon="${Tn}"></ion-icon>`,_,b;return{c(){e=s("div"),t=s("div"),l=s("ion-img"),i=T(),u=s("button"),u.innerHTML=d,this.h()},l(g){e=c(g,"DIV",{class:!0,style:!0});var h=m(e);t=c(h,"DIV",{class:!0,style:!0});var f=m(t);l=c(f,"ION-IMG",{src:!0,alt:!0,style:!0}),m(l).forEach(a),i=C(f),u=c(f,"BUTTON",{class:!0,style:!0,"data-svelte-h":!0}),re(u)!=="svelte-g0qr0o"&&(u.innerHTML=d),f.forEach(a),h.forEach(a),this.h()},h(){Ge(l.src,n=r[12])||v(l,"src",n),v(l,"alt","Evidencia fotográfica"),y(l,"width","100%"),y(l,"height","auto"),Y(u,"class","close-button"),y(u,"position","absolute"),y(u,"top","5px"),y(u,"right","5px"),y(u,"background","white"),y(u,"color","#444444d1"),y(u,"border","none"),y(u,"cursor","pointer"),y(u,"padding","2px 2px 0px 6px"),y(u,"border-radius","50%"),y(u,"font-size","20px"),Y(t,"class","modal-content"),y(t,"position","relative"),y(t,"background","white"),y(t,"padding","20px"),y(t,"border-radius","8px"),y(t,"max-width","90vw"),y(t,"max-height","90vh"),y(t,"overflow","auto"),Y(e,"class","modal-overlay"),y(e,"position","fixed"),y(e,"top","0"),y(e,"left","0"),y(e,"width","100vw"),y(e,"height","100vh"),y(e,"background","rgba(0, 0, 0, 0.8)"),y(e,"display","flex"),y(e,"justify-content","center"),y(e,"align-items","center"),y(e,"z-index","1000")},m(g,h){W(g,e,h),o(e,t),o(t,l),o(t,i),o(t,u),_||(b=[ce(u,"click",r[25]),ce(t,"click",ln(r[26])),ce(e,"click",r[25])],_=!0)},p(g,h){h[0]&4096&&!Ge(l.src,n=g[12])&&v(l,"src",n)},d(g){g&&a(e),_=!1,Pe(b)}}}function io(r){let e,t,l,n,i="Cerrar",u,d,_=r[13].title+"",b,g,h,f,p,E,N,w,R,z,G="Negocio",j,F,S=r[13].client_name+"",D,I,M=r[13].client_phone&&r[13].client_phone.trim().length,L,B,K,Q,X=r[13].schedule&&r[13].schedule.trim().length,x,ie,se=r[13].logistic_comments&&r[13].logistic_comments.trim().length,pe,ue,fe,Oe,de,ge,Ne,be,Te,Ie=(!r[14]&&!r[15]||r[14]&&r[15])&&Jn(r),_e=M&&Yn(r);function ke(U,J){if(U[13].line1&&U[13].line1.trim().length)return Zn;if(U[13].line2&&U[13].line2.trim().length)return Qn}let q=ke(r),$=q&&q(r),V=r[7]&&It(r),H=r[8]&&r[8]!=="<br>"&&Ot(r),ee=X&&$n(r),k=r[13].driver_comments&&eo(r),O=se&&to(r),P=r[9]&&Nt(r),te=!r[15]&&oo(r),ne=(r[14]&&r[15]||!r[14]&&!r[15])&&lo(r),A=r[4]&&yt(),Z=r[1]&&wt(r),ae=r[11]&&zt(r);return{c(){e=s("ion-header"),t=s("ion-toolbar"),l=s("ion-buttons"),n=s("ion-button"),n.textContent=i,u=T(),d=s("ion-title"),b=me(_),g=T(),Ie&&Ie.c(),h=T(),f=s("ion-content"),p=s("ion-list"),E=s("ion-item"),N=s("ion-icon"),w=T(),R=s("ion-label"),z=s("p"),z.textContent=G,j=T(),F=s("h2"),D=me(S),I=T(),_e&&_e.c(),L=T(),$&&$.c(),B=T(),V&&V.c(),K=T(),H&&H.c(),Q=T(),ee&&ee.c(),x=T(),k&&k.c(),ie=T(),O&&O.c(),pe=T(),P&&P.c(),ue=T(),te&&te.c(),fe=T(),ne&&ne.c(),Oe=T(),A&&A.c(),de=T(),Z&&Z.c(),ge=T(),ae&&ae.c(),Ne=Ae(),this.h()},l(U){e=c(U,"ION-HEADER",{translucent:!0});var J=m(e);t=c(J,"ION-TOOLBAR",{});var le=m(t);l=c(le,"ION-BUTTONS",{slot:!0});var Ee=m(l);n=c(Ee,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),re(n)!=="svelte-2ks32x"&&(n.textContent=i),Ee.forEach(a),u=C(le),d=c(le,"ION-TITLE",{style:!0,title:!0});var Ce=m(d);b=ve(Ce,_),Ce.forEach(a),g=C(le),Ie&&Ie.l(le),le.forEach(a),J.forEach(a),h=C(U),f=c(U,"ION-CONTENT",{fullscreen:!0});var we=m(f);p=c(we,"ION-LIST",{});var oe=m(p);E=c(oe,"ION-ITEM",{});var he=m(E);N=c(he,"ION-ICON",{icon:!0,slot:!0}),m(N).forEach(a),w=C(he),R=c(he,"ION-LABEL",{});var ze=m(R);z=c(ze,"P",{"data-svelte-h":!0}),re(z)!=="svelte-57b1dg"&&(z.textContent=G),j=C(ze),F=c(ze,"H2",{});var Be=m(F);D=ve(Be,S),Be.forEach(a),ze.forEach(a),he.forEach(a),I=C(oe),_e&&_e.l(oe),L=C(oe),$&&$.l(oe),B=C(oe),V&&V.l(oe),K=C(oe),H&&H.l(oe),Q=C(oe),ee&&ee.l(oe),x=C(oe),k&&k.l(oe),ie=C(oe),O&&O.l(oe),pe=C(oe),P&&P.l(oe),ue=C(oe),te&&te.l(oe),fe=C(oe),ne&&ne.l(oe),Oe=C(oe),A&&A.l(oe),de=C(oe),Z&&Z.l(oe),oe.forEach(a),we.forEach(a),ge=C(U),ae&&ae.l(U),Ne=Ae(),this.h()},h(){v(n,"color","medium"),v(l,"slot","start"),y(d,"text-align","center"),v(d,"title",r[13].title),v(e,"translucent",""),v(N,"icon",mn),v(N,"slot","start"),v(f,"fullscreen","")},m(U,J){W(U,e,J),o(e,t),o(t,l),o(l,n),o(t,u),o(t,d),o(d,b),o(t,g),Ie&&Ie.m(t,null),W(U,h,J),W(U,f,J),o(f,p),o(p,E),o(E,N),o(E,w),o(E,R),o(R,z),o(R,j),o(R,F),o(F,D),o(p,I),_e&&_e.m(p,null),o(p,L),$&&$.m(p,null),o(p,B),V&&V.m(p,null),o(p,K),H&&H.m(p,null),o(p,Q),ee&&ee.m(p,null),o(p,x),k&&k.m(p,null),o(p,ie),O&&O.m(p,null),o(p,pe),P&&P.m(p,null),o(p,ue),te&&te.m(p,null),o(p,fe),ne&&ne.m(p,null),o(p,Oe),A&&A.m(p,null),o(p,de),Z&&Z.m(p,null),W(U,ge,J),ae&&ae.m(U,J),W(U,Ne,J),be||(Te=ce(n,"click",r[18]),be=!0)},p(U,J){(!U[14]&&!U[15]||U[14]&&U[15])&&Ie.p(U,J),M&&_e.p(U,J),$&&$.p(U,J),U[7]?V?V.p(U,J):(V=It(U),V.c(),V.m(p,K)):V&&(V.d(1),V=null),U[8]&&U[8]!=="<br>"?H?H.p(U,J):(H=Ot(U),H.c(),H.m(p,Q)):H&&(H.d(1),H=null),X&&ee.p(U,J),U[13].driver_comments&&k.p(U,J),se&&O.p(U,J),U[9]?P?P.p(U,J):(P=Nt(U),P.c(),P.m(p,ue)):P&&(P.d(1),P=null),U[15]||te.p(U,J),(U[14]&&U[15]||!U[14]&&!U[15])&&ne.p(U,J),U[4]?A||(A=yt(),A.c(),A.m(p,de)):A&&(A.d(1),A=null),U[1]?Z?Z.p(U,J):(Z=wt(U),Z.c(),Z.m(p,null)):Z&&(Z.d(1),Z=null),U[11]?ae?ae.p(U,J):(ae=zt(U),ae.c(),ae.m(Ne.parentNode,Ne)):ae&&(ae.d(1),ae=null)},i:Le,o:Le,d(U){U&&(a(e),a(h),a(f),a(ge),a(Ne)),Ie&&Ie.d(),_e&&_e.d(),$&&$.d(),V&&V.d(),H&&H.d(),ee&&ee.d(),k&&k.d(),O&&O.d(),P&&P.d(),te&&te.d(),ne&&ne.d(),A&&A.d(),Z&&Z.d(),ae&&ae.d(U),be=!1,Te()}}}const Mt=/Teléfono:\s*(\d{10,})/;function At(r,e){for(let t=0;t<e.length;t++)if(e[t].alias===r)return e[t].val;return""}function ot(r=""){return r.split(",").map(t=>t.trim())}function ro(r,e,t){let l=it,n=document.querySelector("ion-modal"),i=n.componentProps.delivery,u=n.componentProps.isLast||!1,d=n.componentProps.flag||!1,_=i.driver_comments?i.driver_comments:"",b=i.img?i.img:"",g=i.img_id?i.img_id:"",h=b?ot(b):new Array,f=g?ot(g):new Array,p={latitude:null,longitude:null},E=new Object,N="",w="",R=!1,z=!0,G=!1,j="",F=i.comments_ext,S=!1,D="",I=!1,M=null;Qe(()=>{Ne(),B()});async function L(k="",O,P={}){const te=new FormData;t(4,R=!0);for(const[ne,A]of Object.entries(P))te.append(ne,A);try{const ne=await fetch(k,{method:"POST",body:te});if(ne.ok){const A=await ne.json();O(A)}else console.error("Request failed:",ne.statusText)}catch(ne){console.error("Error during file upload:",ne)}finally{t(4,R=!1)}}function B(){i.date_service?i.date_service&&!i.date_completed&&!i.service_time?(t(5,z=!1),t(6,G=!0)):i.date_service&&i.date_completed&&i.service_time&&(t(5,z=!1),t(6,G=!1)):(t(5,z=!0),t(6,G=!1))}if(i.comments_ext){const k=i.comments_ext.match(Mt);k&&(j=k[1],F=i.comments_ext.replace(Mt,"").trim())}const K=async(k,O)=>{await(await qe.create({header:k||"Error",message:O||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()},Q=async(k="",O="",P="",te,ne={})=>{await(await qe.create({header:k||"Error",message:O||"Vuelva a intentar",buttons:[{text:"No",role:"cancel",handler:()=>{console.log('User selected "No"')}},{text:"Sí",handler:()=>{L(P,te,ne)}}]})).present()},X=async k=>{if(h.length==5)K("Límite de evidencias","Solo se permite subir 5 fotos por parada");else if(d&&u&&h.length==1)K("Límite de evidencias","Para el final de la ruta solo se permite subir 1 foto");else{const te=k.target.files[0],ne=await se(te);if(ne){t(1,b=h.join(",")),g=f.join(",");var O=new Object;O.fileToUpload=ne,L(`${l}api/admin/manager/upload_img_driver.php`,function(A){t(1,b=b?`${b},${A.img}`:A.img),g=g?`${g},${A.img_id}`:A.img_id,t(2,h=ot(b)),f=ot(g)},O)}}};function x(k){var O=i.service_time;!O&&z&&!u&&!d&&(k.preventDefault(),K("Registrar Ingreso","Antes de subir la evidencia registra el ingreso a la actual parada."))}function ie(){var k=d?i.date_completed:!1;if(!k&&!z&&G&&!u&&!d){var O=new Object;O.id_event=i.id_event,O.type="checkout",Q("Registrar Salida","¿Completaste tu entrega?",l+"api/admin/route/record_check_date.php",function(P){P.minutes&&K("Tiempo por parada","Completaste la parada en "+P.minutes+" minutos.")},O)}}const se=async k=>new Promise(O=>{const P=new FileReader;P.onload=te=>{const ne=new Image;ne.src=te.target.result,ne.onload=()=>{const A=document.createElement("canvas"),Z=A.getContext("2d"),ae=800,U=600;let J=ne.width,le=ne.height;J>ae&&(le*=ae/J,J=ae),le>U&&(J*=U/le,le=U),A.width=J,A.height=le,Z.drawImage(ne,0,0,J,le),A.toBlob(Ee=>{O(Ee)},"image/jpeg",.7)}},P.readAsDataURL(k)}),pe=()=>{n.dismiss({data:Date.now()})};function ue(k){t(2,h=h.filter((O,P)=>P!==k))}const fe=async()=>{try{if(t(1,b=h.join(",")),g=f.join(","),ie(),await de()){const O={id_route:i.id_route,id_event:i.id_event,comments:_.value,img:b,img_id:g,lat:p.latitude,lon:p.longitude,...N==="0"&&{approve:"0"},...u&&{isLast:!0},...d&&u==!0&&{destiny:!0}};O.img&&O.img_id?L(`${l}api/admin/evidence/send_evidence.php`,function(P){if(P.success==!0){const te=O.id_route;pe(),u&&Oe("","",te,u)}else K("Carga fallida","Actualiza la página y vuelve a intentar cargar la información!")},O):K("Información incompleta","Cargar evidencia fotográfica faltante para completar parada.")}else K("Ubicación faltante","Asegúrate darle permisos a Rutaflow para acceder a tu ubicación")}catch(k){console.error("Error fetching data:",k)}},Oe=(k,O,P,te)=>{n.componentProps.routeId=P,n.componentProps.driverId=i.id_driver,Ue("modal-km-gas",en,{checklist:k,driverId:O,routeId:P,isLast:te}).then(ne=>{})},de=async()=>navigator.geolocation?new Promise((k,O)=>{navigator.geolocation.getCurrentPosition(P=>{p.latitude=P.coords.latitude,p.longitude=P.coords.longitude,k(!0)},P=>{console.error("Error getting location:",P),k(!1)})}):(console.error("Geolocation is not supported by your browser"),!1);async function ge(k){k.stopPropagation();const O=new FormData;O.append("client_phone",j),O.append("client_name",i.title),O.append("delivery_phone",i.client_phone),O.append("enterprise_name",i.enterprise_name);try{const P=await fetch(`${l}api/admin/message_central/send_sms.php`,{method:"POST",body:O});if(P.ok){const te=await P.json();K("SMS enviado","Se envío correctamente un SMS a "+i.title+" con número de teléfono: "+j)}else K("SMS no enviado","Hubo un error al enviar SMS a "+i.title+" con número de teléfono: "+phoneNumber0+". Por favor contacte a soporte.")}catch(P){console.error("Error during file upload:",P)}}const Ne=async()=>{if(i.id_enterprise){const k=new FormData;k.append("id_enterprise",i.id_enterprise);try{const O=await fetch(`${l}api/admin/enterprise/enterprise_settings.php`,{method:"POST",body:k});O.ok?(E=(await O.json()).nodos,N=At("stops_wait_approval",E),t(3,w=At("sms_active",E))):console.error("File upload failed:",O.statusText)}catch(O){console.error("Error during file upload:",O)}}};function be(){t(5,z=!1),t(6,G=!0),Ie(i.id_event,"checkin")}function Te(){t(6,G=!1),t(5,z=!1),Ie(i.id_event,"checkout")}async function Ie(k,O){if(O){const P=new FormData;P.append("type",O),P.append("id_event",k);try{const te=await fetch(`${l}api/admin/route/record_check_date.php`,{method:"POST",body:P});if(te.ok){const ne=await te.json();ne.minutes&&K("Tiempo por parada","Completaste la parada en "+ne.minutes+" minutos.")}else console.error("File upload failed:",te.statusText)}catch(te){console.error("Error during file upload:",te)}finally{}}}const _e=k=>{t(12,M=k),t(11,I=!0)},ke=()=>{t(11,I=!1),t(12,M=null)};function q(k){rn.call(this,r,k)}function $(k){De[k?"unshift":"push"](()=>{D=k,t(10,D)})}function V(k){De[k?"unshift":"push"](()=>{_=k,t(0,_)})}return[_,b,h,w,R,z,G,j,F,S,D,I,M,i,u,d,X,x,pe,ue,fe,ge,be,Te,_e,ke,q,$,V,k=>_e(k),k=>ue(k)]}class Dt extends We{constructor(e){super(),Je(this,e,ro,io,Xe,{},null,[-1,-1])}}function St(r){let e;return{c(){e=s("ion-spinner"),this.h()},l(t){e=c(t,"ION-SPINNER",{name:!0}),m(e).forEach(a),this.h()},h(){v(e,"name","dots")},m(t,l){W(t,e,l)},d(t){t&&a(e)}}}function Pt(r){let e,t,l;return{c(){e=s("section"),t=s("ion-img"),this.h()},l(n){e=c(n,"SECTION",{});var i=m(e);t=c(i,"ION-IMG",{src:!0,alt:!0,style:!0}),m(t).forEach(a),i.forEach(a),this.h()},h(){Ge(t.src,l=r[0])||v(t,"src",l),v(t,"alt","Evidencia fotográfica"),y(t,"max-width","100%"),y(t,"margin-top","16px")},m(n,i){W(n,e,i),o(e,t)},p(n,i){i&1&&!Ge(t.src,l=n[0])&&v(t,"src",l)},d(n){n&&a(e)}}}function ao(r){let e,t,l,n,i="Cancelar",u,d,_="AGREGAR GASTO",b,g,h,f,p,E,N,w,R,z,G,j,F,S,D,I,M,L,B='Tipo de pago <ion-text color="danger">(Obligatorio)</ion-text>',K,Q,X="Efectivo",x,ie,se="Tarjeta",pe,ue,fe="Transferencia",Oe,de,ge,Ne,be,Te,Ie,_e,ke,q,$=`<ion-icon icon="${xt}" slot="start"></ion-icon>
                        Subir Evidencia`,V,H,ee,k,O,P,te,ne,A="Confirmar",Z,ae,U=r[5]&&St(),J=r[0]&&Pt(r);return{c(){e=s("ion-header"),t=s("ion-toolbar"),l=s("ion-buttons"),n=s("ion-button"),n.textContent=i,u=T(),d=s("ion-title"),d.textContent=_,b=T(),g=s("ion-content"),h=s("ion-list"),f=s("ion-item"),p=s("ion-icon"),E=T(),N=s("ion-input"),w=T(),R=s("ion-item"),z=s("ion-icon"),G=T(),j=s("ion-input"),F=T(),S=s("ion-item"),D=s("ion-icon"),I=T(),M=s("ion-select"),L=s("div"),L.innerHTML=B,K=T(),Q=s("ion-select-option"),Q.textContent=X,x=T(),ie=s("ion-select-option"),ie.textContent=se,pe=T(),ue=s("ion-select-option"),ue.textContent=fe,Oe=T(),de=s("ion-item"),ge=s("ion-icon"),Ne=T(),be=s("ion-textarea"),Te=T(),Ie=s("section"),_e=s("label"),ke=s("ion-button"),q=s("label"),q.innerHTML=$,V=T(),H=s("input"),ee=T(),U&&U.c(),k=T(),J&&J.c(),O=T(),P=s("ion-footer"),te=s("ion-toolbar"),ne=s("ion-button"),ne.textContent=A,this.h()},l(le){e=c(le,"ION-HEADER",{translucent:!0});var Ee=m(e);t=c(Ee,"ION-TOOLBAR",{});var Ce=m(t);l=c(Ce,"ION-BUTTONS",{slot:!0});var we=m(l);n=c(we,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),re(n)!=="svelte-1f8rjcf"&&(n.textContent=i),we.forEach(a),u=C(Ce),d=c(Ce,"ION-TITLE",{title:!0,"data-svelte-h":!0}),re(d)!=="svelte-efps2s"&&(d.textContent=_),Ce.forEach(a),Ee.forEach(a),b=C(le),g=c(le,"ION-CONTENT",{fullscreen:!0});var oe=m(g);h=c(oe,"ION-LIST",{});var he=m(h);f=c(he,"ION-ITEM",{});var ze=m(f);p=c(ze,"ION-ICON",{icon:!0,slot:!0}),m(p).forEach(a),E=C(ze),N=c(ze,"ION-INPUT",{label:!0,type:!0,placeholder:!0,value:!0}),m(N).forEach(a),ze.forEach(a),w=C(he),R=c(he,"ION-ITEM",{});var Be=m(R);z=c(Be,"ION-ICON",{icon:!0,slot:!0}),m(z).forEach(a),G=C(Be),j=c(Be,"ION-INPUT",{label:!0,type:!0,value:!0}),m(j).forEach(a),Be.forEach(a),F=C(he),S=c(he,"ION-ITEM",{});var et=m(S);D=c(et,"ION-ICON",{icon:!0,slot:!0}),m(D).forEach(a),I=C(et),M=c(et,"ION-SELECT",{placeholder:!0,value:!0});var Ve=m(M);L=c(Ve,"DIV",{slot:!0,"data-svelte-h":!0}),re(L)!=="svelte-wl764p"&&(L.innerHTML=B),K=C(Ve),Q=c(Ve,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),re(Q)!=="svelte-i9crym"&&(Q.textContent=X),x=C(Ve),ie=c(Ve,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),re(ie)!=="svelte-fx0z11"&&(ie.textContent=se),pe=C(Ve),ue=c(Ve,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),re(ue)!=="svelte-1c24jf2"&&(ue.textContent=fe),Ve.forEach(a),et.forEach(a),Oe=C(he),de=c(he,"ION-ITEM",{});var tt=m(de);ge=c(tt,"ION-ICON",{icon:!0,slot:!0}),m(ge).forEach(a),Ne=C(tt),be=c(tt,"ION-TEXTAREA",{label:!0,placeholder:!0}),m(be).forEach(a),tt.forEach(a),Te=C(he),Ie=c(he,"SECTION",{});var ht=m(Ie);_e=c(ht,"LABEL",{for:!0,style:!0});var pt=m(_e);ke=c(pt,"ION-BUTTON",{fill:!0,size:!0,class:!0,expand:!0});var nt=m(ke);q=c(nt,"LABEL",{for:!0,style:!0,"data-svelte-h":!0}),re(q)!=="svelte-1m9yw22"&&(q.innerHTML=$),V=C(nt),H=c(nt,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0}),nt.forEach(a),pt.forEach(a),ht.forEach(a),ee=C(he),U&&U.l(he),k=C(he),J&&J.l(he),he.forEach(a),oe.forEach(a),O=C(le),P=c(le,"ION-FOOTER",{});var mt=m(P);te=c(mt,"ION-TOOLBAR",{});var vt=m(te);ne=c(vt,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),re(ne)!=="svelte-1c7dl3f"&&(ne.textContent=A),vt.forEach(a),mt.forEach(a),this.h()},h(){v(n,"color","medium"),v(l,"slot","start"),v(d,"title",""),v(e,"translucent",""),v(p,"icon",Zt),v(p,"slot","start"),v(N,"label","Concepto"),v(N,"type","text"),v(N,"placeholder","Escribe aquí..."),v(N,"value",r[6]?r[6]:""),v(z,"icon",st),v(z,"slot","start"),v(j,"label","Cantidad"),v(j,"type","number"),v(j,"value",r[7]?r[7]:""),v(D,"icon",Cn),v(D,"slot","start"),Y(L,"slot","label"),v(Q,"value","cash"),v(ie,"value","card"),v(ue,"value","transfer"),v(M,"placeholder","Tipo de pago"),v(M,"value",r[8]?r[8]:""),v(ge,"icon",st),v(ge,"slot","start"),v(be,"label","Comentarios"),v(be,"placeholder","Escribe aquí..."),Y(q,"for","eventEvidence"),y(q,"width","100%"),y(q,"padding","8px"),y(H,"display","none"),Y(H,"id","eventEvidence"),Y(H,"name","fileToUpload"),Y(H,"type","file"),Y(H,"accept","image/*"),v(ke,"fill","outline"),v(ke,"size","small"),v(ke,"class","loadEvidence"),v(ke,"expand","block"),Y(_e,"for","eventEvidence"),y(_e,"display","block"),y(_e,"width","100%"),v(g,"fullscreen",""),v(ne,"fill","outline"),v(ne,"color","tertiary"),v(ne,"strong",""),y(ne,"width","99%"),y(ne,"height","auto")},m(le,Ee){W(le,e,Ee),o(e,t),o(t,l),o(l,n),o(t,u),o(t,d),W(le,b,Ee),W(le,g,Ee),o(g,h),o(h,f),o(f,p),o(f,E),o(f,N),r[12](N),o(h,w),o(h,R),o(R,z),o(R,G),o(R,j),r[13](j),o(h,F),o(h,S),o(S,D),o(S,I),o(S,M),o(M,L),o(M,K),o(M,Q),o(M,x),o(M,ie),o(M,pe),o(M,ue),r[14](M),o(h,Oe),o(h,de),o(de,ge),o(de,Ne),o(de,be),r[15](be),o(h,Te),o(h,Ie),o(Ie,_e),o(_e,ke),o(ke,q),o(ke,V),o(ke,H),o(h,ee),U&&U.m(h,null),o(h,k),J&&J.m(h,null),W(le,O,Ee),W(le,P,Ee),o(P,te),o(te,ne),Z||(ae=[ce(n,"click",r[10]),ce(H,"change",r[9]),ce(ne,"click",r[11])],Z=!0)},p(le,[Ee]){le[5]?U||(U=St(),U.c(),U.m(h,k)):U&&(U.d(1),U=null),le[0]?J?J.p(le,Ee):(J=Pt(le),J.c(),J.m(h,null)):J&&(J.d(1),J=null)},i:Le,o:Le,d(le){le&&(a(e),a(b),a(g),a(O),a(P)),r[12](null),r[13](null),r[14](null),r[15](null),U&&U.d(),J&&J.d(),Z=!1,Pe(ae)}}}function so(r,e,t){let l=it,n=document.querySelector("ion-modal"),i=n.componentProps.routeId,u=n.componentProps.ex_concept,d=n.componentProps.ex_amount,_=n.componentProps.ex_type,b=n.componentProps.id_expense,g="",h="",f="",p=0,E="",N="",w=!1;Qe(()=>{});const R=async(L,B)=>{await(await qe.create({header:L||"Error",message:B||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()},z=async L=>{t(5,w=!0);const K=L.target.files[0],Q=await G(K);if(Q){const X=new FormData;X.append("fileToUpload",Q);try{const x=await fetch(`${l}api/admin/manager/upload_img_driver.php`,{method:"POST",body:X});if(x.ok){const ie=await x.json();t(0,g=ie.img),h=ie.img_id}else console.error("File upload failed:",x.statusText)}catch(x){console.error("Error during file upload:",x)}finally{t(5,w=!1)}}},G=async L=>new Promise(B=>{const K=new FileReader;K.onload=Q=>{const X=new Image;X.src=Q.target.result,X.onload=()=>{const x=document.createElement("canvas"),ie=x.getContext("2d"),se=800,pe=600;let ue=X.width,fe=X.height;ue>se&&(fe*=se/ue,ue=se),fe>pe&&(ue*=pe/fe,fe=pe),x.width=ue,x.height=fe,ie.drawImage(X,0,0,ue,fe),x.toBlob(Oe=>{B(Oe)},"image/jpeg",.7)}},K.readAsDataURL(L)}),j=()=>{$e.dismiss()},F=()=>{var L=new Object;L.id_route=i,L.comments=E.value,L.type=f.value,L.img=g,L.img_id=h,L.amount=p.value,L.concept=N.value,L.status="done",L.id_expense=b||"null";const B=new FormData;for(const K in L)B.append(K,L[K]);!h||!g||!E.value||!p.value||!N.value?R("Datos incompletos","Llena los datos requeridos para completar el registro"):fetch(`${l}api/admin/expenses/add_expense.php`,{method:"POST",body:B}).then(K=>K.json()).then(K=>{j()}).catch(K=>{console.error("Error fetching data:",K)})};function S(L){De[L?"unshift":"push"](()=>{N=L,t(4,N)})}function D(L){De[L?"unshift":"push"](()=>{p=L,t(2,p)})}function I(L){De[L?"unshift":"push"](()=>{f=L,t(1,f)})}function M(L){De[L?"unshift":"push"](()=>{E=L,t(3,E)})}return[g,f,p,E,N,w,u,d,_,z,j,F,S,D,I,M]}class ut extends We{constructor(e){super(),Je(this,e,so,ao,Xe,{})}}function Bt(r,e,t){const l=r.slice();return l[7]=e[t],l}function co(r){let e,t="Cargar gasto",l,n;function i(...u){return r[4](r[7],...u)}return{c(){e=s("ion-button"),e.textContent=t,this.h()},l(u){e=c(u,"ION-BUTTON",{fill:!0,size:!0,"aria-selected":!0,"data-svelte-h":!0}),re(e)!=="svelte-175aelj"&&(e.textContent=t),this.h()},h(){v(e,"fill","outline"),v(e,"size","small"),v(e,"aria-selected","")},m(u,d){W(u,e,d),l||(n=ce(e,"click",i),l=!0)},p(u,d){r=u},d(u){u&&a(e),l=!1,n()}}}function uo(r){let e,t="Gasto completado";return{c(){e=s("ion-button"),e.textContent=t,this.h()},l(l){e=c(l,"ION-BUTTON",{fill:!0,size:!0,"aria-selected":!0,"data-svelte-h":!0}),re(e)!=="svelte-tlger7"&&(e.textContent=t),this.h()},h(){v(e,"fill","solid"),v(e,"size","small"),v(e,"aria-selected","")},m(l,n){W(l,e,n)},p:Le,d(l){l&&a(e)}}}function Ht(r,e){let t,l,n,i=e[7].concept+"",u,d,_;function b(f,p){return f[7].status=="done"?uo:co}let h=b(e)(e);return{key:r,first:null,c(){t=s("ion-item"),l=s("ion-label"),n=s("p"),u=me(i),d=T(),h.c(),_=T(),this.h()},l(f){t=c(f,"ION-ITEM",{});var p=m(t);l=c(p,"ION-LABEL",{style:!0});var E=m(l);n=c(E,"P",{style:!0});var N=m(n);u=ve(N,i),N.forEach(a),E.forEach(a),d=C(p),h.l(p),_=C(p),p.forEach(a),this.h()},h(){y(n,"margin-left","10px"),y(l,"display","flex"),this.first=t},m(f,p){W(f,t,p),o(t,l),o(l,n),o(n,u),o(t,d),h.m(t,null),o(t,_)},p(f,p){e=f,h.p(e,p)},d(f){f&&a(t),h.d()}}}function fo(r){let e,t,l,n,i=`<ion-icon style="font-size: 25px!important;" icon="${yn}"></ion-icon>`,u,d,_="LISTA DE GASTOS",b,g,h,f=[],p=new Map,E,N,w,R="Cerrar",z,G,j=He(r[0]);const F=S=>S[7].id_expenses;for(let S=0;S<j.length;S+=1){let D=Bt(r,j,S),I=F(D);p.set(I,f[S]=Ht(I,D))}return{c(){e=s("ion-header"),t=s("ion-toolbar"),l=s("ion-buttons"),n=s("ion-button"),n.innerHTML=i,u=T(),d=s("ion-title"),d.textContent=_,b=T(),g=s("ion-content"),h=s("ion-list");for(let S=0;S<f.length;S+=1)f[S].c();E=T(),N=s("ion-footer"),w=s("ion-button"),w.textContent=R,this.h()},l(S){e=c(S,"ION-HEADER",{translucent:!0});var D=m(e);t=c(D,"ION-TOOLBAR",{});var I=m(t);l=c(I,"ION-BUTTONS",{slot:!0});var M=m(l);n=c(M,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),re(n)!=="svelte-160xz3i"&&(n.innerHTML=i),M.forEach(a),u=C(I),d=c(I,"ION-TITLE",{"data-svelte-h":!0}),re(d)!=="svelte-1phn90x"&&(d.textContent=_),I.forEach(a),D.forEach(a),b=C(S),g=c(S,"ION-CONTENT",{fullscreen:!0});var L=m(g);h=c(L,"ION-LIST",{});var B=m(h);for(let Q=0;Q<f.length;Q+=1)f[Q].l(B);B.forEach(a),L.forEach(a),E=C(S),N=c(S,"ION-FOOTER",{});var K=m(N);w=c(K,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),re(w)!=="svelte-zv7v83"&&(w.textContent=R),K.forEach(a),this.h()},h(){v(n,"color","medium"),v(l,"slot","end"),v(e,"translucent",""),v(g,"fullscreen",""),v(w,"fill","outline"),v(w,"color","tertiary"),v(w,"strong",""),y(w,"width","99%"),y(w,"height","auto")},m(S,D){W(S,e,D),o(e,t),o(t,l),o(l,n),o(t,u),o(t,d),W(S,b,D),W(S,g,D),o(g,h);for(let I=0;I<f.length;I+=1)f[I]&&f[I].m(h,null);W(S,E,D),W(S,N,D),o(N,w),z||(G=[ce(n,"click",r[3]),ce(w,"click",r[1])],z=!0)},p(S,[D]){D&5&&(j=He(S[0]),f=Ze(f,D,F,1,S,j,p,h,xe,Ht,null,Bt))},i:Le,o:Le,d(S){S&&(a(e),a(b),a(g),a(E),a(N));for(let D=0;D<f.length;D+=1)f[D].d();z=!1,Pe(G)}}}function _o(r){let e=document.querySelector("ion-modal");e.componentProps.routeId;let t=e.componentProps.expenses;Qe(()=>{});const l=()=>{$e.dismiss()};function n(d,_,b,g,h){e.componentProps.ex_amount=b,e.componentProps.ex_concept=_,e.componentProps.ex_type=g,e.componentProps.id_expense=h,Ue("modal-expense",ut,{amount:b,concept:_,type:g,id_expense:h}).then(()=>{}),l()}return[t,l,n,d=>{Ue("modal-expense",ut,{routeId:d}).then(_=>{}),l()},(d,_)=>n(_,d.concept,d.amount,d.type,d.id_expenses)]}class ho extends We{constructor(e){super(),Je(this,e,_o,fo,Xe,{})}}const{document:Rt}=Sn;function Ut(r,e,t){const l=r.slice();return l[44]=e[t],l[46]=t,l}function Vt(r,e,t){const l=r.slice();return l[44]=e[t],l[46]=t,l}function Ft(r,e,t){const l=r.slice();return l[44]=e[t],l[46]=t,l}function qt(r){let e,t;return e=new Mn({props:{$$slots:{default:[Io]},$$scope:{ctx:r}}}),{c(){fn(e.$$.fragment)},l(l){dn(e.$$.fragment,l)},m(l,n){_n(e,l,n),t=!0},p(l,n){const i={};n[0]&1019|n[1]&262144&&(i.$$scope={dirty:n,ctx:l}),e.$set(i)},i(l){t||(lt(e.$$.fragment,l),t=!0)},o(l){at(e.$$.fragment,l),t=!1},d(l){hn(e,l)}}}function po(r){let e,t='<div id="g_map" style="width: 100%; height: 100vh;"></div>';return{c(){e=s("ion-content"),e.innerHTML=t},l(l){e=c(l,"ION-CONTENT",{"data-svelte-h":!0}),re(e)!=="svelte-1ydw6i9"&&(e.innerHTML=t)},m(l,n){W(l,e,n)},p:Le,d(l){l&&a(e)}}}function mo(r){let e;function t(i,u){if(i[7].length>0)return go;if(!i[3])return vo}let l=t(r),n=l&&l(r);return{c(){n&&n.c(),e=Ae()},l(i){n&&n.l(i),e=Ae()},m(i,u){n&&n.m(i,u),W(i,e,u)},p(i,u){l===(l=t(i))&&n?n.p(i,u):(n&&n.d(1),n=l&&l(i),n&&(n.c(),n.m(e.parentNode,e)))},d(i){i&&a(e),n&&n.d(i)}}}function vo(r){let e,t,l,n='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Jala para actualizar" refreshing-spinner="circles" refreshing-text="Actualizando..."></ion-refresher-content>',i,u,d,_,b,g,h="0",f,p,E,N,w,R=r[6].origin+"",z,G,j,F="",S,D,I,M=[],L=new Map,B,K,Q,X,x,ie=r[5].length+1+"",se,pe,ue,fe,Oe,de,ge=r[6].destination+"",Ne,be,Te,Ie="",_e,ke,q,$,V=r[4]&&jt(r),H=He(r[5]);const ee=k=>k[44].id_event;for(let k=0;k<H.length;k+=1){let O=Ut(r,H,k),P=ee(O);L.set(P,M[k]=Kt(P,O))}return{c(){V&&V.c(),e=T(),t=s("ion-content"),l=s("ion-refresher"),l.innerHTML=n,i=T(),u=s("ion-list"),d=s("ion-item"),_=s("ion-avatar"),b=s("div"),g=s("div"),g.textContent=h,p=T(),E=s("ion-label"),N=s("ion-text"),w=s("h3"),z=me(R),G=T(),j=s("div"),j.innerHTML=F,S=T(),D=s("ion-icon"),I=T();for(let k=0;k<M.length;k+=1)M[k].c();B=T(),K=s("ion-item"),Q=s("ion-avatar"),X=s("div"),x=s("div"),se=me(ie),ue=T(),fe=s("ion-label"),Oe=s("ion-text"),de=s("h3"),Ne=me(ge),be=T(),Te=s("div"),Te.innerHTML=Ie,_e=T(),ke=s("ion-icon"),this.h()},l(k){V&&V.l(k),e=C(k),t=c(k,"ION-CONTENT",{});var O=m(t);l=c(O,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),re(l)!=="svelte-1srnbs3"&&(l.innerHTML=n),i=C(O),u=c(O,"ION-LIST",{});var P=m(u);d=c(P,"ION-ITEM",{});var te=m(d);_=c(te,"ION-AVATAR",{slot:!0});var ne=m(_);b=c(ne,"DIV",{class:!0,title:!0,style:!0});var A=m(b);g=c(A,"DIV",{class:!0,"data-svelte-h":!0}),re(g)!=="svelte-3lvlrb"&&(g.textContent=h),A.forEach(a),ne.forEach(a),p=C(te),E=c(te,"ION-LABEL",{button:!0});var Z=m(E);N=c(Z,"ION-TEXT",{color:!0});var ae=m(N);w=c(ae,"H3",{});var U=m(w);z=ve(U,R),U.forEach(a),ae.forEach(a),G=C(Z),j=c(Z,"DIV",{class:!0,"data-svelte-h":!0}),re(j)!=="svelte-gz9kb"&&(j.innerHTML=F),Z.forEach(a),S=C(te),D=c(te,"ION-ICON",{icon:!0,slot:!0}),m(D).forEach(a),te.forEach(a),I=C(P);for(let ze=0;ze<M.length;ze+=1)M[ze].l(P);B=C(P),K=c(P,"ION-ITEM",{});var J=m(K);Q=c(J,"ION-AVATAR",{slot:!0});var le=m(Q);X=c(le,"DIV",{class:!0,title:!0,style:!0});var Ee=m(X);x=c(Ee,"DIV",{class:!0});var Ce=m(x);se=ve(Ce,ie),Ce.forEach(a),Ee.forEach(a),le.forEach(a),ue=C(J),fe=c(J,"ION-LABEL",{button:!0});var we=m(fe);Oe=c(we,"ION-TEXT",{color:!0});var oe=m(Oe);de=c(oe,"H3",{});var he=m(de);Ne=ve(he,ge),he.forEach(a),oe.forEach(a),be=C(we),Te=c(we,"DIV",{class:!0,"data-svelte-h":!0}),re(Te)!=="svelte-130ohbs"&&(Te.innerHTML=Ie),we.forEach(a),_e=C(J),ke=c(J,"ION-ICON",{icon:!0,slot:!0}),m(ke).forEach(a),J.forEach(a),P.forEach(a),O.forEach(a),this.h()},h(){v(l,"slot","fixed"),Y(g,"class","order svelte-egzizz"),Y(b,"class","order-wrapper svelte-egzizz"),Y(b,"title",f="$"+r[6].origin),y(b,"background-color",r[6].color),y(b,"color",Me(r[6].color)),v(_,"slot","start"),v(N,"color","#2e2e2e"),Y(j,"class","sub svelte-egzizz"),v(E,"button",""),v(D,"icon",Re),v(D,"slot","end"),Y(x,"class","order svelte-egzizz"),Y(X,"class","order-wrapper svelte-egzizz"),Y(X,"title",pe="$"+r[6].destination),y(X,"background-color",r[6].color),y(X,"color",Me(r[6].color)),v(Q,"slot","start"),v(Oe,"color","#2e2e2e"),Y(Te,"class","sub svelte-egzizz"),v(fe,"button",""),v(ke,"icon",Re),v(ke,"slot","end")},m(k,O){V&&V.m(k,O),W(k,e,O),W(k,t,O),o(t,l),r[30](l),o(t,i),o(t,u),o(u,d),o(d,_),o(_,b),o(b,g),o(d,p),o(d,E),o(E,N),o(N,w),o(w,z),o(E,G),o(E,j),o(d,S),o(d,D),o(u,I);for(let P=0;P<M.length;P+=1)M[P]&&M[P].m(u,null);o(u,B),o(u,K),o(K,Q),o(Q,X),o(X,x),o(x,se),o(K,ue),o(K,fe),o(fe,Oe),o(Oe,de),o(de,Ne),o(fe,be),o(fe,Te),o(K,_e),o(K,ke),q||($=[ce(l,"ionRefresh",r[10]),ce(E,"click",r[31]),ce(fe,"click",r[33])],q=!0)},p(k,O){k[4]?V?V.p(k,O):(V=jt(k),V.c(),V.m(e.parentNode,e)):V&&(V.d(1),V=null),O[0]&64&&f!==(f="$"+k[6].origin)&&Y(b,"title",f),O[0]&64&&y(b,"background-color",k[6].color),O[0]&64&&y(b,"color",Me(k[6].color)),O[0]&64&&R!==(R=k[6].origin+"")&&ye(z,R),O[0]&331808&&(H=He(k[5]),M=Ze(M,O,ee,1,k,H,L,u,xe,Kt,B,Ut)),O[0]&32&&ie!==(ie=k[5].length+1+"")&&ye(se,ie),O[0]&64&&pe!==(pe="$"+k[6].destination)&&Y(X,"title",pe),O[0]&64&&y(X,"background-color",k[6].color),O[0]&64&&y(X,"color",Me(k[6].color)),O[0]&64&&ge!==(ge=k[6].destination+"")&&ye(Ne,ge)},d(k){k&&(a(e),a(t)),V&&V.d(k),r[30](null);for(let O=0;O<M.length;O+=1)M[O].d();q=!1,Pe($)}}}function go(r){let e,t;function l(u,d){return d[0]&144&&(e=null),e==null&&(e=!!(u[7].filter(Oo).every(No)&&!u[4])),e?Eo:bo}let n=l(r,[-1,-1]),i=n(r);return{c(){i.c(),t=Ae()},l(u){i.l(u),t=Ae()},m(u,d){i.m(u,d),W(u,t,d)},p(u,d){n===(n=l(u,d))&&i?i.p(u,d):(i.d(1),i=n(u),i&&(i.c(),i.m(t.parentNode,t)))},d(u){u&&a(t),i.d(u)}}}function jt(r){let e=r[14]("",r[1],r[0])+"",t;return{c(){t=me(e)},l(l){t=ve(l,e)},m(l,n){W(l,t,n)},p(l,n){n[0]&3&&e!==(e=l[14]("",l[1],l[0])+"")&&ye(t,e)},d(l){l&&a(t)}}}function Gt(r){let e;return{c(){e=s("span"),this.h()},l(t){e=c(t,"SPAN",{class:!0}),m(e).forEach(a),this.h()},h(){Y(e,"class","notes svelte-egzizz")},m(t,l){W(t,e,l)},d(t){t&&a(e)}}}function Kt(r,e){let t,l,n,i,u=parseInt(e[44].pos)+1+"",d,_,b,g,h,f,p=e[44].title+"",E,N,w=e[44].support_list&&e[44].support_list.length||e[16](e[44]),R,z,G,j,F=w&&Gt();function S(){return e[32](e[44])}return{key:r,first:null,c(){t=s("ion-item"),l=s("ion-avatar"),n=s("div"),i=s("div"),d=me(u),b=T(),g=s("ion-label"),h=s("ion-text"),f=s("h3"),E=me(p),N=T(),F&&F.c(),R=T(),z=s("ion-icon"),this.h()},l(D){t=c(D,"ION-ITEM",{});var I=m(t);l=c(I,"ION-AVATAR",{slot:!0});var M=m(l);n=c(M,"DIV",{class:!0,title:!0,style:!0});var L=m(n);i=c(L,"DIV",{class:!0});var B=m(i);d=ve(B,u),B.forEach(a),L.forEach(a),M.forEach(a),b=C(I),g=c(I,"ION-LABEL",{button:!0});var K=m(g);h=c(K,"ION-TEXT",{color:!0});var Q=m(h);f=c(Q,"H3",{});var X=m(f);E=ve(X,p),N=C(X),F&&F.l(X),X.forEach(a),Q.forEach(a),K.forEach(a),R=C(I),z=c(I,"ION-ICON",{icon:!0,slot:!0,style:!0}),m(z).forEach(a),I.forEach(a),this.h()},h(){Y(i,"class","order svelte-egzizz"),Y(n,"class","order-wrapper svelte-egzizz"),Y(n,"title",_=Ke(e[44].status)),y(n,"background-color",Se(e[44].status,e[44].date_service)),y(n,"color",Me(Se(e[44].status))),v(l,"slot","start"),v(h,"color","#2e2e2e"),v(g,"button",""),v(z,"icon",Re),v(z,"slot","end"),y(z,"color",Se(e[44].status,e[44].date_service)),this.first=t},m(D,I){W(D,t,I),o(t,l),o(l,n),o(n,i),o(i,d),o(t,b),o(t,g),o(g,h),o(h,f),o(f,E),o(f,N),F&&F.m(f,null),o(t,R),o(t,z),G||(j=ce(g,"click",S),G=!0)},p(D,I){e=D,I[0]&32&&u!==(u=parseInt(e[44].pos)+1+"")&&ye(d,u),I[0]&32&&_!==(_=Ke(e[44].status))&&Y(n,"title",_),I[0]&32&&y(n,"background-color",Se(e[44].status,e[44].date_service)),I[0]&32&&y(n,"color",Me(Se(e[44].status))),I[0]&32&&p!==(p=e[44].title+"")&&ye(E,p),I[0]&32&&(w=e[44].support_list&&e[44].support_list.length||e[16](e[44])),w?F||(F=Gt(),F.c(),F.m(f,null)):F&&(F.d(1),F=null),I[0]&32&&y(z,"color",Se(e[44].status,e[44].date_service))},d(D){D&&a(t),F&&F.d(),G=!1,j()}}}function bo(r){let e=r[14](r[7],r[1],r[0])+"",t,l,n,i,u='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Pull to refresh" refreshing-spinner="circles" refreshing-text="Refreshing..."></ion-refresher-content>',d,_,b,g,h,f,p="0",E,N,w,R,z,G=r[6].origin+"",j,F,S,D="",I,M,L,B=[],K=new Map,Q,X,x,ie,se,pe=r[5].length+1+"",ue,fe,Oe,de,ge,Ne,be=r[6].destination+"",Te,Ie,_e,ke="",q,$,V,H,ee=He(r[5]);const k=O=>O[44].id_event;for(let O=0;O<ee.length;O+=1){let P=Vt(r,ee,O),te=k(P);K.set(te,B[O]=Wt(te,P))}return{c(){t=me(e),l=T(),n=s("ion-content"),i=s("ion-refresher"),i.innerHTML=u,d=T(),_=s("ion-list"),b=s("ion-item"),g=s("ion-avatar"),h=s("div"),f=s("div"),f.textContent=p,N=T(),w=s("ion-label"),R=s("ion-text"),z=s("h3"),j=me(G),F=T(),S=s("div"),S.innerHTML=D,I=T(),M=s("ion-icon"),L=T();for(let O=0;O<B.length;O+=1)B[O].c();Q=T(),X=s("ion-item"),x=s("ion-avatar"),ie=s("div"),se=s("div"),ue=me(pe),Oe=T(),de=s("ion-label"),ge=s("ion-text"),Ne=s("h3"),Te=me(be),Ie=T(),_e=s("div"),_e.innerHTML=ke,q=T(),$=s("ion-icon"),this.h()},l(O){t=ve(O,e),l=C(O),n=c(O,"ION-CONTENT",{});var P=m(n);i=c(P,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),re(i)!=="svelte-dvt1s"&&(i.innerHTML=u),d=C(P),_=c(P,"ION-LIST",{});var te=m(_);b=c(te,"ION-ITEM",{});var ne=m(b);g=c(ne,"ION-AVATAR",{slot:!0});var A=m(g);h=c(A,"DIV",{class:!0,title:!0,style:!0});var Z=m(h);f=c(Z,"DIV",{class:!0,"data-svelte-h":!0}),re(f)!=="svelte-3lvlrb"&&(f.textContent=p),Z.forEach(a),A.forEach(a),N=C(ne),w=c(ne,"ION-LABEL",{button:!0});var ae=m(w);R=c(ae,"ION-TEXT",{color:!0});var U=m(R);z=c(U,"H3",{});var J=m(z);j=ve(J,G),J.forEach(a),U.forEach(a),F=C(ae),S=c(ae,"DIV",{class:!0,"data-svelte-h":!0}),re(S)!=="svelte-gz9kb"&&(S.innerHTML=D),ae.forEach(a),I=C(ne),M=c(ne,"ION-ICON",{icon:!0,slot:!0}),m(M).forEach(a),ne.forEach(a),L=C(te);for(let Be=0;Be<B.length;Be+=1)B[Be].l(te);Q=C(te),X=c(te,"ION-ITEM",{});var le=m(X);x=c(le,"ION-AVATAR",{slot:!0});var Ee=m(x);ie=c(Ee,"DIV",{class:!0,title:!0,style:!0});var Ce=m(ie);se=c(Ce,"DIV",{class:!0});var we=m(se);ue=ve(we,pe),we.forEach(a),Ce.forEach(a),Ee.forEach(a),Oe=C(le),de=c(le,"ION-LABEL",{button:!0});var oe=m(de);ge=c(oe,"ION-TEXT",{color:!0});var he=m(ge);Ne=c(he,"H3",{});var ze=m(Ne);Te=ve(ze,be),ze.forEach(a),he.forEach(a),Ie=C(oe),_e=c(oe,"DIV",{class:!0,"data-svelte-h":!0}),re(_e)!=="svelte-130ohbs"&&(_e.innerHTML=ke),oe.forEach(a),q=C(le),$=c(le,"ION-ICON",{icon:!0,slot:!0}),m($).forEach(a),le.forEach(a),te.forEach(a),P.forEach(a),this.h()},h(){v(i,"slot","fixed"),Y(f,"class","order svelte-egzizz"),Y(h,"class","order-wrapper svelte-egzizz"),Y(h,"title",E="$"+r[6].origin),y(h,"background-color",r[6].color),y(h,"color",Me(r[6].color)),v(g,"slot","start"),v(R,"color","#2e2e2e"),Y(S,"class","sub svelte-egzizz"),v(w,"button",""),v(M,"icon",Re),v(M,"slot","end"),Y(se,"class","order svelte-egzizz"),Y(ie,"class","order-wrapper svelte-egzizz"),Y(ie,"title",fe="$"+r[6].destination),y(ie,"background-color",r[6].color),y(ie,"color",Me(r[6].color)),v(x,"slot","start"),v(ge,"color","#2e2e2e"),Y(_e,"class","sub svelte-egzizz"),v(de,"button",""),v($,"icon",Re),v($,"slot","end")},m(O,P){W(O,t,P),W(O,l,P),W(O,n,P),o(n,i),r[26](i),o(n,d),o(n,_),o(_,b),o(b,g),o(g,h),o(h,f),o(b,N),o(b,w),o(w,R),o(R,z),o(z,j),o(w,F),o(w,S),o(b,I),o(b,M),o(_,L);for(let te=0;te<B.length;te+=1)B[te]&&B[te].m(_,null);o(_,Q),o(_,X),o(X,x),o(x,ie),o(ie,se),o(se,ue),o(X,Oe),o(X,de),o(de,ge),o(ge,Ne),o(Ne,Te),o(de,Ie),o(de,_e),o(X,q),o(X,$),V||(H=[ce(i,"ionRefresh",r[10]),ce(w,"click",r[27]),ce(de,"click",r[29])],V=!0)},p(O,P){P[0]&131&&e!==(e=O[14](O[7],O[1],O[0])+"")&&ye(t,e),P[0]&64&&E!==(E="$"+O[6].origin)&&Y(h,"title",E),P[0]&64&&y(h,"background-color",O[6].color),P[0]&64&&y(h,"color",Me(O[6].color)),P[0]&64&&G!==(G=O[6].origin+"")&&ye(j,G),P[0]&331808&&(ee=He(O[5]),B=Ze(B,P,k,1,O,ee,K,_,xe,Wt,Q,Vt)),P[0]&32&&pe!==(pe=O[5].length+1+"")&&ye(ue,pe),P[0]&64&&fe!==(fe="$"+O[6].destination)&&Y(ie,"title",fe),P[0]&64&&y(ie,"background-color",O[6].color),P[0]&64&&y(ie,"color",Me(O[6].color)),P[0]&64&&be!==(be=O[6].destination+"")&&ye(Te,be)},d(O){O&&(a(t),a(l),a(n)),r[26](null);for(let P=0;P<B.length;P+=1)B[P].d();V=!1,Pe(H)}}}function Eo(r){let e,t,l='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Jale para actualizar" refreshing-spinner="circles" refreshing-text="Actualizando..."></ion-refresher-content>',n,i,u,d,_,b,g="0",h,f,p,E,N,w=r[6].origin+"",R,z,G,j="",F,S,D,I=[],M=new Map,L,B,K,Q,X,x=r[5].length+1+"",ie,se,pe,ue,fe,Oe,de=r[6].destination+"",ge,Ne,be,Te="",Ie,_e,ke,q,$=He(r[5]);const V=H=>H[44].id_event;for(let H=0;H<$.length;H+=1){let ee=Ft(r,$,H),k=V(ee);M.set(k,I[H]=Yt(k,ee))}return{c(){e=s("ion-content"),t=s("ion-refresher"),t.innerHTML=l,n=T(),i=s("ion-list"),u=s("ion-item"),d=s("ion-avatar"),_=s("div"),b=s("div"),b.textContent=g,f=T(),p=s("ion-label"),E=s("ion-text"),N=s("h3"),R=me(w),z=T(),G=s("div"),G.innerHTML=j,F=T(),S=s("ion-icon"),D=T();for(let H=0;H<I.length;H+=1)I[H].c();L=T(),B=s("ion-item"),K=s("ion-avatar"),Q=s("div"),X=s("div"),ie=me(x),pe=T(),ue=s("ion-label"),fe=s("ion-text"),Oe=s("h3"),ge=me(de),Ne=T(),be=s("div"),be.innerHTML=Te,Ie=T(),_e=s("ion-icon"),this.h()},l(H){e=c(H,"ION-CONTENT",{});var ee=m(e);t=c(ee,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),re(t)!=="svelte-15ukrgn"&&(t.innerHTML=l),n=C(ee),i=c(ee,"ION-LIST",{});var k=m(i);u=c(k,"ION-ITEM",{});var O=m(u);d=c(O,"ION-AVATAR",{slot:!0});var P=m(d);_=c(P,"DIV",{class:!0,title:!0,style:!0});var te=m(_);b=c(te,"DIV",{class:!0,"data-svelte-h":!0}),re(b)!=="svelte-3lvlrb"&&(b.textContent=g),te.forEach(a),P.forEach(a),f=C(O),p=c(O,"ION-LABEL",{button:!0});var ne=m(p);E=c(ne,"ION-TEXT",{color:!0});var A=m(E);N=c(A,"H3",{});var Z=m(N);R=ve(Z,w),Z.forEach(a),A.forEach(a),z=C(ne),G=c(ne,"DIV",{class:!0,"data-svelte-h":!0}),re(G)!=="svelte-gz9kb"&&(G.innerHTML=j),ne.forEach(a),F=C(O),S=c(O,"ION-ICON",{icon:!0,slot:!0}),m(S).forEach(a),O.forEach(a),D=C(k);for(let oe=0;oe<I.length;oe+=1)I[oe].l(k);L=C(k),B=c(k,"ION-ITEM",{});var ae=m(B);K=c(ae,"ION-AVATAR",{slot:!0});var U=m(K);Q=c(U,"DIV",{class:!0,title:!0,style:!0});var J=m(Q);X=c(J,"DIV",{class:!0});var le=m(X);ie=ve(le,x),le.forEach(a),J.forEach(a),U.forEach(a),pe=C(ae),ue=c(ae,"ION-LABEL",{button:!0});var Ee=m(ue);fe=c(Ee,"ION-TEXT",{color:!0});var Ce=m(fe);Oe=c(Ce,"H3",{});var we=m(Oe);ge=ve(we,de),we.forEach(a),Ce.forEach(a),Ne=C(Ee),be=c(Ee,"DIV",{class:!0,"data-svelte-h":!0}),re(be)!=="svelte-130ohbs"&&(be.innerHTML=Te),Ee.forEach(a),Ie=C(ae),_e=c(ae,"ION-ICON",{icon:!0,slot:!0}),m(_e).forEach(a),ae.forEach(a),k.forEach(a),ee.forEach(a),this.h()},h(){v(t,"slot","fixed"),Y(b,"class","order svelte-egzizz"),Y(_,"class","order-wrapper svelte-egzizz"),Y(_,"title",h="$"+r[6].origin),y(_,"background-color",r[6].color),y(_,"color",Me(r[6].color)),v(d,"slot","start"),v(E,"color","#2e2e2e"),Y(G,"class","sub svelte-egzizz"),v(p,"button",""),v(S,"icon",Re),v(S,"slot","end"),Y(X,"class","order svelte-egzizz"),Y(Q,"class","order-wrapper svelte-egzizz"),Y(Q,"title",se="$"+r[6].destination),y(Q,"background-color",r[6].color),y(Q,"color",Me(r[6].color)),v(K,"slot","start"),v(fe,"color","#2e2e2e"),Y(be,"class","sub svelte-egzizz"),v(ue,"button",""),v(_e,"icon",Re),v(_e,"slot","end")},m(H,ee){W(H,e,ee),o(e,t),r[22](t),o(e,n),o(e,i),o(i,u),o(u,d),o(d,_),o(_,b),o(u,f),o(u,p),o(p,E),o(E,N),o(N,R),o(p,z),o(p,G),o(u,F),o(u,S),o(i,D);for(let k=0;k<I.length;k+=1)I[k]&&I[k].m(i,null);o(i,L),o(i,B),o(B,K),o(K,Q),o(Q,X),o(X,ie),o(B,pe),o(B,ue),o(ue,fe),o(fe,Oe),o(Oe,ge),o(ue,Ne),o(ue,be),o(B,Ie),o(B,_e),ke||(q=[ce(t,"ionRefresh",r[10]),ce(p,"click",r[23]),ce(ue,"click",r[25])],ke=!0)},p(H,ee){ee[0]&64&&h!==(h="$"+H[6].origin)&&Y(_,"title",h),ee[0]&64&&y(_,"background-color",H[6].color),ee[0]&64&&y(_,"color",Me(H[6].color)),ee[0]&64&&w!==(w=H[6].origin+"")&&ye(R,w),ee[0]&331808&&($=He(H[5]),I=Ze(I,ee,V,1,H,$,M,i,xe,Yt,L,Ft)),ee[0]&32&&x!==(x=H[5].length+1+"")&&ye(ie,x),ee[0]&64&&se!==(se="$"+H[6].destination)&&Y(Q,"title",se),ee[0]&64&&y(Q,"background-color",H[6].color),ee[0]&64&&y(Q,"color",Me(H[6].color)),ee[0]&64&&de!==(de=H[6].destination+"")&&ye(ge,de)},d(H){H&&a(e),r[22](null);for(let ee=0;ee<I.length;ee+=1)I[ee].d();ke=!1,Pe(q)}}}function Xt(r){let e;return{c(){e=s("span"),this.h()},l(t){e=c(t,"SPAN",{class:!0}),m(e).forEach(a),this.h()},h(){Y(e,"class","notes svelte-egzizz")},m(t,l){W(t,e,l)},d(t){t&&a(e)}}}function Wt(r,e){let t,l,n,i,u=parseInt(e[44].pos)+1+"",d,_,b,g,h,f,p=e[44].title+"",E,N,w=e[44].support_list&&e[44].support_list.length||e[16](e[44]),R,z,G="",j,F,S,D,I=w&&Xt();function M(){return e[28](e[44])}return{key:r,first:null,c(){t=s("ion-item"),l=s("ion-avatar"),n=s("div"),i=s("div"),d=me(u),b=T(),g=s("ion-label"),h=s("ion-text"),f=s("h3"),E=me(p),N=T(),I&&I.c(),R=T(),z=s("div"),z.innerHTML=G,j=T(),F=s("ion-icon"),this.h()},l(L){t=c(L,"ION-ITEM",{});var B=m(t);l=c(B,"ION-AVATAR",{slot:!0});var K=m(l);n=c(K,"DIV",{class:!0,title:!0,style:!0});var Q=m(n);i=c(Q,"DIV",{class:!0});var X=m(i);d=ve(X,u),X.forEach(a),Q.forEach(a),K.forEach(a),b=C(B),g=c(B,"ION-LABEL",{button:!0});var x=m(g);h=c(x,"ION-TEXT",{color:!0});var ie=m(h);f=c(ie,"H3",{});var se=m(f);E=ve(se,p),N=C(se),I&&I.l(se),se.forEach(a),ie.forEach(a),R=C(x),z=c(x,"DIV",{class:!0,"data-svelte-h":!0}),re(z)!=="svelte-qaecoo"&&(z.innerHTML=G),x.forEach(a),j=C(B),F=c(B,"ION-ICON",{icon:!0,slot:!0}),m(F).forEach(a),B.forEach(a),this.h()},h(){Y(i,"class","order svelte-egzizz"),Y(n,"class","order-wrapper svelte-egzizz"),Y(n,"title",_=Ke(e[44].status)),y(n,"background-color",Se(e[44].status,e[44].date_service)),y(n,"color",Me(Se(e[44].status))),v(l,"slot","start"),v(h,"color","#2e2e2e"),Y(z,"class","sub svelte-egzizz"),v(g,"button",""),v(F,"icon",Re),v(F,"slot","end"),this.first=t},m(L,B){W(L,t,B),o(t,l),o(l,n),o(n,i),o(i,d),o(t,b),o(t,g),o(g,h),o(h,f),o(f,E),o(f,N),I&&I.m(f,null),o(g,R),o(g,z),o(t,j),o(t,F),S||(D=ce(g,"click",M),S=!0)},p(L,B){e=L,B[0]&32&&u!==(u=parseInt(e[44].pos)+1+"")&&ye(d,u),B[0]&32&&_!==(_=Ke(e[44].status))&&Y(n,"title",_),B[0]&32&&y(n,"background-color",Se(e[44].status,e[44].date_service)),B[0]&32&&y(n,"color",Me(Se(e[44].status))),B[0]&32&&p!==(p=e[44].title+"")&&ye(E,p),B[0]&32&&(w=e[44].support_list&&e[44].support_list.length||e[16](e[44])),w?I||(I=Xt(),I.c(),I.m(f,null)):I&&(I.d(1),I=null)},d(L){L&&a(t),I&&I.d(),S=!1,D()}}}function Jt(r){let e;return{c(){e=s("span"),this.h()},l(t){e=c(t,"SPAN",{class:!0}),m(e).forEach(a),this.h()},h(){Y(e,"class","notes svelte-egzizz")},m(t,l){W(t,e,l)},d(t){t&&a(e)}}}function Yt(r,e){let t,l,n,i,u=parseInt(e[44].pos)+1+"",d,_,b,g,h,f,p=e[44].title+"",E,N,w=e[44].support_list&&e[44].support_list.length||e[16](e[44]),R,z,G="",j,F,S,D,I=w&&Jt();function M(){return e[24](e[44])}return{key:r,first:null,c(){t=s("ion-item"),l=s("ion-avatar"),n=s("div"),i=s("div"),d=me(u),b=T(),g=s("ion-label"),h=s("ion-text"),f=s("h3"),E=me(p),N=T(),I&&I.c(),R=T(),z=s("div"),z.innerHTML=G,j=T(),F=s("ion-icon"),this.h()},l(L){t=c(L,"ION-ITEM",{});var B=m(t);l=c(B,"ION-AVATAR",{slot:!0});var K=m(l);n=c(K,"DIV",{class:!0,title:!0,style:!0});var Q=m(n);i=c(Q,"DIV",{class:!0});var X=m(i);d=ve(X,u),X.forEach(a),Q.forEach(a),K.forEach(a),b=C(B),g=c(B,"ION-LABEL",{button:!0});var x=m(g);h=c(x,"ION-TEXT",{color:!0});var ie=m(h);f=c(ie,"H3",{});var se=m(f);E=ve(se,p),N=C(se),I&&I.l(se),se.forEach(a),ie.forEach(a),R=C(x),z=c(x,"DIV",{class:!0,"data-svelte-h":!0}),re(z)!=="svelte-qaecoo"&&(z.innerHTML=G),x.forEach(a),j=C(B),F=c(B,"ION-ICON",{icon:!0,slot:!0}),m(F).forEach(a),B.forEach(a),this.h()},h(){Y(i,"class","order svelte-egzizz"),Y(n,"class","order-wrapper svelte-egzizz"),Y(n,"title",_=Ke(e[44].status)),y(n,"background-color",Se(e[44].status,e[44].date_service)),y(n,"color",Me(Se(e[44].status))),v(l,"slot","start"),v(h,"color","#2e2e2e"),Y(z,"class","sub svelte-egzizz"),v(g,"button",""),v(F,"icon",Re),v(F,"slot","end"),this.first=t},m(L,B){W(L,t,B),o(t,l),o(l,n),o(n,i),o(i,d),o(t,b),o(t,g),o(g,h),o(h,f),o(f,E),o(f,N),I&&I.m(f,null),o(g,R),o(g,z),o(t,j),o(t,F),S||(D=ce(g,"click",M),S=!0)},p(L,B){e=L,B[0]&32&&u!==(u=parseInt(e[44].pos)+1+"")&&ye(d,u),B[0]&32&&_!==(_=Ke(e[44].status))&&Y(n,"title",_),B[0]&32&&y(n,"background-color",Se(e[44].status,e[44].date_service)),B[0]&32&&y(n,"color",Me(Se(e[44].status))),B[0]&32&&p!==(p=e[44].title+"")&&ye(E,p),B[0]&32&&(w=e[44].support_list&&e[44].support_list.length||e[16](e[44])),w?I||(I=Jt(),I.c(),I.m(f,null)):I&&(I.d(1),I=null)},d(L){L&&a(t),I&&I.d(),S=!1,D()}}}function Io(r){let e,t,l,n,i=`<ion-icon icon="${wn}"></ion-icon>`,u,d,_,b=`<ion-icon icon="${Ln}"></ion-icon>`,g,h,f=(r[6].name?r[6].name.toUpperCase():"")+"",p,E,N,w='<ion-segment-button value="list"><ion-label>Paradas</ion-label></ion-segment-button> <ion-segment-button value="map"><ion-label>Mapa</ion-label></ion-segment-button>',R,z,G,j;function F(I,M){if(I[9]==="list")return mo;if(I[9]==="map")return po}let S=F(r),D=S&&S(r);return{c(){e=s("ion-header"),t=s("ion-toolbar"),l=s("ion-buttons"),n=s("ion-button"),n.innerHTML=i,u=T(),d=s("ion-buttons"),_=s("ion-button"),_.innerHTML=b,g=T(),h=s("ion-title"),p=me(f),E=T(),N=s("ion-segment"),N.innerHTML=w,R=T(),D&&D.c(),z=Ae(),this.h()},l(I){e=c(I,"ION-HEADER",{translucent:!0});var M=m(e);t=c(M,"ION-TOOLBAR",{});var L=m(t);l=c(L,"ION-BUTTONS",{slot:!0});var B=m(l);n=c(B,"ION-BUTTON",{title:!0,alt:!0,"data-svelte-h":!0}),re(n)!=="svelte-7ppz3r"&&(n.innerHTML=i),B.forEach(a),u=C(L),d=c(L,"ION-BUTTONS",{slot:!0});var K=m(d);_=c(K,"ION-BUTTON",{"data-svelte-h":!0}),re(_)!=="svelte-nf50hj"&&(_.innerHTML=b),K.forEach(a),g=C(L),h=c(L,"ION-TITLE",{});var Q=m(h);p=ve(Q,f),Q.forEach(a),L.forEach(a),E=C(M),N=c(M,"ION-SEGMENT",{value:!0,"data-svelte-h":!0}),re(N)!=="svelte-lue4c9"&&(N.innerHTML=w),M.forEach(a),R=C(I),D&&D.l(I),z=Ae(),this.h()},h(){v(n,"title","Atrás"),v(n,"alt","Atrás"),v(l,"slot","start"),v(d,"slot","end"),v(N,"value","list"),v(e,"translucent","")},m(I,M){W(I,e,M),o(e,t),o(t,l),o(l,n),o(t,u),o(t,d),o(d,_),o(t,g),o(t,h),o(h,p),o(e,E),o(e,N),W(I,R,M),D&&D.m(I,M),W(I,z,M),G||(j=[ce(n,"click",r[17]),ce(_,"click",r[20]),ce(N,"ionChange",r[21])],G=!0)},p(I,M){M[0]&64&&f!==(f=(I[6].name?I[6].name.toUpperCase():"")+"")&&ye(p,f),S===(S=F(I))&&D?D.p(I,M):(D&&D.d(1),D=S&&S(I),D&&(D.c(),D.m(z.parentNode,z)))},d(I){I&&(a(e),a(R),a(z)),D&&D.d(I),G=!1,Pe(j)}}}function ko(r){let e,t,l,n=r[2]&&qt(r);return{c(){e=T(),n&&n.c(),t=Ae(),this.h()},l(i){an("svelte-kn0kph",Rt.head).forEach(a),e=C(i),n&&n.l(i),t=Ae(),this.h()},h(){Rt.title="Rutaflow - Detalles de ruta"},m(i,u){W(i,e,u),n&&n.m(i,u),W(i,t,u),l=!0},p(i,u){i[2]?n?(n.p(i,u),u[0]&4&&lt(n,1)):(n=qt(i),n.c(),lt(n,1),n.m(t.parentNode,t)):n&&(pn(),at(n,1,1,()=>{n=null}),un())},i(i){l||(lt(n),l=!0)},o(i){at(n),l=!1},d(i){i&&(a(e),a(t)),n&&n.d(i)}}}function Se(r,e=""){let t="#ffffff";return r==="pending"&&!e?t="#f2e300":r=="pending"&&e?t="#F6A833":r==="completed"&&(t="#44d900"),t}function Ke(r){let e="";return r=="pending"?e="Pendiente":r=="completed"&&(e="Completado"),e}function Me(r){r.slice(0,1)==="#"&&(r=r.slice(1)),r.length===3&&(r=r.split("").map(function(i){return i+i}).join(""));const e=parseInt(r.substr(0,2),16),t=parseInt(r.substr(2,2),16),l=parseInt(r.substr(4,2),16);return(e*299+t*587+l*114)/1e3>=128?"#414040":"#fff"}const Oo=r=>r.mandatory==="1",No=r=>r.img;function To(r,e,t){let l;sn(r,zn,q=>t(19,l=q));var n=this&&this.__awaiter||function(q,$,V,H){function ee(k){return k instanceof V?k:new V(function(O){O(k)})}return new(V||(V=Promise))(function(k,O){function P(A){try{ne(H.next(A))}catch(Z){O(Z)}}function te(A){try{ne(H.throw(A))}catch(Z){O(Z)}}function ne(A){A.done?k(A.value):ee(A.value).then(P,te)}ne((H=H.apply(q,$||[])).next())})};let{routeId:i}=e,{driverId:u}=e,d=it,_=new Object,b=!0,g=!1,h=[],f={},p=[],E=[],N,w=!1,R="list",z;const G=()=>n(void 0,void 0,void 0,function*(){yield S(i),N.complete()});Qe(()=>n(void 0,void 0,void 0,function*(){yield S(i)}));function j(q){return n(this,void 0,void 0,function*(){if(t(9,R=q),R==="map"){yield cn(),z=document.getElementById("g_map");const $=new google.maps.Map(z,{zoom:8,center:{lat:20.6745683,lng:-103.3986104},mapId:"4504f8b37365c3d0"}),V=new google.maps.LatLngBounds,{AdvancedMarkerElement:H,PinElement:ee}=yield google.maps.importLibrary("marker");navigator.geolocation?navigator.geolocation.getCurrentPosition(function(k){const O=new google.maps.LatLng(k.coords.latitude,k.coords.longitude);new google.maps.Marker({position:O,map:$,icon:{path:google.maps.SymbolPath.CIRCLE,fillColor:"#0062ff",fillOpacity:1,scale:6,strokeColor:"#ffffff",strokeWeight:2}}),new google.maps.Circle({strokeColor:"#00BFFF",strokeOpacity:.5,strokeWeight:1,fillColor:"#00BFFF",fillOpacity:.2,map:$,center:O,radius:k.coords.accuracy}),V.extend(O)},function(k){console.error("Error retrieving location:",k)}):console.error("Geolocation not supported by this browser."),f.lat1===f.lat2&&f.lon1===f.lon2?F(V,$,{lat:f.lat2,lon:f.lon2,color:f.color,title:f.destination},{type:"icon",iconClass:"icon-home",title:"Origen/Destino",glyph:`0,${String(h.length+1)}`}):(F(V,$,{lat:f.lat1,lon:f.lon1,color:f.color,title:f.origin},{type:"icon",iconClass:"icon-home",title:"Origen",glyph:"0"}),F(V,$,{lat:f.lat2,lon:f.lon2,color:f.color,title:f.destination},{type:"icon",iconClass:"icon-flag",title:"Destino",glyph:String(h.length+1)})),h.forEach((k,O)=>{const P=parseFloat(k.lat),te=parseFloat(k.lon),ne=new google.maps.LatLng(P,te),A=new google.maps.Marker({position:{lat:P,lng:te},map:$,title:k.title}),Z=new ee({background:Se(k.status,k.date_service),borderColor:"#000",glyphColor:"#000",glyph:(parseInt(k.pos)+1).toString()});new H({map:$,position:ne,content:Z.element,title:"Parada "+(parseInt(k.pos)+1).toString()+": "+k.title}).addListener("click",function(U){I(k,!1)}),V.extend(A.getPosition())}),$.fitBounds(V)}})}function F(q,$,V,H){return n(this,void 0,void 0,function*(){let ee;const k=parseFloat(V.lat),O=parseFloat(V.lon),P=new google.maps.LatLng(k,O),{AdvancedMarkerElement:te,PinElement:ne}=yield google.maps.importLibrary("marker");H.type=="icon"?(ee=document.createElement("i"),ee.className=`${H.iconClass} icon`,ee.style.fontSize="14px",ee.style.color=Me(V.color),ee.style.fontWeight="600"):H.type=="text";const A=new google.maps.Marker({position:{lat:k,lng:O},map:$,title:`${H.title}. ${V.title}`}),Z=new ne({background:V.color,borderColor:"#000",glyphColor:Me(V.color),glyph:H.glyph});return new te({map:$,position:P,content:Z.element,title:H.title+": "+V.title}).addListener("click",function(U){M(f,H.title=="Destino"||H.title=="Origen/Destino")}),A})}function S(q){return n(this,void 0,void 0,function*(){const $=new FormData;$.append("id_route",q);try{const H=yield(yield fetch(`${d}api/admin/report/seguimiento_list.php`,{method:"POST",body:$})).json();t(6,f=H.data.seguimiento_list[0]),t(5,h=H.data.event_list),t(7,p=H.data.checklist),E=H.data.expenses,f&&t(4,g=f.km_inicial=="0"&&f.gas_inicial=="0"),t(3,b=!1)}catch(V){t(3,b=!1),console.error("Error fetching data:",V)}})}const D=q=>new Promise(($,V)=>{const H=new FormData;H.append("id_route",q.id_route),H.append("id_event",q.id_event),fetch(`${d}api/admin/evidence/evidence_by_event.php`,{method:"POST",body:H}).then(ee=>ee.json()).then(ee=>{$(ee.data.event_evidence[0])}).catch(ee=>{console.error("Error fetching data:",ee),V(ee)})}),I=(q,$)=>{D(q).then(V=>{V&&(q.img=V.img,q.driver_comments=V.driver_comments,q.comments=V.comments),Ue("modal-delivery-info",Dt,{delivery:q,isLast:$}).then(H=>{}).finally(()=>{S(i)})})},M=(q,$)=>{var V=new Object;$?V={title:q.destination,line1:q.dest_address}:V={title:q.origin,line1:q.origin_address},V.client_name=q.client_name,V.client_phone=q.tel,V.id_route=q.id_route;var H=!0;Ue("modal-delivery-info",Dt,{delivery:V,isLast:$,flag:H})},L=(q,$,V)=>{var H=!1;return w||(w=!0,Ue("modal-checklist",en,{checklist:q,driverId:$,routeId:V,isLast:H}).then(ee=>{w=!1}),Q(V,"checklist")),""},B=q=>n(void 0,void 0,void 0,function*(){return yield S(q),E.length>0?Ue("modal-expense-detail",ho,{routeId:q,expenses:E}).then($=>{}):Ue("modal-expense",ut,{routeId:q}).then($=>{}),""}),K=q=>{if(q.tracking_type=="subscription"){if(q.subscriber_info&&q.payment_type==="cash"&&new Date(q.subscriber_info.payment_next)<new Date)return!0}else if(q.tracking_type=="ecommerce"&&Number(q.payment_pending)>0)return!0;return!1};function Q(q,$){let V=new FormData;return V.append("id_route",q),V.append("status",$),fetch(`${d}api/admin/route/change_status.php`,{method:"POST",body:V}).then(H=>H.json()).then(H=>{}).catch(H=>{console.error("Error fetching data:",H)}),""}const X=()=>{_.type=="super"||_.type=="admin"?Fe("/drivers/me"):_.id_driver&&Fe(`/drivers/${_.id_driver}`)},x=(q,$)=>n(void 0,void 0,void 0,function*(){yield(yield qe.create({header:q||"Error",message:$||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()}),ie=()=>B(i),se=q=>j(q.detail.value);function pe(q){De[q?"unshift":"push"](()=>{N=q,t(8,N)})}const ue=()=>{M(f,!1)},fe=q=>{const $=h.findIndex(O=>O.id_event===q.id_event),V=$===0,H=$>0?h[$-1]:null,ee=V||H&&H.img!==null,k=q.img!==null&&q.img!=="";ee||V&&!k?I(q,!1):x("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")},Oe=()=>{M(f,!0)};function de(q){De[q?"unshift":"push"](()=>{N=q,t(8,N)})}const ge=()=>{M(f,!1)},Ne=q=>{const $=h.findIndex(O=>O.id_event===q.id_event),V=$===0,H=$>0?h[$-1]:null,ee=V||H&&H.img!==null,k=q.img!==null&&q.img!=="";ee||V&&!k?I(q,!1):x("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")},be=()=>{M(f,!0)};function Te(q){De[q?"unshift":"push"](()=>{N=q,t(8,N)})}const Ie=()=>{M(f,!1)},_e=q=>{const $=h.findIndex(O=>O.id_event===q.id_event),V=$===0,H=$>0?h[$-1]:null,ee=V||H&&H.img!==null,k=q.img!==null&&q.img!=="";ee||V&&!k?I(q,!1):x("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")},ke=()=>{M(f,!0)};return r.$$set=q=>{"routeId"in q&&t(0,i=q.routeId),"driverId"in q&&t(1,u=q.driverId)},r.$$.update=()=>{r.$$.dirty[0]&524293&&(t(0,{routeId:i,driverId:u}=l.params,i,(t(1,u),t(19,l),t(2,_),t(0,i))),t(2,_=JSON.parse(localStorage.getItem("userSession"))),_?_.id_user&&(_.type=="admin"||_.type=="super")?(S(i),Fe(`/drivers/me/routes/${i}`)):_.id_user&&_.id_driver&&(S(i),Fe(`/drivers/${_.id_driver}/routes/${i}`)):Fe("/"))},[i,u,_,b,g,h,f,p,N,R,G,j,I,M,L,B,K,X,x,l,ie,se,pe,ue,fe,Oe,de,ge,Ne,be,Te,Ie,_e,ke]}class Do extends We{constructor(e){super(),Je(this,e,To,ko,Xe,{routeId:0,driverId:1},null,[-1,-1])}}export{Do as component};

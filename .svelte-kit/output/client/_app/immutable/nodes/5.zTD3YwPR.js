import{Z as ft,s as We,e as s,j as N,b as c,q as m,d as ie,h as a,m as T,v,i as Q,w as o,x as ue,n as ze,z as Be,_ as tn,B as C,o as Ze,k as Se,$ as dt,t as be,r as Ee,f as x,a0 as nn,a1 as Qe,A as De,y as Le,a2 as on,a3 as Ke,a4 as ln,a5 as rn,l as an,p as sn,F as cn}from"../chunks/index.CiEV7_Uu.js";import{S as Je,i as Ye,t as lt,a as at,c as un,b as fn,d as dn,m as _n,e as hn,g as pn}from"../chunks/index.CzW5ag9q.js";import{e as He,u as xe,d as $e,a as mn,b as vn,c as gn,i as Qt,f as bn,g as Zt,h as En,j as st,k as In,m as xt,s as _t,n as Re,o as kn,q as On,t as Nn,r as Tn,v as Cn,w as yn,x as wn,y as Ln,p as zn}from"../chunks/index.CBZxjcQK.js";import"../chunks/index-6e05b96e.C_9q9BoX.js";import{m as et,D as it,a as je,I as An}from"../chunks/IonPage.CuEZjJBk.js";import{q as Mn,t as Sn}from"../chunks/ion-modal.BYMRzj9z.js";import{g as qe}from"../chunks/entry.B_76jCR2.js";const Dn=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global,Pn=(r,e)=>{if(!customElements.get(r)){class t extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const n={};for(const i of this.attributes)n[i.name]=i.value;new e({target:this.shadowRoot,props:n})}}customElements.define(r,t)}},Bn=function(r){return document.createElement(r).constructor!==HTMLElement},Hn=(r,e)=>{Bn(r)||Pn(r,e)},Ue=async(r,e,t)=>{Mn(),Sn(),Hn(r,e);const l=await et.create({component:r,componentProps:t});return l.present(),await l.onWillDismiss()};let Ge=ft({km_inicial:[],gas_inicial:[],km_final:[],gas_final:[]}),$t=ft({flag:[]});function Rn(r){let e,t,l,n,i="Cancelar",u,d,_="Captura de Km/Gas",b,g,h,f="Confirmar",p,E,O,y,R,z,K;return{c(){e=s("ion-header"),t=s("ion-toolbar"),l=s("ion-buttons"),n=s("ion-button"),n.textContent=i,u=N(),d=s("ion-title"),d.textContent=_,b=N(),g=s("ion-buttons"),h=s("ion-button"),h.textContent=f,p=N(),E=s("ion-content"),O=s("ion-item"),y=s("ion-input"),this.h()},l(j){e=c(j,"ION-HEADER",{translucent:!0});var F=m(e);t=c(F,"ION-TOOLBAR",{});var P=m(t);l=c(P,"ION-BUTTONS",{slot:!0});var S=m(l);n=c(S,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),ie(n)!=="svelte-17pq4f4"&&(n.textContent=i),S.forEach(a),u=T(P),d=c(P,"ION-TITLE",{"data-svelte-h":!0}),ie(d)!=="svelte-1yhkaq7"&&(d.textContent=_),b=T(P),g=c(P,"ION-BUTTONS",{slot:!0});var I=m(g);h=c(I,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),ie(h)!=="svelte-cm6j4s"&&(h.textContent=f),I.forEach(a),P.forEach(a),F.forEach(a),p=T(j),E=c(j,"ION-CONTENT",{fullscreen:!0});var L=m(E);O=c(L,"ION-ITEM",{});var V=m(O);y=c(V,"ION-INPUT",{class:!0,inputmode:!0,pattern:!0,type:!0,placeholder:!0,value:!0,required:!0});var U=m(y);U.forEach(a),V.forEach(a),L.forEach(a),this.h()},h(){v(n,"color","medium"),v(l,"slot","start"),v(h,"strong",""),v(g,"slot","end"),v(e,"translucent",""),v(y,"class","fin-km"),v(y,"inputmode","numeric"),v(y,"pattern","[0-9]*"),v(y,"type","number"),v(y,"placeholder",R="Ingresa "+r[0]+" actual"),v(y,"value",r[1]),v(y,"required",""),v(E,"fullscreen","")},m(j,F){Q(j,e,F),o(e,t),o(t,l),o(l,n),o(t,u),o(t,d),o(t,b),o(t,g),o(g,h),Q(j,p,F),Q(j,E,F),o(E,O),o(O,y),z||(K=[ue(n,"click",r[2]),ue(h,"click",r[3]),ue(y,"input",r[4])],z=!0)},p(j,[F]){F&1&&R!==(R="Ingresa "+j[0]+" actual")&&v(y,"placeholder",R),F&2&&v(y,"value",j[1])},i:ze,o:ze,d(j){j&&(a(e),a(p),a(E)),z=!1,Be(K)}}}function Un(r,e,t){const l=tn();let n=document.querySelector("ion-modal"),i=n.componentProps.data_type;n.componentProps.isLast;let u;$t.subscribe(h=>{i=h.flag[0],i=="km_final"||i=="km_inicial"?t(0,u="kilometraje"):t(0,u="litros de gasolina")});let d=0;function _(){et.dismiss()}function b(){l("modalResult",{data:"Your data",role:"confirm"}),i=="km_inicial"?Ge.update(f=>({...f,km_inicial:[d]})):i=="gas_inicial"?Ge.update(f=>({...f,gas_inicial:[d]})):i=="km_final"?Ge.update(f=>({...f,km_final:[d]})):i=="gas_final"&&Ge.update(f=>({...f,gas_final:[d]})),_()}return[u,d,_,b,h=>t(1,d=h.target.value)]}class Vn extends Je{constructor(e){super(),Ye(this,e,Un,Rn,We,{})}}const rt=ft({items:[],checkedIndices:[],mandatory:[]});function gt(r,e,t){const l=r.slice();return l[55]=e[t],l[56]=e,l[57]=t,l}function Fn(r){let e,t,l,n,i,u="Kilometraje inicial",d,_,b=r[0]?r[0]+" km.":"Cargar km",g,h,f,p,E,O,y,R="Gasolina inicial (litros)",z,K,j=r[1]?r[1]+" litros":"Cargar gas",F,P,S,I;return P=dt(r[21][0]),{c(){e=s("ion-item"),t=s("ion-label"),l=s("input"),n=N(),i=s("p"),i.textContent=u,d=N(),_=s("ion-button"),g=be(b),h=N(),f=s("ion-item"),p=s("ion-label"),E=s("input"),O=N(),y=s("p"),y.textContent=R,z=N(),K=s("ion-button"),F=be(j),this.h()},l(L){e=c(L,"ION-ITEM",{});var V=m(e);t=c(V,"ION-LABEL",{style:!0});var U=m(t);l=c(U,"INPUT",{id:!0,style:!0,type:!0}),n=T(U),i=c(U,"P",{style:!0,"data-svelte-h":!0}),ie(i)!=="svelte-88twxi"&&(i.textContent=u),U.forEach(a),d=T(V),_=c(V,"ION-BUTTON",{fill:!0,size:!0,class:!0,"aria-selected":!0});var H=m(_);g=Ee(H,b),H.forEach(a),V.forEach(a),h=T(L),f=c(L,"ION-ITEM",{});var J=m(f);p=c(J,"ION-LABEL",{style:!0});var Y=m(p);E=c(Y,"INPUT",{id:!0,style:!0,type:!0}),O=T(Y),y=c(Y,"P",{style:!0,"data-svelte-h":!0}),ie(y)!=="svelte-1ux30eb"&&(y.textContent=R),Y.forEach(a),z=T(J),K=c(J,"ION-BUTTON",{fill:!0,class:!0,size:!0,style:!0});var ee=m(K);F=Ee(ee,j),ee.forEach(a),J.forEach(a),this.h()},h(){x(l,"id","chkbox-km-ini"),C(l,"pointer-events","auto"),x(l,"type","checkbox"),l.required=!0,C(i,"margin-left","10px"),C(t,"display","flex"),v(_,"fill","outline"),v(_,"size","small"),v(_,"class","loadKmInicial"),v(_,"aria-selected",""),x(E,"id","chkbox-gas-ini"),C(E,"pointer-events","auto"),x(E,"type","checkbox"),E.required=!0,C(y,"margin-left","10px"),C(p,"display","flex"),v(K,"fill","outline"),v(K,"class","loadGasInicial"),v(K,"size","small"),C(K,"height","16px "),P.p(l,E)},m(L,V){Q(L,e,V),o(e,t),o(t,l),l.checked=~(r[4]||[]).indexOf(l.__value),r[28](l),o(t,n),o(t,i),o(e,d),o(e,_),o(_,g),Q(L,h,V),Q(L,f,V),o(f,p),o(p,E),r[30](E),E.checked=~(r[4]||[]).indexOf(E.__value),o(p,O),o(p,y),o(f,z),o(f,K),o(K,F),S||(I=[ue(l,"change",r[27]),ue(_,"click",r[29]),ue(E,"change",r[31]),ue(K,"click",r[32])],S=!0)},p(L,V){V[0]&16&&(l.checked=~(L[4]||[]).indexOf(l.__value)),V[0]&1&&b!==(b=L[0]?L[0]+" km.":"Cargar km")&&Le(g,b),V[0]&16&&(E.checked=~(L[4]||[]).indexOf(E.__value)),V[0]&2&&j!==(j=L[1]?L[1]+" litros":"Cargar gas")&&Le(F,j)},d(L){L&&(a(e),a(h),a(f)),r[28](null),r[30](null),P.r(),S=!1,Be(I)}}}function qn(r){let e,t,l,n,i,u="Kilometraje final",d,_,b=r[2]?r[2]+" km.":"Cargar km",g,h,f,p,E,O,y,R="Gasolina final (litros)",z,K,j=r[3]?r[3]+" litros":"Cargar gas",F,P,S,I;return P=dt(r[21][0]),{c(){e=s("ion-item"),t=s("ion-label"),l=s("input"),n=N(),i=s("p"),i.textContent=u,d=N(),_=s("ion-button"),g=be(b),h=N(),f=s("ion-item"),p=s("ion-label"),E=s("input"),O=N(),y=s("p"),y.textContent=R,z=N(),K=s("ion-button"),F=be(j),this.h()},l(L){e=c(L,"ION-ITEM",{});var V=m(e);t=c(V,"ION-LABEL",{style:!0});var U=m(t);l=c(U,"INPUT",{id:!0,style:!0,type:!0}),n=T(U),i=c(U,"P",{style:!0,"data-svelte-h":!0}),ie(i)!=="svelte-ccmu71"&&(i.textContent=u),U.forEach(a),d=T(V),_=c(V,"ION-BUTTON",{fill:!0,size:!0,class:!0,"aria-selected":!0});var H=m(_);g=Ee(H,b),H.forEach(a),V.forEach(a),h=T(L),f=c(L,"ION-ITEM",{});var J=m(f);p=c(J,"ION-LABEL",{style:!0});var Y=m(p);E=c(Y,"INPUT",{id:!0,style:!0,type:!0}),O=T(Y),y=c(Y,"P",{style:!0,"data-svelte-h":!0}),ie(y)!=="svelte-wsoyd2"&&(y.textContent=R),Y.forEach(a),z=T(J),K=c(J,"ION-BUTTON",{fill:!0,size:!0,class:!0});var ee=m(K);F=Ee(ee,j),ee.forEach(a),J.forEach(a),this.h()},h(){x(l,"id","chkbox-km-fin"),C(l,"pointer-events","auto"),x(l,"type","checkbox"),l.required=!0,C(i,"margin-left","10px"),C(t,"display","flex"),v(_,"fill","outline"),v(_,"size","small"),v(_,"class","loadKmInicial"),v(_,"aria-selected",""),x(E,"id","chkbox-gas-fin"),C(E,"pointer-events","auto"),x(E,"type","checkbox"),E.required=!0,C(y,"margin-left","10px"),C(p,"display","flex"),v(K,"fill","outline"),v(K,"size","small"),v(K,"class","loadGasInicial"),P.p(l,E)},m(L,V){Q(L,e,V),o(e,t),o(t,l),l.checked=~(r[4]||[]).indexOf(l.__value),r[22](l),o(t,n),o(t,i),o(e,d),o(e,_),o(_,g),Q(L,h,V),Q(L,f,V),o(f,p),o(p,E),E.checked=~(r[4]||[]).indexOf(E.__value),r[25](E),o(p,O),o(p,y),o(f,z),o(f,K),o(K,F),S||(I=[ue(l,"change",r[20]),ue(_,"click",r[23]),ue(E,"change",r[24]),ue(K,"click",r[26])],S=!0)},p(L,V){V[0]&16&&(l.checked=~(L[4]||[]).indexOf(l.__value)),V[0]&4&&b!==(b=L[2]?L[2]+" km.":"Cargar km")&&Le(g,b),V[0]&16&&(E.checked=~(L[4]||[]).indexOf(E.__value)),V[0]&8&&j!==(j=L[3]?L[3]+" litros":"Cargar gas")&&Le(F,j)},d(L){L&&(a(e),a(h),a(f)),r[22](null),r[25](null),P.r(),S=!1,Be(I)}}}function jn(r){let e=[],t=new Map,l,n=He(r[13]);const i=u=>u[55].id_checklist_event;for(let u=0;u<n.length;u+=1){let d=gt(r,n,u),_=i(d);t.set(_,e[u]=bt(_,d))}return{c(){for(let u=0;u<e.length;u+=1)e[u].c();l=Se()},l(u){for(let d=0;d<e.length;d+=1)e[d].l(u);l=Se()},m(u,d){for(let _=0;_<e.length;_+=1)e[_]&&e[_].m(u,d);Q(u,l,d)},p(u,d){d[0]&407664&&(n=He(u[13]),e=xe(e,d,i,1,u,n,t,l.parentNode,$e,bt,l,gt))},d(u){u&&a(l);for(let d=0;d<e.length;d+=1)e[d].d(u)}}}function Gn(r){let e,t=(r[12][r[55].id_checklist_event]?r[12][r[55].id_checklist_event]:"Cargar evidencia")+"",l;return{c(){e=s("label"),l=be(t),this.h()},l(n){e=c(n,"LABEL",{for:!0,class:!0});var i=m(e);l=Ee(i,t),i.forEach(a),this.h()},h(){x(e,"for","chklist-"+r[55].id_checklist_event),x(e,"class","button-label svelte-1ruehls")},m(n,i){Q(n,e,i),o(e,l)},p(n,i){i[0]&4096&&t!==(t=(n[12][n[55].id_checklist_event]?n[12][n[55].id_checklist_event]:"Cargar evidencia")+"")&&Le(l,t)},d(n){n&&a(e)}}}function Kn(r){let e;return{c(){e=s("ion-spinner"),this.h()},l(t){e=c(t,"ION-SPINNER",{name:!0,class:!0}),m(e).forEach(a),this.h()},h(){v(e,"name","dots"),v(e,"class","button-spinner svelte-1ruehls")},m(t,l){Q(t,e,l)},p:ze,d(t){t&&a(e)}}}function bt(r,e){let t,l,n,i=e[55],u,d,_=e[55].item+"",b,g,h,f=e[55].mandatory=="1"?" * ":"",p,E,O,y,R,z,K,j,F,P;const S=()=>e[34](n,i),I=()=>e[34](null,i);function L(){return e[35](e[55])}function V(Y,ee){return Y[11][Y[55].id_checklist_event]?Kn:Gn}let U=V(e),H=U(e);function J(...Y){return e[37](e[55],...Y)}return j=dt(e[21][0]),{key:r,first:null,c(){t=s("ion-item"),l=s("ion-label"),n=s("input"),u=N(),d=s("p"),b=be(_),g=N(),h=s("b"),p=be(f),E=N(),O=s("ion-button"),y=s("div"),H.c(),R=N(),z=s("input"),K=N(),this.h()},l(Y){t=c(Y,"ION-ITEM",{});var ee=m(t);l=c(ee,"ION-LABEL",{style:!0});var te=m(l);n=c(te,"INPUT",{id:!0,style:!0,type:!0}),u=T(te),d=c(te,"P",{style:!0});var re=m(d);b=Ee(re,_),g=T(re),re.forEach(a),h=c(te,"B",{style:!0});var ge=m(h);p=Ee(ge,f),ge.forEach(a),te.forEach(a),E=T(ee),O=c(ee,"ION-BUTTON",{fill:!0,class:!0,size:!0});var ce=m(O);y=c(ce,"DIV",{class:!0});var _e=m(y);H.l(_e),R=T(_e),z=c(_e,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0}),_e.forEach(a),ce.forEach(a),K=T(ee),ee.forEach(a),this.h()},h(){x(n,"id",`chkbox-${e[55].id_checklist_event}`),C(n,"pointer-events","auto"),x(n,"type","checkbox"),n.__value=e[55].id_checklist_event,nn(n,n.__value),n.required=!0,C(d,"margin-left","10px"),C(h,"margin-left","5px"),C(l,"display","flex"),C(z,"display","none"),x(z,"id","chklist-"+e[55].id_checklist_event),x(z,"name","fileToUpload"),x(z,"type","file"),x(z,"accept","image/*"),x(y,"class","button-content svelte-1ruehls"),v(O,"fill","outline"),v(O,"class","loadEvidence svelte-1ruehls"),v(O,"size","small"),j.p(n),this.first=t},m(Y,ee){Q(Y,t,ee),o(t,l),o(l,n),n.checked=~(e[4]||[]).indexOf(n.__value),S(),o(l,u),o(l,d),o(d,b),o(d,g),o(l,h),o(h,p),o(t,E),o(t,O),o(O,y),H.m(y,null),o(y,R),o(y,z),e[36](z),o(t,K),F||(P=[ue(n,"change",e[33]),ue(n,"change",L),ue(z,"change",J)],F=!0)},p(Y,ee){e=Y,ee[0]&16&&(n.checked=~(e[4]||[]).indexOf(n.__value)),i!==e[55]&&(I(),i=e[55],S()),U===(U=V(e))&&H?H.p(e,ee):(H.d(1),H=U(e),H&&(H.c(),H.m(y,R)))},d(Y){Y&&a(t),I(),H.d(),e[36](null),j.r(),F=!1,Be(P)}}}function Xn(r){let e,t,l,n,i="Cancelar",u,d,_="REQUERIMIENTOS DE RUTA",b,g,h,f,p,E,O,y="Confirmar",R,z;function K(S,I){return S[14]?qn:Fn}let F=K(r)(r),P=r[13]&&jn(r);return{c(){e=s("ion-header"),t=s("ion-toolbar"),l=s("ion-buttons"),n=s("ion-button"),n.textContent=i,u=N(),d=s("ion-title"),d.textContent=_,b=N(),g=s("ion-content"),h=s("ion-list"),F.c(),f=N(),P&&P.c(),p=N(),E=s("ion-footer"),O=s("ion-button"),O.textContent=y,this.h()},l(S){e=c(S,"ION-HEADER",{translucent:!0});var I=m(e);t=c(I,"ION-TOOLBAR",{});var L=m(t);l=c(L,"ION-BUTTONS",{slot:!0});var V=m(l);n=c(V,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),ie(n)!=="svelte-1dnmkxs"&&(n.textContent=i),V.forEach(a),u=T(L),d=c(L,"ION-TITLE",{"data-svelte-h":!0}),ie(d)!=="svelte-19bar5p"&&(d.textContent=_),L.forEach(a),I.forEach(a),b=T(S),g=c(S,"ION-CONTENT",{fullscreen:!0});var U=m(g);h=c(U,"ION-LIST",{});var H=m(h);F.l(H),f=T(H),P&&P.l(H),H.forEach(a),U.forEach(a),p=T(S),E=c(S,"ION-FOOTER",{});var J=m(E);O=c(J,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),ie(O)!=="svelte-g82qqw"&&(O.textContent=y),J.forEach(a),this.h()},h(){v(n,"color","medium"),v(l,"slot","start"),v(e,"translucent",""),v(g,"fullscreen",""),v(O,"fill","outline"),v(O,"color","tertiary"),v(O,"strong",""),C(O,"width","99%"),C(O,"height","auto")},m(S,I){Q(S,e,I),o(e,t),o(t,l),o(l,n),o(t,u),o(t,d),Q(S,b,I),Q(S,g,I),o(g,h),F.m(h,null),o(h,f),P&&P.m(h,null),Q(S,p,I),Q(S,E,I),o(E,O),R||(z=[ue(n,"click",r[15]),ue(O,"click",r[16])],R=!0)},p(S,I){F.p(S,I),S[13]&&P.p(S,I)},i:ze,o:ze,d(S){S&&(a(e),a(b),a(g),a(p),a(E)),F.d(),P&&P.d(),R=!1,Be(z)}}}function ct(r,e){if(typeof r=="object"&&r!==null||Array.isArray(r)){if(Array.isArray(r))return r.map(t=>ct(t,e)).flat();{const t=Object.keys(r);let l;return e=="id_checklist_event"?l=t.filter(i=>i.toLowerCase().includes("id_checklist_event")).map(i=>r[i]):e=="mandatory"?l=t.filter(i=>i.toLowerCase().includes("mandatory")).map(i=>r[i]):(console.error("Tipo de dato no reconocido."),l=!1),l}}else return console.error("Invalid input. Please provide a valid object or array."),[]}function Wn(r,e,t){let l=it,n=document.querySelector("ion-modal");const i=n.componentProps.checklist,u=n.componentProps.driverId,d=n.componentProps.routeId,_=n.componentProps.isLast;let b,g,h,f,p=[],E=null,O={},y,R,z,K,j={},F=new Object,P={},S={};Ze(()=>{F=JSON.parse(localStorage.getItem("userSession")),_?console.log("Último checklist"):rt.update(w=>(w.mandatory=ct(i,"mandatory"),w.items=ct(i,"id_checklist_event"),w))});function I(w){t(11,j[w]=!0,j)}const L=async()=>{await(await je.create({header:"Datos o checklist incompletos",message:"Carga la evidencia requerida y marca todas las casillas para confirmar",buttons:[{text:"Cerrar"}]})).present()},V=async()=>{await(await je.create({header:"Datos capturados",message:"El kilometraje y gasolina final fueron registrados correctamente, espere aprobación para finalizar ruta",buttons:[{text:"Cerrar"}]})).present()},U=async w=>{await(await je.create({header:"Datos inválidos",message:w=="km"?"Llena correctamente el campo de kilometraje inicial":"Llena correctamente el campo de gasolina inicial",buttons:[{text:"Cerrar"}]})).present()},H=()=>{et.dismiss(),u?qe(`/drivers/${u}`):qe("/drivers/me")},J=()=>{if(_){var w=ge(h,"km"),M=ge(f,"gas");let ae=new FormData;ae.append("km_final",w),ae.append("gas_final",M),ae.append("id_route",d),ae=me(ae),w&&M?(H(),fetch(`${l}api/admin/checklist/add_evidence.php`,{method:"POST",body:ae}).then(pe=>pe.json()).then(pe=>{V()}).catch(pe=>{console.error("Error fetching data:",pe)})):L()}else{var $=ge(b,"km"),le=ge(g,"gas");rt.update(ae=>{ae.items;const pe=ae.mandatory;if(ae.items.filter((de,ve)=>ae.mandatory[ve]==="1").every(de=>ae.checkedIndices.includes(de))&&$&&le){H();let de=new FormData;de=me(de),de.append("km_inicial",$),de.append("gas_inicial",le),de.append("id_route",d);for(const ve in P)if(P.hasOwnProperty(ve)){const{img:Ae,img_id:Ve}=P[ve];de.append(`selectedImages[${ve}][img]`,Ae),de.append(`selectedImages[${ve}][img_id]`,Ve)}fetch(`${l}api/admin/checklist/add_evidence.php`,{method:"POST",body:de}).then(ve=>ve.json()).then(ve=>{pe&&pe.some(Ae=>Ae==="1")?re(d,"checklist-pending"):re(d,"enroute")}).catch(ve=>{console.error("Error fetching data:",ve)})}else if(!pe&&$&&le){let de=new FormData;de.append("km_inicial",$),de.append("gas_inicial",le),de=me(de),fetch(`${l}api/admin/checklist/add_evidence.php`,{method:"POST",body:de}).then(ve=>ve.json()).then(ve=>{re(d,"enroute")}).catch(ve=>{console.error("Error fetching data:",ve)})}else L();return ae})}fe()},Y=async(w,M)=>{I(M);const le=w.target.files[0],ae=await ee(le);if(ae){let pe=new FormData;pe.append("fileToUpload",ae),pe=me(pe);try{const we=await fetch(`${l}api/admin/manager/upload_img_driver.php`,{method:"POST",body:pe});if(we.ok){const se=await we.json();P={...P,[M]:{img:se.img,img_id:se.img_id}},t(12,S={...S,[M]:se.filename}),te(M),t(6,O[M].checked=!0,O),t(11,j[M]=!1,j)}else console.error("File upload failed:",we.statusText)}catch(we){console.error("Error during file upload:",we)}}},ee=async w=>new Promise(M=>{const $=new FileReader;$.onload=le=>{const ae=new Image;ae.src=le.target.result,ae.onload=()=>{const pe=document.createElement("canvas"),we=pe.getContext("2d"),se=800,de=600;let ve=ae.width,Ae=ae.height;ve>se&&(Ae*=se/ve,ve=se),Ae>de&&(ve*=de/Ae,Ae=de),pe.width=ve,pe.height=Ae,we.drawImage(ae,0,0,ve,Ae),pe.toBlob(Ve=>{M(Ve)},"image/jpeg",.7)}},$.readAsDataURL(w)}),te=w=>{rt.update(M=>(M.checkedIndices.indexOf(w)===-1?M.checkedIndices.push(w):console.error(`ID ${w} is already checked.`),M.items.forEach(le=>{le.id_checklist_event===w&&(le.checked=!0)}),M))};function re(w,M){let $=new FormData;$.append("id_route",w),$.append("status",M),$=me($),fetch(`${l}api/admin/route/change_status.php`,{method:"POST",body:$}).then(le=>le.json()).then(le=>{}).catch(le=>{console.error("Error fetching data:",le)})}function ge(w,M){return/^\d+$/.test(w)?parseInt(w,10):(U(M),null)}function ce(w,M){_e(M),n.componentProps.data_type=M,Ue("modal-gas-km",Vn,{r:M}).then(()=>{Ge.subscribe($=>{Ie($,M)})})}function _e(w){$t.update(M=>({...M,flag:[w]}))}function Ie(w,M){t(0,b=w.km_inicial?w.km_inicial:null),t(1,g=w.gas_inicial?w.gas_inicial:null),t(2,h=w.km_final?w.km_final:null),t(3,f=w.gas_final?w.gas_final:null),M=="km_inicial"&&y&&t(7,y.checked=!0,y),M=="gas_inicial"&&R&&t(8,R.checked=!0,R),M=="km_final"&&z&&t(9,z.checked=!0,z),M=="gas_final"&&K&&t(10,K.checked=!0,K)}function fe(){Ge.set({km_inicial:[],gas_inicial:[],km_final:[],gas_final:[]})}function me(w){return w.append("token",F.token),w.append("id_user_over",F.id_user),w}const ke=[[]];function Oe(){p=Qe(ke[0],this.__value,this.checked),t(4,p)}function ye(w){De[w?"unshift":"push"](()=>{z=w,t(9,z)})}const Te=w=>ce(w,"km_final");function he(){p=Qe(ke[0],this.__value,this.checked),t(4,p)}function Ne(w){De[w?"unshift":"push"](()=>{K=w,t(10,K)})}const Ce=w=>ce(w,"gas_final");function B(){p=Qe(ke[0],this.__value,this.checked),t(4,p)}function X(w){De[w?"unshift":"push"](()=>{y=w,t(7,y)})}const A=w=>ce(w,"km_inicial");function q(w){De[w?"unshift":"push"](()=>{R=w,t(8,R)})}function G(){p=Qe(ke[0],this.__value,this.checked),t(4,p)}const D=w=>ce(w,"gas_inicial");function k(){p=Qe(ke[0],this.__value,this.checked),t(4,p)}function W(w,M){De[w?"unshift":"push"](()=>{O[M.id_checklist_event]=w,t(6,O)})}const Z=w=>te(w.id_checklist_event);function oe(w){De[w?"unshift":"push"](()=>{E=w,t(5,E)})}return[b,g,h,f,p,E,O,y,R,z,K,j,S,i,_,H,J,Y,te,ce,Oe,ke,ye,Te,he,Ne,Ce,B,X,A,q,G,D,k,W,Z,oe,(w,M)=>Y(M,w.id_checklist_event)]}class en extends Je{constructor(e){super(),Ye(this,e,Wn,Xn,We,{},null,[-1,-1])}}function Et(r,e,t){const l=r.slice();return l[52]=e[t],l[54]=t,l}function Jn(r){let e,t,l="Confirmar",n,i;return{c(){e=s("ion-buttons"),t=s("ion-button"),t.textContent=l,this.h()},l(u){e=c(u,"ION-BUTTONS",{slot:!0});var d=m(e);t=c(d,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),ie(t)!=="svelte-1ida0il"&&(t.textContent=l),d.forEach(a),this.h()},h(){v(t,"strong",""),v(e,"slot","end")},m(u,d){Q(u,e,d),o(e,t),n||(i=ue(t,"click",r[20]),n=!0)},p:ze,d(u){u&&a(e),n=!1,i()}}}function Yn(r){let e,t,l,n,i,u="Teléfono de Negocio",d,_,b=r[13].client_phone+"",g;return{c(){e=s("ion-item"),t=s("ion-icon"),l=N(),n=s("ion-label"),i=s("p"),i.textContent=u,d=N(),_=s("h2"),g=be(b),this.h()},l(h){e=c(h,"ION-ITEM",{href:!0});var f=m(e);t=c(f,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=T(f),n=c(f,"ION-LABEL",{class:!0});var p=m(n);i=c(p,"P",{"data-svelte-h":!0}),ie(i)!=="svelte-1u5l7fz"&&(i.textContent=u),d=T(p),_=c(p,"H2",{});var E=m(_);g=Ee(E,b),E.forEach(a),p.forEach(a),f.forEach(a),this.h()},h(){v(t,"icon",vn),v(t,"slot","start"),v(n,"class","ion-text-wrap"),v(e,"href","tel:"+r[13].client_phone)},m(h,f){Q(h,e,f),o(e,t),o(e,l),o(e,n),o(n,i),o(n,d),o(n,_),o(_,g)},p:ze,d(h){h&&a(e)}}}function Qn(r){let e,t,l,n,i,u="Domicilio Alternativo",d,_,b=r[13].line2+"",g,h,f;return{c(){e=s("ion-item"),t=s("ion-icon"),l=N(),n=s("ion-label"),i=s("p"),i.textContent=u,d=N(),_=s("h2"),g=be(b),h=N(),f=s("ion-icon"),this.h()},l(p){e=c(p,"ION-ITEM",{href:!0});var E=m(e);t=c(E,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=T(E),n=c(E,"ION-LABEL",{class:!0});var O=m(n);i=c(O,"P",{"data-svelte-h":!0}),ie(i)!=="svelte-1ub9uzw"&&(i.textContent=u),d=T(O),_=c(O,"H2",{});var y=m(_);g=Ee(y,b),y.forEach(a),O.forEach(a),h=T(E),f=c(E,"ION-ICON",{icon:!0,slot:!0}),m(f).forEach(a),E.forEach(a),this.h()},h(){v(t,"icon",_t),v(t,"slot","start"),v(n,"class","ion-text-wrap"),v(f,"icon",Re),v(f,"slot","end"),v(e,"href","https://www.google.com/maps/searhc/?api=1&query="+r[13].line2)},m(p,E){Q(p,e,E),o(e,t),o(e,l),o(e,n),o(n,i),o(n,d),o(n,_),o(_,g),o(e,h),o(e,f)},p:ze,d(p){p&&a(e)}}}function Zn(r){let e,t,l,n,i,u="Domicilio",d,_,b=r[13].line1+"",g,h,f,p,E=r[13].line2&&r[13].line2.trim().length,O,y=E&&xn(r);return{c(){e=s("ion-item"),t=s("ion-icon"),l=N(),n=s("ion-label"),i=s("p"),i.textContent=u,d=N(),_=s("h2"),g=be(b),h=N(),f=s("ion-icon"),p=N(),y&&y.c(),O=Se(),this.h()},l(R){e=c(R,"ION-ITEM",{href:!0});var z=m(e);t=c(z,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=T(z),n=c(z,"ION-LABEL",{class:!0});var K=m(n);i=c(K,"P",{"data-svelte-h":!0}),ie(i)!=="svelte-cbm7q1"&&(i.textContent=u),d=T(K),_=c(K,"H2",{});var j=m(_);g=Ee(j,b),j.forEach(a),K.forEach(a),h=T(z),f=c(z,"ION-ICON",{icon:!0,slot:!0}),m(f).forEach(a),z.forEach(a),p=T(R),y&&y.l(R),O=Se(),this.h()},h(){v(t,"icon",_t),v(t,"slot","start"),v(n,"class","ion-text-wrap"),v(f,"icon",Re),v(f,"slot","end"),v(e,"href","https://www.google.com/maps/search/?api=1&query="+r[13].line1)},m(R,z){Q(R,e,z),o(e,t),o(e,l),o(e,n),o(n,i),o(n,d),o(n,_),o(_,g),o(e,h),o(e,f),Q(R,p,z),y&&y.m(R,z),Q(R,O,z)},p(R,z){E&&y.p(R,z)},d(R){R&&(a(e),a(p),a(O)),y&&y.d(R)}}}function xn(r){let e,t,l,n,i,u="Domicilio Alternativo",d,_,b=r[13].line2+"",g,h,f;return{c(){e=s("ion-item"),t=s("ion-icon"),l=N(),n=s("ion-label"),i=s("p"),i.textContent=u,d=N(),_=s("h2"),g=be(b),h=N(),f=s("ion-icon"),this.h()},l(p){e=c(p,"ION-ITEM",{href:!0});var E=m(e);t=c(E,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=T(E),n=c(E,"ION-LABEL",{class:!0});var O=m(n);i=c(O,"P",{"data-svelte-h":!0}),ie(i)!=="svelte-1ub9uzw"&&(i.textContent=u),d=T(O),_=c(O,"H2",{});var y=m(_);g=Ee(y,b),y.forEach(a),O.forEach(a),h=T(E),f=c(E,"ION-ICON",{icon:!0,slot:!0}),m(f).forEach(a),E.forEach(a),this.h()},h(){v(t,"icon",_t),v(t,"slot","start"),v(n,"class","ion-text-wrap"),v(f,"icon",Re),v(f,"slot","end"),v(e,"href","https://www.google.com/maps/search/?api=1&query="+r[13].line2)},m(p,E){Q(p,e,E),o(e,t),o(e,l),o(e,n),o(n,i),o(n,d),o(n,_),o(_,g),o(e,h),o(e,f)},p:ze,d(p){p&&a(e)}}}function It(r){let e,t,l,n,i,u="Contacto del Cliente",d,_,b,g,h=r[3]&&r[3]==="1"&&kt(r);return{c(){e=s("ion-item"),t=s("ion-icon"),l=N(),n=s("ion-label"),i=s("p"),i.textContent=u,d=N(),_=s("h2"),b=be(r[7]),g=N(),h&&h.c(),this.h()},l(f){e=c(f,"ION-ITEM",{});var p=m(e);t=c(p,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=T(p),n=c(p,"ION-LABEL",{class:!0});var E=m(n);i=c(E,"P",{"data-svelte-h":!0}),ie(i)!=="svelte-1utsyb6"&&(i.textContent=u),d=T(E),_=c(E,"H2",{});var O=m(_);b=Ee(O,r[7]),O.forEach(a),E.forEach(a),g=T(p),h&&h.l(p),p.forEach(a),this.h()},h(){v(t,"icon",gn),v(t,"slot","start"),v(n,"class","ion-text-wrap")},m(f,p){Q(f,e,p),o(e,t),o(e,l),o(e,n),o(n,i),o(n,d),o(n,_),o(_,b),o(e,g),h&&h.m(e,null)},p(f,p){p[0]&128&&Le(b,f[7]),f[3]&&f[3]==="1"?h?h.p(f,p):(h=kt(f),h.c(),h.m(e,null)):h&&(h.d(1),h=null)},d(f){f&&a(e),h&&h.d()}}}function kt(r){let e,t=`<ion-icon icon="${kn}" slot="start"></ion-icon>
                        Notificar Cliente`,l,n;return{c(){e=s("ion-button"),e.innerHTML=t,this.h()},l(i){e=c(i,"ION-BUTTON",{fill:!0,style:!0,"data-svelte-h":!0}),ie(e)!=="svelte-w3qtwm"&&(e.innerHTML=t),this.h()},h(){v(e,"fill","outline"),C(e,"margin-left","16px")},m(i,u){Q(i,e,u),l||(n=ue(e,"click",r[21]),l=!0)},p:ze,d(i){i&&a(e),l=!1,n()}}}function Ot(r){let e,t,l,n,i,u="Notas de ubicación",d,_,b;return{c(){e=s("ion-item"),t=s("ion-icon"),l=N(),n=s("ion-label"),i=s("p"),i.textContent=u,d=N(),_=s("h2"),b=be(r[8]),this.h()},l(g){e=c(g,"ION-ITEM",{});var h=m(e);t=c(h,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=T(h),n=c(h,"ION-LABEL",{class:!0});var f=m(n);i=c(f,"P",{"data-svelte-h":!0}),ie(i)!=="svelte-nhm2ft"&&(i.textContent=u),d=T(f),_=c(f,"H2",{});var p=m(_);b=Ee(p,r[8]),p.forEach(a),f.forEach(a),h.forEach(a),this.h()},h(){v(t,"icon",Qt),v(t,"slot","start"),v(n,"class","ion-text-wrap")},m(g,h){Q(g,e,h),o(e,t),o(e,l),o(e,n),o(n,i),o(n,d),o(n,_),o(_,b)},p(g,h){h[0]&256&&Le(b,g[8])},d(g){g&&a(e)}}}function $n(r){let e,t,l,n,i,u="Horarios",d,_,b=r[13].schedule+"",g;return{c(){e=s("ion-item"),t=s("ion-icon"),l=N(),n=s("ion-label"),i=s("p"),i.textContent=u,d=N(),_=s("h2"),g=be(b),this.h()},l(h){e=c(h,"ION-ITEM",{});var f=m(e);t=c(f,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=T(f),n=c(f,"ION-LABEL",{});var p=m(n);i=c(p,"P",{"data-svelte-h":!0}),ie(i)!=="svelte-11q7hm5"&&(i.textContent=u),d=T(p),_=c(p,"H2",{});var E=m(_);g=Ee(E,b),E.forEach(a),p.forEach(a),f.forEach(a),this.h()},h(){v(t,"icon",bn),v(t,"slot","start")},m(h,f){Q(h,e,f),o(e,t),o(e,l),o(e,n),o(n,i),o(n,d),o(n,_),o(_,g)},p:ze,d(h){h&&a(e)}}}function eo(r){let e,t,l,n,i,u="Notas del operador",d,_,b=r[13].driver_comments+"",g;return{c(){e=s("ion-item"),t=s("ion-icon"),l=N(),n=s("ion-label"),i=s("p"),i.textContent=u,d=N(),_=s("h2"),g=be(b),this.h()},l(h){e=c(h,"ION-ITEM",{});var f=m(e);t=c(f,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=T(f),n=c(f,"ION-LABEL",{});var p=m(n);i=c(p,"P",{"data-svelte-h":!0}),ie(i)!=="svelte-1yk9qp4"&&(i.textContent=u),d=T(p),_=c(p,"H2",{});var E=m(_);g=Ee(E,b),E.forEach(a),p.forEach(a),f.forEach(a),this.h()},h(){v(t,"icon",Zt),v(t,"slot","start")},m(h,f){Q(h,e,f),o(e,t),o(e,l),o(e,n),o(n,i),o(n,d),o(n,_),o(_,g)},p:ze,d(h){h&&a(e)}}}function to(r){let e,t=r[13].logistic_comments!="<br>"&&no(r);return{c(){t&&t.c(),e=Se()},l(l){t&&t.l(l),e=Se()},m(l,n){t&&t.m(l,n),Q(l,e,n)},p(l,n){l[13].logistic_comments!="<br>"&&t.p(l,n)},d(l){l&&a(e),t&&t.d(l)}}}function no(r){let e,t,l,n,i,u="Comentarios logísticos",d,_,b=r[13].logistic_comments+"",g;return{c(){e=s("ion-item"),t=s("ion-icon"),l=N(),n=s("ion-label"),i=s("p"),i.textContent=u,d=N(),_=s("h2"),g=be(b),this.h()},l(h){e=c(h,"ION-ITEM",{});var f=m(e);t=c(f,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=T(f),n=c(f,"ION-LABEL",{class:!0});var p=m(n);i=c(p,"P",{"data-svelte-h":!0}),ie(i)!=="svelte-1iz85r6"&&(i.textContent=u),d=T(p),_=c(p,"H2",{});var E=m(_);g=Ee(E,b),E.forEach(a),p.forEach(a),f.forEach(a),this.h()},h(){v(t,"icon",Qt),v(t,"slot","start"),v(n,"class","ion-text-wrap")},m(h,f){Q(h,e,f),o(e,t),o(e,l),o(e,n),o(n,i),o(n,d),o(n,_),o(_,g)},p:ze,d(h){h&&a(e)}}}function Nt(r){let e,t,l,n;return{c(){e=s("ion-item"),t=s("ion-icon"),l=N(),n=s("ion-textarea"),this.h()},l(i){e=c(i,"ION-ITEM",{});var u=m(e);t=c(u,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=T(u),n=c(u,"ION-TEXTAREA",{placeholder:!0}),m(n).forEach(a),u.forEach(a),this.h()},h(){v(t,"icon",En),v(t,"slot","start"),v(n,"placeholder","Escribe el motivo...")},m(i,u){Q(i,e,u),o(e,t),o(e,l),o(e,n),r[27](n)},p:ze,d(i){i&&a(e),r[27](null)}}}function oo(r){let e,t,l,n,i,u,d,_=r[5]===!0&&Tt(r),b=(r[6]===!0||r[6]===!1&&r[5]===!1)&&Ct(r);return{c(){e=s("ion-item"),t=s("ion-icon"),l=N(),n=s("ion-textarea"),i=N(),u=s("section"),_&&_.c(),d=N(),b&&b.c(),this.h()},l(g){e=c(g,"ION-ITEM",{});var h=m(e);t=c(h,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=T(h),n=c(h,"ION-TEXTAREA",{label:!0,placeholder:!0}),m(n).forEach(a),h.forEach(a),i=T(g),u=c(g,"SECTION",{style:!0});var f=m(u);_&&_.l(f),d=T(f),b&&b.l(f),f.forEach(a),this.h()},h(){v(t,"icon",st),v(t,"slot","start"),v(n,"label","Notas"),v(n,"placeholder","Escribe aquí..."),C(u,"display","flex"),C(u,"gap","8px"),C(u,"padding","16px 16px 6px")},m(g,h){Q(g,e,h),o(e,t),o(e,l),o(e,n),r[28](n),Q(g,i,h),Q(g,u,h),_&&_.m(u,null),o(u,d),b&&b.m(u,null)},p(g,h){g[5]===!0?_?_.p(g,h):(_=Tt(g),_.c(),_.m(u,d)):_&&(_.d(1),_=null),g[6]===!0||g[6]===!1&&g[5]===!1?b?b.p(g,h):(b=Ct(g),b.c(),b.m(u,null)):b&&(b.d(1),b=null)},d(g){g&&(a(e),a(i),a(u)),r[28](null),_&&_.d(),b&&b.d()}}}function Tt(r){let e,t=`<ion-icon icon="${On}" slot="start"></ion-icon>
                        Ingreso`,l,n;return{c(){e=s("ion-button"),e.innerHTML=t,this.h()},l(i){e=c(i,"ION-BUTTON",{id:!0,style:!0,"data-svelte-h":!0}),ie(e)!=="svelte-3onvnr"&&(e.innerHTML=t),this.h()},h(){v(e,"id","checkInBtn"),C(e,"flex","1")},m(i,u){Q(i,e,u),l||(n=ue(e,"click",r[22]),l=!0)},p:ze,d(i){i&&a(e),l=!1,n()}}}function Ct(r){let e,t,l,n,i,u;return{c(){e=s("ion-button"),t=s("ion-icon"),l=be(`
                        Salida`),this.h()},l(d){e=c(d,"ION-BUTTON",{id:!0,style:!0,disabled:!0});var _=m(e);t=c(_,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=Ee(_,`
                        Salida`),_.forEach(a),this.h()},h(){v(t,"icon",In),v(t,"slot","start"),v(e,"id","checkOutBtn"),C(e,"flex","1"),v(e,"disabled",n=r[6]===!1)},m(d,_){Q(d,e,_),o(e,t),o(e,l),i||(u=ue(e,"click",r[23]),i=!0)},p(d,_){_[0]&64&&n!==(n=d[6]===!1)&&v(e,"disabled",n)},d(d){d&&a(e),i=!1,u()}}}function lo(r){let e,t,l,n,i,u="Subir Evidencia",d,_,b,g;return{c(){e=s("section"),t=s("ion-button"),l=s("ion-icon"),n=N(),i=s("label"),i.textContent=u,d=N(),_=s("input"),this.h()},l(h){e=c(h,"SECTION",{style:!0});var f=m(e);t=c(f,"ION-BUTTON",{fill:!0,class:!0,style:!0});var p=m(t);l=c(p,"ION-ICON",{icon:!0,slot:!0}),m(l).forEach(a),n=T(p),i=c(p,"LABEL",{for:!0,"data-svelte-h":!0}),ie(i)!=="svelte-1wg51s6"&&(i.textContent=u),d=T(p),_=c(p,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0}),p.forEach(a),f.forEach(a),this.h()},h(){v(l,"icon",xt),v(l,"slot","start"),x(i,"for","eventEvidence"),C(_,"display","none"),x(_,"id","eventEvidence"),x(_,"name","fileToUpload"),x(_,"type","file"),_.multiple=!0,x(_,"accept","image/*"),v(t,"fill","outline"),v(t,"class","loadEvidence"),C(t,"flex","1"),C(e,"display","flex"),C(e,"gap","8px"),C(e,"padding","0px 16px")},m(h,f){Q(h,e,f),o(e,t),o(t,l),o(t,n),o(t,i),o(t,d),o(t,_),b||(g=[ue(_,"change",r[16]),ue(_,"click",r[17])],b=!0)},p:ze,d(h){h&&a(e),b=!1,Be(g)}}}function yt(r){let e,t='<ion-spinner name="dots"></ion-spinner>';return{c(){e=s("section"),e.innerHTML=t,this.h()},l(l){e=c(l,"SECTION",{style:!0,"data-svelte-h":!0}),ie(e)!=="svelte-1sj3e0"&&(e.innerHTML=t),this.h()},h(){C(e,"text-align","center")},m(l,n){Q(l,e,n)},d(l){l&&a(e)}}}function wt(r){let e,t,l=He(r[2]),n=[];for(let i=0;i<l.length;i+=1)n[i]=Lt(Et(r,l,i));return{c(){e=s("section"),t=s("div");for(let i=0;i<n.length;i+=1)n[i].c();this.h()},l(i){e=c(i,"SECTION",{});var u=m(e);t=c(u,"DIV",{class:!0,style:!0});var d=m(t);for(let _=0;_<n.length;_+=1)n[_].l(d);d.forEach(a),u.forEach(a),this.h()},h(){x(t,"class","image-grid"),C(t,"display","grid"),C(t,"grid-template-columns","repeat(auto-fill, minmax(100px, 1fr))"),C(t,"gap","10px"),C(t,"padding","0px 10px")},m(i,u){Q(i,e,u),o(e,t);for(let d=0;d<n.length;d+=1)n[d]&&n[d].m(t,null)},p(i,u){if(u[0]&17301508){l=He(i[2]);let d;for(d=0;d<l.length;d+=1){const _=Et(i,l,d);n[d]?n[d].p(_,u):(n[d]=Lt(_),n[d].c(),n[d].m(t,null))}for(;d<n.length;d+=1)n[d].d(1);n.length=l.length}},d(i){i&&a(e),on(n,i)}}}function Lt(r){let e,t,l,n,i,u=`<ion-icon icon="${Nn}"></ion-icon>`,d,_,b;function g(){return r[29](r[52])}function h(){return r[30](r[54])}return{c(){e=s("div"),t=s("ion-img"),n=N(),i=s("button"),i.innerHTML=u,d=N(),this.h()},l(f){e=c(f,"DIV",{class:!0,style:!0});var p=m(e);t=c(p,"ION-IMG",{src:!0,alt:!0,style:!0}),m(t).forEach(a),n=T(p),i=c(p,"BUTTON",{class:!0,style:!0,"data-svelte-h":!0}),ie(i)!=="svelte-zguiov"&&(i.innerHTML=u),d=T(p),p.forEach(a),this.h()},h(){Ke(t.src,l=r[52])||v(t,"src",l),v(t,"alt","Evidencia fotográfica"),C(t,"width","100%"),C(t,"height","100px"),C(t,"object-fit","cover"),C(t,"cursor","pointer"),C(t,"border","1px solid #ccc"),C(t,"border-radius","4px"),C(t,"margin-top","16px"),x(i,"class","remove-button"),C(i,"position","absolute"),C(i,"top","5px"),C(i,"right","5px"),C(i,"border","none"),C(i,"cursor","pointer"),C(i,"font-size","18px"),C(i,"background","white"),C(i,"border-radius","50%"),C(i,"padding","3px 4px 0px"),C(i,"box-shadow","2px 2px 6px rgba(0, 0, 0, 0.3)"),C(i,"color","#0000008f"),x(e,"class","image-container"),C(e,"position","relative")},m(f,p){Q(f,e,p),o(e,t),o(e,n),o(e,i),o(e,d),_||(b=[ue(t,"click",g),ue(i,"click",h)],_=!0)},p(f,p){r=f,p[0]&4&&!Ke(t.src,l=r[52])&&v(t,"src",l)},d(f){f&&a(e),_=!1,Be(b)}}}function zt(r){let e,t,l,n,i,u,d=`<ion-icon icon="${Tn}"></ion-icon>`,_,b;return{c(){e=s("div"),t=s("div"),l=s("ion-img"),i=N(),u=s("button"),u.innerHTML=d,this.h()},l(g){e=c(g,"DIV",{class:!0,style:!0});var h=m(e);t=c(h,"DIV",{class:!0,style:!0});var f=m(t);l=c(f,"ION-IMG",{src:!0,alt:!0,style:!0}),m(l).forEach(a),i=T(f),u=c(f,"BUTTON",{class:!0,style:!0,"data-svelte-h":!0}),ie(u)!=="svelte-g0qr0o"&&(u.innerHTML=d),f.forEach(a),h.forEach(a),this.h()},h(){Ke(l.src,n=r[12])||v(l,"src",n),v(l,"alt","Evidencia fotográfica"),C(l,"width","100%"),C(l,"height","auto"),x(u,"class","close-button"),C(u,"position","absolute"),C(u,"top","5px"),C(u,"right","5px"),C(u,"background","white"),C(u,"color","#444444d1"),C(u,"border","none"),C(u,"cursor","pointer"),C(u,"padding","2px 2px 0px 6px"),C(u,"border-radius","50%"),C(u,"font-size","20px"),x(t,"class","modal-content"),C(t,"position","relative"),C(t,"background","white"),C(t,"padding","20px"),C(t,"border-radius","8px"),C(t,"max-width","90vw"),C(t,"max-height","90vh"),C(t,"overflow","auto"),x(e,"class","modal-overlay"),C(e,"position","fixed"),C(e,"top","0"),C(e,"left","0"),C(e,"width","100vw"),C(e,"height","100vh"),C(e,"background","rgba(0, 0, 0, 0.8)"),C(e,"display","flex"),C(e,"justify-content","center"),C(e,"align-items","center"),C(e,"z-index","1000")},m(g,h){Q(g,e,h),o(e,t),o(t,l),o(t,i),o(t,u),_||(b=[ue(u,"click",r[25]),ue(t,"click",ln(r[26])),ue(e,"click",r[25])],_=!0)},p(g,h){h[0]&4096&&!Ke(l.src,n=g[12])&&v(l,"src",n)},d(g){g&&a(e),_=!1,Be(b)}}}function io(r){let e,t,l,n,i="Cerrar",u,d,_=r[13].title+"",b,g,h,f,p,E,O,y,R,z,K="Negocio",j,F,P=r[13].client_name+"",S,I,L=r[13].client_phone&&r[13].client_phone.trim().length,V,U,H,J,Y=r[13].schedule&&r[13].schedule.trim().length,ee,te,re=r[13].logistic_comments&&r[13].logistic_comments.trim().length,ge,ce,_e,Ie,fe,me,ke,Oe,ye,Te=(!r[14]&&!r[15]||r[14]&&r[15])&&Jn(r),he=L&&Yn(r);function Ne(M,$){if(M[13].line1&&M[13].line1.trim().length)return Zn;if(M[13].line2&&M[13].line2.trim().length)return Qn}let Ce=Ne(r),B=Ce&&Ce(r),X=r[7]&&It(r),A=r[8]&&r[8]!=="<br>"&&Ot(r),q=Y&&$n(r),G=r[13].driver_comments&&eo(r),D=re&&to(r),k=r[9]&&Nt(r),W=!r[15]&&oo(r),Z=(r[14]&&r[15]||!r[14]&&!r[15])&&lo(r),oe=r[4]&&yt(),ne=r[1]&&wt(r),w=r[11]&&zt(r);return{c(){e=s("ion-header"),t=s("ion-toolbar"),l=s("ion-buttons"),n=s("ion-button"),n.textContent=i,u=N(),d=s("ion-title"),b=be(_),g=N(),Te&&Te.c(),h=N(),f=s("ion-content"),p=s("ion-list"),E=s("ion-item"),O=s("ion-icon"),y=N(),R=s("ion-label"),z=s("p"),z.textContent=K,j=N(),F=s("h2"),S=be(P),I=N(),he&&he.c(),V=N(),B&&B.c(),U=N(),X&&X.c(),H=N(),A&&A.c(),J=N(),q&&q.c(),ee=N(),G&&G.c(),te=N(),D&&D.c(),ge=N(),k&&k.c(),ce=N(),W&&W.c(),_e=N(),Z&&Z.c(),Ie=N(),oe&&oe.c(),fe=N(),ne&&ne.c(),me=N(),w&&w.c(),ke=Se(),this.h()},l(M){e=c(M,"ION-HEADER",{translucent:!0});var $=m(e);t=c($,"ION-TOOLBAR",{});var le=m(t);l=c(le,"ION-BUTTONS",{slot:!0});var ae=m(l);n=c(ae,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),ie(n)!=="svelte-2ks32x"&&(n.textContent=i),ae.forEach(a),u=T(le),d=c(le,"ION-TITLE",{style:!0,title:!0});var pe=m(d);b=Ee(pe,_),pe.forEach(a),g=T(le),Te&&Te.l(le),le.forEach(a),$.forEach(a),h=T(M),f=c(M,"ION-CONTENT",{fullscreen:!0});var we=m(f);p=c(we,"ION-LIST",{});var se=m(p);E=c(se,"ION-ITEM",{});var de=m(E);O=c(de,"ION-ICON",{icon:!0,slot:!0}),m(O).forEach(a),y=T(de),R=c(de,"ION-LABEL",{});var ve=m(R);z=c(ve,"P",{"data-svelte-h":!0}),ie(z)!=="svelte-57b1dg"&&(z.textContent=K),j=T(ve),F=c(ve,"H2",{});var Ae=m(F);S=Ee(Ae,P),Ae.forEach(a),ve.forEach(a),de.forEach(a),I=T(se),he&&he.l(se),V=T(se),B&&B.l(se),U=T(se),X&&X.l(se),H=T(se),A&&A.l(se),J=T(se),q&&q.l(se),ee=T(se),G&&G.l(se),te=T(se),D&&D.l(se),ge=T(se),k&&k.l(se),ce=T(se),W&&W.l(se),_e=T(se),Z&&Z.l(se),Ie=T(se),oe&&oe.l(se),fe=T(se),ne&&ne.l(se),se.forEach(a),we.forEach(a),me=T(M),w&&w.l(M),ke=Se(),this.h()},h(){v(n,"color","medium"),v(l,"slot","start"),C(d,"text-align","center"),v(d,"title",r[13].title),v(e,"translucent",""),v(O,"icon",mn),v(O,"slot","start"),v(f,"fullscreen","")},m(M,$){Q(M,e,$),o(e,t),o(t,l),o(l,n),o(t,u),o(t,d),o(d,b),o(t,g),Te&&Te.m(t,null),Q(M,h,$),Q(M,f,$),o(f,p),o(p,E),o(E,O),o(E,y),o(E,R),o(R,z),o(R,j),o(R,F),o(F,S),o(p,I),he&&he.m(p,null),o(p,V),B&&B.m(p,null),o(p,U),X&&X.m(p,null),o(p,H),A&&A.m(p,null),o(p,J),q&&q.m(p,null),o(p,ee),G&&G.m(p,null),o(p,te),D&&D.m(p,null),o(p,ge),k&&k.m(p,null),o(p,ce),W&&W.m(p,null),o(p,_e),Z&&Z.m(p,null),o(p,Ie),oe&&oe.m(p,null),o(p,fe),ne&&ne.m(p,null),Q(M,me,$),w&&w.m(M,$),Q(M,ke,$),Oe||(ye=ue(n,"click",r[18]),Oe=!0)},p(M,$){(!M[14]&&!M[15]||M[14]&&M[15])&&Te.p(M,$),L&&he.p(M,$),B&&B.p(M,$),M[7]?X?X.p(M,$):(X=It(M),X.c(),X.m(p,H)):X&&(X.d(1),X=null),M[8]&&M[8]!=="<br>"?A?A.p(M,$):(A=Ot(M),A.c(),A.m(p,J)):A&&(A.d(1),A=null),Y&&q.p(M,$),M[13].driver_comments&&G.p(M,$),re&&D.p(M,$),M[9]?k?k.p(M,$):(k=Nt(M),k.c(),k.m(p,ce)):k&&(k.d(1),k=null),M[15]||W.p(M,$),(M[14]&&M[15]||!M[14]&&!M[15])&&Z.p(M,$),M[4]?oe||(oe=yt(),oe.c(),oe.m(p,fe)):oe&&(oe.d(1),oe=null),M[1]?ne?ne.p(M,$):(ne=wt(M),ne.c(),ne.m(p,null)):ne&&(ne.d(1),ne=null),M[11]?w?w.p(M,$):(w=zt(M),w.c(),w.m(ke.parentNode,ke)):w&&(w.d(1),w=null)},i:ze,o:ze,d(M){M&&(a(e),a(h),a(f),a(me),a(ke)),Te&&Te.d(),he&&he.d(),B&&B.d(),X&&X.d(),A&&A.d(),q&&q.d(),G&&G.d(),D&&D.d(),k&&k.d(),W&&W.d(),Z&&Z.d(),oe&&oe.d(),ne&&ne.d(),w&&w.d(M),Oe=!1,ye()}}}const At=/Teléfono:\s*(\d{10,})/;function Mt(r,e){for(let t=0;t<e.length;t++)if(e[t].alias===r)return e[t].val;return""}function ot(r=""){return r.split(",").map(t=>t.trim())}function ro(r,e,t){let l=it,n=document.querySelector("ion-modal"),i=n.componentProps.delivery,u=n.componentProps.isLast||!1,d=n.componentProps.flag||!1,_=i.driver_comments?i.driver_comments:"",b=i.img?i.img:"",g=i.img_id?i.img_id:"",h=b?ot(b):new Array,f=g?ot(g):new Array,p={latitude:null,longitude:null},E=new Object,O="",y="",R=!1,z=!0,K=!1,j="",F=i.comments_ext,P=!1,S="",I=!1,L=null,V=new Object;Ze(()=>{V=JSON.parse(localStorage.getItem("userSession")),Oe(),H()});async function U(k="",W,Z={}){let oe=new FormData;t(4,R=!0);for(const[ne,w]of Object.entries(Z))oe.append(ne,w);oe=B(oe);try{const ne=await fetch(k,{method:"POST",body:oe});if(ne.ok){const w=await ne.json();W(w)}else console.error("Request failed:",ne.statusText)}catch(ne){console.error("Error during file upload:",ne)}finally{t(4,R=!1)}}function H(){i.date_service?i.date_service&&!i.date_completed&&!i.service_time?(t(5,z=!1),t(6,K=!0)):i.date_service&&i.date_completed&&i.service_time&&(t(5,z=!1),t(6,K=!1)):(t(5,z=!0),t(6,K=!1))}if(i.comments_ext){const k=i.comments_ext.match(At);k&&(j=k[1],F=i.comments_ext.replace(At,"").trim())}const J=async(k,W)=>{await(await je.create({header:k||"Error",message:W||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()},Y=async(k="",W="",Z="",oe,ne={})=>{await(await je.create({header:k||"Error",message:W||"Vuelva a intentar",buttons:[{text:"No",role:"cancel",handler:()=>{console.log('User selected "No"')}},{text:"Sí",handler:()=>{U(Z,oe,ne)}}]})).present()},ee=async k=>{if(h.length==5)J("Límite de evidencias","Solo se permite subir 5 fotos por parada");else if(d&&u&&h.length==1)J("Límite de evidencias","Para el final de la ruta solo se permite subir 1 foto");else{const oe=k.target.files[0],ne=await ge(oe);if(ne){t(1,b=h.join(",")),g=f.join(",");var W=new Object;W.fileToUpload=ne,W.token=V.token,W.id_user_over=V.id_user,U(`${l}api/admin/manager/upload_img_driver.php`,function(w){t(1,b=b?`${b},${w.img}`:w.img),g=g?`${g},${w.img_id}`:w.img_id,t(2,h=ot(b)),f=ot(g)},W)}}};function te(k){var W=i.service_time;!W&&z&&!u&&!d&&(k.preventDefault(),J("Registrar Ingreso","Antes de subir la evidencia registra el ingreso a la actual parada."))}function re(){var k=d?i.date_completed:!1;if(!k&&!z&&K&&!u&&!d){var W=new Object;W.id_event=i.id_event,W.type="checkout",Y("Registrar Salida","¿Completaste tu entrega?",l+"api/admin/route/record_check_date.php",function(Z){Z.minutes&&J("Tiempo por parada","Completaste la parada en "+Z.minutes+" minutos.")},W)}}const ge=async k=>new Promise(W=>{const Z=new FileReader;Z.onload=oe=>{const ne=new Image;ne.src=oe.target.result,ne.onload=()=>{const w=document.createElement("canvas"),M=w.getContext("2d"),$=800,le=600;let ae=ne.width,pe=ne.height;ae>$&&(pe*=$/ae,ae=$),pe>le&&(ae*=le/pe,pe=le),w.width=ae,w.height=pe,M.drawImage(ne,0,0,ae,pe),w.toBlob(we=>{W(we)},"image/jpeg",.7)}},Z.readAsDataURL(k)}),ce=()=>{n.dismiss({data:Date.now()})};function _e(k){t(2,h=h.filter((W,Z)=>Z!==k))}const Ie=async()=>{try{if(t(1,b=h.join(",")),g=f.join(","),re(),await me()){const W={id_route:i.id_route,...d&&u==!1&&{id_event:i.id_event},...d&&u==!1&&{comments:_.value},img:b,img_id:g,lat:p.latitude,lon:p.longitude,...O==="0"&&{approve:"0"},...u&&{isLast:!0},...d&&u==!0&&{destiny:!0},token:V.token,id_user_over:V.id_user};W.img&&W.img_id?U(`${l}api/admin/evidence/send_evidence.php`,function(Z){if(Z.success==!0){const oe=W.id_route;ce(),u&&fe("","",oe,u)}else J("Carga fallida","Actualiza la página y vuelve a intentar cargar la información!")},W):J("Información incompleta","Cargar evidencia fotográfica faltante para completar parada.")}else J("Ubicación faltante","Asegúrate darle permisos a Rutaflow para acceder a tu ubicación")}catch(k){console.error("Error fetching data:",k)}},fe=(k,W,Z,oe)=>{n.componentProps.routeId=Z,n.componentProps.driverId=i.id_driver,Ue("modal-km-gas",en,{checklist:k,driverId:W,routeId:Z,isLast:oe}).then(ne=>{})},me=async()=>navigator.geolocation?new Promise((k,W)=>{navigator.geolocation.getCurrentPosition(Z=>{p.latitude=Z.coords.latitude,p.longitude=Z.coords.longitude,k(!0)},Z=>{console.error("Error getting location:",Z),k(!1)})}):(console.error("Geolocation is not supported by your browser"),!1);async function ke(k){k.stopPropagation();let W=new FormData;W.append("client_phone",j),W.append("client_name",i.title),W.append("delivery_phone",i.client_phone),W.append("enterprise_name",i.enterprise_name),W=B(W);try{const Z=await fetch(`${l}api/admin/message_central/send_sms.php`,{method:"POST",body:W});if(Z.ok){const oe=await Z.json();J("SMS enviado","Se envío correctamente un SMS a "+i.title+" con número de teléfono: "+j)}else J("SMS no enviado","Hubo un error al enviar SMS a "+i.title+" con número de teléfono: "+phoneNumber0+". Por favor contacte a soporte.")}catch(Z){console.error("Error during file upload:",Z)}}const Oe=async()=>{if(i.id_enterprise){let k=new FormData;k.append("id_enterprise",i.id_enterprise),k=B(k);try{const W=await fetch(`${l}api/admin/enterprise/enterprise_settings.php`,{method:"POST",body:k});W.ok?(E=(await W.json()).nodos,O=Mt("stops_wait_approval",E),t(3,y=Mt("sms_active",E))):console.error("File upload failed:",W.statusText)}catch(W){console.error("Error during file upload:",W)}}};function ye(){t(5,z=!1),t(6,K=!0),he(i.id_event,"checkin")}function Te(){t(6,K=!1),t(5,z=!1),he(i.id_event,"checkout")}async function he(k,W){if(W){let Z=new FormData;Z.append("type",W),Z.append("id_event",k),Z=B(Z);try{const oe=await fetch(`${l}api/admin/route/record_check_date.php`,{method:"POST",body:Z});if(oe.ok){const ne=await oe.json();ne.minutes&&J("Tiempo por parada","Completaste la parada en "+ne.minutes+" minutos.")}else console.error("File upload failed:",oe.statusText)}catch(oe){console.error("Error during file upload:",oe)}finally{}}}const Ne=k=>{t(12,L=k),t(11,I=!0)},Ce=()=>{t(11,I=!1),t(12,L=null)};function B(k){return k.append("token",V.token),k.append("id_user_over",V.id_user),k}function X(k){rn.call(this,r,k)}function A(k){De[k?"unshift":"push"](()=>{S=k,t(10,S)})}function q(k){De[k?"unshift":"push"](()=>{_=k,t(0,_)})}return[_,b,h,y,R,z,K,j,F,P,S,I,L,i,u,d,ee,te,ce,_e,Ie,ke,ye,Te,Ne,Ce,X,A,q,k=>Ne(k),k=>_e(k)]}class St extends Je{constructor(e){super(),Ye(this,e,ro,io,We,{},null,[-1,-1])}}function Dt(r){let e;return{c(){e=s("ion-spinner"),this.h()},l(t){e=c(t,"ION-SPINNER",{name:!0}),m(e).forEach(a),this.h()},h(){v(e,"name","dots")},m(t,l){Q(t,e,l)},d(t){t&&a(e)}}}function Pt(r){let e,t,l;return{c(){e=s("section"),t=s("ion-img"),this.h()},l(n){e=c(n,"SECTION",{});var i=m(e);t=c(i,"ION-IMG",{src:!0,alt:!0,style:!0}),m(t).forEach(a),i.forEach(a),this.h()},h(){Ke(t.src,l=r[0])||v(t,"src",l),v(t,"alt","Evidencia fotográfica"),C(t,"max-width","100%"),C(t,"margin-top","16px")},m(n,i){Q(n,e,i),o(e,t)},p(n,i){i&1&&!Ke(t.src,l=n[0])&&v(t,"src",l)},d(n){n&&a(e)}}}function ao(r){let e,t,l,n,i="Cancelar",u,d,_="AGREGAR GASTO",b,g,h,f,p,E,O,y,R,z,K,j,F,P,S,I,L,V,U='Tipo de pago <ion-text color="danger">(Obligatorio)</ion-text>',H,J,Y="Efectivo",ee,te,re="Tarjeta",ge,ce,_e="Transferencia",Ie,fe,me,ke,Oe,ye,Te,he,Ne,Ce,B=`<ion-icon icon="${xt}" slot="start"></ion-icon>
                        Subir Evidencia`,X,A,q,G,D,k,W,Z,oe="Confirmar",ne,w,M=r[5]&&Dt(),$=r[0]&&Pt(r);return{c(){e=s("ion-header"),t=s("ion-toolbar"),l=s("ion-buttons"),n=s("ion-button"),n.textContent=i,u=N(),d=s("ion-title"),d.textContent=_,b=N(),g=s("ion-content"),h=s("ion-list"),f=s("ion-item"),p=s("ion-icon"),E=N(),O=s("ion-input"),y=N(),R=s("ion-item"),z=s("ion-icon"),K=N(),j=s("ion-input"),F=N(),P=s("ion-item"),S=s("ion-icon"),I=N(),L=s("ion-select"),V=s("div"),V.innerHTML=U,H=N(),J=s("ion-select-option"),J.textContent=Y,ee=N(),te=s("ion-select-option"),te.textContent=re,ge=N(),ce=s("ion-select-option"),ce.textContent=_e,Ie=N(),fe=s("ion-item"),me=s("ion-icon"),ke=N(),Oe=s("ion-textarea"),ye=N(),Te=s("section"),he=s("label"),Ne=s("ion-button"),Ce=s("label"),Ce.innerHTML=B,X=N(),A=s("input"),q=N(),M&&M.c(),G=N(),$&&$.c(),D=N(),k=s("ion-footer"),W=s("ion-toolbar"),Z=s("ion-button"),Z.textContent=oe,this.h()},l(le){e=c(le,"ION-HEADER",{translucent:!0});var ae=m(e);t=c(ae,"ION-TOOLBAR",{});var pe=m(t);l=c(pe,"ION-BUTTONS",{slot:!0});var we=m(l);n=c(we,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),ie(n)!=="svelte-1f8rjcf"&&(n.textContent=i),we.forEach(a),u=T(pe),d=c(pe,"ION-TITLE",{title:!0,"data-svelte-h":!0}),ie(d)!=="svelte-efps2s"&&(d.textContent=_),pe.forEach(a),ae.forEach(a),b=T(le),g=c(le,"ION-CONTENT",{fullscreen:!0});var se=m(g);h=c(se,"ION-LIST",{});var de=m(h);f=c(de,"ION-ITEM",{});var ve=m(f);p=c(ve,"ION-ICON",{icon:!0,slot:!0}),m(p).forEach(a),E=T(ve),O=c(ve,"ION-INPUT",{label:!0,type:!0,placeholder:!0,value:!0}),m(O).forEach(a),ve.forEach(a),y=T(de),R=c(de,"ION-ITEM",{});var Ae=m(R);z=c(Ae,"ION-ICON",{icon:!0,slot:!0}),m(z).forEach(a),K=T(Ae),j=c(Ae,"ION-INPUT",{label:!0,type:!0,value:!0}),m(j).forEach(a),Ae.forEach(a),F=T(de),P=c(de,"ION-ITEM",{});var Ve=m(P);S=c(Ve,"ION-ICON",{icon:!0,slot:!0}),m(S).forEach(a),I=T(Ve),L=c(Ve,"ION-SELECT",{placeholder:!0,value:!0});var Fe=m(L);V=c(Fe,"DIV",{slot:!0,"data-svelte-h":!0}),ie(V)!=="svelte-wl764p"&&(V.innerHTML=U),H=T(Fe),J=c(Fe,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),ie(J)!=="svelte-i9crym"&&(J.textContent=Y),ee=T(Fe),te=c(Fe,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),ie(te)!=="svelte-fx0z11"&&(te.textContent=re),ge=T(Fe),ce=c(Fe,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),ie(ce)!=="svelte-1c24jf2"&&(ce.textContent=_e),Fe.forEach(a),Ve.forEach(a),Ie=T(de),fe=c(de,"ION-ITEM",{});var tt=m(fe);me=c(tt,"ION-ICON",{icon:!0,slot:!0}),m(me).forEach(a),ke=T(tt),Oe=c(tt,"ION-TEXTAREA",{label:!0,placeholder:!0}),m(Oe).forEach(a),tt.forEach(a),ye=T(de),Te=c(de,"SECTION",{});var ht=m(Te);he=c(ht,"LABEL",{for:!0,style:!0});var pt=m(he);Ne=c(pt,"ION-BUTTON",{fill:!0,size:!0,class:!0,expand:!0});var nt=m(Ne);Ce=c(nt,"LABEL",{for:!0,style:!0,"data-svelte-h":!0}),ie(Ce)!=="svelte-1m9yw22"&&(Ce.innerHTML=B),X=T(nt),A=c(nt,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0}),nt.forEach(a),pt.forEach(a),ht.forEach(a),q=T(de),M&&M.l(de),G=T(de),$&&$.l(de),de.forEach(a),se.forEach(a),D=T(le),k=c(le,"ION-FOOTER",{});var mt=m(k);W=c(mt,"ION-TOOLBAR",{});var vt=m(W);Z=c(vt,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),ie(Z)!=="svelte-1c7dl3f"&&(Z.textContent=oe),vt.forEach(a),mt.forEach(a),this.h()},h(){v(n,"color","medium"),v(l,"slot","start"),v(d,"title",""),v(e,"translucent",""),v(p,"icon",Zt),v(p,"slot","start"),v(O,"label","Concepto"),v(O,"type","text"),v(O,"placeholder","Escribe aquí..."),v(O,"value",r[6]?r[6]:""),v(z,"icon",st),v(z,"slot","start"),v(j,"label","Cantidad"),v(j,"type","number"),v(j,"value",r[7]?r[7]:""),v(S,"icon",Cn),v(S,"slot","start"),x(V,"slot","label"),v(J,"value","cash"),v(te,"value","card"),v(ce,"value","transfer"),v(L,"placeholder","Tipo de pago"),v(L,"value",r[8]?r[8]:""),v(me,"icon",st),v(me,"slot","start"),v(Oe,"label","Comentarios"),v(Oe,"placeholder","Escribe aquí..."),x(Ce,"for","eventEvidence"),C(Ce,"width","100%"),C(Ce,"padding","8px"),C(A,"display","none"),x(A,"id","eventEvidence"),x(A,"name","fileToUpload"),x(A,"type","file"),x(A,"accept","image/*"),v(Ne,"fill","outline"),v(Ne,"size","small"),v(Ne,"class","loadEvidence"),v(Ne,"expand","block"),x(he,"for","eventEvidence"),C(he,"display","block"),C(he,"width","100%"),v(g,"fullscreen",""),v(Z,"fill","outline"),v(Z,"color","tertiary"),v(Z,"strong",""),C(Z,"width","99%"),C(Z,"height","auto")},m(le,ae){Q(le,e,ae),o(e,t),o(t,l),o(l,n),o(t,u),o(t,d),Q(le,b,ae),Q(le,g,ae),o(g,h),o(h,f),o(f,p),o(f,E),o(f,O),r[12](O),o(h,y),o(h,R),o(R,z),o(R,K),o(R,j),r[13](j),o(h,F),o(h,P),o(P,S),o(P,I),o(P,L),o(L,V),o(L,H),o(L,J),o(L,ee),o(L,te),o(L,ge),o(L,ce),r[14](L),o(h,Ie),o(h,fe),o(fe,me),o(fe,ke),o(fe,Oe),r[15](Oe),o(h,ye),o(h,Te),o(Te,he),o(he,Ne),o(Ne,Ce),o(Ne,X),o(Ne,A),o(h,q),M&&M.m(h,null),o(h,G),$&&$.m(h,null),Q(le,D,ae),Q(le,k,ae),o(k,W),o(W,Z),ne||(w=[ue(n,"click",r[10]),ue(A,"change",r[9]),ue(Z,"click",r[11])],ne=!0)},p(le,[ae]){le[5]?M||(M=Dt(),M.c(),M.m(h,G)):M&&(M.d(1),M=null),le[0]?$?$.p(le,ae):($=Pt(le),$.c(),$.m(h,null)):$&&($.d(1),$=null)},i:ze,o:ze,d(le){le&&(a(e),a(b),a(g),a(D),a(k)),r[12](null),r[13](null),r[14](null),r[15](null),M&&M.d(),$&&$.d(),ne=!1,Be(w)}}}function so(r,e,t){let l=it,n=document.querySelector("ion-modal"),i=n.componentProps.routeId,u=n.componentProps.ex_concept,d=n.componentProps.ex_amount,_=n.componentProps.ex_type,b=n.componentProps.id_expense,g="",h="",f="",p=0,E="",O="",y=!1,R=new Object;Ze(()=>{R=JSON.parse(localStorage.getItem("userSession"))});const z=async(H,J)=>{await(await je.create({header:H,message:J,buttons:[{text:"Cerrar"}]})).present()},K=async H=>{t(5,y=!0);const Y=H.target.files[0],ee=await j(Y);if(ee){let te=new FormData;te.append("fileToUpload",ee),te=S(te);try{const re=await fetch(`${l}api/admin/manager/upload_img_driver.php`,{method:"POST",body:te});if(re.ok){const ge=await re.json();t(0,g=ge.img),h=ge.img_id}else console.error("File upload failed:",re.statusText)}catch(re){console.error("Error during file upload:",re)}finally{t(5,y=!1)}}},j=async H=>new Promise(J=>{const Y=new FileReader;Y.onload=ee=>{const te=new Image;te.src=ee.target.result,te.onload=()=>{const re=document.createElement("canvas"),ge=re.getContext("2d"),ce=800,_e=600;let Ie=te.width,fe=te.height;Ie>ce&&(fe*=ce/Ie,Ie=ce),fe>_e&&(Ie*=_e/fe,fe=_e),re.width=Ie,re.height=fe,ge.drawImage(te,0,0,Ie,fe),re.toBlob(me=>{J(me)},"image/jpeg",.7)}},Y.readAsDataURL(H)}),F=()=>{et.dismiss()},P=()=>{var H=new Object;H.id_route=i,H.comments=E.value,H.type=f.value,H.img=g,H.img_id=h,H.amount=p.value,H.concept=O.value,H.status="done",H.id_expense=b||"null";let J=new FormData;for(const Y in H)J.append(Y,H[Y]);J=S(J),!h||!g||!E.value||!p.value||!O.value?z("Datos incompletos","Llena los datos requeridos para completar el registro"):fetch(`${l}api/admin/expenses/add_expense.php`,{method:"POST",body:J}).then(Y=>Y.json()).then(Y=>{F()}).catch(Y=>{console.error("Error fetching data:",Y)})};function S(H){return H.append("token",R.token),H.append("id_user_over",R.id_user),H}function I(H){De[H?"unshift":"push"](()=>{O=H,t(4,O)})}function L(H){De[H?"unshift":"push"](()=>{p=H,t(2,p)})}function V(H){De[H?"unshift":"push"](()=>{f=H,t(1,f)})}function U(H){De[H?"unshift":"push"](()=>{E=H,t(3,E)})}return[g,f,p,E,O,y,u,d,_,K,F,P,I,L,V,U]}class ut extends Je{constructor(e){super(),Ye(this,e,so,ao,We,{})}}function Bt(r,e,t){const l=r.slice();return l[7]=e[t],l}function co(r){let e,t="Cargar gasto",l,n;function i(...u){return r[4](r[7],...u)}return{c(){e=s("ion-button"),e.textContent=t,this.h()},l(u){e=c(u,"ION-BUTTON",{fill:!0,size:!0,"aria-selected":!0,"data-svelte-h":!0}),ie(e)!=="svelte-175aelj"&&(e.textContent=t),this.h()},h(){v(e,"fill","outline"),v(e,"size","small"),v(e,"aria-selected","")},m(u,d){Q(u,e,d),l||(n=ue(e,"click",i),l=!0)},p(u,d){r=u},d(u){u&&a(e),l=!1,n()}}}function uo(r){let e,t="Gasto completado";return{c(){e=s("ion-button"),e.textContent=t,this.h()},l(l){e=c(l,"ION-BUTTON",{fill:!0,size:!0,"aria-selected":!0,"data-svelte-h":!0}),ie(e)!=="svelte-tlger7"&&(e.textContent=t),this.h()},h(){v(e,"fill","solid"),v(e,"size","small"),v(e,"aria-selected","")},m(l,n){Q(l,e,n)},p:ze,d(l){l&&a(e)}}}function Ht(r,e){let t,l,n,i=e[7].concept+"",u,d,_;function b(f,p){return f[7].status=="done"?uo:co}let h=b(e)(e);return{key:r,first:null,c(){t=s("ion-item"),l=s("ion-label"),n=s("p"),u=be(i),d=N(),h.c(),_=N(),this.h()},l(f){t=c(f,"ION-ITEM",{});var p=m(t);l=c(p,"ION-LABEL",{style:!0});var E=m(l);n=c(E,"P",{style:!0});var O=m(n);u=Ee(O,i),O.forEach(a),E.forEach(a),d=T(p),h.l(p),_=T(p),p.forEach(a),this.h()},h(){C(n,"margin-left","10px"),C(l,"display","flex"),this.first=t},m(f,p){Q(f,t,p),o(t,l),o(l,n),o(n,u),o(t,d),h.m(t,null),o(t,_)},p(f,p){e=f,h.p(e,p)},d(f){f&&a(t),h.d()}}}function fo(r){let e,t,l,n,i=`<ion-icon style="font-size: 25px!important;" icon="${yn}"></ion-icon>`,u,d,_="LISTA DE GASTOS",b,g,h,f=[],p=new Map,E,O,y,R="Cerrar",z,K,j=He(r[0]);const F=P=>P[7].id_expenses;for(let P=0;P<j.length;P+=1){let S=Bt(r,j,P),I=F(S);p.set(I,f[P]=Ht(I,S))}return{c(){e=s("ion-header"),t=s("ion-toolbar"),l=s("ion-buttons"),n=s("ion-button"),n.innerHTML=i,u=N(),d=s("ion-title"),d.textContent=_,b=N(),g=s("ion-content"),h=s("ion-list");for(let P=0;P<f.length;P+=1)f[P].c();E=N(),O=s("ion-footer"),y=s("ion-button"),y.textContent=R,this.h()},l(P){e=c(P,"ION-HEADER",{translucent:!0});var S=m(e);t=c(S,"ION-TOOLBAR",{});var I=m(t);l=c(I,"ION-BUTTONS",{slot:!0});var L=m(l);n=c(L,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),ie(n)!=="svelte-160xz3i"&&(n.innerHTML=i),L.forEach(a),u=T(I),d=c(I,"ION-TITLE",{"data-svelte-h":!0}),ie(d)!=="svelte-1phn90x"&&(d.textContent=_),I.forEach(a),S.forEach(a),b=T(P),g=c(P,"ION-CONTENT",{fullscreen:!0});var V=m(g);h=c(V,"ION-LIST",{});var U=m(h);for(let J=0;J<f.length;J+=1)f[J].l(U);U.forEach(a),V.forEach(a),E=T(P),O=c(P,"ION-FOOTER",{});var H=m(O);y=c(H,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),ie(y)!=="svelte-zv7v83"&&(y.textContent=R),H.forEach(a),this.h()},h(){v(n,"color","medium"),v(l,"slot","end"),v(e,"translucent",""),v(g,"fullscreen",""),v(y,"fill","outline"),v(y,"color","tertiary"),v(y,"strong",""),C(y,"width","99%"),C(y,"height","auto")},m(P,S){Q(P,e,S),o(e,t),o(t,l),o(l,n),o(t,u),o(t,d),Q(P,b,S),Q(P,g,S),o(g,h);for(let I=0;I<f.length;I+=1)f[I]&&f[I].m(h,null);Q(P,E,S),Q(P,O,S),o(O,y),z||(K=[ue(n,"click",r[3]),ue(y,"click",r[1])],z=!0)},p(P,[S]){S&5&&(j=He(P[0]),f=xe(f,S,F,1,P,j,p,h,$e,Ht,null,Bt))},i:ze,o:ze,d(P){P&&(a(e),a(b),a(g),a(E),a(O));for(let S=0;S<f.length;S+=1)f[S].d();z=!1,Be(K)}}}function _o(r){let e=document.querySelector("ion-modal");e.componentProps.routeId;let t=e.componentProps.expenses;Ze(()=>{});const l=()=>{et.dismiss()};function n(d,_,b,g,h){e.componentProps.ex_amount=b,e.componentProps.ex_concept=_,e.componentProps.ex_type=g,e.componentProps.id_expense=h,Ue("modal-expense",ut,{amount:b,concept:_,type:g,id_expense:h}).then(()=>{}),l()}return[t,l,n,d=>{Ue("modal-expense",ut,{routeId:d}).then(_=>{}),l()},(d,_)=>n(_,d.concept,d.amount,d.type,d.id_expenses)]}class ho extends Je{constructor(e){super(),Ye(this,e,_o,fo,We,{})}}const{document:Rt}=Dn;function Ut(r,e,t){const l=r.slice();return l[45]=e[t],l[47]=t,l}function Vt(r,e,t){const l=r.slice();return l[45]=e[t],l[47]=t,l}function Ft(r,e,t){const l=r.slice();return l[45]=e[t],l[47]=t,l}function qt(r){let e,t;return e=new An({props:{$$slots:{default:[Io]},$$scope:{ctx:r}}}),{c(){fn(e.$$.fragment)},l(l){dn(e.$$.fragment,l)},m(l,n){_n(e,l,n),t=!0},p(l,n){const i={};n[0]&1019|n[1]&524288&&(i.$$scope={dirty:n,ctx:l}),e.$set(i)},i(l){t||(lt(e.$$.fragment,l),t=!0)},o(l){at(e.$$.fragment,l),t=!1},d(l){hn(e,l)}}}function po(r){let e,t='<div id="g_map" style="width: 100%; height: 100vh;"></div>';return{c(){e=s("ion-content"),e.innerHTML=t},l(l){e=c(l,"ION-CONTENT",{"data-svelte-h":!0}),ie(e)!=="svelte-1ydw6i9"&&(e.innerHTML=t)},m(l,n){Q(l,e,n)},p:ze,d(l){l&&a(e)}}}function mo(r){let e;function t(i,u){if(i[7].length>0)return go;if(!i[3])return vo}let l=t(r),n=l&&l(r);return{c(){n&&n.c(),e=Se()},l(i){n&&n.l(i),e=Se()},m(i,u){n&&n.m(i,u),Q(i,e,u)},p(i,u){l===(l=t(i))&&n?n.p(i,u):(n&&n.d(1),n=l&&l(i),n&&(n.c(),n.m(e.parentNode,e)))},d(i){i&&a(e),n&&n.d(i)}}}function vo(r){let e,t,l,n='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Jala para actualizar" refreshing-spinner="circles" refreshing-text="Actualizando..."></ion-refresher-content>',i,u,d,_,b,g,h="0",f,p,E,O,y,R=r[6].origin+"",z,K,j,F="",P,S,I,L=[],V=new Map,U,H,J,Y,ee,te=r[5].length+1+"",re,ge,ce,_e,Ie,fe,me=r[6].destination+"",ke,Oe,ye,Te="",he,Ne,Ce,B,X=r[4]&&jt(r),A=He(r[5]);const q=G=>G[45].id_event;for(let G=0;G<A.length;G+=1){let D=Ut(r,A,G),k=q(D);V.set(k,L[G]=Kt(k,D))}return{c(){X&&X.c(),e=N(),t=s("ion-content"),l=s("ion-refresher"),l.innerHTML=n,i=N(),u=s("ion-list"),d=s("ion-item"),_=s("ion-avatar"),b=s("div"),g=s("div"),g.textContent=h,p=N(),E=s("ion-label"),O=s("ion-text"),y=s("h3"),z=be(R),K=N(),j=s("div"),j.innerHTML=F,P=N(),S=s("ion-icon"),I=N();for(let G=0;G<L.length;G+=1)L[G].c();U=N(),H=s("ion-item"),J=s("ion-avatar"),Y=s("div"),ee=s("div"),re=be(te),ce=N(),_e=s("ion-label"),Ie=s("ion-text"),fe=s("h3"),ke=be(me),Oe=N(),ye=s("div"),ye.innerHTML=Te,he=N(),Ne=s("ion-icon"),this.h()},l(G){X&&X.l(G),e=T(G),t=c(G,"ION-CONTENT",{});var D=m(t);l=c(D,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),ie(l)!=="svelte-1srnbs3"&&(l.innerHTML=n),i=T(D),u=c(D,"ION-LIST",{});var k=m(u);d=c(k,"ION-ITEM",{});var W=m(d);_=c(W,"ION-AVATAR",{slot:!0});var Z=m(_);b=c(Z,"DIV",{class:!0,title:!0,style:!0});var oe=m(b);g=c(oe,"DIV",{class:!0,"data-svelte-h":!0}),ie(g)!=="svelte-3lvlrb"&&(g.textContent=h),oe.forEach(a),Z.forEach(a),p=T(W),E=c(W,"ION-LABEL",{button:!0});var ne=m(E);O=c(ne,"ION-TEXT",{color:!0});var w=m(O);y=c(w,"H3",{});var M=m(y);z=Ee(M,R),M.forEach(a),w.forEach(a),K=T(ne),j=c(ne,"DIV",{class:!0,"data-svelte-h":!0}),ie(j)!=="svelte-gz9kb"&&(j.innerHTML=F),ne.forEach(a),P=T(W),S=c(W,"ION-ICON",{icon:!0,slot:!0}),m(S).forEach(a),W.forEach(a),I=T(k);for(let ve=0;ve<L.length;ve+=1)L[ve].l(k);U=T(k),H=c(k,"ION-ITEM",{});var $=m(H);J=c($,"ION-AVATAR",{slot:!0});var le=m(J);Y=c(le,"DIV",{class:!0,title:!0,style:!0});var ae=m(Y);ee=c(ae,"DIV",{class:!0});var pe=m(ee);re=Ee(pe,te),pe.forEach(a),ae.forEach(a),le.forEach(a),ce=T($),_e=c($,"ION-LABEL",{button:!0});var we=m(_e);Ie=c(we,"ION-TEXT",{color:!0});var se=m(Ie);fe=c(se,"H3",{});var de=m(fe);ke=Ee(de,me),de.forEach(a),se.forEach(a),Oe=T(we),ye=c(we,"DIV",{class:!0,"data-svelte-h":!0}),ie(ye)!=="svelte-130ohbs"&&(ye.innerHTML=Te),we.forEach(a),he=T($),Ne=c($,"ION-ICON",{icon:!0,slot:!0}),m(Ne).forEach(a),$.forEach(a),k.forEach(a),D.forEach(a),this.h()},h(){v(l,"slot","fixed"),x(g,"class","order svelte-egzizz"),x(b,"class","order-wrapper svelte-egzizz"),x(b,"title",f="$"+r[6].origin),C(b,"background-color",r[6].color),C(b,"color",Me(r[6].color)),v(_,"slot","start"),v(O,"color","#2e2e2e"),x(j,"class","sub svelte-egzizz"),v(E,"button",""),v(S,"icon",Re),v(S,"slot","end"),x(ee,"class","order svelte-egzizz"),x(Y,"class","order-wrapper svelte-egzizz"),x(Y,"title",ge="$"+r[6].destination),C(Y,"background-color",r[6].color),C(Y,"color",Me(r[6].color)),v(J,"slot","start"),v(Ie,"color","#2e2e2e"),x(ye,"class","sub svelte-egzizz"),v(_e,"button",""),v(Ne,"icon",Re),v(Ne,"slot","end")},m(G,D){X&&X.m(G,D),Q(G,e,D),Q(G,t,D),o(t,l),r[30](l),o(t,i),o(t,u),o(u,d),o(d,_),o(_,b),o(b,g),o(d,p),o(d,E),o(E,O),o(O,y),o(y,z),o(E,K),o(E,j),o(d,P),o(d,S),o(u,I);for(let k=0;k<L.length;k+=1)L[k]&&L[k].m(u,null);o(u,U),o(u,H),o(H,J),o(J,Y),o(Y,ee),o(ee,re),o(H,ce),o(H,_e),o(_e,Ie),o(Ie,fe),o(fe,ke),o(_e,Oe),o(_e,ye),o(H,he),o(H,Ne),Ce||(B=[ue(l,"ionRefresh",r[10]),ue(E,"click",r[31]),ue(_e,"click",r[33])],Ce=!0)},p(G,D){G[4]?X?X.p(G,D):(X=jt(G),X.c(),X.m(e.parentNode,e)):X&&(X.d(1),X=null),D[0]&64&&f!==(f="$"+G[6].origin)&&x(b,"title",f),D[0]&64&&C(b,"background-color",G[6].color),D[0]&64&&C(b,"color",Me(G[6].color)),D[0]&64&&R!==(R=G[6].origin+"")&&Le(z,R),D[0]&331808&&(A=He(G[5]),L=xe(L,D,q,1,G,A,V,u,$e,Kt,U,Ut)),D[0]&32&&te!==(te=G[5].length+1+"")&&Le(re,te),D[0]&64&&ge!==(ge="$"+G[6].destination)&&x(Y,"title",ge),D[0]&64&&C(Y,"background-color",G[6].color),D[0]&64&&C(Y,"color",Me(G[6].color)),D[0]&64&&me!==(me=G[6].destination+"")&&Le(ke,me)},d(G){G&&(a(e),a(t)),X&&X.d(G),r[30](null);for(let D=0;D<L.length;D+=1)L[D].d();Ce=!1,Be(B)}}}function go(r){let e,t;function l(u,d){return d[0]&144&&(e=null),e==null&&(e=!!(u[7].filter(Oo).every(No)&&!u[4])),e?Eo:bo}let n=l(r,[-1,-1]),i=n(r);return{c(){i.c(),t=Se()},l(u){i.l(u),t=Se()},m(u,d){i.m(u,d),Q(u,t,d)},p(u,d){n===(n=l(u,d))&&i?i.p(u,d):(i.d(1),i=n(u),i&&(i.c(),i.m(t.parentNode,t)))},d(u){u&&a(t),i.d(u)}}}function jt(r){let e=r[14]("",r[1],r[0])+"",t;return{c(){t=be(e)},l(l){t=Ee(l,e)},m(l,n){Q(l,t,n)},p(l,n){n[0]&3&&e!==(e=l[14]("",l[1],l[0])+"")&&Le(t,e)},d(l){l&&a(t)}}}function Gt(r){let e;return{c(){e=s("span"),this.h()},l(t){e=c(t,"SPAN",{class:!0}),m(e).forEach(a),this.h()},h(){x(e,"class","notes svelte-egzizz")},m(t,l){Q(t,e,l)},d(t){t&&a(e)}}}function Kt(r,e){let t,l,n,i,u=parseInt(e[45].pos)+1+"",d,_,b,g,h,f,p=e[45].title+"",E,O,y=e[45].support_list&&e[45].support_list.length||e[16](e[45]),R,z,K,j,F=y&&Gt();function P(){return e[32](e[45])}return{key:r,first:null,c(){t=s("ion-item"),l=s("ion-avatar"),n=s("div"),i=s("div"),d=be(u),b=N(),g=s("ion-label"),h=s("ion-text"),f=s("h3"),E=be(p),O=N(),F&&F.c(),R=N(),z=s("ion-icon"),this.h()},l(S){t=c(S,"ION-ITEM",{});var I=m(t);l=c(I,"ION-AVATAR",{slot:!0});var L=m(l);n=c(L,"DIV",{class:!0,title:!0,style:!0});var V=m(n);i=c(V,"DIV",{class:!0});var U=m(i);d=Ee(U,u),U.forEach(a),V.forEach(a),L.forEach(a),b=T(I),g=c(I,"ION-LABEL",{button:!0});var H=m(g);h=c(H,"ION-TEXT",{color:!0});var J=m(h);f=c(J,"H3",{});var Y=m(f);E=Ee(Y,p),O=T(Y),F&&F.l(Y),Y.forEach(a),J.forEach(a),H.forEach(a),R=T(I),z=c(I,"ION-ICON",{icon:!0,slot:!0,style:!0}),m(z).forEach(a),I.forEach(a),this.h()},h(){x(i,"class","order svelte-egzizz"),x(n,"class","order-wrapper svelte-egzizz"),x(n,"title",_=Xe(e[45].status)),C(n,"background-color",Pe(e[45].status,e[45].date_service)),C(n,"color",Me(Pe(e[45].status))),v(l,"slot","start"),v(h,"color","#2e2e2e"),v(g,"button",""),v(z,"icon",Re),v(z,"slot","end"),C(z,"color",Pe(e[45].status,e[45].date_service)),this.first=t},m(S,I){Q(S,t,I),o(t,l),o(l,n),o(n,i),o(i,d),o(t,b),o(t,g),o(g,h),o(h,f),o(f,E),o(f,O),F&&F.m(f,null),o(t,R),o(t,z),K||(j=ue(g,"click",P),K=!0)},p(S,I){e=S,I[0]&32&&u!==(u=parseInt(e[45].pos)+1+"")&&Le(d,u),I[0]&32&&_!==(_=Xe(e[45].status))&&x(n,"title",_),I[0]&32&&C(n,"background-color",Pe(e[45].status,e[45].date_service)),I[0]&32&&C(n,"color",Me(Pe(e[45].status))),I[0]&32&&p!==(p=e[45].title+"")&&Le(E,p),I[0]&32&&(y=e[45].support_list&&e[45].support_list.length||e[16](e[45])),y?F||(F=Gt(),F.c(),F.m(f,null)):F&&(F.d(1),F=null),I[0]&32&&C(z,"color",Pe(e[45].status,e[45].date_service))},d(S){S&&a(t),F&&F.d(),K=!1,j()}}}function bo(r){let e=r[14](r[7],r[1],r[0])+"",t,l,n,i,u='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Pull to refresh" refreshing-spinner="circles" refreshing-text="Refreshing..."></ion-refresher-content>',d,_,b,g,h,f,p="0",E,O,y,R,z,K=r[6].origin+"",j,F,P,S="",I,L,V,U=[],H=new Map,J,Y,ee,te,re,ge=r[5].length+1+"",ce,_e,Ie,fe,me,ke,Oe=r[6].destination+"",ye,Te,he,Ne="",Ce,B,X,A,q=He(r[5]);const G=D=>D[45].id_event;for(let D=0;D<q.length;D+=1){let k=Vt(r,q,D),W=G(k);H.set(W,U[D]=Wt(W,k))}return{c(){t=be(e),l=N(),n=s("ion-content"),i=s("ion-refresher"),i.innerHTML=u,d=N(),_=s("ion-list"),b=s("ion-item"),g=s("ion-avatar"),h=s("div"),f=s("div"),f.textContent=p,O=N(),y=s("ion-label"),R=s("ion-text"),z=s("h3"),j=be(K),F=N(),P=s("div"),P.innerHTML=S,I=N(),L=s("ion-icon"),V=N();for(let D=0;D<U.length;D+=1)U[D].c();J=N(),Y=s("ion-item"),ee=s("ion-avatar"),te=s("div"),re=s("div"),ce=be(ge),Ie=N(),fe=s("ion-label"),me=s("ion-text"),ke=s("h3"),ye=be(Oe),Te=N(),he=s("div"),he.innerHTML=Ne,Ce=N(),B=s("ion-icon"),this.h()},l(D){t=Ee(D,e),l=T(D),n=c(D,"ION-CONTENT",{});var k=m(n);i=c(k,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),ie(i)!=="svelte-dvt1s"&&(i.innerHTML=u),d=T(k),_=c(k,"ION-LIST",{});var W=m(_);b=c(W,"ION-ITEM",{});var Z=m(b);g=c(Z,"ION-AVATAR",{slot:!0});var oe=m(g);h=c(oe,"DIV",{class:!0,title:!0,style:!0});var ne=m(h);f=c(ne,"DIV",{class:!0,"data-svelte-h":!0}),ie(f)!=="svelte-3lvlrb"&&(f.textContent=p),ne.forEach(a),oe.forEach(a),O=T(Z),y=c(Z,"ION-LABEL",{button:!0});var w=m(y);R=c(w,"ION-TEXT",{color:!0});var M=m(R);z=c(M,"H3",{});var $=m(z);j=Ee($,K),$.forEach(a),M.forEach(a),F=T(w),P=c(w,"DIV",{class:!0,"data-svelte-h":!0}),ie(P)!=="svelte-gz9kb"&&(P.innerHTML=S),w.forEach(a),I=T(Z),L=c(Z,"ION-ICON",{icon:!0,slot:!0}),m(L).forEach(a),Z.forEach(a),V=T(W);for(let Ae=0;Ae<U.length;Ae+=1)U[Ae].l(W);J=T(W),Y=c(W,"ION-ITEM",{});var le=m(Y);ee=c(le,"ION-AVATAR",{slot:!0});var ae=m(ee);te=c(ae,"DIV",{class:!0,title:!0,style:!0});var pe=m(te);re=c(pe,"DIV",{class:!0});var we=m(re);ce=Ee(we,ge),we.forEach(a),pe.forEach(a),ae.forEach(a),Ie=T(le),fe=c(le,"ION-LABEL",{button:!0});var se=m(fe);me=c(se,"ION-TEXT",{color:!0});var de=m(me);ke=c(de,"H3",{});var ve=m(ke);ye=Ee(ve,Oe),ve.forEach(a),de.forEach(a),Te=T(se),he=c(se,"DIV",{class:!0,"data-svelte-h":!0}),ie(he)!=="svelte-130ohbs"&&(he.innerHTML=Ne),se.forEach(a),Ce=T(le),B=c(le,"ION-ICON",{icon:!0,slot:!0}),m(B).forEach(a),le.forEach(a),W.forEach(a),k.forEach(a),this.h()},h(){v(i,"slot","fixed"),x(f,"class","order svelte-egzizz"),x(h,"class","order-wrapper svelte-egzizz"),x(h,"title",E="$"+r[6].origin),C(h,"background-color",r[6].color),C(h,"color",Me(r[6].color)),v(g,"slot","start"),v(R,"color","#2e2e2e"),x(P,"class","sub svelte-egzizz"),v(y,"button",""),v(L,"icon",Re),v(L,"slot","end"),x(re,"class","order svelte-egzizz"),x(te,"class","order-wrapper svelte-egzizz"),x(te,"title",_e="$"+r[6].destination),C(te,"background-color",r[6].color),C(te,"color",Me(r[6].color)),v(ee,"slot","start"),v(me,"color","#2e2e2e"),x(he,"class","sub svelte-egzizz"),v(fe,"button",""),v(B,"icon",Re),v(B,"slot","end")},m(D,k){Q(D,t,k),Q(D,l,k),Q(D,n,k),o(n,i),r[26](i),o(n,d),o(n,_),o(_,b),o(b,g),o(g,h),o(h,f),o(b,O),o(b,y),o(y,R),o(R,z),o(z,j),o(y,F),o(y,P),o(b,I),o(b,L),o(_,V);for(let W=0;W<U.length;W+=1)U[W]&&U[W].m(_,null);o(_,J),o(_,Y),o(Y,ee),o(ee,te),o(te,re),o(re,ce),o(Y,Ie),o(Y,fe),o(fe,me),o(me,ke),o(ke,ye),o(fe,Te),o(fe,he),o(Y,Ce),o(Y,B),X||(A=[ue(i,"ionRefresh",r[10]),ue(y,"click",r[27]),ue(fe,"click",r[29])],X=!0)},p(D,k){k[0]&131&&e!==(e=D[14](D[7],D[1],D[0])+"")&&Le(t,e),k[0]&64&&E!==(E="$"+D[6].origin)&&x(h,"title",E),k[0]&64&&C(h,"background-color",D[6].color),k[0]&64&&C(h,"color",Me(D[6].color)),k[0]&64&&K!==(K=D[6].origin+"")&&Le(j,K),k[0]&331808&&(q=He(D[5]),U=xe(U,k,G,1,D,q,H,_,$e,Wt,J,Vt)),k[0]&32&&ge!==(ge=D[5].length+1+"")&&Le(ce,ge),k[0]&64&&_e!==(_e="$"+D[6].destination)&&x(te,"title",_e),k[0]&64&&C(te,"background-color",D[6].color),k[0]&64&&C(te,"color",Me(D[6].color)),k[0]&64&&Oe!==(Oe=D[6].destination+"")&&Le(ye,Oe)},d(D){D&&(a(t),a(l),a(n)),r[26](null);for(let k=0;k<U.length;k+=1)U[k].d();X=!1,Be(A)}}}function Eo(r){let e,t,l='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Jale para actualizar" refreshing-spinner="circles" refreshing-text="Actualizando..."></ion-refresher-content>',n,i,u,d,_,b,g="0",h,f,p,E,O,y=r[6].origin+"",R,z,K,j="",F,P,S,I=[],L=new Map,V,U,H,J,Y,ee=r[5].length+1+"",te,re,ge,ce,_e,Ie,fe=r[6].destination+"",me,ke,Oe,ye="",Te,he,Ne,Ce,B=He(r[5]);const X=A=>A[45].id_event;for(let A=0;A<B.length;A+=1){let q=Ft(r,B,A),G=X(q);L.set(G,I[A]=Yt(G,q))}return{c(){e=s("ion-content"),t=s("ion-refresher"),t.innerHTML=l,n=N(),i=s("ion-list"),u=s("ion-item"),d=s("ion-avatar"),_=s("div"),b=s("div"),b.textContent=g,f=N(),p=s("ion-label"),E=s("ion-text"),O=s("h3"),R=be(y),z=N(),K=s("div"),K.innerHTML=j,F=N(),P=s("ion-icon"),S=N();for(let A=0;A<I.length;A+=1)I[A].c();V=N(),U=s("ion-item"),H=s("ion-avatar"),J=s("div"),Y=s("div"),te=be(ee),ge=N(),ce=s("ion-label"),_e=s("ion-text"),Ie=s("h3"),me=be(fe),ke=N(),Oe=s("div"),Oe.innerHTML=ye,Te=N(),he=s("ion-icon"),this.h()},l(A){e=c(A,"ION-CONTENT",{});var q=m(e);t=c(q,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),ie(t)!=="svelte-15ukrgn"&&(t.innerHTML=l),n=T(q),i=c(q,"ION-LIST",{});var G=m(i);u=c(G,"ION-ITEM",{});var D=m(u);d=c(D,"ION-AVATAR",{slot:!0});var k=m(d);_=c(k,"DIV",{class:!0,title:!0,style:!0});var W=m(_);b=c(W,"DIV",{class:!0,"data-svelte-h":!0}),ie(b)!=="svelte-3lvlrb"&&(b.textContent=g),W.forEach(a),k.forEach(a),f=T(D),p=c(D,"ION-LABEL",{button:!0});var Z=m(p);E=c(Z,"ION-TEXT",{color:!0});var oe=m(E);O=c(oe,"H3",{});var ne=m(O);R=Ee(ne,y),ne.forEach(a),oe.forEach(a),z=T(Z),K=c(Z,"DIV",{class:!0,"data-svelte-h":!0}),ie(K)!=="svelte-gz9kb"&&(K.innerHTML=j),Z.forEach(a),F=T(D),P=c(D,"ION-ICON",{icon:!0,slot:!0}),m(P).forEach(a),D.forEach(a),S=T(G);for(let se=0;se<I.length;se+=1)I[se].l(G);V=T(G),U=c(G,"ION-ITEM",{});var w=m(U);H=c(w,"ION-AVATAR",{slot:!0});var M=m(H);J=c(M,"DIV",{class:!0,title:!0,style:!0});var $=m(J);Y=c($,"DIV",{class:!0});var le=m(Y);te=Ee(le,ee),le.forEach(a),$.forEach(a),M.forEach(a),ge=T(w),ce=c(w,"ION-LABEL",{button:!0});var ae=m(ce);_e=c(ae,"ION-TEXT",{color:!0});var pe=m(_e);Ie=c(pe,"H3",{});var we=m(Ie);me=Ee(we,fe),we.forEach(a),pe.forEach(a),ke=T(ae),Oe=c(ae,"DIV",{class:!0,"data-svelte-h":!0}),ie(Oe)!=="svelte-130ohbs"&&(Oe.innerHTML=ye),ae.forEach(a),Te=T(w),he=c(w,"ION-ICON",{icon:!0,slot:!0}),m(he).forEach(a),w.forEach(a),G.forEach(a),q.forEach(a),this.h()},h(){v(t,"slot","fixed"),x(b,"class","order svelte-egzizz"),x(_,"class","order-wrapper svelte-egzizz"),x(_,"title",h="$"+r[6].origin),C(_,"background-color",r[6].color),C(_,"color",Me(r[6].color)),v(d,"slot","start"),v(E,"color","#2e2e2e"),x(K,"class","sub svelte-egzizz"),v(p,"button",""),v(P,"icon",Re),v(P,"slot","end"),x(Y,"class","order svelte-egzizz"),x(J,"class","order-wrapper svelte-egzizz"),x(J,"title",re="$"+r[6].destination),C(J,"background-color",r[6].color),C(J,"color",Me(r[6].color)),v(H,"slot","start"),v(_e,"color","#2e2e2e"),x(Oe,"class","sub svelte-egzizz"),v(ce,"button",""),v(he,"icon",Re),v(he,"slot","end")},m(A,q){Q(A,e,q),o(e,t),r[22](t),o(e,n),o(e,i),o(i,u),o(u,d),o(d,_),o(_,b),o(u,f),o(u,p),o(p,E),o(E,O),o(O,R),o(p,z),o(p,K),o(u,F),o(u,P),o(i,S);for(let G=0;G<I.length;G+=1)I[G]&&I[G].m(i,null);o(i,V),o(i,U),o(U,H),o(H,J),o(J,Y),o(Y,te),o(U,ge),o(U,ce),o(ce,_e),o(_e,Ie),o(Ie,me),o(ce,ke),o(ce,Oe),o(U,Te),o(U,he),Ne||(Ce=[ue(t,"ionRefresh",r[10]),ue(p,"click",r[23]),ue(ce,"click",r[25])],Ne=!0)},p(A,q){q[0]&64&&h!==(h="$"+A[6].origin)&&x(_,"title",h),q[0]&64&&C(_,"background-color",A[6].color),q[0]&64&&C(_,"color",Me(A[6].color)),q[0]&64&&y!==(y=A[6].origin+"")&&Le(R,y),q[0]&331808&&(B=He(A[5]),I=xe(I,q,X,1,A,B,L,i,$e,Yt,V,Ft)),q[0]&32&&ee!==(ee=A[5].length+1+"")&&Le(te,ee),q[0]&64&&re!==(re="$"+A[6].destination)&&x(J,"title",re),q[0]&64&&C(J,"background-color",A[6].color),q[0]&64&&C(J,"color",Me(A[6].color)),q[0]&64&&fe!==(fe=A[6].destination+"")&&Le(me,fe)},d(A){A&&a(e),r[22](null);for(let q=0;q<I.length;q+=1)I[q].d();Ne=!1,Be(Ce)}}}function Xt(r){let e;return{c(){e=s("span"),this.h()},l(t){e=c(t,"SPAN",{class:!0}),m(e).forEach(a),this.h()},h(){x(e,"class","notes svelte-egzizz")},m(t,l){Q(t,e,l)},d(t){t&&a(e)}}}function Wt(r,e){let t,l,n,i,u=parseInt(e[45].pos)+1+"",d,_,b,g,h,f,p=e[45].title+"",E,O,y=e[45].support_list&&e[45].support_list.length||e[16](e[45]),R,z,K="",j,F,P,S,I=y&&Xt();function L(){return e[28](e[45])}return{key:r,first:null,c(){t=s("ion-item"),l=s("ion-avatar"),n=s("div"),i=s("div"),d=be(u),b=N(),g=s("ion-label"),h=s("ion-text"),f=s("h3"),E=be(p),O=N(),I&&I.c(),R=N(),z=s("div"),z.innerHTML=K,j=N(),F=s("ion-icon"),this.h()},l(V){t=c(V,"ION-ITEM",{});var U=m(t);l=c(U,"ION-AVATAR",{slot:!0});var H=m(l);n=c(H,"DIV",{class:!0,title:!0,style:!0});var J=m(n);i=c(J,"DIV",{class:!0});var Y=m(i);d=Ee(Y,u),Y.forEach(a),J.forEach(a),H.forEach(a),b=T(U),g=c(U,"ION-LABEL",{button:!0});var ee=m(g);h=c(ee,"ION-TEXT",{color:!0});var te=m(h);f=c(te,"H3",{});var re=m(f);E=Ee(re,p),O=T(re),I&&I.l(re),re.forEach(a),te.forEach(a),R=T(ee),z=c(ee,"DIV",{class:!0,"data-svelte-h":!0}),ie(z)!=="svelte-qaecoo"&&(z.innerHTML=K),ee.forEach(a),j=T(U),F=c(U,"ION-ICON",{icon:!0,slot:!0}),m(F).forEach(a),U.forEach(a),this.h()},h(){x(i,"class","order svelte-egzizz"),x(n,"class","order-wrapper svelte-egzizz"),x(n,"title",_=Xe(e[45].status)),C(n,"background-color",Pe(e[45].status,e[45].date_service)),C(n,"color",Me(Pe(e[45].status))),v(l,"slot","start"),v(h,"color","#2e2e2e"),x(z,"class","sub svelte-egzizz"),v(g,"button",""),v(F,"icon",Re),v(F,"slot","end"),this.first=t},m(V,U){Q(V,t,U),o(t,l),o(l,n),o(n,i),o(i,d),o(t,b),o(t,g),o(g,h),o(h,f),o(f,E),o(f,O),I&&I.m(f,null),o(g,R),o(g,z),o(t,j),o(t,F),P||(S=ue(g,"click",L),P=!0)},p(V,U){e=V,U[0]&32&&u!==(u=parseInt(e[45].pos)+1+"")&&Le(d,u),U[0]&32&&_!==(_=Xe(e[45].status))&&x(n,"title",_),U[0]&32&&C(n,"background-color",Pe(e[45].status,e[45].date_service)),U[0]&32&&C(n,"color",Me(Pe(e[45].status))),U[0]&32&&p!==(p=e[45].title+"")&&Le(E,p),U[0]&32&&(y=e[45].support_list&&e[45].support_list.length||e[16](e[45])),y?I||(I=Xt(),I.c(),I.m(f,null)):I&&(I.d(1),I=null)},d(V){V&&a(t),I&&I.d(),P=!1,S()}}}function Jt(r){let e;return{c(){e=s("span"),this.h()},l(t){e=c(t,"SPAN",{class:!0}),m(e).forEach(a),this.h()},h(){x(e,"class","notes svelte-egzizz")},m(t,l){Q(t,e,l)},d(t){t&&a(e)}}}function Yt(r,e){let t,l,n,i,u=parseInt(e[45].pos)+1+"",d,_,b,g,h,f,p=e[45].title+"",E,O,y=e[45].support_list&&e[45].support_list.length||e[16](e[45]),R,z,K="",j,F,P,S,I=y&&Jt();function L(){return e[24](e[45])}return{key:r,first:null,c(){t=s("ion-item"),l=s("ion-avatar"),n=s("div"),i=s("div"),d=be(u),b=N(),g=s("ion-label"),h=s("ion-text"),f=s("h3"),E=be(p),O=N(),I&&I.c(),R=N(),z=s("div"),z.innerHTML=K,j=N(),F=s("ion-icon"),this.h()},l(V){t=c(V,"ION-ITEM",{});var U=m(t);l=c(U,"ION-AVATAR",{slot:!0});var H=m(l);n=c(H,"DIV",{class:!0,title:!0,style:!0});var J=m(n);i=c(J,"DIV",{class:!0});var Y=m(i);d=Ee(Y,u),Y.forEach(a),J.forEach(a),H.forEach(a),b=T(U),g=c(U,"ION-LABEL",{button:!0});var ee=m(g);h=c(ee,"ION-TEXT",{color:!0});var te=m(h);f=c(te,"H3",{});var re=m(f);E=Ee(re,p),O=T(re),I&&I.l(re),re.forEach(a),te.forEach(a),R=T(ee),z=c(ee,"DIV",{class:!0,"data-svelte-h":!0}),ie(z)!=="svelte-qaecoo"&&(z.innerHTML=K),ee.forEach(a),j=T(U),F=c(U,"ION-ICON",{icon:!0,slot:!0}),m(F).forEach(a),U.forEach(a),this.h()},h(){x(i,"class","order svelte-egzizz"),x(n,"class","order-wrapper svelte-egzizz"),x(n,"title",_=Xe(e[45].status)),C(n,"background-color",Pe(e[45].status,e[45].date_service)),C(n,"color",Me(Pe(e[45].status))),v(l,"slot","start"),v(h,"color","#2e2e2e"),x(z,"class","sub svelte-egzizz"),v(g,"button",""),v(F,"icon",Re),v(F,"slot","end"),this.first=t},m(V,U){Q(V,t,U),o(t,l),o(l,n),o(n,i),o(i,d),o(t,b),o(t,g),o(g,h),o(h,f),o(f,E),o(f,O),I&&I.m(f,null),o(g,R),o(g,z),o(t,j),o(t,F),P||(S=ue(g,"click",L),P=!0)},p(V,U){e=V,U[0]&32&&u!==(u=parseInt(e[45].pos)+1+"")&&Le(d,u),U[0]&32&&_!==(_=Xe(e[45].status))&&x(n,"title",_),U[0]&32&&C(n,"background-color",Pe(e[45].status,e[45].date_service)),U[0]&32&&C(n,"color",Me(Pe(e[45].status))),U[0]&32&&p!==(p=e[45].title+"")&&Le(E,p),U[0]&32&&(y=e[45].support_list&&e[45].support_list.length||e[16](e[45])),y?I||(I=Jt(),I.c(),I.m(f,null)):I&&(I.d(1),I=null)},d(V){V&&a(t),I&&I.d(),P=!1,S()}}}function Io(r){let e,t,l,n,i=`<ion-icon icon="${wn}"></ion-icon>`,u,d,_,b=`<ion-icon icon="${Ln}"></ion-icon>`,g,h,f=(r[6].name?r[6].name.toUpperCase():"")+"",p,E,O,y='<ion-segment-button value="list"><ion-label>Paradas</ion-label></ion-segment-button> <ion-segment-button value="map"><ion-label>Mapa</ion-label></ion-segment-button>',R,z,K,j;function F(I,L){if(I[9]==="list")return mo;if(I[9]==="map")return po}let P=F(r),S=P&&P(r);return{c(){e=s("ion-header"),t=s("ion-toolbar"),l=s("ion-buttons"),n=s("ion-button"),n.innerHTML=i,u=N(),d=s("ion-buttons"),_=s("ion-button"),_.innerHTML=b,g=N(),h=s("ion-title"),p=be(f),E=N(),O=s("ion-segment"),O.innerHTML=y,R=N(),S&&S.c(),z=Se(),this.h()},l(I){e=c(I,"ION-HEADER",{translucent:!0});var L=m(e);t=c(L,"ION-TOOLBAR",{});var V=m(t);l=c(V,"ION-BUTTONS",{slot:!0});var U=m(l);n=c(U,"ION-BUTTON",{title:!0,alt:!0,"data-svelte-h":!0}),ie(n)!=="svelte-7ppz3r"&&(n.innerHTML=i),U.forEach(a),u=T(V),d=c(V,"ION-BUTTONS",{slot:!0});var H=m(d);_=c(H,"ION-BUTTON",{"data-svelte-h":!0}),ie(_)!=="svelte-nf50hj"&&(_.innerHTML=b),H.forEach(a),g=T(V),h=c(V,"ION-TITLE",{});var J=m(h);p=Ee(J,f),J.forEach(a),V.forEach(a),E=T(L),O=c(L,"ION-SEGMENT",{value:!0,"data-svelte-h":!0}),ie(O)!=="svelte-lue4c9"&&(O.innerHTML=y),L.forEach(a),R=T(I),S&&S.l(I),z=Se(),this.h()},h(){v(n,"title","Atrás"),v(n,"alt","Atrás"),v(l,"slot","start"),v(d,"slot","end"),v(O,"value","list"),v(e,"translucent","")},m(I,L){Q(I,e,L),o(e,t),o(t,l),o(l,n),o(t,u),o(t,d),o(d,_),o(t,g),o(t,h),o(h,p),o(e,E),o(e,O),Q(I,R,L),S&&S.m(I,L),Q(I,z,L),K||(j=[ue(n,"click",r[17]),ue(_,"click",r[20]),ue(O,"ionChange",r[21])],K=!0)},p(I,L){L[0]&64&&f!==(f=(I[6].name?I[6].name.toUpperCase():"")+"")&&Le(p,f),P===(P=F(I))&&S?S.p(I,L):(S&&S.d(1),S=P&&P(I),S&&(S.c(),S.m(z.parentNode,z)))},d(I){I&&(a(e),a(R),a(z)),S&&S.d(I),K=!1,Be(j)}}}function ko(r){let e,t,l,n=r[2]&&qt(r);return{c(){e=N(),n&&n.c(),t=Se(),this.h()},l(i){an("svelte-kn0kph",Rt.head).forEach(a),e=T(i),n&&n.l(i),t=Se(),this.h()},h(){Rt.title="Rutaflow - Detalles de ruta"},m(i,u){Q(i,e,u),n&&n.m(i,u),Q(i,t,u),l=!0},p(i,u){i[2]?n?(n.p(i,u),u[0]&4&&lt(n,1)):(n=qt(i),n.c(),lt(n,1),n.m(t.parentNode,t)):n&&(pn(),at(n,1,1,()=>{n=null}),un())},i(i){l||(lt(n),l=!0)},o(i){at(n),l=!1},d(i){i&&(a(e),a(t)),n&&n.d(i)}}}function Pe(r,e=""){let t="#ffffff";return r==="pending"&&!e?t="#f2e300":r=="pending"&&e?t="#F6A833":r==="completed"&&(t="#44d900"),t}function Xe(r){let e="";return r=="pending"?e="Pendiente":r=="completed"&&(e="Completado"),e}function Me(r){r.slice(0,1)==="#"&&(r=r.slice(1)),r.length===3&&(r=r.split("").map(function(i){return i+i}).join(""));const e=parseInt(r.substr(0,2),16),t=parseInt(r.substr(2,2),16),l=parseInt(r.substr(4,2),16);return(e*299+t*587+l*114)/1e3>=128?"#414040":"#fff"}const Oo=r=>r.mandatory==="1",No=r=>r.img;function To(r,e,t){let l;sn(r,zn,B=>t(19,l=B));var n=this&&this.__awaiter||function(B,X,A,q){function G(D){return D instanceof A?D:new A(function(k){k(D)})}return new(A||(A=Promise))(function(D,k){function W(ne){try{oe(q.next(ne))}catch(w){k(w)}}function Z(ne){try{oe(q.throw(ne))}catch(w){k(w)}}function oe(ne){ne.done?D(ne.value):G(ne.value).then(W,Z)}oe((q=q.apply(B,X||[])).next())})};let{routeId:i}=e,{driverId:u}=e,d=it,_=new Object,b=!0,g=!1,h=[],f={},p=[],E=[],O,y=!1,R="list",z;const K=()=>n(void 0,void 0,void 0,function*(){yield P(i),O.complete()});Ze(()=>n(void 0,void 0,void 0,function*(){yield P(i)}));function j(B){return n(this,void 0,void 0,function*(){if(t(9,R=B),R==="map"){yield cn(),z=document.getElementById("g_map");const X=new google.maps.Map(z,{zoom:8,center:{lat:20.6745683,lng:-103.3986104},mapId:"4504f8b37365c3d0"}),A=new google.maps.LatLngBounds,{AdvancedMarkerElement:q,PinElement:G}=yield google.maps.importLibrary("marker");navigator.geolocation?navigator.geolocation.getCurrentPosition(function(D){const k=new google.maps.LatLng(D.coords.latitude,D.coords.longitude);new google.maps.Marker({position:k,map:X,icon:{path:google.maps.SymbolPath.CIRCLE,fillColor:"#0062ff",fillOpacity:1,scale:6,strokeColor:"#ffffff",strokeWeight:2}}),new google.maps.Circle({strokeColor:"#00BFFF",strokeOpacity:.5,strokeWeight:1,fillColor:"#00BFFF",fillOpacity:.2,map:X,center:k,radius:D.coords.accuracy}),A.extend(k)},function(D){console.error("Error retrieving location:",D)}):console.error("Geolocation not supported by this browser."),f.lat1===f.lat2&&f.lon1===f.lon2?F(A,X,{lat:f.lat2,lon:f.lon2,color:f.color,title:f.destination},{type:"icon",iconClass:"icon-home",title:"Origen/Destino",glyph:`0,${String(h.length+1)}`}):(F(A,X,{lat:f.lat1,lon:f.lon1,color:f.color,title:f.origin},{type:"icon",iconClass:"icon-home",title:"Origen",glyph:"0"}),F(A,X,{lat:f.lat2,lon:f.lon2,color:f.color,title:f.destination},{type:"icon",iconClass:"icon-flag",title:"Destino",glyph:String(h.length+1)})),h.forEach((D,k)=>{const W=parseFloat(D.lat),Z=parseFloat(D.lon),oe=new google.maps.LatLng(W,Z),ne=new google.maps.Marker({position:{lat:W,lng:Z},map:X,title:D.title}),w=new G({background:Pe(D.status,D.date_service),borderColor:"#000",glyphColor:"#000",glyph:(parseInt(D.pos)+1).toString()});new q({map:X,position:oe,content:w.element,title:"Parada "+(parseInt(D.pos)+1).toString()+": "+D.title}).addListener("click",function($){I(D,!1)}),A.extend(ne.getPosition())}),X.fitBounds(A)}})}function F(B,X,A,q){return n(this,void 0,void 0,function*(){let G;const D=parseFloat(A.lat),k=parseFloat(A.lon),W=new google.maps.LatLng(D,k),{AdvancedMarkerElement:Z,PinElement:oe}=yield google.maps.importLibrary("marker");q.type=="icon"?(G=document.createElement("i"),G.className=`${q.iconClass} icon`,G.style.fontSize="14px",G.style.color=Me(A.color),G.style.fontWeight="600"):q.type=="text";const ne=new google.maps.Marker({position:{lat:D,lng:k},map:X,title:`${q.title}. ${A.title}`}),w=new oe({background:A.color,borderColor:"#000",glyphColor:Me(A.color),glyph:q.glyph});return new Z({map:X,position:W,content:w.element,title:q.title+": "+A.title}).addListener("click",function($){L(f,q.title=="Destino"||q.title=="Origen/Destino")}),ne})}function P(B){return n(this,void 0,void 0,function*(){let X=new FormData;X.append("id_route",B),X=te(X);try{const q=yield(yield fetch(`${d}api/admin/report/seguimiento_list.php`,{method:"POST",body:X})).json();t(6,f=q.data.seguimiento_list[0]),t(5,h=q.data.event_list),t(7,p=q.data.checklist),E=q.data.expenses,f&&t(4,g=f.km_inicial=="0"&&f.gas_inicial=="0"),t(3,b=!1)}catch(A){t(3,b=!1),console.error("Error fetching data:",A)}})}const S=B=>new Promise((X,A)=>{let q=new FormData;q.append("id_route",B.id_route),q.append("id_event",B.id_event),q=te(q),fetch(`${d}api/admin/evidence/evidence_by_event.php`,{method:"POST",body:q}).then(G=>G.json()).then(G=>{X(G.data.event_evidence[0])}).catch(G=>{console.error("Error fetching data:",G),A(G)})}),I=(B,X)=>{S(B).then(A=>{A&&(B.img=A.img,B.driver_comments=A.driver_comments,B.comments=A.comments),Ue("modal-delivery-info",St,{delivery:B,isLast:X}).then(q=>{}).finally(()=>{P(i)})})},L=(B,X)=>{var A=new Object;X?A={title:B.destination,line1:B.dest_address}:A={title:B.origin,line1:B.origin_address},A.client_name=B.client_name,A.client_phone=B.tel,A.id_route=B.id_route;var q=!0;Ue("modal-delivery-info",St,{delivery:A,isLast:X,flag:q})},V=(B,X,A)=>{var q=!1;return y||(y=!0,Ue("modal-checklist",en,{checklist:B,driverId:X,routeId:A,isLast:q}).then(G=>{y=!1}),J(A,"checklist")),""},U=B=>n(void 0,void 0,void 0,function*(){return yield P(B),E.length>0?Ue("modal-expense-detail",ho,{routeId:B,expenses:E}).then(X=>{}):Ue("modal-expense",ut,{routeId:B}).then(X=>{}),""}),H=B=>{if(B.tracking_type=="subscription"){if(B.subscriber_info&&B.payment_type==="cash"&&new Date(B.subscriber_info.payment_next)<new Date)return!0}else if(B.tracking_type=="ecommerce"&&Number(B.payment_pending)>0)return!0;return!1};function J(B,X){let A=new FormData;return A.append("id_route",B),A.append("status",X),A=te(A),fetch(`${d}api/admin/route/change_status.php`,{method:"POST",body:A}).then(q=>q.json()).then(q=>{}).catch(q=>{console.error("Error fetching data:",q)}),""}const Y=()=>{_.type=="super"||_.type=="admin"?qe("/drivers/me"):_.id_driver&&qe(`/drivers/${_.id_driver}`)},ee=(B,X)=>n(void 0,void 0,void 0,function*(){yield(yield je.create({header:B||"Error",message:X||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()});function te(B){return B.append("token",_.token),B.append("id_user_over",_.id_user),B}const re=()=>U(i),ge=B=>j(B.detail.value);function ce(B){De[B?"unshift":"push"](()=>{O=B,t(8,O)})}const _e=()=>{L(f,!1)},Ie=B=>{const X=h.findIndex(k=>k.id_event===B.id_event),A=X===0,q=X>0?h[X-1]:null,G=A||q&&q.img!==null,D=B.img!==null&&B.img!=="";G||A&&!D?I(B,!1):ee("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")},fe=()=>{L(f,!0)};function me(B){De[B?"unshift":"push"](()=>{O=B,t(8,O)})}const ke=()=>{L(f,!1)},Oe=B=>{const X=h.findIndex(k=>k.id_event===B.id_event),A=X===0,q=X>0?h[X-1]:null,G=A||q&&q.img!==null,D=B.img!==null&&B.img!=="";G||A&&!D?I(B,!1):ee("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")},ye=()=>{L(f,!0)};function Te(B){De[B?"unshift":"push"](()=>{O=B,t(8,O)})}const he=()=>{L(f,!1)},Ne=B=>{const X=h.findIndex(k=>k.id_event===B.id_event),A=X===0,q=X>0?h[X-1]:null,G=A||q&&q.img!==null,D=B.img!==null&&B.img!=="";G||A&&!D?I(B,!1):ee("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")},Ce=()=>{L(f,!0)};return r.$$set=B=>{"routeId"in B&&t(0,i=B.routeId),"driverId"in B&&t(1,u=B.driverId)},r.$$.update=()=>{r.$$.dirty[0]&524293&&(t(0,{routeId:i,driverId:u}=l.params,i,(t(1,u),t(19,l),t(2,_),t(0,i))),t(2,_=JSON.parse(localStorage.getItem("userSession"))),_?_.id_user&&(_.type=="admin"||_.type=="super")?(P(i),qe(`/drivers/me/routes/${i}`)):_.id_user&&_.id_driver&&(P(i),qe(`/drivers/${_.id_driver}/routes/${i}`)):qe("/"))},[i,u,_,b,g,h,f,p,O,R,K,j,I,L,V,U,H,Y,ee,l,re,ge,ce,_e,Ie,fe,me,ke,Oe,ye,Te,he,Ne,Ce]}class So extends Je{constructor(e){super(),Ye(this,e,To,ko,We,{routeId:0,driverId:1},null,[-1,-1])}}export{So as component};

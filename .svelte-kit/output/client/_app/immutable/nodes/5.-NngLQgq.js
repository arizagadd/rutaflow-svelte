import{Z as ht,s as We,e as c,j as w,b as u,q as E,d as x,h as a,m as L,v as p,i as R,w as l,x as $,n as be,z as He,_ as Ft,B as j,o as st,k as we,$ as pt,t as ie,r as re,f as V,a0 as jt,y as Le,a1 as $e,A as ye,a2 as at,l as Vt,p as Gt}from"../chunks/index.BYLndrM5.js";import{S as Xe,i as Je,t as rt,a as ut,c as Kt,b as xt,d as Wt,m as Xt,e as Jt,g as Yt}from"../chunks/index.BNHbygFo.js";import{e as Be,u as tt,d as nt,a as Zt,c as ft,b as Ht,f as Qt,i as Ut,g as $t,h as Rt,s as mt,j as Ye,k as en,m as tn,n as nn,o as on,p as ln}from"../chunks/index.D4sKrugo.js";import{g as je}from"../chunks/entry.DuIQnMQH.js";import"../chunks/index-48209844.IIRtDZyg.js";import{m as ot,a as et,I as rn}from"../chunks/IonPage.KvUD72q2.js";import{q as an,t as sn}from"../chunks/ion-modal.CsJaVgKZ.js";const cn=(i,e)=>{if(!customElements.get(i)){class t extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const n={};for(const r of this.attributes)n[r.name]=r.value;new e({target:this.shadowRoot,props:n})}}customElements.define(i,t)}},un=function(i){return document.createElement(i).constructor!==HTMLElement},fn=(i,e)=>{un(i)||cn(i,e)},Re=async(i,e,t)=>{an(),sn(),fn(i,e);const o=await ot.create({component:i,componentProps:t});return o.present(),await o.onWillDismiss()};let Ge=ht({km_inicial:[],gas_inicial:[],km_final:[],gas_final:[]}),qt=ht({flag:[]});function _n(i){let e,t,o,n,r="Cancelar",h,f,b="Captura de Km/Gas",O,I,_,s="Confirmar",v,d,g,m,T,C,D;return{c(){e=c("ion-header"),t=c("ion-toolbar"),o=c("ion-buttons"),n=c("ion-button"),n.textContent=r,h=w(),f=c("ion-title"),f.textContent=b,O=w(),I=c("ion-buttons"),_=c("ion-button"),_.textContent=s,v=w(),d=c("ion-content"),g=c("ion-item"),m=c("ion-input"),this.h()},l(P){e=u(P,"ION-HEADER",{translucent:!0});var A=E(e);t=u(A,"ION-TOOLBAR",{});var N=E(t);o=u(N,"ION-BUTTONS",{slot:!0});var B=E(o);n=u(B,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),x(n)!=="svelte-17pq4f4"&&(n.textContent=r),B.forEach(a),h=L(N),f=u(N,"ION-TITLE",{"data-svelte-h":!0}),x(f)!=="svelte-1yhkaq7"&&(f.textContent=b),O=L(N),I=u(N,"ION-BUTTONS",{slot:!0});var y=E(I);_=u(y,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),x(_)!=="svelte-cm6j4s"&&(_.textContent=s),y.forEach(a),N.forEach(a),A.forEach(a),v=L(P),d=u(P,"ION-CONTENT",{fullscreen:!0});var k=E(d);g=u(k,"ION-ITEM",{});var S=E(g);m=u(S,"ION-INPUT",{class:!0,inputmode:!0,pattern:!0,type:!0,placeholder:!0,value:!0,required:!0});var q=E(m);q.forEach(a),S.forEach(a),k.forEach(a),this.h()},h(){p(n,"color","medium"),p(o,"slot","start"),p(_,"strong",""),p(I,"slot","end"),p(e,"translucent",""),p(m,"class","fin-km"),p(m,"inputmode","numeric"),p(m,"pattern","[0-9]*"),p(m,"type","number"),p(m,"placeholder",T="Ingresa "+i[0]+" actual"),p(m,"value",i[1]),p(m,"required",""),p(d,"fullscreen","")},m(P,A){R(P,e,A),l(e,t),l(t,o),l(o,n),l(t,h),l(t,f),l(t,O),l(t,I),l(I,_),R(P,v,A),R(P,d,A),l(d,g),l(g,m),C||(D=[$(n,"click",i[2]),$(_,"click",i[3]),$(m,"input",i[4])],C=!0)},p(P,[A]){A&1&&T!==(T="Ingresa "+P[0]+" actual")&&p(m,"placeholder",T),A&2&&p(m,"value",P[1])},i:be,o:be,d(P){P&&(a(e),a(v),a(d)),C=!1,He(D)}}}function dn(i,e,t){const o=Ft();let n=document.querySelector("ion-modal"),r=n.componentProps.data_type;n.componentProps.isLast;let h;qt.subscribe(_=>{r=_.flag[0],r=="km_final"||r=="km_inicial"?t(0,h="kilometraje"):t(0,h="litros de gasolina")});let f=0;function b(){ot.dismiss()}function O(){o("modalResult",{data:"Your data",role:"confirm"}),r=="km_inicial"?Ge.update(s=>({...s,km_inicial:[f]})):r=="gas_inicial"?Ge.update(s=>({...s,gas_inicial:[f]})):r=="km_final"?Ge.update(s=>({...s,km_final:[f]})):r=="gas_final"&&Ge.update(s=>({...s,gas_final:[f]})),b()}return[h,f,b,O,_=>t(1,f=_.target.value)]}class hn extends Xe{constructor(e){super(),Je(this,e,dn,_n,We,{})}}const ct=ht({items:[],checkedIndices:[],mandatory:[]});function gt(i,e,t){const o=i.slice();return o[49]=e[t],o[50]=e,o[51]=t,o}function pn(i){let e,t,o,n,r,h="Kilometraje inicial",f,b,O=i[0]?i[0]+" km.":"Cargar km",I,_,s,v,d,g,m,T="Gasolina inicial (litros)",C,D,P=i[1]?i[1]+" litros":"Cargar gas",A,N,B,y;return N=pt(i[20][0]),{c(){e=c("ion-item"),t=c("ion-label"),o=c("input"),n=w(),r=c("p"),r.textContent=h,f=w(),b=c("ion-button"),I=ie(O),_=w(),s=c("ion-item"),v=c("ion-label"),d=c("input"),g=w(),m=c("p"),m.textContent=T,C=w(),D=c("ion-button"),A=ie(P),this.h()},l(k){e=u(k,"ION-ITEM",{});var S=E(e);t=u(S,"ION-LABEL",{style:!0});var q=E(t);o=u(q,"INPUT",{id:!0,style:!0,type:!0}),n=L(q),r=u(q,"P",{style:!0,"data-svelte-h":!0}),x(r)!=="svelte-88twxi"&&(r.textContent=h),q.forEach(a),f=L(S),b=u(S,"ION-BUTTON",{fill:!0,size:!0,class:!0,"aria-selected":!0});var H=E(b);I=re(H,O),H.forEach(a),S.forEach(a),_=L(k),s=u(k,"ION-ITEM",{});var z=E(s);v=u(z,"ION-LABEL",{style:!0});var W=E(v);d=u(W,"INPUT",{id:!0,style:!0,type:!0}),g=L(W),m=u(W,"P",{style:!0,"data-svelte-h":!0}),x(m)!=="svelte-1ux30eb"&&(m.textContent=T),W.forEach(a),C=L(z),D=u(z,"ION-BUTTON",{fill:!0,class:!0,size:!0,style:!0});var ee=E(D);A=re(ee,P),ee.forEach(a),z.forEach(a),this.h()},h(){V(o,"id","chkbox-km-ini"),j(o,"pointer-events","auto"),V(o,"type","checkbox"),o.required=!0,j(r,"margin-left","10px"),j(t,"display","flex"),p(b,"fill","outline"),p(b,"size","small"),p(b,"class","loadKmInicial"),p(b,"aria-selected",""),V(d,"id","chkbox-gas-ini"),j(d,"pointer-events","auto"),V(d,"type","checkbox"),d.required=!0,j(m,"margin-left","10px"),j(v,"display","flex"),p(D,"fill","outline"),p(D,"class","loadGasInicial"),p(D,"size","small"),j(D,"height","16px "),N.p(o,d)},m(k,S){R(k,e,S),l(e,t),l(t,o),o.checked=~(i[4]||[]).indexOf(o.__value),i[27](o),l(t,n),l(t,r),l(e,f),l(e,b),l(b,I),R(k,_,S),R(k,s,S),l(s,v),l(v,d),i[29](d),d.checked=~(i[4]||[]).indexOf(d.__value),l(v,g),l(v,m),l(s,C),l(s,D),l(D,A),B||(y=[$(o,"change",i[26]),$(b,"click",i[28]),$(d,"change",i[30]),$(D,"click",i[31])],B=!0)},p(k,S){S[0]&16&&(o.checked=~(k[4]||[]).indexOf(o.__value)),S[0]&1&&O!==(O=k[0]?k[0]+" km.":"Cargar km")&&Le(I,O),S[0]&16&&(d.checked=~(k[4]||[]).indexOf(d.__value)),S[0]&2&&P!==(P=k[1]?k[1]+" litros":"Cargar gas")&&Le(A,P)},d(k){k&&(a(e),a(_),a(s)),i[27](null),i[29](null),N.r(),B=!1,He(y)}}}function mn(i){let e,t,o,n,r,h="Kilometraje final",f,b,O=i[2]?i[2]+" km.":"Cargar km",I,_,s,v,d,g,m,T="Gasolina final (litros)",C,D,P=i[3]?i[3]+" litros":"Cargar gas",A,N,B,y;return N=pt(i[20][0]),{c(){e=c("ion-item"),t=c("ion-label"),o=c("input"),n=w(),r=c("p"),r.textContent=h,f=w(),b=c("ion-button"),I=ie(O),_=w(),s=c("ion-item"),v=c("ion-label"),d=c("input"),g=w(),m=c("p"),m.textContent=T,C=w(),D=c("ion-button"),A=ie(P),this.h()},l(k){e=u(k,"ION-ITEM",{});var S=E(e);t=u(S,"ION-LABEL",{style:!0});var q=E(t);o=u(q,"INPUT",{id:!0,style:!0,type:!0}),n=L(q),r=u(q,"P",{style:!0,"data-svelte-h":!0}),x(r)!=="svelte-ccmu71"&&(r.textContent=h),q.forEach(a),f=L(S),b=u(S,"ION-BUTTON",{fill:!0,size:!0,class:!0,"aria-selected":!0});var H=E(b);I=re(H,O),H.forEach(a),S.forEach(a),_=L(k),s=u(k,"ION-ITEM",{});var z=E(s);v=u(z,"ION-LABEL",{style:!0});var W=E(v);d=u(W,"INPUT",{id:!0,style:!0,type:!0}),g=L(W),m=u(W,"P",{style:!0,"data-svelte-h":!0}),x(m)!=="svelte-wsoyd2"&&(m.textContent=T),W.forEach(a),C=L(z),D=u(z,"ION-BUTTON",{fill:!0,size:!0,class:!0});var ee=E(D);A=re(ee,P),ee.forEach(a),z.forEach(a),this.h()},h(){V(o,"id","chkbox-km-fin"),j(o,"pointer-events","auto"),V(o,"type","checkbox"),o.required=!0,j(r,"margin-left","10px"),j(t,"display","flex"),p(b,"fill","outline"),p(b,"size","small"),p(b,"class","loadKmInicial"),p(b,"aria-selected",""),V(d,"id","chkbox-gas-fin"),j(d,"pointer-events","auto"),V(d,"type","checkbox"),d.required=!0,j(m,"margin-left","10px"),j(v,"display","flex"),p(D,"fill","outline"),p(D,"size","small"),p(D,"class","loadGasInicial"),N.p(o,d)},m(k,S){R(k,e,S),l(e,t),l(t,o),o.checked=~(i[4]||[]).indexOf(o.__value),i[21](o),l(t,n),l(t,r),l(e,f),l(e,b),l(b,I),R(k,_,S),R(k,s,S),l(s,v),l(v,d),d.checked=~(i[4]||[]).indexOf(d.__value),i[24](d),l(v,g),l(v,m),l(s,C),l(s,D),l(D,A),B||(y=[$(o,"change",i[19]),$(b,"click",i[22]),$(d,"change",i[23]),$(D,"click",i[25])],B=!0)},p(k,S){S[0]&16&&(o.checked=~(k[4]||[]).indexOf(o.__value)),S[0]&4&&O!==(O=k[2]?k[2]+" km.":"Cargar km")&&Le(I,O),S[0]&16&&(d.checked=~(k[4]||[]).indexOf(d.__value)),S[0]&8&&P!==(P=k[3]?k[3]+" litros":"Cargar gas")&&Le(A,P)},d(k){k&&(a(e),a(_),a(s)),i[21](null),i[24](null),N.r(),B=!1,He(y)}}}function vn(i){let e=[],t=new Map,o,n=Be(i[12]);const r=h=>h[49].id_checklist_event;for(let h=0;h<n.length;h+=1){let f=gt(i,n,h),b=r(f);t.set(b,e[h]=Et(b,f))}return{c(){for(let h=0;h<e.length;h+=1)e[h].c();o=we()},l(h){for(let f=0;f<e.length;f+=1)e[f].l(h);o=we()},m(h,f){for(let b=0;b<e.length;b+=1)e[b]&&e[b].m(h,f);R(h,o,f)},p(h,f){f[0]&202864&&(n=Be(h[12]),e=tt(e,f,r,1,h,n,t,o.parentNode,nt,Et,o,gt))},d(h){h&&a(o);for(let f=0;f<e.length;f+=1)e[f].d(h)}}}function Et(i,e){let t,o,n,r=e[49],h,f,b=e[49].item+"",O,I,_,s,v=(e[11][e[49].id_checklist_event]?e[11][e[49].id_checklist_event]:"Cargar evidencia")+"",d,g,m,T,C,D,P;const A=()=>e[33](n,r),N=()=>e[33](null,r);function B(){return e[34](e[49])}function y(...k){return e[36](e[49],...k)}return C=pt(e[20][0]),{key:i,first:null,c(){t=c("ion-item"),o=c("ion-label"),n=c("input"),h=w(),f=c("p"),O=ie(b),I=w(),_=c("ion-button"),s=c("label"),d=ie(v),g=w(),m=c("input"),T=w(),this.h()},l(k){t=u(k,"ION-ITEM",{});var S=E(t);o=u(S,"ION-LABEL",{style:!0});var q=E(o);n=u(q,"INPUT",{id:!0,style:!0,type:!0}),h=L(q),f=u(q,"P",{style:!0});var H=E(f);O=re(H,b),H.forEach(a),q.forEach(a),I=L(S),_=u(S,"ION-BUTTON",{fill:!0,class:!0,size:!0});var z=E(_);s=u(z,"LABEL",{for:!0});var W=E(s);d=re(W,v),W.forEach(a),g=L(z),m=u(z,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0}),z.forEach(a),T=L(S),S.forEach(a),this.h()},h(){V(n,"id",`chkbox-${e[49].id_checklist_event}`),j(n,"pointer-events","auto"),V(n,"type","checkbox"),n.__value=e[49].id_checklist_event,jt(n,n.__value),n.required=!0,j(f,"margin-left","10px"),j(o,"display","flex"),V(s,"for","chklist-"+e[49].id_checklist_event),j(m,"display","none"),V(m,"id","chklist-"+e[49].id_checklist_event),V(m,"name","fileToUpload"),V(m,"type","file"),V(m,"accept","image/*"),p(_,"fill","outline"),p(_,"class","loadEvidence svelte-1lh6nay"),p(_,"size","small"),C.p(n),this.first=t},m(k,S){R(k,t,S),l(t,o),l(o,n),n.checked=~(e[4]||[]).indexOf(n.__value),A(),l(o,h),l(o,f),l(f,O),l(t,I),l(t,_),l(_,s),l(s,d),l(_,g),l(_,m),e[35](m),l(t,T),D||(P=[$(n,"change",e[32]),$(n,"change",B),$(m,"change",y)],D=!0)},p(k,S){e=k,S[0]&16&&(n.checked=~(e[4]||[]).indexOf(n.__value)),r!==e[49]&&(N(),r=e[49],A()),S[0]&2048&&v!==(v=(e[11][e[49].id_checklist_event]?e[11][e[49].id_checklist_event]:"Cargar evidencia")+"")&&Le(d,v)},d(k){k&&a(t),N(),e[35](null),C.r(),D=!1,He(P)}}}function bn(i){let e,t,o,n,r="Cancelar",h,f,b="Requerimientos de ruta",O,I,_,s,v,d,g,m="Confirmar",T,C;function D(B,y){return B[13]?mn:pn}let A=D(i)(i),N=i[12]&&vn(i);return{c(){e=c("ion-header"),t=c("ion-toolbar"),o=c("ion-buttons"),n=c("ion-button"),n.textContent=r,h=w(),f=c("ion-title"),f.textContent=b,O=w(),I=c("ion-content"),_=c("ion-list"),A.c(),s=w(),N&&N.c(),v=w(),d=c("ion-footer"),g=c("ion-button"),g.textContent=m,this.h()},l(B){e=u(B,"ION-HEADER",{translucent:!0});var y=E(e);t=u(y,"ION-TOOLBAR",{});var k=E(t);o=u(k,"ION-BUTTONS",{slot:!0});var S=E(o);n=u(S,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),x(n)!=="svelte-1dnmkxs"&&(n.textContent=r),S.forEach(a),h=L(k),f=u(k,"ION-TITLE",{"data-svelte-h":!0}),x(f)!=="svelte-ucox25"&&(f.textContent=b),k.forEach(a),y.forEach(a),O=L(B),I=u(B,"ION-CONTENT",{fullscreen:!0});var q=E(I);_=u(q,"ION-LIST",{});var H=E(_);A.l(H),s=L(H),N&&N.l(H),H.forEach(a),q.forEach(a),v=L(B),d=u(B,"ION-FOOTER",{});var z=E(d);g=u(z,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),x(g)!=="svelte-g82qqw"&&(g.textContent=m),z.forEach(a),this.h()},h(){p(n,"color","medium"),p(o,"slot","start"),p(e,"translucent",""),p(I,"fullscreen",""),p(g,"fill","outline"),p(g,"color","tertiary"),p(g,"strong",""),j(g,"width","99%"),j(g,"height","auto")},m(B,y){R(B,e,y),l(e,t),l(t,o),l(o,n),l(t,h),l(t,f),R(B,O,y),R(B,I,y),l(I,_),A.m(_,null),l(_,s),N&&N.m(_,null),R(B,v,y),R(B,d,y),l(d,g),T||(C=[$(n,"click",i[14]),$(g,"click",i[15])],T=!0)},p(B,y){A.p(B,y),B[12]&&N.p(B,y)},i:be,o:be,d(B){B&&(a(e),a(O),a(I),a(v),a(d)),A.d(),N&&N.d(),T=!1,He(C)}}}function _t(i,e){if(typeof i=="object"&&i!==null||Array.isArray(i)){if(Array.isArray(i))return i.map(t=>_t(t,e)).flat();{const t=Object.keys(i);let o;return e=="id_checklist_event"?o=t.filter(r=>r.toLowerCase().includes("id_checklist_event")).map(r=>i[r]):e=="mandatory"?o=t.filter(r=>r.toLowerCase().includes("mandatory")).map(r=>i[r]):(console.error("Tipo de dato no reconocido."),o=!1),o}}else return console.error("Invalid input. Please provide a valid object or array."),[]}function it(i,e){let t=new FormData;t.append("id_route",i),t.append("status",e),fetch("https://rutaflow-app-development.up.railway.app/api/admin/route/change_status.php",{method:"POST",body:t}).then(o=>o.json()).then(o=>{}).catch(o=>{console.error("Error fetching data:",o)})}function gn(i,e,t){let o=document.querySelector("ion-modal");const n=o.componentProps.checklist,r=o.componentProps.driverId,h=o.componentProps.routeId,f=o.componentProps.isLast;let b,O,I,_,s=[],v=null,d={},g,m,T,C,D={},P={};st(()=>{f?console.log("Último checklist"):ct.update(U=>(U.mandatory=_t(n,"mandatory"),U.items=_t(n,"id_checklist_event"),U))});const A=async()=>{await(await et.create({header:"Datos o checklist incompletos",message:"Carga la evidencia requerida y marca todas las casillas para confirmar",buttons:[{text:"Cerrar"}]})).present()},N=async()=>{await(await et.create({header:"Datos capturados",message:"El kilometraje y gasolina final fueron registrados correctamente, espere aprobación para finalizar ruta",buttons:[{text:"Cerrar"}]})).present()},B=async U=>{await(await et.create({header:"Datos inválidos",message:U=="km"?"Llena correctamente el campo de kilometraje inicial":"Llena correctamente el campo de gasolina inicial",buttons:[{text:"Cerrar"}]})).present()},y=()=>{ot.dismiss(),r?je(`/drivers/${r}`):je("/drivers/me")},k=()=>{if(f){var U=z(I,"km"),K=z(_,"gas");const ce=new FormData;ce.append("km_final",U),ce.append("gas_final",K),ce.append("id_route",h),U&&K?(y(),fetch("https://rutaflow-app-development.up.railway.app/api/admin/checklist/add_evidence.php",{method:"POST",body:ce}).then(de=>de.json()).then(de=>{N()}).catch(de=>{console.error("Error fetching data:",de)})):A()}else{var ne=z(b,"km"),se=z(O,"gas");ct.update(ce=>{const de=ce.items,J=ce.mandatory;if(de.every(Q=>ce.checkedIndices.includes(Q))&&ne&&se){y();const Q=new FormData;for(const te in D)if(D.hasOwnProperty(te)){const{img:ue,img_id:X}=D[te];Q.append(`selectedImages[${te}][img]`,ue),Q.append(`selectedImages[${te}][img_id]`,X)}Q.append("km_inicial",ne),Q.append("gas_inicial",se),Q.append("id_route",h),fetch("https://rutaflow-app-development.up.railway.app/api/admin/checklist/add_evidence.php",{method:"POST",body:Q}).then(te=>te.json()).then(te=>{J&&J[0]=="1"?it(h,"checklist-pending"):it(h,"enroute")}).catch(te=>{console.error("Error fetching data:",te)})}else if(!J&&ne&&se){var oe=new FormData;oe.append("km_inicial",ne),oe.append("gas_inicial",se),fetch("https://rutaflow-app-development.up.railway.app/api/admin/checklist/add_evidence.php",{method:"POST",body:oe}).then(Q=>Q.json()).then(Q=>{it(h,"enroute"),console.log("Holaaa")}).catch(Q=>{console.error("Error fetching data:",Q)})}else A();return ce})}G()},S=async(U,K)=>{const se=U.target.files[0],ce=await q(se);if(ce){const de=new FormData;de.append("fileToUpload",ce);try{const J=await fetch("https://rutaflow-app-development.up.railway.app/api/admin/manager/upload_img_driver.php",{method:"POST",body:de});if(J.ok){const Y=await J.json();D={...D,[K]:{img:Y.img,img_id:Y.img_id}},t(11,P={...P,[K]:Y.filename}),H(K),t(6,d[K].checked=!0,d)}else console.error("File upload failed:",J.statusText)}catch(J){console.error("Error during file upload:",J)}}},q=async U=>new Promise(K=>{const ne=new FileReader;ne.onload=se=>{const ce=new Image;ce.src=se.target.result,ce.onload=()=>{const de=document.createElement("canvas"),J=de.getContext("2d"),Y=800,oe=600;let Q=ce.width,te=ce.height;Q>Y&&(te*=Y/Q,Q=Y),te>oe&&(Q*=oe/te,te=oe),de.width=Q,de.height=te,J.drawImage(ce,0,0,Q,te),de.toBlob(ue=>{K(ue)},"image/jpeg",.7)}},ne.readAsDataURL(U)}),H=U=>{ct.update(K=>(K.checkedIndices.indexOf(U)===-1?K.checkedIndices.push(U):console.error(`ID ${U} is already checked.`),K.items.forEach(se=>{se.id_checklist_event===U&&(se.checked=!0)}),K))};function z(U,K){return/^\d+$/.test(U)?parseInt(U,10):(B(K),null)}function W(U,K){ee(K),o.componentProps.data_type=K,Re("modal-gas-km",hn,{r:K}).then(()=>{Ge.subscribe(ne=>{M(ne,K)})})}function ee(U){qt.update(K=>({...K,flag:[U]}))}function M(U,K){t(0,b=U.km_inicial?U.km_inicial:null),t(1,O=U.gas_inicial?U.gas_inicial:null),t(2,I=U.km_final?U.km_final:null),t(3,_=U.gas_final?U.gas_final:null),K=="km_inicial"&&t(7,g.checked=!0,g),K=="gas_inicial"&&t(8,m.checked=!0,m),K=="km_final"&&t(9,T.checked=!0,T),K=="gas_final"&&t(10,C.checked=!0,C)}function G(){Ge.set({km_inicial:[],gas_inicial:[],km_final:[],gas_final:[]})}const F=[[]];function Z(){s=$e(F[0],this.__value,this.checked),t(4,s)}function pe(U){ye[U?"unshift":"push"](()=>{T=U,t(9,T)})}const ge=U=>W(U,"km_final");function ae(){s=$e(F[0],this.__value,this.checked),t(4,s)}function Ee(U){ye[U?"unshift":"push"](()=>{C=U,t(10,C)})}const Pe=U=>W(U,"gas_final");function _e(){s=$e(F[0],this.__value,this.checked),t(4,s)}function Ie(U){ye[U?"unshift":"push"](()=>{g=U,t(7,g)})}const ke=U=>W(U,"km_inicial");function me(U){ye[U?"unshift":"push"](()=>{m=U,t(8,m)})}function le(){s=$e(F[0],this.__value,this.checked),t(4,s)}const ve=U=>W(U,"gas_inicial");function Ue(){s=$e(F[0],this.__value,this.checked),t(4,s)}function Ne(U,K){ye[U?"unshift":"push"](()=>{d[K.id_checklist_event]=U,t(6,d)})}const Te=U=>H(U.id_checklist_event);function De(U){ye[U?"unshift":"push"](()=>{v=U,t(5,v)})}return[b,O,I,_,s,v,d,g,m,T,C,P,n,f,y,k,S,H,W,Z,F,pe,ge,ae,Ee,Pe,_e,Ie,ke,me,le,ve,Ue,Ne,Te,De,(U,K)=>S(K,U.id_checklist_event)]}class zt extends Xe{constructor(e){super(),Je(this,e,gn,bn,We,{},null,[-1,-1])}}function En(i){let e,t,o,n,r,h="Teléfono",f,b,O=i[2].client_phone+"",I;return{c(){e=c("ion-item"),t=c("ion-icon"),o=w(),n=c("ion-label"),r=c("p"),r.textContent=h,f=w(),b=c("h2"),I=ie(O),this.h()},l(_){e=u(_,"ION-ITEM",{href:!0});var s=E(e);t=u(s,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(a),o=L(s),n=u(s,"ION-LABEL",{class:!0});var v=E(n);r=u(v,"P",{"data-svelte-h":!0}),x(r)!=="svelte-9g5fr8"&&(r.textContent=h),f=L(v),b=u(v,"H2",{});var d=E(b);I=re(d,O),d.forEach(a),v.forEach(a),s.forEach(a),this.h()},h(){p(t,"icon",Qt),p(t,"slot","start"),p(n,"class","ion-text-wrap"),p(e,"href","tel:"+i[2].client_phone)},m(_,s){R(_,e,s),l(e,t),l(e,o),l(e,n),l(n,r),l(n,f),l(n,b),l(b,I)},p:be,d(_){_&&a(e)}}}function In(i){let e,t,o,n,r,h="Domicilio 2",f,b,O=i[2].line2+"",I,_,s;return{c(){e=c("ion-item"),t=c("ion-icon"),o=w(),n=c("ion-label"),r=c("p"),r.textContent=h,f=w(),b=c("h2"),I=ie(O),_=w(),s=c("ion-icon"),this.h()},l(v){e=u(v,"ION-ITEM",{href:!0});var d=E(e);t=u(d,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(a),o=L(d),n=u(d,"ION-LABEL",{class:!0});var g=E(n);r=u(g,"P",{"data-svelte-h":!0}),x(r)!=="svelte-1qy148r"&&(r.textContent=h),f=L(g),b=u(g,"H2",{});var m=E(b);I=re(m,O),m.forEach(a),g.forEach(a),_=L(d),s=u(d,"ION-ICON",{icon:!0,slot:!0}),E(s).forEach(a),d.forEach(a),this.h()},h(){p(t,"icon",mt),p(t,"slot","start"),p(n,"class","ion-text-wrap"),p(s,"icon",Ye),p(s,"slot","end"),p(e,"href","https://www.google.com/maps/searhc/?api=1&query="+i[2].line2)},m(v,d){R(v,e,d),l(e,t),l(e,o),l(e,n),l(n,r),l(n,f),l(n,b),l(b,I),l(e,_),l(e,s)},p:be,d(v){v&&a(e)}}}function kn(i){let e,t,o,n,r,h="Domicilio 1",f,b,O=i[2].line1+"",I,_,s,v,d=i[2].line2&&i[2].line2.trim().length,g,m=d&&On(i);return{c(){e=c("ion-item"),t=c("ion-icon"),o=w(),n=c("ion-label"),r=c("p"),r.textContent=h,f=w(),b=c("h2"),I=ie(O),_=w(),s=c("ion-icon"),v=w(),m&&m.c(),g=we(),this.h()},l(T){e=u(T,"ION-ITEM",{href:!0});var C=E(e);t=u(C,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(a),o=L(C),n=u(C,"ION-LABEL",{class:!0});var D=E(n);r=u(D,"P",{"data-svelte-h":!0}),x(r)!=="svelte-1ehcrdm"&&(r.textContent=h),f=L(D),b=u(D,"H2",{});var P=E(b);I=re(P,O),P.forEach(a),D.forEach(a),_=L(C),s=u(C,"ION-ICON",{icon:!0,slot:!0}),E(s).forEach(a),C.forEach(a),v=L(T),m&&m.l(T),g=we(),this.h()},h(){p(t,"icon",mt),p(t,"slot","start"),p(n,"class","ion-text-wrap"),p(s,"icon",Ye),p(s,"slot","end"),p(e,"href","https://www.google.com/maps/search/?api=1&query="+i[2].line1)},m(T,C){R(T,e,C),l(e,t),l(e,o),l(e,n),l(n,r),l(n,f),l(n,b),l(b,I),l(e,_),l(e,s),R(T,v,C),m&&m.m(T,C),R(T,g,C)},p(T,C){d&&m.p(T,C)},d(T){T&&(a(e),a(v),a(g)),m&&m.d(T)}}}function On(i){let e,t,o,n,r,h="Domicilio 2",f,b,O=i[2].line2+"",I,_,s;return{c(){e=c("ion-item"),t=c("ion-icon"),o=w(),n=c("ion-label"),r=c("p"),r.textContent=h,f=w(),b=c("h2"),I=ie(O),_=w(),s=c("ion-icon"),this.h()},l(v){e=u(v,"ION-ITEM",{href:!0});var d=E(e);t=u(d,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(a),o=L(d),n=u(d,"ION-LABEL",{class:!0});var g=E(n);r=u(g,"P",{"data-svelte-h":!0}),x(r)!=="svelte-1qy148r"&&(r.textContent=h),f=L(g),b=u(g,"H2",{});var m=E(b);I=re(m,O),m.forEach(a),g.forEach(a),_=L(d),s=u(d,"ION-ICON",{icon:!0,slot:!0}),E(s).forEach(a),d.forEach(a),this.h()},h(){p(t,"icon",mt),p(t,"slot","start"),p(n,"class","ion-text-wrap"),p(s,"icon",Ye),p(s,"slot","end"),p(e,"href","https://www.google.com/maps/search/?api=1&query="+i[2].line2)},m(v,d){R(v,e,d),l(e,t),l(e,o),l(e,n),l(n,r),l(n,f),l(n,b),l(b,I),l(e,_),l(e,s)},p:be,d(v){v&&a(e)}}}function Nn(i){let e,t=i[2].comments!="<br>"&&Tn(i);return{c(){t&&t.c(),e=we()},l(o){t&&t.l(o),e=we()},m(o,n){t&&t.m(o,n),R(o,e,n)},p(o,n){o[2].comments!="<br>"&&t.p(o,n)},d(o){o&&a(e),t&&t.d(o)}}}function Tn(i){let e,t,o,n,r,h="Notas de ubicación",f,b,O=i[2].comments+"",I;return{c(){e=c("ion-item"),t=c("ion-icon"),o=w(),n=c("ion-label"),r=c("p"),r.textContent=h,f=w(),b=c("h2"),I=ie(O),this.h()},l(_){e=u(_,"ION-ITEM",{});var s=E(e);t=u(s,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(a),o=L(s),n=u(s,"ION-LABEL",{class:!0});var v=E(n);r=u(v,"P",{"data-svelte-h":!0}),x(r)!=="svelte-nhm2ft"&&(r.textContent=h),f=L(v),b=u(v,"H2",{});var d=E(b);I=re(d,O),d.forEach(a),v.forEach(a),s.forEach(a),this.h()},h(){p(t,"icon",Ut),p(t,"slot","start"),p(n,"class","ion-text-wrap")},m(_,s){R(_,e,s),l(e,t),l(e,o),l(e,n),l(n,r),l(n,f),l(n,b),l(b,I)},p:be,d(_){_&&a(e)}}}function yn(i){let e,t,o,n,r,h="Horarios",f,b,O=i[2].schedule+"",I;return{c(){e=c("ion-item"),t=c("ion-icon"),o=w(),n=c("ion-label"),r=c("p"),r.textContent=h,f=w(),b=c("h2"),I=ie(O),this.h()},l(_){e=u(_,"ION-ITEM",{});var s=E(e);t=u(s,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(a),o=L(s),n=u(s,"ION-LABEL",{});var v=E(n);r=u(v,"P",{"data-svelte-h":!0}),x(r)!=="svelte-11q7hm5"&&(r.textContent=h),f=L(v),b=u(v,"H2",{});var d=E(b);I=re(d,O),d.forEach(a),v.forEach(a),s.forEach(a),this.h()},h(){p(t,"icon",$t),p(t,"slot","start")},m(_,s){R(_,e,s),l(e,t),l(e,o),l(e,n),l(n,r),l(n,f),l(n,b),l(b,I)},p:be,d(_){_&&a(e)}}}function Cn(i){let e,t,o,n,r,h="Notas del operador",f,b,O=i[2].driver_comments+"",I;return{c(){e=c("ion-item"),t=c("ion-icon"),o=w(),n=c("ion-label"),r=c("p"),r.textContent=h,f=w(),b=c("h2"),I=ie(O),this.h()},l(_){e=u(_,"ION-ITEM",{});var s=E(e);t=u(s,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(a),o=L(s),n=u(s,"ION-LABEL",{});var v=E(n);r=u(v,"P",{"data-svelte-h":!0}),x(r)!=="svelte-1yk9qp4"&&(r.textContent=h),f=L(v),b=u(v,"H2",{});var d=E(b);I=re(d,O),d.forEach(a),v.forEach(a),s.forEach(a),this.h()},h(){p(t,"icon",Rt),p(t,"slot","start")},m(_,s){R(_,e,s),l(e,t),l(e,o),l(e,n),l(n,r),l(n,f),l(n,b),l(b,I)},p:be,d(_){_&&a(e)}}}function wn(i){let e,t=i[2].logistic_comments!="<br>"&&Ln(i);return{c(){t&&t.c(),e=we()},l(o){t&&t.l(o),e=we()},m(o,n){t&&t.m(o,n),R(o,e,n)},p(o,n){o[2].logistic_comments!="<br>"&&t.p(o,n)},d(o){o&&a(e),t&&t.d(o)}}}function Ln(i){let e,t,o,n,r,h="Comentarios logísticos",f,b,O=i[2].logistic_comments+"",I;return{c(){e=c("ion-item"),t=c("ion-icon"),o=w(),n=c("ion-label"),r=c("p"),r.textContent=h,f=w(),b=c("h2"),I=ie(O),this.h()},l(_){e=u(_,"ION-ITEM",{});var s=E(e);t=u(s,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(a),o=L(s),n=u(s,"ION-LABEL",{class:!0});var v=E(n);r=u(v,"P",{"data-svelte-h":!0}),x(r)!=="svelte-1iz85r6"&&(r.textContent=h),f=L(v),b=u(v,"H2",{});var d=E(b);I=re(d,O),d.forEach(a),v.forEach(a),s.forEach(a),this.h()},h(){p(t,"icon",Ut),p(t,"slot","start"),p(n,"class","ion-text-wrap")},m(_,s){R(_,e,s),l(e,t),l(e,o),l(e,n),l(n,r),l(n,f),l(n,b),l(b,I)},p:be,d(_){_&&a(e)}}}function It(i){let e,t,o;return{c(){e=c("section"),t=c("ion-img"),this.h()},l(n){e=u(n,"SECTION",{});var r=E(e);t=u(r,"ION-IMG",{src:!0,alt:!0,style:!0}),E(t).forEach(a),r.forEach(a),this.h()},h(){at(t.src,o=i[1])||p(t,"src",o),p(t,"alt","Evidencia fotográfica"),j(t,"max-width","100%"),j(t,"margin-top","16px")},m(n,r){R(n,e,r),l(e,t)},p(n,r){r&2&&!at(t.src,o=n[1])&&p(t,"src",o)},d(n){n&&a(e)}}}function Pn(i){let e,t,o,n,r="Cancelar",h,f,b=i[2].title+"",O,I,_,s,v="Confirmar",d,g,m,T,C,D,P,A,N="Cliente",B,y,k=i[2].client_name+"",S,q,H=i[2].client_phone&&i[2].client_phone.trim().length,z,W,ee=i[2].comments&&i[2].comments.trim().length,M,G=i[2].schedule&&i[2].schedule.trim().length,F,Z,pe=i[2].logistic_comments&&i[2].logistic_comments.trim().length,ge,ae,Ee,Pe,_e,Ie,ke,me,le,ve,Ue,Ne,Te="Subir Evidencia",De,Oe,U,K,ne,se=H&&En(i);function ce(X,he){if(X[2].line1&&X[2].line1.trim().length)return kn;if(X[2].line2&&X[2].line2.trim().length)return In}let de=ce(i),J=de&&de(i),Y=ee&&Nn(i),oe=G&&yn(i),Q=i[2].driver_comments&&Cn(i),te=pe&&wn(i),ue=i[1]&&It(i);return{c(){e=c("ion-header"),t=c("ion-toolbar"),o=c("ion-buttons"),n=c("ion-button"),n.textContent=r,h=w(),f=c("ion-title"),O=ie(b),I=w(),_=c("ion-buttons"),s=c("ion-button"),s.textContent=v,d=w(),g=c("ion-content"),m=c("ion-list"),T=c("ion-item"),C=c("ion-icon"),D=w(),P=c("ion-label"),A=c("p"),A.textContent=N,B=w(),y=c("h2"),S=ie(k),q=w(),se&&se.c(),z=w(),J&&J.c(),W=w(),Y&&Y.c(),M=w(),oe&&oe.c(),F=w(),Q&&Q.c(),Z=w(),te&&te.c(),ge=w(),ae=c("ion-item"),Ee=c("ion-icon"),Pe=w(),_e=c("ion-textarea"),Ie=w(),ke=c("section"),me=c("label"),le=c("ion-button"),ve=c("ion-icon"),Ue=w(),Ne=c("label"),Ne.textContent=Te,De=w(),Oe=c("input"),U=w(),ue&&ue.c(),this.h()},l(X){e=u(X,"ION-HEADER",{translucent:!0});var he=E(e);t=u(he,"ION-TOOLBAR",{});var Ae=E(t);o=u(Ae,"ION-BUTTONS",{slot:!0});var qe=E(o);n=u(qe,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),x(n)!=="svelte-1f8rjcf"&&(n.textContent=r),qe.forEach(a),h=L(Ae),f=u(Ae,"ION-TITLE",{title:!0});var Se=E(f);O=re(Se,b),Se.forEach(a),I=L(Ae),_=u(Ae,"ION-BUTTONS",{slot:!0});var ze=E(_);s=u(ze,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),x(s)!=="svelte-1ida0il"&&(s.textContent=v),ze.forEach(a),Ae.forEach(a),he.forEach(a),d=L(X),g=u(X,"ION-CONTENT",{fullscreen:!0});var Ze=E(g);m=u(Ze,"ION-LIST",{});var fe=E(m);T=u(fe,"ION-ITEM",{});var Me=E(T);C=u(Me,"ION-ICON",{icon:!0,slot:!0}),E(C).forEach(a),D=L(Me),P=u(Me,"ION-LABEL",{});var Fe=E(P);A=u(Fe,"P",{"data-svelte-h":!0}),x(A)!=="svelte-jrq7ei"&&(A.textContent=N),B=L(Fe),y=u(Fe,"H2",{});var Qe=E(y);S=re(Qe,k),Qe.forEach(a),Fe.forEach(a),Me.forEach(a),q=L(fe),se&&se.l(fe),z=L(fe),J&&J.l(fe),W=L(fe),Y&&Y.l(fe),M=L(fe),oe&&oe.l(fe),F=L(fe),Q&&Q.l(fe),Z=L(fe),te&&te.l(fe),ge=L(fe),ae=u(fe,"ION-ITEM",{});var lt=E(ae);Ee=u(lt,"ION-ICON",{icon:!0,slot:!0}),E(Ee).forEach(a),Pe=L(lt),_e=u(lt,"ION-TEXTAREA",{label:!0,placeholder:!0}),E(_e).forEach(a),lt.forEach(a),Ie=L(fe),ke=u(fe,"SECTION",{});var vt=E(ke);me=u(vt,"LABEL",{for:!0,style:!0});var bt=E(me);le=u(bt,"ION-BUTTON",{fill:!0,class:!0,expand:!0});var Ve=E(le);ve=u(Ve,"ION-ICON",{icon:!0,slot:!0}),E(ve).forEach(a),Ue=L(Ve),Ne=u(Ve,"LABEL",{for:!0,style:!0,"data-svelte-h":!0}),x(Ne)!=="svelte-1as0od8"&&(Ne.textContent=Te),De=L(Ve),Oe=u(Ve,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0}),Ve.forEach(a),bt.forEach(a),vt.forEach(a),U=L(fe),ue&&ue.l(fe),fe.forEach(a),Ze.forEach(a),this.h()},h(){p(n,"color","medium"),p(o,"slot","start"),p(f,"title",i[2].title),p(s,"strong",""),p(_,"slot","end"),p(e,"translucent",""),p(C,"icon",Zt),p(C,"slot","start"),p(Ee,"icon",ft),p(Ee,"slot","start"),p(_e,"label","Notas"),p(_e,"placeholder","Escribe aquí..."),p(ve,"icon",Ht),p(ve,"slot","start"),V(Ne,"for","eventEvidence"),j(Ne,"padding","8px 10px"),j(Oe,"display","none"),V(Oe,"id","eventEvidence"),V(Oe,"name","fileToUpload"),V(Oe,"type","file"),V(Oe,"accept","image/*"),p(le,"fill","outline"),p(le,"class","loadEvidence"),p(le,"expand","block"),V(me,"for","eventEvidence"),j(me,"display","block"),j(me,"width","100%"),p(g,"fullscreen","")},m(X,he){R(X,e,he),l(e,t),l(t,o),l(o,n),l(t,h),l(t,f),l(f,O),l(t,I),l(t,_),l(_,s),R(X,d,he),R(X,g,he),l(g,m),l(m,T),l(T,C),l(T,D),l(T,P),l(P,A),l(P,B),l(P,y),l(y,S),l(m,q),se&&se.m(m,null),l(m,z),J&&J.m(m,null),l(m,W),Y&&Y.m(m,null),l(m,M),oe&&oe.m(m,null),l(m,F),Q&&Q.m(m,null),l(m,Z),te&&te.m(m,null),l(m,ge),l(m,ae),l(ae,Ee),l(ae,Pe),l(ae,_e),i[6](_e),l(m,Ie),l(m,ke),l(ke,me),l(me,le),l(le,ve),l(le,Ue),l(le,Ne),l(le,De),l(le,Oe),l(m,U),ue&&ue.m(m,null),K||(ne=[$(n,"click",i[4]),$(s,"click",i[5]),$(Oe,"change",i[3])],K=!0)},p(X,[he]){H&&se.p(X,he),J&&J.p(X,he),ee&&Y.p(X,he),G&&oe.p(X,he),X[2].driver_comments&&Q.p(X,he),pe&&te.p(X,he),X[1]?ue?ue.p(X,he):(ue=It(X),ue.c(),ue.m(m,null)):ue&&(ue.d(1),ue=null)},i:be,o:be,d(X){X&&(a(e),a(d),a(g)),se&&se.d(),J&&J.d(),Y&&Y.d(),oe&&oe.d(),Q&&Q.d(),te&&te.d(),i[6](null),ue&&ue.d(),K=!1,He(ne)}}}function An(i,e,t){let o=document.querySelector("ion-modal"),n=o.componentProps.delivery,r=o.componentProps.isLast,h=n.driver_comments?n.driver_comments:"",f=n.img?n.img:"",b="",O={latitude:null,longitude:null};const I=async T=>{const D=T.target.files[0],P=await _(D);if(P){const A=new FormData;A.append("fileToUpload",P);try{const N=await fetch("https://rutaflow-app-development.up.railway.app/api/admin/manager/upload_img_driver.php",{method:"POST",body:A});if(N.ok){const B=await N.json();t(1,f=B.img),b=B.img_id}else console.error("File upload failed:",N.statusText)}catch(N){console.error("Error during file upload:",N)}}},_=async T=>new Promise(C=>{const D=new FileReader;D.onload=P=>{const A=new Image;A.src=P.target.result,A.onload=()=>{const N=document.createElement("canvas"),B=N.getContext("2d"),y=800,k=600;let S=A.width,q=A.height;S>y&&(q*=y/S,S=y),q>k&&(S*=k/q,q=k),N.width=S,N.height=q,B.drawImage(A,0,0,S,q),N.toBlob(H=>{C(H)},"image/jpeg",.7)}},D.readAsDataURL(T)}),s=()=>{o.dismiss({data:Date.now()})},v=async()=>{try{const T=await g();if(console.log(T),T){const C={id_route:n.id_route,id_event:n.id_event,comments:h.value,img:f,img_id:b,lat:O.latitude,lon:O.longitude},D=new FormData;for(const y in C)D.append(y,C[y]);console.log(D);const A=await(await fetch("https://rutaflow-app-development.up.railway.app/api/admin/evidence/send_evidence.php",{method:"POST",body:D})).json();s();const N={},B=C.id_route;r&&d("","",B,r)}else console.log("No entré")}catch(T){console.error("Error fetching data:",T)}},d=(T,C,D,P)=>{o.componentProps.routeId=D,o.componentProps.driverId=n.id_driver,Re("modal-km-gas",zt,{checklist:T,driverId:C,routeId:D,isLast:P}).then(A=>{})},g=async()=>navigator.geolocation?new Promise((T,C)=>{navigator.geolocation.getCurrentPosition(D=>{O.latitude=D.coords.latitude,O.longitude=D.coords.longitude,T(!0)},D=>{console.error("Error getting location:",D),T(!1)})}):(console.error("Geolocation is not supported by your browser"),!1);function m(T){ye[T?"unshift":"push"](()=>{h=T,t(0,h)})}return[h,f,n,I,s,v,m]}class Sn extends Xe{constructor(e){super(),Je(this,e,An,Pn,We,{})}}function kt(i){let e,t,o;return{c(){e=c("section"),t=c("ion-img"),this.h()},l(n){e=u(n,"SECTION",{});var r=E(e);t=u(r,"ION-IMG",{src:!0,alt:!0,style:!0}),E(t).forEach(a),r.forEach(a),this.h()},h(){at(t.src,o=i[0])||p(t,"src",o),p(t,"alt","Evidencia fotográfica"),j(t,"max-width","100%"),j(t,"margin-top","16px")},m(n,r){R(n,e,r),l(e,t)},p(n,r){r&1&&!at(t.src,o=n[0])&&p(t,"src",o)},d(n){n&&a(e)}}}function Bn(i){let e,t,o,n,r="Cancelar",h,f,b="Agregar Gasto",O,I,_,s,v,d,g,m,T,C,D,P,A,N,B,y,k,S,q='Tipo de pago <ion-text color="danger">(Obligatorio)</ion-text>',H,z,W="Efectivo",ee,M,G="Tarjeta",F,Z,pe="Transferencia",ge,ae,Ee,Pe,_e,Ie,ke,me,le,ve,Ue=`<ion-icon icon="${Ht}" slot="start"></ion-icon>
                        Subir Evidencia`,Ne,Te,De,Oe,U,K,ne,se="Confirmar",ce,de,J=i[0]&&kt(i);return{c(){e=c("ion-header"),t=c("ion-toolbar"),o=c("ion-buttons"),n=c("ion-button"),n.textContent=r,h=w(),f=c("ion-title"),f.textContent=b,O=w(),I=c("ion-content"),_=c("ion-list"),s=c("ion-item"),v=c("ion-icon"),d=w(),g=c("ion-input"),m=w(),T=c("ion-item"),C=c("ion-icon"),D=w(),P=c("ion-input"),A=w(),N=c("ion-item"),B=c("ion-icon"),y=w(),k=c("ion-select"),S=c("div"),S.innerHTML=q,H=w(),z=c("ion-select-option"),z.textContent=W,ee=w(),M=c("ion-select-option"),M.textContent=G,F=w(),Z=c("ion-select-option"),Z.textContent=pe,ge=w(),ae=c("ion-item"),Ee=c("ion-icon"),Pe=w(),_e=c("ion-textarea"),Ie=w(),ke=c("section"),me=c("label"),le=c("ion-button"),ve=c("label"),ve.innerHTML=Ue,Ne=w(),Te=c("input"),De=w(),J&&J.c(),Oe=w(),U=c("ion-footer"),K=c("ion-toolbar"),ne=c("ion-button"),ne.textContent=se,this.h()},l(Y){e=u(Y,"ION-HEADER",{translucent:!0});var oe=E(e);t=u(oe,"ION-TOOLBAR",{});var Q=E(t);o=u(Q,"ION-BUTTONS",{slot:!0});var te=E(o);n=u(te,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),x(n)!=="svelte-1f8rjcf"&&(n.textContent=r),te.forEach(a),h=L(Q),f=u(Q,"ION-TITLE",{title:!0,"data-svelte-h":!0}),x(f)!=="svelte-10xvxus"&&(f.textContent=b),Q.forEach(a),oe.forEach(a),O=L(Y),I=u(Y,"ION-CONTENT",{fullscreen:!0});var ue=E(I);_=u(ue,"ION-LIST",{});var X=E(_);s=u(X,"ION-ITEM",{});var he=E(s);v=u(he,"ION-ICON",{icon:!0,slot:!0}),E(v).forEach(a),d=L(he),g=u(he,"ION-INPUT",{label:!0,type:!0,placeholder:!0,value:!0}),E(g).forEach(a),he.forEach(a),m=L(X),T=u(X,"ION-ITEM",{});var Ae=E(T);C=u(Ae,"ION-ICON",{icon:!0,slot:!0}),E(C).forEach(a),D=L(Ae),P=u(Ae,"ION-INPUT",{label:!0,type:!0,value:!0}),E(P).forEach(a),Ae.forEach(a),A=L(X),N=u(X,"ION-ITEM",{});var qe=E(N);B=u(qe,"ION-ICON",{icon:!0,slot:!0}),E(B).forEach(a),y=L(qe),k=u(qe,"ION-SELECT",{placeholder:!0,value:!0});var Se=E(k);S=u(Se,"DIV",{slot:!0,"data-svelte-h":!0}),x(S)!=="svelte-wl764p"&&(S.innerHTML=q),H=L(Se),z=u(Se,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),x(z)!=="svelte-i9crym"&&(z.textContent=W),ee=L(Se),M=u(Se,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),x(M)!=="svelte-fx0z11"&&(M.textContent=G),F=L(Se),Z=u(Se,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),x(Z)!=="svelte-1c24jf2"&&(Z.textContent=pe),Se.forEach(a),qe.forEach(a),ge=L(X),ae=u(X,"ION-ITEM",{});var ze=E(ae);Ee=u(ze,"ION-ICON",{icon:!0,slot:!0}),E(Ee).forEach(a),Pe=L(ze),_e=u(ze,"ION-TEXTAREA",{label:!0,placeholder:!0}),E(_e).forEach(a),ze.forEach(a),Ie=L(X),ke=u(X,"SECTION",{});var Ze=E(ke);me=u(Ze,"LABEL",{for:!0,style:!0});var fe=E(me);le=u(fe,"ION-BUTTON",{fill:!0,size:!0,class:!0,expand:!0});var Me=E(le);ve=u(Me,"LABEL",{for:!0,style:!0,"data-svelte-h":!0}),x(ve)!=="svelte-1m9yw22"&&(ve.innerHTML=Ue),Ne=L(Me),Te=u(Me,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0}),Me.forEach(a),fe.forEach(a),Ze.forEach(a),De=L(X),J&&J.l(X),X.forEach(a),ue.forEach(a),Oe=L(Y),U=u(Y,"ION-FOOTER",{});var Fe=E(U);K=u(Fe,"ION-TOOLBAR",{});var Qe=E(K);ne=u(Qe,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),x(ne)!=="svelte-1c7dl3f"&&(ne.textContent=se),Qe.forEach(a),Fe.forEach(a),this.h()},h(){p(n,"color","medium"),p(o,"slot","start"),p(f,"title",""),p(e,"translucent",""),p(v,"icon",Rt),p(v,"slot","start"),p(g,"label","Concepto"),p(g,"type","text"),p(g,"placeholder","Escribe aquí..."),p(g,"value",i[5]?i[5]:""),p(C,"icon",ft),p(C,"slot","start"),p(P,"label","Cantidad"),p(P,"type","number"),p(P,"value",i[6]?i[6]:""),p(B,"icon",en),p(B,"slot","start"),V(S,"slot","label"),p(z,"value","cash"),p(M,"value","card"),p(Z,"value","transfer"),p(k,"placeholder","Tipo de pago"),p(k,"value",i[7]?i[7]:""),p(Ee,"icon",ft),p(Ee,"slot","start"),p(_e,"label","Comentarios"),p(_e,"placeholder","Escribe aquí..."),V(ve,"for","eventEvidence"),j(ve,"width","100%"),j(ve,"padding","8px"),j(Te,"display","none"),V(Te,"id","eventEvidence"),V(Te,"name","fileToUpload"),V(Te,"type","file"),V(Te,"accept","image/*"),p(le,"fill","outline"),p(le,"size","small"),p(le,"class","loadEvidence"),p(le,"expand","block"),V(me,"for","eventEvidence"),j(me,"display","block"),j(me,"width","100%"),p(I,"fullscreen",""),p(ne,"fill","outline"),p(ne,"color","tertiary"),p(ne,"strong",""),j(ne,"width","99%"),j(ne,"height","auto")},m(Y,oe){R(Y,e,oe),l(e,t),l(t,o),l(o,n),l(t,h),l(t,f),R(Y,O,oe),R(Y,I,oe),l(I,_),l(_,s),l(s,v),l(s,d),l(s,g),i[11](g),l(_,m),l(_,T),l(T,C),l(T,D),l(T,P),i[12](P),l(_,A),l(_,N),l(N,B),l(N,y),l(N,k),l(k,S),l(k,H),l(k,z),l(k,ee),l(k,M),l(k,F),l(k,Z),i[13](k),l(_,ge),l(_,ae),l(ae,Ee),l(ae,Pe),l(ae,_e),i[14](_e),l(_,Ie),l(_,ke),l(ke,me),l(me,le),l(le,ve),l(le,Ne),l(le,Te),l(_,De),J&&J.m(_,null),R(Y,Oe,oe),R(Y,U,oe),l(U,K),l(K,ne),ce||(de=[$(n,"click",i[9]),$(Te,"change",i[8]),$(ne,"click",i[10])],ce=!0)},p(Y,[oe]){Y[0]?J?J.p(Y,oe):(J=kt(Y),J.c(),J.m(_,null)):J&&(J.d(1),J=null)},i:be,o:be,d(Y){Y&&(a(e),a(O),a(I),a(Oe),a(U)),i[11](null),i[12](null),i[13](null),i[14](null),J&&J.d(),ce=!1,He(de)}}}function Dn(i,e,t){let o=document.querySelector("ion-modal"),n=o.componentProps.routeId,r=o.componentProps.ex_concept,h=o.componentProps.ex_amount,f=o.componentProps.ex_type,b=o.componentProps.id_expense,O="",I="",_="",s=0,v="",d="";st(()=>{});const g=async(y,k)=>{await(await et.create({header:y||"Error",message:k||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()},m=async y=>{const S=y.target.files[0],q=await T(S);if(q){const H=new FormData;H.append("fileToUpload",q);try{const z=await fetch("https://rutaflow-app-development.up.railway.app/api/admin/manager/upload_img_driver.php",{method:"POST",body:H});if(z.ok){const W=await z.json();t(0,O=W.img),I=W.img_id}else console.error("File upload failed:",z.statusText)}catch(z){console.error("Error during file upload:",z)}}},T=async y=>new Promise(k=>{const S=new FileReader;S.onload=q=>{const H=new Image;H.src=q.target.result,H.onload=()=>{const z=document.createElement("canvas"),W=z.getContext("2d"),ee=800,M=600;let G=H.width,F=H.height;G>ee&&(F*=ee/G,G=ee),F>M&&(G*=M/F,F=M),z.width=G,z.height=F,W.drawImage(H,0,0,G,F),z.toBlob(Z=>{k(Z)},"image/jpeg",.7)}},S.readAsDataURL(y)}),C=()=>{ot.dismiss()},D=()=>{var y=new Object;y.id_route=n,y.comments=v.value,y.type=_.value,y.img=O,y.img_id=I,y.amount=s.value,y.concept=d.value,y.status="done",y.id_expense=b||"null";const k=new FormData;for(const S in y)k.append(S,y[S]);!I||!O||!v.value||!s.value||!d.value?g("Datos incompletos","Llena los datos requeridos para completar el registro"):fetch("https://rutaflow-app-development.up.railway.app/api/admin/expenses/add_expense.php",{method:"POST",body:k}).then(S=>S.json()).then(S=>{C()}).catch(S=>{console.error("Error fetching data:",S)})};function P(y){ye[y?"unshift":"push"](()=>{d=y,t(4,d)})}function A(y){ye[y?"unshift":"push"](()=>{s=y,t(2,s)})}function N(y){ye[y?"unshift":"push"](()=>{_=y,t(1,_)})}function B(y){ye[y?"unshift":"push"](()=>{v=y,t(3,v)})}return[O,_,s,v,d,r,h,f,m,C,D,P,A,N,B]}class dt extends Xe{constructor(e){super(),Je(this,e,Dn,Bn,We,{})}}function Ot(i,e,t){const o=i.slice();return o[7]=e[t],o}function Mn(i){let e,t="Cargar gasto",o,n;function r(...h){return i[4](i[7],...h)}return{c(){e=c("ion-button"),e.textContent=t,this.h()},l(h){e=u(h,"ION-BUTTON",{fill:!0,size:!0,"aria-selected":!0,"data-svelte-h":!0}),x(e)!=="svelte-175aelj"&&(e.textContent=t),this.h()},h(){p(e,"fill","outline"),p(e,"size","small"),p(e,"aria-selected","")},m(h,f){R(h,e,f),o||(n=$(e,"click",r),o=!0)},p(h,f){i=h},d(h){h&&a(e),o=!1,n()}}}function Hn(i){let e,t="Gasto completado";return{c(){e=c("ion-button"),e.textContent=t,this.h()},l(o){e=u(o,"ION-BUTTON",{fill:!0,size:!0,"aria-selected":!0,"data-svelte-h":!0}),x(e)!=="svelte-tlger7"&&(e.textContent=t),this.h()},h(){p(e,"fill","solid"),p(e,"size","small"),p(e,"aria-selected","")},m(o,n){R(o,e,n)},p:be,d(o){o&&a(e)}}}function Nt(i,e){let t,o,n,r=e[7].concept+"",h,f,b;function O(s,v){return s[7].status=="done"?Hn:Mn}let _=O(e)(e);return{key:i,first:null,c(){t=c("ion-item"),o=c("ion-label"),n=c("p"),h=ie(r),f=w(),_.c(),b=w(),this.h()},l(s){t=u(s,"ION-ITEM",{});var v=E(t);o=u(v,"ION-LABEL",{style:!0});var d=E(o);n=u(d,"P",{style:!0});var g=E(n);h=re(g,r),g.forEach(a),d.forEach(a),f=L(v),_.l(v),b=L(v),v.forEach(a),this.h()},h(){j(n,"margin-left","10px"),j(o,"display","flex"),this.first=t},m(s,v){R(s,t,v),l(t,o),l(o,n),l(n,h),l(t,f),_.m(t,null),l(t,b)},p(s,v){e=s,_.p(e,v)},d(s){s&&a(t),_.d()}}}function Un(i){let e,t,o,n,r=`<ion-icon style="font-size: 25px!important;" icon="${tn}"></ion-icon>`,h,f,b="Lista de gastos",O,I,_,s=[],v=new Map,d,g,m,T="Cerrar",C,D,P=Be(i[0]);const A=N=>N[7].id_expenses;for(let N=0;N<P.length;N+=1){let B=Ot(i,P,N),y=A(B);v.set(y,s[N]=Nt(y,B))}return{c(){e=c("ion-header"),t=c("ion-toolbar"),o=c("ion-buttons"),n=c("ion-button"),n.innerHTML=r,h=w(),f=c("ion-title"),f.textContent=b,O=w(),I=c("ion-content"),_=c("ion-list");for(let N=0;N<s.length;N+=1)s[N].c();d=w(),g=c("ion-footer"),m=c("ion-button"),m.textContent=T,this.h()},l(N){e=u(N,"ION-HEADER",{translucent:!0});var B=E(e);t=u(B,"ION-TOOLBAR",{});var y=E(t);o=u(y,"ION-BUTTONS",{slot:!0});var k=E(o);n=u(k,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),x(n)!=="svelte-160xz3i"&&(n.innerHTML=r),k.forEach(a),h=L(y),f=u(y,"ION-TITLE",{"data-svelte-h":!0}),x(f)!=="svelte-e3wnox"&&(f.textContent=b),y.forEach(a),B.forEach(a),O=L(N),I=u(N,"ION-CONTENT",{fullscreen:!0});var S=E(I);_=u(S,"ION-LIST",{});var q=E(_);for(let z=0;z<s.length;z+=1)s[z].l(q);q.forEach(a),S.forEach(a),d=L(N),g=u(N,"ION-FOOTER",{});var H=E(g);m=u(H,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),x(m)!=="svelte-zv7v83"&&(m.textContent=T),H.forEach(a),this.h()},h(){p(n,"color","medium"),p(o,"slot","end"),p(e,"translucent",""),p(I,"fullscreen",""),p(m,"fill","outline"),p(m,"color","tertiary"),p(m,"strong",""),j(m,"width","99%"),j(m,"height","auto")},m(N,B){R(N,e,B),l(e,t),l(t,o),l(o,n),l(t,h),l(t,f),R(N,O,B),R(N,I,B),l(I,_);for(let y=0;y<s.length;y+=1)s[y]&&s[y].m(_,null);R(N,d,B),R(N,g,B),l(g,m),C||(D=[$(n,"click",i[3]),$(m,"click",i[1])],C=!0)},p(N,[B]){B&5&&(P=Be(N[0]),s=tt(s,B,A,1,N,P,v,_,nt,Nt,null,Ot))},i:be,o:be,d(N){N&&(a(e),a(O),a(I),a(d),a(g));for(let B=0;B<s.length;B+=1)s[B].d();C=!1,He(D)}}}function Rn(i){let e=document.querySelector("ion-modal");e.componentProps.routeId;let t=e.componentProps.expenses;st(()=>{});const o=()=>{ot.dismiss()};function n(f,b,O,I,_){e.componentProps.ex_amount=O,e.componentProps.ex_concept=b,e.componentProps.ex_type=I,e.componentProps.id_expense=_,Re("modal-expense",dt,{amount:O,concept:b,type:I,id_expense:_}).then(()=>{}),o()}return[t,o,n,f=>{Re("modal-expense",dt,{routeId:f}).then(b=>{}),o()},(f,b)=>n(b,f.concept,f.amount,f.type,f.id_expenses)]}class qn extends Xe{constructor(e){super(),Je(this,e,Rn,Un,We,{})}}function Tt(i,e,t){const o=i.slice();return o[29]=e[t],o}function yt(i,e,t){const o=i.slice();return o[29]=e[t],o[31]=t,o}function Ct(i,e,t){const o=i.slice();return o[29]=e[t],o[31]=t,o}function wt(i){let e,t;return e=new rn({props:{$$slots:{default:[Gn]},$$scope:{ctx:i}}}),{c(){xt(e.$$.fragment)},l(o){Wt(e.$$.fragment,o)},m(o,n){Xt(e,o,n),t=!0},p(o,n){const r={};n[0]&507|n[1]&16&&(r.$$scope={dirty:n,ctx:o}),e.$set(r)},i(o){t||(rt(e.$$.fragment,o),t=!0)},o(o){ut(e.$$.fragment,o),t=!1},d(o){Jt(e,o)}}}function zn(i){let e,t,o,n='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Jala para actualizar" refreshing-spinner="circles" refreshing-text="Actualizando..."></ion-refresher-content>',r,h,f=[],b=new Map,O,I,_=i[4]&&Lt(i),s=Be(i[5]);const v=d=>d[29].id_event;for(let d=0;d<s.length;d+=1){let g=Tt(i,s,d),m=v(g);b.set(m,f[d]=At(m,g))}return{c(){_&&_.c(),e=w(),t=c("ion-content"),o=c("ion-refresher"),o.innerHTML=n,r=w(),h=c("ion-list");for(let d=0;d<f.length;d+=1)f[d].c();this.h()},l(d){_&&_.l(d),e=L(d),t=u(d,"ION-CONTENT",{});var g=E(t);o=u(g,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),x(o)!=="svelte-19e7x43"&&(o.innerHTML=n),r=L(g),h=u(g,"ION-LIST",{});var m=E(h);for(let T=0;T<f.length;T+=1)f[T].l(m);m.forEach(a),g.forEach(a),this.h()},h(){p(o,"slot","fixed")},m(d,g){_&&_.m(d,g),R(d,e,g),R(d,t,g),l(t,o),i[23](o),l(t,r),l(t,h);for(let m=0;m<f.length;m+=1)f[m]&&f[m].m(h,null);O||(I=$(o,"ionRefresh",i[9]),O=!0)},p(d,g){d[4]?_?_.p(d,g):(_=Lt(d),_.c(),_.m(e.parentNode,e)):_&&(_.d(1),_=null),g[0]&42016&&(s=Be(d[5]),f=tt(f,g,v,1,d,s,b,h,nt,At,null,Tt))},d(d){d&&(a(e),a(t)),_&&_.d(d),i[23](null);for(let g=0;g<f.length;g+=1)f[g].d();O=!1,I()}}}function Fn(i){let e,t;function o(h,f){return f[0]&128&&(e=null),e==null&&(e=!!h[7].every(Wn)),e?Vn:jn}let n=o(i,[-1,-1]),r=n(i);return{c(){r.c(),t=we()},l(h){r.l(h),t=we()},m(h,f){r.m(h,f),R(h,t,f)},p(h,f){n===(n=o(h,f))&&r?r.p(h,f):(r.d(1),r=n(h),r&&(r.c(),r.m(t.parentNode,t)))},d(h){h&&a(t),r.d(h)}}}function Lt(i){let e=i[11]("",i[1],i[0])+"",t;return{c(){t=ie(e)},l(o){t=re(o,e)},m(o,n){R(o,t,n)},p(o,n){n[0]&3&&e!==(e=o[11]("",o[1],o[0])+"")&&Le(t,e)},d(o){o&&a(t)}}}function Pt(i){let e;return{c(){e=c("span"),this.h()},l(t){e=u(t,"SPAN",{class:!0}),E(e).forEach(a),this.h()},h(){V(e,"class","notes svelte-ziybgw")},m(t,o){R(t,e,o)},d(t){t&&a(e)}}}function At(i,e){let t,o,n,r,h=parseInt(e[29].pos)+1+"",f,b,O,I,_,s,v=e[29].title+"",d,g,m=e[29].support_list&&e[29].support_list.length||e[13](e[29]),T,C,D,P,A,N=m&&Pt();function B(){return e[24](e[29])}return{key:i,first:null,c(){t=c("ion-item"),o=c("ion-avatar"),n=c("div"),r=c("div"),f=ie(h),O=w(),I=c("ion-label"),_=c("ion-text"),s=c("h3"),d=ie(v),g=w(),N&&N.c(),T=w(),C=c("ion-icon"),D=w(),this.h()},l(y){t=u(y,"ION-ITEM",{});var k=E(t);o=u(k,"ION-AVATAR",{slot:!0});var S=E(o);n=u(S,"DIV",{class:!0,title:!0,style:!0});var q=E(n);r=u(q,"DIV",{class:!0});var H=E(r);f=re(H,h),H.forEach(a),q.forEach(a),S.forEach(a),O=L(k),I=u(k,"ION-LABEL",{button:!0});var z=E(I);_=u(z,"ION-TEXT",{color:!0});var W=E(_);s=u(W,"H3",{});var ee=E(s);d=re(ee,v),g=L(ee),N&&N.l(ee),ee.forEach(a),W.forEach(a),z.forEach(a),T=L(k),C=u(k,"ION-ICON",{icon:!0,slot:!0,style:!0}),E(C).forEach(a),D=L(k),k.forEach(a),this.h()},h(){V(r,"class","order svelte-ziybgw"),V(n,"class","order-wrapper svelte-ziybgw"),V(n,"title",b=Ke(e[29].status)),j(n,"background-color",Ce(e[29])),j(n,"color",xe(Ce(e[29]))),p(o,"slot","start"),p(_,"color","#2e2e2e"),p(I,"button",""),p(C,"icon",Ye),p(C,"slot","end"),j(C,"color",Ce(e[29])),this.first=t},m(y,k){R(y,t,k),l(t,o),l(o,n),l(n,r),l(r,f),l(t,O),l(t,I),l(I,_),l(_,s),l(s,d),l(s,g),N&&N.m(s,null),l(t,T),l(t,C),l(t,D),P||(A=$(I,"click",B),P=!0)},p(y,k){e=y,k[0]&32&&h!==(h=parseInt(e[29].pos)+1+"")&&Le(f,h),k[0]&32&&b!==(b=Ke(e[29].status))&&V(n,"title",b),k[0]&32&&j(n,"background-color",Ce(e[29])),k[0]&32&&j(n,"color",xe(Ce(e[29]))),k[0]&32&&v!==(v=e[29].title+"")&&Le(d,v),k[0]&32&&(m=e[29].support_list&&e[29].support_list.length||e[13](e[29])),m?N||(N=Pt(),N.c(),N.m(s,null)):N&&(N.d(1),N=null),k[0]&32&&j(C,"color",Ce(e[29]))},d(y){y&&a(t),N&&N.d(),P=!1,A()}}}function jn(i){let e=i[11](i[7],i[1],i[0])+"",t,o,n,r,h='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Pull to refresh" refreshing-spinner="circles" refreshing-text="Refreshing..."></ion-refresher-content>',f,b,O=[],I=new Map,_,s,v=Be(i[5]);const d=g=>g[29].id_event;for(let g=0;g<v.length;g+=1){let m=yt(i,v,g),T=d(m);I.set(T,O[g]=Bt(T,m))}return{c(){t=ie(e),o=w(),n=c("ion-content"),r=c("ion-refresher"),r.innerHTML=h,f=w(),b=c("ion-list");for(let g=0;g<O.length;g+=1)O[g].c();this.h()},l(g){t=re(g,e),o=L(g),n=u(g,"ION-CONTENT",{});var m=E(n);r=u(m,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),x(r)!=="svelte-1poui8g"&&(r.innerHTML=h),f=L(m),b=u(m,"ION-LIST",{});var T=E(b);for(let C=0;C<O.length;C+=1)O[C].l(T);T.forEach(a),m.forEach(a),this.h()},h(){p(r,"slot","fixed")},m(g,m){R(g,t,m),R(g,o,m),R(g,n,m),l(n,r),i[21](r),l(n,f),l(n,b);for(let T=0;T<O.length;T+=1)O[T]&&O[T].m(b,null);_||(s=$(r,"ionRefresh",i[9]),_=!0)},p(g,m){m[0]&131&&e!==(e=g[11](g[7],g[1],g[0])+"")&&Le(t,e),m[0]&74784&&(v=Be(g[5]),O=tt(O,m,d,1,g,v,I,b,nt,Bt,null,yt))},d(g){g&&(a(t),a(o),a(n)),i[21](null);for(let m=0;m<O.length;m+=1)O[m].d();_=!1,s()}}}function Vn(i){let e,t,o='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Jale para actualizar" refreshing-spinner="circles" refreshing-text="Actualizando..."></ion-refresher-content>',n,r,h=[],f=new Map,b,O,I=Be(i[5]);const _=s=>s[29].id_event;for(let s=0;s<I.length;s+=1){let v=Ct(i,I,s),d=_(v);f.set(d,h[s]=Mt(d,v))}return{c(){e=c("ion-content"),t=c("ion-refresher"),t.innerHTML=o,n=w(),r=c("ion-list");for(let s=0;s<h.length;s+=1)h[s].c();this.h()},l(s){e=u(s,"ION-CONTENT",{});var v=E(e);t=u(v,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),x(t)!=="svelte-1t1tzpj"&&(t.innerHTML=o),n=L(v),r=u(v,"ION-LIST",{});var d=E(r);for(let g=0;g<h.length;g+=1)h[g].l(d);d.forEach(a),v.forEach(a),this.h()},h(){p(t,"slot","fixed")},m(s,v){R(s,e,v),l(e,t),i[19](t),l(e,n),l(e,r);for(let d=0;d<h.length;d+=1)h[d]&&h[d].m(r,null);b||(O=$(t,"ionRefresh",i[9]),b=!0)},p(s,v){v[0]&74784&&(I=Be(s[5]),h=tt(h,v,_,1,s,I,f,r,nt,Mt,null,Ct))},d(s){s&&a(e),i[19](null);for(let v=0;v<h.length;v+=1)h[v].d();b=!1,O()}}}function St(i){let e;return{c(){e=c("span"),this.h()},l(t){e=u(t,"SPAN",{class:!0}),E(e).forEach(a),this.h()},h(){V(e,"class","notes svelte-ziybgw")},m(t,o){R(t,e,o)},d(t){t&&a(e)}}}function Bt(i,e){let t,o,n,r,h=parseInt(e[29].pos)+1+"",f,b,O,I,_,s,v=e[29].title+"",d,g,m=e[29].support_list&&e[29].support_list.length||e[13](e[29]),T,C,D="",P,A,N,B,y,k=m&&St();function S(){return e[22](e[29],e[31])}return{key:i,first:null,c(){t=c("ion-item"),o=c("ion-avatar"),n=c("div"),r=c("div"),f=ie(h),O=w(),I=c("ion-label"),_=c("ion-text"),s=c("h3"),d=ie(v),g=w(),k&&k.c(),T=w(),C=c("div"),C.innerHTML=D,P=w(),A=c("ion-icon"),N=w(),this.h()},l(q){t=u(q,"ION-ITEM",{});var H=E(t);o=u(H,"ION-AVATAR",{slot:!0});var z=E(o);n=u(z,"DIV",{class:!0,title:!0,style:!0});var W=E(n);r=u(W,"DIV",{class:!0});var ee=E(r);f=re(ee,h),ee.forEach(a),W.forEach(a),z.forEach(a),O=L(H),I=u(H,"ION-LABEL",{button:!0});var M=E(I);_=u(M,"ION-TEXT",{color:!0});var G=E(_);s=u(G,"H3",{});var F=E(s);d=re(F,v),g=L(F),k&&k.l(F),F.forEach(a),G.forEach(a),T=L(M),C=u(M,"DIV",{class:!0,"data-svelte-h":!0}),x(C)!=="svelte-130ohbs"&&(C.innerHTML=D),M.forEach(a),P=L(H),A=u(H,"ION-ICON",{icon:!0,slot:!0}),E(A).forEach(a),N=L(H),H.forEach(a),this.h()},h(){V(r,"class","order svelte-ziybgw"),V(n,"class","order-wrapper svelte-ziybgw"),V(n,"title",b=Ke(e[29].status)),j(n,"background-color",Ce(e[29])),j(n,"color",xe(Ce(e[29]))),p(o,"slot","start"),p(_,"color","#2e2e2e"),V(C,"class","sub svelte-ziybgw"),p(I,"button",""),p(A,"icon",Ye),p(A,"slot","end"),this.first=t},m(q,H){R(q,t,H),l(t,o),l(o,n),l(n,r),l(r,f),l(t,O),l(t,I),l(I,_),l(_,s),l(s,d),l(s,g),k&&k.m(s,null),l(I,T),l(I,C),l(t,P),l(t,A),l(t,N),B||(y=$(I,"click",S),B=!0)},p(q,H){e=q,H[0]&32&&h!==(h=parseInt(e[29].pos)+1+"")&&Le(f,h),H[0]&32&&b!==(b=Ke(e[29].status))&&V(n,"title",b),H[0]&32&&j(n,"background-color",Ce(e[29])),H[0]&32&&j(n,"color",xe(Ce(e[29]))),H[0]&32&&v!==(v=e[29].title+"")&&Le(d,v),H[0]&32&&(m=e[29].support_list&&e[29].support_list.length||e[13](e[29])),m?k||(k=St(),k.c(),k.m(s,null)):k&&(k.d(1),k=null)},d(q){q&&a(t),k&&k.d(),B=!1,y()}}}function Dt(i){let e;return{c(){e=c("span"),this.h()},l(t){e=u(t,"SPAN",{class:!0}),E(e).forEach(a),this.h()},h(){V(e,"class","notes svelte-ziybgw")},m(t,o){R(t,e,o)},d(t){t&&a(e)}}}function Mt(i,e){let t,o,n,r,h=parseInt(e[29].pos)+1+"",f,b,O,I,_,s,v=e[29].title+"",d,g,m=e[29].support_list&&e[29].support_list.length||e[13](e[29]),T,C,D="",P,A,N,B,y,k=m&&Dt();function S(){return e[20](e[29],e[31])}return{key:i,first:null,c(){t=c("ion-item"),o=c("ion-avatar"),n=c("div"),r=c("div"),f=ie(h),O=w(),I=c("ion-label"),_=c("ion-text"),s=c("h3"),d=ie(v),g=w(),k&&k.c(),T=w(),C=c("div"),C.innerHTML=D,P=w(),A=c("ion-icon"),N=w(),this.h()},l(q){t=u(q,"ION-ITEM",{});var H=E(t);o=u(H,"ION-AVATAR",{slot:!0});var z=E(o);n=u(z,"DIV",{class:!0,title:!0,style:!0});var W=E(n);r=u(W,"DIV",{class:!0});var ee=E(r);f=re(ee,h),ee.forEach(a),W.forEach(a),z.forEach(a),O=L(H),I=u(H,"ION-LABEL",{button:!0});var M=E(I);_=u(M,"ION-TEXT",{color:!0});var G=E(_);s=u(G,"H3",{});var F=E(s);d=re(F,v),g=L(F),k&&k.l(F),F.forEach(a),G.forEach(a),T=L(M),C=u(M,"DIV",{class:!0,"data-svelte-h":!0}),x(C)!=="svelte-130ohbs"&&(C.innerHTML=D),M.forEach(a),P=L(H),A=u(H,"ION-ICON",{icon:!0,slot:!0}),E(A).forEach(a),N=L(H),H.forEach(a),this.h()},h(){V(r,"class","order svelte-ziybgw"),V(n,"class","order-wrapper svelte-ziybgw"),V(n,"title",b=Ke(e[29].status)),j(n,"background-color",Ce(e[29])),j(n,"color",xe(Ce(e[29]))),p(o,"slot","start"),p(_,"color","#2e2e2e"),V(C,"class","sub svelte-ziybgw"),p(I,"button",""),p(A,"icon",Ye),p(A,"slot","end"),this.first=t},m(q,H){R(q,t,H),l(t,o),l(o,n),l(n,r),l(r,f),l(t,O),l(t,I),l(I,_),l(_,s),l(s,d),l(s,g),k&&k.m(s,null),l(I,T),l(I,C),l(t,P),l(t,A),l(t,N),B||(y=$(I,"click",S),B=!0)},p(q,H){e=q,H[0]&32&&h!==(h=parseInt(e[29].pos)+1+"")&&Le(f,h),H[0]&32&&b!==(b=Ke(e[29].status))&&V(n,"title",b),H[0]&32&&j(n,"background-color",Ce(e[29])),H[0]&32&&j(n,"color",xe(Ce(e[29]))),H[0]&32&&v!==(v=e[29].title+"")&&Le(d,v),H[0]&32&&(m=e[29].support_list&&e[29].support_list.length||e[13](e[29])),m?k||(k=Dt(),k.c(),k.m(s,null)):k&&(k.d(1),k=null)},d(q){q&&a(t),k&&k.d(),B=!1,y()}}}function Gn(i){let e,t,o,n,r=`<ion-icon icon="${nn}"></ion-icon>`,h,f,b,O=`<ion-icon icon="${on}"></ion-icon>`,I,_,s=i[6].name+"",v,d,g,m,T;function C(A,N){if(A[7].length>0)return Fn;if(!A[3])return zn}let D=C(i),P=D&&D(i);return{c(){e=c("ion-header"),t=c("ion-toolbar"),o=c("ion-buttons"),n=c("ion-button"),n.innerHTML=r,h=w(),f=c("ion-buttons"),b=c("ion-button"),b.innerHTML=O,I=w(),_=c("ion-title"),v=ie(s),d=w(),P&&P.c(),g=we(),this.h()},l(A){e=u(A,"ION-HEADER",{translucent:!0});var N=E(e);t=u(N,"ION-TOOLBAR",{});var B=E(t);o=u(B,"ION-BUTTONS",{slot:!0});var y=E(o);n=u(y,"ION-BUTTON",{title:!0,alt:!0,"data-svelte-h":!0}),x(n)!=="svelte-7ppz3r"&&(n.innerHTML=r),y.forEach(a),h=L(B),f=u(B,"ION-BUTTONS",{slot:!0});var k=E(f);b=u(k,"ION-BUTTON",{"data-svelte-h":!0}),x(b)!=="svelte-nf50hj"&&(b.innerHTML=O),k.forEach(a),I=L(B),_=u(B,"ION-TITLE",{});var S=E(_);v=re(S,s),S.forEach(a),B.forEach(a),N.forEach(a),d=L(A),P&&P.l(A),g=we(),this.h()},h(){p(n,"title","Atrás"),p(n,"alt","Atrás"),p(o,"slot","start"),p(f,"slot","end"),p(e,"translucent","")},m(A,N){R(A,e,N),l(e,t),l(t,o),l(o,n),l(t,h),l(t,f),l(f,b),l(t,I),l(t,_),l(_,v),R(A,d,N),P&&P.m(A,N),R(A,g,N),m||(T=[$(n,"click",i[14]),$(b,"click",i[18])],m=!0)},p(A,N){N[0]&64&&s!==(s=A[6].name+"")&&Le(v,s),D===(D=C(A))&&P?P.p(A,N):(P&&P.d(1),P=D&&D(A),P&&(P.c(),P.m(g.parentNode,g)))},d(A){A&&(a(e),a(d),a(g)),P&&P.d(A),m=!1,He(T)}}}function Kn(i){let e,t,o,n=i[2]&&wt(i);return{c(){e=w(),n&&n.c(),t=we(),this.h()},l(r){Vt("svelte-kn0kph",document.head).forEach(a),e=L(r),n&&n.l(r),t=we(),this.h()},h(){document.title="Rutaflow - Detalles de ruta"},m(r,h){R(r,e,h),n&&n.m(r,h),R(r,t,h),o=!0},p(r,h){r[2]?n?(n.p(r,h),h[0]&4&&rt(n,1)):(n=wt(r),n.c(),rt(n,1),n.m(t.parentNode,t)):n&&(Yt(),ut(n,1,1,()=>{n=null}),Kt())},i(r){o||(rt(n),o=!0)},o(r){ut(n),o=!1},d(r){r&&(a(e),a(t)),n&&n.d(r)}}}function Ce(i){let e="#ffffff";return i.status==="pending"?e="#f2e300":i.status==="completed"&&(e="#44d900"),e}function Ke(i){let e="";return i=="pending"?e="Pendiente":i=="completed"&&(e="Completado"),e}function xe(i){i.slice(0,1)==="#"&&(i=i.slice(1)),i.length===3&&(i=i.split("").map(function(r){return r+r}).join(""));const e=parseInt(i.substr(0,2),16),t=parseInt(i.substr(2,2),16),o=parseInt(i.substr(4,2),16);return(e*299+t*587+o*114)/1e3>=128?"#414040":"#fff"}function xn(i,e){let t=new FormData;return t.append("id_route",i),t.append("status",e),fetch("https://rutaflow-app-development.up.railway.app/api/admin/route/change_status.php",{method:"POST",body:t}).then(o=>o.json()).then(o=>{}).catch(o=>{console.error("Error fetching data:",o)}),""}const Wn=i=>i.img;function Xn(i,e,t){let o;Gt(i,ln,M=>t(17,o=M));var n=this&&this.__awaiter||function(M,G,F,Z){function pe(ge){return ge instanceof F?ge:new F(function(ae){ae(ge)})}return new(F||(F=Promise))(function(ge,ae){function Ee(Ie){try{_e(Z.next(Ie))}catch(ke){ae(ke)}}function Pe(Ie){try{_e(Z.throw(Ie))}catch(ke){ae(ke)}}function _e(Ie){Ie.done?ge(Ie.value):pe(Ie.value).then(Ee,Pe)}_e((Z=Z.apply(M,G||[])).next())})};let{routeId:r}=e,{driverId:h}=e,f=new Object,b=!0,O=!1,I=[],_={},s=[],v=[],d;const g=()=>n(void 0,void 0,void 0,function*(){yield m(r),d.complete()});st(()=>{g()});function m(M){return n(this,void 0,void 0,function*(){const G=new FormData;G.append("id_route",M);try{const Z=yield(yield fetch("https://rutaflow-app-development.up.railway.app/api/admin/report/seguimiento_list.php",{method:"POST",body:G})).json();t(6,_=Z.data.seguimiento_list[0]),t(5,I=Z.data.event_list),t(7,s=Z.data.checklist),v=Z.data.expenses,_&&t(4,O=_.km_inicial=="0"&&_.gas_inicial=="0"),t(3,b=!1)}catch(F){t(3,b=!1),console.error("Error fetching data:",F)}})}const T=M=>new Promise((G,F)=>{const Z=new FormData;Z.append("id_route",M.id_route),Z.append("id_event",M.id_event),fetch("https://rutaflow-app-development.up.railway.app/api/admin/evidence/evidence_by_event.php",{method:"POST",body:Z}).then(pe=>pe.json()).then(pe=>{G(pe.data.event_evidence[0])}).catch(pe=>{console.error("Error fetching data:",pe),F(pe)})}),C=(M,G)=>{T(M).then(F=>{F&&(M.img=F.img,M.driver_comments=F.driver_comments,M.comments=F.comments),Re("modal-delivery-info",Sn,{delivery:M,isLast:G}).then(Z=>{})})},D=(M,G,F)=>{var Z=!1;return Re("modal-checklist",zt,{checklist:M,driverId:G,routeId:F,isLast:Z}).then(pe=>{}),xn(F,"checklist"),""},P=M=>n(void 0,void 0,void 0,function*(){return yield m(M),v.length>0?Re("modal-expense-detail",qn,{routeId:M,expenses:v}).then(G=>{}):Re("modal-expense",dt,{routeId:M}).then(G=>{}),""}),A=M=>{if(M.tracking_type=="subscription"){if(M.subscriber_info&&M.payment_type==="cash"&&new Date(M.subscriber_info.payment_next)<new Date)return!0}else if(M.tracking_type=="ecommerce"&&Number(M.payment_pending)>0)return!0;return!1},N=()=>{f.id_driver?je(`/drivers/${f.id_driver}`):je("/drivers/me")},B=(M,G)=>n(void 0,void 0,void 0,function*(){yield(yield et.create({header:M||"Error",message:G||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()});function y(M){return M===I.length-1}const k=()=>P(r);function S(M){ye[M?"unshift":"push"](()=>{d=M,t(8,d)})}const q=(M,G)=>C(M,y(G));function H(M){ye[M?"unshift":"push"](()=>{d=M,t(8,d)})}const z=(M,G)=>C(M,y(G));function W(M){ye[M?"unshift":"push"](()=>{d=M,t(8,d)})}const ee=M=>{const G=I.findIndex(ae=>ae.id_event===M.id_event),F=G===0,Z=G>0?I[G-1]:null,pe=F||Z&&Z.img!==null,ge=M.img!==null&&M.img!=="";pe||F&&!ge?C(M):B("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")};return i.$$set=M=>{"routeId"in M&&t(0,r=M.routeId),"driverId"in M&&t(1,h=M.driverId)},i.$$.update=()=>{i.$$.dirty[0]&131077&&(t(0,{routeId:r,driverId:h}=o.params,r,(t(1,h),t(17,o),t(2,f),t(0,r))),t(2,f=JSON.parse(localStorage.getItem("userSession"))),f?f.id_user&&(f.type=="admin"||f.type=="superadmin")?(m(r),je(`/drivers/me/routes/${r}`)):f.id_user&&f.id_driver&&(m(r),je(`/drivers/${f.id_driver}/routes/${r}`)):je("/"))},[r,h,f,b,O,I,_,s,d,g,C,D,P,A,N,B,y,o,k,S,q,H,z,W,ee]}class no extends Xe{constructor(e){super(),Je(this,e,Xn,Kn,We,{routeId:0,driverId:1},null,[-1,-1])}}export{no as component};

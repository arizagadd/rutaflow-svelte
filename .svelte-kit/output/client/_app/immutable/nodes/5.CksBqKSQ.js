import{s as je,n as se,r as Ve,b as bt,l as ot,d as Te,w as Nt,o as wt}from"../chunks/index.CP94t5tW.js";import{S as We,i as Xe,e as f,s as A,q as X,c as _,r as I,g as J,f as s,k as D,u as G,v as N,b as U,A as V,d as q,w as i,x as Z,h as oe,F as Tt,G as Ct,y as ie,H as yt,j as Lt,t as Ae,a as Fe,l as At,m as Dt,n as St,o as Ht,p as Bt,z as Mt}from"../chunks/index.BB8175xn.js";import{a as Pt,c as Rt,b as qt,p as gt,i as Et,f as Ut,g as Ft,s as Ge,h as Ne,e as pe,u as De,d as Se,j as zt}from"../chunks/index.BoAjZG4g.js";import{g as Ie}from"../chunks/entry.CBKaAQVc.js";import{a as It,m as jt,I as Vt}from"../chunks/IonPage.bGG8reFV.js";import"../chunks/index-48209844.IIRtDZyg.js";import{q as Wt,t as Xt}from"../chunks/ion-modal.CsJaVgKZ.js";function Gt(r){let e,t,o,n,l,h="Domicilio 2",b,g,k=r[2].line2+"",E,p,a;return{c(){e=f("ion-item"),t=f("ion-icon"),o=A(),n=f("ion-label"),l=f("p"),l.textContent=h,b=A(),g=f("h2"),E=X(k),p=A(),a=f("ion-icon"),this.h()},l(m){e=_(m,"ION-ITEM",{href:!0});var v=I(e);t=_(v,"ION-ICON",{icon:!0,slot:!0}),I(t).forEach(s),o=D(v),n=_(v,"ION-LABEL",{class:!0});var u=I(n);l=_(u,"P",{"data-svelte-h":!0}),J(l)!=="svelte-1qy148r"&&(l.textContent=h),b=D(u),g=_(u,"H2",{});var c=I(g);E=G(c,k),c.forEach(s),u.forEach(s),p=D(v),a=_(v,"ION-ICON",{icon:!0,slot:!0}),I(a).forEach(s),v.forEach(s),this.h()},h(){N(t,"icon",Ge),N(t,"slot","start"),N(n,"class","ion-text-wrap"),N(a,"icon",Ne),N(a,"slot","end"),N(e,"href","https://www.google.com/maps/searhc/?api=1&query="+r[2].line2)},m(m,v){q(m,e,v),i(e,t),i(e,o),i(e,n),i(n,l),i(n,b),i(n,g),i(g,E),i(e,p),i(e,a)},p:se,d(m){m&&s(e)}}}function Jt(r){let e,t,o,n,l,h="Domicilio 1",b,g,k=r[2].line1+"",E,p,a,m,v=r[2].line2&&r[2].line2.trim().length,u,c=v&&Kt(r);return{c(){e=f("ion-item"),t=f("ion-icon"),o=A(),n=f("ion-label"),l=f("p"),l.textContent=h,b=A(),g=f("h2"),E=X(k),p=A(),a=f("ion-icon"),m=A(),c&&c.c(),u=oe(),this.h()},l(y){e=_(y,"ION-ITEM",{href:!0});var C=I(e);t=_(C,"ION-ICON",{icon:!0,slot:!0}),I(t).forEach(s),o=D(C),n=_(C,"ION-LABEL",{class:!0});var M=I(n);l=_(M,"P",{"data-svelte-h":!0}),J(l)!=="svelte-1ehcrdm"&&(l.textContent=h),b=D(M),g=_(M,"H2",{});var P=I(g);E=G(P,k),P.forEach(s),M.forEach(s),p=D(C),a=_(C,"ION-ICON",{icon:!0,slot:!0}),I(a).forEach(s),C.forEach(s),m=D(y),c&&c.l(y),u=oe(),this.h()},h(){N(t,"icon",Ge),N(t,"slot","start"),N(n,"class","ion-text-wrap"),N(a,"icon",Ne),N(a,"slot","end"),N(e,"href","https://www.google.com/maps/search/?api=1&query="+r[2].line1)},m(y,C){q(y,e,C),i(e,t),i(e,o),i(e,n),i(n,l),i(n,b),i(n,g),i(g,E),i(e,p),i(e,a),q(y,m,C),c&&c.m(y,C),q(y,u,C)},p(y,C){v&&c.p(y,C)},d(y){y&&(s(e),s(m),s(u)),c&&c.d(y)}}}function Kt(r){let e,t,o,n,l,h="Domicilio 2",b,g,k=r[2].line2+"",E,p,a;return{c(){e=f("ion-item"),t=f("ion-icon"),o=A(),n=f("ion-label"),l=f("p"),l.textContent=h,b=A(),g=f("h2"),E=X(k),p=A(),a=f("ion-icon"),this.h()},l(m){e=_(m,"ION-ITEM",{href:!0});var v=I(e);t=_(v,"ION-ICON",{icon:!0,slot:!0}),I(t).forEach(s),o=D(v),n=_(v,"ION-LABEL",{class:!0});var u=I(n);l=_(u,"P",{"data-svelte-h":!0}),J(l)!=="svelte-1qy148r"&&(l.textContent=h),b=D(u),g=_(u,"H2",{});var c=I(g);E=G(c,k),c.forEach(s),u.forEach(s),p=D(v),a=_(v,"ION-ICON",{icon:!0,slot:!0}),I(a).forEach(s),v.forEach(s),this.h()},h(){N(t,"icon",Ge),N(t,"slot","start"),N(n,"class","ion-text-wrap"),N(a,"icon",Ne),N(a,"slot","end"),N(e,"href","https://www.google.com/maps/search/?api=1&query="+r[2].line2)},m(m,v){q(m,e,v),i(e,t),i(e,o),i(e,n),i(n,l),i(n,b),i(n,g),i(g,E),i(e,p),i(e,a)},p:se,d(m){m&&s(e)}}}function Qt(r){let e,t=r[2].comments!="<br>"&&Yt(r);return{c(){t&&t.c(),e=oe()},l(o){t&&t.l(o),e=oe()},m(o,n){t&&t.m(o,n),q(o,e,n)},p(o,n){o[2].comments!="<br>"&&t.p(o,n)},d(o){o&&s(e),t&&t.d(o)}}}function Yt(r){let e,t,o,n,l,h="Notas de ubicación",b,g,k=r[2].comments+"",E;return{c(){e=f("ion-item"),t=f("ion-icon"),o=A(),n=f("ion-label"),l=f("p"),l.textContent=h,b=A(),g=f("h2"),E=X(k),this.h()},l(p){e=_(p,"ION-ITEM",{});var a=I(e);t=_(a,"ION-ICON",{icon:!0,slot:!0}),I(t).forEach(s),o=D(a),n=_(a,"ION-LABEL",{class:!0});var m=I(n);l=_(m,"P",{"data-svelte-h":!0}),J(l)!=="svelte-nhm2ft"&&(l.textContent=h),b=D(m),g=_(m,"H2",{});var v=I(g);E=G(v,k),v.forEach(s),m.forEach(s),a.forEach(s),this.h()},h(){N(t,"icon",Et),N(t,"slot","start"),N(n,"class","ion-text-wrap")},m(p,a){q(p,e,a),i(e,t),i(e,o),i(e,n),i(n,l),i(n,b),i(n,g),i(g,E)},p:se,d(p){p&&s(e)}}}function Zt(r){let e,t,o,n,l,h="Horarios",b,g,k=r[2].schedule+"",E;return{c(){e=f("ion-item"),t=f("ion-icon"),o=A(),n=f("ion-label"),l=f("p"),l.textContent=h,b=A(),g=f("h2"),E=X(k),this.h()},l(p){e=_(p,"ION-ITEM",{});var a=I(e);t=_(a,"ION-ICON",{icon:!0,slot:!0}),I(t).forEach(s),o=D(a),n=_(a,"ION-LABEL",{});var m=I(n);l=_(m,"P",{"data-svelte-h":!0}),J(l)!=="svelte-11q7hm5"&&(l.textContent=h),b=D(m),g=_(m,"H2",{});var v=I(g);E=G(v,k),v.forEach(s),m.forEach(s),a.forEach(s),this.h()},h(){N(t,"icon",Ut),N(t,"slot","start")},m(p,a){q(p,e,a),i(e,t),i(e,o),i(e,n),i(n,l),i(n,b),i(n,g),i(g,E)},p:se,d(p){p&&s(e)}}}function $t(r){let e,t,o,n,l,h="Notas del operador",b,g,k=r[2].driver_comments+"",E;return{c(){e=f("ion-item"),t=f("ion-icon"),o=A(),n=f("ion-label"),l=f("p"),l.textContent=h,b=A(),g=f("h2"),E=X(k),this.h()},l(p){e=_(p,"ION-ITEM",{});var a=I(e);t=_(a,"ION-ICON",{icon:!0,slot:!0}),I(t).forEach(s),o=D(a),n=_(a,"ION-LABEL",{});var m=I(n);l=_(m,"P",{"data-svelte-h":!0}),J(l)!=="svelte-1yk9qp4"&&(l.textContent=h),b=D(m),g=_(m,"H2",{});var v=I(g);E=G(v,k),v.forEach(s),m.forEach(s),a.forEach(s),this.h()},h(){N(t,"icon",Ft),N(t,"slot","start")},m(p,a){q(p,e,a),i(e,t),i(e,o),i(e,n),i(n,l),i(n,b),i(n,g),i(g,E)},p:se,d(p){p&&s(e)}}}function xt(r){let e,t=r[2].logistic_comments!="<br>"&&en(r);return{c(){t&&t.c(),e=oe()},l(o){t&&t.l(o),e=oe()},m(o,n){t&&t.m(o,n),q(o,e,n)},p(o,n){o[2].logistic_comments!="<br>"&&t.p(o,n)},d(o){o&&s(e),t&&t.d(o)}}}function en(r){let e,t,o,n,l,h="Comentarios logísticos",b,g,k=r[2].logistic_comments+"",E;return{c(){e=f("ion-item"),t=f("ion-icon"),o=A(),n=f("ion-label"),l=f("p"),l.textContent=h,b=A(),g=f("h2"),E=X(k),this.h()},l(p){e=_(p,"ION-ITEM",{});var a=I(e);t=_(a,"ION-ICON",{icon:!0,slot:!0}),I(t).forEach(s),o=D(a),n=_(a,"ION-LABEL",{class:!0});var m=I(n);l=_(m,"P",{"data-svelte-h":!0}),J(l)!=="svelte-1iz85r6"&&(l.textContent=h),b=D(m),g=_(m,"H2",{});var v=I(g);E=G(v,k),v.forEach(s),m.forEach(s),a.forEach(s),this.h()},h(){N(t,"icon",Et),N(t,"slot","start"),N(n,"class","ion-text-wrap")},m(p,a){q(p,e,a),i(e,t),i(e,o),i(e,n),i(n,l),i(n,b),i(n,g),i(g,E)},p:se,d(p){p&&s(e)}}}function it(r){let e,t,o;return{c(){e=f("section"),t=f("ion-img"),this.h()},l(n){e=_(n,"SECTION",{});var l=I(e);t=_(l,"ION-IMG",{src:!0,alt:!0,style:!0}),I(t).forEach(s),l.forEach(s),this.h()},h(){ot(t.src,o=r[1])||N(t,"src",o),N(t,"alt","Evidencia fotográfica"),V(t,"max-width","100%"),V(t,"margin-top","16px")},m(n,l){q(n,e,l),i(e,t)},p(n,l){l&2&&!ot(t.src,o=n[1])&&N(t,"src",o)},d(n){n&&s(e)}}}function tn(r){let e,t,o,n,l="Cancelar",h,b,g=r[2].title+"",k,E,p,a,m="Confirmar",v,u,c,y,C,M,P,B,d="Cliente",L,S,T=r[2].client_name+"",O,H,w,R=r[2].comments&&r[2].comments.trim().length,F,z=r[2].schedule&&r[2].schedule.trim().length,j,te,$=r[2].logistic_comments&&r[2].logistic_comments.trim().length,me,Y,le,He,ve,Be,we,he,ne,be,Me,de,Je="Subir Evidencia",Pe,ae,Re,qe,Ke;function Ot(W,x){if(W[2].line1&&W[2].line1.trim().length)return Jt;if(W[2].line2&&W[2].line2.trim().length)return Gt}let Qe=Ot(r),re=Qe&&Qe(r),ce=R&&Qt(r),ue=z&&Zt(r),fe=r[2].driver_comments&&$t(r),_e=$&&xt(r),Q=r[1]&&it(r);return{c(){e=f("ion-header"),t=f("ion-toolbar"),o=f("ion-buttons"),n=f("ion-button"),n.textContent=l,h=A(),b=f("ion-title"),k=X(g),E=A(),p=f("ion-buttons"),a=f("ion-button"),a.textContent=m,v=A(),u=f("ion-content"),c=f("ion-list"),y=f("ion-item"),C=f("ion-icon"),M=A(),P=f("ion-label"),B=f("p"),B.textContent=d,L=A(),S=f("h2"),O=X(T),H=A(),re&&re.c(),w=A(),ce&&ce.c(),F=A(),ue&&ue.c(),j=A(),fe&&fe.c(),te=A(),_e&&_e.c(),me=A(),Y=f("ion-item"),le=f("ion-icon"),He=A(),ve=f("ion-textarea"),Be=A(),we=f("section"),he=f("label"),ne=f("ion-button"),be=f("ion-icon"),Me=A(),de=f("label"),de.textContent=Je,Pe=A(),ae=f("input"),Re=A(),Q&&Q.c(),this.h()},l(W){e=_(W,"ION-HEADER",{translucent:!0});var x=I(e);t=_(x,"ION-TOOLBAR",{});var ge=I(t);o=_(ge,"ION-BUTTONS",{slot:!0});var Ye=I(o);n=_(Ye,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),J(n)!=="svelte-1dnmkxs"&&(n.textContent=l),Ye.forEach(s),h=D(ge),b=_(ge,"ION-TITLE",{title:!0});var Ze=I(b);k=G(Ze,g),Ze.forEach(s),E=D(ge),p=_(ge,"ION-BUTTONS",{slot:!0});var $e=I(p);a=_($e,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),J(a)!=="svelte-1ida0il"&&(a.textContent=m),$e.forEach(s),ge.forEach(s),x.forEach(s),v=D(W),u=_(W,"ION-CONTENT",{fullscreen:!0});var xe=I(u);c=_(xe,"ION-LIST",{});var K=I(c);y=_(K,"ION-ITEM",{});var Ce=I(y);C=_(Ce,"ION-ICON",{icon:!0,slot:!0}),I(C).forEach(s),M=D(Ce),P=_(Ce,"ION-LABEL",{});var ye=I(P);B=_(ye,"P",{"data-svelte-h":!0}),J(B)!=="svelte-jrq7ei"&&(B.textContent=d),L=D(ye),S=_(ye,"H2",{});var et=I(S);O=G(et,T),et.forEach(s),ye.forEach(s),Ce.forEach(s),H=D(K),re&&re.l(K),w=D(K),ce&&ce.l(K),F=D(K),ue&&ue.l(K),j=D(K),fe&&fe.l(K),te=D(K),_e&&_e.l(K),me=D(K),Y=_(K,"ION-ITEM",{});var Le=I(Y);le=_(Le,"ION-ICON",{icon:!0,slot:!0}),I(le).forEach(s),He=D(Le),ve=_(Le,"ION-TEXTAREA",{label:!0,placeholder:!0}),I(ve).forEach(s),Le.forEach(s),Be=D(K),we=_(K,"SECTION",{});var tt=I(we);he=_(tt,"LABEL",{for:!0,style:!0});var nt=I(he);ne=_(nt,"ION-BUTTON",{fill:!0,class:!0,expand:!0});var Ee=I(ne);be=_(Ee,"ION-ICON",{icon:!0,slot:!0}),I(be).forEach(s),Me=D(Ee),de=_(Ee,"LABEL",{for:!0,style:!0,"data-svelte-h":!0}),J(de)!=="svelte-1as0od8"&&(de.textContent=Je),Pe=D(Ee),ae=_(Ee,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0}),Ee.forEach(s),nt.forEach(s),tt.forEach(s),Re=D(K),Q&&Q.l(K),K.forEach(s),xe.forEach(s),this.h()},h(){N(n,"color","medium"),N(o,"slot","start"),N(b,"title",r[2].title),N(a,"strong",""),N(p,"slot","end"),N(e,"translucent",""),N(C,"icon",Pt),N(C,"slot","start"),N(le,"icon",Rt),N(le,"slot","start"),N(ve,"label","Notas"),N(ve,"placeholder","Escribe aquí..."),N(be,"icon",qt),N(be,"slot","start"),U(de,"for","eventEvidence"),V(de,"padding","8px 10px"),V(ae,"display","none"),U(ae,"id","eventEvidence"),U(ae,"name","fileToUpload"),U(ae,"type","file"),U(ae,"accept","image/*"),N(ne,"fill","outline"),N(ne,"class","loadEvidence"),N(ne,"expand","block"),U(he,"for","eventEvidence"),V(he,"display","block"),V(he,"width","100%"),N(u,"fullscreen","")},m(W,x){q(W,e,x),i(e,t),i(t,o),i(o,n),i(t,h),i(t,b),i(b,k),i(t,E),i(t,p),i(p,a),q(W,v,x),q(W,u,x),i(u,c),i(c,y),i(y,C),i(y,M),i(y,P),i(P,B),i(P,L),i(P,S),i(S,O),i(c,H),re&&re.m(c,null),i(c,w),ce&&ce.m(c,null),i(c,F),ue&&ue.m(c,null),i(c,j),fe&&fe.m(c,null),i(c,te),_e&&_e.m(c,null),i(c,me),i(c,Y),i(Y,le),i(Y,He),i(Y,ve),r[7](ve),i(c,Be),i(c,we),i(we,he),i(he,ne),i(ne,be),i(ne,Me),i(ne,de),i(ne,Pe),i(ne,ae),i(c,Re),Q&&Q.m(c,null),qe||(Ke=[Z(n,"click",r[4]),Z(a,"click",r[5]),Z(ae,"change",r[3])],qe=!0)},p(W,[x]){re&&re.p(W,x),R&&ce.p(W,x),z&&ue.p(W,x),W[2].driver_comments&&fe.p(W,x),$&&_e.p(W,x),W[1]?Q?Q.p(W,x):(Q=it(W),Q.c(),Q.m(c,null)):Q&&(Q.d(1),Q=null)},i:se,o:se,d(W){W&&(s(e),s(v),s(u)),re&&re.d(),ce&&ce.d(),ue&&ue.d(),fe&&fe.d(),_e&&_e.d(),r[7](null),Q&&Q.d(),qe=!1,Ve(Ke)}}}function nn(r,e,t){let o;bt(r,gt,v=>t(6,o=v));let n=document.querySelector("ion-modal"),l=n.componentProps.delivery,h=l.driver_comments?l.driver_comments:"",b=l.img?l.img:"",g="";const k=async v=>{const c=v.target.files[0],y=await E(c);if(y){const C=new FormData;C.append("fileToUpload",y);try{const M=await fetch("https://rutaflow-app-production.up.railway.app/api/admin/manager/upload_img_driver.php",{method:"POST",body:C});if(M.ok){const P=await M.json();t(1,b=P.img),g=P.img_id}else console.error("File upload failed:",M.statusText)}catch(M){console.error("Error during file upload:",M)}}},E=async v=>new Promise(u=>{const c=new FileReader;c.onload=y=>{const C=new Image;C.src=y.target.result,C.onload=()=>{const M=document.createElement("canvas"),P=M.getContext("2d"),B=800,d=600;let L=C.width,S=C.height;L>B&&(S*=B/L,L=B),S>d&&(L*=d/S,S=d),M.width=L,M.height=S,P.drawImage(C,0,0,L,S),M.toBlob(T=>{u(T)},"image/jpeg",.7)}},c.readAsDataURL(v)}),p=()=>{n.dismiss({data:Date.now()})},a=()=>{var v=new Object;v.id_route=l.id_route,v.id_event=l.id_event,v.comments=h.value,v.img=b,v.img_id=g;const u=new FormData;for(const c in v)u.append(c,v[c]);fetch("https://rutaflow-app-production.up.railway.app/api/admin/evidence/send_evidence.php",{method:"POST",body:u}).then(c=>c.json()).then(c=>{p()}).catch(c=>{console.error("Error fetching data:",c)})};function m(v){Te[v?"unshift":"push"](()=>{h=v,t(0,h)})}return r.$$.update=()=>{r.$$.dirty&64&&o.params},[h,b,l,k,p,a,o,m]}class on extends We{constructor(e){super(),Xe(this,e,nn,tn,je,{})}}const Ue=Nt({items:[],checkedIndices:[]});function lt(r,e,t){const o=r.slice();return o[19]=e[t],o}function rt(r,e){let t,o,n,l,h,b=e[19].item+"",g,k,E,p,a=(e[2][e[19].id_checklist_event]?e[2][e[19].id_checklist_event]:"Cargar evidencia")+"",m,v,u,c,y,C,M;function P(){return e[10](e[19])}function B(...d){return e[12](e[19],...d)}return y=Tt(e[9][0]),{key:r,first:null,c(){t=f("ion-item"),o=f("ion-label"),n=f("input"),l=A(),h=f("p"),g=X(b),k=A(),E=f("ion-button"),p=f("label"),m=X(a),v=A(),u=f("input"),c=A(),this.h()},l(d){t=_(d,"ION-ITEM",{});var L=I(t);o=_(L,"ION-LABEL",{style:!0});var S=I(o);n=_(S,"INPUT",{id:!0,style:!0,type:!0}),l=D(S),h=_(S,"P",{style:!0});var T=I(h);g=G(T,b),T.forEach(s),S.forEach(s),k=D(L),E=_(L,"ION-BUTTON",{fill:!0,class:!0});var O=I(E);p=_(O,"LABEL",{for:!0,style:!0});var H=I(p);m=G(H,a),H.forEach(s),v=D(O),u=_(O,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0}),O.forEach(s),c=D(L),L.forEach(s),this.h()},h(){U(n,"id",`chkbox-${e[19].id_checklist_event}`),V(n,"pointer-events","auto"),U(n,"type","checkbox"),n.__value=e[19].id_checklist_event,Ct(n,n.__value),n.required=!0,V(h,"margin-left","10px"),V(o,"display","flex"),U(p,"for","chklist-"+e[19].id_checklist_event),V(p,"padding","8px 10px"),V(u,"display","none"),U(u,"id","chklist-"+e[19].id_checklist_event),U(u,"name","fileToUpload"),U(u,"type","file"),U(u,"accept","image/*"),N(E,"fill","outline"),N(E,"class","loadEvidence svelte-4jkdim"),y.p(n),this.first=t},m(d,L){q(d,t,L),i(t,o),i(o,n),n.checked=~(e[0]||[]).indexOf(n.__value),i(o,l),i(o,h),i(h,g),i(t,k),i(t,E),i(E,p),i(p,m),i(E,v),i(E,u),e[11](u),i(t,c),C||(M=[Z(n,"change",e[8]),Z(n,"change",P),Z(u,"change",B)],C=!0)},p(d,L){e=d,L&1&&(n.checked=~(e[0]||[]).indexOf(n.__value)),L&4&&a!==(a=(e[2][e[19].id_checklist_event]?e[2][e[19].id_checklist_event]:"Cargar evidencia")+"")&&ie(m,a)},d(d){d&&s(t),e[11](null),y.r(),C=!1,Ve(M)}}}function ln(r){let e,t,o,n,l="Cancelar",h,b,g="Requerimientos de ruta",k,E,p,a="Confirmar",m,v,u,c=[],y=new Map,C,M,P=pe(r[3]);const B=d=>d[19].id_checklist_event;for(let d=0;d<P.length;d+=1){let L=lt(r,P,d),S=B(L);y.set(S,c[d]=rt(S,L))}return{c(){e=f("ion-header"),t=f("ion-toolbar"),o=f("ion-buttons"),n=f("ion-button"),n.textContent=l,h=A(),b=f("ion-title"),b.textContent=g,k=A(),E=f("ion-buttons"),p=f("ion-button"),p.textContent=a,m=A(),v=f("ion-content"),u=f("ion-list");for(let d=0;d<c.length;d+=1)c[d].c();this.h()},l(d){e=_(d,"ION-HEADER",{translucent:!0});var L=I(e);t=_(L,"ION-TOOLBAR",{});var S=I(t);o=_(S,"ION-BUTTONS",{slot:!0});var T=I(o);n=_(T,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),J(n)!=="svelte-1dnmkxs"&&(n.textContent=l),T.forEach(s),h=D(S),b=_(S,"ION-TITLE",{"data-svelte-h":!0}),J(b)!=="svelte-ucox25"&&(b.textContent=g),k=D(S),E=_(S,"ION-BUTTONS",{slot:!0});var O=I(E);p=_(O,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),J(p)!=="svelte-1ida0il"&&(p.textContent=a),O.forEach(s),S.forEach(s),L.forEach(s),m=D(d),v=_(d,"ION-CONTENT",{fullscreen:!0});var H=I(v);u=_(H,"ION-LIST",{});var w=I(u);for(let R=0;R<c.length;R+=1)c[R].l(w);w.forEach(s),H.forEach(s),this.h()},h(){N(n,"color","medium"),N(o,"slot","start"),N(p,"strong",""),N(E,"slot","end"),N(e,"translucent",""),N(v,"fullscreen","")},m(d,L){q(d,e,L),i(e,t),i(t,o),i(o,n),i(t,h),i(t,b),i(t,k),i(t,E),i(E,p),q(d,m,L),q(d,v,L),i(v,u);for(let S=0;S<c.length;S+=1)c[S]&&c[S].m(u,null);C||(M=[Z(n,"click",r[4]),Z(p,"click",r[5])],C=!0)},p(d,[L]){L&207&&(P=pe(d[3]),c=De(c,L,B,1,d,P,y,u,Se,rt,null,lt))},i:se,o:se,d(d){d&&(s(e),s(m),s(v));for(let L=0;L<c.length;L+=1)c[L].d();C=!1,Ve(M)}}}function kt(r){return typeof r=="object"&&r!==null||Array.isArray(r)?Array.isArray(r)?r.map(e=>kt(e)).flat():Object.keys(r).filter(n=>n.toLowerCase().includes("id_checklist_event")).map(n=>r[n]):(console.error("Invalid input. Please provide a valid object or array."),[])}function rn(r,e){let t=new FormData;t.append("id_route",r),t.append("status",e),fetch("https://rutaflow-app-production.up.railway.app/api/admin/route/change_status.php",{method:"POST",body:t}).then(o=>o.json()).then(o=>{}).catch(o=>{console.error("Error fetching data:",o)})}function sn(r,e,t){let o=document.querySelector("ion-modal");const n=o.componentProps.checklist,l=o.componentProps.driverId,h=o.componentProps.routeId;let b=[],g=null,k={},E={};wt(()=>{Ue.update(d=>(d.items=kt(n),d))});const p=async()=>{await(await It.create({header:"Datos o checklist incompletos",message:"Carga la evidencia requerida y marca todas las casillas para confirmar",buttons:[{text:"Cerrar"}]})).present()},a=()=>{o.dismiss({data:Date.now()}),Ie(`/drivers/${l}`)},m=()=>{Ue.update(d=>{if(d.items.every(T=>d.checkedIndices.includes(T))){a();const T=new FormData;for(const O in k)if(k.hasOwnProperty(O)){const{img:H,img_id:w}=k[O];T.append(`selectedImages[${O}][img]`,H),T.append(`selectedImages[${O}][img_id]`,w)}fetch("https://rutaflow-app-production.up.railway.app/api/admin/checklist/add_evidence.php",{method:"POST",body:T}).then(O=>O.json()).then(O=>{rn(h,"enroute")}).catch(O=>{console.error("Error fetching data:",O)})}else p();return d})},v=async(d,L)=>{const T=d.target.files[0],O=await u(T);if(O){const H=new FormData;H.append("fileToUpload",O);try{const w=await fetch("https://rutaflow-app-production.up.railway.app/api/admin/manager/upload_img_driver.php",{method:"POST",body:H});if(w.ok){const R=await w.json();k={...k,[L]:{img:R.img,img_id:R.img_id}},t(2,E={...E,[L]:R.filename})}else console.error("File upload failed:",w.statusText)}catch(w){console.error("Error during file upload:",w)}}},u=async d=>new Promise(L=>{const S=new FileReader;S.onload=T=>{const O=new Image;O.src=T.target.result,O.onload=()=>{const H=document.createElement("canvas"),w=H.getContext("2d"),R=800,F=600;let z=O.width,j=O.height;z>R&&(j*=R/z,z=R),j>F&&(z*=F/j,j=F),H.width=z,H.height=j,w.drawImage(O,0,0,z,j),H.toBlob(te=>{L(te)},"image/jpeg",.7)}},S.readAsDataURL(d)}),c=d=>{Ue.update(L=>(L.checkedIndices.indexOf(d)===-1?L.checkedIndices.push(d):console.error(`ID ${d} is already checked.`),L.items.forEach(T=>{T.id_checklist_event===d&&(T.checked=!0)}),L))},y=[[]];function C(){b=yt(y[0],this.__value,this.checked),t(0,b)}const M=d=>c(d.id_checklist_event);function P(d){Te[d?"unshift":"push"](()=>{g=d,t(1,g)})}return[b,g,E,n,a,m,v,c,C,y,M,P,(d,L)=>v(L,d.id_checklist_event)]}class an extends We{constructor(e){super(),Xe(this,e,sn,ln,je,{})}}const cn=(r,e)=>{if(!customElements.get(r)){class t extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const n={};for(const l of this.attributes)n[l.name]=l.value;new e({target:this.shadowRoot,props:n})}}customElements.define(r,t)}},un=function(r){return document.createElement(r).constructor!==HTMLElement},fn=(r,e)=>{un(r)||cn(r,e)},st=async(r,e,t)=>{Wt(),Xt(),fn(r,e);const o=await jt.create({component:r,componentProps:t});return o.present(),await o.onWillDismiss()};function at(r,e,t){const o=r.slice();return o[25]=e[t],o}function ct(r,e,t){const o=r.slice();return o[25]=e[t],o}function ut(r,e,t){const o=r.slice();return o[25]=e[t],o}function ft(r){let e,t;return e=new Vt({props:{$$slots:{default:[mn]},$$scope:{ctx:r}}}),{c(){Dt(e.$$.fragment)},l(o){St(e.$$.fragment,o)},m(o,n){Ht(e,o,n),t=!0},p(o,n){const l={};n[0]&127|n[1]&2&&(l.$$scope={dirty:n,ctx:o}),e.$set(l)},i(o){t||(Ae(e.$$.fragment,o),t=!0)},o(o){Fe(e.$$.fragment,o),t=!1},d(o){Bt(e,o)}}}function _n(r){let e=ze(r[0],"enroute")+"",t,o,n,l,h='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Jala para actualizar" refreshing-spinner="circles" refreshing-text="Actualizando..."></ion-refresher-content>',b,g,k=[],E=new Map,p,a,m=pe(r[3]);const v=u=>u[25].id_event;for(let u=0;u<m.length;u+=1){let c=at(r,m,u),y=v(c);E.set(y,k[u]=ht(y,c))}return{c(){t=X(e),o=A(),n=f("ion-content"),l=f("ion-refresher"),l.innerHTML=h,b=A(),g=f("ion-list");for(let u=0;u<k.length;u+=1)k[u].c();this.h()},l(u){t=G(u,e),o=D(u),n=_(u,"ION-CONTENT",{});var c=I(n);l=_(c,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),J(l)!=="svelte-1jkndk3"&&(l.innerHTML=h),b=D(c),g=_(c,"ION-LIST",{});var y=I(g);for(let C=0;C<k.length;C+=1)k[C].l(y);y.forEach(s),c.forEach(s),this.h()},h(){N(l,"slot","fixed")},m(u,c){q(u,t,c),q(u,o,c),q(u,n,c),i(n,l),r[18](l),i(n,b),i(n,g);for(let y=0;y<k.length;y+=1)k[y]&&k[y].m(g,null);p||(a=Z(l,"ionRefresh",r[7]),p=!0)},p(u,c){c[0]&1&&e!==(e=ze(u[0],"enroute")+"")&&ie(t,e),c[0]&5384&&(m=pe(u[3]),k=De(k,c,v,1,u,m,E,g,Se,ht,null,at))},d(u){u&&(s(t),s(o),s(n)),r[18](null);for(let c=0;c<k.length;c+=1)k[c].d();p=!1,a()}}}function hn(r){let e,t;function o(h,b){return b[0]&32&&(e=null),e==null&&(e=!!h[5].every(bn)),e?pn:dn}let n=o(r,[-1,-1]),l=n(r);return{c(){l.c(),t=oe()},l(h){l.l(h),t=oe()},m(h,b){l.m(h,b),q(h,t,b)},p(h,b){n===(n=o(h,b))&&l?l.p(h,b):(l.d(1),l=n(h),l&&(l.c(),l.m(t.parentNode,t)))},d(h){h&&s(t),l.d(h)}}}function _t(r){let e;return{c(){e=f("span"),this.h()},l(t){e=_(t,"SPAN",{class:!0}),I(e).forEach(s),this.h()},h(){U(e,"class","notes svelte-ziybgw")},m(t,o){q(t,e,o)},d(t){t&&s(e)}}}function ht(r,e){let t,o,n,l,h=parseInt(e[25].pos)+1+"",b,g,k,E,p,a,m=e[25].title+"",v,u,c=e[25].support_list&&e[25].support_list.length||e[10](e[25]),y,C,M,P,B,d=c&&_t();function L(){return e[19](e[25])}return{key:r,first:null,c(){t=f("ion-item"),o=f("ion-avatar"),n=f("div"),l=f("div"),b=X(h),k=A(),E=f("ion-label"),p=f("ion-text"),a=f("h3"),v=X(m),u=A(),d&&d.c(),y=A(),C=f("ion-icon"),M=A(),this.h()},l(S){t=_(S,"ION-ITEM",{});var T=I(t);o=_(T,"ION-AVATAR",{slot:!0});var O=I(o);n=_(O,"DIV",{class:!0,title:!0,style:!0});var H=I(n);l=_(H,"DIV",{class:!0});var w=I(l);b=G(w,h),w.forEach(s),H.forEach(s),O.forEach(s),k=D(T),E=_(T,"ION-LABEL",{button:!0});var R=I(E);p=_(R,"ION-TEXT",{color:!0});var F=I(p);a=_(F,"H3",{});var z=I(a);v=G(z,m),u=D(z),d&&d.l(z),z.forEach(s),F.forEach(s),R.forEach(s),y=D(T),C=_(T,"ION-ICON",{icon:!0,slot:!0,style:!0}),I(C).forEach(s),M=D(T),T.forEach(s),this.h()},h(){U(l,"class","order svelte-ziybgw"),U(n,"class","order-wrapper svelte-ziybgw"),U(n,"title",g=ke(e[25].status)),V(n,"background-color",ee(e[25])),V(n,"color",Oe(ee(e[25]))),N(o,"slot","start"),N(p,"color","#2e2e2e"),N(E,"button",""),N(C,"icon",Ne),N(C,"slot","end"),V(C,"color",ee(e[25])),this.first=t},m(S,T){q(S,t,T),i(t,o),i(o,n),i(n,l),i(l,b),i(t,k),i(t,E),i(E,p),i(p,a),i(a,v),i(a,u),d&&d.m(a,null),i(t,y),i(t,C),i(t,M),P||(B=Z(E,"click",L),P=!0)},p(S,T){e=S,T[0]&8&&h!==(h=parseInt(e[25].pos)+1+"")&&ie(b,h),T[0]&8&&g!==(g=ke(e[25].status))&&U(n,"title",g),T[0]&8&&V(n,"background-color",ee(e[25])),T[0]&8&&V(n,"color",Oe(ee(e[25]))),T[0]&8&&m!==(m=e[25].title+"")&&ie(v,m),T[0]&8&&(c=e[25].support_list&&e[25].support_list.length||e[10](e[25])),c?d||(d=_t(),d.c(),d.m(a,null)):d&&(d.d(1),d=null),T[0]&8&&V(C,"color",ee(e[25]))},d(S){S&&s(t),d&&d.d(),P=!1,B()}}}function dn(r){let e=r[9](r[5],r[1],r[0])+"",t,o,n,l,h='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Pull to refresh" refreshing-spinner="circles" refreshing-text="Refreshing..."></ion-refresher-content>',b,g,k=[],E=new Map,p,a,m=pe(r[3]);const v=u=>u[25].id_event;for(let u=0;u<m.length;u+=1){let c=ct(r,m,u),y=v(c);E.set(y,k[u]=pt(y,c))}return{c(){t=X(e),o=A(),n=f("ion-content"),l=f("ion-refresher"),l.innerHTML=h,b=A(),g=f("ion-list");for(let u=0;u<k.length;u+=1)k[u].c();this.h()},l(u){t=G(u,e),o=D(u),n=_(u,"ION-CONTENT",{});var c=I(n);l=_(c,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),J(l)!=="svelte-1poui8g"&&(l.innerHTML=h),b=D(c),g=_(c,"ION-LIST",{});var y=I(g);for(let C=0;C<k.length;C+=1)k[C].l(y);y.forEach(s),c.forEach(s),this.h()},h(){N(l,"slot","fixed")},m(u,c){q(u,t,c),q(u,o,c),q(u,n,c),i(n,l),r[16](l),i(n,b),i(n,g);for(let y=0;y<k.length;y+=1)k[y]&&k[y].m(g,null);p||(a=Z(l,"ionRefresh",r[7]),p=!0)},p(u,c){c[0]&35&&e!==(e=u[9](u[5],u[1],u[0])+"")&&ie(t,e),c[0]&1288&&(m=pe(u[3]),k=De(k,c,v,1,u,m,E,g,Se,pt,null,ct))},d(u){u&&(s(t),s(o),s(n)),r[16](null);for(let c=0;c<k.length;c+=1)k[c].d();p=!1,a()}}}function pn(r){let e,t,o='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Pull to refresh" refreshing-spinner="circles" refreshing-text="Refreshing..."></ion-refresher-content>',n,l,h=[],b=new Map,g,k,E=pe(r[3]);const p=a=>a[25].id_event;for(let a=0;a<E.length;a+=1){let m=ut(r,E,a),v=p(m);b.set(v,h[a]=vt(v,m))}return{c(){e=f("ion-content"),t=f("ion-refresher"),t.innerHTML=o,n=A(),l=f("ion-list");for(let a=0;a<h.length;a+=1)h[a].c();this.h()},l(a){e=_(a,"ION-CONTENT",{});var m=I(e);t=_(m,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),J(t)!=="svelte-1poui8g"&&(t.innerHTML=o),n=D(m),l=_(m,"ION-LIST",{});var v=I(l);for(let u=0;u<h.length;u+=1)h[u].l(v);v.forEach(s),m.forEach(s),this.h()},h(){N(t,"slot","fixed")},m(a,m){q(a,e,m),i(e,t),r[14](t),i(e,n),i(e,l);for(let v=0;v<h.length;v+=1)h[v]&&h[v].m(l,null);g||(k=Z(t,"ionRefresh",r[7]),g=!0)},p(a,m){m[0]&1288&&(E=pe(a[3]),h=De(h,m,p,1,a,E,b,l,Se,vt,null,ut))},d(a){a&&s(e),r[14](null);for(let m=0;m<h.length;m+=1)h[m].d();g=!1,k()}}}function dt(r){let e;return{c(){e=f("span"),this.h()},l(t){e=_(t,"SPAN",{class:!0}),I(e).forEach(s),this.h()},h(){U(e,"class","notes svelte-ziybgw")},m(t,o){q(t,e,o)},d(t){t&&s(e)}}}function pt(r,e){let t,o,n,l,h=parseInt(e[25].pos)+1+"",b,g,k,E,p,a,m=e[25].title+"",v,u,c=e[25].support_list&&e[25].support_list.length||e[10](e[25]),y,C,M="",P,B,d,L,S,T=c&&dt();function O(){return e[17](e[25])}return{key:r,first:null,c(){t=f("ion-item"),o=f("ion-avatar"),n=f("div"),l=f("div"),b=X(h),k=A(),E=f("ion-label"),p=f("ion-text"),a=f("h3"),v=X(m),u=A(),T&&T.c(),y=A(),C=f("div"),C.innerHTML=M,P=A(),B=f("ion-icon"),d=A(),this.h()},l(H){t=_(H,"ION-ITEM",{});var w=I(t);o=_(w,"ION-AVATAR",{slot:!0});var R=I(o);n=_(R,"DIV",{class:!0,title:!0,style:!0});var F=I(n);l=_(F,"DIV",{class:!0});var z=I(l);b=G(z,h),z.forEach(s),F.forEach(s),R.forEach(s),k=D(w),E=_(w,"ION-LABEL",{button:!0});var j=I(E);p=_(j,"ION-TEXT",{color:!0});var te=I(p);a=_(te,"H3",{});var $=I(a);v=G($,m),u=D($),T&&T.l($),$.forEach(s),te.forEach(s),y=D(j),C=_(j,"DIV",{class:!0,"data-svelte-h":!0}),J(C)!=="svelte-130ohbs"&&(C.innerHTML=M),j.forEach(s),P=D(w),B=_(w,"ION-ICON",{icon:!0,slot:!0}),I(B).forEach(s),d=D(w),w.forEach(s),this.h()},h(){U(l,"class","order svelte-ziybgw"),U(n,"class","order-wrapper svelte-ziybgw"),U(n,"title",g=ke(e[25].status)),V(n,"background-color",ee(e[25])),V(n,"color",Oe(ee(e[25]))),N(o,"slot","start"),N(p,"color","#2e2e2e"),U(C,"class","sub svelte-ziybgw"),N(E,"button",""),N(B,"icon",Ne),N(B,"slot","end"),this.first=t},m(H,w){q(H,t,w),i(t,o),i(o,n),i(n,l),i(l,b),i(t,k),i(t,E),i(E,p),i(p,a),i(a,v),i(a,u),T&&T.m(a,null),i(E,y),i(E,C),i(t,P),i(t,B),i(t,d),L||(S=Z(E,"click",O),L=!0)},p(H,w){e=H,w[0]&8&&h!==(h=parseInt(e[25].pos)+1+"")&&ie(b,h),w[0]&8&&g!==(g=ke(e[25].status))&&U(n,"title",g),w[0]&8&&V(n,"background-color",ee(e[25])),w[0]&8&&V(n,"color",Oe(ee(e[25]))),w[0]&8&&m!==(m=e[25].title+"")&&ie(v,m),w[0]&8&&(c=e[25].support_list&&e[25].support_list.length||e[10](e[25])),c?T||(T=dt(),T.c(),T.m(a,null)):T&&(T.d(1),T=null)},d(H){H&&s(t),T&&T.d(),L=!1,S()}}}function mt(r){let e;return{c(){e=f("span"),this.h()},l(t){e=_(t,"SPAN",{class:!0}),I(e).forEach(s),this.h()},h(){U(e,"class","notes svelte-ziybgw")},m(t,o){q(t,e,o)},d(t){t&&s(e)}}}function vt(r,e){let t,o,n,l,h=parseInt(e[25].pos)+1+"",b,g,k,E,p,a,m=e[25].title+"",v,u,c=e[25].support_list&&e[25].support_list.length||e[10](e[25]),y,C,M="",P,B,d,L,S,T=c&&mt();function O(){return e[15](e[25])}return{key:r,first:null,c(){t=f("ion-item"),o=f("ion-avatar"),n=f("div"),l=f("div"),b=X(h),k=A(),E=f("ion-label"),p=f("ion-text"),a=f("h3"),v=X(m),u=A(),T&&T.c(),y=A(),C=f("div"),C.innerHTML=M,P=A(),B=f("ion-icon"),d=A(),this.h()},l(H){t=_(H,"ION-ITEM",{});var w=I(t);o=_(w,"ION-AVATAR",{slot:!0});var R=I(o);n=_(R,"DIV",{class:!0,title:!0,style:!0});var F=I(n);l=_(F,"DIV",{class:!0});var z=I(l);b=G(z,h),z.forEach(s),F.forEach(s),R.forEach(s),k=D(w),E=_(w,"ION-LABEL",{button:!0});var j=I(E);p=_(j,"ION-TEXT",{color:!0});var te=I(p);a=_(te,"H3",{});var $=I(a);v=G($,m),u=D($),T&&T.l($),$.forEach(s),te.forEach(s),y=D(j),C=_(j,"DIV",{class:!0,"data-svelte-h":!0}),J(C)!=="svelte-130ohbs"&&(C.innerHTML=M),j.forEach(s),P=D(w),B=_(w,"ION-ICON",{icon:!0,slot:!0}),I(B).forEach(s),d=D(w),w.forEach(s),this.h()},h(){U(l,"class","order svelte-ziybgw"),U(n,"class","order-wrapper svelte-ziybgw"),U(n,"title",g=ke(e[25].status)),V(n,"background-color",ee(e[25])),V(n,"color",Oe(ee(e[25]))),N(o,"slot","start"),N(p,"color","#2e2e2e"),U(C,"class","sub svelte-ziybgw"),N(E,"button",""),N(B,"icon",Ne),N(B,"slot","end"),this.first=t},m(H,w){q(H,t,w),i(t,o),i(o,n),i(n,l),i(l,b),i(t,k),i(t,E),i(E,p),i(p,a),i(a,v),i(a,u),T&&T.m(a,null),i(E,y),i(E,C),i(t,P),i(t,B),i(t,d),L||(S=Z(E,"click",O),L=!0)},p(H,w){e=H,w[0]&8&&h!==(h=parseInt(e[25].pos)+1+"")&&ie(b,h),w[0]&8&&g!==(g=ke(e[25].status))&&U(n,"title",g),w[0]&8&&V(n,"background-color",ee(e[25])),w[0]&8&&V(n,"color",Oe(ee(e[25]))),w[0]&8&&m!==(m=e[25].title+"")&&ie(v,m),w[0]&8&&(c=e[25].support_list&&e[25].support_list.length||e[10](e[25])),c?T||(T=mt(),T.c(),T.m(a,null)):T&&(T.d(1),T=null)},d(H){H&&s(t),T&&T.d(),L=!1,S()}}}function mn(r){let e,t,o,n,l=`<ion-icon icon="${zt}"></ion-icon>`,h,b,g,k=r[2].name+"",E,p,a,m=r[4].name+"",v,u,c,y,C;function M(d,L){return d[5].length>0?hn:_n}let P=M(r),B=P(r);return{c(){e=f("ion-header"),t=f("ion-toolbar"),o=f("ion-buttons"),n=f("ion-button"),n.innerHTML=l,h=A(),b=f("ion-buttons"),g=f("ion-button"),E=X(k),p=A(),a=f("ion-title"),v=X(m),u=A(),B.c(),c=oe(),this.h()},l(d){e=_(d,"ION-HEADER",{translucent:!0});var L=I(e);t=_(L,"ION-TOOLBAR",{});var S=I(t);o=_(S,"ION-BUTTONS",{slot:!0});var T=I(o);n=_(T,"ION-BUTTON",{title:!0,alt:!0,"data-svelte-h":!0}),J(n)!=="svelte-7ppz3r"&&(n.innerHTML=l),T.forEach(s),h=D(S),b=_(S,"ION-BUTTONS",{slot:!0});var O=I(b);g=_(O,"ION-BUTTON",{});var H=I(g);E=G(H,k),H.forEach(s),O.forEach(s),p=D(S),a=_(S,"ION-TITLE",{});var w=I(a);v=G(w,m),w.forEach(s),S.forEach(s),L.forEach(s),u=D(d),B.l(d),c=oe(),this.h()},h(){N(n,"title","Atrás"),N(n,"alt","Atrás"),N(o,"slot","start"),N(b,"slot","secondary"),N(e,"translucent","")},m(d,L){q(d,e,L),i(e,t),i(t,o),i(o,n),i(t,h),i(t,b),i(b,g),i(g,E),i(t,p),i(t,a),i(a,v),q(d,u,L),B.m(d,L),q(d,c,L),y||(C=Z(n,"click",r[11]),y=!0)},p(d,L){L[0]&4&&k!==(k=d[2].name+"")&&ie(E,k),L[0]&16&&m!==(m=d[4].name+"")&&ie(v,m),P===(P=M(d))&&B?B.p(d,L):(B.d(1),B=P(d),B&&(B.c(),B.m(c.parentNode,c)))},d(d){d&&(s(e),s(u),s(c)),B.d(d),y=!1,C()}}}function vn(r){let e,t,o,n=r[2]&&ft(r);return{c(){e=A(),n&&n.c(),t=oe(),this.h()},l(l){Lt("svelte-kn0kph",document.head).forEach(s),e=D(l),n&&n.l(l),t=oe(),this.h()},h(){document.title="Rutaflow - Detalles de ruta"},m(l,h){q(l,e,h),n&&n.m(l,h),q(l,t,h),o=!0},p(l,h){l[2]?n?(n.p(l,h),h[0]&4&&Ae(n,1)):(n=ft(l),n.c(),Ae(n,1),n.m(t.parentNode,t)):n&&(Mt(),Fe(n,1,1,()=>{n=null}),At())},i(l){o||(Ae(n),o=!0)},o(l){Fe(n),o=!1},d(l){l&&(s(e),s(t)),n&&n.d(l)}}}function ee(r){let e="#ffffff";return r.status==="pending"?e="#f2e300":r.status==="completed"&&(e="#44d900"),e}function ke(r){let e="";return r=="pending"?e="Pendiente":r=="completed"&&(e="Completado"),e}function Oe(r){r.slice(0,1)==="#"&&(r=r.slice(1)),r.length===3&&(r=r.split("").map(function(l){return l+l}).join(""));const e=parseInt(r.substr(0,2),16),t=parseInt(r.substr(2,2),16),o=parseInt(r.substr(4,2),16);return(e*299+t*587+o*114)/1e3>=128?"#414040":"#fff"}function ze(r,e){let t=new FormData;return t.append("id_route",r),t.append("status",e),fetch("https://rutaflow-app-production.up.railway.app/api/admin/route/change_status.php",{method:"POST",body:t}).then(o=>o.json()).then(o=>{}).catch(o=>{console.error("Error fetching data:",o)}),""}const bn=r=>r.img;function gn(r,e,t){let o;bt(r,gt,O=>t(13,o=O));var n=this&&this.__awaiter||function(O,H,w,R){function F(z){return z instanceof w?z:new w(function(j){j(z)})}return new(w||(w=Promise))(function(z,j){function te(Y){try{me(R.next(Y))}catch(le){j(le)}}function $(Y){try{me(R.throw(Y))}catch(le){j(le)}}function me(Y){Y.done?z(Y.value):F(Y.value).then(te,$)}me((R=R.apply(O,H||[])).next())})};let{routeId:l}=e,{driverId:h}=e,b=new Object,g=[],k={},E={},p;const a=()=>n(void 0,void 0,void 0,function*(){yield m(l),p.complete()});function m(O){const H=new FormData;H.append("id_route",O),fetch("https://rutaflow-app-production.up.railway.app/api/admin/report/seguimiento_list.php",{method:"POST",body:H}).then(w=>w.json()).then(w=>{t(4,k=w.data.seguimiento_list[0]),t(3,g=w.data.event_list),t(5,E=w.data.checklist)}).catch(w=>{console.error("Error fetching data:",w)})}const v=O=>new Promise((H,w)=>{const R=new FormData;R.append("id_route",O.id_route),R.append("id_event",O.id_event),fetch("https://rutaflow-app-production.up.railway.app/api/admin/evidence/evidence_by_event.php",{method:"POST",body:R}).then(F=>F.json()).then(F=>{H(F.data.event_evidence[0])}).catch(F=>{console.error("Error fetching data:",F),w(F)})}),u=(O,H,w)=>{v(O).then(R=>{O.client_name=k.client_name,R&&(O.img=R.img,O.driver_comments=R.driver_comments,O.comments=R.comments),st("modal-delivery-info",on,{delivery:O}).then(F=>{})})},c=(O,H,w)=>(st("modal-checklist",an,{checklist:O,driverId:H,routeId:w}).then(R=>{}),ze(w,"checklist"),""),y=O=>{if(O.tracking_type=="subscription"){if(O.subscriber_info&&O.payment_type==="cash"&&new Date(O.subscriber_info.payment_next)<new Date)return!0}else if(O.tracking_type=="ecommerce"&&Number(O.payment_pending)>0)return!0;return!1},C=()=>{b.id_driver?Ie(`/drivers/${b.id_driver}`):Ie("/drivers/me")},M=(O,H)=>n(void 0,void 0,void 0,function*(){yield(yield It.create({header:O||"Error",message:H||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()});function P(O){Te[O?"unshift":"push"](()=>{p=O,t(6,p)})}const B=O=>u(O);function d(O){Te[O?"unshift":"push"](()=>{p=O,t(6,p)})}const L=O=>u(O);function S(O){Te[O?"unshift":"push"](()=>{p=O,t(6,p)})}const T=O=>{const H=g.findIndex(z=>z.id_event===O.id_event),w=H===0,R=H>0?g[H-1]:null;w||R&&R.img;const F=O.img!==null&&O.img!=="";F||w&&!F?u(O):M("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")};return r.$$set=O=>{"routeId"in O&&t(0,l=O.routeId),"driverId"in O&&t(1,h=O.driverId)},r.$$.update=()=>{r.$$.dirty[0]&8197&&(t(0,{routeId:l,driverId:h}=o.params,l,(t(1,h),t(13,o),t(2,b),t(0,l))),t(2,b=JSON.parse(localStorage.getItem("userSession"))),b?b.id_user&&(b.type=="admin"||b.type=="super")?(Ie(`/drivers/me/routes/${l}`),m(l)):b.id_user&&b.id_driver&&(m(l),Ie(`/drivers/${b.id_driver}/routes/${l}`)):Ie("/"))},[l,h,b,g,k,E,p,a,u,c,y,C,M,o,P,B,d,L,S,T]}class Cn extends We{constructor(e){super(),Xe(this,e,gn,vn,je,{routeId:0,driverId:1},null,[-1,-1])}}export{Cn as component};

import{Z as it,s as Fe,e as c,j as w,b as u,q as g,d as Z,h as s,m as L,v as E,i as z,w as i,x,n as Oe,z as De,_ as Ut,B as K,o as Ht,k as Ne,$ as lt,t as ie,r as le,f as G,a0 as Rt,y as be,a1 as qe,A as Ie,a2 as Ze,l as qt,p as pt}from"../chunks/index.BYLndrM5.js";import{S as je,i as Ve,t as Xe,a as et,c as zt,b as Ft,d as jt,m as Vt,e as Kt,g as Gt}from"../chunks/index.BNHbygFo.js";import{e as Ae,u as Qe,d as xe,a as Wt,c as tt,b as Dt,i as St,f as Xt,g as Bt,s as rt,h as Re,j as Jt,k as Yt,m as Zt,p as Qt}from"../chunks/index.CskF_WKi.js";import{g as Be}from"../chunks/entry.D-1wuOmU.js";import"../chunks/index-48209844.IIRtDZyg.js";import{m as at,a as Je,I as xt}from"../chunks/IonPage.KvUD72q2.js";import{q as $t,t as en}from"../chunks/ion-modal.CsJaVgKZ.js";const tn=(l,e)=>{if(!customElements.get(l)){class t extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const n={};for(const r of this.attributes)n[r.name]=r.value;new e({target:this.shadowRoot,props:n})}}customElements.define(l,t)}},nn=function(l){return document.createElement(l).constructor!==HTMLElement},on=(l,e)=>{nn(l)||tn(l,e)},ze=async(l,e,t)=>{$t(),en(),on(l,e);const o=await at.create({component:l,componentProps:t});return o.present(),await o.onWillDismiss()};let Me=it({km_inicial:[],gas_inicial:[],km_final:[],gas_final:[]}),Pt=it({flag:[]});function ln(l){let e,t,o,n,r="Cancelar",d,p,h="Captura de Km/Gas",T,k,b,a="Confirmar",I,m,f,_,O,y,N;return{c(){e=c("ion-header"),t=c("ion-toolbar"),o=c("ion-buttons"),n=c("ion-button"),n.textContent=r,d=w(),p=c("ion-title"),p.textContent=h,T=w(),k=c("ion-buttons"),b=c("ion-button"),b.textContent=a,I=w(),m=c("ion-content"),f=c("ion-item"),_=c("ion-input"),this.h()},l(B){e=u(B,"ION-HEADER",{translucent:!0});var A=g(e);t=u(A,"ION-TOOLBAR",{});var P=g(t);o=u(P,"ION-BUTTONS",{slot:!0});var U=g(o);n=u(U,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),Z(n)!=="svelte-17pq4f4"&&(n.textContent=r),U.forEach(s),d=L(P),p=u(P,"ION-TITLE",{"data-svelte-h":!0}),Z(p)!=="svelte-1yhkaq7"&&(p.textContent=h),T=L(P),k=u(P,"ION-BUTTONS",{slot:!0});var D=g(k);b=u(D,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),Z(b)!=="svelte-cm6j4s"&&(b.textContent=a),D.forEach(s),P.forEach(s),A.forEach(s),I=L(B),m=u(B,"ION-CONTENT",{fullscreen:!0});var v=g(m);f=u(v,"ION-ITEM",{});var S=g(f);_=u(S,"ION-INPUT",{class:!0,inputmode:!0,pattern:!0,type:!0,placeholder:!0,value:!0,required:!0});var R=g(_);R.forEach(s),S.forEach(s),v.forEach(s),this.h()},h(){E(n,"color","medium"),E(o,"slot","start"),E(b,"strong",""),E(k,"slot","end"),E(e,"translucent",""),E(_,"class","fin-km"),E(_,"inputmode","numeric"),E(_,"pattern","[0-9]*"),E(_,"type","number"),E(_,"placeholder",O="Ingresa "+l[0]+" actual"),E(_,"value",l[1]),E(_,"required",""),E(m,"fullscreen","")},m(B,A){z(B,e,A),i(e,t),i(t,o),i(o,n),i(t,d),i(t,p),i(t,T),i(t,k),i(k,b),z(B,I,A),z(B,m,A),i(m,f),i(f,_),y||(N=[x(n,"click",l[2]),x(b,"click",l[3]),x(_,"input",l[4])],y=!0)},p(B,[A]){A&1&&O!==(O="Ingresa "+B[0]+" actual")&&E(_,"placeholder",O),A&2&&E(_,"value",B[1])},i:Oe,o:Oe,d(B){B&&(s(e),s(I),s(m)),y=!1,De(N)}}}function rn(l,e,t){const o=Ut();let n=document.querySelector("ion-modal"),r=n.componentProps.data_type;n.componentProps.isLast;let d;Pt.subscribe(b=>{r=b.flag[0],r=="km_final"||r=="km_inicial"?t(0,d="kilometraje"):t(0,d="litros de gasolina")});let p=0;function h(){at.dismiss()}function T(){o("modalResult",{data:"Your data",role:"confirm"}),r=="km_inicial"?Me.update(a=>({...a,km_inicial:[p]})):r=="gas_inicial"?Me.update(a=>({...a,gas_inicial:[p]})):r=="km_final"?Me.update(a=>({...a,km_final:[p]})):r=="gas_final"&&Me.update(a=>({...a,gas_final:[p]})),h()}return[d,p,h,T,b=>t(1,p=b.target.value)]}class an extends je{constructor(e){super(),Ve(this,e,rn,ln,Fe,{})}}const Ye=it({items:[],checkedIndices:[],mandatory:[]});function mt(l,e,t){const o=l.slice();return o[49]=e[t],o[50]=e,o[51]=t,o}function sn(l){let e,t,o,n,r,d="Kilometraje inicial",p,h,T=l[0]?l[0]+" km.":"Cargar km",k,b,a,I,m,f,_,O="Gasolina inicial (litros)",y,N,B=l[1]?l[1]+" litros":"Cargar gas",A,P,U,D;return P=lt(l[20][0]),{c(){e=c("ion-item"),t=c("ion-label"),o=c("input"),n=w(),r=c("p"),r.textContent=d,p=w(),h=c("ion-button"),k=ie(T),b=w(),a=c("ion-item"),I=c("ion-label"),m=c("input"),f=w(),_=c("p"),_.textContent=O,y=w(),N=c("ion-button"),A=ie(B),this.h()},l(v){e=u(v,"ION-ITEM",{});var S=g(e);t=u(S,"ION-LABEL",{style:!0});var R=g(t);o=u(R,"INPUT",{id:!0,style:!0,type:!0}),n=L(R),r=u(R,"P",{style:!0,"data-svelte-h":!0}),Z(r)!=="svelte-88twxi"&&(r.textContent=d),R.forEach(s),p=L(S),h=u(S,"ION-BUTTON",{fill:!0,size:!0,class:!0,"aria-selected":!0});var M=g(h);k=le(M,T),M.forEach(s),S.forEach(s),b=L(v),a=u(v,"ION-ITEM",{});var q=g(a);I=u(q,"ION-LABEL",{style:!0});var C=g(I);m=u(C,"INPUT",{id:!0,style:!0,type:!0}),f=L(C),_=u(C,"P",{style:!0,"data-svelte-h":!0}),Z(_)!=="svelte-1ux30eb"&&(_.textContent=O),C.forEach(s),y=L(q),N=u(q,"ION-BUTTON",{fill:!0,class:!0,size:!0,style:!0});var F=g(N);A=le(F,B),F.forEach(s),q.forEach(s),this.h()},h(){G(o,"id","chkbox-km-ini"),K(o,"pointer-events","auto"),G(o,"type","checkbox"),o.required=!0,K(r,"margin-left","10px"),K(t,"display","flex"),E(h,"fill","outline"),E(h,"size","small"),E(h,"class","loadKmInicial"),E(h,"aria-selected",""),G(m,"id","chkbox-gas-ini"),K(m,"pointer-events","auto"),G(m,"type","checkbox"),m.required=!0,K(_,"margin-left","10px"),K(I,"display","flex"),E(N,"fill","outline"),E(N,"class","loadGasInicial"),E(N,"size","small"),K(N,"height","16px "),P.p(o,m)},m(v,S){z(v,e,S),i(e,t),i(t,o),o.checked=~(l[4]||[]).indexOf(o.__value),l[27](o),i(t,n),i(t,r),i(e,p),i(e,h),i(h,k),z(v,b,S),z(v,a,S),i(a,I),i(I,m),l[29](m),m.checked=~(l[4]||[]).indexOf(m.__value),i(I,f),i(I,_),i(a,y),i(a,N),i(N,A),U||(D=[x(o,"change",l[26]),x(h,"click",l[28]),x(m,"change",l[30]),x(N,"click",l[31])],U=!0)},p(v,S){S[0]&16&&(o.checked=~(v[4]||[]).indexOf(o.__value)),S[0]&1&&T!==(T=v[0]?v[0]+" km.":"Cargar km")&&be(k,T),S[0]&16&&(m.checked=~(v[4]||[]).indexOf(m.__value)),S[0]&2&&B!==(B=v[1]?v[1]+" litros":"Cargar gas")&&be(A,B)},d(v){v&&(s(e),s(b),s(a)),l[27](null),l[29](null),P.r(),U=!1,De(D)}}}function cn(l){let e,t,o,n,r,d="Kilometraje final",p,h,T=l[2]?l[2]+" km.":"Cargar km",k,b,a,I,m,f,_,O="Gasolina final (litros)",y,N,B=l[3]?l[3]+" litros":"Cargar gas",A,P,U,D;return P=lt(l[20][0]),{c(){e=c("ion-item"),t=c("ion-label"),o=c("input"),n=w(),r=c("p"),r.textContent=d,p=w(),h=c("ion-button"),k=ie(T),b=w(),a=c("ion-item"),I=c("ion-label"),m=c("input"),f=w(),_=c("p"),_.textContent=O,y=w(),N=c("ion-button"),A=ie(B),this.h()},l(v){e=u(v,"ION-ITEM",{});var S=g(e);t=u(S,"ION-LABEL",{style:!0});var R=g(t);o=u(R,"INPUT",{id:!0,style:!0,type:!0}),n=L(R),r=u(R,"P",{style:!0,"data-svelte-h":!0}),Z(r)!=="svelte-ccmu71"&&(r.textContent=d),R.forEach(s),p=L(S),h=u(S,"ION-BUTTON",{fill:!0,size:!0,class:!0,"aria-selected":!0});var M=g(h);k=le(M,T),M.forEach(s),S.forEach(s),b=L(v),a=u(v,"ION-ITEM",{});var q=g(a);I=u(q,"ION-LABEL",{style:!0});var C=g(I);m=u(C,"INPUT",{id:!0,style:!0,type:!0}),f=L(C),_=u(C,"P",{style:!0,"data-svelte-h":!0}),Z(_)!=="svelte-wsoyd2"&&(_.textContent=O),C.forEach(s),y=L(q),N=u(q,"ION-BUTTON",{fill:!0,size:!0,class:!0});var F=g(N);A=le(F,B),F.forEach(s),q.forEach(s),this.h()},h(){G(o,"id","chkbox-km-fin"),K(o,"pointer-events","auto"),G(o,"type","checkbox"),o.required=!0,K(r,"margin-left","10px"),K(t,"display","flex"),E(h,"fill","outline"),E(h,"size","small"),E(h,"class","loadKmInicial"),E(h,"aria-selected",""),G(m,"id","chkbox-gas-fin"),K(m,"pointer-events","auto"),G(m,"type","checkbox"),m.required=!0,K(_,"margin-left","10px"),K(I,"display","flex"),E(N,"fill","outline"),E(N,"size","small"),E(N,"class","loadGasInicial"),P.p(o,m)},m(v,S){z(v,e,S),i(e,t),i(t,o),o.checked=~(l[4]||[]).indexOf(o.__value),l[21](o),i(t,n),i(t,r),i(e,p),i(e,h),i(h,k),z(v,b,S),z(v,a,S),i(a,I),i(I,m),m.checked=~(l[4]||[]).indexOf(m.__value),l[24](m),i(I,f),i(I,_),i(a,y),i(a,N),i(N,A),U||(D=[x(o,"change",l[19]),x(h,"click",l[22]),x(m,"change",l[23]),x(N,"click",l[25])],U=!0)},p(v,S){S[0]&16&&(o.checked=~(v[4]||[]).indexOf(o.__value)),S[0]&4&&T!==(T=v[2]?v[2]+" km.":"Cargar km")&&be(k,T),S[0]&16&&(m.checked=~(v[4]||[]).indexOf(m.__value)),S[0]&8&&B!==(B=v[3]?v[3]+" litros":"Cargar gas")&&be(A,B)},d(v){v&&(s(e),s(b),s(a)),l[21](null),l[24](null),P.r(),U=!1,De(D)}}}function un(l){let e=[],t=new Map,o,n=Ae(l[12]);const r=d=>d[49].id_checklist_event;for(let d=0;d<n.length;d+=1){let p=mt(l,n,d),h=r(p);t.set(h,e[d]=vt(h,p))}return{c(){for(let d=0;d<e.length;d+=1)e[d].c();o=Ne()},l(d){for(let p=0;p<e.length;p+=1)e[p].l(d);o=Ne()},m(d,p){for(let h=0;h<e.length;h+=1)e[h]&&e[h].m(d,p);z(d,o,p)},p(d,p){p[0]&202864&&(n=Ae(d[12]),e=Qe(e,p,r,1,d,n,t,o.parentNode,xe,vt,o,mt))},d(d){d&&s(o);for(let p=0;p<e.length;p+=1)e[p].d(d)}}}function vt(l,e){let t,o,n,r=e[49],d,p,h=e[49].item+"",T,k,b,a,I=(e[11][e[49].id_checklist_event]?e[11][e[49].id_checklist_event]:"Cargar evidencia")+"",m,f,_,O,y,N,B;const A=()=>e[33](n,r),P=()=>e[33](null,r);function U(){return e[34](e[49])}function D(...v){return e[36](e[49],...v)}return y=lt(e[20][0]),{key:l,first:null,c(){t=c("ion-item"),o=c("ion-label"),n=c("input"),d=w(),p=c("p"),T=ie(h),k=w(),b=c("ion-button"),a=c("label"),m=ie(I),f=w(),_=c("input"),O=w(),this.h()},l(v){t=u(v,"ION-ITEM",{});var S=g(t);o=u(S,"ION-LABEL",{style:!0});var R=g(o);n=u(R,"INPUT",{id:!0,style:!0,type:!0}),d=L(R),p=u(R,"P",{style:!0});var M=g(p);T=le(M,h),M.forEach(s),R.forEach(s),k=L(S),b=u(S,"ION-BUTTON",{fill:!0,class:!0,size:!0});var q=g(b);a=u(q,"LABEL",{for:!0});var C=g(a);m=le(C,I),C.forEach(s),f=L(q),_=u(q,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0}),q.forEach(s),O=L(S),S.forEach(s),this.h()},h(){G(n,"id",`chkbox-${e[49].id_checklist_event}`),K(n,"pointer-events","auto"),G(n,"type","checkbox"),n.__value=e[49].id_checklist_event,Rt(n,n.__value),n.required=!0,K(p,"margin-left","10px"),K(o,"display","flex"),G(a,"for","chklist-"+e[49].id_checklist_event),K(_,"display","none"),G(_,"id","chklist-"+e[49].id_checklist_event),G(_,"name","fileToUpload"),G(_,"type","file"),G(_,"accept","image/*"),E(b,"fill","outline"),E(b,"class","loadEvidence svelte-1lh6nay"),E(b,"size","small"),y.p(n),this.first=t},m(v,S){z(v,t,S),i(t,o),i(o,n),n.checked=~(e[4]||[]).indexOf(n.__value),A(),i(o,d),i(o,p),i(p,T),i(t,k),i(t,b),i(b,a),i(a,m),i(b,f),i(b,_),e[35](_),i(t,O),N||(B=[x(n,"change",e[32]),x(n,"change",U),x(_,"change",D)],N=!0)},p(v,S){e=v,S[0]&16&&(n.checked=~(e[4]||[]).indexOf(n.__value)),r!==e[49]&&(P(),r=e[49],A()),S[0]&2048&&I!==(I=(e[11][e[49].id_checklist_event]?e[11][e[49].id_checklist_event]:"Cargar evidencia")+"")&&be(m,I)},d(v){v&&s(t),P(),e[35](null),y.r(),N=!1,De(B)}}}function fn(l){let e,t,o,n,r="Cancelar",d,p,h="Requerimientos de ruta",T,k,b,a,I,m,f,_="Confirmar",O,y;function N(U,D){return U[13]?cn:sn}let A=N(l)(l),P=l[12]&&un(l);return{c(){e=c("ion-header"),t=c("ion-toolbar"),o=c("ion-buttons"),n=c("ion-button"),n.textContent=r,d=w(),p=c("ion-title"),p.textContent=h,T=w(),k=c("ion-content"),b=c("ion-list"),A.c(),a=w(),P&&P.c(),I=w(),m=c("ion-footer"),f=c("ion-button"),f.textContent=_,this.h()},l(U){e=u(U,"ION-HEADER",{translucent:!0});var D=g(e);t=u(D,"ION-TOOLBAR",{});var v=g(t);o=u(v,"ION-BUTTONS",{slot:!0});var S=g(o);n=u(S,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),Z(n)!=="svelte-1dnmkxs"&&(n.textContent=r),S.forEach(s),d=L(v),p=u(v,"ION-TITLE",{"data-svelte-h":!0}),Z(p)!=="svelte-ucox25"&&(p.textContent=h),v.forEach(s),D.forEach(s),T=L(U),k=u(U,"ION-CONTENT",{fullscreen:!0});var R=g(k);b=u(R,"ION-LIST",{});var M=g(b);A.l(M),a=L(M),P&&P.l(M),M.forEach(s),R.forEach(s),I=L(U),m=u(U,"ION-FOOTER",{});var q=g(m);f=u(q,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),Z(f)!=="svelte-g82qqw"&&(f.textContent=_),q.forEach(s),this.h()},h(){E(n,"color","medium"),E(o,"slot","start"),E(e,"translucent",""),E(k,"fullscreen",""),E(f,"fill","outline"),E(f,"color","tertiary"),E(f,"strong",""),K(f,"width","99%"),K(f,"height","auto")},m(U,D){z(U,e,D),i(e,t),i(t,o),i(o,n),i(t,d),i(t,p),z(U,T,D),z(U,k,D),i(k,b),A.m(b,null),i(b,a),P&&P.m(b,null),z(U,I,D),z(U,m,D),i(m,f),O||(y=[x(n,"click",l[14]),x(f,"click",l[15])],O=!0)},p(U,D){A.p(U,D),U[12]&&P.p(U,D)},i:Oe,o:Oe,d(U){U&&(s(e),s(T),s(k),s(I),s(m)),A.d(),P&&P.d(),O=!1,De(y)}}}function nt(l,e){if(typeof l=="object"&&l!==null||Array.isArray(l)){if(Array.isArray(l))return l.map(t=>nt(t,e)).flat();{const t=Object.keys(l);let o;return e=="id_checklist_event"?o=t.filter(r=>r.toLowerCase().includes("id_checklist_event")).map(r=>l[r]):e=="mandatory"?o=t.filter(r=>r.toLowerCase().includes("mandatory")).map(r=>l[r]):(console.error("Tipo de dato no reconocido."),o=!1),o}}else return console.error("Invalid input. Please provide a valid object or array."),[]}function $e(l,e){let t=new FormData;t.append("id_route",l),t.append("status",e),fetch("https://app.rutaflow.com/api/admin/route/change_status.php",{method:"POST",body:t}).then(o=>o.json()).then(o=>{}).catch(o=>{console.error("Error fetching data:",o)})}function _n(l,e,t){let o=document.querySelector("ion-modal");const n=o.componentProps.checklist,r=o.componentProps.driverId,d=o.componentProps.routeId,p=o.componentProps.isLast;let h,T,k,b,a=[],I=null,m={},f,_,O,y,N={},B={};Ht(()=>{p?console.log("Último checklist"):Ye.update(H=>(H.mandatory=nt(n,"mandatory"),H.items=nt(n,"id_checklist_event"),H))});const A=async()=>{await(await Je.create({header:"Datos o checklist incompletos",message:"Carga la evidencia requerida y marca todas las casillas para confirmar",buttons:[{text:"Cerrar"}]})).present()},P=async()=>{await(await Je.create({header:"Datos capturados",message:"El kilometraje y gasolina final fueron registrados correctamente, espere aprobación para finalizar ruta",buttons:[{text:"Cerrar"}]})).present()},U=async H=>{await(await Je.create({header:"Datos inválidos",message:H=="km"?"Llena correctamente el campo de kilometraje inicial":"Llena correctamente el campo de gasolina inicial",buttons:[{text:"Cerrar"}]})).present()},D=()=>{at.dismiss(),r?Be(`/drivers/${r}`):Be("/drivers/me")},v=()=>{if(p){var H=q(k,"km"),W=q(b,"gas");const Y=new FormData;Y.append("km_final",H),Y.append("gas_final",W),Y.append("id_route",d),H&&W?(D(),fetch("https://app.rutaflow.com/api/admin/checklist/add_evidence.php",{method:"POST",body:Y}).then($=>$.json()).then($=>{P()}).catch($=>{console.error("Error fetching data:",$)})):A()}else{var ee=q(h,"km"),ne=q(T,"gas");Ye.update(Y=>{const $=Y.items,oe=Y.mandatory;if($.every(Q=>Y.checkedIndices.includes(Q))&&ee&&ne){D();const Q=new FormData;for(const V in N)if(N.hasOwnProperty(V)){const{img:se,img_id:we}=N[V];Q.append(`selectedImages[${V}][img]`,se),Q.append(`selectedImages[${V}][img_id]`,we)}Q.append("km_inicial",ee),Q.append("gas_inicial",ne),Q.append("id_route",d),fetch("https://app.rutaflow.com/api/admin/checklist/add_evidence.php",{method:"POST",body:Q}).then(V=>V.json()).then(V=>{oe&&oe[0]=="1"?$e(d,"checklist-pending"):$e(d,"enroute")}).catch(V=>{console.error("Error fetching data:",V)})}else A();return Y})}J()},S=async(H,W)=>{const ne=H.target.files[0],Y=await R(ne);if(Y){const $=new FormData;$.append("fileToUpload",Y);try{const oe=await fetch("https://app.rutaflow.com/api/admin/manager/upload_img_driver.php",{method:"POST",body:$});if(oe.ok){const fe=await oe.json();N={...N,[W]:{img:fe.img,img_id:fe.img_id}},t(11,B={...B,[W]:fe.filename}),M(W),t(6,m[W].checked=!0,m)}else console.error("File upload failed:",oe.statusText)}catch(oe){console.error("Error during file upload:",oe)}}},R=async H=>new Promise(W=>{const ee=new FileReader;ee.onload=ne=>{const Y=new Image;Y.src=ne.target.result,Y.onload=()=>{const $=document.createElement("canvas"),oe=$.getContext("2d"),fe=800,Q=600;let V=Y.width,se=Y.height;V>fe&&(se*=fe/V,V=fe),se>Q&&(V*=Q/se,se=Q),$.width=V,$.height=se,oe.drawImage(Y,0,0,V,se),$.toBlob(we=>{W(we)},"image/jpeg",.7)}},ee.readAsDataURL(H)}),M=H=>{Ye.update(W=>(W.checkedIndices.indexOf(H)===-1?W.checkedIndices.push(H):console.error(`ID ${H} is already checked.`),W.items.forEach(ne=>{ne.id_checklist_event===H&&(ne.checked=!0)}),W))};function q(H,W){return/^\d+$/.test(H)?parseInt(H,10):(U(W),null)}function C(H,W){F(W),o.componentProps.data_type=W,ze("modal-gas-km",an,{r:W}).then(()=>{Me.subscribe(ee=>{j(ee,W)})})}function F(H){Pt.update(W=>({...W,flag:[H]}))}function j(H,W){t(0,h=H.km_inicial?H.km_inicial:null),t(1,T=H.gas_inicial?H.gas_inicial:null),t(2,k=H.km_final?H.km_final:null),t(3,b=H.gas_final?H.gas_final:null),W=="km_inicial"&&t(7,f.checked=!0,f),W=="gas_inicial"&&t(8,_.checked=!0,_),W=="km_final"&&t(9,O.checked=!0,O),W=="gas_final"&&t(10,y.checked=!0,y)}function J(){Me.set({km_inicial:[],gas_inicial:[],km_final:[],gas_final:[]})}const X=[[]];function ce(){a=qe(X[0],this.__value,this.checked),t(4,a)}function _e(H){Ie[H?"unshift":"push"](()=>{O=H,t(9,O)})}const me=H=>C(H,"km_final");function ve(){a=qe(X[0],this.__value,this.checked),t(4,a)}function te(H){Ie[H?"unshift":"push"](()=>{y=H,t(10,y)})}const ae=H=>C(H,"gas_final");function ge(){a=qe(X[0],this.__value,this.checked),t(4,a)}function Ee(H){Ie[H?"unshift":"push"](()=>{f=H,t(7,f)})}const re=H=>C(H,"km_inicial");function ye(H){Ie[H?"unshift":"push"](()=>{_=H,t(8,_)})}function Le(){a=qe(X[0],this.__value,this.checked),t(4,a)}const Te=H=>C(H,"gas_inicial");function ue(){a=qe(X[0],this.__value,this.checked),t(4,a)}function he(H,W){Ie[H?"unshift":"push"](()=>{m[W.id_checklist_event]=H,t(6,m)})}const de=H=>M(H.id_checklist_event);function Ce(H){Ie[H?"unshift":"push"](()=>{I=H,t(5,I)})}return[h,T,k,b,a,I,m,f,_,O,y,B,n,p,D,v,S,M,C,ce,X,_e,me,ve,te,ae,ge,Ee,re,ye,Le,Te,ue,he,de,Ce,(H,W)=>S(W,H.id_checklist_event)]}class Mt extends je{constructor(e){super(),Ve(this,e,_n,fn,Fe,{},null,[-1,-1])}}function dn(l){let e,t,o,n,r,d="Domicilio 2",p,h,T=l[2].line2+"",k,b,a;return{c(){e=c("ion-item"),t=c("ion-icon"),o=w(),n=c("ion-label"),r=c("p"),r.textContent=d,p=w(),h=c("h2"),k=ie(T),b=w(),a=c("ion-icon"),this.h()},l(I){e=u(I,"ION-ITEM",{href:!0});var m=g(e);t=u(m,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(s),o=L(m),n=u(m,"ION-LABEL",{class:!0});var f=g(n);r=u(f,"P",{"data-svelte-h":!0}),Z(r)!=="svelte-1qy148r"&&(r.textContent=d),p=L(f),h=u(f,"H2",{});var _=g(h);k=le(_,T),_.forEach(s),f.forEach(s),b=L(m),a=u(m,"ION-ICON",{icon:!0,slot:!0}),g(a).forEach(s),m.forEach(s),this.h()},h(){E(t,"icon",rt),E(t,"slot","start"),E(n,"class","ion-text-wrap"),E(a,"icon",Re),E(a,"slot","end"),E(e,"href","https://www.google.com/maps/searhc/?api=1&query="+l[2].line2)},m(I,m){z(I,e,m),i(e,t),i(e,o),i(e,n),i(n,r),i(n,p),i(n,h),i(h,k),i(e,b),i(e,a)},p:Oe,d(I){I&&s(e)}}}function hn(l){let e,t,o,n,r,d="Domicilio 1",p,h,T=l[2].line1+"",k,b,a,I,m=l[2].line2&&l[2].line2.trim().length,f,_=m&&pn(l);return{c(){e=c("ion-item"),t=c("ion-icon"),o=w(),n=c("ion-label"),r=c("p"),r.textContent=d,p=w(),h=c("h2"),k=ie(T),b=w(),a=c("ion-icon"),I=w(),_&&_.c(),f=Ne(),this.h()},l(O){e=u(O,"ION-ITEM",{href:!0});var y=g(e);t=u(y,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(s),o=L(y),n=u(y,"ION-LABEL",{class:!0});var N=g(n);r=u(N,"P",{"data-svelte-h":!0}),Z(r)!=="svelte-1ehcrdm"&&(r.textContent=d),p=L(N),h=u(N,"H2",{});var B=g(h);k=le(B,T),B.forEach(s),N.forEach(s),b=L(y),a=u(y,"ION-ICON",{icon:!0,slot:!0}),g(a).forEach(s),y.forEach(s),I=L(O),_&&_.l(O),f=Ne(),this.h()},h(){E(t,"icon",rt),E(t,"slot","start"),E(n,"class","ion-text-wrap"),E(a,"icon",Re),E(a,"slot","end"),E(e,"href","https://www.google.com/maps/search/?api=1&query="+l[2].line1)},m(O,y){z(O,e,y),i(e,t),i(e,o),i(e,n),i(n,r),i(n,p),i(n,h),i(h,k),i(e,b),i(e,a),z(O,I,y),_&&_.m(O,y),z(O,f,y)},p(O,y){m&&_.p(O,y)},d(O){O&&(s(e),s(I),s(f)),_&&_.d(O)}}}function pn(l){let e,t,o,n,r,d="Domicilio 2",p,h,T=l[2].line2+"",k,b,a;return{c(){e=c("ion-item"),t=c("ion-icon"),o=w(),n=c("ion-label"),r=c("p"),r.textContent=d,p=w(),h=c("h2"),k=ie(T),b=w(),a=c("ion-icon"),this.h()},l(I){e=u(I,"ION-ITEM",{href:!0});var m=g(e);t=u(m,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(s),o=L(m),n=u(m,"ION-LABEL",{class:!0});var f=g(n);r=u(f,"P",{"data-svelte-h":!0}),Z(r)!=="svelte-1qy148r"&&(r.textContent=d),p=L(f),h=u(f,"H2",{});var _=g(h);k=le(_,T),_.forEach(s),f.forEach(s),b=L(m),a=u(m,"ION-ICON",{icon:!0,slot:!0}),g(a).forEach(s),m.forEach(s),this.h()},h(){E(t,"icon",rt),E(t,"slot","start"),E(n,"class","ion-text-wrap"),E(a,"icon",Re),E(a,"slot","end"),E(e,"href","https://www.google.com/maps/search/?api=1&query="+l[2].line2)},m(I,m){z(I,e,m),i(e,t),i(e,o),i(e,n),i(n,r),i(n,p),i(n,h),i(h,k),i(e,b),i(e,a)},p:Oe,d(I){I&&s(e)}}}function mn(l){let e,t=l[2].comments!="<br>"&&vn(l);return{c(){t&&t.c(),e=Ne()},l(o){t&&t.l(o),e=Ne()},m(o,n){t&&t.m(o,n),z(o,e,n)},p(o,n){o[2].comments!="<br>"&&t.p(o,n)},d(o){o&&s(e),t&&t.d(o)}}}function vn(l){let e,t,o,n,r,d="Notas de ubicación",p,h,T=l[2].comments+"",k;return{c(){e=c("ion-item"),t=c("ion-icon"),o=w(),n=c("ion-label"),r=c("p"),r.textContent=d,p=w(),h=c("h2"),k=ie(T),this.h()},l(b){e=u(b,"ION-ITEM",{});var a=g(e);t=u(a,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(s),o=L(a),n=u(a,"ION-LABEL",{class:!0});var I=g(n);r=u(I,"P",{"data-svelte-h":!0}),Z(r)!=="svelte-nhm2ft"&&(r.textContent=d),p=L(I),h=u(I,"H2",{});var m=g(h);k=le(m,T),m.forEach(s),I.forEach(s),a.forEach(s),this.h()},h(){E(t,"icon",St),E(t,"slot","start"),E(n,"class","ion-text-wrap")},m(b,a){z(b,e,a),i(e,t),i(e,o),i(e,n),i(n,r),i(n,p),i(n,h),i(h,k)},p:Oe,d(b){b&&s(e)}}}function bn(l){let e,t,o,n,r,d="Horarios",p,h,T=l[2].schedule+"",k;return{c(){e=c("ion-item"),t=c("ion-icon"),o=w(),n=c("ion-label"),r=c("p"),r.textContent=d,p=w(),h=c("h2"),k=ie(T),this.h()},l(b){e=u(b,"ION-ITEM",{});var a=g(e);t=u(a,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(s),o=L(a),n=u(a,"ION-LABEL",{});var I=g(n);r=u(I,"P",{"data-svelte-h":!0}),Z(r)!=="svelte-11q7hm5"&&(r.textContent=d),p=L(I),h=u(I,"H2",{});var m=g(h);k=le(m,T),m.forEach(s),I.forEach(s),a.forEach(s),this.h()},h(){E(t,"icon",Xt),E(t,"slot","start")},m(b,a){z(b,e,a),i(e,t),i(e,o),i(e,n),i(n,r),i(n,p),i(n,h),i(h,k)},p:Oe,d(b){b&&s(e)}}}function gn(l){let e,t,o,n,r,d="Notas del operador",p,h,T=l[2].driver_comments+"",k;return{c(){e=c("ion-item"),t=c("ion-icon"),o=w(),n=c("ion-label"),r=c("p"),r.textContent=d,p=w(),h=c("h2"),k=ie(T),this.h()},l(b){e=u(b,"ION-ITEM",{});var a=g(e);t=u(a,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(s),o=L(a),n=u(a,"ION-LABEL",{});var I=g(n);r=u(I,"P",{"data-svelte-h":!0}),Z(r)!=="svelte-1yk9qp4"&&(r.textContent=d),p=L(I),h=u(I,"H2",{});var m=g(h);k=le(m,T),m.forEach(s),I.forEach(s),a.forEach(s),this.h()},h(){E(t,"icon",Bt),E(t,"slot","start")},m(b,a){z(b,e,a),i(e,t),i(e,o),i(e,n),i(n,r),i(n,p),i(n,h),i(h,k)},p:Oe,d(b){b&&s(e)}}}function En(l){let e,t=l[2].logistic_comments!="<br>"&&In(l);return{c(){t&&t.c(),e=Ne()},l(o){t&&t.l(o),e=Ne()},m(o,n){t&&t.m(o,n),z(o,e,n)},p(o,n){o[2].logistic_comments!="<br>"&&t.p(o,n)},d(o){o&&s(e),t&&t.d(o)}}}function In(l){let e,t,o,n,r,d="Comentarios logísticos",p,h,T=l[2].logistic_comments+"",k;return{c(){e=c("ion-item"),t=c("ion-icon"),o=w(),n=c("ion-label"),r=c("p"),r.textContent=d,p=w(),h=c("h2"),k=ie(T),this.h()},l(b){e=u(b,"ION-ITEM",{});var a=g(e);t=u(a,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(s),o=L(a),n=u(a,"ION-LABEL",{class:!0});var I=g(n);r=u(I,"P",{"data-svelte-h":!0}),Z(r)!=="svelte-1iz85r6"&&(r.textContent=d),p=L(I),h=u(I,"H2",{});var m=g(h);k=le(m,T),m.forEach(s),I.forEach(s),a.forEach(s),this.h()},h(){E(t,"icon",St),E(t,"slot","start"),E(n,"class","ion-text-wrap")},m(b,a){z(b,e,a),i(e,t),i(e,o),i(e,n),i(n,r),i(n,p),i(n,h),i(h,k)},p:Oe,d(b){b&&s(e)}}}function bt(l){let e,t,o;return{c(){e=c("section"),t=c("ion-img"),this.h()},l(n){e=u(n,"SECTION",{});var r=g(e);t=u(r,"ION-IMG",{src:!0,alt:!0,style:!0}),g(t).forEach(s),r.forEach(s),this.h()},h(){Ze(t.src,o=l[1])||E(t,"src",o),E(t,"alt","Evidencia fotográfica"),K(t,"max-width","100%"),K(t,"margin-top","16px")},m(n,r){z(n,e,r),i(e,t)},p(n,r){r&2&&!Ze(t.src,o=n[1])&&E(t,"src",o)},d(n){n&&s(e)}}}function kn(l){let e,t,o,n,r="Cancelar",d,p,h=l[2].title+"",T,k,b,a,I="Confirmar",m,f,_,O,y,N,B,A,P="Cliente",U,D,v=l[2].client_name+"",S,R,M,q=l[2].comments&&l[2].comments.trim().length,C,F=l[2].schedule&&l[2].schedule.trim().length,j,J,X=l[2].logistic_comments&&l[2].logistic_comments.trim().length,ce,_e,me,ve,te,ae,ge,Ee,re,ye,Le,Te,ue="Subir Evidencia",he,de,Ce,Se,H;function W(V,se){if(V[2].line1&&V[2].line1.trim().length)return hn;if(V[2].line2&&V[2].line2.trim().length)return dn}let ee=W(l),ne=ee&&ee(l),Y=q&&mn(l),$=F&&bn(l),oe=l[2].driver_comments&&gn(l),fe=X&&En(l),Q=l[1]&&bt(l);return{c(){e=c("ion-header"),t=c("ion-toolbar"),o=c("ion-buttons"),n=c("ion-button"),n.textContent=r,d=w(),p=c("ion-title"),T=ie(h),k=w(),b=c("ion-buttons"),a=c("ion-button"),a.textContent=I,m=w(),f=c("ion-content"),_=c("ion-list"),O=c("ion-item"),y=c("ion-icon"),N=w(),B=c("ion-label"),A=c("p"),A.textContent=P,U=w(),D=c("h2"),S=ie(v),R=w(),ne&&ne.c(),M=w(),Y&&Y.c(),C=w(),$&&$.c(),j=w(),oe&&oe.c(),J=w(),fe&&fe.c(),ce=w(),_e=c("ion-item"),me=c("ion-icon"),ve=w(),te=c("ion-textarea"),ae=w(),ge=c("section"),Ee=c("label"),re=c("ion-button"),ye=c("ion-icon"),Le=w(),Te=c("label"),Te.textContent=ue,he=w(),de=c("input"),Ce=w(),Q&&Q.c(),this.h()},l(V){e=u(V,"ION-HEADER",{translucent:!0});var se=g(e);t=u(se,"ION-TOOLBAR",{});var we=g(t);o=u(we,"ION-BUTTONS",{slot:!0});var st=g(o);n=u(st,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),Z(n)!=="svelte-1f8rjcf"&&(n.textContent=r),st.forEach(s),d=L(we),p=u(we,"ION-TITLE",{title:!0});var ct=g(p);T=le(ct,h),ct.forEach(s),k=L(we),b=u(we,"ION-BUTTONS",{slot:!0});var ut=g(b);a=u(ut,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),Z(a)!=="svelte-1ida0il"&&(a.textContent=I),ut.forEach(s),we.forEach(s),se.forEach(s),m=L(V),f=u(V,"ION-CONTENT",{fullscreen:!0});var ft=g(f);_=u(ft,"ION-LIST",{});var pe=g(_);O=u(pe,"ION-ITEM",{});var Ke=g(O);y=u(Ke,"ION-ICON",{icon:!0,slot:!0}),g(y).forEach(s),N=L(Ke),B=u(Ke,"ION-LABEL",{});var Ge=g(B);A=u(Ge,"P",{"data-svelte-h":!0}),Z(A)!=="svelte-jrq7ei"&&(A.textContent=P),U=L(Ge),D=u(Ge,"H2",{});var _t=g(D);S=le(_t,v),_t.forEach(s),Ge.forEach(s),Ke.forEach(s),R=L(pe),ne&&ne.l(pe),M=L(pe),Y&&Y.l(pe),C=L(pe),$&&$.l(pe),j=L(pe),oe&&oe.l(pe),J=L(pe),fe&&fe.l(pe),ce=L(pe),_e=u(pe,"ION-ITEM",{});var We=g(_e);me=u(We,"ION-ICON",{icon:!0,slot:!0}),g(me).forEach(s),ve=L(We),te=u(We,"ION-TEXTAREA",{label:!0,placeholder:!0}),g(te).forEach(s),We.forEach(s),ae=L(pe),ge=u(pe,"SECTION",{});var dt=g(ge);Ee=u(dt,"LABEL",{for:!0,style:!0});var ht=g(Ee);re=u(ht,"ION-BUTTON",{fill:!0,class:!0,expand:!0});var Pe=g(re);ye=u(Pe,"ION-ICON",{icon:!0,slot:!0}),g(ye).forEach(s),Le=L(Pe),Te=u(Pe,"LABEL",{for:!0,style:!0,"data-svelte-h":!0}),Z(Te)!=="svelte-1as0od8"&&(Te.textContent=ue),he=L(Pe),de=u(Pe,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0}),Pe.forEach(s),ht.forEach(s),dt.forEach(s),Ce=L(pe),Q&&Q.l(pe),pe.forEach(s),ft.forEach(s),this.h()},h(){E(n,"color","medium"),E(o,"slot","start"),E(p,"title",l[2].title),E(a,"strong",""),E(b,"slot","end"),E(e,"translucent",""),E(y,"icon",Wt),E(y,"slot","start"),E(me,"icon",tt),E(me,"slot","start"),E(te,"label","Notas"),E(te,"placeholder","Escribe aquí..."),E(ye,"icon",Dt),E(ye,"slot","start"),G(Te,"for","eventEvidence"),K(Te,"padding","8px 10px"),K(de,"display","none"),G(de,"id","eventEvidence"),G(de,"name","fileToUpload"),G(de,"type","file"),G(de,"accept","image/*"),E(re,"fill","outline"),E(re,"class","loadEvidence"),E(re,"expand","block"),G(Ee,"for","eventEvidence"),K(Ee,"display","block"),K(Ee,"width","100%"),E(f,"fullscreen","")},m(V,se){z(V,e,se),i(e,t),i(t,o),i(o,n),i(t,d),i(t,p),i(p,T),i(t,k),i(t,b),i(b,a),z(V,m,se),z(V,f,se),i(f,_),i(_,O),i(O,y),i(O,N),i(O,B),i(B,A),i(B,U),i(B,D),i(D,S),i(_,R),ne&&ne.m(_,null),i(_,M),Y&&Y.m(_,null),i(_,C),$&&$.m(_,null),i(_,j),oe&&oe.m(_,null),i(_,J),fe&&fe.m(_,null),i(_,ce),i(_,_e),i(_e,me),i(_e,ve),i(_e,te),l[6](te),i(_,ae),i(_,ge),i(ge,Ee),i(Ee,re),i(re,ye),i(re,Le),i(re,Te),i(re,he),i(re,de),i(_,Ce),Q&&Q.m(_,null),Se||(H=[x(n,"click",l[4]),x(a,"click",l[5]),x(de,"change",l[3])],Se=!0)},p(V,[se]){ne&&ne.p(V,se),q&&Y.p(V,se),F&&$.p(V,se),V[2].driver_comments&&oe.p(V,se),X&&fe.p(V,se),V[1]?Q?Q.p(V,se):(Q=bt(V),Q.c(),Q.m(_,null)):Q&&(Q.d(1),Q=null)},i:Oe,o:Oe,d(V){V&&(s(e),s(m),s(f)),ne&&ne.d(),Y&&Y.d(),$&&$.d(),oe&&oe.d(),fe&&fe.d(),l[6](null),Q&&Q.d(),Se=!1,De(H)}}}function On(l,e,t){let o=document.querySelector("ion-modal"),n=o.componentProps.delivery,r=o.componentProps.isLast,d=n.driver_comments?n.driver_comments:"",p=n.img?n.img:"",h="";const T=async f=>{const O=f.target.files[0],y=await k(O);if(y){const N=new FormData;N.append("fileToUpload",y);try{const B=await fetch("https://app.rutaflow.com/api/admin/manager/upload_img_driver.php",{method:"POST",body:N});if(B.ok){const A=await B.json();t(1,p=A.img),h=A.img_id}else console.error("File upload failed:",B.statusText)}catch(B){console.error("Error during file upload:",B)}}},k=async f=>new Promise(_=>{const O=new FileReader;O.onload=y=>{const N=new Image;N.src=y.target.result,N.onload=()=>{const B=document.createElement("canvas"),A=B.getContext("2d"),P=800,U=600;let D=N.width,v=N.height;D>P&&(v*=P/D,D=P),v>U&&(D*=U/v,v=U),B.width=D,B.height=v,A.drawImage(N,0,0,D,v),B.toBlob(S=>{_(S)},"image/jpeg",.7)}},O.readAsDataURL(f)}),b=()=>{o.dismiss({data:Date.now()})},a=()=>{var f=new Object;f.id_route=n.id_route,f.id_event=n.id_event,f.comments=d.value,f.img=p,f.img_id=h;const _=new FormData;for(const O in f)_.append(O,f[O]);fetch("https://app.rutaflow.com/api/admin/evidence/send_evidence.php",{method:"POST",body:_}).then(O=>O.json()).then(O=>{b();var y=f.id_route;r&&I("","",y,r)}).catch(O=>{console.error("Error fetching data:",O)})},I=(f,_,O,y)=>{o.componentProps.routeId=O,o.componentProps.driverId=n.id_driver,ze("modal-km-gas",Mt,{checklist:f,driverId:_,routeId:O,isLast:y}).then(N=>{})};function m(f){Ie[f?"unshift":"push"](()=>{d=f,t(0,d)})}return[d,p,n,T,b,a,m]}class Nn extends je{constructor(e){super(),Ve(this,e,On,kn,Fe,{})}}function gt(l){let e,t,o;return{c(){e=c("section"),t=c("ion-img"),this.h()},l(n){e=u(n,"SECTION",{});var r=g(e);t=u(r,"ION-IMG",{src:!0,alt:!0,style:!0}),g(t).forEach(s),r.forEach(s),this.h()},h(){Ze(t.src,o=l[0])||E(t,"src",o),E(t,"alt","Evidencia fotográfica"),K(t,"max-width","100%"),K(t,"margin-top","16px")},m(n,r){z(n,e,r),i(e,t)},p(n,r){r&1&&!Ze(t.src,o=n[0])&&E(t,"src",o)},d(n){n&&s(e)}}}function Tn(l){let e,t,o,n,r="Cancelar",d,p,h="Agregar Gasto",T,k,b,a="Confirmar",I,m,f,_,O,y,N,B,A,P,U,D,v,S,R,M,q,C='<div slot="label">Tipo de pago <ion-text color="danger">(Obligatorio)</ion-text></div> <ion-select-option value="cash">Efectivo</ion-select-option> <ion-select-option value="cash">Tarjeta</ion-select-option> <ion-select-option value="transfer">Transferencia</ion-select-option>',F,j,J,X,ce,_e,me,ve,te,ae,ge=`<ion-icon icon="${Dt}" slot="start"></ion-icon>
                        Subir Evidencia`,Ee,re,ye,Le,Te,ue=l[0]&&gt(l);return{c(){e=c("ion-header"),t=c("ion-toolbar"),o=c("ion-buttons"),n=c("ion-button"),n.textContent=r,d=w(),p=c("ion-title"),p.textContent=h,T=w(),k=c("ion-buttons"),b=c("ion-button"),b.textContent=a,I=w(),m=c("ion-content"),f=c("ion-list"),_=c("ion-item"),O=c("ion-icon"),y=w(),N=c("ion-input"),B=w(),A=c("ion-item"),P=c("ion-icon"),U=w(),D=c("ion-input"),v=w(),S=c("ion-item"),R=c("ion-icon"),M=w(),q=c("ion-select"),q.innerHTML=C,F=w(),j=c("ion-item"),J=c("ion-icon"),X=w(),ce=c("ion-textarea"),_e=w(),me=c("section"),ve=c("label"),te=c("ion-button"),ae=c("label"),ae.innerHTML=ge,Ee=w(),re=c("input"),ye=w(),ue&&ue.c(),this.h()},l(he){e=u(he,"ION-HEADER",{translucent:!0});var de=g(e);t=u(de,"ION-TOOLBAR",{});var Ce=g(t);o=u(Ce,"ION-BUTTONS",{slot:!0});var Se=g(o);n=u(Se,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),Z(n)!=="svelte-1f8rjcf"&&(n.textContent=r),Se.forEach(s),d=L(Ce),p=u(Ce,"ION-TITLE",{title:!0,"data-svelte-h":!0}),Z(p)!=="svelte-10xvxus"&&(p.textContent=h),T=L(Ce),k=u(Ce,"ION-BUTTONS",{slot:!0});var H=g(k);b=u(H,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),Z(b)!=="svelte-k5zoz0"&&(b.textContent=a),H.forEach(s),Ce.forEach(s),de.forEach(s),I=L(he),m=u(he,"ION-CONTENT",{fullscreen:!0});var W=g(m);f=u(W,"ION-LIST",{});var ee=g(f);_=u(ee,"ION-ITEM",{});var ne=g(_);O=u(ne,"ION-ICON",{icon:!0,slot:!0}),g(O).forEach(s),y=L(ne),N=u(ne,"ION-INPUT",{label:!0,type:!0,placeholder:!0}),g(N).forEach(s),ne.forEach(s),B=L(ee),A=u(ee,"ION-ITEM",{});var Y=g(A);P=u(Y,"ION-ICON",{icon:!0,slot:!0}),g(P).forEach(s),U=L(Y),D=u(Y,"ION-INPUT",{label:!0,type:!0}),g(D).forEach(s),Y.forEach(s),v=L(ee),S=u(ee,"ION-ITEM",{});var $=g(S);R=u($,"ION-ICON",{icon:!0,slot:!0}),g(R).forEach(s),M=L($),q=u($,"ION-SELECT",{placeholder:!0,"data-svelte-h":!0}),Z(q)!=="svelte-1y2o04l"&&(q.innerHTML=C),$.forEach(s),F=L(ee),j=u(ee,"ION-ITEM",{});var oe=g(j);J=u(oe,"ION-ICON",{icon:!0,slot:!0}),g(J).forEach(s),X=L(oe),ce=u(oe,"ION-TEXTAREA",{label:!0,placeholder:!0}),g(ce).forEach(s),oe.forEach(s),_e=L(ee),me=u(ee,"SECTION",{});var fe=g(me);ve=u(fe,"LABEL",{for:!0,style:!0});var Q=g(ve);te=u(Q,"ION-BUTTON",{fill:!0,size:!0,class:!0,expand:!0});var V=g(te);ae=u(V,"LABEL",{for:!0,style:!0,"data-svelte-h":!0}),Z(ae)!=="svelte-1m9yw22"&&(ae.innerHTML=ge),Ee=L(V),re=u(V,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0}),V.forEach(s),Q.forEach(s),fe.forEach(s),ye=L(ee),ue&&ue.l(ee),ee.forEach(s),W.forEach(s),this.h()},h(){E(n,"color","medium"),E(o,"slot","start"),E(p,"title",""),E(b,"strong",""),E(k,"slot","end"),E(e,"translucent",""),E(O,"icon",Bt),E(O,"slot","start"),E(N,"label","Concepto"),E(N,"type","text"),E(N,"placeholder","Escribe aquí..."),E(P,"icon",tt),E(P,"slot","start"),E(D,"label","Cantidad"),E(D,"type","number"),E(R,"icon",Jt),E(R,"slot","start"),E(q,"placeholder","Tipo de pago"),E(J,"icon",tt),E(J,"slot","start"),E(ce,"label","Comentarios"),E(ce,"placeholder","Escribe aquí..."),G(ae,"for","eventEvidence"),K(ae,"width","100%"),K(ae,"padding","8px"),K(re,"display","none"),G(re,"id","eventEvidence"),G(re,"name","fileToUpload"),G(re,"type","file"),G(re,"accept","image/*"),E(te,"fill","outline"),E(te,"size","small"),E(te,"class","loadEvidence"),E(te,"expand","block"),G(ve,"for","eventEvidence"),K(ve,"display","block"),K(ve,"width","100%"),E(m,"fullscreen","")},m(he,de){z(he,e,de),i(e,t),i(t,o),i(o,n),i(t,d),i(t,p),i(t,T),i(t,k),i(k,b),z(he,I,de),z(he,m,de),i(m,f),i(f,_),i(_,O),i(_,y),i(_,N),l[8](N),i(f,B),i(f,A),i(A,P),i(A,U),i(A,D),l[9](D),i(f,v),i(f,S),i(S,R),i(S,M),i(S,q),l[10](q),i(f,F),i(f,j),i(j,J),i(j,X),i(j,ce),l[11](ce),i(f,_e),i(f,me),i(me,ve),i(ve,te),i(te,ae),i(te,Ee),i(te,re),i(f,ye),ue&&ue.m(f,null),Le||(Te=[x(n,"click",l[6]),x(b,"click",l[7]),x(re,"change",l[5])],Le=!0)},p(he,[de]){he[0]?ue?ue.p(he,de):(ue=gt(he),ue.c(),ue.m(f,null)):ue&&(ue.d(1),ue=null)},i:Oe,o:Oe,d(he){he&&(s(e),s(I),s(m)),l[8](null),l[9](null),l[10](null),l[11](null),ue&&ue.d(),Le=!1,De(Te)}}}function yn(l,e,t){let o=document.querySelector("ion-modal");o.componentProps.routeName;let n=o.componentProps.routeId,r="",d="",p="",h=0,T="",k="";const b=async N=>{const A=N.target.files[0],P=await a(A);if(P){const U=new FormData;U.append("fileToUpload",P);try{const D=await fetch("https://app.rutaflow.com/api/admin/manager/upload_img_driver.php",{method:"POST",body:U});if(D.ok){const v=await D.json();t(0,r=v.img),d=v.img_id}else console.error("File upload failed:",D.statusText)}catch(D){console.error("Error during file upload:",D)}}},a=async N=>new Promise(B=>{const A=new FileReader;A.onload=P=>{const U=new Image;U.src=P.target.result,U.onload=()=>{const D=document.createElement("canvas"),v=D.getContext("2d"),S=800,R=600;let M=U.width,q=U.height;M>S&&(q*=S/M,M=S),q>R&&(M*=R/q,q=R),D.width=M,D.height=q,v.drawImage(U,0,0,M,q),D.toBlob(C=>{B(C)},"image/jpeg",.7)}},A.readAsDataURL(N)}),I=()=>{o.dismiss({data:Date.now()})},m=()=>{var N=new Object;N.id_route=n,N.comments=T.value,N.type=p.value,N.img=r,N.img_id=d,N.amount=h.value,N.concept=k.value;const B=new FormData;for(const A in N)B.append(A,N[A]);console.log(B),fetch("https://app.rutaflow.com/api/admin/expenses/add_expense.php",{method:"POST",body:B}).then(A=>A.json()).then(A=>{I()}).catch(A=>{console.error("Error fetching data:",A)})};function f(N){Ie[N?"unshift":"push"](()=>{k=N,t(4,k)})}function _(N){Ie[N?"unshift":"push"](()=>{h=N,t(2,h)})}function O(N){Ie[N?"unshift":"push"](()=>{p=N,t(1,p)})}function y(N){Ie[N?"unshift":"push"](()=>{T=N,t(3,T)})}return[r,p,h,T,k,b,I,m,f,_,O,y]}class Cn extends je{constructor(e){super(),Ve(this,e,yn,Tn,Fe,{})}}function Et(l,e,t){const o=l.slice();return o[29]=e[t],o}function It(l,e,t){const o=l.slice();return o[29]=e[t],o[31]=t,o}function kt(l,e,t){const o=l.slice();return o[29]=e[t],o[31]=t,o}function Ot(l){let e,t;return e=new xt({props:{$$slots:{default:[Sn]},$$scope:{ctx:l}}}),{c(){Ft(e.$$.fragment)},l(o){jt(e.$$.fragment,o)},m(o,n){Vt(e,o,n),t=!0},p(o,n){const r={};n[0]&255|n[1]&16&&(r.$$scope={dirty:n,ctx:o}),e.$set(r)},i(o){t||(Xe(e.$$.fragment,o),t=!0)},o(o){et(e.$$.fragment,o),t=!1},d(o){Kt(e,o)}}}function wn(l){let e=l[7].mandatory&&Array.isArray(l[7].mandatory)&&l[7].mandatory[0]==="0",t,o,n,r='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Jala para actualizar" refreshing-spinner="circles" refreshing-text="Actualizando..."></ion-refresher-content>',d,p,h=[],T=new Map,k,b,a=e&&Nt(l),I=Ae(l[3]);const m=f=>f[29].id_event;for(let f=0;f<I.length;f+=1){let _=Et(l,I,f),O=m(_);T.set(O,h[f]=yt(O,_))}return{c(){a&&a.c(),t=w(),o=c("ion-content"),n=c("ion-refresher"),n.innerHTML=r,d=w(),p=c("ion-list");for(let f=0;f<h.length;f+=1)h[f].c();this.h()},l(f){a&&a.l(f),t=L(f),o=u(f,"ION-CONTENT",{});var _=g(o);n=u(_,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),Z(n)!=="svelte-1jkndk3"&&(n.innerHTML=r),d=L(_),p=u(_,"ION-LIST",{});var O=g(p);for(let y=0;y<h.length;y+=1)h[y].l(O);O.forEach(s),_.forEach(s),this.h()},h(){E(n,"slot","fixed")},m(f,_){a&&a.m(f,_),z(f,t,_),z(f,o,_),i(o,n),l[22](n),i(o,d),i(o,p);for(let O=0;O<h.length;O+=1)h[O]&&h[O].m(p,null);k||(b=x(n,"ionRefresh",l[8]),k=!0)},p(f,_){_[0]&128&&(e=f[7].mandatory&&Array.isArray(f[7].mandatory)&&f[7].mandatory[0]==="0"),e?a?a.p(f,_):(a=Nt(f),a.c(),a.m(t.parentNode,t)):a&&(a.d(1),a=null),_[0]&21e3&&(I=Ae(f[3]),h=Qe(h,_,m,1,f,I,T,p,xe,yt,null,Et))},d(f){f&&(s(t),s(o)),a&&a.d(f),l[22](null);for(let _=0;_<h.length;_+=1)h[_].d();k=!1,b()}}}function Ln(l){let e,t;function o(d,p){return p[0]&32&&(e=null),e==null&&(e=!!d[5].every(Pn)),e?Dn:An}let n=o(l,[-1,-1]),r=n(l);return{c(){r.c(),t=Ne()},l(d){r.l(d),t=Ne()},m(d,p){r.m(d,p),z(d,t,p)},p(d,p){n===(n=o(d,p))&&r?r.p(d,p):(r.d(1),r=n(d),r&&(r.c(),r.m(t.parentNode,t)))},d(d){d&&s(t),r.d(d)}}}function Nt(l){let e=ot(l[0],"enroute")+"",t;return{c(){t=ie(e)},l(o){t=le(o,e)},m(o,n){z(o,t,n)},p(o,n){n[0]&1&&e!==(e=ot(o[0],"enroute")+"")&&be(t,e)},d(o){o&&s(t)}}}function Tt(l){let e;return{c(){e=c("span"),this.h()},l(t){e=u(t,"SPAN",{class:!0}),g(e).forEach(s),this.h()},h(){G(e,"class","notes svelte-ziybgw")},m(t,o){z(t,e,o)},d(t){t&&s(e)}}}function yt(l,e){let t,o,n,r,d=parseInt(e[29].pos)+1+"",p,h,T,k,b,a,I=e[29].title+"",m,f,_=e[29].support_list&&e[29].support_list.length||e[12](e[29]),O,y,N,B,A,P=_&&Tt();function U(){return e[23](e[29])}return{key:l,first:null,c(){t=c("ion-item"),o=c("ion-avatar"),n=c("div"),r=c("div"),p=ie(d),T=w(),k=c("ion-label"),b=c("ion-text"),a=c("h3"),m=ie(I),f=w(),P&&P.c(),O=w(),y=c("ion-icon"),N=w(),this.h()},l(D){t=u(D,"ION-ITEM",{});var v=g(t);o=u(v,"ION-AVATAR",{slot:!0});var S=g(o);n=u(S,"DIV",{class:!0,title:!0,style:!0});var R=g(n);r=u(R,"DIV",{class:!0});var M=g(r);p=le(M,d),M.forEach(s),R.forEach(s),S.forEach(s),T=L(v),k=u(v,"ION-LABEL",{button:!0});var q=g(k);b=u(q,"ION-TEXT",{color:!0});var C=g(b);a=u(C,"H3",{});var F=g(a);m=le(F,I),f=L(F),P&&P.l(F),F.forEach(s),C.forEach(s),q.forEach(s),O=L(v),y=u(v,"ION-ICON",{icon:!0,slot:!0,style:!0}),g(y).forEach(s),N=L(v),v.forEach(s),this.h()},h(){G(r,"class","order svelte-ziybgw"),G(n,"class","order-wrapper svelte-ziybgw"),G(n,"title",h=Ue(e[29].status)),K(n,"background-color",ke(e[29])),K(n,"color",He(ke(e[29]))),E(o,"slot","start"),E(b,"color","#2e2e2e"),E(k,"button",""),E(y,"icon",Re),E(y,"slot","end"),K(y,"color",ke(e[29])),this.first=t},m(D,v){z(D,t,v),i(t,o),i(o,n),i(n,r),i(r,p),i(t,T),i(t,k),i(k,b),i(b,a),i(a,m),i(a,f),P&&P.m(a,null),i(t,O),i(t,y),i(t,N),B||(A=x(k,"click",U),B=!0)},p(D,v){e=D,v[0]&8&&d!==(d=parseInt(e[29].pos)+1+"")&&be(p,d),v[0]&8&&h!==(h=Ue(e[29].status))&&G(n,"title",h),v[0]&8&&K(n,"background-color",ke(e[29])),v[0]&8&&K(n,"color",He(ke(e[29]))),v[0]&8&&I!==(I=e[29].title+"")&&be(m,I),v[0]&8&&(_=e[29].support_list&&e[29].support_list.length||e[12](e[29])),_?P||(P=Tt(),P.c(),P.m(a,null)):P&&(P.d(1),P=null),v[0]&8&&K(y,"color",ke(e[29]))},d(D){D&&s(t),P&&P.d(),B=!1,A()}}}function An(l){let e=l[10](l[5],l[1],l[0])+"",t,o,n,r,d='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Pull to refresh" refreshing-spinner="circles" refreshing-text="Refreshing..."></ion-refresher-content>',p,h,T=[],k=new Map,b,a,I=Ae(l[3]);const m=f=>f[29].id_event;for(let f=0;f<I.length;f+=1){let _=It(l,I,f),O=m(_);k.set(O,T[f]=wt(O,_))}return{c(){t=ie(e),o=w(),n=c("ion-content"),r=c("ion-refresher"),r.innerHTML=d,p=w(),h=c("ion-list");for(let f=0;f<T.length;f+=1)T[f].c();this.h()},l(f){t=le(f,e),o=L(f),n=u(f,"ION-CONTENT",{});var _=g(n);r=u(_,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),Z(r)!=="svelte-1poui8g"&&(r.innerHTML=d),p=L(_),h=u(_,"ION-LIST",{});var O=g(h);for(let y=0;y<T.length;y+=1)T[y].l(O);O.forEach(s),_.forEach(s),this.h()},h(){E(r,"slot","fixed")},m(f,_){z(f,t,_),z(f,o,_),z(f,n,_),i(n,r),l[20](r),i(n,p),i(n,h);for(let O=0;O<T.length;O+=1)T[O]&&T[O].m(h,null);b||(a=x(r,"ionRefresh",l[8]),b=!0)},p(f,_){_[0]&35&&e!==(e=f[10](f[5],f[1],f[0])+"")&&be(t,e),_[0]&37384&&(I=Ae(f[3]),T=Qe(T,_,m,1,f,I,k,h,xe,wt,null,It))},d(f){f&&(s(t),s(o),s(n)),l[20](null);for(let _=0;_<T.length;_+=1)T[_].d();b=!1,a()}}}function Dn(l){let e,t,o='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Pull to refresh" refreshing-spinner="circles" refreshing-text="Refreshing..."></ion-refresher-content>',n,r,d=[],p=new Map,h,T,k=Ae(l[3]);const b=a=>a[29].id_event;for(let a=0;a<k.length;a+=1){let I=kt(l,k,a),m=b(I);p.set(m,d[a]=At(m,I))}return{c(){e=c("ion-content"),t=c("ion-refresher"),t.innerHTML=o,n=w(),r=c("ion-list");for(let a=0;a<d.length;a+=1)d[a].c();this.h()},l(a){e=u(a,"ION-CONTENT",{});var I=g(e);t=u(I,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),Z(t)!=="svelte-1poui8g"&&(t.innerHTML=o),n=L(I),r=u(I,"ION-LIST",{});var m=g(r);for(let f=0;f<d.length;f+=1)d[f].l(m);m.forEach(s),I.forEach(s),this.h()},h(){E(t,"slot","fixed")},m(a,I){z(a,e,I),i(e,t),l[18](t),i(e,n),i(e,r);for(let m=0;m<d.length;m+=1)d[m]&&d[m].m(r,null);h||(T=x(t,"ionRefresh",l[8]),h=!0)},p(a,I){I[0]&37384&&(k=Ae(a[3]),d=Qe(d,I,b,1,a,k,p,r,xe,At,null,kt))},d(a){a&&s(e),l[18](null);for(let I=0;I<d.length;I+=1)d[I].d();h=!1,T()}}}function Ct(l){let e;return{c(){e=c("span"),this.h()},l(t){e=u(t,"SPAN",{class:!0}),g(e).forEach(s),this.h()},h(){G(e,"class","notes svelte-ziybgw")},m(t,o){z(t,e,o)},d(t){t&&s(e)}}}function wt(l,e){let t,o,n,r,d=parseInt(e[29].pos)+1+"",p,h,T,k,b,a,I=e[29].title+"",m,f,_=e[29].support_list&&e[29].support_list.length||e[12](e[29]),O,y,N="",B,A,P,U,D,v=_&&Ct();function S(){return e[21](e[29],e[31])}return{key:l,first:null,c(){t=c("ion-item"),o=c("ion-avatar"),n=c("div"),r=c("div"),p=ie(d),T=w(),k=c("ion-label"),b=c("ion-text"),a=c("h3"),m=ie(I),f=w(),v&&v.c(),O=w(),y=c("div"),y.innerHTML=N,B=w(),A=c("ion-icon"),P=w(),this.h()},l(R){t=u(R,"ION-ITEM",{});var M=g(t);o=u(M,"ION-AVATAR",{slot:!0});var q=g(o);n=u(q,"DIV",{class:!0,title:!0,style:!0});var C=g(n);r=u(C,"DIV",{class:!0});var F=g(r);p=le(F,d),F.forEach(s),C.forEach(s),q.forEach(s),T=L(M),k=u(M,"ION-LABEL",{button:!0});var j=g(k);b=u(j,"ION-TEXT",{color:!0});var J=g(b);a=u(J,"H3",{});var X=g(a);m=le(X,I),f=L(X),v&&v.l(X),X.forEach(s),J.forEach(s),O=L(j),y=u(j,"DIV",{class:!0,"data-svelte-h":!0}),Z(y)!=="svelte-130ohbs"&&(y.innerHTML=N),j.forEach(s),B=L(M),A=u(M,"ION-ICON",{icon:!0,slot:!0}),g(A).forEach(s),P=L(M),M.forEach(s),this.h()},h(){G(r,"class","order svelte-ziybgw"),G(n,"class","order-wrapper svelte-ziybgw"),G(n,"title",h=Ue(e[29].status)),K(n,"background-color",ke(e[29])),K(n,"color",He(ke(e[29]))),E(o,"slot","start"),E(b,"color","#2e2e2e"),G(y,"class","sub svelte-ziybgw"),E(k,"button",""),E(A,"icon",Re),E(A,"slot","end"),this.first=t},m(R,M){z(R,t,M),i(t,o),i(o,n),i(n,r),i(r,p),i(t,T),i(t,k),i(k,b),i(b,a),i(a,m),i(a,f),v&&v.m(a,null),i(k,O),i(k,y),i(t,B),i(t,A),i(t,P),U||(D=x(k,"click",S),U=!0)},p(R,M){e=R,M[0]&8&&d!==(d=parseInt(e[29].pos)+1+"")&&be(p,d),M[0]&8&&h!==(h=Ue(e[29].status))&&G(n,"title",h),M[0]&8&&K(n,"background-color",ke(e[29])),M[0]&8&&K(n,"color",He(ke(e[29]))),M[0]&8&&I!==(I=e[29].title+"")&&be(m,I),M[0]&8&&(_=e[29].support_list&&e[29].support_list.length||e[12](e[29])),_?v||(v=Ct(),v.c(),v.m(a,null)):v&&(v.d(1),v=null)},d(R){R&&s(t),v&&v.d(),U=!1,D()}}}function Lt(l){let e;return{c(){e=c("span"),this.h()},l(t){e=u(t,"SPAN",{class:!0}),g(e).forEach(s),this.h()},h(){G(e,"class","notes svelte-ziybgw")},m(t,o){z(t,e,o)},d(t){t&&s(e)}}}function At(l,e){let t,o,n,r,d=parseInt(e[29].pos)+1+"",p,h,T,k,b,a,I=e[29].title+"",m,f,_=e[29].support_list&&e[29].support_list.length||e[12](e[29]),O,y,N="",B,A,P,U,D,v=_&&Lt();function S(){return e[19](e[29],e[31])}return{key:l,first:null,c(){t=c("ion-item"),o=c("ion-avatar"),n=c("div"),r=c("div"),p=ie(d),T=w(),k=c("ion-label"),b=c("ion-text"),a=c("h3"),m=ie(I),f=w(),v&&v.c(),O=w(),y=c("div"),y.innerHTML=N,B=w(),A=c("ion-icon"),P=w(),this.h()},l(R){t=u(R,"ION-ITEM",{});var M=g(t);o=u(M,"ION-AVATAR",{slot:!0});var q=g(o);n=u(q,"DIV",{class:!0,title:!0,style:!0});var C=g(n);r=u(C,"DIV",{class:!0});var F=g(r);p=le(F,d),F.forEach(s),C.forEach(s),q.forEach(s),T=L(M),k=u(M,"ION-LABEL",{button:!0});var j=g(k);b=u(j,"ION-TEXT",{color:!0});var J=g(b);a=u(J,"H3",{});var X=g(a);m=le(X,I),f=L(X),v&&v.l(X),X.forEach(s),J.forEach(s),O=L(j),y=u(j,"DIV",{class:!0,"data-svelte-h":!0}),Z(y)!=="svelte-130ohbs"&&(y.innerHTML=N),j.forEach(s),B=L(M),A=u(M,"ION-ICON",{icon:!0,slot:!0}),g(A).forEach(s),P=L(M),M.forEach(s),this.h()},h(){G(r,"class","order svelte-ziybgw"),G(n,"class","order-wrapper svelte-ziybgw"),G(n,"title",h=Ue(e[29].status)),K(n,"background-color",ke(e[29])),K(n,"color",He(ke(e[29]))),E(o,"slot","start"),E(b,"color","#2e2e2e"),G(y,"class","sub svelte-ziybgw"),E(k,"button",""),E(A,"icon",Re),E(A,"slot","end"),this.first=t},m(R,M){z(R,t,M),i(t,o),i(o,n),i(n,r),i(r,p),i(t,T),i(t,k),i(k,b),i(b,a),i(a,m),i(a,f),v&&v.m(a,null),i(k,O),i(k,y),i(t,B),i(t,A),i(t,P),U||(D=x(k,"click",S),U=!0)},p(R,M){e=R,M[0]&8&&d!==(d=parseInt(e[29].pos)+1+"")&&be(p,d),M[0]&8&&h!==(h=Ue(e[29].status))&&G(n,"title",h),M[0]&8&&K(n,"background-color",ke(e[29])),M[0]&8&&K(n,"color",He(ke(e[29]))),M[0]&8&&I!==(I=e[29].title+"")&&be(m,I),M[0]&8&&(_=e[29].support_list&&e[29].support_list.length||e[12](e[29])),_?v||(v=Lt(),v.c(),v.m(a,null)):v&&(v.d(1),v=null)},d(R){R&&s(t),v&&v.d(),U=!1,D()}}}function Sn(l){let e,t,o,n,r=`<ion-icon icon="${Yt}"></ion-icon>`,d,p,h,T=`<ion-icon icon="${Zt}"></ion-icon>`,k,b,a=l[2].name+"",I,m,f,_=l[4].name+"",O,y,N,B,A;function P(v,S){return v[5].length>0?Ln:wn}let U=P(l),D=U(l);return{c(){e=c("ion-header"),t=c("ion-toolbar"),o=c("ion-buttons"),n=c("ion-button"),n.innerHTML=r,d=w(),p=c("ion-buttons"),h=c("ion-button"),h.innerHTML=T,k=w(),b=c("ion-button"),I=ie(a),m=w(),f=c("ion-title"),O=ie(_),y=w(),D.c(),N=Ne(),this.h()},l(v){e=u(v,"ION-HEADER",{translucent:!0});var S=g(e);t=u(S,"ION-TOOLBAR",{});var R=g(t);o=u(R,"ION-BUTTONS",{slot:!0});var M=g(o);n=u(M,"ION-BUTTON",{title:!0,alt:!0,"data-svelte-h":!0}),Z(n)!=="svelte-7ppz3r"&&(n.innerHTML=r),M.forEach(s),d=L(R),p=u(R,"ION-BUTTONS",{slot:!0});var q=g(p);h=u(q,"ION-BUTTON",{"data-svelte-h":!0}),Z(h)!=="svelte-1mwna5t"&&(h.innerHTML=T),k=L(q),b=u(q,"ION-BUTTON",{});var C=g(b);I=le(C,a),C.forEach(s),q.forEach(s),m=L(R),f=u(R,"ION-TITLE",{});var F=g(f);O=le(F,_),F.forEach(s),R.forEach(s),S.forEach(s),y=L(v),D.l(v),N=Ne(),this.h()},h(){E(n,"title","Atrás"),E(n,"alt","Atrás"),E(o,"slot","start"),E(p,"slot","end"),E(e,"translucent","")},m(v,S){z(v,e,S),i(e,t),i(t,o),i(o,n),i(t,d),i(t,p),i(p,h),i(p,k),i(p,b),i(b,I),i(t,m),i(t,f),i(f,O),z(v,y,S),D.m(v,S),z(v,N,S),B||(A=[x(n,"click",l[13]),x(h,"click",l[17])],B=!0)},p(v,S){S[0]&4&&a!==(a=v[2].name+"")&&be(I,a),S[0]&16&&_!==(_=v[4].name+"")&&be(O,_),U===(U=P(v))&&D?D.p(v,S):(D.d(1),D=U(v),D&&(D.c(),D.m(N.parentNode,N)))},d(v){v&&(s(e),s(y),s(N)),D.d(v),B=!1,De(A)}}}function Bn(l){let e,t,o,n=l[2]&&Ot(l);return{c(){e=w(),n&&n.c(),t=Ne(),this.h()},l(r){qt("svelte-kn0kph",document.head).forEach(s),e=L(r),n&&n.l(r),t=Ne(),this.h()},h(){document.title="Rutaflow - Detalles de ruta"},m(r,d){z(r,e,d),n&&n.m(r,d),z(r,t,d),o=!0},p(r,d){r[2]?n?(n.p(r,d),d[0]&4&&Xe(n,1)):(n=Ot(r),n.c(),Xe(n,1),n.m(t.parentNode,t)):n&&(Gt(),et(n,1,1,()=>{n=null}),zt())},i(r){o||(Xe(n),o=!0)},o(r){et(n),o=!1},d(r){r&&(s(e),s(t)),n&&n.d(r)}}}function ke(l){let e="#ffffff";return l.status==="pending"?e="#f2e300":l.status==="completed"&&(e="#44d900"),e}function Ue(l){let e="";return l=="pending"?e="Pendiente":l=="completed"&&(e="Completado"),e}function He(l){l.slice(0,1)==="#"&&(l=l.slice(1)),l.length===3&&(l=l.split("").map(function(r){return r+r}).join(""));const e=parseInt(l.substr(0,2),16),t=parseInt(l.substr(2,2),16),o=parseInt(l.substr(4,2),16);return(e*299+t*587+o*114)/1e3>=128?"#414040":"#fff"}function ot(l,e){let t=new FormData;return t.append("id_route",l),t.append("status",e),fetch("https://app.rutaflow.com/api/admin/route/change_status.php",{method:"POST",body:t}).then(o=>o.json()).then(o=>{}).catch(o=>{console.error("Error fetching data:",o)}),""}const Pn=l=>l.img;function Mn(l,e,t){let o,n;pt(l,Qt,C=>t(16,o=C)),pt(l,Ye,C=>t(7,n=C));var r=this&&this.__awaiter||function(C,F,j,J){function X(ce){return ce instanceof j?ce:new j(function(_e){_e(ce)})}return new(j||(j=Promise))(function(ce,_e){function me(ae){try{te(J.next(ae))}catch(ge){_e(ge)}}function ve(ae){try{te(J.throw(ae))}catch(ge){_e(ge)}}function te(ae){ae.done?ce(ae.value):X(ae.value).then(me,ve)}te((J=J.apply(C,F||[])).next())})};let{routeId:d}=e,{driverId:p}=e,h=new Object,T=[],k={},b={},a;const I=()=>r(void 0,void 0,void 0,function*(){yield m(d),a.complete()});function m(C){const F=new FormData;F.append("id_route",C),fetch("https://app.rutaflow.com/api/admin/report/seguimiento_list.php",{method:"POST",body:F}).then(j=>j.json()).then(j=>{t(4,k=j.data.seguimiento_list[0]),t(3,T=j.data.event_list),t(5,b=j.data.checklist)}).catch(j=>{console.error("Error fetching data:",j)})}const f=C=>new Promise((F,j)=>{const J=new FormData;J.append("id_route",C.id_route),J.append("id_event",C.id_event),fetch("https://app.rutaflow.com/api/admin/evidence/evidence_by_event.php",{method:"POST",body:J}).then(X=>X.json()).then(X=>{F(X.data.event_evidence[0])}).catch(X=>{console.error("Error fetching data:",X),j(X)})}),_=(C,F)=>{f(C).then(j=>{C.client_name=k.client_name,j&&(C.img=j.img,C.driver_comments=j.driver_comments,C.comments=j.comments),ze("modal-delivery-info",Nn,{delivery:C,isLast:F}).then(J=>{})})},O=(C,F,j)=>{var J=!1;return ze("modal-checklist",Mt,{checklist:C,driverId:F,routeId:j,isLast:J}).then(X=>{}),ot(j,"checklist"),""},y=(C,F)=>(ze("modal-expense",Cn,{routeName:C,routeId:F}).then(j=>{}),""),N=C=>{if(C.tracking_type=="subscription"){if(C.subscriber_info&&C.payment_type==="cash"&&new Date(C.subscriber_info.payment_next)<new Date)return!0}else if(C.tracking_type=="ecommerce"&&Number(C.payment_pending)>0)return!0;return!1},B=()=>{h.id_driver?Be(`/drivers/${h.id_driver}`):Be("/drivers/me")},A=(C,F)=>r(void 0,void 0,void 0,function*(){yield(yield Je.create({header:C||"Error",message:F||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()});function P(C){return C===T.length-1}const U=()=>y(k.name,d);function D(C){Ie[C?"unshift":"push"](()=>{a=C,t(6,a)})}const v=(C,F)=>_(C,P(F));function S(C){Ie[C?"unshift":"push"](()=>{a=C,t(6,a)})}const R=(C,F)=>_(C,P(F));function M(C){Ie[C?"unshift":"push"](()=>{a=C,t(6,a)})}const q=C=>{const F=T.findIndex(_e=>_e.id_event===C.id_event),j=F===0,J=F>0?T[F-1]:null,X=j||J&&J.img!==null,ce=C.img!==null&&C.img!=="";X||j&&!ce?_(C):A("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")};return l.$$set=C=>{"routeId"in C&&t(0,d=C.routeId),"driverId"in C&&t(1,p=C.driverId)},l.$$.update=()=>{l.$$.dirty[0]&65541&&(t(0,{routeId:d,driverId:p}=o.params,d,(t(1,p),t(16,o),t(2,h),t(0,d))),t(2,h=JSON.parse(localStorage.getItem("userSession"))),h?h.id_user&&(h.type=="admin"||h.type=="super")?(Be(`/drivers/me/routes/${d}`),m(d)):h.id_user&&h.id_driver&&(m(d),Be(`/drivers/${h.id_driver}/routes/${d}`)):Be("/"))},[d,p,h,T,k,b,a,n,I,_,O,y,N,B,A,P,o,U,D,v,S,R,M,q]}class Vn extends je{constructor(e){super(),Ve(this,e,Mn,Bn,Fe,{routeId:0,driverId:1},null,[-1,-1])}}export{Vn as component};

import{Z as dt,s as We,e as s,j as w,b as c,q as m,d as te,h as a,m as L,v,i as Y,w as o,x as ue,n as ze,z as Pe,_ as xt,B as N,o as Ze,k as Me,$ as _t,t as ve,r as ge,f as J,a0 as $t,a1 as Qe,A as Se,y as Le,a2 as en,a3 as Ke,a4 as tn,a5 as nn,l as on,p as ln,F as rn}from"../chunks/index.CdEBkEwf.js";import{S as Je,i as Ye,t as it,a as st,c as an,b as sn,d as cn,m as un,e as fn,g as dn}from"../chunks/index.c2pjNB5R.js";import{e as Be,u as xe,d as $e,a as _n,b as hn,c as pn,i as Wt,f as mn,g as Jt,h as vn,j as ct,k as gn,m as Yt,s as ht,n as Re,o as bn,q as En,t as In,r as kn,v as On,w as Nn,x as Tn,y as Cn,p as yn}from"../chunks/index.D4srSoNc.js";import"../chunks/index-48209844.IIRtDZyg.js";import{m as et,D as rt,a as je,I as wn}from"../chunks/IonPage.v1T0_FOl.js";import{q as Ln,t as zn}from"../chunks/ion-modal.CsJaVgKZ.js";import{g as Fe}from"../chunks/entry.HFVLD9c0.js";const An=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global,Mn=(r,e)=>{if(!customElements.get(r)){class t extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const n={};for(const i of this.attributes)n[i.name]=i.value;new e({target:this.shadowRoot,props:n})}}customElements.define(r,t)}},Sn=function(r){return document.createElement(r).constructor!==HTMLElement},Dn=(r,e)=>{Sn(r)||Mn(r,e)},Ue=async(r,e,t)=>{Ln(),zn(),Dn(r,e);const l=await et.create({component:r,componentProps:t});return l.present(),await l.onWillDismiss()};let Ge=dt({km_inicial:[],gas_inicial:[],km_final:[],gas_final:[]}),Qt=dt({flag:[]});function Pn(r){let e,t,l,n,i="Cancelar",d,u,_="Captura de Km/Gas",C,g,h,f="Confirmar",p,E,T,y,U,A,F;return{c(){e=s("ion-header"),t=s("ion-toolbar"),l=s("ion-buttons"),n=s("ion-button"),n.textContent=i,d=w(),u=s("ion-title"),u.textContent=_,C=w(),g=s("ion-buttons"),h=s("ion-button"),h.textContent=f,p=w(),E=s("ion-content"),T=s("ion-item"),y=s("ion-input"),this.h()},l(K){e=c(K,"ION-HEADER",{translucent:!0});var V=m(e);t=c(V,"ION-TOOLBAR",{});var S=m(t);l=c(S,"ION-BUTTONS",{slot:!0});var H=m(l);n=c(H,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),te(n)!=="svelte-17pq4f4"&&(n.textContent=i),H.forEach(a),d=L(S),u=c(S,"ION-TITLE",{"data-svelte-h":!0}),te(u)!=="svelte-1yhkaq7"&&(u.textContent=_),C=L(S),g=c(S,"ION-BUTTONS",{slot:!0});var k=m(g);h=c(k,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),te(h)!=="svelte-cm6j4s"&&(h.textContent=f),k.forEach(a),S.forEach(a),V.forEach(a),p=L(K),E=c(K,"ION-CONTENT",{fullscreen:!0});var M=m(E);T=c(M,"ION-ITEM",{});var P=m(T);y=c(P,"ION-INPUT",{class:!0,inputmode:!0,pattern:!0,type:!0,placeholder:!0,value:!0,required:!0});var D=m(y);D.forEach(a),P.forEach(a),M.forEach(a),this.h()},h(){v(n,"color","medium"),v(l,"slot","start"),v(h,"strong",""),v(g,"slot","end"),v(e,"translucent",""),v(y,"class","fin-km"),v(y,"inputmode","numeric"),v(y,"pattern","[0-9]*"),v(y,"type","number"),v(y,"placeholder",U="Ingresa "+r[0]+" actual"),v(y,"value",r[1]),v(y,"required",""),v(E,"fullscreen","")},m(K,V){Y(K,e,V),o(e,t),o(t,l),o(l,n),o(t,d),o(t,u),o(t,C),o(t,g),o(g,h),Y(K,p,V),Y(K,E,V),o(E,T),o(T,y),A||(F=[ue(n,"click",r[2]),ue(h,"click",r[3]),ue(y,"input",r[4])],A=!0)},p(K,[V]){V&1&&U!==(U="Ingresa "+K[0]+" actual")&&v(y,"placeholder",U),V&2&&v(y,"value",K[1])},i:ze,o:ze,d(K){K&&(a(e),a(p),a(E)),A=!1,Pe(F)}}}function Hn(r,e,t){const l=xt();let n=document.querySelector("ion-modal"),i=n.componentProps.data_type;n.componentProps.isLast;let d;Qt.subscribe(h=>{i=h.flag[0],i=="km_final"||i=="km_inicial"?t(0,d="kilometraje"):t(0,d="litros de gasolina")});let u=0;function _(){et.dismiss()}function C(){l("modalResult",{data:"Your data",role:"confirm"}),i=="km_inicial"?Ge.update(f=>({...f,km_inicial:[u]})):i=="gas_inicial"?Ge.update(f=>({...f,gas_inicial:[u]})):i=="km_final"?Ge.update(f=>({...f,km_final:[u]})):i=="gas_final"&&Ge.update(f=>({...f,gas_final:[u]})),_()}return[d,u,_,C,h=>t(1,u=h.target.value)]}class Bn extends Je{constructor(e){super(),Ye(this,e,Hn,Pn,We,{})}}const at=dt({items:[],checkedIndices:[],mandatory:[]});function vt(r,e,t){const l=r.slice();return l[55]=e[t],l[56]=e,l[57]=t,l}function Rn(r){let e,t,l,n,i,d="Kilometraje inicial",u,_,C=r[0]?r[0]+" km.":"Cargar km",g,h,f,p,E,T,y,U="Gasolina inicial (litros)",A,F,K=r[1]?r[1]+" litros":"Cargar gas",V,S,H,k;return S=_t(r[21][0]),{c(){e=s("ion-item"),t=s("ion-label"),l=s("input"),n=w(),i=s("p"),i.textContent=d,u=w(),_=s("ion-button"),g=ve(C),h=w(),f=s("ion-item"),p=s("ion-label"),E=s("input"),T=w(),y=s("p"),y.textContent=U,A=w(),F=s("ion-button"),V=ve(K),this.h()},l(M){e=c(M,"ION-ITEM",{});var P=m(e);t=c(P,"ION-LABEL",{style:!0});var D=m(t);l=c(D,"INPUT",{id:!0,style:!0,type:!0}),n=L(D),i=c(D,"P",{style:!0,"data-svelte-h":!0}),te(i)!=="svelte-88twxi"&&(i.textContent=d),D.forEach(a),u=L(P),_=c(P,"ION-BUTTON",{fill:!0,size:!0,class:!0,"aria-selected":!0});var B=m(_);g=ge(B,C),B.forEach(a),P.forEach(a),h=L(M),f=c(M,"ION-ITEM",{});var j=m(f);p=c(j,"ION-LABEL",{style:!0});var q=m(p);E=c(q,"INPUT",{id:!0,style:!0,type:!0}),T=L(q),y=c(q,"P",{style:!0,"data-svelte-h":!0}),te(y)!=="svelte-1ux30eb"&&(y.textContent=U),q.forEach(a),A=L(j),F=c(j,"ION-BUTTON",{fill:!0,class:!0,size:!0,style:!0});var ee=m(F);V=ge(ee,K),ee.forEach(a),j.forEach(a),this.h()},h(){J(l,"id","chkbox-km-ini"),N(l,"pointer-events","auto"),J(l,"type","checkbox"),l.required=!0,N(i,"margin-left","10px"),N(t,"display","flex"),v(_,"fill","outline"),v(_,"size","small"),v(_,"class","loadKmInicial"),v(_,"aria-selected",""),J(E,"id","chkbox-gas-ini"),N(E,"pointer-events","auto"),J(E,"type","checkbox"),E.required=!0,N(y,"margin-left","10px"),N(p,"display","flex"),v(F,"fill","outline"),v(F,"class","loadGasInicial"),v(F,"size","small"),N(F,"height","16px "),S.p(l,E)},m(M,P){Y(M,e,P),o(e,t),o(t,l),l.checked=~(r[4]||[]).indexOf(l.__value),r[28](l),o(t,n),o(t,i),o(e,u),o(e,_),o(_,g),Y(M,h,P),Y(M,f,P),o(f,p),o(p,E),r[30](E),E.checked=~(r[4]||[]).indexOf(E.__value),o(p,T),o(p,y),o(f,A),o(f,F),o(F,V),H||(k=[ue(l,"change",r[27]),ue(_,"click",r[29]),ue(E,"change",r[31]),ue(F,"click",r[32])],H=!0)},p(M,P){P[0]&16&&(l.checked=~(M[4]||[]).indexOf(l.__value)),P[0]&1&&C!==(C=M[0]?M[0]+" km.":"Cargar km")&&Le(g,C),P[0]&16&&(E.checked=~(M[4]||[]).indexOf(E.__value)),P[0]&2&&K!==(K=M[1]?M[1]+" litros":"Cargar gas")&&Le(V,K)},d(M){M&&(a(e),a(h),a(f)),r[28](null),r[30](null),S.r(),H=!1,Pe(k)}}}function Un(r){let e,t,l,n,i,d="Kilometraje final",u,_,C=r[2]?r[2]+" km.":"Cargar km",g,h,f,p,E,T,y,U="Gasolina final (litros)",A,F,K=r[3]?r[3]+" litros":"Cargar gas",V,S,H,k;return S=_t(r[21][0]),{c(){e=s("ion-item"),t=s("ion-label"),l=s("input"),n=w(),i=s("p"),i.textContent=d,u=w(),_=s("ion-button"),g=ve(C),h=w(),f=s("ion-item"),p=s("ion-label"),E=s("input"),T=w(),y=s("p"),y.textContent=U,A=w(),F=s("ion-button"),V=ve(K),this.h()},l(M){e=c(M,"ION-ITEM",{});var P=m(e);t=c(P,"ION-LABEL",{style:!0});var D=m(t);l=c(D,"INPUT",{id:!0,style:!0,type:!0}),n=L(D),i=c(D,"P",{style:!0,"data-svelte-h":!0}),te(i)!=="svelte-ccmu71"&&(i.textContent=d),D.forEach(a),u=L(P),_=c(P,"ION-BUTTON",{fill:!0,size:!0,class:!0,"aria-selected":!0});var B=m(_);g=ge(B,C),B.forEach(a),P.forEach(a),h=L(M),f=c(M,"ION-ITEM",{});var j=m(f);p=c(j,"ION-LABEL",{style:!0});var q=m(p);E=c(q,"INPUT",{id:!0,style:!0,type:!0}),T=L(q),y=c(q,"P",{style:!0,"data-svelte-h":!0}),te(y)!=="svelte-wsoyd2"&&(y.textContent=U),q.forEach(a),A=L(j),F=c(j,"ION-BUTTON",{fill:!0,size:!0,class:!0});var ee=m(F);V=ge(ee,K),ee.forEach(a),j.forEach(a),this.h()},h(){J(l,"id","chkbox-km-fin"),N(l,"pointer-events","auto"),J(l,"type","checkbox"),l.required=!0,N(i,"margin-left","10px"),N(t,"display","flex"),v(_,"fill","outline"),v(_,"size","small"),v(_,"class","loadKmInicial"),v(_,"aria-selected",""),J(E,"id","chkbox-gas-fin"),N(E,"pointer-events","auto"),J(E,"type","checkbox"),E.required=!0,N(y,"margin-left","10px"),N(p,"display","flex"),v(F,"fill","outline"),v(F,"size","small"),v(F,"class","loadGasInicial"),S.p(l,E)},m(M,P){Y(M,e,P),o(e,t),o(t,l),l.checked=~(r[4]||[]).indexOf(l.__value),r[22](l),o(t,n),o(t,i),o(e,u),o(e,_),o(_,g),Y(M,h,P),Y(M,f,P),o(f,p),o(p,E),E.checked=~(r[4]||[]).indexOf(E.__value),r[25](E),o(p,T),o(p,y),o(f,A),o(f,F),o(F,V),H||(k=[ue(l,"change",r[20]),ue(_,"click",r[23]),ue(E,"change",r[24]),ue(F,"click",r[26])],H=!0)},p(M,P){P[0]&16&&(l.checked=~(M[4]||[]).indexOf(l.__value)),P[0]&4&&C!==(C=M[2]?M[2]+" km.":"Cargar km")&&Le(g,C),P[0]&16&&(E.checked=~(M[4]||[]).indexOf(E.__value)),P[0]&8&&K!==(K=M[3]?M[3]+" litros":"Cargar gas")&&Le(V,K)},d(M){M&&(a(e),a(h),a(f)),r[22](null),r[25](null),S.r(),H=!1,Pe(k)}}}function Vn(r){let e=[],t=new Map,l,n=Be(r[13]);const i=d=>d[55].id_checklist_event;for(let d=0;d<n.length;d+=1){let u=vt(r,n,d),_=i(u);t.set(_,e[d]=gt(_,u))}return{c(){for(let d=0;d<e.length;d+=1)e[d].c();l=Me()},l(d){for(let u=0;u<e.length;u+=1)e[u].l(d);l=Me()},m(d,u){for(let _=0;_<e.length;_+=1)e[_]&&e[_].m(d,u);Y(d,l,u)},p(d,u){u[0]&407664&&(n=Be(d[13]),e=xe(e,u,i,1,d,n,t,l.parentNode,$e,gt,l,vt))},d(d){d&&a(l);for(let u=0;u<e.length;u+=1)e[u].d(d)}}}function Fn(r){let e,t=(r[12][r[55].id_checklist_event]?r[12][r[55].id_checklist_event]:"Cargar evidencia")+"",l;return{c(){e=s("label"),l=ve(t),this.h()},l(n){e=c(n,"LABEL",{for:!0,class:!0});var i=m(e);l=ge(i,t),i.forEach(a),this.h()},h(){J(e,"for","chklist-"+r[55].id_checklist_event),J(e,"class","button-label svelte-1ruehls")},m(n,i){Y(n,e,i),o(e,l)},p(n,i){i[0]&4096&&t!==(t=(n[12][n[55].id_checklist_event]?n[12][n[55].id_checklist_event]:"Cargar evidencia")+"")&&Le(l,t)},d(n){n&&a(e)}}}function jn(r){let e;return{c(){e=s("ion-spinner"),this.h()},l(t){e=c(t,"ION-SPINNER",{name:!0,class:!0}),m(e).forEach(a),this.h()},h(){v(e,"name","dots"),v(e,"class","button-spinner svelte-1ruehls")},m(t,l){Y(t,e,l)},p:ze,d(t){t&&a(e)}}}function gt(r,e){let t,l,n,i=e[55],d,u,_=e[55].item+"",C,g,h,f=e[55].mandatory=="1"?" * ":"",p,E,T,y,U,A,F,K,V,S;const H=()=>e[34](n,i),k=()=>e[34](null,i);function M(){return e[35](e[55])}function P(q,ee){return q[11][q[55].id_checklist_event]?jn:Fn}let D=P(e),B=D(e);function j(...q){return e[37](e[55],...q)}return K=_t(e[21][0]),{key:r,first:null,c(){t=s("ion-item"),l=s("ion-label"),n=s("input"),d=w(),u=s("p"),C=ve(_),g=w(),h=s("b"),p=ve(f),E=w(),T=s("ion-button"),y=s("div"),B.c(),U=w(),A=s("input"),F=w(),this.h()},l(q){t=c(q,"ION-ITEM",{});var ee=m(t);l=c(ee,"ION-LABEL",{style:!0});var ne=m(l);n=c(ne,"INPUT",{id:!0,style:!0,type:!0}),d=L(ne),u=c(ne,"P",{style:!0});var oe=m(u);C=ge(oe,_),g=L(oe),oe.forEach(a),h=c(ne,"B",{style:!0});var fe=m(h);p=ge(fe,f),fe.forEach(a),ne.forEach(a),E=L(ee),T=c(ee,"ION-BUTTON",{fill:!0,class:!0,size:!0});var se=m(T);y=c(se,"DIV",{class:!0});var ae=m(y);B.l(ae),U=L(ae),A=c(ae,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0,capture:!0}),ae.forEach(a),se.forEach(a),F=L(ee),ee.forEach(a),this.h()},h(){J(n,"id",`chkbox-${e[55].id_checklist_event}`),N(n,"pointer-events","auto"),J(n,"type","checkbox"),n.__value=e[55].id_checklist_event,$t(n,n.__value),n.required=!0,N(u,"margin-left","10px"),N(h,"margin-left","5px"),N(l,"display","flex"),N(A,"display","none"),J(A,"id","chklist-"+e[55].id_checklist_event),J(A,"name","fileToUpload"),J(A,"type","file"),J(A,"accept","image/*"),J(A,"capture","environment"),J(y,"class","button-content svelte-1ruehls"),v(T,"fill","outline"),v(T,"class","loadEvidence svelte-1ruehls"),v(T,"size","small"),K.p(n),this.first=t},m(q,ee){Y(q,t,ee),o(t,l),o(l,n),n.checked=~(e[4]||[]).indexOf(n.__value),H(),o(l,d),o(l,u),o(u,C),o(u,g),o(l,h),o(h,p),o(t,E),o(t,T),o(T,y),B.m(y,null),o(y,U),o(y,A),e[36](A),o(t,F),V||(S=[ue(n,"change",e[33]),ue(n,"change",M),ue(A,"change",j)],V=!0)},p(q,ee){e=q,ee[0]&16&&(n.checked=~(e[4]||[]).indexOf(n.__value)),i!==e[55]&&(k(),i=e[55],H()),D===(D=P(e))&&B?B.p(e,ee):(B.d(1),B=D(e),B&&(B.c(),B.m(y,U)))},d(q){q&&a(t),k(),B.d(),e[36](null),K.r(),V=!1,Pe(S)}}}function qn(r){let e,t,l,n,i="Cancelar",d,u,_="REQUERIMIENTOS DE RUTA",C,g,h,f,p,E,T,y="Confirmar",U,A;function F(H,k){return H[14]?Un:Rn}let V=F(r)(r),S=r[13]&&Vn(r);return{c(){e=s("ion-header"),t=s("ion-toolbar"),l=s("ion-buttons"),n=s("ion-button"),n.textContent=i,d=w(),u=s("ion-title"),u.textContent=_,C=w(),g=s("ion-content"),h=s("ion-list"),V.c(),f=w(),S&&S.c(),p=w(),E=s("ion-footer"),T=s("ion-button"),T.textContent=y,this.h()},l(H){e=c(H,"ION-HEADER",{translucent:!0});var k=m(e);t=c(k,"ION-TOOLBAR",{});var M=m(t);l=c(M,"ION-BUTTONS",{slot:!0});var P=m(l);n=c(P,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),te(n)!=="svelte-1dnmkxs"&&(n.textContent=i),P.forEach(a),d=L(M),u=c(M,"ION-TITLE",{"data-svelte-h":!0}),te(u)!=="svelte-19bar5p"&&(u.textContent=_),M.forEach(a),k.forEach(a),C=L(H),g=c(H,"ION-CONTENT",{fullscreen:!0});var D=m(g);h=c(D,"ION-LIST",{});var B=m(h);V.l(B),f=L(B),S&&S.l(B),B.forEach(a),D.forEach(a),p=L(H),E=c(H,"ION-FOOTER",{});var j=m(E);T=c(j,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),te(T)!=="svelte-g82qqw"&&(T.textContent=y),j.forEach(a),this.h()},h(){v(n,"color","medium"),v(l,"slot","start"),v(e,"translucent",""),v(g,"fullscreen",""),v(T,"fill","outline"),v(T,"color","tertiary"),v(T,"strong",""),N(T,"width","99%"),N(T,"height","auto")},m(H,k){Y(H,e,k),o(e,t),o(t,l),o(l,n),o(t,d),o(t,u),Y(H,C,k),Y(H,g,k),o(g,h),V.m(h,null),o(h,f),S&&S.m(h,null),Y(H,p,k),Y(H,E,k),o(E,T),U||(A=[ue(n,"click",r[15]),ue(T,"click",r[16])],U=!0)},p(H,k){V.p(H,k),H[13]&&S.p(H,k)},i:ze,o:ze,d(H){H&&(a(e),a(C),a(g),a(p),a(E)),V.d(),S&&S.d(),U=!1,Pe(A)}}}function ut(r,e){if(typeof r=="object"&&r!==null||Array.isArray(r)){if(Array.isArray(r))return r.map(t=>ut(t,e)).flat();{const t=Object.keys(r);let l;return e=="id_checklist_event"?l=t.filter(i=>i.toLowerCase().includes("id_checklist_event")).map(i=>r[i]):e=="mandatory"?l=t.filter(i=>i.toLowerCase().includes("mandatory")).map(i=>r[i]):(console.error("Tipo de dato no reconocido."),l=!1),l}}else return console.error("Invalid input. Please provide a valid object or array."),[]}function Gn(r,e,t){let l=rt,n=document.querySelector("ion-modal");const i=n.componentProps.checklist,d=n.componentProps.driverId,u=n.componentProps.routeId,_=n.componentProps.isLast;let C,g,h,f,p=[],E=null,T={},y,U,A,F,K={},V=new Object,S={},H={};Ze(()=>{V=JSON.parse(localStorage.getItem("userSession")),_?console.log("Último checklist"):at.update(I=>(I.mandatory=ut(i,"mandatory"),I.items=ut(i,"id_checklist_event"),I))});function k(I){t(11,K[I]=!0,K)}const M=async()=>{await(await je.create({header:"Datos o checklist incompletos",message:"Carga la evidencia requerida y marca todas las casillas para confirmar",buttons:[{text:"Cerrar"}]})).present()},P=async()=>{await(await je.create({header:"Datos capturados",message:"El kilometraje y gasolina final fueron registrados correctamente, espere aprobación para finalizar ruta",buttons:[{text:"Cerrar"}]})).present()},D=async I=>{await(await je.create({header:"Datos inválidos",message:I=="km"?"Llena correctamente el campo de kilometraje inicial":"Llena correctamente el campo de gasolina inicial",buttons:[{text:"Cerrar"}]})).present()},B=()=>{et.dismiss(),d?Fe(`/drivers/${d}`):Fe("/drivers/me")},j=()=>{if(_){var I=fe(h,"km"),X=fe(f,"gas");let re=new FormData;re.append("km_final",I),re.append("gas_final",X),re.append("id_route",u),re=de(re),I&&X?(B(),fetch(`${l}api/admin/checklist/add_evidence.php`,{method:"POST",body:re}).then(pe=>pe.json()).then(pe=>{P()}).catch(pe=>{console.error("Error fetching data:",pe)})):M()}else{var Z=fe(C,"km"),Q=fe(g,"gas");at.update(re=>{re.items;const pe=re.mandatory;if(re.items.filter((me,_e)=>re.mandatory[_e]==="1").every(me=>re.checkedIndices.includes(me))&&Z&&Q){B();let me=new FormData;me=de(me),me.append("km_inicial",Z),me.append("gas_inicial",Q),me.append("id_route",u);for(const _e in S)if(S.hasOwnProperty(_e)){const{img:He,img_id:qe}=S[_e];me.append(`selectedImages[${_e}][img]`,He),me.append(`selectedImages[${_e}][img_id]`,qe)}fetch(`${l}api/admin/checklist/add_evidence.php`,{method:"POST",body:me}).then(_e=>_e.json()).then(_e=>{pe&&pe.some(He=>He==="1")?oe(u,"checklist-pending"):oe(u,"enroute")}).catch(_e=>{console.error("Error fetching data:",_e)})}else if(!pe&&Z&&Q){let me=new FormData;me.append("km_inicial",Z),me.append("gas_inicial",Q),me=de(me),fetch(`${l}api/admin/checklist/add_evidence.php`,{method:"POST",body:me}).then(_e=>_e.json()).then(_e=>{oe(u,"enroute")}).catch(_e=>{console.error("Error fetching data:",_e)})}else M();return re})}Ee()},q=async(I,X)=>{k(X);const Q=I.target.files[0],re=await ee(Q);if(re){let pe=new FormData;pe.append("fileToUpload",re),pe=de(pe);try{const ce=await fetch(`${l}api/admin/manager/upload_img_driver.php`,{method:"POST",body:pe});if(ce.ok){const Ce=await ce.json();S={...S,[X]:{img:Ce.img,img_id:Ce.img_id}},t(12,H={...H,[X]:Ce.filename}),ne(X),t(6,T[X].checked=!0,T),t(11,K[X]=!1,K)}else console.error("File upload failed:",ce.statusText)}catch(ce){console.error("Error during file upload:",ce)}}},ee=async I=>new Promise(X=>{const Z=new Image;Z.src=URL.createObjectURL(I),Z.onload=()=>{const Q=document.createElement("canvas"),re=Q.getContext("2d"),pe=800,ce=600;let Ce=Z.width,me=Z.height;Ce>pe&&(me*=pe/Ce,Ce=pe),me>ce&&(Ce*=ce/me,me=ce),Q.width=Ce,Q.height=me,re.drawImage(Z,0,0,Ce,me),Q.toBlob(_e=>{X(_e),URL.revokeObjectURL(Z.src),re.clearRect(0,0,Q.width,Q.height)},"image/jpeg",.7)}}),ne=I=>{at.update(X=>(X.checkedIndices.indexOf(I)===-1?X.checkedIndices.push(I):console.error(`ID ${I} is already checked.`),X.items.forEach(Q=>{Q.id_checklist_event===I&&(Q.checked=!0)}),X))};function oe(I,X){let Z=new FormData;Z.append("id_route",I),Z.append("status",X),Z=de(Z),fetch(`${l}api/admin/route/change_status.php`,{method:"POST",body:Z}).then(Q=>Q.json()).then(Q=>{}).catch(Q=>{console.error("Error fetching data:",Q)})}function fe(I,X){return/^\d+$/.test(I)?parseInt(I,10):(D(X),null)}function se(I,X){ae(X),n.componentProps.data_type=X,Ue("modal-gas-km",Bn,{r:X}).then(()=>{Ge.subscribe(Z=>{Ne(Z,X)})})}function ae(I){Qt.update(X=>({...X,flag:[I]}))}function Ne(I,X){t(0,C=I.km_inicial?I.km_inicial:null),t(1,g=I.gas_inicial?I.gas_inicial:null),t(2,h=I.km_final?I.km_final:null),t(3,f=I.gas_final?I.gas_final:null),X=="km_inicial"&&y&&t(7,y.checked=!0,y),X=="gas_inicial"&&U&&t(8,U.checked=!0,U),X=="km_final"&&A&&t(9,A.checked=!0,A),X=="gas_final"&&F&&t(10,F.checked=!0,F)}function Ee(){Ge.set({km_inicial:[],gas_inicial:[],km_final:[],gas_final:[]})}function de(I){return I.append("token",V.token),I.append("id_user_over",V.id_user),I}const Ie=[[]];function Te(){p=Qe(Ie[0],this.__value,this.checked),t(4,p)}function Oe(I){Se[I?"unshift":"push"](()=>{A=I,t(9,A)})}const ke=I=>se(I,"km_final");function he(){p=Qe(Ie[0],this.__value,this.checked),t(4,p)}function ye(I){Se[I?"unshift":"push"](()=>{F=I,t(10,F)})}const we=I=>se(I,"gas_final");function be(){p=Qe(Ie[0],this.__value,this.checked),t(4,p)}function ie(I){Se[I?"unshift":"push"](()=>{y=I,t(7,y)})}const x=I=>se(I,"km_inicial");function le(I){Se[I?"unshift":"push"](()=>{U=I,t(8,U)})}function O(){p=Qe(Ie[0],this.__value,this.checked),t(4,p)}const z=I=>se(I,"gas_inicial");function b(){p=Qe(Ie[0],this.__value,this.checked),t(4,p)}function R(I,X){Se[I?"unshift":"push"](()=>{T[X.id_checklist_event]=I,t(6,T)})}const G=I=>ne(I.id_checklist_event);function W(I){Se[I?"unshift":"push"](()=>{E=I,t(5,E)})}return[C,g,h,f,p,E,T,y,U,A,F,K,H,i,_,B,j,q,ne,se,Te,Ie,Oe,ke,he,ye,we,be,ie,x,le,O,z,b,R,G,W,(I,X)=>q(X,I.id_checklist_event)]}class Zt extends Je{constructor(e){super(),Ye(this,e,Gn,qn,We,{},null,[-1,-1])}}function bt(r,e,t){const l=r.slice();return l[50]=e[t],l[52]=t,l}function Kn(r){let e,t,l="Confirmar",n,i;return{c(){e=s("ion-buttons"),t=s("ion-button"),t.textContent=l,this.h()},l(d){e=c(d,"ION-BUTTONS",{slot:!0});var u=m(e);t=c(u,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),te(t)!=="svelte-1ida0il"&&(t.textContent=l),u.forEach(a),this.h()},h(){v(t,"strong",""),v(e,"slot","end")},m(d,u){Y(d,e,u),o(e,t),n||(i=ue(t,"click",r[21]),n=!0)},p:ze,d(d){d&&a(e),n=!1,i()}}}function Xn(r){let e,t,l,n,i,d="Teléfono de Negocio",u,_,C=r[12].client_phone+"",g;return{c(){e=s("ion-item"),t=s("ion-icon"),l=w(),n=s("ion-label"),i=s("p"),i.textContent=d,u=w(),_=s("h2"),g=ve(C),this.h()},l(h){e=c(h,"ION-ITEM",{href:!0});var f=m(e);t=c(f,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=L(f),n=c(f,"ION-LABEL",{class:!0});var p=m(n);i=c(p,"P",{"data-svelte-h":!0}),te(i)!=="svelte-1u5l7fz"&&(i.textContent=d),u=L(p),_=c(p,"H2",{});var E=m(_);g=ge(E,C),E.forEach(a),p.forEach(a),f.forEach(a),this.h()},h(){v(t,"icon",hn),v(t,"slot","start"),v(n,"class","ion-text-wrap"),v(e,"href","tel:"+r[12].client_phone)},m(h,f){Y(h,e,f),o(e,t),o(e,l),o(e,n),o(n,i),o(n,u),o(n,_),o(_,g)},p:ze,d(h){h&&a(e)}}}function Wn(r){let e,t,l,n,i,d="Domicilio Alternativo",u,_,C=r[12].line2+"",g,h,f;return{c(){e=s("ion-item"),t=s("ion-icon"),l=w(),n=s("ion-label"),i=s("p"),i.textContent=d,u=w(),_=s("h2"),g=ve(C),h=w(),f=s("ion-icon"),this.h()},l(p){e=c(p,"ION-ITEM",{href:!0});var E=m(e);t=c(E,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=L(E),n=c(E,"ION-LABEL",{class:!0});var T=m(n);i=c(T,"P",{"data-svelte-h":!0}),te(i)!=="svelte-1ub9uzw"&&(i.textContent=d),u=L(T),_=c(T,"H2",{});var y=m(_);g=ge(y,C),y.forEach(a),T.forEach(a),h=L(E),f=c(E,"ION-ICON",{icon:!0,slot:!0}),m(f).forEach(a),E.forEach(a),this.h()},h(){v(t,"icon",ht),v(t,"slot","start"),v(n,"class","ion-text-wrap"),v(f,"icon",Re),v(f,"slot","end"),v(e,"href","https://www.google.com/maps/searhc/?api=1&query="+r[12].line2)},m(p,E){Y(p,e,E),o(e,t),o(e,l),o(e,n),o(n,i),o(n,u),o(n,_),o(_,g),o(e,h),o(e,f)},p:ze,d(p){p&&a(e)}}}function Jn(r){let e,t,l,n,i,d="Domicilio",u,_,C=r[12].line1+"",g,h,f,p,E=r[12].line2&&r[12].line2.trim().length,T,y=E&&Yn(r);return{c(){e=s("ion-item"),t=s("ion-icon"),l=w(),n=s("ion-label"),i=s("p"),i.textContent=d,u=w(),_=s("h2"),g=ve(C),h=w(),f=s("ion-icon"),p=w(),y&&y.c(),T=Me(),this.h()},l(U){e=c(U,"ION-ITEM",{href:!0});var A=m(e);t=c(A,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=L(A),n=c(A,"ION-LABEL",{class:!0});var F=m(n);i=c(F,"P",{"data-svelte-h":!0}),te(i)!=="svelte-cbm7q1"&&(i.textContent=d),u=L(F),_=c(F,"H2",{});var K=m(_);g=ge(K,C),K.forEach(a),F.forEach(a),h=L(A),f=c(A,"ION-ICON",{icon:!0,slot:!0}),m(f).forEach(a),A.forEach(a),p=L(U),y&&y.l(U),T=Me(),this.h()},h(){v(t,"icon",ht),v(t,"slot","start"),v(n,"class","ion-text-wrap"),v(f,"icon",Re),v(f,"slot","end"),v(e,"href","https://www.google.com/maps/search/?api=1&query="+r[12].line1)},m(U,A){Y(U,e,A),o(e,t),o(e,l),o(e,n),o(n,i),o(n,u),o(n,_),o(_,g),o(e,h),o(e,f),Y(U,p,A),y&&y.m(U,A),Y(U,T,A)},p(U,A){E&&y.p(U,A)},d(U){U&&(a(e),a(p),a(T)),y&&y.d(U)}}}function Yn(r){let e,t,l,n,i,d="Domicilio Alternativo",u,_,C=r[12].line2+"",g,h,f;return{c(){e=s("ion-item"),t=s("ion-icon"),l=w(),n=s("ion-label"),i=s("p"),i.textContent=d,u=w(),_=s("h2"),g=ve(C),h=w(),f=s("ion-icon"),this.h()},l(p){e=c(p,"ION-ITEM",{href:!0});var E=m(e);t=c(E,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=L(E),n=c(E,"ION-LABEL",{class:!0});var T=m(n);i=c(T,"P",{"data-svelte-h":!0}),te(i)!=="svelte-1ub9uzw"&&(i.textContent=d),u=L(T),_=c(T,"H2",{});var y=m(_);g=ge(y,C),y.forEach(a),T.forEach(a),h=L(E),f=c(E,"ION-ICON",{icon:!0,slot:!0}),m(f).forEach(a),E.forEach(a),this.h()},h(){v(t,"icon",ht),v(t,"slot","start"),v(n,"class","ion-text-wrap"),v(f,"icon",Re),v(f,"slot","end"),v(e,"href","https://www.google.com/maps/search/?api=1&query="+r[12].line2)},m(p,E){Y(p,e,E),o(e,t),o(e,l),o(e,n),o(n,i),o(n,u),o(n,_),o(_,g),o(e,h),o(e,f)},p:ze,d(p){p&&a(e)}}}function Et(r){let e,t,l,n,i,d="Contacto del Cliente",u,_,C,g,h=r[16]&&r[16]==="1"&&Qn(r);return{c(){e=s("ion-item"),t=s("ion-icon"),l=w(),n=s("ion-label"),i=s("p"),i.textContent=d,u=w(),_=s("h2"),C=ve(r[6]),g=w(),h&&h.c(),this.h()},l(f){e=c(f,"ION-ITEM",{});var p=m(e);t=c(p,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=L(p),n=c(p,"ION-LABEL",{class:!0});var E=m(n);i=c(E,"P",{"data-svelte-h":!0}),te(i)!=="svelte-1utsyb6"&&(i.textContent=d),u=L(E),_=c(E,"H2",{});var T=m(_);C=ge(T,r[6]),T.forEach(a),E.forEach(a),g=L(p),h&&h.l(p),p.forEach(a),this.h()},h(){v(t,"icon",pn),v(t,"slot","start"),v(n,"class","ion-text-wrap")},m(f,p){Y(f,e,p),o(e,t),o(e,l),o(e,n),o(n,i),o(n,u),o(n,_),o(_,C),o(e,g),h&&h.m(e,null)},p(f,p){p[0]&64&&Le(C,f[6]),f[16]&&f[16]==="1"&&h.p(f,p)},d(f){f&&a(e),h&&h.d()}}}function Qn(r){let e,t=`<ion-icon icon="${bn}" slot="start"></ion-icon>
                        Notificar Cliente`,l,n;return{c(){e=s("ion-button"),e.innerHTML=t,this.h()},l(i){e=c(i,"ION-BUTTON",{fill:!0,style:!0,"data-svelte-h":!0}),te(e)!=="svelte-w3qtwm"&&(e.innerHTML=t),this.h()},h(){v(e,"fill","outline"),N(e,"margin-left","16px")},m(i,d){Y(i,e,d),l||(n=ue(e,"click",r[22]),l=!0)},p:ze,d(i){i&&a(e),l=!1,n()}}}function It(r){let e,t,l,n,i,d="Notas de ubicación",u,_,C;return{c(){e=s("ion-item"),t=s("ion-icon"),l=w(),n=s("ion-label"),i=s("p"),i.textContent=d,u=w(),_=s("h2"),C=ve(r[7]),this.h()},l(g){e=c(g,"ION-ITEM",{});var h=m(e);t=c(h,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=L(h),n=c(h,"ION-LABEL",{class:!0});var f=m(n);i=c(f,"P",{"data-svelte-h":!0}),te(i)!=="svelte-nhm2ft"&&(i.textContent=d),u=L(f),_=c(f,"H2",{});var p=m(_);C=ge(p,r[7]),p.forEach(a),f.forEach(a),h.forEach(a),this.h()},h(){v(t,"icon",Wt),v(t,"slot","start"),v(n,"class","ion-text-wrap")},m(g,h){Y(g,e,h),o(e,t),o(e,l),o(e,n),o(n,i),o(n,u),o(n,_),o(_,C)},p(g,h){h[0]&128&&Le(C,g[7])},d(g){g&&a(e)}}}function Zn(r){let e,t,l,n,i,d="Horarios",u,_,C=r[12].schedule+"",g;return{c(){e=s("ion-item"),t=s("ion-icon"),l=w(),n=s("ion-label"),i=s("p"),i.textContent=d,u=w(),_=s("h2"),g=ve(C),this.h()},l(h){e=c(h,"ION-ITEM",{});var f=m(e);t=c(f,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=L(f),n=c(f,"ION-LABEL",{});var p=m(n);i=c(p,"P",{"data-svelte-h":!0}),te(i)!=="svelte-11q7hm5"&&(i.textContent=d),u=L(p),_=c(p,"H2",{});var E=m(_);g=ge(E,C),E.forEach(a),p.forEach(a),f.forEach(a),this.h()},h(){v(t,"icon",mn),v(t,"slot","start")},m(h,f){Y(h,e,f),o(e,t),o(e,l),o(e,n),o(n,i),o(n,u),o(n,_),o(_,g)},p:ze,d(h){h&&a(e)}}}function xn(r){let e,t,l,n,i,d="Notas del operador",u,_,C=r[12].driver_comments+"",g;return{c(){e=s("ion-item"),t=s("ion-icon"),l=w(),n=s("ion-label"),i=s("p"),i.textContent=d,u=w(),_=s("h2"),g=ve(C),this.h()},l(h){e=c(h,"ION-ITEM",{});var f=m(e);t=c(f,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=L(f),n=c(f,"ION-LABEL",{});var p=m(n);i=c(p,"P",{"data-svelte-h":!0}),te(i)!=="svelte-1yk9qp4"&&(i.textContent=d),u=L(p),_=c(p,"H2",{});var E=m(_);g=ge(E,C),E.forEach(a),p.forEach(a),f.forEach(a),this.h()},h(){v(t,"icon",Jt),v(t,"slot","start")},m(h,f){Y(h,e,f),o(e,t),o(e,l),o(e,n),o(n,i),o(n,u),o(n,_),o(_,g)},p:ze,d(h){h&&a(e)}}}function $n(r){let e,t=r[12].logistic_comments!="<br>"&&eo(r);return{c(){t&&t.c(),e=Me()},l(l){t&&t.l(l),e=Me()},m(l,n){t&&t.m(l,n),Y(l,e,n)},p(l,n){l[12].logistic_comments!="<br>"&&t.p(l,n)},d(l){l&&a(e),t&&t.d(l)}}}function eo(r){let e,t,l,n,i,d="Comentarios logísticos",u,_,C=r[12].logistic_comments+"",g;return{c(){e=s("ion-item"),t=s("ion-icon"),l=w(),n=s("ion-label"),i=s("p"),i.textContent=d,u=w(),_=s("h2"),g=ve(C),this.h()},l(h){e=c(h,"ION-ITEM",{});var f=m(e);t=c(f,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=L(f),n=c(f,"ION-LABEL",{class:!0});var p=m(n);i=c(p,"P",{"data-svelte-h":!0}),te(i)!=="svelte-1iz85r6"&&(i.textContent=d),u=L(p),_=c(p,"H2",{});var E=m(_);g=ge(E,C),E.forEach(a),p.forEach(a),f.forEach(a),this.h()},h(){v(t,"icon",Wt),v(t,"slot","start"),v(n,"class","ion-text-wrap")},m(h,f){Y(h,e,f),o(e,t),o(e,l),o(e,n),o(n,i),o(n,u),o(n,_),o(_,g)},p:ze,d(h){h&&a(e)}}}function to(r){let e,t,l,n,i,d="Estado de entrega",u,_,C="Entregado",g,h,f="No Entregado",p,E,T="Entrega Parcial",y,U,A,F,K,V,S,H,k=r[4]===!0&&kt(r),M=(r[5]===!0||r[5]===!1&&r[4]===!1)&&Ot(r);return{c(){e=s("ion-item"),t=s("ion-icon"),l=w(),n=s("ion-select"),i=s("div"),i.textContent=d,u=w(),_=s("ion-select-option"),_.textContent=C,g=w(),h=s("ion-select-option"),h.textContent=f,p=w(),E=s("ion-select-option"),E.textContent=T,y=w(),U=s("ion-item"),A=s("ion-icon"),F=w(),K=s("ion-textarea"),V=w(),S=s("section"),k&&k.c(),H=w(),M&&M.c(),this.h()},l(P){e=c(P,"ION-ITEM",{});var D=m(e);t=c(D,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=L(D),n=c(D,"ION-SELECT",{value:!0});var B=m(n);i=c(B,"DIV",{slot:!0,"data-svelte-h":!0}),te(i)!=="svelte-1635zca"&&(i.textContent=d),u=L(B),_=c(B,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),te(_)!=="svelte-s33eln"&&(_.textContent=C),g=L(B),h=c(B,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),te(h)!=="svelte-1a859l3"&&(h.textContent=f),p=L(B),E=c(B,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),te(E)!=="svelte-1c4dcm8"&&(E.textContent=T),B.forEach(a),D.forEach(a),y=L(P),U=c(P,"ION-ITEM",{});var j=m(U);A=c(j,"ION-ICON",{icon:!0,slot:!0}),m(A).forEach(a),F=L(j),K=c(j,"ION-TEXTAREA",{label:!0,placeholder:!0}),m(K).forEach(a),j.forEach(a),V=L(P),S=c(P,"SECTION",{style:!0});var q=m(S);k&&k.l(q),H=L(q),M&&M.l(q),q.forEach(a),this.h()},h(){v(t,"icon",vn),v(t,"slot","start"),J(i,"slot","label"),v(_,"value","delivered"),v(h,"value","notdelivered"),v(E,"value","partialdeliver"),v(n,"value",r[15]?r[15]:"delivered"),v(A,"icon",ct),v(A,"slot","start"),v(K,"label","Notas"),v(K,"placeholder","Escribe aquí..."),N(S,"display","flex"),N(S,"gap","8px"),N(S,"padding","16px 16px 6px")},m(P,D){Y(P,e,D),o(e,t),o(e,l),o(e,n),o(n,i),o(n,u),o(n,_),o(n,g),o(n,h),o(n,p),o(n,E),r[29](n),Y(P,y,D),Y(P,U,D),o(U,A),o(U,F),o(U,K),r[30](K),Y(P,V,D),Y(P,S,D),k&&k.m(S,null),o(S,H),M&&M.m(S,null)},p(P,D){P[4]===!0?k?k.p(P,D):(k=kt(P),k.c(),k.m(S,H)):k&&(k.d(1),k=null),P[5]===!0||P[5]===!1&&P[4]===!1?M?M.p(P,D):(M=Ot(P),M.c(),M.m(S,null)):M&&(M.d(1),M=null)},d(P){P&&(a(e),a(y),a(U),a(V),a(S)),r[29](null),r[30](null),k&&k.d(),M&&M.d()}}}function kt(r){let e,t=`<ion-icon icon="${En}" slot="start"></ion-icon>
                        Ingreso`,l,n;return{c(){e=s("ion-button"),e.innerHTML=t,this.h()},l(i){e=c(i,"ION-BUTTON",{id:!0,style:!0,"data-svelte-h":!0}),te(e)!=="svelte-3onvnr"&&(e.innerHTML=t),this.h()},h(){v(e,"id","checkInBtn"),N(e,"flex","1")},m(i,d){Y(i,e,d),l||(n=ue(e,"click",r[23]),l=!0)},p:ze,d(i){i&&a(e),l=!1,n()}}}function Ot(r){let e,t,l,n,i,d;return{c(){e=s("ion-button"),t=s("ion-icon"),l=ve(`
                        Salida`),this.h()},l(u){e=c(u,"ION-BUTTON",{id:!0,style:!0,disabled:!0});var _=m(e);t=c(_,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=ge(_,`
                        Salida`),_.forEach(a),this.h()},h(){v(t,"icon",gn),v(t,"slot","start"),v(e,"id","checkOutBtn"),N(e,"flex","1"),v(e,"disabled",n=r[5]===!1)},m(u,_){Y(u,e,_),o(e,t),o(e,l),i||(d=ue(e,"click",r[24]),i=!0)},p(u,_){_[0]&32&&n!==(n=u[5]===!1)&&v(e,"disabled",n)},d(u){u&&a(e),i=!1,d()}}}function no(r){let e,t,l,n,i,d="Subir Evidencia",u,_,C,g;return{c(){e=s("section"),t=s("ion-button"),l=s("ion-icon"),n=w(),i=s("label"),i.textContent=d,u=w(),_=s("input"),this.h()},l(h){e=c(h,"SECTION",{style:!0});var f=m(e);t=c(f,"ION-BUTTON",{fill:!0,class:!0,style:!0});var p=m(t);l=c(p,"ION-ICON",{icon:!0,slot:!0}),m(l).forEach(a),n=L(p),i=c(p,"LABEL",{for:!0,"data-svelte-h":!0}),te(i)!=="svelte-1wg51s6"&&(i.textContent=d),u=L(p),_=c(p,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0,capture:!0}),p.forEach(a),f.forEach(a),this.h()},h(){v(l,"icon",Yt),v(l,"slot","start"),J(i,"for","eventEvidence"),N(_,"display","none"),J(_,"id","eventEvidence"),J(_,"name","fileToUpload"),J(_,"type","file"),_.multiple=!0,J(_,"accept","image/*"),J(_,"capture","environment"),v(t,"fill","outline"),v(t,"class","loadEvidence"),N(t,"flex","1"),N(e,"display","flex"),N(e,"gap","8px"),N(e,"padding","0px 16px")},m(h,f){Y(h,e,f),o(e,t),o(t,l),o(t,n),o(t,i),o(t,u),o(t,_),C||(g=[ue(_,"change",r[17]),ue(_,"click",r[18])],C=!0)},p:ze,d(h){h&&a(e),C=!1,Pe(g)}}}function Nt(r){let e,t,l=Be(r[2]),n=[];for(let i=0;i<l.length;i+=1)n[i]=Tt(bt(r,l,i));return{c(){e=s("section"),t=s("div");for(let i=0;i<n.length;i+=1)n[i].c();this.h()},l(i){e=c(i,"SECTION",{});var d=m(e);t=c(d,"DIV",{class:!0,style:!0});var u=m(t);for(let _=0;_<n.length;_+=1)n[_].l(u);u.forEach(a),d.forEach(a),this.h()},h(){J(t,"class","image-grid"),N(t,"display","grid"),N(t,"grid-template-columns","repeat(auto-fill, minmax(100px, 1fr))"),N(t,"gap","10px"),N(t,"padding","0px 10px")},m(i,d){Y(i,e,d),o(e,t);for(let u=0;u<n.length;u+=1)n[u]&&n[u].m(t,null)},p(i,d){if(d[0]&34603012){l=Be(i[2]);let u;for(u=0;u<l.length;u+=1){const _=bt(i,l,u);n[u]?n[u].p(_,d):(n[u]=Tt(_),n[u].c(),n[u].m(t,null))}for(;u<n.length;u+=1)n[u].d(1);n.length=l.length}},d(i){i&&a(e),en(n,i)}}}function Tt(r){let e,t,l,n,i,d=`<ion-icon icon="${In}"></ion-icon>`,u,_,C;function g(){return r[31](r[50])}function h(){return r[32](r[52])}return{c(){e=s("div"),t=s("ion-img"),n=w(),i=s("button"),i.innerHTML=d,u=w(),this.h()},l(f){e=c(f,"DIV",{class:!0,style:!0});var p=m(e);t=c(p,"ION-IMG",{src:!0,alt:!0,style:!0}),m(t).forEach(a),n=L(p),i=c(p,"BUTTON",{class:!0,style:!0,"data-svelte-h":!0}),te(i)!=="svelte-zguiov"&&(i.innerHTML=d),u=L(p),p.forEach(a),this.h()},h(){Ke(t.src,l=r[50])||v(t,"src",l),v(t,"alt","Evidencia fotográfica"),N(t,"width","100%"),N(t,"height","100px"),N(t,"object-fit","cover"),N(t,"cursor","pointer"),N(t,"border","1px solid #ccc"),N(t,"border-radius","4px"),N(t,"margin-top","16px"),J(i,"class","remove-button"),N(i,"position","absolute"),N(i,"top","5px"),N(i,"right","5px"),N(i,"border","none"),N(i,"cursor","pointer"),N(i,"font-size","18px"),N(i,"background","white"),N(i,"border-radius","50%"),N(i,"padding","3px 4px 0px"),N(i,"box-shadow","2px 2px 6px rgba(0, 0, 0, 0.3)"),N(i,"color","#0000008f"),J(e,"class","image-container"),N(e,"position","relative")},m(f,p){Y(f,e,p),o(e,t),o(e,n),o(e,i),o(e,u),_||(C=[ue(t,"click",g),ue(i,"click",h)],_=!0)},p(f,p){r=f,p[0]&4&&!Ke(t.src,l=r[50])&&v(t,"src",l)},d(f){f&&a(e),_=!1,Pe(C)}}}function Ct(r){let e,t='<ion-spinner name="dots" style="color:white;"></ion-spinner>';return{c(){e=s("div"),e.innerHTML=t,this.h()},l(l){e=c(l,"DIV",{class:!0,style:!0,"data-svelte-h":!0}),te(e)!=="svelte-h8s7r2"&&(e.innerHTML=t),this.h()},h(){J(e,"class","overlay"),N(e,"position","fixed"),N(e,"top","0"),N(e,"left","0"),N(e,"width","100vw"),N(e,"height","100vh"),N(e,"background","rgba(0, 0, 0, 0.5)"),N(e,"display","flex"),N(e,"align-items","center"),N(e,"justify-content","center"),N(e,"z-index","9999")},m(l,n){Y(l,e,n)},d(l){l&&a(e)}}}function yt(r){let e,t,l,n,i,d,u=`<ion-icon icon="${kn}"></ion-icon>`,_,C;return{c(){e=s("div"),t=s("div"),l=s("ion-img"),i=w(),d=s("button"),d.innerHTML=u,this.h()},l(g){e=c(g,"DIV",{class:!0,style:!0});var h=m(e);t=c(h,"DIV",{class:!0,style:!0});var f=m(t);l=c(f,"ION-IMG",{src:!0,alt:!0,style:!0}),m(l).forEach(a),i=L(f),d=c(f,"BUTTON",{class:!0,style:!0,"data-svelte-h":!0}),te(d)!=="svelte-g0qr0o"&&(d.innerHTML=u),f.forEach(a),h.forEach(a),this.h()},h(){Ke(l.src,n=r[10])||v(l,"src",n),v(l,"alt","Evidencia fotográfica"),N(l,"width","100%"),N(l,"height","auto"),J(d,"class","close-button"),N(d,"position","absolute"),N(d,"top","5px"),N(d,"right","5px"),N(d,"background","white"),N(d,"color","#444444d1"),N(d,"border","none"),N(d,"cursor","pointer"),N(d,"padding","2px 2px 0px 6px"),N(d,"border-radius","50%"),N(d,"font-size","20px"),J(t,"class","modal-content"),N(t,"position","relative"),N(t,"background","white"),N(t,"padding","20px"),N(t,"border-radius","8px"),N(t,"max-width","90vw"),N(t,"max-height","90vh"),N(t,"overflow","auto"),J(e,"class","modal-overlay"),N(e,"position","fixed"),N(e,"top","0"),N(e,"left","0"),N(e,"width","100vw"),N(e,"height","100vh"),N(e,"background","rgba(0, 0, 0, 0.8)"),N(e,"display","flex"),N(e,"justify-content","center"),N(e,"align-items","center"),N(e,"z-index","1000")},m(g,h){Y(g,e,h),o(e,t),o(t,l),o(t,i),o(t,d),_||(C=[ue(d,"click",r[26]),ue(t,"click",tn(r[27])),ue(e,"click",r[26])],_=!0)},p(g,h){h[0]&1024&&!Ke(l.src,n=g[10])&&v(l,"src",n)},d(g){g&&a(e),_=!1,Pe(C)}}}function oo(r){let e,t,l,n,i="Cerrar",d,u,_=r[12].title+"",C,g,h,f,p,E,T,y,U,A,F="Negocio",K,V,S=r[12].client_name+"",H,k,M=r[12].client_phone&&r[12].client_phone.trim().length,P,D,B,j,q=r[12].schedule&&r[12].schedule.trim().length,ee,ne,oe=r[12].logistic_comments&&r[12].logistic_comments.trim().length,fe,se,ae,Ne,Ee,de,Ie,Te,Oe,ke=(!r[13]&&!r[14]||r[13]&&r[14])&&Kn(r),he=M&&Xn(r);function ye(I,X){if(I[12].line1&&I[12].line1.trim().length)return Jn;if(I[12].line2&&I[12].line2.trim().length)return Wn}let we=ye(r),be=we&&we(r),ie=r[6]&&Et(r),x=r[7]&&r[7]!=="<br>"&&It(r),le=q&&Zn(r),O=r[12].driver_comments&&xn(r),z=oe&&$n(r),b=!r[14]&&to(r),R=(r[13]&&r[14]||!r[13]&&!r[14])&&no(r),G=r[1]&&Nt(r),W=r[3]&&Ct(),$=r[9]&&yt(r);return{c(){e=s("ion-header"),t=s("ion-toolbar"),l=s("ion-buttons"),n=s("ion-button"),n.textContent=i,d=w(),u=s("ion-title"),C=ve(_),g=w(),ke&&ke.c(),h=w(),f=s("ion-content"),p=s("ion-list"),E=s("ion-item"),T=s("ion-icon"),y=w(),U=s("ion-label"),A=s("p"),A.textContent=F,K=w(),V=s("h2"),H=ve(S),k=w(),he&&he.c(),P=w(),be&&be.c(),D=w(),ie&&ie.c(),B=w(),x&&x.c(),j=w(),le&&le.c(),ee=w(),O&&O.c(),ne=w(),z&&z.c(),fe=w(),se=w(),b&&b.c(),ae=w(),R&&R.c(),Ne=w(),G&&G.c(),Ee=w(),W&&W.c(),de=w(),$&&$.c(),Ie=Me(),this.h()},l(I){e=c(I,"ION-HEADER",{translucent:!0});var X=m(e);t=c(X,"ION-TOOLBAR",{});var Z=m(t);l=c(Z,"ION-BUTTONS",{slot:!0});var Q=m(l);n=c(Q,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),te(n)!=="svelte-2ks32x"&&(n.textContent=i),Q.forEach(a),d=L(Z),u=c(Z,"ION-TITLE",{style:!0,title:!0});var re=m(u);C=ge(re,_),re.forEach(a),g=L(Z),ke&&ke.l(Z),Z.forEach(a),X.forEach(a),h=L(I),f=c(I,"ION-CONTENT",{fullscreen:!0});var pe=m(f);p=c(pe,"ION-LIST",{});var ce=m(p);E=c(ce,"ION-ITEM",{});var Ce=m(E);T=c(Ce,"ION-ICON",{icon:!0,slot:!0}),m(T).forEach(a),y=L(Ce),U=c(Ce,"ION-LABEL",{});var me=m(U);A=c(me,"P",{"data-svelte-h":!0}),te(A)!=="svelte-57b1dg"&&(A.textContent=F),K=L(me),V=c(me,"H2",{});var _e=m(V);H=ge(_e,S),_e.forEach(a),me.forEach(a),Ce.forEach(a),k=L(ce),he&&he.l(ce),P=L(ce),be&&be.l(ce),D=L(ce),ie&&ie.l(ce),B=L(ce),x&&x.l(ce),j=L(ce),le&&le.l(ce),ee=L(ce),O&&O.l(ce),ne=L(ce),z&&z.l(ce),fe=L(ce),se=L(ce),b&&b.l(ce),ae=L(ce),R&&R.l(ce),Ne=L(ce),G&&G.l(ce),ce.forEach(a),pe.forEach(a),Ee=L(I),W&&W.l(I),de=L(I),$&&$.l(I),Ie=Me(),this.h()},h(){v(n,"color","medium"),v(l,"slot","start"),N(u,"text-align","center"),v(u,"title",r[12].title),v(e,"translucent",""),v(T,"icon",_n),v(T,"slot","start"),v(f,"fullscreen","")},m(I,X){Y(I,e,X),o(e,t),o(t,l),o(l,n),o(t,d),o(t,u),o(u,C),o(t,g),ke&&ke.m(t,null),Y(I,h,X),Y(I,f,X),o(f,p),o(p,E),o(E,T),o(E,y),o(E,U),o(U,A),o(U,K),o(U,V),o(V,H),o(p,k),he&&he.m(p,null),o(p,P),be&&be.m(p,null),o(p,D),ie&&ie.m(p,null),o(p,B),x&&x.m(p,null),o(p,j),le&&le.m(p,null),o(p,ee),O&&O.m(p,null),o(p,ne),z&&z.m(p,null),o(p,fe),o(p,se),b&&b.m(p,null),o(p,ae),R&&R.m(p,null),o(p,Ne),G&&G.m(p,null),Y(I,Ee,X),W&&W.m(I,X),Y(I,de,X),$&&$.m(I,X),Y(I,Ie,X),Te||(Oe=ue(n,"click",r[19]),Te=!0)},p(I,X){(!I[13]&&!I[14]||I[13]&&I[14])&&ke.p(I,X),M&&he.p(I,X),be&&be.p(I,X),I[6]?ie?ie.p(I,X):(ie=Et(I),ie.c(),ie.m(p,B)):ie&&(ie.d(1),ie=null),I[7]&&I[7]!=="<br>"?x?x.p(I,X):(x=It(I),x.c(),x.m(p,j)):x&&(x.d(1),x=null),q&&le.p(I,X),I[12].driver_comments&&O.p(I,X),oe&&z.p(I,X),I[14]||b.p(I,X),(I[13]&&I[14]||!I[13]&&!I[14])&&R.p(I,X),I[1]?G?G.p(I,X):(G=Nt(I),G.c(),G.m(p,null)):G&&(G.d(1),G=null),I[3]?W||(W=Ct(),W.c(),W.m(de.parentNode,de)):W&&(W.d(1),W=null),I[9]?$?$.p(I,X):($=yt(I),$.c(),$.m(Ie.parentNode,Ie)):$&&($.d(1),$=null)},i:ze,o:ze,d(I){I&&(a(e),a(h),a(f),a(Ee),a(de),a(Ie)),ke&&ke.d(),he&&he.d(),be&&be.d(),ie&&ie.d(),x&&x.d(),le&&le.d(),O&&O.d(),z&&z.d(),b&&b.d(),R&&R.d(),G&&G.d(),W&&W.d(I),$&&$.d(I),Te=!1,Oe()}}}const wt=/Teléfono:\s*(\d{10,})/;function lt(r=""){return r.split(",").map(t=>t.trim())}function lo(r,e,t){let l=rt,n=document.querySelector("ion-modal"),i=n.componentProps.delivery,d=n.componentProps.isLast||!1,u=n.componentProps.flag||!1,_=i.driver_comments?i.driver_comments:"",C=i.deliver_status?i.deliver_status:"",g=i.img?i.img:"",h=i.img_id?i.img_id:"",f=g?lt(g):new Array,p=h?lt(h):new Array,E={latitude:null,longitude:null},T=i.stopsApproval,y=i.smsActive,U=!1,A=!0,F=!1,K="",V=i.comments_ext,S="",H=!1,k="",M=new Object,P="";Ze(()=>{M=JSON.parse(localStorage.getItem("userSession")),B()});async function D(b="",R,G={}){let W=new FormData;t(3,U=!0);for(const[$,I]of Object.entries(G))W.append($,I);W=we(W);try{const $=await fetch(b,{method:"POST",body:W});if($.ok){const I=await $.json();R(I)}else console.error("Request failed:",$.statusText)}catch($){console.error("Error during file upload:",$)}finally{t(3,U=!1)}}function B(){i.date_service?i.date_service&&!i.date_completed&&!i.service_time?(t(4,A=!1),t(5,F=!0)):i.date_service&&i.date_completed&&i.service_time&&(t(4,A=!1),t(5,F=!1)):(t(4,A=!0),t(5,F=!1))}if(i.comments_ext){const b=i.comments_ext.match(wt);b&&(K=b[1],V=i.comments_ext.replace(wt,"").trim())}const j=async(b,R)=>{await(await je.create({header:b||"Error",message:R||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()},q=async(b="",R="",G="",W,$={})=>{await(await je.create({header:b||"Error",message:R||"Vuelva a intentar",buttons:[{text:"No",role:"cancel",handler:()=>{}},{text:"Sí",handler:()=>{D(G,W,$)}}]})).present()},ee=async b=>{if(f.length>=5){j("Límite de evidencias","Solo se permite subir 5 fotos por parada");return}if(u&&d&&f.length>=1){j("Límite de evidencias","Para el final de la ruta solo se permite subir 1 foto");return}const G=b.target.files[0];if(G)try{t(3,U=!0);const W=await fe(G);if(W){const $=new FormData;$.append("fileToUpload",W),fetch(`${l}api/admin/manager/upload_img_driver.php`,{method:"POST",body:$}).then(I=>I.json()).then(I=>{t(1,g=g?`${g},${I.img}`:I.img),h=h?`${h},${I.img_id}`:I.img_id,t(2,f=lt(g)),p=lt(h)}).catch(I=>console.error("Upload error:",I))}}catch(W){console.error("Compression error:",W)}finally{t(3,U=!1)}};function ne(b){var R=i.service_time;!R&&A&&!d&&!u&&(b.preventDefault(),j("Registrar Ingreso","Antes de subir la evidencia registra el ingreso a la actual parada."))}function oe(){var b=u?i.date_completed:!1;if(!b&&!A&&F&&!d&&!u){var R=new Object;R.id_event=i.id_event,R.type="checkout",q("Registrar Salida","¿Completaste tu entrega?",l+"api/admin/route/record_check_date.php",function(G){G.minutes&&j("Tiempo por parada","Completaste la parada en "+G.minutes+" minutos.")},R)}}const fe=async b=>new Promise(R=>{const G=new Image;G.src=URL.createObjectURL(b),G.onload=()=>{const W=document.createElement("canvas"),$=W.getContext("2d"),I=800,X=600;let Z=G.width,Q=G.height;Z>I&&(Q*=I/Z,Z=I),Q>X&&(Z*=X/Q,Q=X),W.width=Z,W.height=Q,$.drawImage(G,0,0,Z,Q),W.toBlob(re=>{R(re),URL.revokeObjectURL(G.src),$.clearRect(0,0,W.width,W.height)},"image/jpeg",.7)}}),se=()=>{n.dismiss({data:Date.now()})};function ae(b){t(2,f=f.filter((R,G)=>G!==b))}const Ne=async()=>{try{if(t(3,U=!0),t(1,g=f.join(",")),h=p.join(","),oe(),await de())if(P.value=="delivered"||P.value!=="delivered"&&(_.value||i.driver_comments)||u&&d){const R={id_route:i.id_route,...!u&&!d&&{id_event:i.id_event},...!u&&!d&&{comments:_.value},...!u&&!d&&{deliver_status:P.value},img:g,img_id:h,lat:E.latitude,lon:E.longitude,...T==="0"&&{approve:"0"},...d&&{isLast:!0},...u&&d&&{destiny:!0}};R.img&&R.img_id||g?D(`${l}api/admin/evidence/send_evidence.php`,function(G){if(G.success==!0){const W=R.id_route;se(),d&&Ee("","",W,d)}else j("Carga fallida","Actualiza la página y vuelve a intentar cargar la información!")},R):j("Información incompleta","Cargar evidencia fotográfica faltante para completar parada.")}else j("Motivo de status de entrega","Favor de ingresar en notas el motivo por el que la entrega no fue entregada correctamente");else j("Ubicación faltante","Asegúrate darle permisos a Rutaflow para acceder a tu ubicación")}catch(b){console.error("Error fetching data:",b)}finally{t(3,U=!1)}},Ee=(b,R,G,W)=>{n.componentProps.routeId=G,n.componentProps.driverId=i.id_driver,Ue("modal-km-gas",Zt,{checklist:b,driverId:R,routeId:G,isLast:W}).then($=>{})},de=async()=>navigator.geolocation?new Promise((b,R)=>{navigator.geolocation.getCurrentPosition(G=>{E.latitude=G.coords.latitude,E.longitude=G.coords.longitude,b(!0)},G=>{console.error("Error getting location:",G),b(!1)})}):(console.error("Geolocation is not supported by your browser"),!1);async function Ie(b){b.stopPropagation();let R=new FormData;R.append("client_phone",K),R.append("client_name",i.title),R.append("delivery_phone",i.client_phone),R.append("enterprise_name",i.enterprise_name),R=we(R);try{const G=await fetch(`${l}api/admin/message_central/send_sms.php`,{method:"POST",body:R});if(G.ok){const W=await G.json();j("SMS enviado","Se envío correctamente un SMS a "+i.title+" con número de teléfono: "+K)}else j("SMS no enviado","Hubo un error al enviar SMS a "+i.title+" con número de teléfono: "+phoneNumber0+". Por favor contacte a soporte.")}catch(G){console.error("Error during file upload:",G)}}function Te(){t(4,A=!1),t(5,F=!0),ke(i.id_event,"checkin")}function Oe(){t(5,F=!1),t(4,A=!1),ke(i.id_event,"checkout")}async function ke(b,R){if(R){let G=new FormData;G.append("type",R),G.append("id_event",b),G=we(G);try{const W=await fetch(`${l}api/admin/route/record_check_date.php`,{method:"POST",body:G});if(W.ok){const $=await W.json();$.minutes&&j("Tiempo por parada","Completaste la parada en "+$.minutes+" minutos.")}else console.error("File upload failed:",W.statusText)}catch(W){console.error("Error during file upload:",W)}finally{}}}const he=b=>{t(10,k=b),t(9,H=!0)},ye=()=>{t(9,H=!1),t(10,k="")};function we(b){return b.append("token",M.token),b.append("id_user_over",M.id_user),b}function be(b){nn.call(this,r,b)}function ie(b){Se[b?"unshift":"push"](()=>{S=b,t(8,S)})}function x(b){Se[b?"unshift":"push"](()=>{P=b,t(11,P)})}function le(b){Se[b?"unshift":"push"](()=>{_=b,t(0,_)})}return[_,g,f,U,A,F,K,V,S,H,k,P,i,d,u,C,y,ee,ne,se,ae,Ne,Ie,Te,Oe,he,ye,be,ie,x,le,b=>he(b),b=>ae(b)]}class Lt extends Je{constructor(e){super(),Ye(this,e,lo,oo,We,{},null,[-1,-1])}}function zt(r){let e,t,l;return{c(){e=s("section"),t=s("ion-img"),this.h()},l(n){e=c(n,"SECTION",{});var i=m(e);t=c(i,"ION-IMG",{src:!0,alt:!0,style:!0}),m(t).forEach(a),i.forEach(a),this.h()},h(){Ke(t.src,l=r[0])||v(t,"src",l),v(t,"alt","Evidencia fotográfica"),N(t,"max-width","100%"),N(t,"margin-top","16px")},m(n,i){Y(n,e,i),o(e,t)},p(n,i){i&1&&!Ke(t.src,l=n[0])&&v(t,"src",l)},d(n){n&&a(e)}}}function At(r){let e,t='<ion-spinner name="dots" style="color:white;"></ion-spinner>';return{c(){e=s("div"),e.innerHTML=t,this.h()},l(l){e=c(l,"DIV",{class:!0,style:!0,"data-svelte-h":!0}),te(e)!=="svelte-h8s7r2"&&(e.innerHTML=t),this.h()},h(){J(e,"class","overlay"),N(e,"position","fixed"),N(e,"top","0"),N(e,"left","0"),N(e,"width","100vw"),N(e,"height","100vh"),N(e,"background","rgba(0, 0, 0, 0.5)"),N(e,"display","flex"),N(e,"align-items","center"),N(e,"justify-content","center"),N(e,"z-index","9999")},m(l,n){Y(l,e,n)},d(l){l&&a(e)}}}function io(r){let e,t,l,n,i="Cancelar",d,u,_="AGREGAR GASTO",C,g,h,f="Confirmar",p,E,T,y,U,A,F,K,V,S,H,k,M,P,D,B,j,q,ee='Tipo de pago <ion-text color="danger">(Obligatorio)</ion-text>',ne,oe,fe="Efectivo",se,ae,Ne="Tarjeta",Ee,de,Ie="Transferencia",Te,Oe,ke,he,ye,we,be,ie,x,le,O=`<ion-icon icon="${Yt}" slot="start"></ion-icon>
                        Subir Evidencia`,z,b,R,G,W,$,I,X=r[0]&&zt(r),Z=r[5]&&At();return{c(){e=s("ion-header"),t=s("ion-toolbar"),l=s("ion-buttons"),n=s("ion-button"),n.textContent=i,d=w(),u=s("ion-title"),u.textContent=_,C=w(),g=s("ion-buttons"),h=s("ion-button"),h.textContent=f,p=w(),E=s("ion-content"),T=s("ion-list"),y=s("ion-item"),U=s("ion-icon"),A=w(),F=s("ion-input"),K=w(),V=s("ion-item"),S=s("ion-icon"),H=w(),k=s("ion-input"),M=w(),P=s("ion-item"),D=s("ion-icon"),B=w(),j=s("ion-select"),q=s("div"),q.innerHTML=ee,ne=w(),oe=s("ion-select-option"),oe.textContent=fe,se=w(),ae=s("ion-select-option"),ae.textContent=Ne,Ee=w(),de=s("ion-select-option"),de.textContent=Ie,Te=w(),Oe=s("ion-item"),ke=s("ion-icon"),he=w(),ye=s("ion-textarea"),we=w(),be=s("section"),ie=s("label"),x=s("ion-button"),le=s("label"),le.innerHTML=O,z=w(),b=s("input"),R=w(),X&&X.c(),G=w(),Z&&Z.c(),W=Me(),this.h()},l(Q){e=c(Q,"ION-HEADER",{translucent:!0});var re=m(e);t=c(re,"ION-TOOLBAR",{});var pe=m(t);l=c(pe,"ION-BUTTONS",{slot:!0});var ce=m(l);n=c(ce,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),te(n)!=="svelte-1f8rjcf"&&(n.textContent=i),ce.forEach(a),d=L(pe),u=c(pe,"ION-TITLE",{title:!0,"data-svelte-h":!0}),te(u)!=="svelte-efps2s"&&(u.textContent=_),C=L(pe),g=c(pe,"ION-BUTTONS",{slot:!0});var Ce=m(g);h=c(Ce,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),te(h)!=="svelte-k5zoz0"&&(h.textContent=f),Ce.forEach(a),pe.forEach(a),re.forEach(a),p=L(Q),E=c(Q,"ION-CONTENT",{fullscreen:!0});var me=m(E);T=c(me,"ION-LIST",{});var _e=m(T);y=c(_e,"ION-ITEM",{});var He=m(y);U=c(He,"ION-ICON",{icon:!0,slot:!0}),m(U).forEach(a),A=L(He),F=c(He,"ION-INPUT",{label:!0,type:!0,placeholder:!0,value:!0}),m(F).forEach(a),He.forEach(a),K=L(_e),V=c(_e,"ION-ITEM",{});var qe=m(V);S=c(qe,"ION-ICON",{icon:!0,slot:!0}),m(S).forEach(a),H=L(qe),k=c(qe,"ION-INPUT",{label:!0,type:!0,value:!0}),m(k).forEach(a),qe.forEach(a),M=L(_e),P=c(_e,"ION-ITEM",{});var tt=m(P);D=c(tt,"ION-ICON",{icon:!0,slot:!0}),m(D).forEach(a),B=L(tt),j=c(tt,"ION-SELECT",{placeholder:!0,value:!0});var Ve=m(j);q=c(Ve,"DIV",{slot:!0,"data-svelte-h":!0}),te(q)!=="svelte-wl764p"&&(q.innerHTML=ee),ne=L(Ve),oe=c(Ve,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),te(oe)!=="svelte-i9crym"&&(oe.textContent=fe),se=L(Ve),ae=c(Ve,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),te(ae)!=="svelte-fx0z11"&&(ae.textContent=Ne),Ee=L(Ve),de=c(Ve,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),te(de)!=="svelte-1c24jf2"&&(de.textContent=Ie),Ve.forEach(a),tt.forEach(a),Te=L(_e),Oe=c(_e,"ION-ITEM",{});var nt=m(Oe);ke=c(nt,"ION-ICON",{icon:!0,slot:!0}),m(ke).forEach(a),he=L(nt),ye=c(nt,"ION-TEXTAREA",{label:!0,placeholder:!0}),m(ye).forEach(a),nt.forEach(a),we=L(_e),be=c(_e,"SECTION",{});var pt=m(be);ie=c(pt,"LABEL",{for:!0,style:!0});var mt=m(ie);x=c(mt,"ION-BUTTON",{fill:!0,size:!0,class:!0,expand:!0});var ot=m(x);le=c(ot,"LABEL",{for:!0,style:!0,"data-svelte-h":!0}),te(le)!=="svelte-1m9yw22"&&(le.innerHTML=O),z=L(ot),b=c(ot,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0,capture:!0}),ot.forEach(a),mt.forEach(a),pt.forEach(a),R=L(_e),X&&X.l(_e),_e.forEach(a),me.forEach(a),G=L(Q),Z&&Z.l(Q),W=Me(),this.h()},h(){v(n,"color","medium"),v(l,"slot","start"),v(u,"title",""),v(h,"strong",""),v(g,"slot","end"),v(e,"translucent",""),v(U,"icon",Jt),v(U,"slot","start"),v(F,"label","Concepto"),v(F,"type","text"),v(F,"placeholder","Escribe aquí..."),v(F,"value",r[6]?r[6]:""),v(S,"icon",ct),v(S,"slot","start"),v(k,"label","Cantidad"),v(k,"type","number"),v(k,"value",r[7]?r[7]:""),v(D,"icon",On),v(D,"slot","start"),J(q,"slot","label"),v(oe,"value","cash"),v(ae,"value","card"),v(de,"value","transfer"),v(j,"placeholder","Tipo de pago"),v(j,"value",r[8]?r[8]:""),v(ke,"icon",ct),v(ke,"slot","start"),v(ye,"label","Comentarios"),v(ye,"placeholder","Escribe aquí..."),J(le,"for","eventEvidence"),N(le,"width","100%"),N(le,"padding","8px"),N(b,"display","none"),J(b,"id","eventEvidence"),J(b,"name","fileToUpload"),J(b,"type","file"),J(b,"accept","image/*"),J(b,"capture","environment"),v(x,"fill","outline"),v(x,"size","small"),v(x,"class","loadEvidence"),v(x,"expand","block"),J(ie,"for","eventEvidence"),N(ie,"display","block"),N(ie,"width","100%"),v(E,"fullscreen","")},m(Q,re){Y(Q,e,re),o(e,t),o(t,l),o(l,n),o(t,d),o(t,u),o(t,C),o(t,g),o(g,h),Y(Q,p,re),Y(Q,E,re),o(E,T),o(T,y),o(y,U),o(y,A),o(y,F),r[12](F),o(T,K),o(T,V),o(V,S),o(V,H),o(V,k),r[13](k),o(T,M),o(T,P),o(P,D),o(P,B),o(P,j),o(j,q),o(j,ne),o(j,oe),o(j,se),o(j,ae),o(j,Ee),o(j,de),r[14](j),o(T,Te),o(T,Oe),o(Oe,ke),o(Oe,he),o(Oe,ye),r[15](ye),o(T,we),o(T,be),o(be,ie),o(ie,x),o(x,le),o(x,z),o(x,b),o(T,R),X&&X.m(T,null),Y(Q,G,re),Z&&Z.m(Q,re),Y(Q,W,re),$||(I=[ue(n,"click",r[10]),ue(h,"click",r[11]),ue(b,"change",r[9])],$=!0)},p(Q,[re]){Q[0]?X?X.p(Q,re):(X=zt(Q),X.c(),X.m(T,null)):X&&(X.d(1),X=null),Q[5]?Z||(Z=At(),Z.c(),Z.m(W.parentNode,W)):Z&&(Z.d(1),Z=null)},i:ze,o:ze,d(Q){Q&&(a(e),a(p),a(E),a(G),a(W)),r[12](null),r[13](null),r[14](null),r[15](null),X&&X.d(),Z&&Z.d(Q),$=!1,Pe(I)}}}function ro(r,e,t){let l=rt,n=document.querySelector("ion-modal"),i=n.componentProps.routeId,d=n.componentProps.ex_concept,u=n.componentProps.ex_amount,_=n.componentProps.ex_type,C=n.componentProps.id_expense,g="",h="",f="",p=0,E="",T="",y=!1,U=new Object;Ze(()=>{U=JSON.parse(localStorage.getItem("userSession"))});const A=async(B,j)=>{await(await je.create({header:B||"Error",message:j||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()},F=async B=>{t(5,y=!0);const q=B.target.files[0],ee=await K(q);if(ee){let ne=new FormData;ne.append("fileToUpload",ee),ne=H(ne);try{const oe=await fetch(`${l}api/admin/manager/upload_img_driver.php`,{method:"POST",body:ne});if(oe.ok){const fe=await oe.json();t(0,g=fe.img),h=fe.img_id}else console.error("File upload failed:",oe.statusText)}catch(oe){console.error("Error during file upload:",oe)}finally{t(5,y=!1)}}},K=async B=>new Promise(j=>{const q=new Image;q.src=URL.createObjectURL(B),q.onload=()=>{const ee=document.createElement("canvas"),ne=ee.getContext("2d"),oe=800,fe=600;let se=q.width,ae=q.height;se>oe&&(ae*=oe/se,se=oe),ae>fe&&(se*=fe/ae,ae=fe),ee.width=se,ee.height=ae,ne.drawImage(q,0,0,se,ae),ee.toBlob(Ne=>{j(Ne),URL.revokeObjectURL(q.src),ne.clearRect(0,0,ee.width,ee.height)},"image/jpeg",.7)}}),V=()=>{et.dismiss()},S=()=>{var B=new Object;B.id_route=i,B.comments=E.value,B.type=f.value,B.img=g,B.img_id=h,B.amount=p.value,B.concept=T.value,B.status="done",B.id_expense=C||"null";let j=new FormData;for(const q in B)j.append(q,B[q]);j=H(j),!h||!g||!E.value||!p.value||!T.value?A("Datos incompletos","Llena los datos requeridos para completar el registro"):fetch(`${l}api/admin/expenses/add_expense.php`,{method:"POST",body:j}).then(q=>q.json()).then(q=>{V()}).catch(q=>{console.error("Error fetching data:",q)})};function H(B){return B.append("token",U.token),B.append("id_user_over",U.id_user),B}function k(B){Se[B?"unshift":"push"](()=>{T=B,t(4,T)})}function M(B){Se[B?"unshift":"push"](()=>{p=B,t(2,p)})}function P(B){Se[B?"unshift":"push"](()=>{f=B,t(1,f)})}function D(B){Se[B?"unshift":"push"](()=>{E=B,t(3,E)})}return[g,f,p,E,T,y,d,u,_,F,V,S,k,M,P,D]}class ft extends Je{constructor(e){super(),Ye(this,e,ro,io,We,{})}}function Mt(r,e,t){const l=r.slice();return l[7]=e[t],l}function ao(r){let e,t="Cargar gasto",l,n;function i(...d){return r[4](r[7],...d)}return{c(){e=s("ion-button"),e.textContent=t,this.h()},l(d){e=c(d,"ION-BUTTON",{fill:!0,size:!0,"aria-selected":!0,"data-svelte-h":!0}),te(e)!=="svelte-175aelj"&&(e.textContent=t),this.h()},h(){v(e,"fill","outline"),v(e,"size","small"),v(e,"aria-selected","")},m(d,u){Y(d,e,u),l||(n=ue(e,"click",i),l=!0)},p(d,u){r=d},d(d){d&&a(e),l=!1,n()}}}function so(r){let e,t="Gasto completado";return{c(){e=s("ion-button"),e.textContent=t,this.h()},l(l){e=c(l,"ION-BUTTON",{fill:!0,size:!0,"aria-selected":!0,"data-svelte-h":!0}),te(e)!=="svelte-tlger7"&&(e.textContent=t),this.h()},h(){v(e,"fill","solid"),v(e,"size","small"),v(e,"aria-selected","")},m(l,n){Y(l,e,n)},p:ze,d(l){l&&a(e)}}}function St(r,e){let t,l,n,i=e[7].concept+"",d,u,_;function C(f,p){return f[7].status=="done"?so:ao}let h=C(e)(e);return{key:r,first:null,c(){t=s("ion-item"),l=s("ion-label"),n=s("p"),d=ve(i),u=w(),h.c(),_=w(),this.h()},l(f){t=c(f,"ION-ITEM",{});var p=m(t);l=c(p,"ION-LABEL",{style:!0});var E=m(l);n=c(E,"P",{style:!0});var T=m(n);d=ge(T,i),T.forEach(a),E.forEach(a),u=L(p),h.l(p),_=L(p),p.forEach(a),this.h()},h(){N(n,"margin-left","10px"),N(l,"display","flex"),this.first=t},m(f,p){Y(f,t,p),o(t,l),o(l,n),o(n,d),o(t,u),h.m(t,null),o(t,_)},p(f,p){e=f,h.p(e,p)},d(f){f&&a(t),h.d()}}}function co(r){let e,t,l,n,i=`<ion-icon style="font-size: 25px!important;" icon="${Nn}"></ion-icon>`,d,u,_="LISTA DE GASTOS",C,g,h,f=[],p=new Map,E,T,y,U="Cerrar",A,F,K=Be(r[0]);const V=S=>S[7].id_expenses;for(let S=0;S<K.length;S+=1){let H=Mt(r,K,S),k=V(H);p.set(k,f[S]=St(k,H))}return{c(){e=s("ion-header"),t=s("ion-toolbar"),l=s("ion-buttons"),n=s("ion-button"),n.innerHTML=i,d=w(),u=s("ion-title"),u.textContent=_,C=w(),g=s("ion-content"),h=s("ion-list");for(let S=0;S<f.length;S+=1)f[S].c();E=w(),T=s("ion-footer"),y=s("ion-button"),y.textContent=U,this.h()},l(S){e=c(S,"ION-HEADER",{translucent:!0});var H=m(e);t=c(H,"ION-TOOLBAR",{});var k=m(t);l=c(k,"ION-BUTTONS",{slot:!0});var M=m(l);n=c(M,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),te(n)!=="svelte-160xz3i"&&(n.innerHTML=i),M.forEach(a),d=L(k),u=c(k,"ION-TITLE",{"data-svelte-h":!0}),te(u)!=="svelte-1phn90x"&&(u.textContent=_),k.forEach(a),H.forEach(a),C=L(S),g=c(S,"ION-CONTENT",{fullscreen:!0});var P=m(g);h=c(P,"ION-LIST",{});var D=m(h);for(let j=0;j<f.length;j+=1)f[j].l(D);D.forEach(a),P.forEach(a),E=L(S),T=c(S,"ION-FOOTER",{});var B=m(T);y=c(B,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),te(y)!=="svelte-zv7v83"&&(y.textContent=U),B.forEach(a),this.h()},h(){v(n,"color","medium"),v(l,"slot","end"),v(e,"translucent",""),v(g,"fullscreen",""),v(y,"fill","outline"),v(y,"color","tertiary"),v(y,"strong",""),N(y,"width","99%"),N(y,"height","auto")},m(S,H){Y(S,e,H),o(e,t),o(t,l),o(l,n),o(t,d),o(t,u),Y(S,C,H),Y(S,g,H),o(g,h);for(let k=0;k<f.length;k+=1)f[k]&&f[k].m(h,null);Y(S,E,H),Y(S,T,H),o(T,y),A||(F=[ue(n,"click",r[3]),ue(y,"click",r[1])],A=!0)},p(S,[H]){H&5&&(K=Be(S[0]),f=xe(f,H,V,1,S,K,p,h,$e,St,null,Mt))},i:ze,o:ze,d(S){S&&(a(e),a(C),a(g),a(E),a(T));for(let H=0;H<f.length;H+=1)f[H].d();A=!1,Pe(F)}}}function uo(r){let e=document.querySelector("ion-modal");e.componentProps.routeId;let t=e.componentProps.expenses;Ze(()=>{});const l=()=>{et.dismiss()};function n(u,_,C,g,h){e.componentProps.ex_amount=C,e.componentProps.ex_concept=_,e.componentProps.ex_type=g,e.componentProps.id_expense=h,Ue("modal-expense",ft,{amount:C,concept:_,type:g,id_expense:h}).then(()=>{}),l()}return[t,l,n,u=>{Ue("modal-expense",ft,{routeId:u}).then(_=>{}),l()},(u,_)=>n(_,u.concept,u.amount,u.type,u.id_expenses)]}class fo extends Je{constructor(e){super(),Ye(this,e,uo,co,We,{})}}const{document:Dt}=An;function Pt(r,e,t){const l=r.slice();return l[48]=e[t],l[50]=t,l}function Ht(r,e,t){const l=r.slice();return l[48]=e[t],l[50]=t,l}function Bt(r,e,t){const l=r.slice();return l[48]=e[t],l[50]=t,l}function Rt(r){let e,t;return e=new wn({props:{$$slots:{default:[bo]},$$scope:{ctx:r}}}),{c(){sn(e.$$.fragment)},l(l){cn(e.$$.fragment,l)},m(l,n){un(e,l,n),t=!0},p(l,n){const i={};n[0]&1019|n[1]&4194304&&(i.$$scope={dirty:n,ctx:l}),e.$set(i)},i(l){t||(it(e.$$.fragment,l),t=!0)},o(l){st(e.$$.fragment,l),t=!1},d(l){fn(e,l)}}}function _o(r){let e,t='<div id="g_map" style="width: 100%; height: 100vh;"></div>';return{c(){e=s("ion-content"),e.innerHTML=t},l(l){e=c(l,"ION-CONTENT",{"data-svelte-h":!0}),te(e)!=="svelte-1ydw6i9"&&(e.innerHTML=t)},m(l,n){Y(l,e,n)},p:ze,d(l){l&&a(e)}}}function ho(r){let e;function t(i,d){if(i[7].length>0)return mo;if(!i[3])return po}let l=t(r),n=l&&l(r);return{c(){n&&n.c(),e=Me()},l(i){n&&n.l(i),e=Me()},m(i,d){n&&n.m(i,d),Y(i,e,d)},p(i,d){l===(l=t(i))&&n?n.p(i,d):(n&&n.d(1),n=l&&l(i),n&&(n.c(),n.m(e.parentNode,e)))},d(i){i&&a(e),n&&n.d(i)}}}function po(r){let e,t,l,n='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Jala para actualizar" refreshing-spinner="circles" refreshing-text="Actualizando..."></ion-refresher-content>',i,d,u,_,C,g,h="0",f,p,E,T,y,U=r[6].origin+"",A,F,K,V="",S,H,k,M=[],P=new Map,D,B,j,q,ee,ne=r[5].length+1+"",oe,fe,se,ae,Ne,Ee,de=r[6].destination+"",Ie,Te,Oe,ke="",he,ye,we,be,ie=r[4]&&Ut(r),x=Be(r[5]);const le=O=>O[48].id_event;for(let O=0;O<x.length;O+=1){let z=Pt(r,x,O),b=le(z);P.set(b,M[O]=Ft(b,z))}return{c(){ie&&ie.c(),e=w(),t=s("ion-content"),l=s("ion-refresher"),l.innerHTML=n,i=w(),d=s("ion-list"),u=s("ion-item"),_=s("ion-avatar"),C=s("div"),g=s("div"),g.textContent=h,p=w(),E=s("ion-label"),T=s("ion-text"),y=s("h3"),A=ve(U),F=w(),K=s("div"),K.innerHTML=V,S=w(),H=s("ion-icon"),k=w();for(let O=0;O<M.length;O+=1)M[O].c();D=w(),B=s("ion-item"),j=s("ion-avatar"),q=s("div"),ee=s("div"),oe=ve(ne),se=w(),ae=s("ion-label"),Ne=s("ion-text"),Ee=s("h3"),Ie=ve(de),Te=w(),Oe=s("div"),Oe.innerHTML=ke,he=w(),ye=s("ion-icon"),this.h()},l(O){ie&&ie.l(O),e=L(O),t=c(O,"ION-CONTENT",{});var z=m(t);l=c(z,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),te(l)!=="svelte-1srnbs3"&&(l.innerHTML=n),i=L(z),d=c(z,"ION-LIST",{});var b=m(d);u=c(b,"ION-ITEM",{});var R=m(u);_=c(R,"ION-AVATAR",{slot:!0});var G=m(_);C=c(G,"DIV",{class:!0,title:!0,style:!0});var W=m(C);g=c(W,"DIV",{class:!0,"data-svelte-h":!0}),te(g)!=="svelte-3lvlrb"&&(g.textContent=h),W.forEach(a),G.forEach(a),p=L(R),E=c(R,"ION-LABEL",{button:!0});var $=m(E);T=c($,"ION-TEXT",{color:!0});var I=m(T);y=c(I,"H3",{});var X=m(y);A=ge(X,U),X.forEach(a),I.forEach(a),F=L($),K=c($,"DIV",{class:!0,"data-svelte-h":!0}),te(K)!=="svelte-gz9kb"&&(K.innerHTML=V),$.forEach(a),S=L(R),H=c(R,"ION-ICON",{icon:!0,slot:!0}),m(H).forEach(a),R.forEach(a),k=L(b);for(let _e=0;_e<M.length;_e+=1)M[_e].l(b);D=L(b),B=c(b,"ION-ITEM",{});var Z=m(B);j=c(Z,"ION-AVATAR",{slot:!0});var Q=m(j);q=c(Q,"DIV",{class:!0,title:!0,style:!0});var re=m(q);ee=c(re,"DIV",{class:!0});var pe=m(ee);oe=ge(pe,ne),pe.forEach(a),re.forEach(a),Q.forEach(a),se=L(Z),ae=c(Z,"ION-LABEL",{button:!0});var ce=m(ae);Ne=c(ce,"ION-TEXT",{color:!0});var Ce=m(Ne);Ee=c(Ce,"H3",{});var me=m(Ee);Ie=ge(me,de),me.forEach(a),Ce.forEach(a),Te=L(ce),Oe=c(ce,"DIV",{class:!0,"data-svelte-h":!0}),te(Oe)!=="svelte-130ohbs"&&(Oe.innerHTML=ke),ce.forEach(a),he=L(Z),ye=c(Z,"ION-ICON",{icon:!0,slot:!0}),m(ye).forEach(a),Z.forEach(a),b.forEach(a),z.forEach(a),this.h()},h(){v(l,"slot","fixed"),J(g,"class","order svelte-egzizz"),J(C,"class","order-wrapper svelte-egzizz"),J(C,"title",f="$"+r[6].origin),N(C,"background-color",r[6].color),N(C,"color",Ae(r[6].color)),v(_,"slot","start"),v(T,"color","#2e2e2e"),J(K,"class","sub svelte-egzizz"),v(E,"button",""),v(H,"icon",Re),v(H,"slot","end"),J(ee,"class","order svelte-egzizz"),J(q,"class","order-wrapper svelte-egzizz"),J(q,"title",fe="$"+r[6].destination),N(q,"background-color",r[6].color),N(q,"color",Ae(r[6].color)),v(j,"slot","start"),v(Ne,"color","#2e2e2e"),J(Oe,"class","sub svelte-egzizz"),v(ae,"button",""),v(ye,"icon",Re),v(ye,"slot","end")},m(O,z){ie&&ie.m(O,z),Y(O,e,z),Y(O,t,z),o(t,l),r[30](l),o(t,i),o(t,d),o(d,u),o(u,_),o(_,C),o(C,g),o(u,p),o(u,E),o(E,T),o(T,y),o(y,A),o(E,F),o(E,K),o(u,S),o(u,H),o(d,k);for(let b=0;b<M.length;b+=1)M[b]&&M[b].m(d,null);o(d,D),o(d,B),o(B,j),o(j,q),o(q,ee),o(ee,oe),o(B,se),o(B,ae),o(ae,Ne),o(Ne,Ee),o(Ee,Ie),o(ae,Te),o(ae,Oe),o(B,he),o(B,ye),we||(be=[ue(l,"ionRefresh",r[10]),ue(E,"click",r[31]),ue(ae,"click",r[33])],we=!0)},p(O,z){O[4]?ie?ie.p(O,z):(ie=Ut(O),ie.c(),ie.m(e.parentNode,e)):ie&&(ie.d(1),ie=null),z[0]&64&&f!==(f="$"+O[6].origin)&&J(C,"title",f),z[0]&64&&N(C,"background-color",O[6].color),z[0]&64&&N(C,"color",Ae(O[6].color)),z[0]&64&&U!==(U=O[6].origin+"")&&Le(A,U),z[0]&331808&&(x=Be(O[5]),M=xe(M,z,le,1,O,x,P,d,$e,Ft,D,Pt)),z[0]&32&&ne!==(ne=O[5].length+1+"")&&Le(oe,ne),z[0]&64&&fe!==(fe="$"+O[6].destination)&&J(q,"title",fe),z[0]&64&&N(q,"background-color",O[6].color),z[0]&64&&N(q,"color",Ae(O[6].color)),z[0]&64&&de!==(de=O[6].destination+"")&&Le(Ie,de)},d(O){O&&(a(e),a(t)),ie&&ie.d(O),r[30](null);for(let z=0;z<M.length;z+=1)M[z].d();we=!1,Pe(be)}}}function mo(r){let e,t;function l(d,u){return u[0]&144&&(e=null),e==null&&(e=!!(d[7].filter(Io).every(ko)&&!d[4])),e?go:vo}let n=l(r,[-1,-1]),i=n(r);return{c(){i.c(),t=Me()},l(d){i.l(d),t=Me()},m(d,u){i.m(d,u),Y(d,t,u)},p(d,u){n===(n=l(d,u))&&i?i.p(d,u):(i.d(1),i=n(d),i&&(i.c(),i.m(t.parentNode,t)))},d(d){d&&a(t),i.d(d)}}}function Ut(r){let e=r[14]("",r[1],r[0])+"",t;return{c(){t=ve(e)},l(l){t=ge(l,e)},m(l,n){Y(l,t,n)},p(l,n){n[0]&3&&e!==(e=l[14]("",l[1],l[0])+"")&&Le(t,e)},d(l){l&&a(t)}}}function Vt(r){let e;return{c(){e=s("span"),this.h()},l(t){e=c(t,"SPAN",{class:!0}),m(e).forEach(a),this.h()},h(){J(e,"class","notes svelte-egzizz")},m(t,l){Y(t,e,l)},d(t){t&&a(e)}}}function Ft(r,e){let t,l,n,i,d=parseInt(e[48].pos)+1+"",u,_,C,g,h,f,p=e[48].title+"",E,T,y=e[48].support_list&&e[48].support_list.length||e[16](e[48]),U,A,F,K,V=y&&Vt();function S(){return e[32](e[48])}return{key:r,first:null,c(){t=s("ion-item"),l=s("ion-avatar"),n=s("div"),i=s("div"),u=ve(d),C=w(),g=s("ion-label"),h=s("ion-text"),f=s("h3"),E=ve(p),T=w(),V&&V.c(),U=w(),A=s("ion-icon"),this.h()},l(H){t=c(H,"ION-ITEM",{});var k=m(t);l=c(k,"ION-AVATAR",{slot:!0});var M=m(l);n=c(M,"DIV",{class:!0,title:!0,style:!0});var P=m(n);i=c(P,"DIV",{class:!0});var D=m(i);u=ge(D,d),D.forEach(a),P.forEach(a),M.forEach(a),C=L(k),g=c(k,"ION-LABEL",{button:!0});var B=m(g);h=c(B,"ION-TEXT",{color:!0});var j=m(h);f=c(j,"H3",{});var q=m(f);E=ge(q,p),T=L(q),V&&V.l(q),q.forEach(a),j.forEach(a),B.forEach(a),U=L(k),A=c(k,"ION-ICON",{icon:!0,slot:!0,style:!0}),m(A).forEach(a),k.forEach(a),this.h()},h(){J(i,"class","order svelte-egzizz"),J(n,"class","order-wrapper svelte-egzizz"),J(n,"title",_=Xe(e[48].status)),N(n,"background-color",De(e[48].status,e[48].date_service)),N(n,"color",Ae(De(e[48].status))),v(l,"slot","start"),v(h,"color","#2e2e2e"),v(g,"button",""),v(A,"icon",Re),v(A,"slot","end"),N(A,"color",De(e[48].status,e[48].date_service)),this.first=t},m(H,k){Y(H,t,k),o(t,l),o(l,n),o(n,i),o(i,u),o(t,C),o(t,g),o(g,h),o(h,f),o(f,E),o(f,T),V&&V.m(f,null),o(t,U),o(t,A),F||(K=ue(g,"click",S),F=!0)},p(H,k){e=H,k[0]&32&&d!==(d=parseInt(e[48].pos)+1+"")&&Le(u,d),k[0]&32&&_!==(_=Xe(e[48].status))&&J(n,"title",_),k[0]&32&&N(n,"background-color",De(e[48].status,e[48].date_service)),k[0]&32&&N(n,"color",Ae(De(e[48].status))),k[0]&32&&p!==(p=e[48].title+"")&&Le(E,p),k[0]&32&&(y=e[48].support_list&&e[48].support_list.length||e[16](e[48])),y?V||(V=Vt(),V.c(),V.m(f,null)):V&&(V.d(1),V=null),k[0]&32&&N(A,"color",De(e[48].status,e[48].date_service))},d(H){H&&a(t),V&&V.d(),F=!1,K()}}}function vo(r){let e=r[14](r[7],r[1],r[0])+"",t,l,n,i,d='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Pull to refresh" refreshing-spinner="circles" refreshing-text="Refreshing..."></ion-refresher-content>',u,_,C,g,h,f,p="0",E,T,y,U,A,F=r[6].origin+"",K,V,S,H="",k,M,P,D=[],B=new Map,j,q,ee,ne,oe,fe=r[5].length+1+"",se,ae,Ne,Ee,de,Ie,Te=r[6].destination+"",Oe,ke,he,ye="",we,be,ie,x,le=Be(r[5]);const O=z=>z[48].id_event;for(let z=0;z<le.length;z+=1){let b=Ht(r,le,z),R=O(b);B.set(R,D[z]=qt(R,b))}return{c(){t=ve(e),l=w(),n=s("ion-content"),i=s("ion-refresher"),i.innerHTML=d,u=w(),_=s("ion-list"),C=s("ion-item"),g=s("ion-avatar"),h=s("div"),f=s("div"),f.textContent=p,T=w(),y=s("ion-label"),U=s("ion-text"),A=s("h3"),K=ve(F),V=w(),S=s("div"),S.innerHTML=H,k=w(),M=s("ion-icon"),P=w();for(let z=0;z<D.length;z+=1)D[z].c();j=w(),q=s("ion-item"),ee=s("ion-avatar"),ne=s("div"),oe=s("div"),se=ve(fe),Ne=w(),Ee=s("ion-label"),de=s("ion-text"),Ie=s("h3"),Oe=ve(Te),ke=w(),he=s("div"),he.innerHTML=ye,we=w(),be=s("ion-icon"),this.h()},l(z){t=ge(z,e),l=L(z),n=c(z,"ION-CONTENT",{});var b=m(n);i=c(b,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),te(i)!=="svelte-dvt1s"&&(i.innerHTML=d),u=L(b),_=c(b,"ION-LIST",{});var R=m(_);C=c(R,"ION-ITEM",{});var G=m(C);g=c(G,"ION-AVATAR",{slot:!0});var W=m(g);h=c(W,"DIV",{class:!0,title:!0,style:!0});var $=m(h);f=c($,"DIV",{class:!0,"data-svelte-h":!0}),te(f)!=="svelte-3lvlrb"&&(f.textContent=p),$.forEach(a),W.forEach(a),T=L(G),y=c(G,"ION-LABEL",{button:!0});var I=m(y);U=c(I,"ION-TEXT",{color:!0});var X=m(U);A=c(X,"H3",{});var Z=m(A);K=ge(Z,F),Z.forEach(a),X.forEach(a),V=L(I),S=c(I,"DIV",{class:!0,"data-svelte-h":!0}),te(S)!=="svelte-gz9kb"&&(S.innerHTML=H),I.forEach(a),k=L(G),M=c(G,"ION-ICON",{icon:!0,slot:!0}),m(M).forEach(a),G.forEach(a),P=L(R);for(let He=0;He<D.length;He+=1)D[He].l(R);j=L(R),q=c(R,"ION-ITEM",{});var Q=m(q);ee=c(Q,"ION-AVATAR",{slot:!0});var re=m(ee);ne=c(re,"DIV",{class:!0,title:!0,style:!0});var pe=m(ne);oe=c(pe,"DIV",{class:!0});var ce=m(oe);se=ge(ce,fe),ce.forEach(a),pe.forEach(a),re.forEach(a),Ne=L(Q),Ee=c(Q,"ION-LABEL",{button:!0});var Ce=m(Ee);de=c(Ce,"ION-TEXT",{color:!0});var me=m(de);Ie=c(me,"H3",{});var _e=m(Ie);Oe=ge(_e,Te),_e.forEach(a),me.forEach(a),ke=L(Ce),he=c(Ce,"DIV",{class:!0,"data-svelte-h":!0}),te(he)!=="svelte-130ohbs"&&(he.innerHTML=ye),Ce.forEach(a),we=L(Q),be=c(Q,"ION-ICON",{icon:!0,slot:!0}),m(be).forEach(a),Q.forEach(a),R.forEach(a),b.forEach(a),this.h()},h(){v(i,"slot","fixed"),J(f,"class","order svelte-egzizz"),J(h,"class","order-wrapper svelte-egzizz"),J(h,"title",E="$"+r[6].origin),N(h,"background-color",r[6].color),N(h,"color",Ae(r[6].color)),v(g,"slot","start"),v(U,"color","#2e2e2e"),J(S,"class","sub svelte-egzizz"),v(y,"button",""),v(M,"icon",Re),v(M,"slot","end"),J(oe,"class","order svelte-egzizz"),J(ne,"class","order-wrapper svelte-egzizz"),J(ne,"title",ae="$"+r[6].destination),N(ne,"background-color",r[6].color),N(ne,"color",Ae(r[6].color)),v(ee,"slot","start"),v(de,"color","#2e2e2e"),J(he,"class","sub svelte-egzizz"),v(Ee,"button",""),v(be,"icon",Re),v(be,"slot","end")},m(z,b){Y(z,t,b),Y(z,l,b),Y(z,n,b),o(n,i),r[26](i),o(n,u),o(n,_),o(_,C),o(C,g),o(g,h),o(h,f),o(C,T),o(C,y),o(y,U),o(U,A),o(A,K),o(y,V),o(y,S),o(C,k),o(C,M),o(_,P);for(let R=0;R<D.length;R+=1)D[R]&&D[R].m(_,null);o(_,j),o(_,q),o(q,ee),o(ee,ne),o(ne,oe),o(oe,se),o(q,Ne),o(q,Ee),o(Ee,de),o(de,Ie),o(Ie,Oe),o(Ee,ke),o(Ee,he),o(q,we),o(q,be),ie||(x=[ue(i,"ionRefresh",r[10]),ue(y,"click",r[27]),ue(Ee,"click",r[29])],ie=!0)},p(z,b){b[0]&131&&e!==(e=z[14](z[7],z[1],z[0])+"")&&Le(t,e),b[0]&64&&E!==(E="$"+z[6].origin)&&J(h,"title",E),b[0]&64&&N(h,"background-color",z[6].color),b[0]&64&&N(h,"color",Ae(z[6].color)),b[0]&64&&F!==(F=z[6].origin+"")&&Le(K,F),b[0]&331808&&(le=Be(z[5]),D=xe(D,b,O,1,z,le,B,_,$e,qt,j,Ht)),b[0]&32&&fe!==(fe=z[5].length+1+"")&&Le(se,fe),b[0]&64&&ae!==(ae="$"+z[6].destination)&&J(ne,"title",ae),b[0]&64&&N(ne,"background-color",z[6].color),b[0]&64&&N(ne,"color",Ae(z[6].color)),b[0]&64&&Te!==(Te=z[6].destination+"")&&Le(Oe,Te)},d(z){z&&(a(t),a(l),a(n)),r[26](null);for(let b=0;b<D.length;b+=1)D[b].d();ie=!1,Pe(x)}}}function go(r){let e,t,l='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Jale para actualizar" refreshing-spinner="circles" refreshing-text="Actualizando..."></ion-refresher-content>',n,i,d,u,_,C,g="0",h,f,p,E,T,y=r[6].origin+"",U,A,F,K="",V,S,H,k=[],M=new Map,P,D,B,j,q,ee=r[5].length+1+"",ne,oe,fe,se,ae,Ne,Ee=r[6].destination+"",de,Ie,Te,Oe="",ke,he,ye,we,be=Be(r[5]);const ie=x=>x[48].id_event;for(let x=0;x<be.length;x+=1){let le=Bt(r,be,x),O=ie(le);M.set(O,k[x]=Kt(O,le))}return{c(){e=s("ion-content"),t=s("ion-refresher"),t.innerHTML=l,n=w(),i=s("ion-list"),d=s("ion-item"),u=s("ion-avatar"),_=s("div"),C=s("div"),C.textContent=g,f=w(),p=s("ion-label"),E=s("ion-text"),T=s("h3"),U=ve(y),A=w(),F=s("div"),F.innerHTML=K,V=w(),S=s("ion-icon"),H=w();for(let x=0;x<k.length;x+=1)k[x].c();P=w(),D=s("ion-item"),B=s("ion-avatar"),j=s("div"),q=s("div"),ne=ve(ee),fe=w(),se=s("ion-label"),ae=s("ion-text"),Ne=s("h3"),de=ve(Ee),Ie=w(),Te=s("div"),Te.innerHTML=Oe,ke=w(),he=s("ion-icon"),this.h()},l(x){e=c(x,"ION-CONTENT",{});var le=m(e);t=c(le,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),te(t)!=="svelte-15ukrgn"&&(t.innerHTML=l),n=L(le),i=c(le,"ION-LIST",{});var O=m(i);d=c(O,"ION-ITEM",{});var z=m(d);u=c(z,"ION-AVATAR",{slot:!0});var b=m(u);_=c(b,"DIV",{class:!0,title:!0,style:!0});var R=m(_);C=c(R,"DIV",{class:!0,"data-svelte-h":!0}),te(C)!=="svelte-3lvlrb"&&(C.textContent=g),R.forEach(a),b.forEach(a),f=L(z),p=c(z,"ION-LABEL",{button:!0});var G=m(p);E=c(G,"ION-TEXT",{color:!0});var W=m(E);T=c(W,"H3",{});var $=m(T);U=ge($,y),$.forEach(a),W.forEach(a),A=L(G),F=c(G,"DIV",{class:!0,"data-svelte-h":!0}),te(F)!=="svelte-gz9kb"&&(F.innerHTML=K),G.forEach(a),V=L(z),S=c(z,"ION-ICON",{icon:!0,slot:!0}),m(S).forEach(a),z.forEach(a),H=L(O);for(let Ce=0;Ce<k.length;Ce+=1)k[Ce].l(O);P=L(O),D=c(O,"ION-ITEM",{});var I=m(D);B=c(I,"ION-AVATAR",{slot:!0});var X=m(B);j=c(X,"DIV",{class:!0,title:!0,style:!0});var Z=m(j);q=c(Z,"DIV",{class:!0});var Q=m(q);ne=ge(Q,ee),Q.forEach(a),Z.forEach(a),X.forEach(a),fe=L(I),se=c(I,"ION-LABEL",{button:!0});var re=m(se);ae=c(re,"ION-TEXT",{color:!0});var pe=m(ae);Ne=c(pe,"H3",{});var ce=m(Ne);de=ge(ce,Ee),ce.forEach(a),pe.forEach(a),Ie=L(re),Te=c(re,"DIV",{class:!0,"data-svelte-h":!0}),te(Te)!=="svelte-130ohbs"&&(Te.innerHTML=Oe),re.forEach(a),ke=L(I),he=c(I,"ION-ICON",{icon:!0,slot:!0}),m(he).forEach(a),I.forEach(a),O.forEach(a),le.forEach(a),this.h()},h(){v(t,"slot","fixed"),J(C,"class","order svelte-egzizz"),J(_,"class","order-wrapper svelte-egzizz"),J(_,"title",h="$"+r[6].origin),N(_,"background-color",r[6].color),N(_,"color",Ae(r[6].color)),v(u,"slot","start"),v(E,"color","#2e2e2e"),J(F,"class","sub svelte-egzizz"),v(p,"button",""),v(S,"icon",Re),v(S,"slot","end"),J(q,"class","order svelte-egzizz"),J(j,"class","order-wrapper svelte-egzizz"),J(j,"title",oe="$"+r[6].destination),N(j,"background-color",r[6].color),N(j,"color",Ae(r[6].color)),v(B,"slot","start"),v(ae,"color","#2e2e2e"),J(Te,"class","sub svelte-egzizz"),v(se,"button",""),v(he,"icon",Re),v(he,"slot","end")},m(x,le){Y(x,e,le),o(e,t),r[22](t),o(e,n),o(e,i),o(i,d),o(d,u),o(u,_),o(_,C),o(d,f),o(d,p),o(p,E),o(E,T),o(T,U),o(p,A),o(p,F),o(d,V),o(d,S),o(i,H);for(let O=0;O<k.length;O+=1)k[O]&&k[O].m(i,null);o(i,P),o(i,D),o(D,B),o(B,j),o(j,q),o(q,ne),o(D,fe),o(D,se),o(se,ae),o(ae,Ne),o(Ne,de),o(se,Ie),o(se,Te),o(D,ke),o(D,he),ye||(we=[ue(t,"ionRefresh",r[10]),ue(p,"click",r[23]),ue(se,"click",r[25])],ye=!0)},p(x,le){le[0]&64&&h!==(h="$"+x[6].origin)&&J(_,"title",h),le[0]&64&&N(_,"background-color",x[6].color),le[0]&64&&N(_,"color",Ae(x[6].color)),le[0]&64&&y!==(y=x[6].origin+"")&&Le(U,y),le[0]&331808&&(be=Be(x[5]),k=xe(k,le,ie,1,x,be,M,i,$e,Kt,P,Bt)),le[0]&32&&ee!==(ee=x[5].length+1+"")&&Le(ne,ee),le[0]&64&&oe!==(oe="$"+x[6].destination)&&J(j,"title",oe),le[0]&64&&N(j,"background-color",x[6].color),le[0]&64&&N(j,"color",Ae(x[6].color)),le[0]&64&&Ee!==(Ee=x[6].destination+"")&&Le(de,Ee)},d(x){x&&a(e),r[22](null);for(let le=0;le<k.length;le+=1)k[le].d();ye=!1,Pe(we)}}}function jt(r){let e;return{c(){e=s("span"),this.h()},l(t){e=c(t,"SPAN",{class:!0}),m(e).forEach(a),this.h()},h(){J(e,"class","notes svelte-egzizz")},m(t,l){Y(t,e,l)},d(t){t&&a(e)}}}function qt(r,e){let t,l,n,i,d=parseInt(e[48].pos)+1+"",u,_,C,g,h,f,p=e[48].title+"",E,T,y=e[48].support_list&&e[48].support_list.length||e[16](e[48]),U,A,F="",K,V,S,H,k=y&&jt();function M(){return e[28](e[48])}return{key:r,first:null,c(){t=s("ion-item"),l=s("ion-avatar"),n=s("div"),i=s("div"),u=ve(d),C=w(),g=s("ion-label"),h=s("ion-text"),f=s("h3"),E=ve(p),T=w(),k&&k.c(),U=w(),A=s("div"),A.innerHTML=F,K=w(),V=s("ion-icon"),this.h()},l(P){t=c(P,"ION-ITEM",{});var D=m(t);l=c(D,"ION-AVATAR",{slot:!0});var B=m(l);n=c(B,"DIV",{class:!0,title:!0,style:!0});var j=m(n);i=c(j,"DIV",{class:!0});var q=m(i);u=ge(q,d),q.forEach(a),j.forEach(a),B.forEach(a),C=L(D),g=c(D,"ION-LABEL",{button:!0});var ee=m(g);h=c(ee,"ION-TEXT",{color:!0});var ne=m(h);f=c(ne,"H3",{});var oe=m(f);E=ge(oe,p),T=L(oe),k&&k.l(oe),oe.forEach(a),ne.forEach(a),U=L(ee),A=c(ee,"DIV",{class:!0,"data-svelte-h":!0}),te(A)!=="svelte-qaecoo"&&(A.innerHTML=F),ee.forEach(a),K=L(D),V=c(D,"ION-ICON",{icon:!0,slot:!0}),m(V).forEach(a),D.forEach(a),this.h()},h(){J(i,"class","order svelte-egzizz"),J(n,"class","order-wrapper svelte-egzizz"),J(n,"title",_=Xe(e[48].status)),N(n,"background-color",De(e[48].status,e[48].date_service)),N(n,"color",Ae(De(e[48].status))),v(l,"slot","start"),v(h,"color","#2e2e2e"),J(A,"class","sub svelte-egzizz"),v(g,"button",""),v(V,"icon",Re),v(V,"slot","end"),this.first=t},m(P,D){Y(P,t,D),o(t,l),o(l,n),o(n,i),o(i,u),o(t,C),o(t,g),o(g,h),o(h,f),o(f,E),o(f,T),k&&k.m(f,null),o(g,U),o(g,A),o(t,K),o(t,V),S||(H=ue(g,"click",M),S=!0)},p(P,D){e=P,D[0]&32&&d!==(d=parseInt(e[48].pos)+1+"")&&Le(u,d),D[0]&32&&_!==(_=Xe(e[48].status))&&J(n,"title",_),D[0]&32&&N(n,"background-color",De(e[48].status,e[48].date_service)),D[0]&32&&N(n,"color",Ae(De(e[48].status))),D[0]&32&&p!==(p=e[48].title+"")&&Le(E,p),D[0]&32&&(y=e[48].support_list&&e[48].support_list.length||e[16](e[48])),y?k||(k=jt(),k.c(),k.m(f,null)):k&&(k.d(1),k=null)},d(P){P&&a(t),k&&k.d(),S=!1,H()}}}function Gt(r){let e;return{c(){e=s("span"),this.h()},l(t){e=c(t,"SPAN",{class:!0}),m(e).forEach(a),this.h()},h(){J(e,"class","notes svelte-egzizz")},m(t,l){Y(t,e,l)},d(t){t&&a(e)}}}function Kt(r,e){let t,l,n,i,d=parseInt(e[48].pos)+1+"",u,_,C,g,h,f,p=e[48].title+"",E,T,y=e[48].support_list&&e[48].support_list.length||e[16](e[48]),U,A,F="",K,V,S,H,k=y&&Gt();function M(){return e[24](e[48])}return{key:r,first:null,c(){t=s("ion-item"),l=s("ion-avatar"),n=s("div"),i=s("div"),u=ve(d),C=w(),g=s("ion-label"),h=s("ion-text"),f=s("h3"),E=ve(p),T=w(),k&&k.c(),U=w(),A=s("div"),A.innerHTML=F,K=w(),V=s("ion-icon"),this.h()},l(P){t=c(P,"ION-ITEM",{});var D=m(t);l=c(D,"ION-AVATAR",{slot:!0});var B=m(l);n=c(B,"DIV",{class:!0,title:!0,style:!0});var j=m(n);i=c(j,"DIV",{class:!0});var q=m(i);u=ge(q,d),q.forEach(a),j.forEach(a),B.forEach(a),C=L(D),g=c(D,"ION-LABEL",{button:!0});var ee=m(g);h=c(ee,"ION-TEXT",{color:!0});var ne=m(h);f=c(ne,"H3",{});var oe=m(f);E=ge(oe,p),T=L(oe),k&&k.l(oe),oe.forEach(a),ne.forEach(a),U=L(ee),A=c(ee,"DIV",{class:!0,"data-svelte-h":!0}),te(A)!=="svelte-qaecoo"&&(A.innerHTML=F),ee.forEach(a),K=L(D),V=c(D,"ION-ICON",{icon:!0,slot:!0}),m(V).forEach(a),D.forEach(a),this.h()},h(){J(i,"class","order svelte-egzizz"),J(n,"class","order-wrapper svelte-egzizz"),J(n,"title",_=Xe(e[48].status)),N(n,"background-color",De(e[48].status,e[48].date_service)),N(n,"color",Ae(De(e[48].status))),v(l,"slot","start"),v(h,"color","#2e2e2e"),J(A,"class","sub svelte-egzizz"),v(g,"button",""),v(V,"icon",Re),v(V,"slot","end"),this.first=t},m(P,D){Y(P,t,D),o(t,l),o(l,n),o(n,i),o(i,u),o(t,C),o(t,g),o(g,h),o(h,f),o(f,E),o(f,T),k&&k.m(f,null),o(g,U),o(g,A),o(t,K),o(t,V),S||(H=ue(g,"click",M),S=!0)},p(P,D){e=P,D[0]&32&&d!==(d=parseInt(e[48].pos)+1+"")&&Le(u,d),D[0]&32&&_!==(_=Xe(e[48].status))&&J(n,"title",_),D[0]&32&&N(n,"background-color",De(e[48].status,e[48].date_service)),D[0]&32&&N(n,"color",Ae(De(e[48].status))),D[0]&32&&p!==(p=e[48].title+"")&&Le(E,p),D[0]&32&&(y=e[48].support_list&&e[48].support_list.length||e[16](e[48])),y?k||(k=Gt(),k.c(),k.m(f,null)):k&&(k.d(1),k=null)},d(P){P&&a(t),k&&k.d(),S=!1,H()}}}function bo(r){let e,t,l,n,i=`<ion-icon icon="${Tn}"></ion-icon>`,d,u,_,C=`<ion-icon icon="${Cn}"></ion-icon>`,g,h,f=(r[6].name?r[6].name.toUpperCase():"")+"",p,E,T,y='<ion-segment-button value="list"><ion-label>Paradas</ion-label></ion-segment-button> <ion-segment-button value="map"><ion-label>Mapa</ion-label></ion-segment-button>',U,A,F,K;function V(k,M){if(k[9]==="list")return ho;if(k[9]==="map")return _o}let S=V(r),H=S&&S(r);return{c(){e=s("ion-header"),t=s("ion-toolbar"),l=s("ion-buttons"),n=s("ion-button"),n.innerHTML=i,d=w(),u=s("ion-buttons"),_=s("ion-button"),_.innerHTML=C,g=w(),h=s("ion-title"),p=ve(f),E=w(),T=s("ion-segment"),T.innerHTML=y,U=w(),H&&H.c(),A=Me(),this.h()},l(k){e=c(k,"ION-HEADER",{translucent:!0});var M=m(e);t=c(M,"ION-TOOLBAR",{});var P=m(t);l=c(P,"ION-BUTTONS",{slot:!0});var D=m(l);n=c(D,"ION-BUTTON",{title:!0,alt:!0,"data-svelte-h":!0}),te(n)!=="svelte-7ppz3r"&&(n.innerHTML=i),D.forEach(a),d=L(P),u=c(P,"ION-BUTTONS",{slot:!0});var B=m(u);_=c(B,"ION-BUTTON",{"data-svelte-h":!0}),te(_)!=="svelte-nf50hj"&&(_.innerHTML=C),B.forEach(a),g=L(P),h=c(P,"ION-TITLE",{});var j=m(h);p=ge(j,f),j.forEach(a),P.forEach(a),E=L(M),T=c(M,"ION-SEGMENT",{value:!0,"data-svelte-h":!0}),te(T)!=="svelte-lue4c9"&&(T.innerHTML=y),M.forEach(a),U=L(k),H&&H.l(k),A=Me(),this.h()},h(){v(n,"title","Atrás"),v(n,"alt","Atrás"),v(l,"slot","start"),v(u,"slot","end"),v(T,"value","list"),v(e,"translucent","")},m(k,M){Y(k,e,M),o(e,t),o(t,l),o(l,n),o(t,d),o(t,u),o(u,_),o(t,g),o(t,h),o(h,p),o(e,E),o(e,T),Y(k,U,M),H&&H.m(k,M),Y(k,A,M),F||(K=[ue(n,"click",r[17]),ue(_,"click",r[20]),ue(T,"ionChange",r[21])],F=!0)},p(k,M){M[0]&64&&f!==(f=(k[6].name?k[6].name.toUpperCase():"")+"")&&Le(p,f),S===(S=V(k))&&H?H.p(k,M):(H&&H.d(1),H=S&&S(k),H&&(H.c(),H.m(A.parentNode,A)))},d(k){k&&(a(e),a(U),a(A)),H&&H.d(k),F=!1,Pe(K)}}}function Eo(r){let e,t,l,n=r[2]&&Rt(r);return{c(){e=w(),n&&n.c(),t=Me(),this.h()},l(i){on("svelte-kn0kph",Dt.head).forEach(a),e=L(i),n&&n.l(i),t=Me(),this.h()},h(){Dt.title="Rutaflow - Detalles de ruta"},m(i,d){Y(i,e,d),n&&n.m(i,d),Y(i,t,d),l=!0},p(i,d){i[2]?n?(n.p(i,d),d[0]&4&&it(n,1)):(n=Rt(i),n.c(),it(n,1),n.m(t.parentNode,t)):n&&(dn(),st(n,1,1,()=>{n=null}),an())},i(i){l||(it(n),l=!0)},o(i){st(n),l=!1},d(i){i&&(a(e),a(t)),n&&n.d(i)}}}function De(r,e=""){let t="#ffffff";return r==="pending"&&!e?t="#f2e300":r=="pending"&&e?t="#F6A833":r==="completed"&&(t="#44d900"),t}function Xe(r){let e="";return r=="pending"?e="Pendiente":r=="completed"&&(e="Completado"),e}function Ae(r){r.slice(0,1)==="#"&&(r=r.slice(1)),r.length===3&&(r=r.split("").map(function(i){return i+i}).join(""));const e=parseInt(r.substr(0,2),16),t=parseInt(r.substr(2,2),16),l=parseInt(r.substr(4,2),16);return(e*299+t*587+l*114)/1e3>=128?"#414040":"#fff"}function Xt(r,e){for(let t=0;t<e.length;t++)if(e[t].alias===r)return e[t].val;return""}const Io=r=>r.mandatory==="1",ko=r=>r.img;function Oo(r,e,t){let l;ln(r,yn,O=>t(19,l=O));var n=this&&this.__awaiter||function(O,z,b,R){function G(W){return W instanceof b?W:new b(function($){$(W)})}return new(b||(b=Promise))(function(W,$){function I(Q){try{Z(R.next(Q))}catch(re){$(re)}}function X(Q){try{Z(R.throw(Q))}catch(re){$(re)}}function Z(Q){Q.done?W(Q.value):G(Q.value).then(I,X)}Z((R=R.apply(O,z||[])).next())})};let{routeId:i}=e,{driverId:d}=e,u=rt,_=new Object,C=!0,g=!1,h=[],f={},p=[],E=[],T,y=!1,U="list",A,F="",K="",V=new Object;const S=()=>n(void 0,void 0,void 0,function*(){yield M(i),T.complete()});Ze(()=>n(void 0,void 0,void 0,function*(){ae(),yield M(i)}));function H(O){return n(this,void 0,void 0,function*(){if(t(9,U=O),U==="map"){yield rn(),A=document.getElementById("g_map");const z=new google.maps.Map(A,{zoom:8,center:{lat:20.6745683,lng:-103.3986104},mapId:"4504f8b37365c3d0"}),b=new google.maps.LatLngBounds,{AdvancedMarkerElement:R,PinElement:G}=yield google.maps.importLibrary("marker");navigator.geolocation?navigator.geolocation.getCurrentPosition(function(W){const $=new google.maps.LatLng(W.coords.latitude,W.coords.longitude);new google.maps.Marker({position:$,map:z,icon:{path:google.maps.SymbolPath.CIRCLE,fillColor:"#0062ff",fillOpacity:1,scale:6,strokeColor:"#ffffff",strokeWeight:2}}),new google.maps.Circle({strokeColor:"#00BFFF",strokeOpacity:.5,strokeWeight:1,fillColor:"#00BFFF",fillOpacity:.2,map:z,center:$,radius:W.coords.accuracy}),b.extend($)},function(W){console.error("Error retrieving location:",W)}):console.error("Geolocation not supported by this browser."),f.lat1===f.lat2&&f.lon1===f.lon2?k(b,z,{lat:f.lat2,lon:f.lon2,color:f.color,title:f.destination},{type:"icon",iconClass:"icon-home",title:"Origen/Destino",glyph:`0,${String(h.length+1)}`}):(k(b,z,{lat:f.lat1,lon:f.lon1,color:f.color,title:f.origin},{type:"icon",iconClass:"icon-home",title:"Origen",glyph:"0"}),k(b,z,{lat:f.lat2,lon:f.lon2,color:f.color,title:f.destination},{type:"icon",iconClass:"icon-flag",title:"Destino",glyph:String(h.length+1)})),h.forEach((W,$)=>{const I=parseFloat(W.lat),X=parseFloat(W.lon),Z=new google.maps.LatLng(I,X),Q=new google.maps.Marker({position:{lat:I,lng:X},map:z,title:W.title}),re=new G({background:De(W.status,W.date_service),borderColor:"#000",glyphColor:"#000",glyph:(parseInt(W.pos)+1).toString()});new R({map:z,position:Z,content:re.element,title:"Parada "+(parseInt(W.pos)+1).toString()+": "+W.title}).addListener("click",function(ce){D(W,!1)}),b.extend(Q.getPosition())}),z.fitBounds(b)}})}function k(O,z,b,R){return n(this,void 0,void 0,function*(){let G;const W=parseFloat(b.lat),$=parseFloat(b.lon),I=new google.maps.LatLng(W,$),{AdvancedMarkerElement:X,PinElement:Z}=yield google.maps.importLibrary("marker");R.type=="icon"?(G=document.createElement("i"),G.className=`${R.iconClass} icon`,G.style.fontSize="14px",G.style.color=Ae(b.color),G.style.fontWeight="600"):R.type=="text";const Q=new google.maps.Marker({position:{lat:W,lng:$},map:z,title:`${R.title}. ${b.title}`}),re=new Z({background:b.color,borderColor:"#000",glyphColor:Ae(b.color),glyph:R.glyph});return new X({map:z,position:I,content:re.element,title:R.title+": "+b.title}).addListener("click",function(ce){B(f,R.title=="Destino"||R.title=="Origen/Destino")}),Q})}function M(O){return n(this,void 0,void 0,function*(){let z=new FormData;z.append("id_route",O),z=se(z);try{const R=yield(yield fetch(`${u}api/admin/report/seguimiento_list.php`,{method:"POST",body:z})).json();t(6,f=R.data.seguimiento_list[0]),t(5,h=R.data.event_list),t(7,p=R.data.checklist),E=R.data.expenses,f&&t(4,g=f.km_inicial=="0"&&f.gas_inicial=="0"),t(3,C=!1)}catch(b){t(3,C=!1),console.error("Error fetching data:",b)}})}const P=O=>new Promise((z,b)=>{let R=new FormData;R.append("id_route",O.id_route),R.append("id_event",O.id_event),R=se(R),fetch(`${u}api/admin/evidence/evidence_by_event.php`,{method:"POST",body:R}).then(G=>G.json()).then(G=>{z(G.data.event_evidence[0])}).catch(G=>{console.error("Error fetching data:",G),b(G)})}),D=(O,z)=>{P(O).then(b=>{O.stopsApproval=F,O.smsActive=K,b&&(O.img=b.img,O.driver_comments=b.driver_comments,O.comments=b.comments),Ue("modal-delivery-info",Lt,{delivery:O,isLast:z}).then(R=>{}).finally(()=>{M(i)})})},B=(O,z)=>{var b=new Object;z?b={title:O.destination,line1:O.dest_address}:b={title:O.origin,line1:O.origin_address},b.client_name=O.client_name,b.client_phone=O.tel,b.id_route=O.id_route,b.stopsApproval=F,b.smsActive=K;var R=!0;Ue("modal-delivery-info",Lt,{delivery:b,isLast:z,flag:R})},j=(O,z,b)=>{var R=!1;return y||(y=!0,Ue("modal-checklist",Zt,{checklist:O,driverId:z,routeId:b,isLast:R}).then(G=>{y=!1}),ne(b,"checklist")),""},q=O=>n(void 0,void 0,void 0,function*(){return yield M(O),E.length>0?Ue("modal-expense-detail",fo,{routeId:O,expenses:E}).then(z=>{}):Ue("modal-expense",ft,{routeId:O}).then(z=>{}),""}),ee=O=>{if(O.tracking_type=="subscription"){if(O.subscriber_info&&O.payment_type==="cash"&&new Date(O.subscriber_info.payment_next)<new Date)return!0}else if(O.tracking_type=="ecommerce"&&Number(O.payment_pending)>0)return!0;return!1};function ne(O,z){let b=new FormData;return b.append("id_route",O),b.append("status",z),b=se(b),fetch(`${u}api/admin/route/change_status.php`,{method:"POST",body:b}).then(R=>R.json()).then(R=>{}).catch(R=>{console.error("Error fetching data:",R)}),""}const oe=()=>{_.type=="super"||_.type=="admin"?Fe("/drivers/me"):_.id_driver&&Fe(`/drivers/${_.id_driver}`)},fe=(O,z)=>n(void 0,void 0,void 0,function*(){yield(yield je.create({header:O||"Error",message:z||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()});function se(O){return O.append("token",_.token),O.append("id_user_over",_.id_user),O}const ae=()=>n(void 0,void 0,void 0,function*(){if(_.id_enterprise){let O=new FormData;O.append("id_enterprise",_.id_enterprise),O=se(O);try{const z=yield fetch(`${u}api/admin/enterprise/enterprise_settings.php`,{method:"POST",body:O});z.ok?(V=(yield z.json()).nodos,F=Xt("stops_wait_approval",V),K=Xt("sms_active",V)):console.error("File upload failed:",z.statusText)}catch(z){console.error("Error during file upload:",z)}}}),Ne=()=>q(i),Ee=O=>H(O.detail.value);function de(O){Se[O?"unshift":"push"](()=>{T=O,t(8,T)})}const Ie=()=>{B(f,!1)},Te=O=>{const z=h.findIndex($=>$.id_event===O.id_event),b=z===0,R=z>0?h[z-1]:null,G=b||R&&R.img!==null,W=O.img!==null&&O.img!=="";G||b&&!W?D(O,!1):fe("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")},Oe=()=>{B(f,!0)};function ke(O){Se[O?"unshift":"push"](()=>{T=O,t(8,T)})}const he=()=>{B(f,!1)},ye=O=>{const z=h.findIndex($=>$.id_event===O.id_event),b=z===0,R=z>0?h[z-1]:null,G=b||R&&R.img!==null,W=O.img!==null&&O.img!=="";G||b&&!W?D(O,!1):fe("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")},we=()=>{B(f,!0)};function be(O){Se[O?"unshift":"push"](()=>{T=O,t(8,T)})}const ie=()=>{B(f,!1)},x=O=>{const z=h.findIndex($=>$.id_event===O.id_event),b=z===0,R=z>0?h[z-1]:null,G=b||R&&R.img!==null,W=O.img!==null&&O.img!=="";G||b&&!W?D(O,!1):fe("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")},le=()=>{B(f,!0)};return r.$$set=O=>{"routeId"in O&&t(0,i=O.routeId),"driverId"in O&&t(1,d=O.driverId)},r.$$.update=()=>{r.$$.dirty[0]&524293&&(t(0,{routeId:i,driverId:d}=l.params,i,(t(1,d),t(19,l),t(2,_),t(0,i))),t(2,_=JSON.parse(localStorage.getItem("userSession"))),_?_.id_user&&(_.type=="admin"||_.type=="super")?(M(i),Fe(`/drivers/me/routes/${i}`)):_.id_user&&_.id_driver&&(M(i),Fe(`/drivers/${_.id_driver}/routes/${i}`)):Fe("/"))},[i,d,_,C,g,h,f,p,T,U,S,H,D,B,j,q,ee,oe,fe,l,Ne,Ee,de,Ie,Te,Oe,ke,he,ye,we,be,ie,x,le]}class Ao extends Je{constructor(e){super(),Ye(this,e,Oo,Eo,We,{routeId:0,driverId:1},null,[-1,-1])}}export{Ao as component};

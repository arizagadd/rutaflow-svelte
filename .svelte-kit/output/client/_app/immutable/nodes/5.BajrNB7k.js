import{Z as Ct,s as ot,e as c,j as N,b as u,q as b,d as Z,h as a,m as T,v as p,i as U,w as l,x as le,n as Oe,z as We,_ as dn,B as q,o as st,k as He,$ as yt,t as ce,r as ue,f as Y,a0 as hn,a1 as at,A as ze,y as Pe,a2 as vt,l as pn,p as mn,F as vn}from"../chunks/index.BzUyNcuj.js";import{S as lt,i as it,t as mt,a as kt,c as gn,b as bn,d as En,m as In,e as kn,g as On}from"../chunks/index.D9GPdhpm.js";import{e as Ke,u as ct,d as ut,a as Nn,c as Ot,b as Tn,f as Cn,g as sn,h as yn,i as wn,j as cn,k as Ln,m as un,s as wt,n as rt,o as Sn,q as Pn,r as Mn,t as An,v as Bn,p as Dn}from"../chunks/index.JDPEvLd4.js";import"../chunks/index-6e05b96e.C_9q9BoX.js";import{m as ft,a as Ye,I as zn}from"../chunks/IonPage.xQ4lM5iK.js";import{q as Hn,t as Rn}from"../chunks/ion-modal.BYMRzj9z.js";import{g as Qe}from"../chunks/entry.YrHLBCAJ.js";const Un=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global,Fn=(i,e)=>{if(!customElements.get(i)){class t extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const n={};for(const r of this.attributes)n[r.name]=r.value;new e({target:this.shadowRoot,props:n})}}customElements.define(i,t)}},qn=function(i){return document.createElement(i).constructor!==HTMLElement},jn=(i,e)=>{qn(i)||Fn(i,e)},Xe=async(i,e,t)=>{Hn(),Rn(),jn(i,e);const o=await ft.create({component:i,componentProps:t});return o.present(),await o.onWillDismiss()};let et=Ct({km_inicial:[],gas_inicial:[],km_final:[],gas_final:[]}),fn=Ct({flag:[]});function Vn(i){let e,t,o,n,r="Cancelar",d,_,E="Captura de Km/Gas",O,k,f,s="Confirmar",g,h,m,v,L,y,z;return{c(){e=c("ion-header"),t=c("ion-toolbar"),o=c("ion-buttons"),n=c("ion-button"),n.textContent=r,d=N(),_=c("ion-title"),_.textContent=E,O=N(),k=c("ion-buttons"),f=c("ion-button"),f.textContent=s,g=N(),h=c("ion-content"),m=c("ion-item"),v=c("ion-input"),this.h()},l(M){e=u(M,"ION-HEADER",{translucent:!0});var H=b(e);t=u(H,"ION-TOOLBAR",{});var C=b(t);o=u(C,"ION-BUTTONS",{slot:!0});var w=b(o);n=u(w,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),Z(n)!=="svelte-17pq4f4"&&(n.textContent=r),w.forEach(a),d=T(C),_=u(C,"ION-TITLE",{"data-svelte-h":!0}),Z(_)!=="svelte-1yhkaq7"&&(_.textContent=E),O=T(C),k=u(C,"ION-BUTTONS",{slot:!0});var S=b(k);f=u(S,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),Z(f)!=="svelte-cm6j4s"&&(f.textContent=s),S.forEach(a),C.forEach(a),H.forEach(a),g=T(M),h=u(M,"ION-CONTENT",{fullscreen:!0});var I=b(h);m=u(I,"ION-ITEM",{});var B=b(m);v=u(B,"ION-INPUT",{class:!0,inputmode:!0,pattern:!0,type:!0,placeholder:!0,value:!0,required:!0});var R=b(v);R.forEach(a),B.forEach(a),I.forEach(a),this.h()},h(){p(n,"color","medium"),p(o,"slot","start"),p(f,"strong",""),p(k,"slot","end"),p(e,"translucent",""),p(v,"class","fin-km"),p(v,"inputmode","numeric"),p(v,"pattern","[0-9]*"),p(v,"type","number"),p(v,"placeholder",L="Ingresa "+i[0]+" actual"),p(v,"value",i[1]),p(v,"required",""),p(h,"fullscreen","")},m(M,H){U(M,e,H),l(e,t),l(t,o),l(o,n),l(t,d),l(t,_),l(t,O),l(t,k),l(k,f),U(M,g,H),U(M,h,H),l(h,m),l(m,v),y||(z=[le(n,"click",i[2]),le(f,"click",i[3]),le(v,"input",i[4])],y=!0)},p(M,[H]){H&1&&L!==(L="Ingresa "+M[0]+" actual")&&p(v,"placeholder",L),H&2&&p(v,"value",M[1])},i:Oe,o:Oe,d(M){M&&(a(e),a(g),a(h)),y=!1,We(z)}}}function Gn(i,e,t){const o=dn();let n=document.querySelector("ion-modal"),r=n.componentProps.data_type;n.componentProps.isLast;let d;fn.subscribe(f=>{r=f.flag[0],r=="km_final"||r=="km_inicial"?t(0,d="kilometraje"):t(0,d="litros de gasolina")});let _=0;function E(){ft.dismiss()}function O(){o("modalResult",{data:"Your data",role:"confirm"}),r=="km_inicial"?et.update(s=>({...s,km_inicial:[_]})):r=="gas_inicial"?et.update(s=>({...s,gas_inicial:[_]})):r=="km_final"?et.update(s=>({...s,km_final:[_]})):r=="gas_final"&&et.update(s=>({...s,gas_final:[_]})),E()}return[d,_,E,O,f=>t(1,_=f.target.value)]}class Kn extends lt{constructor(e){super(),it(this,e,Gn,Vn,ot,{})}}const Et=Ct({items:[],checkedIndices:[],mandatory:[]});function zt(i,e,t){const o=i.slice();return o[51]=e[t],o[52]=e,o[53]=t,o}function Wn(i){let e,t,o,n,r,d="Kilometraje inicial",_,E,O=i[0]?i[0]+" km.":"Cargar km",k,f,s,g,h,m,v,L="Gasolina inicial (litros)",y,z,M=i[1]?i[1]+" litros":"Cargar gas",H,C,w,S;return C=yt(i[21][0]),{c(){e=c("ion-item"),t=c("ion-label"),o=c("input"),n=N(),r=c("p"),r.textContent=d,_=N(),E=c("ion-button"),k=ce(O),f=N(),s=c("ion-item"),g=c("ion-label"),h=c("input"),m=N(),v=c("p"),v.textContent=L,y=N(),z=c("ion-button"),H=ce(M),this.h()},l(I){e=u(I,"ION-ITEM",{});var B=b(e);t=u(B,"ION-LABEL",{style:!0});var R=b(t);o=u(R,"INPUT",{id:!0,style:!0,type:!0}),n=T(R),r=u(R,"P",{style:!0,"data-svelte-h":!0}),Z(r)!=="svelte-88twxi"&&(r.textContent=d),R.forEach(a),_=T(B),E=u(B,"ION-BUTTON",{fill:!0,size:!0,class:!0,"aria-selected":!0});var P=b(E);k=ue(P,O),P.forEach(a),B.forEach(a),f=T(I),s=u(I,"ION-ITEM",{});var j=b(s);g=u(j,"ION-LABEL",{style:!0});var V=b(g);h=u(V,"INPUT",{id:!0,style:!0,type:!0}),m=T(V),v=u(V,"P",{style:!0,"data-svelte-h":!0}),Z(v)!=="svelte-1ux30eb"&&(v.textContent=L),V.forEach(a),y=T(j),z=u(j,"ION-BUTTON",{fill:!0,class:!0,size:!0,style:!0});var X=b(z);H=ue(X,M),X.forEach(a),j.forEach(a),this.h()},h(){Y(o,"id","chkbox-km-ini"),q(o,"pointer-events","auto"),Y(o,"type","checkbox"),o.required=!0,q(r,"margin-left","10px"),q(t,"display","flex"),p(E,"fill","outline"),p(E,"size","small"),p(E,"class","loadKmInicial"),p(E,"aria-selected",""),Y(h,"id","chkbox-gas-ini"),q(h,"pointer-events","auto"),Y(h,"type","checkbox"),h.required=!0,q(v,"margin-left","10px"),q(g,"display","flex"),p(z,"fill","outline"),p(z,"class","loadGasInicial"),p(z,"size","small"),q(z,"height","16px "),C.p(o,h)},m(I,B){U(I,e,B),l(e,t),l(t,o),o.checked=~(i[4]||[]).indexOf(o.__value),i[28](o),l(t,n),l(t,r),l(e,_),l(e,E),l(E,k),U(I,f,B),U(I,s,B),l(s,g),l(g,h),i[30](h),h.checked=~(i[4]||[]).indexOf(h.__value),l(g,m),l(g,v),l(s,y),l(s,z),l(z,H),w||(S=[le(o,"change",i[27]),le(E,"click",i[29]),le(h,"change",i[31]),le(z,"click",i[32])],w=!0)},p(I,B){B[0]&16&&(o.checked=~(I[4]||[]).indexOf(o.__value)),B[0]&1&&O!==(O=I[0]?I[0]+" km.":"Cargar km")&&Pe(k,O),B[0]&16&&(h.checked=~(I[4]||[]).indexOf(h.__value)),B[0]&2&&M!==(M=I[1]?I[1]+" litros":"Cargar gas")&&Pe(H,M)},d(I){I&&(a(e),a(f),a(s)),i[28](null),i[30](null),C.r(),w=!1,We(S)}}}function Xn(i){let e,t,o,n,r,d="Kilometraje final",_,E,O=i[2]?i[2]+" km.":"Cargar km",k,f,s,g,h,m,v,L="Gasolina final (litros)",y,z,M=i[3]?i[3]+" litros":"Cargar gas",H,C,w,S;return C=yt(i[21][0]),{c(){e=c("ion-item"),t=c("ion-label"),o=c("input"),n=N(),r=c("p"),r.textContent=d,_=N(),E=c("ion-button"),k=ce(O),f=N(),s=c("ion-item"),g=c("ion-label"),h=c("input"),m=N(),v=c("p"),v.textContent=L,y=N(),z=c("ion-button"),H=ce(M),this.h()},l(I){e=u(I,"ION-ITEM",{});var B=b(e);t=u(B,"ION-LABEL",{style:!0});var R=b(t);o=u(R,"INPUT",{id:!0,style:!0,type:!0}),n=T(R),r=u(R,"P",{style:!0,"data-svelte-h":!0}),Z(r)!=="svelte-ccmu71"&&(r.textContent=d),R.forEach(a),_=T(B),E=u(B,"ION-BUTTON",{fill:!0,size:!0,class:!0,"aria-selected":!0});var P=b(E);k=ue(P,O),P.forEach(a),B.forEach(a),f=T(I),s=u(I,"ION-ITEM",{});var j=b(s);g=u(j,"ION-LABEL",{style:!0});var V=b(g);h=u(V,"INPUT",{id:!0,style:!0,type:!0}),m=T(V),v=u(V,"P",{style:!0,"data-svelte-h":!0}),Z(v)!=="svelte-wsoyd2"&&(v.textContent=L),V.forEach(a),y=T(j),z=u(j,"ION-BUTTON",{fill:!0,size:!0,class:!0});var X=b(z);H=ue(X,M),X.forEach(a),j.forEach(a),this.h()},h(){Y(o,"id","chkbox-km-fin"),q(o,"pointer-events","auto"),Y(o,"type","checkbox"),o.required=!0,q(r,"margin-left","10px"),q(t,"display","flex"),p(E,"fill","outline"),p(E,"size","small"),p(E,"class","loadKmInicial"),p(E,"aria-selected",""),Y(h,"id","chkbox-gas-fin"),q(h,"pointer-events","auto"),Y(h,"type","checkbox"),h.required=!0,q(v,"margin-left","10px"),q(g,"display","flex"),p(z,"fill","outline"),p(z,"size","small"),p(z,"class","loadGasInicial"),C.p(o,h)},m(I,B){U(I,e,B),l(e,t),l(t,o),o.checked=~(i[4]||[]).indexOf(o.__value),i[22](o),l(t,n),l(t,r),l(e,_),l(e,E),l(E,k),U(I,f,B),U(I,s,B),l(s,g),l(g,h),h.checked=~(i[4]||[]).indexOf(h.__value),i[25](h),l(g,m),l(g,v),l(s,y),l(s,z),l(z,H),w||(S=[le(o,"change",i[20]),le(E,"click",i[23]),le(h,"change",i[24]),le(z,"click",i[26])],w=!0)},p(I,B){B[0]&16&&(o.checked=~(I[4]||[]).indexOf(o.__value)),B[0]&4&&O!==(O=I[2]?I[2]+" km.":"Cargar km")&&Pe(k,O),B[0]&16&&(h.checked=~(I[4]||[]).indexOf(h.__value)),B[0]&8&&M!==(M=I[3]?I[3]+" litros":"Cargar gas")&&Pe(H,M)},d(I){I&&(a(e),a(f),a(s)),i[22](null),i[25](null),C.r(),w=!1,We(S)}}}function Jn(i){let e=[],t=new Map,o,n=Ke(i[13]);const r=d=>d[51].id_checklist_event;for(let d=0;d<n.length;d+=1){let _=zt(i,n,d),E=r(_);t.set(E,e[d]=Ht(E,_))}return{c(){for(let d=0;d<e.length;d+=1)e[d].c();o=He()},l(d){for(let _=0;_<e.length;_+=1)e[_].l(d);o=He()},m(d,_){for(let E=0;E<e.length;E+=1)e[E]&&e[E].m(d,_);U(d,o,_)},p(d,_){_[0]&407664&&(n=Ke(d[13]),e=ct(e,_,r,1,d,n,t,o.parentNode,ut,Ht,o,zt))},d(d){d&&a(o);for(let _=0;_<e.length;_+=1)e[_].d(d)}}}function Qn(i){let e,t=(i[12][i[51].id_checklist_event]?i[12][i[51].id_checklist_event]:"Cargar evidencia")+"",o;return{c(){e=c("label"),o=ce(t),this.h()},l(n){e=u(n,"LABEL",{for:!0,class:!0});var r=b(e);o=ue(r,t),r.forEach(a),this.h()},h(){Y(e,"for","chklist-"+i[51].id_checklist_event),Y(e,"class","button-label svelte-1ruehls")},m(n,r){U(n,e,r),l(e,o)},p(n,r){r[0]&4096&&t!==(t=(n[12][n[51].id_checklist_event]?n[12][n[51].id_checklist_event]:"Cargar evidencia")+"")&&Pe(o,t)},d(n){n&&a(e)}}}function Yn(i){let e;return{c(){e=c("ion-spinner"),this.h()},l(t){e=u(t,"ION-SPINNER",{name:!0,class:!0}),b(e).forEach(a),this.h()},h(){p(e,"name","dots"),p(e,"class","button-spinner svelte-1ruehls")},m(t,o){U(t,e,o)},p:Oe,d(t){t&&a(e)}}}function Ht(i,e){let t,o,n,r=e[51],d,_,E=e[51].item+"",O,k,f,s=e[51].mandatory=="1"?" * ":"",g,h,m,v,L,y,z,M,H,C;const w=()=>e[34](n,r),S=()=>e[34](null,r);function I(){return e[35](e[51])}function B(V,X){return V[11][V[51].id_checklist_event]?Yn:Qn}let R=B(e),P=R(e);function j(...V){return e[37](e[51],...V)}return M=yt(e[21][0]),{key:i,first:null,c(){t=c("ion-item"),o=c("ion-label"),n=c("input"),d=N(),_=c("p"),O=ce(E),k=N(),f=c("b"),g=ce(s),h=N(),m=c("ion-button"),v=c("div"),P.c(),L=N(),y=c("input"),z=N(),this.h()},l(V){t=u(V,"ION-ITEM",{});var X=b(t);o=u(X,"ION-LABEL",{style:!0});var x=b(o);n=u(x,"INPUT",{id:!0,style:!0,type:!0}),d=T(x),_=u(x,"P",{style:!0});var J=b(_);O=ue(J,E),k=T(J),J.forEach(a),f=u(x,"B",{style:!0});var W=b(f);g=ue(W,s),W.forEach(a),x.forEach(a),h=T(X),m=u(X,"ION-BUTTON",{fill:!0,class:!0,size:!0});var K=b(m);v=u(K,"DIV",{class:!0});var oe=b(v);P.l(oe),L=T(oe),y=u(oe,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0}),oe.forEach(a),K.forEach(a),z=T(X),X.forEach(a),this.h()},h(){Y(n,"id",`chkbox-${e[51].id_checklist_event}`),q(n,"pointer-events","auto"),Y(n,"type","checkbox"),n.__value=e[51].id_checklist_event,hn(n,n.__value),n.required=!0,q(_,"margin-left","10px"),q(f,"margin-left","5px"),q(o,"display","flex"),q(y,"display","none"),Y(y,"id","chklist-"+e[51].id_checklist_event),Y(y,"name","fileToUpload"),Y(y,"type","file"),Y(y,"accept","image/*"),Y(v,"class","button-content svelte-1ruehls"),p(m,"fill","outline"),p(m,"class","loadEvidence svelte-1ruehls"),p(m,"size","small"),M.p(n),this.first=t},m(V,X){U(V,t,X),l(t,o),l(o,n),n.checked=~(e[4]||[]).indexOf(n.__value),w(),l(o,d),l(o,_),l(_,O),l(_,k),l(o,f),l(f,g),l(t,h),l(t,m),l(m,v),P.m(v,null),l(v,L),l(v,y),e[36](y),l(t,z),H||(C=[le(n,"change",e[33]),le(n,"change",I),le(y,"change",j)],H=!0)},p(V,X){e=V,X[0]&16&&(n.checked=~(e[4]||[]).indexOf(n.__value)),r!==e[51]&&(S(),r=e[51],w()),R===(R=B(e))&&P?P.p(e,X):(P.d(1),P=R(e),P&&(P.c(),P.m(v,L)))},d(V){V&&a(t),S(),P.d(),e[36](null),M.r(),H=!1,We(C)}}}function Zn(i){let e,t,o,n,r="Cancelar",d,_,E="REQUERIMIENTOS DE RUTA",O,k,f,s,g,h,m,v="Confirmar",L,y;function z(w,S){return w[14]?Xn:Wn}let H=z(i)(i),C=i[13]&&Jn(i);return{c(){e=c("ion-header"),t=c("ion-toolbar"),o=c("ion-buttons"),n=c("ion-button"),n.textContent=r,d=N(),_=c("ion-title"),_.textContent=E,O=N(),k=c("ion-content"),f=c("ion-list"),H.c(),s=N(),C&&C.c(),g=N(),h=c("ion-footer"),m=c("ion-button"),m.textContent=v,this.h()},l(w){e=u(w,"ION-HEADER",{translucent:!0});var S=b(e);t=u(S,"ION-TOOLBAR",{});var I=b(t);o=u(I,"ION-BUTTONS",{slot:!0});var B=b(o);n=u(B,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),Z(n)!=="svelte-1dnmkxs"&&(n.textContent=r),B.forEach(a),d=T(I),_=u(I,"ION-TITLE",{"data-svelte-h":!0}),Z(_)!=="svelte-19bar5p"&&(_.textContent=E),I.forEach(a),S.forEach(a),O=T(w),k=u(w,"ION-CONTENT",{fullscreen:!0});var R=b(k);f=u(R,"ION-LIST",{});var P=b(f);H.l(P),s=T(P),C&&C.l(P),P.forEach(a),R.forEach(a),g=T(w),h=u(w,"ION-FOOTER",{});var j=b(h);m=u(j,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),Z(m)!=="svelte-g82qqw"&&(m.textContent=v),j.forEach(a),this.h()},h(){p(n,"color","medium"),p(o,"slot","start"),p(e,"translucent",""),p(k,"fullscreen",""),p(m,"fill","outline"),p(m,"color","tertiary"),p(m,"strong",""),q(m,"width","99%"),q(m,"height","auto")},m(w,S){U(w,e,S),l(e,t),l(t,o),l(o,n),l(t,d),l(t,_),U(w,O,S),U(w,k,S),l(k,f),H.m(f,null),l(f,s),C&&C.m(f,null),U(w,g,S),U(w,h,S),l(h,m),L||(y=[le(n,"click",i[15]),le(m,"click",i[16])],L=!0)},p(w,S){H.p(w,S),w[13]&&C.p(w,S)},i:Oe,o:Oe,d(w){w&&(a(e),a(O),a(k),a(g),a(h)),H.d(),C&&C.d(),L=!1,We(y)}}}function Nt(i,e){if(typeof i=="object"&&i!==null||Array.isArray(i)){if(Array.isArray(i))return i.map(t=>Nt(t,e)).flat();{const t=Object.keys(i);let o;return e=="id_checklist_event"?o=t.filter(r=>r.toLowerCase().includes("id_checklist_event")).map(r=>i[r]):e=="mandatory"?o=t.filter(r=>r.toLowerCase().includes("mandatory")).map(r=>i[r]):(console.error("Tipo de dato no reconocido."),o=!1),o}}else return console.error("Invalid input. Please provide a valid object or array."),[]}function It(i,e){let t=new FormData;t.append("id_route",i),t.append("status",e),fetch("https://app.rutaflow.com/api/admin/route/change_status.php",{method:"POST",body:t}).then(o=>o.json()).then(o=>{}).catch(o=>{console.error("Error fetching data:",o)})}function xn(i,e,t){let o=document.querySelector("ion-modal");const n=o.componentProps.checklist,r=o.componentProps.driverId,d=o.componentProps.routeId,_=o.componentProps.isLast;let E,O,k,f,s=[],g=null,h={},m,v,L,y,z={},M={},H={};st(()=>{_?console.log("Último checklist"):Et.update(D=>(D.mandatory=Nt(n,"mandatory"),D.items=Nt(n,"id_checklist_event"),D))});function C(D){t(11,z[D]=!0,z)}const w=async()=>{await(await Ye.create({header:"Datos o checklist incompletos",message:"Carga la evidencia requerida y marca todas las casillas para confirmar",buttons:[{text:"Cerrar"}]})).present()},S=async()=>{await(await Ye.create({header:"Datos capturados",message:"El kilometraje y gasolina final fueron registrados correctamente, espere aprobación para finalizar ruta",buttons:[{text:"Cerrar"}]})).present()},I=async D=>{await(await Ye.create({header:"Datos inválidos",message:D=="km"?"Llena correctamente el campo de kilometraje inicial":"Llena correctamente el campo de gasolina inicial",buttons:[{text:"Cerrar"}]})).present()},B=()=>{ft.dismiss(),r?Qe(`/drivers/${r}`):Qe("/drivers/me")},R=()=>{if(_){var D=X(k,"km"),G=X(f,"gas");const pe=new FormData;pe.append("km_final",D),pe.append("gas_final",G),pe.append("id_route",d),D&&G?(B(),fetch("https://app.rutaflow.com/api/admin/checklist/add_evidence.php",{method:"POST",body:pe}).then($=>$.json()).then($=>{S()}).catch($=>{console.error("Error fetching data:",$)})):w()}else{var _e=X(E,"km"),Ee=X(O,"gas");Et.update(pe=>{pe.items;const $=pe.mandatory;if(pe.items.filter((se,me)=>pe.mandatory[me]==="1").every(se=>pe.checkedIndices.includes(se))&&_e&&Ee){B();const se=new FormData;for(const me in M)if(M.hasOwnProperty(me)){const{img:Ue,img_id:Te}=M[me];se.append(`selectedImages[${me}][img]`,Ue),se.append(`selectedImages[${me}][img_id]`,Te)}se.append("km_inicial",_e),se.append("gas_inicial",Ee),se.append("id_route",d),fetch("https://app.rutaflow.com/api/admin/checklist/add_evidence.php",{method:"POST",body:se}).then(me=>me.json()).then(me=>{$&&$.some(Ue=>Ue==="1")?It(d,"checklist-pending"):It(d,"enroute")}).catch(me=>{console.error("Error fetching data:",me)})}else if(!$&&_e&&Ee){var he=new FormData;he.append("km_inicial",_e),he.append("gas_inicial",Ee),fetch("https://app.rutaflow.com/api/admin/checklist/add_evidence.php",{method:"POST",body:he}).then(se=>se.json()).then(se=>{It(d,"enroute")}).catch(se=>{console.error("Error fetching data:",se)})}else w();return pe})}K()},P=async(D,G)=>{C(G);const Ee=D.target.files[0],pe=await j(Ee);if(pe){const $=new FormData;$.append("fileToUpload",pe);try{const de=await fetch("https://app.rutaflow.com/api/admin/manager/upload_img_driver.php",{method:"POST",body:$});if(de.ok){const ae=await de.json();M={...M,[G]:{img:ae.img,img_id:ae.img_id}},t(12,H={...H,[G]:ae.filename}),V(G),t(6,h[G].checked=!0,h),t(11,z[G]=!1,z)}else console.error("File upload failed:",de.statusText)}catch(de){console.error("Error during file upload:",de)}}},j=async D=>new Promise(G=>{const _e=new FileReader;_e.onload=Ee=>{const pe=new Image;pe.src=Ee.target.result,pe.onload=()=>{const $=document.createElement("canvas"),de=$.getContext("2d"),ae=800,he=600;let se=pe.width,me=pe.height;se>ae&&(me*=ae/se,se=ae),me>he&&(se*=he/me,me=he),$.width=se,$.height=me,de.drawImage(pe,0,0,se,me),$.toBlob(Ue=>{G(Ue)},"image/jpeg",.7)}},_e.readAsDataURL(D)}),V=D=>{Et.update(G=>(G.checkedIndices.indexOf(D)===-1?G.checkedIndices.push(D):console.error(`ID ${D} is already checked.`),G.items.forEach(Ee=>{Ee.id_checklist_event===D&&(Ee.checked=!0)}),G))};function X(D,G){return/^\d+$/.test(D)?parseInt(D,10):(I(G),null)}function x(D,G){J(G),o.componentProps.data_type=G,Xe("modal-gas-km",Kn,{r:G}).then(()=>{et.subscribe(_e=>{W(_e,G)})})}function J(D){fn.update(G=>({...G,flag:[D]}))}function W(D,G){t(0,E=D.km_inicial?D.km_inicial:null),t(1,O=D.gas_inicial?D.gas_inicial:null),t(2,k=D.km_final?D.km_final:null),t(3,f=D.gas_final?D.gas_final:null),G=="km_inicial"&&m&&t(7,m.checked=!0,m),G=="gas_inicial"&&v&&t(8,v.checked=!0,v),G=="km_final"&&L&&t(9,L.checked=!0,L),G=="gas_final"&&y&&t(10,y.checked=!0,y)}function K(){et.set({km_inicial:[],gas_inicial:[],km_final:[],gas_final:[]})}const oe=[[]];function A(){s=at(oe[0],this.__value,this.checked),t(4,s)}function F(D){ze[D?"unshift":"push"](()=>{L=D,t(9,L)})}const Q=D=>x(D,"km_final");function te(){s=at(oe[0],this.__value,this.checked),t(4,s)}function ie(D){ze[D?"unshift":"push"](()=>{y=D,t(10,y)})}const ee=D=>x(D,"gas_final");function ne(){s=at(oe[0],this.__value,this.checked),t(4,s)}function fe(D){ze[D?"unshift":"push"](()=>{m=D,t(7,m)})}const ge=D=>x(D,"km_inicial");function Ie(D){ze[D?"unshift":"push"](()=>{v=D,t(8,v)})}function Ne(){s=at(oe[0],this.__value,this.checked),t(4,s)}const Me=D=>x(D,"gas_inicial");function be(){s=at(oe[0],this.__value,this.checked),t(4,s)}function Re(D,G){ze[D?"unshift":"push"](()=>{h[G.id_checklist_event]=D,t(6,h)})}const Ge=D=>V(D.id_checklist_event);function je(D){ze[D?"unshift":"push"](()=>{g=D,t(5,g)})}return[E,O,k,f,s,g,h,m,v,L,y,z,H,n,_,B,R,P,V,x,A,oe,F,Q,te,ie,ee,ne,fe,ge,Ie,Ne,Me,be,Re,Ge,je,(D,G)=>P(G,D.id_checklist_event)]}class _n extends lt{constructor(e){super(),it(this,e,xn,Zn,ot,{},null,[-1,-1])}}function $n(i){let e,t,o,n,r,d="Teléfono de Negocio",_,E,O=i[8].client_phone+"",k;return{c(){e=c("ion-item"),t=c("ion-icon"),o=N(),n=c("ion-label"),r=c("p"),r.textContent=d,_=N(),E=c("h2"),k=ce(O),this.h()},l(f){e=u(f,"ION-ITEM",{href:!0});var s=b(e);t=u(s,"ION-ICON",{icon:!0,slot:!0}),b(t).forEach(a),o=T(s),n=u(s,"ION-LABEL",{class:!0});var g=b(n);r=u(g,"P",{"data-svelte-h":!0}),Z(r)!=="svelte-1u5l7fz"&&(r.textContent=d),_=T(g),E=u(g,"H2",{});var h=b(E);k=ue(h,O),h.forEach(a),g.forEach(a),s.forEach(a),this.h()},h(){p(t,"icon",yn),p(t,"slot","start"),p(n,"class","ion-text-wrap"),p(e,"href","tel:"+i[8].client_phone)},m(f,s){U(f,e,s),l(e,t),l(e,o),l(e,n),l(n,r),l(n,_),l(n,E),l(E,k)},p:Oe,d(f){f&&a(e)}}}function eo(i){let e,t,o,n,r,d="Domicilio Alternativo",_,E,O=i[8].line2+"",k,f,s;return{c(){e=c("ion-item"),t=c("ion-icon"),o=N(),n=c("ion-label"),r=c("p"),r.textContent=d,_=N(),E=c("h2"),k=ce(O),f=N(),s=c("ion-icon"),this.h()},l(g){e=u(g,"ION-ITEM",{href:!0});var h=b(e);t=u(h,"ION-ICON",{icon:!0,slot:!0}),b(t).forEach(a),o=T(h),n=u(h,"ION-LABEL",{class:!0});var m=b(n);r=u(m,"P",{"data-svelte-h":!0}),Z(r)!=="svelte-1ub9uzw"&&(r.textContent=d),_=T(m),E=u(m,"H2",{});var v=b(E);k=ue(v,O),v.forEach(a),m.forEach(a),f=T(h),s=u(h,"ION-ICON",{icon:!0,slot:!0}),b(s).forEach(a),h.forEach(a),this.h()},h(){p(t,"icon",wt),p(t,"slot","start"),p(n,"class","ion-text-wrap"),p(s,"icon",rt),p(s,"slot","end"),p(e,"href","https://www.google.com/maps/searhc/?api=1&query="+i[8].line2)},m(g,h){U(g,e,h),l(e,t),l(e,o),l(e,n),l(n,r),l(n,_),l(n,E),l(E,k),l(e,f),l(e,s)},p:Oe,d(g){g&&a(e)}}}function to(i){let e,t,o,n,r,d="Domicilio",_,E,O=i[8].line1+"",k,f,s,g,h=i[8].line2&&i[8].line2.trim().length,m,v=h&&no(i);return{c(){e=c("ion-item"),t=c("ion-icon"),o=N(),n=c("ion-label"),r=c("p"),r.textContent=d,_=N(),E=c("h2"),k=ce(O),f=N(),s=c("ion-icon"),g=N(),v&&v.c(),m=He(),this.h()},l(L){e=u(L,"ION-ITEM",{href:!0});var y=b(e);t=u(y,"ION-ICON",{icon:!0,slot:!0}),b(t).forEach(a),o=T(y),n=u(y,"ION-LABEL",{class:!0});var z=b(n);r=u(z,"P",{"data-svelte-h":!0}),Z(r)!=="svelte-cbm7q1"&&(r.textContent=d),_=T(z),E=u(z,"H2",{});var M=b(E);k=ue(M,O),M.forEach(a),z.forEach(a),f=T(y),s=u(y,"ION-ICON",{icon:!0,slot:!0}),b(s).forEach(a),y.forEach(a),g=T(L),v&&v.l(L),m=He(),this.h()},h(){p(t,"icon",wt),p(t,"slot","start"),p(n,"class","ion-text-wrap"),p(s,"icon",rt),p(s,"slot","end"),p(e,"href","https://www.google.com/maps/search/?api=1&query="+i[8].line1)},m(L,y){U(L,e,y),l(e,t),l(e,o),l(e,n),l(n,r),l(n,_),l(n,E),l(E,k),l(e,f),l(e,s),U(L,g,y),v&&v.m(L,y),U(L,m,y)},p(L,y){h&&v.p(L,y)},d(L){L&&(a(e),a(g),a(m)),v&&v.d(L)}}}function no(i){let e,t,o,n,r,d="Domicilio Alternativo",_,E,O=i[8].line2+"",k,f,s;return{c(){e=c("ion-item"),t=c("ion-icon"),o=N(),n=c("ion-label"),r=c("p"),r.textContent=d,_=N(),E=c("h2"),k=ce(O),f=N(),s=c("ion-icon"),this.h()},l(g){e=u(g,"ION-ITEM",{href:!0});var h=b(e);t=u(h,"ION-ICON",{icon:!0,slot:!0}),b(t).forEach(a),o=T(h),n=u(h,"ION-LABEL",{class:!0});var m=b(n);r=u(m,"P",{"data-svelte-h":!0}),Z(r)!=="svelte-1ub9uzw"&&(r.textContent=d),_=T(m),E=u(m,"H2",{});var v=b(E);k=ue(v,O),v.forEach(a),m.forEach(a),f=T(h),s=u(h,"ION-ICON",{icon:!0,slot:!0}),b(s).forEach(a),h.forEach(a),this.h()},h(){p(t,"icon",wt),p(t,"slot","start"),p(n,"class","ion-text-wrap"),p(s,"icon",rt),p(s,"slot","end"),p(e,"href","https://www.google.com/maps/search/?api=1&query="+i[8].line2)},m(g,h){U(g,e,h),l(e,t),l(e,o),l(e,n),l(n,r),l(n,_),l(n,E),l(E,k),l(e,f),l(e,s)},p:Oe,d(g){g&&a(e)}}}function Rt(i){let e,t,o,n,r,d="Contacto del Cliente",_,E,O,k,f=i[2]&&i[2]==="1"&&Ut(i);return{c(){e=c("ion-item"),t=c("ion-icon"),o=N(),n=c("ion-label"),r=c("p"),r.textContent=d,_=N(),E=c("h2"),O=ce(i[6]),k=N(),f&&f.c(),this.h()},l(s){e=u(s,"ION-ITEM",{});var g=b(e);t=u(g,"ION-ICON",{icon:!0,slot:!0}),b(t).forEach(a),o=T(g),n=u(g,"ION-LABEL",{class:!0});var h=b(n);r=u(h,"P",{"data-svelte-h":!0}),Z(r)!=="svelte-1utsyb6"&&(r.textContent=d),_=T(h),E=u(h,"H2",{});var m=b(E);O=ue(m,i[6]),m.forEach(a),h.forEach(a),k=T(g),f&&f.l(g),g.forEach(a),this.h()},h(){p(t,"icon",wn),p(t,"slot","start"),p(n,"class","ion-text-wrap")},m(s,g){U(s,e,g),l(e,t),l(e,o),l(e,n),l(n,r),l(n,_),l(n,E),l(E,O),l(e,k),f&&f.m(e,null)},p(s,g){g[0]&64&&Pe(O,s[6]),s[2]&&s[2]==="1"?f?f.p(s,g):(f=Ut(s),f.c(),f.m(e,null)):f&&(f.d(1),f=null)},d(s){s&&a(e),f&&f.d()}}}function Ut(i){let e,t=`<ion-icon icon="${Sn}" slot="start"></ion-icon>
                        Notificar Cliente`,o,n;return{c(){e=c("ion-button"),e.innerHTML=t,this.h()},l(r){e=u(r,"ION-BUTTON",{fill:!0,style:!0,"data-svelte-h":!0}),Z(e)!=="svelte-w3qtwm"&&(e.innerHTML=t),this.h()},h(){p(e,"fill","outline"),q(e,"margin-left","16px")},m(r,d){U(r,e,d),o||(n=le(e,"click",i[12]),o=!0)},p:Oe,d(r){r&&a(e),o=!1,n()}}}function Ft(i){let e,t,o,n,r,d="Notas de ubicación",_,E,O;return{c(){e=c("ion-item"),t=c("ion-icon"),o=N(),n=c("ion-label"),r=c("p"),r.textContent=d,_=N(),E=c("h2"),O=ce(i[7]),this.h()},l(k){e=u(k,"ION-ITEM",{});var f=b(e);t=u(f,"ION-ICON",{icon:!0,slot:!0}),b(t).forEach(a),o=T(f),n=u(f,"ION-LABEL",{class:!0});var s=b(n);r=u(s,"P",{"data-svelte-h":!0}),Z(r)!=="svelte-nhm2ft"&&(r.textContent=d),_=T(s),E=u(s,"H2",{});var g=b(E);O=ue(g,i[7]),g.forEach(a),s.forEach(a),f.forEach(a),this.h()},h(){p(t,"icon",cn),p(t,"slot","start"),p(n,"class","ion-text-wrap")},m(k,f){U(k,e,f),l(e,t),l(e,o),l(e,n),l(n,r),l(n,_),l(n,E),l(E,O)},p(k,f){f[0]&128&&Pe(O,k[7])},d(k){k&&a(e)}}}function oo(i){let e,t,o,n,r,d="Horarios",_,E,O=i[8].schedule+"",k;return{c(){e=c("ion-item"),t=c("ion-icon"),o=N(),n=c("ion-label"),r=c("p"),r.textContent=d,_=N(),E=c("h2"),k=ce(O),this.h()},l(f){e=u(f,"ION-ITEM",{});var s=b(e);t=u(s,"ION-ICON",{icon:!0,slot:!0}),b(t).forEach(a),o=T(s),n=u(s,"ION-LABEL",{});var g=b(n);r=u(g,"P",{"data-svelte-h":!0}),Z(r)!=="svelte-11q7hm5"&&(r.textContent=d),_=T(g),E=u(g,"H2",{});var h=b(E);k=ue(h,O),h.forEach(a),g.forEach(a),s.forEach(a),this.h()},h(){p(t,"icon",Ln),p(t,"slot","start")},m(f,s){U(f,e,s),l(e,t),l(e,o),l(e,n),l(n,r),l(n,_),l(n,E),l(E,k)},p:Oe,d(f){f&&a(e)}}}function lo(i){let e,t,o,n,r,d="Notas del operador",_,E,O=i[8].driver_comments+"",k;return{c(){e=c("ion-item"),t=c("ion-icon"),o=N(),n=c("ion-label"),r=c("p"),r.textContent=d,_=N(),E=c("h2"),k=ce(O),this.h()},l(f){e=u(f,"ION-ITEM",{});var s=b(e);t=u(s,"ION-ICON",{icon:!0,slot:!0}),b(t).forEach(a),o=T(s),n=u(s,"ION-LABEL",{});var g=b(n);r=u(g,"P",{"data-svelte-h":!0}),Z(r)!=="svelte-1yk9qp4"&&(r.textContent=d),_=T(g),E=u(g,"H2",{});var h=b(E);k=ue(h,O),h.forEach(a),g.forEach(a),s.forEach(a),this.h()},h(){p(t,"icon",un),p(t,"slot","start")},m(f,s){U(f,e,s),l(e,t),l(e,o),l(e,n),l(n,r),l(n,_),l(n,E),l(E,k)},p:Oe,d(f){f&&a(e)}}}function io(i){let e,t=i[8].logistic_comments!="<br>"&&ro(i);return{c(){t&&t.c(),e=He()},l(o){t&&t.l(o),e=He()},m(o,n){t&&t.m(o,n),U(o,e,n)},p(o,n){o[8].logistic_comments!="<br>"&&t.p(o,n)},d(o){o&&a(e),t&&t.d(o)}}}function ro(i){let e,t,o,n,r,d="Comentarios logísticos",_,E,O=i[8].logistic_comments+"",k;return{c(){e=c("ion-item"),t=c("ion-icon"),o=N(),n=c("ion-label"),r=c("p"),r.textContent=d,_=N(),E=c("h2"),k=ce(O),this.h()},l(f){e=u(f,"ION-ITEM",{});var s=b(e);t=u(s,"ION-ICON",{icon:!0,slot:!0}),b(t).forEach(a),o=T(s),n=u(s,"ION-LABEL",{class:!0});var g=b(n);r=u(g,"P",{"data-svelte-h":!0}),Z(r)!=="svelte-1iz85r6"&&(r.textContent=d),_=T(g),E=u(g,"H2",{});var h=b(E);k=ue(h,O),h.forEach(a),g.forEach(a),s.forEach(a),this.h()},h(){p(t,"icon",cn),p(t,"slot","start"),p(n,"class","ion-text-wrap")},m(f,s){U(f,e,s),l(e,t),l(e,o),l(e,n),l(n,r),l(n,_),l(n,E),l(E,k)},p:Oe,d(f){f&&a(e)}}}function qt(i){let e;return{c(){e=c("ion-spinner"),this.h()},l(t){e=u(t,"ION-SPINNER",{name:!0}),b(e).forEach(a),this.h()},h(){p(e,"name","dots")},m(t,o){U(t,e,o)},d(t){t&&a(e)}}}function jt(i){let e,t,o;return{c(){e=c("section"),t=c("ion-img"),this.h()},l(n){e=u(n,"SECTION",{});var r=b(e);t=u(r,"ION-IMG",{src:!0,alt:!0,style:!0}),b(t).forEach(a),r.forEach(a),this.h()},h(){vt(t.src,o=i[1])||p(t,"src",o),p(t,"alt","Evidencia fotográfica"),q(t,"max-width","100%"),q(t,"margin-top","16px")},m(n,r){U(n,e,r),l(e,t)},p(n,r){r[0]&2&&!vt(t.src,o=n[1])&&p(t,"src",o)},d(n){n&&a(e)}}}function ao(i){let e,t,o,n,r="Cancelar",d,_,E=i[8].title+"",O,k,f,s,g="Confirmar",h,m,v,L,y,z,M,H,C="Negocio",w,S,I=i[8].client_name+"",B,R,P=i[8].client_phone&&i[8].client_phone.trim().length,j,V,X,x,J=i[8].schedule&&i[8].schedule.trim().length,W,K,oe=i[8].logistic_comments&&i[8].logistic_comments.trim().length,A,F,Q,te,ie,ee,ne,fe,ge,Ie,Ne,Me,be,Re,Ge,je,Ve,D,G,_e,Ee,pe,$,de="Subir Evidencia",ae,he,se,me,Ue,Te,Be=P&&$n(i);function Ze(re,Le){if(re[8].line1&&re[8].line1.trim().length)return to;if(re[8].line2&&re[8].line2.trim().length)return eo}let Je=Ze(i),Ce=Je&&Je(i),ke=i[6]&&Rt(i),ye=i[7]&&i[7]!=="<br>"&&Ft(i),Fe=J&&oo(i),De=i[8].driver_comments&&lo(i),qe=oe&&io(i),we=i[3]&&qt(),Se=i[1]&&jt(i);return{c(){e=c("ion-header"),t=c("ion-toolbar"),o=c("ion-buttons"),n=c("ion-button"),n.textContent=r,d=N(),_=c("ion-title"),O=ce(E),k=N(),f=c("ion-buttons"),s=c("ion-button"),s.textContent=g,h=N(),m=c("ion-content"),v=c("ion-list"),L=c("ion-item"),y=c("ion-icon"),z=N(),M=c("ion-label"),H=c("p"),H.textContent=C,w=N(),S=c("h2"),B=ce(I),R=N(),Be&&Be.c(),j=N(),Ce&&Ce.c(),V=N(),ke&&ke.c(),X=N(),ye&&ye.c(),x=N(),Fe&&Fe.c(),W=N(),De&&De.c(),K=N(),qe&&qe.c(),A=N(),F=c("ion-item"),Q=c("ion-icon"),te=N(),ie=c("ion-textarea"),ee=N(),ne=c("section"),fe=c("ion-button"),ge=c("ion-icon"),Ie=ce(`
                Ingreso`),Me=N(),be=c("ion-button"),Re=c("ion-icon"),Ge=ce(`
                Salida`),Ve=N(),D=c("section"),G=c("label"),_e=c("ion-button"),Ee=c("ion-icon"),pe=N(),$=c("label"),$.textContent=de,ae=N(),he=c("input"),se=N(),we&&we.c(),me=N(),Se&&Se.c(),this.h()},l(re){e=u(re,"ION-HEADER",{translucent:!0});var Le=b(e);t=u(Le,"ION-TOOLBAR",{});var xe=b(t);o=u(xe,"ION-BUTTONS",{slot:!0});var Lt=b(o);n=u(Lt,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),Z(n)!=="svelte-1f8rjcf"&&(n.textContent=r),Lt.forEach(a),d=T(xe),_=u(xe,"ION-TITLE",{title:!0});var St=b(_);O=ue(St,E),St.forEach(a),k=T(xe),f=u(xe,"ION-BUTTONS",{slot:!0});var Pt=b(f);s=u(Pt,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),Z(s)!=="svelte-1ida0il"&&(s.textContent=g),Pt.forEach(a),xe.forEach(a),Le.forEach(a),h=T(re),m=u(re,"ION-CONTENT",{fullscreen:!0});var Mt=b(m);v=u(Mt,"ION-LIST",{});var ve=b(v);L=u(ve,"ION-ITEM",{});var _t=b(L);y=u(_t,"ION-ICON",{icon:!0,slot:!0}),b(y).forEach(a),z=T(_t),M=u(_t,"ION-LABEL",{});var dt=b(M);H=u(dt,"P",{"data-svelte-h":!0}),Z(H)!=="svelte-57b1dg"&&(H.textContent=C),w=T(dt),S=u(dt,"H2",{});var At=b(S);B=ue(At,I),At.forEach(a),dt.forEach(a),_t.forEach(a),R=T(ve),Be&&Be.l(ve),j=T(ve),Ce&&Ce.l(ve),V=T(ve),ke&&ke.l(ve),X=T(ve),ye&&ye.l(ve),x=T(ve),Fe&&Fe.l(ve),W=T(ve),De&&De.l(ve),K=T(ve),qe&&qe.l(ve),A=T(ve),F=u(ve,"ION-ITEM",{});var ht=b(F);Q=u(ht,"ION-ICON",{icon:!0,slot:!0}),b(Q).forEach(a),te=T(ht),ie=u(ht,"ION-TEXTAREA",{label:!0,placeholder:!0}),b(ie).forEach(a),ht.forEach(a),ee=T(ve),ne=u(ve,"SECTION",{style:!0});var pt=b(ne);fe=u(pt,"ION-BUTTON",{id:!0,style:!0,disabled:!0});var gt=b(fe);ge=u(gt,"ION-ICON",{icon:!0,slot:!0}),b(ge).forEach(a),Ie=ue(gt,`
                Ingreso`),gt.forEach(a),Me=T(pt),be=u(pt,"ION-BUTTON",{id:!0,style:!0,disabled:!0});var bt=b(be);Re=u(bt,"ION-ICON",{icon:!0,slot:!0}),b(Re).forEach(a),Ge=ue(bt,`
                Salida`),bt.forEach(a),pt.forEach(a),Ve=T(ve),D=u(ve,"SECTION",{});var Bt=b(D);G=u(Bt,"LABEL",{for:!0,style:!0});var Dt=b(G);_e=u(Dt,"ION-BUTTON",{fill:!0,class:!0,expand:!0});var $e=b(_e);Ee=u($e,"ION-ICON",{icon:!0,slot:!0}),b(Ee).forEach(a),pe=T($e),$=u($e,"LABEL",{for:!0,style:!0,"data-svelte-h":!0}),Z($)!=="svelte-1as0od8"&&($.textContent=de),ae=T($e),he=u($e,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0}),$e.forEach(a),Dt.forEach(a),Bt.forEach(a),se=T(ve),we&&we.l(ve),me=T(ve),Se&&Se.l(ve),ve.forEach(a),Mt.forEach(a),this.h()},h(){p(n,"color","medium"),p(o,"slot","start"),p(_,"title",i[8].title),p(s,"strong",""),p(f,"slot","end"),p(e,"translucent",""),p(y,"icon",Nn),p(y,"slot","start"),p(Q,"icon",Ot),p(Q,"slot","start"),p(ie,"label","Notas"),p(ie,"placeholder","Escribe aquí..."),p(ge,"icon",Tn),p(ge,"slot","start"),p(fe,"id","checkInBtn"),q(fe,"flex","1"),p(fe,"disabled",Ne=i[4]===!1),p(Re,"icon",Cn),p(Re,"slot","start"),p(be,"id","checkOutBtn"),q(be,"flex","1"),p(be,"disabled",je=i[5]===!1),q(ne,"display","flex"),q(ne,"gap","8px"),q(ne,"padding","16px"),p(Ee,"icon",sn),p(Ee,"slot","start"),Y($,"for","eventEvidence"),q($,"padding","8px 10px"),q(he,"display","none"),Y(he,"id","eventEvidence"),Y(he,"name","fileToUpload"),Y(he,"type","file"),Y(he,"accept","image/*"),p(_e,"fill","outline"),p(_e,"class","loadEvidence"),p(_e,"expand","block"),Y(G,"for","eventEvidence"),q(G,"display","block"),q(G,"width","100%"),p(m,"fullscreen","")},m(re,Le){U(re,e,Le),l(e,t),l(t,o),l(o,n),l(t,d),l(t,_),l(_,O),l(t,k),l(t,f),l(f,s),U(re,h,Le),U(re,m,Le),l(m,v),l(v,L),l(L,y),l(L,z),l(L,M),l(M,H),l(M,w),l(M,S),l(S,B),l(v,R),Be&&Be.m(v,null),l(v,j),Ce&&Ce.m(v,null),l(v,V),ke&&ke.m(v,null),l(v,X),ye&&ye.m(v,null),l(v,x),Fe&&Fe.m(v,null),l(v,W),De&&De.m(v,null),l(v,K),qe&&qe.m(v,null),l(v,A),l(v,F),l(F,Q),l(F,te),l(F,ie),i[15](ie),l(v,ee),l(v,ne),l(ne,fe),l(fe,ge),l(fe,Ie),l(ne,Me),l(ne,be),l(be,Re),l(be,Ge),l(v,Ve),l(v,D),l(D,G),l(G,_e),l(_e,Ee),l(_e,pe),l(_e,$),l(_e,ae),l(_e,he),l(v,se),we&&we.m(v,null),l(v,me),Se&&Se.m(v,null),Ue||(Te=[le(n,"click",i[10]),le(s,"click",i[11]),le(fe,"click",i[13]),le(be,"click",i[14]),le(he,"change",i[9])],Ue=!0)},p(re,Le){P&&Be.p(re,Le),Ce&&Ce.p(re,Le),re[6]?ke?ke.p(re,Le):(ke=Rt(re),ke.c(),ke.m(v,X)):ke&&(ke.d(1),ke=null),re[7]&&re[7]!=="<br>"?ye?ye.p(re,Le):(ye=Ft(re),ye.c(),ye.m(v,x)):ye&&(ye.d(1),ye=null),J&&Fe.p(re,Le),re[8].driver_comments&&De.p(re,Le),oe&&qe.p(re,Le),Le[0]&16&&Ne!==(Ne=re[4]===!1)&&p(fe,"disabled",Ne),Le[0]&32&&je!==(je=re[5]===!1)&&p(be,"disabled",je),re[3]?we||(we=qt(),we.c(),we.m(v,me)):we&&(we.d(1),we=null),re[1]?Se?Se.p(re,Le):(Se=jt(re),Se.c(),Se.m(v,null)):Se&&(Se.d(1),Se=null)},i:Oe,o:Oe,d(re){re&&(a(e),a(h),a(m)),Be&&Be.d(),Ce&&Ce.d(),ke&&ke.d(),ye&&ye.d(),Fe&&Fe.d(),De&&De.d(),qe&&qe.d(),i[15](null),we&&we.d(),Se&&Se.d(),Ue=!1,We(Te)}}}const Vt=/Teléfono:\s*(\d{10,})/;function Gt(i,e){for(let t=0;t<e.length;t++)if(e[t].alias===i)return e[t].val;return""}function so(i,e,t){let o=document.querySelector("ion-modal"),n=o.componentProps.delivery,r=o.componentProps.isLast,d=n.driver_comments?n.driver_comments:"",_=n.img?n.img:"",E="",O={latitude:null,longitude:null},k=new Object,f="",s="",g=!1,h=!0,m=!1,v="",L=n.comments_ext;st(()=>{P(),y()});function y(){n.date_service?n.date_service&&!n.date_completed&&!n.service_time?(t(4,h=!1),t(5,m=!0)):n.date_service&&n.date_completed&&n.service_time&&(t(4,h=!1),t(5,m=!1)):(console.log("date_service"),t(4,h=!0),t(5,m=!1))}if(n.comments_ext){const J=n.comments_ext.match(Vt);J&&(v=J[1],L=n.comments_ext.replace(Vt,"").trim())}const z=async()=>{await(await Ye.create({header:"SMS enviado",message:"Se envío correctamente un SMS a "+n.title+" con número de teléfono: "+v,buttons:[{text:"Cerrar"}]})).present()},M=async()=>{await(await Ye.create({header:"SMS no enviado",message:"Hubo un error al enviar SMS a "+n.title+" con número de teléfono: "+phoneNumber0+". Por favor contacte a soporte.",buttons:[{text:"Cerrar"}]})).present()},H=async J=>{t(3,g=!0);const K=J.target.files[0],oe=await C(K);if(oe){const A=new FormData;A.append("fileToUpload",oe);try{const F=await fetch("https://app.rutaflow.com/api/admin/manager/upload_img_driver.php",{method:"POST",body:A});if(F.ok){const Q=await F.json();t(1,_=Q.img),E=Q.img_id}else console.error("File upload failed:",F.statusText)}catch(F){console.error("Error during file upload:",F)}finally{t(3,g=!1)}}},C=async J=>new Promise(W=>{const K=new FileReader;K.onload=oe=>{const A=new Image;A.src=oe.target.result,A.onload=()=>{const F=document.createElement("canvas"),Q=F.getContext("2d"),te=800,ie=600;let ee=A.width,ne=A.height;ee>te&&(ne*=te/ee,ee=te),ne>ie&&(ee*=ie/ne,ne=ie),F.width=ee,F.height=ne,Q.drawImage(A,0,0,ee,ne),F.toBlob(fe=>{W(fe)},"image/jpeg",.7)}},K.readAsDataURL(J)}),w=()=>{o.dismiss({data:Date.now()})},S=async()=>{try{if(await B()){const W={id_route:n.id_route,id_event:n.id_event,comments:d.value,img:_,img_id:E,lat:O.latitude,lon:O.longitude,...f==="0"&&{approve:"0"},...r&&{isLast:!0}},K=new FormData;for(const te in W)K.append(te,W[te]);const A=await(await fetch("https://app.rutaflow.com/api/admin/evidence/send_evidence.php",{method:"POST",body:K})).json();w();const F={},Q=W.id_route;r&&I("","",Q,r)}}catch(J){console.error("Error fetching data:",J)}},I=(J,W,K,oe)=>{o.componentProps.routeId=K,o.componentProps.driverId=n.id_driver,Xe("modal-km-gas",_n,{checklist:J,driverId:W,routeId:K,isLast:oe}).then(A=>{})},B=async()=>navigator.geolocation?new Promise((J,W)=>{navigator.geolocation.getCurrentPosition(K=>{O.latitude=K.coords.latitude,O.longitude=K.coords.longitude,J(!0)},K=>{console.error("Error getting location:",K),J(!1)})}):(console.error("Geolocation is not supported by your browser"),!1);async function R(J){J.stopPropagation();const W=new FormData;W.append("client_phone",v),W.append("client_name",n.title),W.append("delivery_phone",n.client_phone),W.append("enterprise_name",n.enterprise_name);try{const K=await fetch("https://app.rutaflow.com/api/admin/message_central/send_sms.php",{method:"POST",body:W});if(K.ok){const oe=await K.json();z()}else M()}catch(K){console.error("Error during file upload:",K)}}const P=async J=>{if(n.id_enterprise){const W=new FormData;W.append("id_enterprise",n.id_enterprise);try{const K=await fetch("https://app.rutaflow.com/api/admin/enterprise/enterprise_settings.php",{method:"POST",body:W});K.ok?(k=(await K.json()).nodos,f=Gt("stops_wait_approval",k),t(2,s=Gt("sms_active",k))):console.error("File upload failed:",K.statusText)}catch(K){console.error("Error during file upload:",K)}}};function j(){t(4,h=!1),t(5,m=!0),X(n.id_event,"checkin")}function V(){t(5,m=!1),t(4,h=!1),X(n.id_event,"checkout")}async function X(J,W){if(W){const K=new FormData;K.append("type",W),K.append("id_event",J);try{const oe=await fetch("https://app.rutaflow.com/api/admin/route/record_check_date.php",{method:"POST",body:K});if(oe.ok){const A=await oe.json();t(1,_=A.img),E=A.img_id}else console.error("File upload failed:",oe.statusText)}catch(oe){console.error("Error during file upload:",oe)}finally{}}}function x(J){ze[J?"unshift":"push"](()=>{d=J,t(0,d)})}return[d,_,s,g,h,m,v,L,n,H,w,S,R,j,V,x]}class co extends lt{constructor(e){super(),it(this,e,so,ao,ot,{},null,[-1,-1])}}function Kt(i){let e;return{c(){e=c("ion-spinner"),this.h()},l(t){e=u(t,"ION-SPINNER",{name:!0}),b(e).forEach(a),this.h()},h(){p(e,"name","dots")},m(t,o){U(t,e,o)},d(t){t&&a(e)}}}function Wt(i){let e,t,o;return{c(){e=c("section"),t=c("ion-img"),this.h()},l(n){e=u(n,"SECTION",{});var r=b(e);t=u(r,"ION-IMG",{src:!0,alt:!0,style:!0}),b(t).forEach(a),r.forEach(a),this.h()},h(){vt(t.src,o=i[0])||p(t,"src",o),p(t,"alt","Evidencia fotográfica"),q(t,"max-width","100%"),q(t,"margin-top","16px")},m(n,r){U(n,e,r),l(e,t)},p(n,r){r&1&&!vt(t.src,o=n[0])&&p(t,"src",o)},d(n){n&&a(e)}}}function uo(i){let e,t,o,n,r="Cancelar",d,_,E="AGREGAR GASTO",O,k,f,s,g,h,m,v,L,y,z,M,H,C,w,S,I,B,R='Tipo de pago <ion-text color="danger">(Obligatorio)</ion-text>',P,j,V="Efectivo",X,x,J="Tarjeta",W,K,oe="Transferencia",A,F,Q,te,ie,ee,ne,fe,ge,Ie,Ne=`<ion-icon icon="${sn}" slot="start"></ion-icon>
                        Subir Evidencia`,Me,be,Re,Ge,je,Ve,D,G,_e="Confirmar",Ee,pe,$=i[5]&&Kt(),de=i[0]&&Wt(i);return{c(){e=c("ion-header"),t=c("ion-toolbar"),o=c("ion-buttons"),n=c("ion-button"),n.textContent=r,d=N(),_=c("ion-title"),_.textContent=E,O=N(),k=c("ion-content"),f=c("ion-list"),s=c("ion-item"),g=c("ion-icon"),h=N(),m=c("ion-input"),v=N(),L=c("ion-item"),y=c("ion-icon"),z=N(),M=c("ion-input"),H=N(),C=c("ion-item"),w=c("ion-icon"),S=N(),I=c("ion-select"),B=c("div"),B.innerHTML=R,P=N(),j=c("ion-select-option"),j.textContent=V,X=N(),x=c("ion-select-option"),x.textContent=J,W=N(),K=c("ion-select-option"),K.textContent=oe,A=N(),F=c("ion-item"),Q=c("ion-icon"),te=N(),ie=c("ion-textarea"),ee=N(),ne=c("section"),fe=c("label"),ge=c("ion-button"),Ie=c("label"),Ie.innerHTML=Ne,Me=N(),be=c("input"),Re=N(),$&&$.c(),Ge=N(),de&&de.c(),je=N(),Ve=c("ion-footer"),D=c("ion-toolbar"),G=c("ion-button"),G.textContent=_e,this.h()},l(ae){e=u(ae,"ION-HEADER",{translucent:!0});var he=b(e);t=u(he,"ION-TOOLBAR",{});var se=b(t);o=u(se,"ION-BUTTONS",{slot:!0});var me=b(o);n=u(me,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),Z(n)!=="svelte-1f8rjcf"&&(n.textContent=r),me.forEach(a),d=T(se),_=u(se,"ION-TITLE",{title:!0,"data-svelte-h":!0}),Z(_)!=="svelte-efps2s"&&(_.textContent=E),se.forEach(a),he.forEach(a),O=T(ae),k=u(ae,"ION-CONTENT",{fullscreen:!0});var Ue=b(k);f=u(Ue,"ION-LIST",{});var Te=b(f);s=u(Te,"ION-ITEM",{});var Be=b(s);g=u(Be,"ION-ICON",{icon:!0,slot:!0}),b(g).forEach(a),h=T(Be),m=u(Be,"ION-INPUT",{label:!0,type:!0,placeholder:!0,value:!0}),b(m).forEach(a),Be.forEach(a),v=T(Te),L=u(Te,"ION-ITEM",{});var Ze=b(L);y=u(Ze,"ION-ICON",{icon:!0,slot:!0}),b(y).forEach(a),z=T(Ze),M=u(Ze,"ION-INPUT",{label:!0,type:!0,value:!0}),b(M).forEach(a),Ze.forEach(a),H=T(Te),C=u(Te,"ION-ITEM",{});var Je=b(C);w=u(Je,"ION-ICON",{icon:!0,slot:!0}),b(w).forEach(a),S=T(Je),I=u(Je,"ION-SELECT",{placeholder:!0,value:!0});var Ce=b(I);B=u(Ce,"DIV",{slot:!0,"data-svelte-h":!0}),Z(B)!=="svelte-wl764p"&&(B.innerHTML=R),P=T(Ce),j=u(Ce,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),Z(j)!=="svelte-i9crym"&&(j.textContent=V),X=T(Ce),x=u(Ce,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),Z(x)!=="svelte-fx0z11"&&(x.textContent=J),W=T(Ce),K=u(Ce,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),Z(K)!=="svelte-1c24jf2"&&(K.textContent=oe),Ce.forEach(a),Je.forEach(a),A=T(Te),F=u(Te,"ION-ITEM",{});var ke=b(F);Q=u(ke,"ION-ICON",{icon:!0,slot:!0}),b(Q).forEach(a),te=T(ke),ie=u(ke,"ION-TEXTAREA",{label:!0,placeholder:!0}),b(ie).forEach(a),ke.forEach(a),ee=T(Te),ne=u(Te,"SECTION",{});var ye=b(ne);fe=u(ye,"LABEL",{for:!0,style:!0});var Fe=b(fe);ge=u(Fe,"ION-BUTTON",{fill:!0,size:!0,class:!0,expand:!0});var De=b(ge);Ie=u(De,"LABEL",{for:!0,style:!0,"data-svelte-h":!0}),Z(Ie)!=="svelte-1m9yw22"&&(Ie.innerHTML=Ne),Me=T(De),be=u(De,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0}),De.forEach(a),Fe.forEach(a),ye.forEach(a),Re=T(Te),$&&$.l(Te),Ge=T(Te),de&&de.l(Te),Te.forEach(a),Ue.forEach(a),je=T(ae),Ve=u(ae,"ION-FOOTER",{});var qe=b(Ve);D=u(qe,"ION-TOOLBAR",{});var we=b(D);G=u(we,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),Z(G)!=="svelte-1c7dl3f"&&(G.textContent=_e),we.forEach(a),qe.forEach(a),this.h()},h(){p(n,"color","medium"),p(o,"slot","start"),p(_,"title",""),p(e,"translucent",""),p(g,"icon",un),p(g,"slot","start"),p(m,"label","Concepto"),p(m,"type","text"),p(m,"placeholder","Escribe aquí..."),p(m,"value",i[6]?i[6]:""),p(y,"icon",Ot),p(y,"slot","start"),p(M,"label","Cantidad"),p(M,"type","number"),p(M,"value",i[7]?i[7]:""),p(w,"icon",Pn),p(w,"slot","start"),Y(B,"slot","label"),p(j,"value","cash"),p(x,"value","card"),p(K,"value","transfer"),p(I,"placeholder","Tipo de pago"),p(I,"value",i[8]?i[8]:""),p(Q,"icon",Ot),p(Q,"slot","start"),p(ie,"label","Comentarios"),p(ie,"placeholder","Escribe aquí..."),Y(Ie,"for","eventEvidence"),q(Ie,"width","100%"),q(Ie,"padding","8px"),q(be,"display","none"),Y(be,"id","eventEvidence"),Y(be,"name","fileToUpload"),Y(be,"type","file"),Y(be,"accept","image/*"),p(ge,"fill","outline"),p(ge,"size","small"),p(ge,"class","loadEvidence"),p(ge,"expand","block"),Y(fe,"for","eventEvidence"),q(fe,"display","block"),q(fe,"width","100%"),p(k,"fullscreen",""),p(G,"fill","outline"),p(G,"color","tertiary"),p(G,"strong",""),q(G,"width","99%"),q(G,"height","auto")},m(ae,he){U(ae,e,he),l(e,t),l(t,o),l(o,n),l(t,d),l(t,_),U(ae,O,he),U(ae,k,he),l(k,f),l(f,s),l(s,g),l(s,h),l(s,m),i[12](m),l(f,v),l(f,L),l(L,y),l(L,z),l(L,M),i[13](M),l(f,H),l(f,C),l(C,w),l(C,S),l(C,I),l(I,B),l(I,P),l(I,j),l(I,X),l(I,x),l(I,W),l(I,K),i[14](I),l(f,A),l(f,F),l(F,Q),l(F,te),l(F,ie),i[15](ie),l(f,ee),l(f,ne),l(ne,fe),l(fe,ge),l(ge,Ie),l(ge,Me),l(ge,be),l(f,Re),$&&$.m(f,null),l(f,Ge),de&&de.m(f,null),U(ae,je,he),U(ae,Ve,he),l(Ve,D),l(D,G),Ee||(pe=[le(n,"click",i[10]),le(be,"change",i[9]),le(G,"click",i[11])],Ee=!0)},p(ae,[he]){ae[5]?$||($=Kt(),$.c(),$.m(f,Ge)):$&&($.d(1),$=null),ae[0]?de?de.p(ae,he):(de=Wt(ae),de.c(),de.m(f,null)):de&&(de.d(1),de=null)},i:Oe,o:Oe,d(ae){ae&&(a(e),a(O),a(k),a(je),a(Ve)),i[12](null),i[13](null),i[14](null),i[15](null),$&&$.d(),de&&de.d(),Ee=!1,We(pe)}}}function fo(i,e,t){let o=document.querySelector("ion-modal"),n=o.componentProps.routeId,r=o.componentProps.ex_concept,d=o.componentProps.ex_amount,_=o.componentProps.ex_type,E=o.componentProps.id_expense,O="",k="",f="",s=0,g="",h="",m=!1;st(()=>{});const v=async(I,B)=>{await(await Ye.create({header:I,message:B,buttons:[{text:"Cerrar"}]})).present()},L=async I=>{t(5,m=!0);const R=I.target.files[0],P=await y(R);if(P){const j=new FormData;j.append("fileToUpload",P);try{const V=await fetch("https://app.rutaflow.com/api/admin/manager/upload_img_driver.php",{method:"POST",body:j});if(V.ok){const X=await V.json();t(0,O=X.img),k=X.img_id}else console.error("File upload failed:",V.statusText)}catch(V){console.error("Error during file upload:",V)}finally{t(5,m=!1)}}},y=async I=>new Promise(B=>{const R=new FileReader;R.onload=P=>{const j=new Image;j.src=P.target.result,j.onload=()=>{const V=document.createElement("canvas"),X=V.getContext("2d"),x=800,J=600;let W=j.width,K=j.height;W>x&&(K*=x/W,W=x),K>J&&(W*=J/K,K=J),V.width=W,V.height=K,X.drawImage(j,0,0,W,K),V.toBlob(oe=>{B(oe)},"image/jpeg",.7)}},R.readAsDataURL(I)}),z=()=>{ft.dismiss()},M=()=>{var I=new Object;I.id_route=n,I.comments=g.value,I.type=f.value,I.img=O,I.img_id=k,I.amount=s.value,I.concept=h.value,I.status="done",I.id_expense=E||"null";const B=new FormData;for(const R in I)B.append(R,I[R]);!k||!O||!g.value||!s.value||!h.value?v("Datos incompletos","Llena los datos requeridos para completar el registro"):fetch("https://app.rutaflow.com/api/admin/expenses/add_expense.php",{method:"POST",body:B}).then(R=>R.json()).then(R=>{z()}).catch(R=>{console.error("Error fetching data:",R)})};function H(I){ze[I?"unshift":"push"](()=>{h=I,t(4,h)})}function C(I){ze[I?"unshift":"push"](()=>{s=I,t(2,s)})}function w(I){ze[I?"unshift":"push"](()=>{f=I,t(1,f)})}function S(I){ze[I?"unshift":"push"](()=>{g=I,t(3,g)})}return[O,f,s,g,h,m,r,d,_,L,z,M,H,C,w,S]}class Tt extends lt{constructor(e){super(),it(this,e,fo,uo,ot,{})}}function Xt(i,e,t){const o=i.slice();return o[7]=e[t],o}function _o(i){let e,t="Cargar gasto",o,n;function r(...d){return i[4](i[7],...d)}return{c(){e=c("ion-button"),e.textContent=t,this.h()},l(d){e=u(d,"ION-BUTTON",{fill:!0,size:!0,"aria-selected":!0,"data-svelte-h":!0}),Z(e)!=="svelte-175aelj"&&(e.textContent=t),this.h()},h(){p(e,"fill","outline"),p(e,"size","small"),p(e,"aria-selected","")},m(d,_){U(d,e,_),o||(n=le(e,"click",r),o=!0)},p(d,_){i=d},d(d){d&&a(e),o=!1,n()}}}function ho(i){let e,t="Gasto completado";return{c(){e=c("ion-button"),e.textContent=t,this.h()},l(o){e=u(o,"ION-BUTTON",{fill:!0,size:!0,"aria-selected":!0,"data-svelte-h":!0}),Z(e)!=="svelte-tlger7"&&(e.textContent=t),this.h()},h(){p(e,"fill","solid"),p(e,"size","small"),p(e,"aria-selected","")},m(o,n){U(o,e,n)},p:Oe,d(o){o&&a(e)}}}function Jt(i,e){let t,o,n,r=e[7].concept+"",d,_,E;function O(s,g){return s[7].status=="done"?ho:_o}let f=O(e)(e);return{key:i,first:null,c(){t=c("ion-item"),o=c("ion-label"),n=c("p"),d=ce(r),_=N(),f.c(),E=N(),this.h()},l(s){t=u(s,"ION-ITEM",{});var g=b(t);o=u(g,"ION-LABEL",{style:!0});var h=b(o);n=u(h,"P",{style:!0});var m=b(n);d=ue(m,r),m.forEach(a),h.forEach(a),_=T(g),f.l(g),E=T(g),g.forEach(a),this.h()},h(){q(n,"margin-left","10px"),q(o,"display","flex"),this.first=t},m(s,g){U(s,t,g),l(t,o),l(o,n),l(n,d),l(t,_),f.m(t,null),l(t,E)},p(s,g){e=s,f.p(e,g)},d(s){s&&a(t),f.d()}}}function po(i){let e,t,o,n,r=`<ion-icon style="font-size: 25px!important;" icon="${Mn}"></ion-icon>`,d,_,E="LISTA DE GASTOS",O,k,f,s=[],g=new Map,h,m,v,L="Cerrar",y,z,M=Ke(i[0]);const H=C=>C[7].id_expenses;for(let C=0;C<M.length;C+=1){let w=Xt(i,M,C),S=H(w);g.set(S,s[C]=Jt(S,w))}return{c(){e=c("ion-header"),t=c("ion-toolbar"),o=c("ion-buttons"),n=c("ion-button"),n.innerHTML=r,d=N(),_=c("ion-title"),_.textContent=E,O=N(),k=c("ion-content"),f=c("ion-list");for(let C=0;C<s.length;C+=1)s[C].c();h=N(),m=c("ion-footer"),v=c("ion-button"),v.textContent=L,this.h()},l(C){e=u(C,"ION-HEADER",{translucent:!0});var w=b(e);t=u(w,"ION-TOOLBAR",{});var S=b(t);o=u(S,"ION-BUTTONS",{slot:!0});var I=b(o);n=u(I,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),Z(n)!=="svelte-160xz3i"&&(n.innerHTML=r),I.forEach(a),d=T(S),_=u(S,"ION-TITLE",{"data-svelte-h":!0}),Z(_)!=="svelte-1phn90x"&&(_.textContent=E),S.forEach(a),w.forEach(a),O=T(C),k=u(C,"ION-CONTENT",{fullscreen:!0});var B=b(k);f=u(B,"ION-LIST",{});var R=b(f);for(let j=0;j<s.length;j+=1)s[j].l(R);R.forEach(a),B.forEach(a),h=T(C),m=u(C,"ION-FOOTER",{});var P=b(m);v=u(P,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),Z(v)!=="svelte-zv7v83"&&(v.textContent=L),P.forEach(a),this.h()},h(){p(n,"color","medium"),p(o,"slot","end"),p(e,"translucent",""),p(k,"fullscreen",""),p(v,"fill","outline"),p(v,"color","tertiary"),p(v,"strong",""),q(v,"width","99%"),q(v,"height","auto")},m(C,w){U(C,e,w),l(e,t),l(t,o),l(o,n),l(t,d),l(t,_),U(C,O,w),U(C,k,w),l(k,f);for(let S=0;S<s.length;S+=1)s[S]&&s[S].m(f,null);U(C,h,w),U(C,m,w),l(m,v),y||(z=[le(n,"click",i[3]),le(v,"click",i[1])],y=!0)},p(C,[w]){w&5&&(M=Ke(C[0]),s=ct(s,w,H,1,C,M,g,f,ut,Jt,null,Xt))},i:Oe,o:Oe,d(C){C&&(a(e),a(O),a(k),a(h),a(m));for(let w=0;w<s.length;w+=1)s[w].d();y=!1,We(z)}}}function mo(i){let e=document.querySelector("ion-modal");e.componentProps.routeId;let t=e.componentProps.expenses;st(()=>{});const o=()=>{ft.dismiss()};function n(_,E,O,k,f){e.componentProps.ex_amount=O,e.componentProps.ex_concept=E,e.componentProps.ex_type=k,e.componentProps.id_expense=f,Xe("modal-expense",Tt,{amount:O,concept:E,type:k,id_expense:f}).then(()=>{}),o()}return[t,o,n,_=>{Xe("modal-expense",Tt,{routeId:_}).then(E=>{}),o()},(_,E)=>n(E,_.concept,_.amount,_.type,_.id_expenses)]}class vo extends lt{constructor(e){super(),it(this,e,mo,po,ot,{})}}const{document:Qt}=Un;function Yt(i,e,t){const o=i.slice();return o[34]=e[t],o}function Zt(i,e,t){const o=i.slice();return o[34]=e[t],o[36]=t,o}function xt(i,e,t){const o=i.slice();return o[34]=e[t],o[36]=t,o}function $t(i){let e,t;return e=new zn({props:{$$slots:{default:[No]},$$scope:{ctx:i}}}),{c(){bn(e.$$.fragment)},l(o){En(e.$$.fragment,o)},m(o,n){In(e,o,n),t=!0},p(o,n){const r={};n[0]&1019|n[1]&512&&(r.$$scope={dirty:n,ctx:o}),e.$set(r)},i(o){t||(mt(e.$$.fragment,o),t=!0)},o(o){kt(e.$$.fragment,o),t=!1},d(o){kn(e,o)}}}function go(i){let e,t='<div id="g_map" style="width: 100%; height: 100vh;"></div>';return{c(){e=c("ion-content"),e.innerHTML=t},l(o){e=u(o,"ION-CONTENT",{"data-svelte-h":!0}),Z(e)!=="svelte-1ydw6i9"&&(e.innerHTML=t)},m(o,n){U(o,e,n)},p:Oe,d(o){o&&a(e)}}}function bo(i){let e;function t(r,d){if(r[7].length>0)return Io;if(!r[3])return Eo}let o=t(i),n=o&&o(i);return{c(){n&&n.c(),e=He()},l(r){n&&n.l(r),e=He()},m(r,d){n&&n.m(r,d),U(r,e,d)},p(r,d){o===(o=t(r))&&n?n.p(r,d):(n&&n.d(1),n=o&&o(r),n&&(n.c(),n.m(e.parentNode,e)))},d(r){r&&a(e),n&&n.d(r)}}}function Eo(i){let e,t,o,n='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Jala para actualizar" refreshing-spinner="circles" refreshing-text="Actualizando..."></ion-refresher-content>',r,d,_=[],E=new Map,O,k,f=i[4]&&en(i),s=Ke(i[5]);const g=h=>h[34].id_event;for(let h=0;h<s.length;h+=1){let m=Yt(i,s,h),v=g(m);E.set(v,_[h]=nn(v,m))}return{c(){f&&f.c(),e=N(),t=c("ion-content"),o=c("ion-refresher"),o.innerHTML=n,r=N(),d=c("ion-list");for(let h=0;h<_.length;h+=1)_[h].c();this.h()},l(h){f&&f.l(h),e=T(h),t=u(h,"ION-CONTENT",{});var m=b(t);o=u(m,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),Z(o)!=="svelte-1srnbs3"&&(o.innerHTML=n),r=T(m),d=u(m,"ION-LIST",{});var v=b(d);for(let L=0;L<_.length;L+=1)_[L].l(v);v.forEach(a),m.forEach(a),this.h()},h(){p(o,"slot","fixed")},m(h,m){f&&f.m(h,m),U(h,e,m),U(h,t,m),l(t,o),i[26](o),l(t,r),l(t,d);for(let v=0;v<_.length;v+=1)_[v]&&_[v].m(d,null);O||(k=le(o,"ionRefresh",i[10]),O=!0)},p(h,m){h[4]?f?f.p(h,m):(f=en(h),f.c(),f.m(e.parentNode,e)):f&&(f.d(1),f=null),m[0]&167968&&(s=Ke(h[5]),_=ct(_,m,g,1,h,s,E,d,ut,nn,null,Yt))},d(h){h&&(a(e),a(t)),f&&f.d(h),i[26](null);for(let m=0;m<_.length;m+=1)_[m].d();O=!1,k()}}}function Io(i){let e,t;function o(d,_){return _[0]&144&&(e=null),e==null&&(e=!!(d[7].filter(yo).every(wo)&&!d[4])),e?Oo:ko}let n=o(i,[-1,-1]),r=n(i);return{c(){r.c(),t=He()},l(d){r.l(d),t=He()},m(d,_){r.m(d,_),U(d,t,_)},p(d,_){n===(n=o(d,_))&&r?r.p(d,_):(r.d(1),r=n(d),r&&(r.c(),r.m(t.parentNode,t)))},d(d){d&&a(t),r.d(d)}}}function en(i){let e=i[13]("",i[1],i[0])+"",t;return{c(){t=ce(e)},l(o){t=ue(o,e)},m(o,n){U(o,t,n)},p(o,n){n[0]&3&&e!==(e=o[13]("",o[1],o[0])+"")&&Pe(t,e)},d(o){o&&a(t)}}}function tn(i){let e;return{c(){e=c("span"),this.h()},l(t){e=u(t,"SPAN",{class:!0}),b(e).forEach(a),this.h()},h(){Y(e,"class","notes svelte-egzizz")},m(t,o){U(t,e,o)},d(t){t&&a(e)}}}function nn(i,e){let t,o,n,r,d=parseInt(e[34].pos)+1+"",_,E,O,k,f,s,g=e[34].title+"",h,m,v=e[34].support_list&&e[34].support_list.length||e[15](e[34]),L,y,z,M,H,C=v&&tn();function w(){return e[27](e[34])}return{key:i,first:null,c(){t=c("ion-item"),o=c("ion-avatar"),n=c("div"),r=c("div"),_=ce(d),O=N(),k=c("ion-label"),f=c("ion-text"),s=c("h3"),h=ce(g),m=N(),C&&C.c(),L=N(),y=c("ion-icon"),z=N(),this.h()},l(S){t=u(S,"ION-ITEM",{});var I=b(t);o=u(I,"ION-AVATAR",{slot:!0});var B=b(o);n=u(B,"DIV",{class:!0,title:!0,style:!0});var R=b(n);r=u(R,"DIV",{class:!0});var P=b(r);_=ue(P,d),P.forEach(a),R.forEach(a),B.forEach(a),O=T(I),k=u(I,"ION-LABEL",{button:!0});var j=b(k);f=u(j,"ION-TEXT",{color:!0});var V=b(f);s=u(V,"H3",{});var X=b(s);h=ue(X,g),m=T(X),C&&C.l(X),X.forEach(a),V.forEach(a),j.forEach(a),L=T(I),y=u(I,"ION-ICON",{icon:!0,slot:!0,style:!0}),b(y).forEach(a),z=T(I),I.forEach(a),this.h()},h(){Y(r,"class","order svelte-egzizz"),Y(n,"class","order-wrapper svelte-egzizz"),Y(n,"title",E=tt(e[34].status)),q(n,"background-color",Ae(e[34].status)),q(n,"color",nt(Ae(e[34].status))),p(o,"slot","start"),p(f,"color","#2e2e2e"),p(k,"button",""),p(y,"icon",rt),p(y,"slot","end"),q(y,"color",Ae(e[34].status)),this.first=t},m(S,I){U(S,t,I),l(t,o),l(o,n),l(n,r),l(r,_),l(t,O),l(t,k),l(k,f),l(f,s),l(s,h),l(s,m),C&&C.m(s,null),l(t,L),l(t,y),l(t,z),M||(H=le(k,"click",w),M=!0)},p(S,I){e=S,I[0]&32&&d!==(d=parseInt(e[34].pos)+1+"")&&Pe(_,d),I[0]&32&&E!==(E=tt(e[34].status))&&Y(n,"title",E),I[0]&32&&q(n,"background-color",Ae(e[34].status)),I[0]&32&&q(n,"color",nt(Ae(e[34].status))),I[0]&32&&g!==(g=e[34].title+"")&&Pe(h,g),I[0]&32&&(v=e[34].support_list&&e[34].support_list.length||e[15](e[34])),v?C||(C=tn(),C.c(),C.m(s,null)):C&&(C.d(1),C=null),I[0]&32&&q(y,"color",Ae(e[34].status))},d(S){S&&a(t),C&&C.d(),M=!1,H()}}}function ko(i){let e=i[13](i[7],i[1],i[0])+"",t,o,n,r,d='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Pull to refresh" refreshing-spinner="circles" refreshing-text="Refreshing..."></ion-refresher-content>',_,E,O=[],k=new Map,f,s,g=Ke(i[5]);const h=m=>m[34].id_event;for(let m=0;m<g.length;m+=1){let v=Zt(i,g,m),L=h(v);k.set(L,O[m]=ln(L,v))}return{c(){t=ce(e),o=N(),n=c("ion-content"),r=c("ion-refresher"),r.innerHTML=d,_=N(),E=c("ion-list");for(let m=0;m<O.length;m+=1)O[m].c();this.h()},l(m){t=ue(m,e),o=T(m),n=u(m,"ION-CONTENT",{});var v=b(n);r=u(v,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),Z(r)!=="svelte-dvt1s"&&(r.innerHTML=d),_=T(v),E=u(v,"ION-LIST",{});var L=b(E);for(let y=0;y<O.length;y+=1)O[y].l(L);L.forEach(a),v.forEach(a),this.h()},h(){p(r,"slot","fixed")},m(m,v){U(m,t,v),U(m,o,v),U(m,n,v),l(n,r),i[24](r),l(n,_),l(n,E);for(let L=0;L<O.length;L+=1)O[L]&&O[L].m(E,null);f||(s=le(r,"ionRefresh",i[10]),f=!0)},p(m,v){v[0]&131&&e!==(e=m[13](m[7],m[1],m[0])+"")&&Pe(t,e),v[0]&299040&&(g=Ke(m[5]),O=ct(O,v,h,1,m,g,k,E,ut,ln,null,Zt))},d(m){m&&(a(t),a(o),a(n)),i[24](null);for(let v=0;v<O.length;v+=1)O[v].d();f=!1,s()}}}function Oo(i){let e,t,o='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Jale para actualizar" refreshing-spinner="circles" refreshing-text="Actualizando..."></ion-refresher-content>',n,r,d=[],_=new Map,E,O,k=Ke(i[5]);const f=s=>s[34].id_event;for(let s=0;s<k.length;s+=1){let g=xt(i,k,s),h=f(g);_.set(h,d[s]=an(h,g))}return{c(){e=c("ion-content"),t=c("ion-refresher"),t.innerHTML=o,n=N(),r=c("ion-list");for(let s=0;s<d.length;s+=1)d[s].c();this.h()},l(s){e=u(s,"ION-CONTENT",{});var g=b(e);t=u(g,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),Z(t)!=="svelte-15ukrgn"&&(t.innerHTML=o),n=T(g),r=u(g,"ION-LIST",{});var h=b(r);for(let m=0;m<d.length;m+=1)d[m].l(h);h.forEach(a),g.forEach(a),this.h()},h(){p(t,"slot","fixed")},m(s,g){U(s,e,g),l(e,t),i[22](t),l(e,n),l(e,r);for(let h=0;h<d.length;h+=1)d[h]&&d[h].m(r,null);E||(O=le(t,"ionRefresh",i[10]),E=!0)},p(s,g){g[0]&299040&&(k=Ke(s[5]),d=ct(d,g,f,1,s,k,_,r,ut,an,null,xt))},d(s){s&&a(e),i[22](null);for(let g=0;g<d.length;g+=1)d[g].d();E=!1,O()}}}function on(i){let e;return{c(){e=c("span"),this.h()},l(t){e=u(t,"SPAN",{class:!0}),b(e).forEach(a),this.h()},h(){Y(e,"class","notes svelte-egzizz")},m(t,o){U(t,e,o)},d(t){t&&a(e)}}}function ln(i,e){let t,o,n,r,d=parseInt(e[34].pos)+1+"",_,E,O,k,f,s,g=e[34].title+"",h,m,v=e[34].support_list&&e[34].support_list.length||e[15](e[34]),L,y,z="",M,H,C,w,S,I=v&&on();function B(){return e[25](e[34],e[36])}return{key:i,first:null,c(){t=c("ion-item"),o=c("ion-avatar"),n=c("div"),r=c("div"),_=ce(d),O=N(),k=c("ion-label"),f=c("ion-text"),s=c("h3"),h=ce(g),m=N(),I&&I.c(),L=N(),y=c("div"),y.innerHTML=z,M=N(),H=c("ion-icon"),C=N(),this.h()},l(R){t=u(R,"ION-ITEM",{});var P=b(t);o=u(P,"ION-AVATAR",{slot:!0});var j=b(o);n=u(j,"DIV",{class:!0,title:!0,style:!0});var V=b(n);r=u(V,"DIV",{class:!0});var X=b(r);_=ue(X,d),X.forEach(a),V.forEach(a),j.forEach(a),O=T(P),k=u(P,"ION-LABEL",{button:!0});var x=b(k);f=u(x,"ION-TEXT",{color:!0});var J=b(f);s=u(J,"H3",{});var W=b(s);h=ue(W,g),m=T(W),I&&I.l(W),W.forEach(a),J.forEach(a),L=T(x),y=u(x,"DIV",{class:!0,"data-svelte-h":!0}),Z(y)!=="svelte-qaecoo"&&(y.innerHTML=z),x.forEach(a),M=T(P),H=u(P,"ION-ICON",{icon:!0,slot:!0}),b(H).forEach(a),C=T(P),P.forEach(a),this.h()},h(){Y(r,"class","order svelte-egzizz"),Y(n,"class","order-wrapper svelte-egzizz"),Y(n,"title",E=tt(e[34].status)),q(n,"background-color",Ae(e[34].status)),q(n,"color",nt(Ae(e[34].status))),p(o,"slot","start"),p(f,"color","#2e2e2e"),Y(y,"class","sub svelte-egzizz"),p(k,"button",""),p(H,"icon",rt),p(H,"slot","end"),this.first=t},m(R,P){U(R,t,P),l(t,o),l(o,n),l(n,r),l(r,_),l(t,O),l(t,k),l(k,f),l(f,s),l(s,h),l(s,m),I&&I.m(s,null),l(k,L),l(k,y),l(t,M),l(t,H),l(t,C),w||(S=le(k,"click",B),w=!0)},p(R,P){e=R,P[0]&32&&d!==(d=parseInt(e[34].pos)+1+"")&&Pe(_,d),P[0]&32&&E!==(E=tt(e[34].status))&&Y(n,"title",E),P[0]&32&&q(n,"background-color",Ae(e[34].status)),P[0]&32&&q(n,"color",nt(Ae(e[34].status))),P[0]&32&&g!==(g=e[34].title+"")&&Pe(h,g),P[0]&32&&(v=e[34].support_list&&e[34].support_list.length||e[15](e[34])),v?I||(I=on(),I.c(),I.m(s,null)):I&&(I.d(1),I=null)},d(R){R&&a(t),I&&I.d(),w=!1,S()}}}function rn(i){let e;return{c(){e=c("span"),this.h()},l(t){e=u(t,"SPAN",{class:!0}),b(e).forEach(a),this.h()},h(){Y(e,"class","notes svelte-egzizz")},m(t,o){U(t,e,o)},d(t){t&&a(e)}}}function an(i,e){let t,o,n,r,d=parseInt(e[34].pos)+1+"",_,E,O,k,f,s,g=e[34].title+"",h,m,v=e[34].support_list&&e[34].support_list.length||e[15](e[34]),L,y,z="",M,H,C,w,S,I=v&&rn();function B(){return e[23](e[34],e[36])}return{key:i,first:null,c(){t=c("ion-item"),o=c("ion-avatar"),n=c("div"),r=c("div"),_=ce(d),O=N(),k=c("ion-label"),f=c("ion-text"),s=c("h3"),h=ce(g),m=N(),I&&I.c(),L=N(),y=c("div"),y.innerHTML=z,M=N(),H=c("ion-icon"),C=N(),this.h()},l(R){t=u(R,"ION-ITEM",{});var P=b(t);o=u(P,"ION-AVATAR",{slot:!0});var j=b(o);n=u(j,"DIV",{class:!0,title:!0,style:!0});var V=b(n);r=u(V,"DIV",{class:!0});var X=b(r);_=ue(X,d),X.forEach(a),V.forEach(a),j.forEach(a),O=T(P),k=u(P,"ION-LABEL",{button:!0});var x=b(k);f=u(x,"ION-TEXT",{color:!0});var J=b(f);s=u(J,"H3",{});var W=b(s);h=ue(W,g),m=T(W),I&&I.l(W),W.forEach(a),J.forEach(a),L=T(x),y=u(x,"DIV",{class:!0,"data-svelte-h":!0}),Z(y)!=="svelte-qaecoo"&&(y.innerHTML=z),x.forEach(a),M=T(P),H=u(P,"ION-ICON",{icon:!0,slot:!0}),b(H).forEach(a),C=T(P),P.forEach(a),this.h()},h(){Y(r,"class","order svelte-egzizz"),Y(n,"class","order-wrapper svelte-egzizz"),Y(n,"title",E=tt(e[34].status)),q(n,"background-color",Ae(e[34].status)),q(n,"color",nt(Ae(e[34].status))),p(o,"slot","start"),p(f,"color","#2e2e2e"),Y(y,"class","sub svelte-egzizz"),p(k,"button",""),p(H,"icon",rt),p(H,"slot","end"),this.first=t},m(R,P){U(R,t,P),l(t,o),l(o,n),l(n,r),l(r,_),l(t,O),l(t,k),l(k,f),l(f,s),l(s,h),l(s,m),I&&I.m(s,null),l(k,L),l(k,y),l(t,M),l(t,H),l(t,C),w||(S=le(k,"click",B),w=!0)},p(R,P){e=R,P[0]&32&&d!==(d=parseInt(e[34].pos)+1+"")&&Pe(_,d),P[0]&32&&E!==(E=tt(e[34].status))&&Y(n,"title",E),P[0]&32&&q(n,"background-color",Ae(e[34].status)),P[0]&32&&q(n,"color",nt(Ae(e[34].status))),P[0]&32&&g!==(g=e[34].title+"")&&Pe(h,g),P[0]&32&&(v=e[34].support_list&&e[34].support_list.length||e[15](e[34])),v?I||(I=rn(),I.c(),I.m(s,null)):I&&(I.d(1),I=null)},d(R){R&&a(t),I&&I.d(),w=!1,S()}}}function No(i){let e,t,o,n,r=`<ion-icon icon="${An}"></ion-icon>`,d,_,E,O=`<ion-icon icon="${Bn}"></ion-icon>`,k,f,s=(i[6].name?i[6].name.toUpperCase():"")+"",g,h,m,v='<ion-segment-button value="list"><ion-label>Paradas</ion-label></ion-segment-button> <ion-segment-button value="map"><ion-label>Mapa</ion-label></ion-segment-button>',L,y,z,M;function H(S,I){if(S[9]==="list")return bo;if(S[9]==="map")return go}let C=H(i),w=C&&C(i);return{c(){e=c("ion-header"),t=c("ion-toolbar"),o=c("ion-buttons"),n=c("ion-button"),n.innerHTML=r,d=N(),_=c("ion-buttons"),E=c("ion-button"),E.innerHTML=O,k=N(),f=c("ion-title"),g=ce(s),h=N(),m=c("ion-segment"),m.innerHTML=v,L=N(),w&&w.c(),y=He(),this.h()},l(S){e=u(S,"ION-HEADER",{translucent:!0});var I=b(e);t=u(I,"ION-TOOLBAR",{});var B=b(t);o=u(B,"ION-BUTTONS",{slot:!0});var R=b(o);n=u(R,"ION-BUTTON",{title:!0,alt:!0,"data-svelte-h":!0}),Z(n)!=="svelte-7ppz3r"&&(n.innerHTML=r),R.forEach(a),d=T(B),_=u(B,"ION-BUTTONS",{slot:!0});var P=b(_);E=u(P,"ION-BUTTON",{"data-svelte-h":!0}),Z(E)!=="svelte-nf50hj"&&(E.innerHTML=O),P.forEach(a),k=T(B),f=u(B,"ION-TITLE",{});var j=b(f);g=ue(j,s),j.forEach(a),B.forEach(a),h=T(I),m=u(I,"ION-SEGMENT",{value:!0,"data-svelte-h":!0}),Z(m)!=="svelte-lue4c9"&&(m.innerHTML=v),I.forEach(a),L=T(S),w&&w.l(S),y=He(),this.h()},h(){p(n,"title","Atrás"),p(n,"alt","Atrás"),p(o,"slot","start"),p(_,"slot","end"),p(m,"value","list"),p(e,"translucent","")},m(S,I){U(S,e,I),l(e,t),l(t,o),l(o,n),l(t,d),l(t,_),l(_,E),l(t,k),l(t,f),l(f,g),l(e,h),l(e,m),U(S,L,I),w&&w.m(S,I),U(S,y,I),z||(M=[le(n,"click",i[16]),le(E,"click",i[20]),le(m,"ionChange",i[21])],z=!0)},p(S,I){I[0]&64&&s!==(s=(S[6].name?S[6].name.toUpperCase():"")+"")&&Pe(g,s),C===(C=H(S))&&w?w.p(S,I):(w&&w.d(1),w=C&&C(S),w&&(w.c(),w.m(y.parentNode,y)))},d(S){S&&(a(e),a(L),a(y)),w&&w.d(S),z=!1,We(M)}}}function To(i){let e,t,o,n=i[2]&&$t(i);return{c(){e=N(),n&&n.c(),t=He(),this.h()},l(r){pn("svelte-kn0kph",Qt.head).forEach(a),e=T(r),n&&n.l(r),t=He(),this.h()},h(){Qt.title="Rutaflow - Detalles de ruta"},m(r,d){U(r,e,d),n&&n.m(r,d),U(r,t,d),o=!0},p(r,d){r[2]?n?(n.p(r,d),d[0]&4&&mt(n,1)):(n=$t(r),n.c(),mt(n,1),n.m(t.parentNode,t)):n&&(On(),kt(n,1,1,()=>{n=null}),gn())},i(r){o||(mt(n),o=!0)},o(r){kt(n),o=!1},d(r){r&&(a(e),a(t)),n&&n.d(r)}}}function Ae(i){let e="#ffffff";return i==="pending"?e="#f2e300":i==="completed"&&(e="#44d900"),e}function tt(i){let e="";return i=="pending"?e="Pendiente":i=="completed"&&(e="Completado"),e}function nt(i){i.slice(0,1)==="#"&&(i=i.slice(1)),i.length===3&&(i=i.split("").map(function(r){return r+r}).join(""));const e=parseInt(i.substr(0,2),16),t=parseInt(i.substr(2,2),16),o=parseInt(i.substr(4,2),16);return(e*299+t*587+o*114)/1e3>=128?"#414040":"#fff"}function Co(i,e){let t=new FormData;return t.append("id_route",i),t.append("status",e),fetch("https://app.rutaflow.com/api/admin/route/change_status.php",{method:"POST",body:t}).then(o=>o.json()).then(o=>{}).catch(o=>{console.error("Error fetching data:",o)}),""}const yo=i=>i.mandatory==="1",wo=i=>i.img;function Lo(i,e,t){let o;mn(i,Dn,A=>t(19,o=A));var n=this&&this.__awaiter||function(A,F,Q,te){function ie(ee){return ee instanceof Q?ee:new Q(function(ne){ne(ee)})}return new(Q||(Q=Promise))(function(ee,ne){function fe(Ne){try{Ie(te.next(Ne))}catch(Me){ne(Me)}}function ge(Ne){try{Ie(te.throw(Ne))}catch(Me){ne(Me)}}function Ie(Ne){Ne.done?ee(Ne.value):ie(Ne.value).then(fe,ge)}Ie((te=te.apply(A,F||[])).next())})};let{routeId:r}=e,{driverId:d}=e,_=new Object,E=!0,O=!1,k=[],f={},s=[],g=[],h,m=!1,v="list",L;const y=()=>n(void 0,void 0,void 0,function*(){yield M(r),h.complete()});st(()=>n(void 0,void 0,void 0,function*(){d=="41"&&(localStorage.clear(),console.log("Cleared session from localStorage")),yield M(r)}));function z(A){return n(this,void 0,void 0,function*(){if(t(9,v=A),v==="map"){yield vn(),L=document.getElementById("g_map");const F=new google.maps.Map(L,{zoom:8,center:{lat:20.6745683,lng:-103.3986104},mapId:"4504f8b37365c3d0"}),Q=new google.maps.LatLngBounds,{AdvancedMarkerElement:te,PinElement:ie}=yield google.maps.importLibrary("marker");navigator.geolocation?navigator.geolocation.getCurrentPosition(function(ee){const ne=new google.maps.LatLng(ee.coords.latitude,ee.coords.longitude);new google.maps.Marker({position:ne,map:F,icon:{path:google.maps.SymbolPath.CIRCLE,fillColor:"#0062ff",fillOpacity:1,scale:6,strokeColor:"#ffffff",strokeWeight:2}}),new google.maps.Circle({strokeColor:"#00BFFF",strokeOpacity:.5,strokeWeight:1,fillColor:"#00BFFF",fillOpacity:.2,map:F,center:ne,radius:ee.coords.accuracy}),Q.extend(ne)},function(ee){console.error("Error retrieving location:",ee)}):console.error("Geolocation not supported by this browser."),k.forEach((ee,ne)=>{const fe=parseFloat(ee.lat),ge=parseFloat(ee.lon),Ie=new google.maps.LatLng(fe,ge),Ne=new google.maps.Marker({position:{lat:fe,lng:ge},map:F,title:ee.title}),Me=new ie({background:Ae(ee.status),borderColor:"#000",glyphColor:"#000",glyph:(parseInt(ee.pos)+1).toString()});new te({map:F,position:Ie,content:Me.element,title:"Parada "+(parseInt(ee.pos)+1).toString()+": "+ee.title}).addListener("click",function(Re){C(ee,P(ne))}),Q.extend(Ne.getPosition())}),F.fitBounds(Q)}})}function M(A){return n(this,void 0,void 0,function*(){const F=new FormData;F.append("id_route",A);try{const te=yield(yield fetch("https://app.rutaflow.com/api/admin/report/seguimiento_list.php",{method:"POST",body:F})).json();t(6,f=te.data.seguimiento_list[0]),t(5,k=te.data.event_list),t(7,s=te.data.checklist),g=te.data.expenses,f&&t(4,O=f.km_inicial=="0"&&f.gas_inicial=="0"),t(3,E=!1)}catch(Q){t(3,E=!1),console.error("Error fetching data:",Q)}})}const H=A=>new Promise((F,Q)=>{const te=new FormData;te.append("id_route",A.id_route),te.append("id_event",A.id_event),fetch("https://app.rutaflow.com/api/admin/evidence/evidence_by_event.php",{method:"POST",body:te}).then(ie=>ie.json()).then(ie=>{F(ie.data.event_evidence[0])}).catch(ie=>{console.error("Error fetching data:",ie),Q(ie)})}),C=(A,F)=>{H(A).then(Q=>{Q&&(A.img=Q.img,A.driver_comments=Q.driver_comments,A.comments=Q.comments),Xe("modal-delivery-info",co,{delivery:A,isLast:F}).then(te=>{}).finally(()=>{M(r)})})},w=(A,F,Q)=>{var te=!1;return m||(m=!0,Xe("modal-checklist",_n,{checklist:A,driverId:F,routeId:Q,isLast:te}).then(ie=>{m=!1}),Co(Q,"checklist")),""},S=A=>n(void 0,void 0,void 0,function*(){return yield M(A),g.length>0?Xe("modal-expense-detail",vo,{routeId:A,expenses:g}).then(F=>{}):Xe("modal-expense",Tt,{routeId:A}).then(F=>{}),""}),I=A=>{if(A.tracking_type=="subscription"){if(A.subscriber_info&&A.payment_type==="cash"&&new Date(A.subscriber_info.payment_next)<new Date)return!0}else if(A.tracking_type=="ecommerce"&&Number(A.payment_pending)>0)return!0;return!1},B=()=>{_.type=="super"?Qe("/drivers/me"):_.id_driver&&Qe(`/drivers/${_.id_driver}`)},R=(A,F)=>n(void 0,void 0,void 0,function*(){yield(yield Ye.create({header:A||"Error",message:F||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()});function P(A){return A===k.length-1}const j=()=>S(r),V=A=>z(A.detail.value);function X(A){ze[A?"unshift":"push"](()=>{h=A,t(8,h)})}const x=(A,F)=>C(A,P(F));function J(A){ze[A?"unshift":"push"](()=>{h=A,t(8,h)})}const W=(A,F)=>C(A,P(F));function K(A){ze[A?"unshift":"push"](()=>{h=A,t(8,h)})}const oe=A=>{const F=k.findIndex(ne=>ne.id_event===A.id_event),Q=F===0,te=F>0?k[F-1]:null,ie=Q||te&&te.img!==null,ee=A.img!==null&&A.img!=="";ie||Q&&!ee?C(A):R("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")};return i.$$set=A=>{"routeId"in A&&t(0,r=A.routeId),"driverId"in A&&t(1,d=A.driverId)},i.$$.update=()=>{i.$$.dirty[0]&524293&&(t(0,{routeId:r,driverId:d}=o.params,r,(t(1,d),t(19,o),t(2,_),t(0,r))),t(2,_=JSON.parse(localStorage.getItem("userSession"))),_?_.id_user&&(_.type=="admin"||_.type=="super")?(M(r),Qe(`/drivers/me/routes/${r}`)):_.id_user&&_.id_driver&&(M(r),Qe(`/drivers/${_.id_driver}/routes/${r}`)):Qe("/"))},[r,d,_,E,O,k,f,s,h,v,y,z,C,w,S,I,B,R,P,o,j,V,X,x,J,W,K,oe]}class Ho extends lt{constructor(e){super(),it(this,e,Lo,To,ot,{routeId:0,driverId:1},null,[-1,-1])}}export{Ho as component};

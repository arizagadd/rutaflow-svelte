import{Z as ft,s as We,e as s,j as N,b as c,q as m,d as oe,h as a,m as T,v,i as x,w as o,x as ce,n as ze,z as Be,_ as tn,B as L,o as Ze,k as De,$ as dt,t as Ee,r as Ie,f as $,a0 as nn,a1 as Qe,A as Se,y as Le,a2 as on,a3 as Ke,a4 as ln,a5 as rn,l as an,p as sn,F as cn}from"../chunks/index.CdEBkEwf.js";import{S as Je,i as Ye,t as lt,a as at,c as un,b as fn,d as dn,m as _n,e as hn,g as pn}from"../chunks/index.c2pjNB5R.js";import{e as He,u as xe,d as $e,a as mn,b as vn,c as gn,i as Qt,f as bn,g as Zt,h as En,j as In,k as st,m as kn,n as xt,s as _t,o as Re,q as On,r as Nn,t as Tn,v as Cn,w as yn,x as wn,y as Ln,z as zn,p as An}from"../chunks/index.aVm2B5Ks.js";import"../chunks/index-48209844.IIRtDZyg.js";import{m as et,D as it,a as je,I as Mn}from"../chunks/IonPage.Camov4E5.js";import{q as Sn,t as Dn}from"../chunks/ion-modal.CsJaVgKZ.js";import{g as qe}from"../chunks/entry.DAbes_4C.js";const Pn=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global,Bn=(i,e)=>{if(!customElements.get(i)){class t extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const n={};for(const l of this.attributes)n[l.name]=l.value;new e({target:this.shadowRoot,props:n})}}customElements.define(i,t)}},Hn=function(i){return document.createElement(i).constructor!==HTMLElement},Rn=(i,e)=>{Hn(i)||Bn(i,e)},Ue=async(i,e,t)=>{Sn(),Dn(),Rn(i,e);const r=await et.create({component:i,componentProps:t});return r.present(),await r.onWillDismiss()};let Ge=ft({km_inicial:[],gas_inicial:[],km_final:[],gas_final:[]}),$t=ft({flag:[]});function Un(i){let e,t,r,n,l="Cancelar",f,d,h="Captura de Km/Gas",k,g,_,u="Confirmar",p,b,O,w,R,A,q;return{c(){e=s("ion-header"),t=s("ion-toolbar"),r=s("ion-buttons"),n=s("ion-button"),n.textContent=l,f=N(),d=s("ion-title"),d.textContent=h,k=N(),g=s("ion-buttons"),_=s("ion-button"),_.textContent=u,p=N(),b=s("ion-content"),O=s("ion-item"),w=s("ion-input"),this.h()},l(V){e=c(V,"ION-HEADER",{translucent:!0});var F=m(e);t=c(F,"ION-TOOLBAR",{});var z=m(t);r=c(z,"ION-BUTTONS",{slot:!0});var S=m(r);n=c(S,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),oe(n)!=="svelte-17pq4f4"&&(n.textContent=l),S.forEach(a),f=T(z),d=c(z,"ION-TITLE",{"data-svelte-h":!0}),oe(d)!=="svelte-1yhkaq7"&&(d.textContent=h),k=T(z),g=c(z,"ION-BUTTONS",{slot:!0});var E=m(g);_=c(E,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),oe(_)!=="svelte-cm6j4s"&&(_.textContent=u),E.forEach(a),z.forEach(a),F.forEach(a),p=T(V),b=c(V,"ION-CONTENT",{fullscreen:!0});var C=m(b);O=c(C,"ION-ITEM",{});var D=m(O);w=c(D,"ION-INPUT",{class:!0,inputmode:!0,pattern:!0,type:!0,placeholder:!0,value:!0,required:!0});var H=m(w);H.forEach(a),D.forEach(a),C.forEach(a),this.h()},h(){v(n,"color","medium"),v(r,"slot","start"),v(_,"strong",""),v(g,"slot","end"),v(e,"translucent",""),v(w,"class","fin-km"),v(w,"inputmode","numeric"),v(w,"pattern","[0-9]*"),v(w,"type","number"),v(w,"placeholder",R="Ingresa "+i[0]+" actual"),v(w,"value",i[1]),v(w,"required",""),v(b,"fullscreen","")},m(V,F){x(V,e,F),o(e,t),o(t,r),o(r,n),o(t,f),o(t,d),o(t,k),o(t,g),o(g,_),x(V,p,F),x(V,b,F),o(b,O),o(O,w),A||(q=[ce(n,"click",i[2]),ce(_,"click",i[3]),ce(w,"input",i[4])],A=!0)},p(V,[F]){F&1&&R!==(R="Ingresa "+V[0]+" actual")&&v(w,"placeholder",R),F&2&&v(w,"value",V[1])},i:ze,o:ze,d(V){V&&(a(e),a(p),a(b)),A=!1,Be(q)}}}function Vn(i,e,t){const r=tn();let n=document.querySelector("ion-modal"),l=n.componentProps.data_type;n.componentProps.isLast;let f;$t.subscribe(_=>{l=_.flag[0],l=="km_final"||l=="km_inicial"?t(0,f="kilometraje"):t(0,f="litros de gasolina")});let d=0;function h(){et.dismiss()}function k(){r("modalResult",{data:"Your data",role:"confirm"}),l=="km_inicial"?Ge.update(u=>({...u,km_inicial:[d]})):l=="gas_inicial"?Ge.update(u=>({...u,gas_inicial:[d]})):l=="km_final"?Ge.update(u=>({...u,km_final:[d]})):l=="gas_final"&&Ge.update(u=>({...u,gas_final:[d]})),h()}return[f,d,h,k,_=>t(1,d=_.target.value)]}class Fn extends Je{constructor(e){super(),Ye(this,e,Vn,Un,We,{})}}const rt=ft({items:[],checkedIndices:[],mandatory:[]});function gt(i,e,t){const r=i.slice();return r[55]=e[t],r[56]=e,r[57]=t,r}function qn(i){let e,t,r,n,l,f="Kilometraje inicial",d,h,k=i[0]?i[0]+" km.":"Cargar km",g,_,u,p,b,O,w,R="Gasolina inicial (litros)",A,q,V=i[1]?i[1]+" litros":"Cargar gas",F,z,S,E;return z=dt(i[21][0]),{c(){e=s("ion-item"),t=s("ion-label"),r=s("input"),n=N(),l=s("p"),l.textContent=f,d=N(),h=s("ion-button"),g=Ee(k),_=N(),u=s("ion-item"),p=s("ion-label"),b=s("input"),O=N(),w=s("p"),w.textContent=R,A=N(),q=s("ion-button"),F=Ee(V),this.h()},l(C){e=c(C,"ION-ITEM",{});var D=m(e);t=c(D,"ION-LABEL",{style:!0});var H=m(t);r=c(H,"INPUT",{id:!0,style:!0,type:!0}),n=T(H),l=c(H,"P",{style:!0,"data-svelte-h":!0}),oe(l)!=="svelte-88twxi"&&(l.textContent=f),H.forEach(a),d=T(D),h=c(D,"ION-BUTTON",{fill:!0,size:!0,class:!0,"aria-selected":!0});var P=m(h);g=Ie(P,k),P.forEach(a),D.forEach(a),_=T(C),u=c(C,"ION-ITEM",{});var Q=m(u);p=c(Q,"ION-LABEL",{style:!0});var X=m(p);b=c(X,"INPUT",{id:!0,style:!0,type:!0}),O=T(X),w=c(X,"P",{style:!0,"data-svelte-h":!0}),oe(w)!=="svelte-1ux30eb"&&(w.textContent=R),X.forEach(a),A=T(Q),q=c(Q,"ION-BUTTON",{fill:!0,class:!0,size:!0,style:!0});var ee=m(q);F=Ie(ee,V),ee.forEach(a),Q.forEach(a),this.h()},h(){$(r,"id","chkbox-km-ini"),L(r,"pointer-events","auto"),$(r,"type","checkbox"),r.required=!0,L(l,"margin-left","10px"),L(t,"display","flex"),v(h,"fill","outline"),v(h,"size","small"),v(h,"class","loadKmInicial"),v(h,"aria-selected",""),$(b,"id","chkbox-gas-ini"),L(b,"pointer-events","auto"),$(b,"type","checkbox"),b.required=!0,L(w,"margin-left","10px"),L(p,"display","flex"),v(q,"fill","outline"),v(q,"class","loadGasInicial"),v(q,"size","small"),L(q,"height","16px "),z.p(r,b)},m(C,D){x(C,e,D),o(e,t),o(t,r),r.checked=~(i[4]||[]).indexOf(r.__value),i[28](r),o(t,n),o(t,l),o(e,d),o(e,h),o(h,g),x(C,_,D),x(C,u,D),o(u,p),o(p,b),i[30](b),b.checked=~(i[4]||[]).indexOf(b.__value),o(p,O),o(p,w),o(u,A),o(u,q),o(q,F),S||(E=[ce(r,"change",i[27]),ce(h,"click",i[29]),ce(b,"change",i[31]),ce(q,"click",i[32])],S=!0)},p(C,D){D[0]&16&&(r.checked=~(C[4]||[]).indexOf(r.__value)),D[0]&1&&k!==(k=C[0]?C[0]+" km.":"Cargar km")&&Le(g,k),D[0]&16&&(b.checked=~(C[4]||[]).indexOf(b.__value)),D[0]&2&&V!==(V=C[1]?C[1]+" litros":"Cargar gas")&&Le(F,V)},d(C){C&&(a(e),a(_),a(u)),i[28](null),i[30](null),z.r(),S=!1,Be(E)}}}function jn(i){let e,t,r,n,l,f="Kilometraje final",d,h,k=i[2]?i[2]+" km.":"Cargar km",g,_,u,p,b,O,w,R="Gasolina final (litros)",A,q,V=i[3]?i[3]+" litros":"Cargar gas",F,z,S,E;return z=dt(i[21][0]),{c(){e=s("ion-item"),t=s("ion-label"),r=s("input"),n=N(),l=s("p"),l.textContent=f,d=N(),h=s("ion-button"),g=Ee(k),_=N(),u=s("ion-item"),p=s("ion-label"),b=s("input"),O=N(),w=s("p"),w.textContent=R,A=N(),q=s("ion-button"),F=Ee(V),this.h()},l(C){e=c(C,"ION-ITEM",{});var D=m(e);t=c(D,"ION-LABEL",{style:!0});var H=m(t);r=c(H,"INPUT",{id:!0,style:!0,type:!0}),n=T(H),l=c(H,"P",{style:!0,"data-svelte-h":!0}),oe(l)!=="svelte-ccmu71"&&(l.textContent=f),H.forEach(a),d=T(D),h=c(D,"ION-BUTTON",{fill:!0,size:!0,class:!0,"aria-selected":!0});var P=m(h);g=Ie(P,k),P.forEach(a),D.forEach(a),_=T(C),u=c(C,"ION-ITEM",{});var Q=m(u);p=c(Q,"ION-LABEL",{style:!0});var X=m(p);b=c(X,"INPUT",{id:!0,style:!0,type:!0}),O=T(X),w=c(X,"P",{style:!0,"data-svelte-h":!0}),oe(w)!=="svelte-wsoyd2"&&(w.textContent=R),X.forEach(a),A=T(Q),q=c(Q,"ION-BUTTON",{fill:!0,size:!0,class:!0});var ee=m(q);F=Ie(ee,V),ee.forEach(a),Q.forEach(a),this.h()},h(){$(r,"id","chkbox-km-fin"),L(r,"pointer-events","auto"),$(r,"type","checkbox"),r.required=!0,L(l,"margin-left","10px"),L(t,"display","flex"),v(h,"fill","outline"),v(h,"size","small"),v(h,"class","loadKmInicial"),v(h,"aria-selected",""),$(b,"id","chkbox-gas-fin"),L(b,"pointer-events","auto"),$(b,"type","checkbox"),b.required=!0,L(w,"margin-left","10px"),L(p,"display","flex"),v(q,"fill","outline"),v(q,"size","small"),v(q,"class","loadGasInicial"),z.p(r,b)},m(C,D){x(C,e,D),o(e,t),o(t,r),r.checked=~(i[4]||[]).indexOf(r.__value),i[22](r),o(t,n),o(t,l),o(e,d),o(e,h),o(h,g),x(C,_,D),x(C,u,D),o(u,p),o(p,b),b.checked=~(i[4]||[]).indexOf(b.__value),i[25](b),o(p,O),o(p,w),o(u,A),o(u,q),o(q,F),S||(E=[ce(r,"change",i[20]),ce(h,"click",i[23]),ce(b,"change",i[24]),ce(q,"click",i[26])],S=!0)},p(C,D){D[0]&16&&(r.checked=~(C[4]||[]).indexOf(r.__value)),D[0]&4&&k!==(k=C[2]?C[2]+" km.":"Cargar km")&&Le(g,k),D[0]&16&&(b.checked=~(C[4]||[]).indexOf(b.__value)),D[0]&8&&V!==(V=C[3]?C[3]+" litros":"Cargar gas")&&Le(F,V)},d(C){C&&(a(e),a(_),a(u)),i[22](null),i[25](null),z.r(),S=!1,Be(E)}}}function Gn(i){let e=[],t=new Map,r,n=He(i[13]);const l=f=>f[55].id_checklist_event;for(let f=0;f<n.length;f+=1){let d=gt(i,n,f),h=l(d);t.set(h,e[f]=bt(h,d))}return{c(){for(let f=0;f<e.length;f+=1)e[f].c();r=De()},l(f){for(let d=0;d<e.length;d+=1)e[d].l(f);r=De()},m(f,d){for(let h=0;h<e.length;h+=1)e[h]&&e[h].m(f,d);x(f,r,d)},p(f,d){d[0]&407664&&(n=He(f[13]),e=xe(e,d,l,1,f,n,t,r.parentNode,$e,bt,r,gt))},d(f){f&&a(r);for(let d=0;d<e.length;d+=1)e[d].d(f)}}}function Kn(i){let e,t=(i[12][i[55].id_checklist_event]?i[12][i[55].id_checklist_event]:"Cargar evidencia")+"",r;return{c(){e=s("label"),r=Ee(t),this.h()},l(n){e=c(n,"LABEL",{for:!0,class:!0});var l=m(e);r=Ie(l,t),l.forEach(a),this.h()},h(){$(e,"for","chklist-"+i[55].id_checklist_event),$(e,"class","button-label svelte-1ruehls")},m(n,l){x(n,e,l),o(e,r)},p(n,l){l[0]&4096&&t!==(t=(n[12][n[55].id_checklist_event]?n[12][n[55].id_checklist_event]:"Cargar evidencia")+"")&&Le(r,t)},d(n){n&&a(e)}}}function Xn(i){let e;return{c(){e=s("ion-spinner"),this.h()},l(t){e=c(t,"ION-SPINNER",{name:!0,class:!0}),m(e).forEach(a),this.h()},h(){v(e,"name","dots"),v(e,"class","button-spinner svelte-1ruehls")},m(t,r){x(t,e,r)},p:ze,d(t){t&&a(e)}}}function bt(i,e){let t,r,n,l=e[55],f,d,h=e[55].item+"",k,g,_,u=e[55].mandatory=="1"?" * ":"",p,b,O,w,R,A,q,V,F,z;const S=()=>e[34](n,l),E=()=>e[34](null,l);function C(){return e[35](e[55])}function D(X,ee){return X[11][X[55].id_checklist_event]?Xn:Kn}let H=D(e),P=H(e);function Q(...X){return e[37](e[55],...X)}return V=dt(e[21][0]),{key:i,first:null,c(){t=s("ion-item"),r=s("ion-label"),n=s("input"),f=N(),d=s("p"),k=Ee(h),g=N(),_=s("b"),p=Ee(u),b=N(),O=s("ion-button"),w=s("div"),P.c(),R=N(),A=s("input"),q=N(),this.h()},l(X){t=c(X,"ION-ITEM",{});var ee=m(t);r=c(ee,"ION-LABEL",{style:!0});var ne=m(r);n=c(ne,"INPUT",{id:!0,style:!0,type:!0}),f=T(ne),d=c(ne,"P",{style:!0});var ie=m(d);k=Ie(ie,h),g=T(ie),ie.forEach(a),_=c(ne,"B",{style:!0});var ve=m(_);p=Ie(ve,u),ve.forEach(a),ne.forEach(a),b=T(ee),O=c(ee,"ION-BUTTON",{fill:!0,class:!0,size:!0});var ue=m(O);w=c(ue,"DIV",{class:!0});var _e=m(w);P.l(_e),R=T(_e),A=c(_e,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0}),_e.forEach(a),ue.forEach(a),q=T(ee),ee.forEach(a),this.h()},h(){$(n,"id",`chkbox-${e[55].id_checklist_event}`),L(n,"pointer-events","auto"),$(n,"type","checkbox"),n.__value=e[55].id_checklist_event,nn(n,n.__value),n.required=!0,L(d,"margin-left","10px"),L(_,"margin-left","5px"),L(r,"display","flex"),L(A,"display","none"),$(A,"id","chklist-"+e[55].id_checklist_event),$(A,"name","fileToUpload"),$(A,"type","file"),$(A,"accept","image/*"),$(w,"class","button-content svelte-1ruehls"),v(O,"fill","outline"),v(O,"class","loadEvidence svelte-1ruehls"),v(O,"size","small"),V.p(n),this.first=t},m(X,ee){x(X,t,ee),o(t,r),o(r,n),n.checked=~(e[4]||[]).indexOf(n.__value),S(),o(r,f),o(r,d),o(d,k),o(d,g),o(r,_),o(_,p),o(t,b),o(t,O),o(O,w),P.m(w,null),o(w,R),o(w,A),e[36](A),o(t,q),F||(z=[ce(n,"change",e[33]),ce(n,"change",C),ce(A,"change",Q)],F=!0)},p(X,ee){e=X,ee[0]&16&&(n.checked=~(e[4]||[]).indexOf(n.__value)),l!==e[55]&&(E(),l=e[55],S()),H===(H=D(e))&&P?P.p(e,ee):(P.d(1),P=H(e),P&&(P.c(),P.m(w,R)))},d(X){X&&a(t),E(),P.d(),e[36](null),V.r(),F=!1,Be(z)}}}function Wn(i){let e,t,r,n,l="Cancelar",f,d,h="REQUERIMIENTOS DE RUTA",k,g,_,u,p,b,O,w="Confirmar",R,A;function q(S,E){return S[14]?jn:qn}let F=q(i)(i),z=i[13]&&Gn(i);return{c(){e=s("ion-header"),t=s("ion-toolbar"),r=s("ion-buttons"),n=s("ion-button"),n.textContent=l,f=N(),d=s("ion-title"),d.textContent=h,k=N(),g=s("ion-content"),_=s("ion-list"),F.c(),u=N(),z&&z.c(),p=N(),b=s("ion-footer"),O=s("ion-button"),O.textContent=w,this.h()},l(S){e=c(S,"ION-HEADER",{translucent:!0});var E=m(e);t=c(E,"ION-TOOLBAR",{});var C=m(t);r=c(C,"ION-BUTTONS",{slot:!0});var D=m(r);n=c(D,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),oe(n)!=="svelte-1dnmkxs"&&(n.textContent=l),D.forEach(a),f=T(C),d=c(C,"ION-TITLE",{"data-svelte-h":!0}),oe(d)!=="svelte-19bar5p"&&(d.textContent=h),C.forEach(a),E.forEach(a),k=T(S),g=c(S,"ION-CONTENT",{fullscreen:!0});var H=m(g);_=c(H,"ION-LIST",{});var P=m(_);F.l(P),u=T(P),z&&z.l(P),P.forEach(a),H.forEach(a),p=T(S),b=c(S,"ION-FOOTER",{});var Q=m(b);O=c(Q,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),oe(O)!=="svelte-g82qqw"&&(O.textContent=w),Q.forEach(a),this.h()},h(){v(n,"color","medium"),v(r,"slot","start"),v(e,"translucent",""),v(g,"fullscreen",""),v(O,"fill","outline"),v(O,"color","tertiary"),v(O,"strong",""),L(O,"width","99%"),L(O,"height","auto")},m(S,E){x(S,e,E),o(e,t),o(t,r),o(r,n),o(t,f),o(t,d),x(S,k,E),x(S,g,E),o(g,_),F.m(_,null),o(_,u),z&&z.m(_,null),x(S,p,E),x(S,b,E),o(b,O),R||(A=[ce(n,"click",i[15]),ce(O,"click",i[16])],R=!0)},p(S,E){F.p(S,E),S[13]&&z.p(S,E)},i:ze,o:ze,d(S){S&&(a(e),a(k),a(g),a(p),a(b)),F.d(),z&&z.d(),R=!1,Be(A)}}}function ct(i,e){if(typeof i=="object"&&i!==null||Array.isArray(i)){if(Array.isArray(i))return i.map(t=>ct(t,e)).flat();{const t=Object.keys(i);let r;return e=="id_checklist_event"?r=t.filter(l=>l.toLowerCase().includes("id_checklist_event")).map(l=>i[l]):e=="mandatory"?r=t.filter(l=>l.toLowerCase().includes("mandatory")).map(l=>i[l]):(console.error("Tipo de dato no reconocido."),r=!1),r}}else return console.error("Invalid input. Please provide a valid object or array."),[]}function Jn(i,e,t){let r=it,n=document.querySelector("ion-modal");const l=n.componentProps.checklist,f=n.componentProps.driverId,d=n.componentProps.routeId,h=n.componentProps.isLast;let k,g,_,u,p=[],b=null,O={},w,R,A,q,V={},F=new Object,z={},S={};Ze(()=>{F=JSON.parse(localStorage.getItem("userSession")),h?console.log("Último checklist"):rt.update(I=>(I.mandatory=ct(l,"mandatory"),I.items=ct(l,"id_checklist_event"),I))});function E(I){t(11,V[I]=!0,V)}const C=async()=>{await(await je.create({header:"Datos o checklist incompletos",message:"Carga la evidencia requerida y marca todas las casillas para confirmar",buttons:[{text:"Cerrar"}]})).present()},D=async()=>{await(await je.create({header:"Datos capturados",message:"El kilometraje y gasolina final fueron registrados correctamente, espere aprobación para finalizar ruta",buttons:[{text:"Cerrar"}]})).present()},H=async I=>{await(await je.create({header:"Datos inválidos",message:I=="km"?"Llena correctamente el campo de kilometraje inicial":"Llena correctamente el campo de gasolina inicial",buttons:[{text:"Cerrar"}]})).present()},P=()=>{et.dismiss(),f?qe(`/drivers/${f}`):qe("/drivers/me")},Q=()=>{if(h){var I=ve(_,"km"),y=ve(u,"gas");let se=new FormData;se.append("km_final",I),se.append("gas_final",y),se.append("id_route",d),se=me(se),I&&y?(P(),fetch(`${r}api/admin/checklist/add_evidence.php`,{method:"POST",body:se}).then(ge=>ge.json()).then(ge=>{D()}).catch(ge=>{console.error("Error fetching data:",ge)})):C()}else{var j=ve(k,"km"),te=ve(g,"gas");rt.update(se=>{se.items;const ge=se.mandatory;if(se.items.filter((re,pe)=>se.mandatory[pe]==="1").every(re=>se.checkedIndices.includes(re))&&j&&te){P();let re=new FormData;re=me(re),re.append("km_inicial",j),re.append("gas_inicial",te),re.append("id_route",d);for(const pe in z)if(z.hasOwnProperty(pe)){const{img:Ae,img_id:Ve}=z[pe];re.append(`selectedImages[${pe}][img]`,Ae),re.append(`selectedImages[${pe}][img_id]`,Ve)}fetch(`${r}api/admin/checklist/add_evidence.php`,{method:"POST",body:re}).then(pe=>pe.json()).then(pe=>{ge&&ge.some(Ae=>Ae==="1")?ie(d,"checklist-pending"):ie(d,"enroute")}).catch(pe=>{console.error("Error fetching data:",pe)})}else if(!ge&&j&&te){let re=new FormData;re.append("km_inicial",j),re.append("gas_inicial",te),re=me(re),fetch(`${r}api/admin/checklist/add_evidence.php`,{method:"POST",body:re}).then(pe=>pe.json()).then(pe=>{ie(d,"enroute")}).catch(pe=>{console.error("Error fetching data:",pe)})}else C();return se})}fe()},X=async(I,y)=>{E(y);const te=I.target.files[0],se=await ee(te);if(se){let ge=new FormData;ge.append("fileToUpload",se),ge=me(ge);try{const ye=await fetch(`${r}api/admin/manager/upload_img_driver.php`,{method:"POST",body:ge});if(ye.ok){const le=await ye.json();z={...z,[y]:{img:le.img,img_id:le.img_id}},t(12,S={...S,[y]:le.filename}),ne(y),t(6,O[y].checked=!0,O),t(11,V[y]=!1,V)}else console.error("File upload failed:",ye.statusText)}catch(ye){console.error("Error during file upload:",ye)}}},ee=async I=>new Promise(y=>{const j=new FileReader;j.onload=te=>{const se=new Image;se.src=te.target.result,se.onload=()=>{const ge=document.createElement("canvas"),ye=ge.getContext("2d"),le=800,re=600;let pe=se.width,Ae=se.height;pe>le&&(Ae*=le/pe,pe=le),Ae>re&&(pe*=re/Ae,Ae=re),ge.width=pe,ge.height=Ae,ye.drawImage(se,0,0,pe,Ae),ge.toBlob(Ve=>{y(Ve)},"image/jpeg",.7)}},j.readAsDataURL(I)}),ne=I=>{rt.update(y=>(y.checkedIndices.indexOf(I)===-1?y.checkedIndices.push(I):console.error(`ID ${I} is already checked.`),y.items.forEach(te=>{te.id_checklist_event===I&&(te.checked=!0)}),y))};function ie(I,y){let j=new FormData;j.append("id_route",I),j.append("status",y),j=me(j),fetch(`${r}api/admin/route/change_status.php`,{method:"POST",body:j}).then(te=>te.json()).then(te=>{}).catch(te=>{console.error("Error fetching data:",te)})}function ve(I,y){return/^\d+$/.test(I)?parseInt(I,10):(H(y),null)}function ue(I,y){_e(y),n.componentProps.data_type=y,Ue("modal-gas-km",Fn,{r:y}).then(()=>{Ge.subscribe(j=>{be(j,y)})})}function _e(I){$t.update(y=>({...y,flag:[I]}))}function be(I,y){t(0,k=I.km_inicial?I.km_inicial:null),t(1,g=I.gas_inicial?I.gas_inicial:null),t(2,_=I.km_final?I.km_final:null),t(3,u=I.gas_final?I.gas_final:null),y=="km_inicial"&&w&&t(7,w.checked=!0,w),y=="gas_inicial"&&R&&t(8,R.checked=!0,R),y=="km_final"&&A&&t(9,A.checked=!0,A),y=="gas_final"&&q&&t(10,q.checked=!0,q)}function fe(){Ge.set({km_inicial:[],gas_inicial:[],km_final:[],gas_final:[]})}function me(I){return I.append("token",F.token),I.append("id_user_over",F.id_user),I}const ke=[[]];function Oe(){p=Qe(ke[0],this.__value,this.checked),t(4,p)}function we(I){Se[I?"unshift":"push"](()=>{A=I,t(9,A)})}const Te=I=>ue(I,"km_final");function he(){p=Qe(ke[0],this.__value,this.checked),t(4,p)}function Ne(I){Se[I?"unshift":"push"](()=>{q=I,t(10,q)})}const Ce=I=>ue(I,"gas_final");function U(){p=Qe(ke[0],this.__value,this.checked),t(4,p)}function W(I){Se[I?"unshift":"push"](()=>{w=I,t(7,w)})}const M=I=>ue(I,"km_inicial");function G(I){Se[I?"unshift":"push"](()=>{R=I,t(8,R)})}function K(){p=Qe(ke[0],this.__value,this.checked),t(4,p)}const B=I=>ue(I,"gas_inicial");function Y(){p=Qe(ke[0],this.__value,this.checked),t(4,p)}function ae(I,y){Se[I?"unshift":"push"](()=>{O[y.id_checklist_event]=I,t(6,O)})}const de=I=>ne(I.id_checklist_event);function J(I){Se[I?"unshift":"push"](()=>{b=I,t(5,b)})}return[k,g,_,u,p,b,O,w,R,A,q,V,S,l,h,P,Q,X,ne,ue,Oe,ke,we,Te,he,Ne,Ce,U,W,M,G,K,B,Y,ae,de,J,(I,y)=>X(y,I.id_checklist_event)]}class en extends Je{constructor(e){super(),Ye(this,e,Jn,Wn,We,{},null,[-1,-1])}}function Et(i,e,t){const r=i.slice();return r[55]=e[t],r[57]=t,r}function Yn(i){let e,t,r="Confirmar",n,l;return{c(){e=s("ion-buttons"),t=s("ion-button"),t.textContent=r,this.h()},l(f){e=c(f,"ION-BUTTONS",{slot:!0});var d=m(e);t=c(d,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),oe(t)!=="svelte-1ida0il"&&(t.textContent=r),d.forEach(a),this.h()},h(){v(t,"strong",""),v(e,"slot","end")},m(f,d){x(f,e,d),o(e,t),n||(l=ce(t,"click",i[22]),n=!0)},p:ze,d(f){f&&a(e),n=!1,l()}}}function Qn(i){let e,t,r,n,l,f="Teléfono de Negocio",d,h,k=i[14].client_phone+"",g;return{c(){e=s("ion-item"),t=s("ion-icon"),r=N(),n=s("ion-label"),l=s("p"),l.textContent=f,d=N(),h=s("h2"),g=Ee(k),this.h()},l(_){e=c(_,"ION-ITEM",{href:!0});var u=m(e);t=c(u,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),r=T(u),n=c(u,"ION-LABEL",{class:!0});var p=m(n);l=c(p,"P",{"data-svelte-h":!0}),oe(l)!=="svelte-1u5l7fz"&&(l.textContent=f),d=T(p),h=c(p,"H2",{});var b=m(h);g=Ie(b,k),b.forEach(a),p.forEach(a),u.forEach(a),this.h()},h(){v(t,"icon",vn),v(t,"slot","start"),v(n,"class","ion-text-wrap"),v(e,"href","tel:"+i[14].client_phone)},m(_,u){x(_,e,u),o(e,t),o(e,r),o(e,n),o(n,l),o(n,d),o(n,h),o(h,g)},p:ze,d(_){_&&a(e)}}}function Zn(i){let e,t,r,n,l,f="Domicilio Alternativo",d,h,k=i[14].line2+"",g,_,u;return{c(){e=s("ion-item"),t=s("ion-icon"),r=N(),n=s("ion-label"),l=s("p"),l.textContent=f,d=N(),h=s("h2"),g=Ee(k),_=N(),u=s("ion-icon"),this.h()},l(p){e=c(p,"ION-ITEM",{href:!0});var b=m(e);t=c(b,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),r=T(b),n=c(b,"ION-LABEL",{class:!0});var O=m(n);l=c(O,"P",{"data-svelte-h":!0}),oe(l)!=="svelte-1ub9uzw"&&(l.textContent=f),d=T(O),h=c(O,"H2",{});var w=m(h);g=Ie(w,k),w.forEach(a),O.forEach(a),_=T(b),u=c(b,"ION-ICON",{icon:!0,slot:!0}),m(u).forEach(a),b.forEach(a),this.h()},h(){v(t,"icon",_t),v(t,"slot","start"),v(n,"class","ion-text-wrap"),v(u,"icon",Re),v(u,"slot","end"),v(e,"href","https://www.google.com/maps/searhc/?api=1&query="+i[14].line2)},m(p,b){x(p,e,b),o(e,t),o(e,r),o(e,n),o(n,l),o(n,d),o(n,h),o(h,g),o(e,_),o(e,u)},p:ze,d(p){p&&a(e)}}}function xn(i){let e,t,r,n,l,f="Domicilio",d,h,k=i[14].line1+"",g,_,u,p,b=i[14].line2&&i[14].line2.trim().length,O,w=b&&$n(i);return{c(){e=s("ion-item"),t=s("ion-icon"),r=N(),n=s("ion-label"),l=s("p"),l.textContent=f,d=N(),h=s("h2"),g=Ee(k),_=N(),u=s("ion-icon"),p=N(),w&&w.c(),O=De(),this.h()},l(R){e=c(R,"ION-ITEM",{href:!0});var A=m(e);t=c(A,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),r=T(A),n=c(A,"ION-LABEL",{class:!0});var q=m(n);l=c(q,"P",{"data-svelte-h":!0}),oe(l)!=="svelte-cbm7q1"&&(l.textContent=f),d=T(q),h=c(q,"H2",{});var V=m(h);g=Ie(V,k),V.forEach(a),q.forEach(a),_=T(A),u=c(A,"ION-ICON",{icon:!0,slot:!0}),m(u).forEach(a),A.forEach(a),p=T(R),w&&w.l(R),O=De(),this.h()},h(){v(t,"icon",_t),v(t,"slot","start"),v(n,"class","ion-text-wrap"),v(u,"icon",Re),v(u,"slot","end"),v(e,"href","https://www.google.com/maps/search/?api=1&query="+i[14].line1)},m(R,A){x(R,e,A),o(e,t),o(e,r),o(e,n),o(n,l),o(n,d),o(n,h),o(h,g),o(e,_),o(e,u),x(R,p,A),w&&w.m(R,A),x(R,O,A)},p(R,A){b&&w.p(R,A)},d(R){R&&(a(e),a(p),a(O)),w&&w.d(R)}}}function $n(i){let e,t,r,n,l,f="Domicilio Alternativo",d,h,k=i[14].line2+"",g,_,u;return{c(){e=s("ion-item"),t=s("ion-icon"),r=N(),n=s("ion-label"),l=s("p"),l.textContent=f,d=N(),h=s("h2"),g=Ee(k),_=N(),u=s("ion-icon"),this.h()},l(p){e=c(p,"ION-ITEM",{href:!0});var b=m(e);t=c(b,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),r=T(b),n=c(b,"ION-LABEL",{class:!0});var O=m(n);l=c(O,"P",{"data-svelte-h":!0}),oe(l)!=="svelte-1ub9uzw"&&(l.textContent=f),d=T(O),h=c(O,"H2",{});var w=m(h);g=Ie(w,k),w.forEach(a),O.forEach(a),_=T(b),u=c(b,"ION-ICON",{icon:!0,slot:!0}),m(u).forEach(a),b.forEach(a),this.h()},h(){v(t,"icon",_t),v(t,"slot","start"),v(n,"class","ion-text-wrap"),v(u,"icon",Re),v(u,"slot","end"),v(e,"href","https://www.google.com/maps/search/?api=1&query="+i[14].line2)},m(p,b){x(p,e,b),o(e,t),o(e,r),o(e,n),o(n,l),o(n,d),o(n,h),o(h,g),o(e,_),o(e,u)},p:ze,d(p){p&&a(e)}}}function It(i){let e,t,r,n,l,f="Contacto del Cliente",d,h,k,g,_=i[3]&&i[3]==="1"&&kt(i);return{c(){e=s("ion-item"),t=s("ion-icon"),r=N(),n=s("ion-label"),l=s("p"),l.textContent=f,d=N(),h=s("h2"),k=Ee(i[7]),g=N(),_&&_.c(),this.h()},l(u){e=c(u,"ION-ITEM",{});var p=m(e);t=c(p,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),r=T(p),n=c(p,"ION-LABEL",{class:!0});var b=m(n);l=c(b,"P",{"data-svelte-h":!0}),oe(l)!=="svelte-1utsyb6"&&(l.textContent=f),d=T(b),h=c(b,"H2",{});var O=m(h);k=Ie(O,i[7]),O.forEach(a),b.forEach(a),g=T(p),_&&_.l(p),p.forEach(a),this.h()},h(){v(t,"icon",gn),v(t,"slot","start"),v(n,"class","ion-text-wrap")},m(u,p){x(u,e,p),o(e,t),o(e,r),o(e,n),o(n,l),o(n,d),o(n,h),o(h,k),o(e,g),_&&_.m(e,null)},p(u,p){p[0]&128&&Le(k,u[7]),u[3]&&u[3]==="1"?_?_.p(u,p):(_=kt(u),_.c(),_.m(e,null)):_&&(_.d(1),_=null)},d(u){u&&a(e),_&&_.d()}}}function kt(i){let e,t=`<ion-icon icon="${On}" slot="start"></ion-icon>
                        Notificar Cliente`,r,n;return{c(){e=s("ion-button"),e.innerHTML=t,this.h()},l(l){e=c(l,"ION-BUTTON",{fill:!0,style:!0,"data-svelte-h":!0}),oe(e)!=="svelte-w3qtwm"&&(e.innerHTML=t),this.h()},h(){v(e,"fill","outline"),L(e,"margin-left","16px")},m(l,f){x(l,e,f),r||(n=ce(e,"click",i[23]),r=!0)},p:ze,d(l){l&&a(e),r=!1,n()}}}function Ot(i){let e,t,r,n,l,f="Notas de ubicación",d,h,k;return{c(){e=s("ion-item"),t=s("ion-icon"),r=N(),n=s("ion-label"),l=s("p"),l.textContent=f,d=N(),h=s("h2"),k=Ee(i[8]),this.h()},l(g){e=c(g,"ION-ITEM",{});var _=m(e);t=c(_,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),r=T(_),n=c(_,"ION-LABEL",{class:!0});var u=m(n);l=c(u,"P",{"data-svelte-h":!0}),oe(l)!=="svelte-nhm2ft"&&(l.textContent=f),d=T(u),h=c(u,"H2",{});var p=m(h);k=Ie(p,i[8]),p.forEach(a),u.forEach(a),_.forEach(a),this.h()},h(){v(t,"icon",Qt),v(t,"slot","start"),v(n,"class","ion-text-wrap")},m(g,_){x(g,e,_),o(e,t),o(e,r),o(e,n),o(n,l),o(n,d),o(n,h),o(h,k)},p(g,_){_[0]&256&&Le(k,g[8])},d(g){g&&a(e)}}}function eo(i){let e,t,r,n,l,f="Horarios",d,h,k=i[14].schedule+"",g;return{c(){e=s("ion-item"),t=s("ion-icon"),r=N(),n=s("ion-label"),l=s("p"),l.textContent=f,d=N(),h=s("h2"),g=Ee(k),this.h()},l(_){e=c(_,"ION-ITEM",{});var u=m(e);t=c(u,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),r=T(u),n=c(u,"ION-LABEL",{});var p=m(n);l=c(p,"P",{"data-svelte-h":!0}),oe(l)!=="svelte-11q7hm5"&&(l.textContent=f),d=T(p),h=c(p,"H2",{});var b=m(h);g=Ie(b,k),b.forEach(a),p.forEach(a),u.forEach(a),this.h()},h(){v(t,"icon",bn),v(t,"slot","start")},m(_,u){x(_,e,u),o(e,t),o(e,r),o(e,n),o(n,l),o(n,d),o(n,h),o(h,g)},p:ze,d(_){_&&a(e)}}}function to(i){let e,t,r,n,l,f="Notas del operador",d,h,k=i[14].driver_comments+"",g;return{c(){e=s("ion-item"),t=s("ion-icon"),r=N(),n=s("ion-label"),l=s("p"),l.textContent=f,d=N(),h=s("h2"),g=Ee(k),this.h()},l(_){e=c(_,"ION-ITEM",{});var u=m(e);t=c(u,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),r=T(u),n=c(u,"ION-LABEL",{});var p=m(n);l=c(p,"P",{"data-svelte-h":!0}),oe(l)!=="svelte-1yk9qp4"&&(l.textContent=f),d=T(p),h=c(p,"H2",{});var b=m(h);g=Ie(b,k),b.forEach(a),p.forEach(a),u.forEach(a),this.h()},h(){v(t,"icon",Zt),v(t,"slot","start")},m(_,u){x(_,e,u),o(e,t),o(e,r),o(e,n),o(n,l),o(n,d),o(n,h),o(h,g)},p:ze,d(_){_&&a(e)}}}function no(i){let e,t=i[14].logistic_comments!="<br>"&&oo(i);return{c(){t&&t.c(),e=De()},l(r){t&&t.l(r),e=De()},m(r,n){t&&t.m(r,n),x(r,e,n)},p(r,n){r[14].logistic_comments!="<br>"&&t.p(r,n)},d(r){r&&a(e),t&&t.d(r)}}}function oo(i){let e,t,r,n,l,f="Comentarios logísticos",d,h,k=i[14].logistic_comments+"",g;return{c(){e=s("ion-item"),t=s("ion-icon"),r=N(),n=s("ion-label"),l=s("p"),l.textContent=f,d=N(),h=s("h2"),g=Ee(k),this.h()},l(_){e=c(_,"ION-ITEM",{});var u=m(e);t=c(u,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),r=T(u),n=c(u,"ION-LABEL",{class:!0});var p=m(n);l=c(p,"P",{"data-svelte-h":!0}),oe(l)!=="svelte-1iz85r6"&&(l.textContent=f),d=T(p),h=c(p,"H2",{});var b=m(h);g=Ie(b,k),b.forEach(a),p.forEach(a),u.forEach(a),this.h()},h(){v(t,"icon",Qt),v(t,"slot","start"),v(n,"class","ion-text-wrap")},m(_,u){x(_,e,u),o(e,t),o(e,r),o(e,n),o(n,l),o(n,d),o(n,h),o(h,g)},p:ze,d(_){_&&a(e)}}}function Nt(i){let e,t,r,n;return{c(){e=s("ion-item"),t=s("ion-icon"),r=N(),n=s("ion-textarea"),this.h()},l(l){e=c(l,"ION-ITEM",{});var f=m(e);t=c(f,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),r=T(f),n=c(f,"ION-TEXTAREA",{placeholder:!0}),m(n).forEach(a),f.forEach(a),this.h()},h(){v(t,"icon",En),v(t,"slot","start"),v(n,"placeholder","Escribe el motivo...")},m(l,f){x(l,e,f),o(e,t),o(e,r),o(e,n),i[29](n)},p:ze,d(l){l&&a(e),i[29](null)}}}function lo(i){let e,t,r,n,l,f="Estado de entrega",d,h,k="Entregado",g,_,u="No Entregado",p,b,O="Entrega Parcial",w,R,A,q,V,F,z,S,E=i[5]===!0&&Tt(i),C=(i[6]===!0||i[6]===!1&&i[5]===!1)&&Ct(i);return{c(){e=s("ion-item"),t=s("ion-icon"),r=N(),n=s("ion-select"),l=s("div"),l.textContent=f,d=N(),h=s("ion-select-option"),h.textContent=k,g=N(),_=s("ion-select-option"),_.textContent=u,p=N(),b=s("ion-select-option"),b.textContent=O,w=N(),R=s("ion-item"),A=s("ion-icon"),q=N(),V=s("ion-textarea"),F=N(),z=s("section"),E&&E.c(),S=N(),C&&C.c(),this.h()},l(D){e=c(D,"ION-ITEM",{});var H=m(e);t=c(H,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),r=T(H),n=c(H,"ION-SELECT",{value:!0});var P=m(n);l=c(P,"DIV",{slot:!0,"data-svelte-h":!0}),oe(l)!=="svelte-1635zca"&&(l.textContent=f),d=T(P),h=c(P,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),oe(h)!=="svelte-s33eln"&&(h.textContent=k),g=T(P),_=c(P,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),oe(_)!=="svelte-1a859l3"&&(_.textContent=u),p=T(P),b=c(P,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),oe(b)!=="svelte-1c4dcm8"&&(b.textContent=O),P.forEach(a),H.forEach(a),w=T(D),R=c(D,"ION-ITEM",{});var Q=m(R);A=c(Q,"ION-ICON",{icon:!0,slot:!0}),m(A).forEach(a),q=T(Q),V=c(Q,"ION-TEXTAREA",{label:!0,placeholder:!0}),m(V).forEach(a),Q.forEach(a),F=T(D),z=c(D,"SECTION",{style:!0});var X=m(z);E&&E.l(X),S=T(X),C&&C.l(X),X.forEach(a),this.h()},h(){v(t,"icon",In),v(t,"slot","start"),$(l,"slot","label"),v(h,"value","delivered"),v(_,"value","notdelivered"),v(b,"value","partialdeliver"),v(n,"value",i[17]?i[17]:"delivered"),v(A,"icon",st),v(A,"slot","start"),v(V,"label","Notas"),v(V,"placeholder","Escribe aquí..."),L(z,"display","flex"),L(z,"gap","8px"),L(z,"padding","16px 16px 6px")},m(D,H){x(D,e,H),o(e,t),o(e,r),o(e,n),o(n,l),o(n,d),o(n,h),o(n,g),o(n,_),o(n,p),o(n,b),i[30](n),x(D,w,H),x(D,R,H),o(R,A),o(R,q),o(R,V),i[31](V),x(D,F,H),x(D,z,H),E&&E.m(z,null),o(z,S),C&&C.m(z,null)},p(D,H){D[5]===!0?E?E.p(D,H):(E=Tt(D),E.c(),E.m(z,S)):E&&(E.d(1),E=null),D[6]===!0||D[6]===!1&&D[5]===!1?C?C.p(D,H):(C=Ct(D),C.c(),C.m(z,null)):C&&(C.d(1),C=null)},d(D){D&&(a(e),a(w),a(R),a(F),a(z)),i[30](null),i[31](null),E&&E.d(),C&&C.d()}}}function Tt(i){let e,t=`<ion-icon icon="${Nn}" slot="start"></ion-icon>
                        Ingreso`,r,n;return{c(){e=s("ion-button"),e.innerHTML=t,this.h()},l(l){e=c(l,"ION-BUTTON",{id:!0,style:!0,"data-svelte-h":!0}),oe(e)!=="svelte-3onvnr"&&(e.innerHTML=t),this.h()},h(){v(e,"id","checkInBtn"),L(e,"flex","1")},m(l,f){x(l,e,f),r||(n=ce(e,"click",i[24]),r=!0)},p:ze,d(l){l&&a(e),r=!1,n()}}}function Ct(i){let e,t,r,n,l,f;return{c(){e=s("ion-button"),t=s("ion-icon"),r=Ee(`
                        Salida`),this.h()},l(d){e=c(d,"ION-BUTTON",{id:!0,style:!0,disabled:!0});var h=m(e);t=c(h,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),r=Ie(h,`
                        Salida`),h.forEach(a),this.h()},h(){v(t,"icon",kn),v(t,"slot","start"),v(e,"id","checkOutBtn"),L(e,"flex","1"),v(e,"disabled",n=i[6]===!1)},m(d,h){x(d,e,h),o(e,t),o(e,r),l||(f=ce(e,"click",i[25]),l=!0)},p(d,h){h[0]&64&&n!==(n=d[6]===!1)&&v(e,"disabled",n)},d(d){d&&a(e),l=!1,f()}}}function io(i){let e,t,r,n,l,f="Subir Evidencia",d,h,k,g;return{c(){e=s("section"),t=s("ion-button"),r=s("ion-icon"),n=N(),l=s("label"),l.textContent=f,d=N(),h=s("input"),this.h()},l(_){e=c(_,"SECTION",{style:!0});var u=m(e);t=c(u,"ION-BUTTON",{fill:!0,class:!0,style:!0});var p=m(t);r=c(p,"ION-ICON",{icon:!0,slot:!0}),m(r).forEach(a),n=T(p),l=c(p,"LABEL",{for:!0,"data-svelte-h":!0}),oe(l)!=="svelte-1wg51s6"&&(l.textContent=f),d=T(p),h=c(p,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0}),p.forEach(a),u.forEach(a),this.h()},h(){v(r,"icon",xt),v(r,"slot","start"),$(l,"for","eventEvidence"),L(h,"display","none"),$(h,"id","eventEvidence"),$(h,"name","fileToUpload"),$(h,"type","file"),h.multiple=!0,$(h,"accept","image/*"),v(t,"fill","outline"),v(t,"class","loadEvidence"),L(t,"flex","1"),L(e,"display","flex"),L(e,"gap","8px"),L(e,"padding","0px 16px")},m(_,u){x(_,e,u),o(e,t),o(t,r),o(t,n),o(t,l),o(t,d),o(t,h),k||(g=[ce(h,"change",i[18]),ce(h,"click",i[19])],k=!0)},p:ze,d(_){_&&a(e),k=!1,Be(g)}}}function yt(i){let e,t='<ion-spinner name="dots"></ion-spinner>';return{c(){e=s("section"),e.innerHTML=t,this.h()},l(r){e=c(r,"SECTION",{style:!0,"data-svelte-h":!0}),oe(e)!=="svelte-1sj3e0"&&(e.innerHTML=t),this.h()},h(){L(e,"text-align","center")},m(r,n){x(r,e,n)},d(r){r&&a(e)}}}function wt(i){let e,t,r=He(i[2]),n=[];for(let l=0;l<r.length;l+=1)n[l]=Lt(Et(i,r,l));return{c(){e=s("section"),t=s("div");for(let l=0;l<n.length;l+=1)n[l].c();this.h()},l(l){e=c(l,"SECTION",{});var f=m(e);t=c(f,"DIV",{class:!0,style:!0});var d=m(t);for(let h=0;h<n.length;h+=1)n[h].l(d);d.forEach(a),f.forEach(a),this.h()},h(){$(t,"class","image-grid"),L(t,"display","grid"),L(t,"grid-template-columns","repeat(auto-fill, minmax(100px, 1fr))"),L(t,"gap","10px"),L(t,"padding","0px 10px")},m(l,f){x(l,e,f),o(e,t);for(let d=0;d<n.length;d+=1)n[d]&&n[d].m(t,null)},p(l,f){if(f[0]&69206020){r=He(l[2]);let d;for(d=0;d<r.length;d+=1){const h=Et(l,r,d);n[d]?n[d].p(h,f):(n[d]=Lt(h),n[d].c(),n[d].m(t,null))}for(;d<n.length;d+=1)n[d].d(1);n.length=r.length}},d(l){l&&a(e),on(n,l)}}}function Lt(i){let e,t,r,n,l,f=`<ion-icon icon="${Tn}"></ion-icon>`,d,h,k;function g(){return i[32](i[55])}function _(){return i[33](i[57])}return{c(){e=s("div"),t=s("ion-img"),n=N(),l=s("button"),l.innerHTML=f,d=N(),this.h()},l(u){e=c(u,"DIV",{class:!0,style:!0});var p=m(e);t=c(p,"ION-IMG",{src:!0,alt:!0,style:!0}),m(t).forEach(a),n=T(p),l=c(p,"BUTTON",{class:!0,style:!0,"data-svelte-h":!0}),oe(l)!=="svelte-zguiov"&&(l.innerHTML=f),d=T(p),p.forEach(a),this.h()},h(){Ke(t.src,r=i[55])||v(t,"src",r),v(t,"alt","Evidencia fotográfica"),L(t,"width","100%"),L(t,"height","100px"),L(t,"object-fit","cover"),L(t,"cursor","pointer"),L(t,"border","1px solid #ccc"),L(t,"border-radius","4px"),L(t,"margin-top","16px"),$(l,"class","remove-button"),L(l,"position","absolute"),L(l,"top","5px"),L(l,"right","5px"),L(l,"border","none"),L(l,"cursor","pointer"),L(l,"font-size","18px"),L(l,"background","white"),L(l,"border-radius","50%"),L(l,"padding","3px 4px 0px"),L(l,"box-shadow","2px 2px 6px rgba(0, 0, 0, 0.3)"),L(l,"color","#0000008f"),$(e,"class","image-container"),L(e,"position","relative")},m(u,p){x(u,e,p),o(e,t),o(e,n),o(e,l),o(e,d),h||(k=[ce(t,"click",g),ce(l,"click",_)],h=!0)},p(u,p){i=u,p[0]&4&&!Ke(t.src,r=i[55])&&v(t,"src",r)},d(u){u&&a(e),h=!1,Be(k)}}}function zt(i){let e,t,r,n,l,f,d=`<ion-icon icon="${Cn}"></ion-icon>`,h,k;return{c(){e=s("div"),t=s("div"),r=s("ion-img"),l=N(),f=s("button"),f.innerHTML=d,this.h()},l(g){e=c(g,"DIV",{class:!0,style:!0});var _=m(e);t=c(_,"DIV",{class:!0,style:!0});var u=m(t);r=c(u,"ION-IMG",{src:!0,alt:!0,style:!0}),m(r).forEach(a),l=T(u),f=c(u,"BUTTON",{class:!0,style:!0,"data-svelte-h":!0}),oe(f)!=="svelte-g0qr0o"&&(f.innerHTML=d),u.forEach(a),_.forEach(a),this.h()},h(){Ke(r.src,n=i[12])||v(r,"src",n),v(r,"alt","Evidencia fotográfica"),L(r,"width","100%"),L(r,"height","auto"),$(f,"class","close-button"),L(f,"position","absolute"),L(f,"top","5px"),L(f,"right","5px"),L(f,"background","white"),L(f,"color","#444444d1"),L(f,"border","none"),L(f,"cursor","pointer"),L(f,"padding","2px 2px 0px 6px"),L(f,"border-radius","50%"),L(f,"font-size","20px"),$(t,"class","modal-content"),L(t,"position","relative"),L(t,"background","white"),L(t,"padding","20px"),L(t,"border-radius","8px"),L(t,"max-width","90vw"),L(t,"max-height","90vh"),L(t,"overflow","auto"),$(e,"class","modal-overlay"),L(e,"position","fixed"),L(e,"top","0"),L(e,"left","0"),L(e,"width","100vw"),L(e,"height","100vh"),L(e,"background","rgba(0, 0, 0, 0.8)"),L(e,"display","flex"),L(e,"justify-content","center"),L(e,"align-items","center"),L(e,"z-index","1000")},m(g,_){x(g,e,_),o(e,t),o(t,r),o(t,l),o(t,f),h||(k=[ce(f,"click",i[27]),ce(t,"click",ln(i[28])),ce(e,"click",i[27])],h=!0)},p(g,_){_[0]&4096&&!Ke(r.src,n=g[12])&&v(r,"src",n)},d(g){g&&a(e),h=!1,Be(k)}}}function ro(i){let e,t,r,n,l="Cerrar",f,d,h=i[14].title+"",k,g,_,u,p,b,O,w,R,A,q="Negocio",V,F,z=i[14].client_name+"",S,E,C=i[14].client_phone&&i[14].client_phone.trim().length,D,H,P,Q,X=i[14].schedule&&i[14].schedule.trim().length,ee,ne,ie=i[14].logistic_comments&&i[14].logistic_comments.trim().length,ve,ue,_e,be,fe,me,ke,Oe,we,Te=(!i[15]&&!i[16]||i[15]&&i[16])&&Yn(i),he=C&&Qn(i);function Ne(y,j){if(y[14].line1&&y[14].line1.trim().length)return xn;if(y[14].line2&&y[14].line2.trim().length)return Zn}let Ce=Ne(i),U=Ce&&Ce(i),W=i[7]&&It(i),M=i[8]&&i[8]!=="<br>"&&Ot(i),G=X&&eo(i),K=i[14].driver_comments&&to(i),B=ie&&no(i),Y=i[9]&&Nt(i),ae=!i[16]&&lo(i),de=(i[15]&&i[16]||!i[15]&&!i[16])&&io(i),J=i[4]&&yt(),Z=i[1]&&wt(i),I=i[11]&&zt(i);return{c(){e=s("ion-header"),t=s("ion-toolbar"),r=s("ion-buttons"),n=s("ion-button"),n.textContent=l,f=N(),d=s("ion-title"),k=Ee(h),g=N(),Te&&Te.c(),_=N(),u=s("ion-content"),p=s("ion-list"),b=s("ion-item"),O=s("ion-icon"),w=N(),R=s("ion-label"),A=s("p"),A.textContent=q,V=N(),F=s("h2"),S=Ee(z),E=N(),he&&he.c(),D=N(),U&&U.c(),H=N(),W&&W.c(),P=N(),M&&M.c(),Q=N(),G&&G.c(),ee=N(),K&&K.c(),ne=N(),B&&B.c(),ve=N(),Y&&Y.c(),ue=N(),ae&&ae.c(),_e=N(),de&&de.c(),be=N(),J&&J.c(),fe=N(),Z&&Z.c(),me=N(),I&&I.c(),ke=De(),this.h()},l(y){e=c(y,"ION-HEADER",{translucent:!0});var j=m(e);t=c(j,"ION-TOOLBAR",{});var te=m(t);r=c(te,"ION-BUTTONS",{slot:!0});var se=m(r);n=c(se,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),oe(n)!=="svelte-2ks32x"&&(n.textContent=l),se.forEach(a),f=T(te),d=c(te,"ION-TITLE",{style:!0,title:!0});var ge=m(d);k=Ie(ge,h),ge.forEach(a),g=T(te),Te&&Te.l(te),te.forEach(a),j.forEach(a),_=T(y),u=c(y,"ION-CONTENT",{fullscreen:!0});var ye=m(u);p=c(ye,"ION-LIST",{});var le=m(p);b=c(le,"ION-ITEM",{});var re=m(b);O=c(re,"ION-ICON",{icon:!0,slot:!0}),m(O).forEach(a),w=T(re),R=c(re,"ION-LABEL",{});var pe=m(R);A=c(pe,"P",{"data-svelte-h":!0}),oe(A)!=="svelte-57b1dg"&&(A.textContent=q),V=T(pe),F=c(pe,"H2",{});var Ae=m(F);S=Ie(Ae,z),Ae.forEach(a),pe.forEach(a),re.forEach(a),E=T(le),he&&he.l(le),D=T(le),U&&U.l(le),H=T(le),W&&W.l(le),P=T(le),M&&M.l(le),Q=T(le),G&&G.l(le),ee=T(le),K&&K.l(le),ne=T(le),B&&B.l(le),ve=T(le),Y&&Y.l(le),ue=T(le),ae&&ae.l(le),_e=T(le),de&&de.l(le),be=T(le),J&&J.l(le),fe=T(le),Z&&Z.l(le),le.forEach(a),ye.forEach(a),me=T(y),I&&I.l(y),ke=De(),this.h()},h(){v(n,"color","medium"),v(r,"slot","start"),L(d,"text-align","center"),v(d,"title",i[14].title),v(e,"translucent",""),v(O,"icon",mn),v(O,"slot","start"),v(u,"fullscreen","")},m(y,j){x(y,e,j),o(e,t),o(t,r),o(r,n),o(t,f),o(t,d),o(d,k),o(t,g),Te&&Te.m(t,null),x(y,_,j),x(y,u,j),o(u,p),o(p,b),o(b,O),o(b,w),o(b,R),o(R,A),o(R,V),o(R,F),o(F,S),o(p,E),he&&he.m(p,null),o(p,D),U&&U.m(p,null),o(p,H),W&&W.m(p,null),o(p,P),M&&M.m(p,null),o(p,Q),G&&G.m(p,null),o(p,ee),K&&K.m(p,null),o(p,ne),B&&B.m(p,null),o(p,ve),Y&&Y.m(p,null),o(p,ue),ae&&ae.m(p,null),o(p,_e),de&&de.m(p,null),o(p,be),J&&J.m(p,null),o(p,fe),Z&&Z.m(p,null),x(y,me,j),I&&I.m(y,j),x(y,ke,j),Oe||(we=ce(n,"click",i[20]),Oe=!0)},p(y,j){(!y[15]&&!y[16]||y[15]&&y[16])&&Te.p(y,j),C&&he.p(y,j),U&&U.p(y,j),y[7]?W?W.p(y,j):(W=It(y),W.c(),W.m(p,P)):W&&(W.d(1),W=null),y[8]&&y[8]!=="<br>"?M?M.p(y,j):(M=Ot(y),M.c(),M.m(p,Q)):M&&(M.d(1),M=null),X&&G.p(y,j),y[14].driver_comments&&K.p(y,j),ie&&B.p(y,j),y[9]?Y?Y.p(y,j):(Y=Nt(y),Y.c(),Y.m(p,ue)):Y&&(Y.d(1),Y=null),y[16]||ae.p(y,j),(y[15]&&y[16]||!y[15]&&!y[16])&&de.p(y,j),y[4]?J||(J=yt(),J.c(),J.m(p,fe)):J&&(J.d(1),J=null),y[1]?Z?Z.p(y,j):(Z=wt(y),Z.c(),Z.m(p,null)):Z&&(Z.d(1),Z=null),y[11]?I?I.p(y,j):(I=zt(y),I.c(),I.m(ke.parentNode,ke)):I&&(I.d(1),I=null)},i:ze,o:ze,d(y){y&&(a(e),a(_),a(u),a(me),a(ke)),Te&&Te.d(),he&&he.d(),U&&U.d(),W&&W.d(),M&&M.d(),G&&G.d(),K&&K.d(),B&&B.d(),Y&&Y.d(),ae&&ae.d(),de&&de.d(),J&&J.d(),Z&&Z.d(),I&&I.d(y),Oe=!1,we()}}}const At=/Teléfono:\s*(\d{10,})/;function Mt(i,e){for(let t=0;t<e.length;t++)if(e[t].alias===i)return e[t].val;return""}function ot(i=""){return i.split(",").map(t=>t.trim())}function ao(i,e,t){let r=it,n=document.querySelector("ion-modal"),l=n.componentProps.delivery,f=n.componentProps.isLast||!1,d=n.componentProps.flag||!1,h=l.driver_comments?l.driver_comments:"",k=l.deliver_status?l.deliver_status:"",g=l.img?l.img:"",_=l.img_id?l.img_id:"",u=g?ot(g):new Array,p=_?ot(_):new Array,b={latitude:null,longitude:null},O=new Object,w="",R="",A=!1,q=!0,V=!1,F="",z=l.comments_ext,S=!1,E="",C=!1,D=null,H=new Object,P="";Ze(()=>{H=JSON.parse(localStorage.getItem("userSession")),Te(),X()});async function Q(J="",Z,I={}){let y=new FormData;t(4,A=!0);for(const[j,te]of Object.entries(I))y.append(j,te);y=M(y);try{const j=await fetch(J,{method:"POST",body:y});if(j.ok){const te=await j.json();Z(te)}else console.error("Request failed:",j.statusText)}catch(j){console.error("Error during file upload:",j)}finally{t(4,A=!1)}}function X(){l.date_service?l.date_service&&!l.date_completed&&!l.service_time?(t(5,q=!1),t(6,V=!0)):l.date_service&&l.date_completed&&l.service_time&&(t(5,q=!1),t(6,V=!1)):(t(5,q=!0),t(6,V=!1))}if(l.comments_ext){const J=l.comments_ext.match(At);J&&(F=J[1],z=l.comments_ext.replace(At,"").trim())}const ee=async(J,Z)=>{await(await je.create({header:J||"Error",message:Z||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()},ne=async(J="",Z="",I="",y,j={})=>{await(await je.create({header:J||"Error",message:Z||"Vuelva a intentar",buttons:[{text:"No",role:"cancel",handler:()=>{}},{text:"Sí",handler:()=>{Q(I,y,j)}}]})).present()},ie=async J=>{if(u.length==5)ee("Límite de evidencias","Solo se permite subir 5 fotos por parada");else if(d&&f&&u.length==1)ee("Límite de evidencias","Para el final de la ruta solo se permite subir 1 foto");else{const y=J.target.files[0],j=await _e(y);if(j){t(1,g=u.join(",")),_=p.join(",");var Z=new Object;Z.fileToUpload=j,Q(`${r}api/admin/manager/upload_img_driver.php`,function(te){t(1,g=g?`${g},${te.img}`:te.img),_=_?`${_},${te.img_id}`:te.img_id,t(2,u=ot(g)),p=ot(_)},Z)}}};function ve(J){var Z=l.service_time;!Z&&q&&!f&&!d&&(J.preventDefault(),ee("Registrar Ingreso","Antes de subir la evidencia registra el ingreso a la actual parada."))}function ue(){var J=d?l.date_completed:!1;if(!J&&!q&&V&&!f&&!d){var Z=new Object;Z.id_event=l.id_event,Z.type="checkout",ne("Registrar Salida","¿Completaste tu entrega?",r+"api/admin/route/record_check_date.php",function(I){I.minutes&&ee("Tiempo por parada","Completaste la parada en "+I.minutes+" minutos.")},Z)}}const _e=async J=>new Promise(Z=>{const I=new FileReader;I.onload=y=>{const j=new Image;j.src=y.target.result,j.onload=()=>{const te=document.createElement("canvas"),se=te.getContext("2d"),ge=800,ye=600;let le=j.width,re=j.height;le>ge&&(re*=ge/le,le=ge),re>ye&&(le*=ye/re,re=ye),te.width=le,te.height=re,se.drawImage(j,0,0,le,re),te.toBlob(pe=>{Z(pe)},"image/jpeg",.7)}},I.readAsDataURL(J)}),be=()=>{n.dismiss({data:Date.now()})};function fe(J){t(2,u=u.filter((Z,I)=>I!==J))}const me=async()=>{try{if(t(1,g=u.join(",")),_=p.join(","),ue(),await Oe())if(P.value=="delivered"||P.value!=="delivered"&&h.value){const Z={id_route:l.id_route,...!d&&!f&&{id_event:l.id_event},...!d&&!f&&{comments:h.value},...!d&&!f&&{deliver_status:P.value},img:g,img_id:_,lat:b.latitude,lon:b.longitude,...w==="0"&&{approve:"0"},...f&&{isLast:!0},...d&&f&&{destiny:!0}};Z.img&&Z.img_id?Q(`${r}api/admin/evidence/send_evidence.php`,function(I){if(I.success==!0){const y=Z.id_route;be(),f&&ke("","",y,f)}else ee("Carga fallida","Actualiza la página y vuelve a intentar cargar la información!")},Z):ee("Información incompleta","Cargar evidencia fotográfica faltante para completar parada.")}else ee("Motivo de status de entrega","Favor de ingresar en notas el motivo por el que la entrega no fue entregada correctamente");else ee("Ubicación faltante","Asegúrate darle permisos a Rutaflow para acceder a tu ubicación")}catch(J){console.error("Error fetching data:",J)}},ke=(J,Z,I,y)=>{n.componentProps.routeId=I,n.componentProps.driverId=l.id_driver,Ue("modal-km-gas",en,{checklist:J,driverId:Z,routeId:I,isLast:y}).then(j=>{})},Oe=async()=>navigator.geolocation?new Promise((J,Z)=>{navigator.geolocation.getCurrentPosition(I=>{b.latitude=I.coords.latitude,b.longitude=I.coords.longitude,J(!0)},I=>{console.error("Error getting location:",I),J(!1)})}):(console.error("Geolocation is not supported by your browser"),!1);async function we(J){J.stopPropagation();let Z=new FormData;Z.append("client_phone",F),Z.append("client_name",l.title),Z.append("delivery_phone",l.client_phone),Z.append("enterprise_name",l.enterprise_name),Z=M(Z);try{const I=await fetch(`${r}api/admin/message_central/send_sms.php`,{method:"POST",body:Z});if(I.ok){const y=await I.json();ee("SMS enviado","Se envío correctamente un SMS a "+l.title+" con número de teléfono: "+F)}else ee("SMS no enviado","Hubo un error al enviar SMS a "+l.title+" con número de teléfono: "+phoneNumber0+". Por favor contacte a soporte.")}catch(I){console.error("Error during file upload:",I)}}const Te=async()=>{if(l.id_enterprise){let J=new FormData;J.append("id_enterprise",l.id_enterprise),J=M(J);try{const Z=await fetch(`${r}api/admin/enterprise/enterprise_settings.php`,{method:"POST",body:J});Z.ok?(O=(await Z.json()).nodos,w=Mt("stops_wait_approval",O),t(3,R=Mt("sms_active",O))):console.error("File upload failed:",Z.statusText)}catch(Z){console.error("Error during file upload:",Z)}}};function he(){t(5,q=!1),t(6,V=!0),Ce(l.id_event,"checkin")}function Ne(){t(6,V=!1),t(5,q=!1),Ce(l.id_event,"checkout")}async function Ce(J,Z){if(Z){let I=new FormData;I.append("type",Z),I.append("id_event",J),I=M(I);try{const y=await fetch(`${r}api/admin/route/record_check_date.php`,{method:"POST",body:I});if(y.ok){const j=await y.json();j.minutes&&ee("Tiempo por parada","Completaste la parada en "+j.minutes+" minutos.")}else console.error("File upload failed:",y.statusText)}catch(y){console.error("Error during file upload:",y)}finally{}}}const U=J=>{t(12,D=J),t(11,C=!0)},W=()=>{t(11,C=!1),t(12,D=null)};function M(J){return J.append("token",H.token),J.append("id_user_over",H.id_user),J}function G(J){rn.call(this,i,J)}function K(J){Se[J?"unshift":"push"](()=>{E=J,t(10,E)})}function B(J){Se[J?"unshift":"push"](()=>{P=J,t(13,P)})}function Y(J){Se[J?"unshift":"push"](()=>{h=J,t(0,h)})}return[h,g,u,R,A,q,V,F,z,S,E,C,D,P,l,f,d,k,ie,ve,be,fe,me,we,he,Ne,U,W,G,K,B,Y,J=>U(J),J=>fe(J)]}class St extends Je{constructor(e){super(),Ye(this,e,ao,ro,We,{},null,[-1,-1])}}function Dt(i){let e;return{c(){e=s("ion-spinner"),this.h()},l(t){e=c(t,"ION-SPINNER",{name:!0}),m(e).forEach(a),this.h()},h(){v(e,"name","dots")},m(t,r){x(t,e,r)},d(t){t&&a(e)}}}function Pt(i){let e,t,r;return{c(){e=s("section"),t=s("ion-img"),this.h()},l(n){e=c(n,"SECTION",{});var l=m(e);t=c(l,"ION-IMG",{src:!0,alt:!0,style:!0}),m(t).forEach(a),l.forEach(a),this.h()},h(){Ke(t.src,r=i[0])||v(t,"src",r),v(t,"alt","Evidencia fotográfica"),L(t,"max-width","100%"),L(t,"margin-top","16px")},m(n,l){x(n,e,l),o(e,t)},p(n,l){l&1&&!Ke(t.src,r=n[0])&&v(t,"src",r)},d(n){n&&a(e)}}}function so(i){let e,t,r,n,l="Cancelar",f,d,h="AGREGAR GASTO",k,g,_,u,p,b,O,w,R,A,q,V,F,z,S,E,C,D,H='Tipo de pago <ion-text color="danger">(Obligatorio)</ion-text>',P,Q,X="Efectivo",ee,ne,ie="Tarjeta",ve,ue,_e="Transferencia",be,fe,me,ke,Oe,we,Te,he,Ne,Ce,U=`<ion-icon icon="${xt}" slot="start"></ion-icon>
                        Subir Evidencia`,W,M,G,K,B,Y,ae,de,J="Confirmar",Z,I,y=i[5]&&Dt(),j=i[0]&&Pt(i);return{c(){e=s("ion-header"),t=s("ion-toolbar"),r=s("ion-buttons"),n=s("ion-button"),n.textContent=l,f=N(),d=s("ion-title"),d.textContent=h,k=N(),g=s("ion-content"),_=s("ion-list"),u=s("ion-item"),p=s("ion-icon"),b=N(),O=s("ion-input"),w=N(),R=s("ion-item"),A=s("ion-icon"),q=N(),V=s("ion-input"),F=N(),z=s("ion-item"),S=s("ion-icon"),E=N(),C=s("ion-select"),D=s("div"),D.innerHTML=H,P=N(),Q=s("ion-select-option"),Q.textContent=X,ee=N(),ne=s("ion-select-option"),ne.textContent=ie,ve=N(),ue=s("ion-select-option"),ue.textContent=_e,be=N(),fe=s("ion-item"),me=s("ion-icon"),ke=N(),Oe=s("ion-textarea"),we=N(),Te=s("section"),he=s("label"),Ne=s("ion-button"),Ce=s("label"),Ce.innerHTML=U,W=N(),M=s("input"),G=N(),y&&y.c(),K=N(),j&&j.c(),B=N(),Y=s("ion-footer"),ae=s("ion-toolbar"),de=s("ion-button"),de.textContent=J,this.h()},l(te){e=c(te,"ION-HEADER",{translucent:!0});var se=m(e);t=c(se,"ION-TOOLBAR",{});var ge=m(t);r=c(ge,"ION-BUTTONS",{slot:!0});var ye=m(r);n=c(ye,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),oe(n)!=="svelte-1f8rjcf"&&(n.textContent=l),ye.forEach(a),f=T(ge),d=c(ge,"ION-TITLE",{title:!0,"data-svelte-h":!0}),oe(d)!=="svelte-efps2s"&&(d.textContent=h),ge.forEach(a),se.forEach(a),k=T(te),g=c(te,"ION-CONTENT",{fullscreen:!0});var le=m(g);_=c(le,"ION-LIST",{});var re=m(_);u=c(re,"ION-ITEM",{});var pe=m(u);p=c(pe,"ION-ICON",{icon:!0,slot:!0}),m(p).forEach(a),b=T(pe),O=c(pe,"ION-INPUT",{label:!0,type:!0,placeholder:!0,value:!0}),m(O).forEach(a),pe.forEach(a),w=T(re),R=c(re,"ION-ITEM",{});var Ae=m(R);A=c(Ae,"ION-ICON",{icon:!0,slot:!0}),m(A).forEach(a),q=T(Ae),V=c(Ae,"ION-INPUT",{label:!0,type:!0,value:!0}),m(V).forEach(a),Ae.forEach(a),F=T(re),z=c(re,"ION-ITEM",{});var Ve=m(z);S=c(Ve,"ION-ICON",{icon:!0,slot:!0}),m(S).forEach(a),E=T(Ve),C=c(Ve,"ION-SELECT",{placeholder:!0,value:!0});var Fe=m(C);D=c(Fe,"DIV",{slot:!0,"data-svelte-h":!0}),oe(D)!=="svelte-wl764p"&&(D.innerHTML=H),P=T(Fe),Q=c(Fe,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),oe(Q)!=="svelte-i9crym"&&(Q.textContent=X),ee=T(Fe),ne=c(Fe,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),oe(ne)!=="svelte-fx0z11"&&(ne.textContent=ie),ve=T(Fe),ue=c(Fe,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),oe(ue)!=="svelte-1c24jf2"&&(ue.textContent=_e),Fe.forEach(a),Ve.forEach(a),be=T(re),fe=c(re,"ION-ITEM",{});var tt=m(fe);me=c(tt,"ION-ICON",{icon:!0,slot:!0}),m(me).forEach(a),ke=T(tt),Oe=c(tt,"ION-TEXTAREA",{label:!0,placeholder:!0}),m(Oe).forEach(a),tt.forEach(a),we=T(re),Te=c(re,"SECTION",{});var ht=m(Te);he=c(ht,"LABEL",{for:!0,style:!0});var pt=m(he);Ne=c(pt,"ION-BUTTON",{fill:!0,size:!0,class:!0,expand:!0});var nt=m(Ne);Ce=c(nt,"LABEL",{for:!0,style:!0,"data-svelte-h":!0}),oe(Ce)!=="svelte-1m9yw22"&&(Ce.innerHTML=U),W=T(nt),M=c(nt,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0}),nt.forEach(a),pt.forEach(a),ht.forEach(a),G=T(re),y&&y.l(re),K=T(re),j&&j.l(re),re.forEach(a),le.forEach(a),B=T(te),Y=c(te,"ION-FOOTER",{});var mt=m(Y);ae=c(mt,"ION-TOOLBAR",{});var vt=m(ae);de=c(vt,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),oe(de)!=="svelte-1c7dl3f"&&(de.textContent=J),vt.forEach(a),mt.forEach(a),this.h()},h(){v(n,"color","medium"),v(r,"slot","start"),v(d,"title",""),v(e,"translucent",""),v(p,"icon",Zt),v(p,"slot","start"),v(O,"label","Concepto"),v(O,"type","text"),v(O,"placeholder","Escribe aquí..."),v(O,"value",i[6]?i[6]:""),v(A,"icon",st),v(A,"slot","start"),v(V,"label","Cantidad"),v(V,"type","number"),v(V,"value",i[7]?i[7]:""),v(S,"icon",yn),v(S,"slot","start"),$(D,"slot","label"),v(Q,"value","cash"),v(ne,"value","card"),v(ue,"value","transfer"),v(C,"placeholder","Tipo de pago"),v(C,"value",i[8]?i[8]:""),v(me,"icon",st),v(me,"slot","start"),v(Oe,"label","Comentarios"),v(Oe,"placeholder","Escribe aquí..."),$(Ce,"for","eventEvidence"),L(Ce,"width","100%"),L(Ce,"padding","8px"),L(M,"display","none"),$(M,"id","eventEvidence"),$(M,"name","fileToUpload"),$(M,"type","file"),$(M,"accept","image/*"),v(Ne,"fill","outline"),v(Ne,"size","small"),v(Ne,"class","loadEvidence"),v(Ne,"expand","block"),$(he,"for","eventEvidence"),L(he,"display","block"),L(he,"width","100%"),v(g,"fullscreen",""),v(de,"fill","outline"),v(de,"color","tertiary"),v(de,"strong",""),L(de,"width","99%"),L(de,"height","auto")},m(te,se){x(te,e,se),o(e,t),o(t,r),o(r,n),o(t,f),o(t,d),x(te,k,se),x(te,g,se),o(g,_),o(_,u),o(u,p),o(u,b),o(u,O),i[12](O),o(_,w),o(_,R),o(R,A),o(R,q),o(R,V),i[13](V),o(_,F),o(_,z),o(z,S),o(z,E),o(z,C),o(C,D),o(C,P),o(C,Q),o(C,ee),o(C,ne),o(C,ve),o(C,ue),i[14](C),o(_,be),o(_,fe),o(fe,me),o(fe,ke),o(fe,Oe),i[15](Oe),o(_,we),o(_,Te),o(Te,he),o(he,Ne),o(Ne,Ce),o(Ne,W),o(Ne,M),o(_,G),y&&y.m(_,null),o(_,K),j&&j.m(_,null),x(te,B,se),x(te,Y,se),o(Y,ae),o(ae,de),Z||(I=[ce(n,"click",i[10]),ce(M,"change",i[9]),ce(de,"click",i[11])],Z=!0)},p(te,[se]){te[5]?y||(y=Dt(),y.c(),y.m(_,K)):y&&(y.d(1),y=null),te[0]?j?j.p(te,se):(j=Pt(te),j.c(),j.m(_,null)):j&&(j.d(1),j=null)},i:ze,o:ze,d(te){te&&(a(e),a(k),a(g),a(B),a(Y)),i[12](null),i[13](null),i[14](null),i[15](null),y&&y.d(),j&&j.d(),Z=!1,Be(I)}}}function co(i,e,t){let r=it,n=document.querySelector("ion-modal"),l=n.componentProps.routeId,f=n.componentProps.ex_concept,d=n.componentProps.ex_amount,h=n.componentProps.ex_type,k=n.componentProps.id_expense,g="",_="",u="",p=0,b="",O="",w=!1,R=new Object;Ze(()=>{R=JSON.parse(localStorage.getItem("userSession"))});const A=async(P,Q)=>{await(await je.create({header:P||"Error",message:Q||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()},q=async P=>{t(5,w=!0);const X=P.target.files[0],ee=await V(X);if(ee){let ne=new FormData;ne.append("fileToUpload",ee),ne=S(ne);try{const ie=await fetch(`${r}api/admin/manager/upload_img_driver.php`,{method:"POST",body:ne});if(ie.ok){const ve=await ie.json();t(0,g=ve.img),_=ve.img_id}else console.error("File upload failed:",ie.statusText)}catch(ie){console.error("Error during file upload:",ie)}finally{t(5,w=!1)}}},V=async P=>new Promise(Q=>{const X=new FileReader;X.onload=ee=>{const ne=new Image;ne.src=ee.target.result,ne.onload=()=>{const ie=document.createElement("canvas"),ve=ie.getContext("2d"),ue=800,_e=600;let be=ne.width,fe=ne.height;be>ue&&(fe*=ue/be,be=ue),fe>_e&&(be*=_e/fe,fe=_e),ie.width=be,ie.height=fe,ve.drawImage(ne,0,0,be,fe),ie.toBlob(me=>{Q(me)},"image/jpeg",.7)}},X.readAsDataURL(P)}),F=()=>{et.dismiss()},z=()=>{var P=new Object;P.id_route=l,P.comments=b.value,P.type=u.value,P.img=g,P.img_id=_,P.amount=p.value,P.concept=O.value,P.status="done",P.id_expense=k||"null";let Q=new FormData;for(const X in P)Q.append(X,P[X]);Q=S(Q),!_||!g||!b.value||!p.value||!O.value?A("Datos incompletos","Llena los datos requeridos para completar el registro"):fetch(`${r}api/admin/expenses/add_expense.php`,{method:"POST",body:Q}).then(X=>X.json()).then(X=>{F()}).catch(X=>{console.error("Error fetching data:",X)})};function S(P){return P.append("token",R.token),P.append("id_user_over",R.id_user),P}function E(P){Se[P?"unshift":"push"](()=>{O=P,t(4,O)})}function C(P){Se[P?"unshift":"push"](()=>{p=P,t(2,p)})}function D(P){Se[P?"unshift":"push"](()=>{u=P,t(1,u)})}function H(P){Se[P?"unshift":"push"](()=>{b=P,t(3,b)})}return[g,u,p,b,O,w,f,d,h,q,F,z,E,C,D,H]}class ut extends Je{constructor(e){super(),Ye(this,e,co,so,We,{})}}function Bt(i,e,t){const r=i.slice();return r[7]=e[t],r}function uo(i){let e,t="Cargar gasto",r,n;function l(...f){return i[4](i[7],...f)}return{c(){e=s("ion-button"),e.textContent=t,this.h()},l(f){e=c(f,"ION-BUTTON",{fill:!0,size:!0,"aria-selected":!0,"data-svelte-h":!0}),oe(e)!=="svelte-175aelj"&&(e.textContent=t),this.h()},h(){v(e,"fill","outline"),v(e,"size","small"),v(e,"aria-selected","")},m(f,d){x(f,e,d),r||(n=ce(e,"click",l),r=!0)},p(f,d){i=f},d(f){f&&a(e),r=!1,n()}}}function fo(i){let e,t="Gasto completado";return{c(){e=s("ion-button"),e.textContent=t,this.h()},l(r){e=c(r,"ION-BUTTON",{fill:!0,size:!0,"aria-selected":!0,"data-svelte-h":!0}),oe(e)!=="svelte-tlger7"&&(e.textContent=t),this.h()},h(){v(e,"fill","solid"),v(e,"size","small"),v(e,"aria-selected","")},m(r,n){x(r,e,n)},p:ze,d(r){r&&a(e)}}}function Ht(i,e){let t,r,n,l=e[7].concept+"",f,d,h;function k(u,p){return u[7].status=="done"?fo:uo}let _=k(e)(e);return{key:i,first:null,c(){t=s("ion-item"),r=s("ion-label"),n=s("p"),f=Ee(l),d=N(),_.c(),h=N(),this.h()},l(u){t=c(u,"ION-ITEM",{});var p=m(t);r=c(p,"ION-LABEL",{style:!0});var b=m(r);n=c(b,"P",{style:!0});var O=m(n);f=Ie(O,l),O.forEach(a),b.forEach(a),d=T(p),_.l(p),h=T(p),p.forEach(a),this.h()},h(){L(n,"margin-left","10px"),L(r,"display","flex"),this.first=t},m(u,p){x(u,t,p),o(t,r),o(r,n),o(n,f),o(t,d),_.m(t,null),o(t,h)},p(u,p){e=u,_.p(e,p)},d(u){u&&a(t),_.d()}}}function _o(i){let e,t,r,n,l=`<ion-icon style="font-size: 25px!important;" icon="${wn}"></ion-icon>`,f,d,h="LISTA DE GASTOS",k,g,_,u=[],p=new Map,b,O,w,R="Cerrar",A,q,V=He(i[0]);const F=z=>z[7].id_expenses;for(let z=0;z<V.length;z+=1){let S=Bt(i,V,z),E=F(S);p.set(E,u[z]=Ht(E,S))}return{c(){e=s("ion-header"),t=s("ion-toolbar"),r=s("ion-buttons"),n=s("ion-button"),n.innerHTML=l,f=N(),d=s("ion-title"),d.textContent=h,k=N(),g=s("ion-content"),_=s("ion-list");for(let z=0;z<u.length;z+=1)u[z].c();b=N(),O=s("ion-footer"),w=s("ion-button"),w.textContent=R,this.h()},l(z){e=c(z,"ION-HEADER",{translucent:!0});var S=m(e);t=c(S,"ION-TOOLBAR",{});var E=m(t);r=c(E,"ION-BUTTONS",{slot:!0});var C=m(r);n=c(C,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),oe(n)!=="svelte-160xz3i"&&(n.innerHTML=l),C.forEach(a),f=T(E),d=c(E,"ION-TITLE",{"data-svelte-h":!0}),oe(d)!=="svelte-1phn90x"&&(d.textContent=h),E.forEach(a),S.forEach(a),k=T(z),g=c(z,"ION-CONTENT",{fullscreen:!0});var D=m(g);_=c(D,"ION-LIST",{});var H=m(_);for(let Q=0;Q<u.length;Q+=1)u[Q].l(H);H.forEach(a),D.forEach(a),b=T(z),O=c(z,"ION-FOOTER",{});var P=m(O);w=c(P,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),oe(w)!=="svelte-zv7v83"&&(w.textContent=R),P.forEach(a),this.h()},h(){v(n,"color","medium"),v(r,"slot","end"),v(e,"translucent",""),v(g,"fullscreen",""),v(w,"fill","outline"),v(w,"color","tertiary"),v(w,"strong",""),L(w,"width","99%"),L(w,"height","auto")},m(z,S){x(z,e,S),o(e,t),o(t,r),o(r,n),o(t,f),o(t,d),x(z,k,S),x(z,g,S),o(g,_);for(let E=0;E<u.length;E+=1)u[E]&&u[E].m(_,null);x(z,b,S),x(z,O,S),o(O,w),A||(q=[ce(n,"click",i[3]),ce(w,"click",i[1])],A=!0)},p(z,[S]){S&5&&(V=He(z[0]),u=xe(u,S,F,1,z,V,p,_,$e,Ht,null,Bt))},i:ze,o:ze,d(z){z&&(a(e),a(k),a(g),a(b),a(O));for(let S=0;S<u.length;S+=1)u[S].d();A=!1,Be(q)}}}function ho(i){let e=document.querySelector("ion-modal");e.componentProps.routeId;let t=e.componentProps.expenses;Ze(()=>{});const r=()=>{et.dismiss()};function n(d,h,k,g,_){e.componentProps.ex_amount=k,e.componentProps.ex_concept=h,e.componentProps.ex_type=g,e.componentProps.id_expense=_,Ue("modal-expense",ut,{amount:k,concept:h,type:g,id_expense:_}).then(()=>{}),r()}return[t,r,n,d=>{Ue("modal-expense",ut,{routeId:d}).then(h=>{}),r()},(d,h)=>n(h,d.concept,d.amount,d.type,d.id_expenses)]}class po extends Je{constructor(e){super(),Ye(this,e,ho,_o,We,{})}}const{document:Rt}=Pn;function Ut(i,e,t){const r=i.slice();return r[45]=e[t],r[47]=t,r}function Vt(i,e,t){const r=i.slice();return r[45]=e[t],r[47]=t,r}function Ft(i,e,t){const r=i.slice();return r[45]=e[t],r[47]=t,r}function qt(i){let e,t;return e=new Mn({props:{$$slots:{default:[ko]},$$scope:{ctx:i}}}),{c(){fn(e.$$.fragment)},l(r){dn(e.$$.fragment,r)},m(r,n){_n(e,r,n),t=!0},p(r,n){const l={};n[0]&1019|n[1]&524288&&(l.$$scope={dirty:n,ctx:r}),e.$set(l)},i(r){t||(lt(e.$$.fragment,r),t=!0)},o(r){at(e.$$.fragment,r),t=!1},d(r){hn(e,r)}}}function mo(i){let e,t='<div id="g_map" style="width: 100%; height: 100vh;"></div>';return{c(){e=s("ion-content"),e.innerHTML=t},l(r){e=c(r,"ION-CONTENT",{"data-svelte-h":!0}),oe(e)!=="svelte-1ydw6i9"&&(e.innerHTML=t)},m(r,n){x(r,e,n)},p:ze,d(r){r&&a(e)}}}function vo(i){let e;function t(l,f){if(l[7].length>0)return bo;if(!l[3])return go}let r=t(i),n=r&&r(i);return{c(){n&&n.c(),e=De()},l(l){n&&n.l(l),e=De()},m(l,f){n&&n.m(l,f),x(l,e,f)},p(l,f){r===(r=t(l))&&n?n.p(l,f):(n&&n.d(1),n=r&&r(l),n&&(n.c(),n.m(e.parentNode,e)))},d(l){l&&a(e),n&&n.d(l)}}}function go(i){let e,t,r,n='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Jala para actualizar" refreshing-spinner="circles" refreshing-text="Actualizando..."></ion-refresher-content>',l,f,d,h,k,g,_="0",u,p,b,O,w,R=i[6].origin+"",A,q,V,F="",z,S,E,C=[],D=new Map,H,P,Q,X,ee,ne=i[5].length+1+"",ie,ve,ue,_e,be,fe,me=i[6].destination+"",ke,Oe,we,Te="",he,Ne,Ce,U,W=i[4]&&jt(i),M=He(i[5]);const G=K=>K[45].id_event;for(let K=0;K<M.length;K+=1){let B=Ut(i,M,K),Y=G(B);D.set(Y,C[K]=Kt(Y,B))}return{c(){W&&W.c(),e=N(),t=s("ion-content"),r=s("ion-refresher"),r.innerHTML=n,l=N(),f=s("ion-list"),d=s("ion-item"),h=s("ion-avatar"),k=s("div"),g=s("div"),g.textContent=_,p=N(),b=s("ion-label"),O=s("ion-text"),w=s("h3"),A=Ee(R),q=N(),V=s("div"),V.innerHTML=F,z=N(),S=s("ion-icon"),E=N();for(let K=0;K<C.length;K+=1)C[K].c();H=N(),P=s("ion-item"),Q=s("ion-avatar"),X=s("div"),ee=s("div"),ie=Ee(ne),ue=N(),_e=s("ion-label"),be=s("ion-text"),fe=s("h3"),ke=Ee(me),Oe=N(),we=s("div"),we.innerHTML=Te,he=N(),Ne=s("ion-icon"),this.h()},l(K){W&&W.l(K),e=T(K),t=c(K,"ION-CONTENT",{});var B=m(t);r=c(B,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),oe(r)!=="svelte-1srnbs3"&&(r.innerHTML=n),l=T(B),f=c(B,"ION-LIST",{});var Y=m(f);d=c(Y,"ION-ITEM",{});var ae=m(d);h=c(ae,"ION-AVATAR",{slot:!0});var de=m(h);k=c(de,"DIV",{class:!0,title:!0,style:!0});var J=m(k);g=c(J,"DIV",{class:!0,"data-svelte-h":!0}),oe(g)!=="svelte-3lvlrb"&&(g.textContent=_),J.forEach(a),de.forEach(a),p=T(ae),b=c(ae,"ION-LABEL",{button:!0});var Z=m(b);O=c(Z,"ION-TEXT",{color:!0});var I=m(O);w=c(I,"H3",{});var y=m(w);A=Ie(y,R),y.forEach(a),I.forEach(a),q=T(Z),V=c(Z,"DIV",{class:!0,"data-svelte-h":!0}),oe(V)!=="svelte-gz9kb"&&(V.innerHTML=F),Z.forEach(a),z=T(ae),S=c(ae,"ION-ICON",{icon:!0,slot:!0}),m(S).forEach(a),ae.forEach(a),E=T(Y);for(let pe=0;pe<C.length;pe+=1)C[pe].l(Y);H=T(Y),P=c(Y,"ION-ITEM",{});var j=m(P);Q=c(j,"ION-AVATAR",{slot:!0});var te=m(Q);X=c(te,"DIV",{class:!0,title:!0,style:!0});var se=m(X);ee=c(se,"DIV",{class:!0});var ge=m(ee);ie=Ie(ge,ne),ge.forEach(a),se.forEach(a),te.forEach(a),ue=T(j),_e=c(j,"ION-LABEL",{button:!0});var ye=m(_e);be=c(ye,"ION-TEXT",{color:!0});var le=m(be);fe=c(le,"H3",{});var re=m(fe);ke=Ie(re,me),re.forEach(a),le.forEach(a),Oe=T(ye),we=c(ye,"DIV",{class:!0,"data-svelte-h":!0}),oe(we)!=="svelte-130ohbs"&&(we.innerHTML=Te),ye.forEach(a),he=T(j),Ne=c(j,"ION-ICON",{icon:!0,slot:!0}),m(Ne).forEach(a),j.forEach(a),Y.forEach(a),B.forEach(a),this.h()},h(){v(r,"slot","fixed"),$(g,"class","order svelte-egzizz"),$(k,"class","order-wrapper svelte-egzizz"),$(k,"title",u="$"+i[6].origin),L(k,"background-color",i[6].color),L(k,"color",Me(i[6].color)),v(h,"slot","start"),v(O,"color","#2e2e2e"),$(V,"class","sub svelte-egzizz"),v(b,"button",""),v(S,"icon",Re),v(S,"slot","end"),$(ee,"class","order svelte-egzizz"),$(X,"class","order-wrapper svelte-egzizz"),$(X,"title",ve="$"+i[6].destination),L(X,"background-color",i[6].color),L(X,"color",Me(i[6].color)),v(Q,"slot","start"),v(be,"color","#2e2e2e"),$(we,"class","sub svelte-egzizz"),v(_e,"button",""),v(Ne,"icon",Re),v(Ne,"slot","end")},m(K,B){W&&W.m(K,B),x(K,e,B),x(K,t,B),o(t,r),i[30](r),o(t,l),o(t,f),o(f,d),o(d,h),o(h,k),o(k,g),o(d,p),o(d,b),o(b,O),o(O,w),o(w,A),o(b,q),o(b,V),o(d,z),o(d,S),o(f,E);for(let Y=0;Y<C.length;Y+=1)C[Y]&&C[Y].m(f,null);o(f,H),o(f,P),o(P,Q),o(Q,X),o(X,ee),o(ee,ie),o(P,ue),o(P,_e),o(_e,be),o(be,fe),o(fe,ke),o(_e,Oe),o(_e,we),o(P,he),o(P,Ne),Ce||(U=[ce(r,"ionRefresh",i[10]),ce(b,"click",i[31]),ce(_e,"click",i[33])],Ce=!0)},p(K,B){K[4]?W?W.p(K,B):(W=jt(K),W.c(),W.m(e.parentNode,e)):W&&(W.d(1),W=null),B[0]&64&&u!==(u="$"+K[6].origin)&&$(k,"title",u),B[0]&64&&L(k,"background-color",K[6].color),B[0]&64&&L(k,"color",Me(K[6].color)),B[0]&64&&R!==(R=K[6].origin+"")&&Le(A,R),B[0]&331808&&(M=He(K[5]),C=xe(C,B,G,1,K,M,D,f,$e,Kt,H,Ut)),B[0]&32&&ne!==(ne=K[5].length+1+"")&&Le(ie,ne),B[0]&64&&ve!==(ve="$"+K[6].destination)&&$(X,"title",ve),B[0]&64&&L(X,"background-color",K[6].color),B[0]&64&&L(X,"color",Me(K[6].color)),B[0]&64&&me!==(me=K[6].destination+"")&&Le(ke,me)},d(K){K&&(a(e),a(t)),W&&W.d(K),i[30](null);for(let B=0;B<C.length;B+=1)C[B].d();Ce=!1,Be(U)}}}function bo(i){let e,t;function r(f,d){return d[0]&144&&(e=null),e==null&&(e=!!(f[7].filter(No).every(To)&&!f[4])),e?Io:Eo}let n=r(i,[-1,-1]),l=n(i);return{c(){l.c(),t=De()},l(f){l.l(f),t=De()},m(f,d){l.m(f,d),x(f,t,d)},p(f,d){n===(n=r(f,d))&&l?l.p(f,d):(l.d(1),l=n(f),l&&(l.c(),l.m(t.parentNode,t)))},d(f){f&&a(t),l.d(f)}}}function jt(i){let e=i[14]("",i[1],i[0])+"",t;return{c(){t=Ee(e)},l(r){t=Ie(r,e)},m(r,n){x(r,t,n)},p(r,n){n[0]&3&&e!==(e=r[14]("",r[1],r[0])+"")&&Le(t,e)},d(r){r&&a(t)}}}function Gt(i){let e;return{c(){e=s("span"),this.h()},l(t){e=c(t,"SPAN",{class:!0}),m(e).forEach(a),this.h()},h(){$(e,"class","notes svelte-egzizz")},m(t,r){x(t,e,r)},d(t){t&&a(e)}}}function Kt(i,e){let t,r,n,l,f=parseInt(e[45].pos)+1+"",d,h,k,g,_,u,p=e[45].title+"",b,O,w=e[45].support_list&&e[45].support_list.length||e[16](e[45]),R,A,q,V,F=w&&Gt();function z(){return e[32](e[45])}return{key:i,first:null,c(){t=s("ion-item"),r=s("ion-avatar"),n=s("div"),l=s("div"),d=Ee(f),k=N(),g=s("ion-label"),_=s("ion-text"),u=s("h3"),b=Ee(p),O=N(),F&&F.c(),R=N(),A=s("ion-icon"),this.h()},l(S){t=c(S,"ION-ITEM",{});var E=m(t);r=c(E,"ION-AVATAR",{slot:!0});var C=m(r);n=c(C,"DIV",{class:!0,title:!0,style:!0});var D=m(n);l=c(D,"DIV",{class:!0});var H=m(l);d=Ie(H,f),H.forEach(a),D.forEach(a),C.forEach(a),k=T(E),g=c(E,"ION-LABEL",{button:!0});var P=m(g);_=c(P,"ION-TEXT",{color:!0});var Q=m(_);u=c(Q,"H3",{});var X=m(u);b=Ie(X,p),O=T(X),F&&F.l(X),X.forEach(a),Q.forEach(a),P.forEach(a),R=T(E),A=c(E,"ION-ICON",{icon:!0,slot:!0,style:!0}),m(A).forEach(a),E.forEach(a),this.h()},h(){$(l,"class","order svelte-egzizz"),$(n,"class","order-wrapper svelte-egzizz"),$(n,"title",h=Xe(e[45].status)),L(n,"background-color",Pe(e[45].status,e[45].date_service)),L(n,"color",Me(Pe(e[45].status))),v(r,"slot","start"),v(_,"color","#2e2e2e"),v(g,"button",""),v(A,"icon",Re),v(A,"slot","end"),L(A,"color",Pe(e[45].status,e[45].date_service)),this.first=t},m(S,E){x(S,t,E),o(t,r),o(r,n),o(n,l),o(l,d),o(t,k),o(t,g),o(g,_),o(_,u),o(u,b),o(u,O),F&&F.m(u,null),o(t,R),o(t,A),q||(V=ce(g,"click",z),q=!0)},p(S,E){e=S,E[0]&32&&f!==(f=parseInt(e[45].pos)+1+"")&&Le(d,f),E[0]&32&&h!==(h=Xe(e[45].status))&&$(n,"title",h),E[0]&32&&L(n,"background-color",Pe(e[45].status,e[45].date_service)),E[0]&32&&L(n,"color",Me(Pe(e[45].status))),E[0]&32&&p!==(p=e[45].title+"")&&Le(b,p),E[0]&32&&(w=e[45].support_list&&e[45].support_list.length||e[16](e[45])),w?F||(F=Gt(),F.c(),F.m(u,null)):F&&(F.d(1),F=null),E[0]&32&&L(A,"color",Pe(e[45].status,e[45].date_service))},d(S){S&&a(t),F&&F.d(),q=!1,V()}}}function Eo(i){let e=i[14](i[7],i[1],i[0])+"",t,r,n,l,f='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Pull to refresh" refreshing-spinner="circles" refreshing-text="Refreshing..."></ion-refresher-content>',d,h,k,g,_,u,p="0",b,O,w,R,A,q=i[6].origin+"",V,F,z,S="",E,C,D,H=[],P=new Map,Q,X,ee,ne,ie,ve=i[5].length+1+"",ue,_e,be,fe,me,ke,Oe=i[6].destination+"",we,Te,he,Ne="",Ce,U,W,M,G=He(i[5]);const K=B=>B[45].id_event;for(let B=0;B<G.length;B+=1){let Y=Vt(i,G,B),ae=K(Y);P.set(ae,H[B]=Wt(ae,Y))}return{c(){t=Ee(e),r=N(),n=s("ion-content"),l=s("ion-refresher"),l.innerHTML=f,d=N(),h=s("ion-list"),k=s("ion-item"),g=s("ion-avatar"),_=s("div"),u=s("div"),u.textContent=p,O=N(),w=s("ion-label"),R=s("ion-text"),A=s("h3"),V=Ee(q),F=N(),z=s("div"),z.innerHTML=S,E=N(),C=s("ion-icon"),D=N();for(let B=0;B<H.length;B+=1)H[B].c();Q=N(),X=s("ion-item"),ee=s("ion-avatar"),ne=s("div"),ie=s("div"),ue=Ee(ve),be=N(),fe=s("ion-label"),me=s("ion-text"),ke=s("h3"),we=Ee(Oe),Te=N(),he=s("div"),he.innerHTML=Ne,Ce=N(),U=s("ion-icon"),this.h()},l(B){t=Ie(B,e),r=T(B),n=c(B,"ION-CONTENT",{});var Y=m(n);l=c(Y,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),oe(l)!=="svelte-dvt1s"&&(l.innerHTML=f),d=T(Y),h=c(Y,"ION-LIST",{});var ae=m(h);k=c(ae,"ION-ITEM",{});var de=m(k);g=c(de,"ION-AVATAR",{slot:!0});var J=m(g);_=c(J,"DIV",{class:!0,title:!0,style:!0});var Z=m(_);u=c(Z,"DIV",{class:!0,"data-svelte-h":!0}),oe(u)!=="svelte-3lvlrb"&&(u.textContent=p),Z.forEach(a),J.forEach(a),O=T(de),w=c(de,"ION-LABEL",{button:!0});var I=m(w);R=c(I,"ION-TEXT",{color:!0});var y=m(R);A=c(y,"H3",{});var j=m(A);V=Ie(j,q),j.forEach(a),y.forEach(a),F=T(I),z=c(I,"DIV",{class:!0,"data-svelte-h":!0}),oe(z)!=="svelte-gz9kb"&&(z.innerHTML=S),I.forEach(a),E=T(de),C=c(de,"ION-ICON",{icon:!0,slot:!0}),m(C).forEach(a),de.forEach(a),D=T(ae);for(let Ae=0;Ae<H.length;Ae+=1)H[Ae].l(ae);Q=T(ae),X=c(ae,"ION-ITEM",{});var te=m(X);ee=c(te,"ION-AVATAR",{slot:!0});var se=m(ee);ne=c(se,"DIV",{class:!0,title:!0,style:!0});var ge=m(ne);ie=c(ge,"DIV",{class:!0});var ye=m(ie);ue=Ie(ye,ve),ye.forEach(a),ge.forEach(a),se.forEach(a),be=T(te),fe=c(te,"ION-LABEL",{button:!0});var le=m(fe);me=c(le,"ION-TEXT",{color:!0});var re=m(me);ke=c(re,"H3",{});var pe=m(ke);we=Ie(pe,Oe),pe.forEach(a),re.forEach(a),Te=T(le),he=c(le,"DIV",{class:!0,"data-svelte-h":!0}),oe(he)!=="svelte-130ohbs"&&(he.innerHTML=Ne),le.forEach(a),Ce=T(te),U=c(te,"ION-ICON",{icon:!0,slot:!0}),m(U).forEach(a),te.forEach(a),ae.forEach(a),Y.forEach(a),this.h()},h(){v(l,"slot","fixed"),$(u,"class","order svelte-egzizz"),$(_,"class","order-wrapper svelte-egzizz"),$(_,"title",b="$"+i[6].origin),L(_,"background-color",i[6].color),L(_,"color",Me(i[6].color)),v(g,"slot","start"),v(R,"color","#2e2e2e"),$(z,"class","sub svelte-egzizz"),v(w,"button",""),v(C,"icon",Re),v(C,"slot","end"),$(ie,"class","order svelte-egzizz"),$(ne,"class","order-wrapper svelte-egzizz"),$(ne,"title",_e="$"+i[6].destination),L(ne,"background-color",i[6].color),L(ne,"color",Me(i[6].color)),v(ee,"slot","start"),v(me,"color","#2e2e2e"),$(he,"class","sub svelte-egzizz"),v(fe,"button",""),v(U,"icon",Re),v(U,"slot","end")},m(B,Y){x(B,t,Y),x(B,r,Y),x(B,n,Y),o(n,l),i[26](l),o(n,d),o(n,h),o(h,k),o(k,g),o(g,_),o(_,u),o(k,O),o(k,w),o(w,R),o(R,A),o(A,V),o(w,F),o(w,z),o(k,E),o(k,C),o(h,D);for(let ae=0;ae<H.length;ae+=1)H[ae]&&H[ae].m(h,null);o(h,Q),o(h,X),o(X,ee),o(ee,ne),o(ne,ie),o(ie,ue),o(X,be),o(X,fe),o(fe,me),o(me,ke),o(ke,we),o(fe,Te),o(fe,he),o(X,Ce),o(X,U),W||(M=[ce(l,"ionRefresh",i[10]),ce(w,"click",i[27]),ce(fe,"click",i[29])],W=!0)},p(B,Y){Y[0]&131&&e!==(e=B[14](B[7],B[1],B[0])+"")&&Le(t,e),Y[0]&64&&b!==(b="$"+B[6].origin)&&$(_,"title",b),Y[0]&64&&L(_,"background-color",B[6].color),Y[0]&64&&L(_,"color",Me(B[6].color)),Y[0]&64&&q!==(q=B[6].origin+"")&&Le(V,q),Y[0]&331808&&(G=He(B[5]),H=xe(H,Y,K,1,B,G,P,h,$e,Wt,Q,Vt)),Y[0]&32&&ve!==(ve=B[5].length+1+"")&&Le(ue,ve),Y[0]&64&&_e!==(_e="$"+B[6].destination)&&$(ne,"title",_e),Y[0]&64&&L(ne,"background-color",B[6].color),Y[0]&64&&L(ne,"color",Me(B[6].color)),Y[0]&64&&Oe!==(Oe=B[6].destination+"")&&Le(we,Oe)},d(B){B&&(a(t),a(r),a(n)),i[26](null);for(let Y=0;Y<H.length;Y+=1)H[Y].d();W=!1,Be(M)}}}function Io(i){let e,t,r='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Jale para actualizar" refreshing-spinner="circles" refreshing-text="Actualizando..."></ion-refresher-content>',n,l,f,d,h,k,g="0",_,u,p,b,O,w=i[6].origin+"",R,A,q,V="",F,z,S,E=[],C=new Map,D,H,P,Q,X,ee=i[5].length+1+"",ne,ie,ve,ue,_e,be,fe=i[6].destination+"",me,ke,Oe,we="",Te,he,Ne,Ce,U=He(i[5]);const W=M=>M[45].id_event;for(let M=0;M<U.length;M+=1){let G=Ft(i,U,M),K=W(G);C.set(K,E[M]=Yt(K,G))}return{c(){e=s("ion-content"),t=s("ion-refresher"),t.innerHTML=r,n=N(),l=s("ion-list"),f=s("ion-item"),d=s("ion-avatar"),h=s("div"),k=s("div"),k.textContent=g,u=N(),p=s("ion-label"),b=s("ion-text"),O=s("h3"),R=Ee(w),A=N(),q=s("div"),q.innerHTML=V,F=N(),z=s("ion-icon"),S=N();for(let M=0;M<E.length;M+=1)E[M].c();D=N(),H=s("ion-item"),P=s("ion-avatar"),Q=s("div"),X=s("div"),ne=Ee(ee),ve=N(),ue=s("ion-label"),_e=s("ion-text"),be=s("h3"),me=Ee(fe),ke=N(),Oe=s("div"),Oe.innerHTML=we,Te=N(),he=s("ion-icon"),this.h()},l(M){e=c(M,"ION-CONTENT",{});var G=m(e);t=c(G,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),oe(t)!=="svelte-15ukrgn"&&(t.innerHTML=r),n=T(G),l=c(G,"ION-LIST",{});var K=m(l);f=c(K,"ION-ITEM",{});var B=m(f);d=c(B,"ION-AVATAR",{slot:!0});var Y=m(d);h=c(Y,"DIV",{class:!0,title:!0,style:!0});var ae=m(h);k=c(ae,"DIV",{class:!0,"data-svelte-h":!0}),oe(k)!=="svelte-3lvlrb"&&(k.textContent=g),ae.forEach(a),Y.forEach(a),u=T(B),p=c(B,"ION-LABEL",{button:!0});var de=m(p);b=c(de,"ION-TEXT",{color:!0});var J=m(b);O=c(J,"H3",{});var Z=m(O);R=Ie(Z,w),Z.forEach(a),J.forEach(a),A=T(de),q=c(de,"DIV",{class:!0,"data-svelte-h":!0}),oe(q)!=="svelte-gz9kb"&&(q.innerHTML=V),de.forEach(a),F=T(B),z=c(B,"ION-ICON",{icon:!0,slot:!0}),m(z).forEach(a),B.forEach(a),S=T(K);for(let le=0;le<E.length;le+=1)E[le].l(K);D=T(K),H=c(K,"ION-ITEM",{});var I=m(H);P=c(I,"ION-AVATAR",{slot:!0});var y=m(P);Q=c(y,"DIV",{class:!0,title:!0,style:!0});var j=m(Q);X=c(j,"DIV",{class:!0});var te=m(X);ne=Ie(te,ee),te.forEach(a),j.forEach(a),y.forEach(a),ve=T(I),ue=c(I,"ION-LABEL",{button:!0});var se=m(ue);_e=c(se,"ION-TEXT",{color:!0});var ge=m(_e);be=c(ge,"H3",{});var ye=m(be);me=Ie(ye,fe),ye.forEach(a),ge.forEach(a),ke=T(se),Oe=c(se,"DIV",{class:!0,"data-svelte-h":!0}),oe(Oe)!=="svelte-130ohbs"&&(Oe.innerHTML=we),se.forEach(a),Te=T(I),he=c(I,"ION-ICON",{icon:!0,slot:!0}),m(he).forEach(a),I.forEach(a),K.forEach(a),G.forEach(a),this.h()},h(){v(t,"slot","fixed"),$(k,"class","order svelte-egzizz"),$(h,"class","order-wrapper svelte-egzizz"),$(h,"title",_="$"+i[6].origin),L(h,"background-color",i[6].color),L(h,"color",Me(i[6].color)),v(d,"slot","start"),v(b,"color","#2e2e2e"),$(q,"class","sub svelte-egzizz"),v(p,"button",""),v(z,"icon",Re),v(z,"slot","end"),$(X,"class","order svelte-egzizz"),$(Q,"class","order-wrapper svelte-egzizz"),$(Q,"title",ie="$"+i[6].destination),L(Q,"background-color",i[6].color),L(Q,"color",Me(i[6].color)),v(P,"slot","start"),v(_e,"color","#2e2e2e"),$(Oe,"class","sub svelte-egzizz"),v(ue,"button",""),v(he,"icon",Re),v(he,"slot","end")},m(M,G){x(M,e,G),o(e,t),i[22](t),o(e,n),o(e,l),o(l,f),o(f,d),o(d,h),o(h,k),o(f,u),o(f,p),o(p,b),o(b,O),o(O,R),o(p,A),o(p,q),o(f,F),o(f,z),o(l,S);for(let K=0;K<E.length;K+=1)E[K]&&E[K].m(l,null);o(l,D),o(l,H),o(H,P),o(P,Q),o(Q,X),o(X,ne),o(H,ve),o(H,ue),o(ue,_e),o(_e,be),o(be,me),o(ue,ke),o(ue,Oe),o(H,Te),o(H,he),Ne||(Ce=[ce(t,"ionRefresh",i[10]),ce(p,"click",i[23]),ce(ue,"click",i[25])],Ne=!0)},p(M,G){G[0]&64&&_!==(_="$"+M[6].origin)&&$(h,"title",_),G[0]&64&&L(h,"background-color",M[6].color),G[0]&64&&L(h,"color",Me(M[6].color)),G[0]&64&&w!==(w=M[6].origin+"")&&Le(R,w),G[0]&331808&&(U=He(M[5]),E=xe(E,G,W,1,M,U,C,l,$e,Yt,D,Ft)),G[0]&32&&ee!==(ee=M[5].length+1+"")&&Le(ne,ee),G[0]&64&&ie!==(ie="$"+M[6].destination)&&$(Q,"title",ie),G[0]&64&&L(Q,"background-color",M[6].color),G[0]&64&&L(Q,"color",Me(M[6].color)),G[0]&64&&fe!==(fe=M[6].destination+"")&&Le(me,fe)},d(M){M&&a(e),i[22](null);for(let G=0;G<E.length;G+=1)E[G].d();Ne=!1,Be(Ce)}}}function Xt(i){let e;return{c(){e=s("span"),this.h()},l(t){e=c(t,"SPAN",{class:!0}),m(e).forEach(a),this.h()},h(){$(e,"class","notes svelte-egzizz")},m(t,r){x(t,e,r)},d(t){t&&a(e)}}}function Wt(i,e){let t,r,n,l,f=parseInt(e[45].pos)+1+"",d,h,k,g,_,u,p=e[45].title+"",b,O,w=e[45].support_list&&e[45].support_list.length||e[16](e[45]),R,A,q="",V,F,z,S,E=w&&Xt();function C(){return e[28](e[45])}return{key:i,first:null,c(){t=s("ion-item"),r=s("ion-avatar"),n=s("div"),l=s("div"),d=Ee(f),k=N(),g=s("ion-label"),_=s("ion-text"),u=s("h3"),b=Ee(p),O=N(),E&&E.c(),R=N(),A=s("div"),A.innerHTML=q,V=N(),F=s("ion-icon"),this.h()},l(D){t=c(D,"ION-ITEM",{});var H=m(t);r=c(H,"ION-AVATAR",{slot:!0});var P=m(r);n=c(P,"DIV",{class:!0,title:!0,style:!0});var Q=m(n);l=c(Q,"DIV",{class:!0});var X=m(l);d=Ie(X,f),X.forEach(a),Q.forEach(a),P.forEach(a),k=T(H),g=c(H,"ION-LABEL",{button:!0});var ee=m(g);_=c(ee,"ION-TEXT",{color:!0});var ne=m(_);u=c(ne,"H3",{});var ie=m(u);b=Ie(ie,p),O=T(ie),E&&E.l(ie),ie.forEach(a),ne.forEach(a),R=T(ee),A=c(ee,"DIV",{class:!0,"data-svelte-h":!0}),oe(A)!=="svelte-qaecoo"&&(A.innerHTML=q),ee.forEach(a),V=T(H),F=c(H,"ION-ICON",{icon:!0,slot:!0}),m(F).forEach(a),H.forEach(a),this.h()},h(){$(l,"class","order svelte-egzizz"),$(n,"class","order-wrapper svelte-egzizz"),$(n,"title",h=Xe(e[45].status)),L(n,"background-color",Pe(e[45].status,e[45].date_service)),L(n,"color",Me(Pe(e[45].status))),v(r,"slot","start"),v(_,"color","#2e2e2e"),$(A,"class","sub svelte-egzizz"),v(g,"button",""),v(F,"icon",Re),v(F,"slot","end"),this.first=t},m(D,H){x(D,t,H),o(t,r),o(r,n),o(n,l),o(l,d),o(t,k),o(t,g),o(g,_),o(_,u),o(u,b),o(u,O),E&&E.m(u,null),o(g,R),o(g,A),o(t,V),o(t,F),z||(S=ce(g,"click",C),z=!0)},p(D,H){e=D,H[0]&32&&f!==(f=parseInt(e[45].pos)+1+"")&&Le(d,f),H[0]&32&&h!==(h=Xe(e[45].status))&&$(n,"title",h),H[0]&32&&L(n,"background-color",Pe(e[45].status,e[45].date_service)),H[0]&32&&L(n,"color",Me(Pe(e[45].status))),H[0]&32&&p!==(p=e[45].title+"")&&Le(b,p),H[0]&32&&(w=e[45].support_list&&e[45].support_list.length||e[16](e[45])),w?E||(E=Xt(),E.c(),E.m(u,null)):E&&(E.d(1),E=null)},d(D){D&&a(t),E&&E.d(),z=!1,S()}}}function Jt(i){let e;return{c(){e=s("span"),this.h()},l(t){e=c(t,"SPAN",{class:!0}),m(e).forEach(a),this.h()},h(){$(e,"class","notes svelte-egzizz")},m(t,r){x(t,e,r)},d(t){t&&a(e)}}}function Yt(i,e){let t,r,n,l,f=parseInt(e[45].pos)+1+"",d,h,k,g,_,u,p=e[45].title+"",b,O,w=e[45].support_list&&e[45].support_list.length||e[16](e[45]),R,A,q="",V,F,z,S,E=w&&Jt();function C(){return e[24](e[45])}return{key:i,first:null,c(){t=s("ion-item"),r=s("ion-avatar"),n=s("div"),l=s("div"),d=Ee(f),k=N(),g=s("ion-label"),_=s("ion-text"),u=s("h3"),b=Ee(p),O=N(),E&&E.c(),R=N(),A=s("div"),A.innerHTML=q,V=N(),F=s("ion-icon"),this.h()},l(D){t=c(D,"ION-ITEM",{});var H=m(t);r=c(H,"ION-AVATAR",{slot:!0});var P=m(r);n=c(P,"DIV",{class:!0,title:!0,style:!0});var Q=m(n);l=c(Q,"DIV",{class:!0});var X=m(l);d=Ie(X,f),X.forEach(a),Q.forEach(a),P.forEach(a),k=T(H),g=c(H,"ION-LABEL",{button:!0});var ee=m(g);_=c(ee,"ION-TEXT",{color:!0});var ne=m(_);u=c(ne,"H3",{});var ie=m(u);b=Ie(ie,p),O=T(ie),E&&E.l(ie),ie.forEach(a),ne.forEach(a),R=T(ee),A=c(ee,"DIV",{class:!0,"data-svelte-h":!0}),oe(A)!=="svelte-qaecoo"&&(A.innerHTML=q),ee.forEach(a),V=T(H),F=c(H,"ION-ICON",{icon:!0,slot:!0}),m(F).forEach(a),H.forEach(a),this.h()},h(){$(l,"class","order svelte-egzizz"),$(n,"class","order-wrapper svelte-egzizz"),$(n,"title",h=Xe(e[45].status)),L(n,"background-color",Pe(e[45].status,e[45].date_service)),L(n,"color",Me(Pe(e[45].status))),v(r,"slot","start"),v(_,"color","#2e2e2e"),$(A,"class","sub svelte-egzizz"),v(g,"button",""),v(F,"icon",Re),v(F,"slot","end"),this.first=t},m(D,H){x(D,t,H),o(t,r),o(r,n),o(n,l),o(l,d),o(t,k),o(t,g),o(g,_),o(_,u),o(u,b),o(u,O),E&&E.m(u,null),o(g,R),o(g,A),o(t,V),o(t,F),z||(S=ce(g,"click",C),z=!0)},p(D,H){e=D,H[0]&32&&f!==(f=parseInt(e[45].pos)+1+"")&&Le(d,f),H[0]&32&&h!==(h=Xe(e[45].status))&&$(n,"title",h),H[0]&32&&L(n,"background-color",Pe(e[45].status,e[45].date_service)),H[0]&32&&L(n,"color",Me(Pe(e[45].status))),H[0]&32&&p!==(p=e[45].title+"")&&Le(b,p),H[0]&32&&(w=e[45].support_list&&e[45].support_list.length||e[16](e[45])),w?E||(E=Jt(),E.c(),E.m(u,null)):E&&(E.d(1),E=null)},d(D){D&&a(t),E&&E.d(),z=!1,S()}}}function ko(i){let e,t,r,n,l=`<ion-icon icon="${Ln}"></ion-icon>`,f,d,h,k=`<ion-icon icon="${zn}"></ion-icon>`,g,_,u=(i[6].name?i[6].name.toUpperCase():"")+"",p,b,O,w='<ion-segment-button value="list"><ion-label>Paradas</ion-label></ion-segment-button> <ion-segment-button value="map"><ion-label>Mapa</ion-label></ion-segment-button>',R,A,q,V;function F(E,C){if(E[9]==="list")return vo;if(E[9]==="map")return mo}let z=F(i),S=z&&z(i);return{c(){e=s("ion-header"),t=s("ion-toolbar"),r=s("ion-buttons"),n=s("ion-button"),n.innerHTML=l,f=N(),d=s("ion-buttons"),h=s("ion-button"),h.innerHTML=k,g=N(),_=s("ion-title"),p=Ee(u),b=N(),O=s("ion-segment"),O.innerHTML=w,R=N(),S&&S.c(),A=De(),this.h()},l(E){e=c(E,"ION-HEADER",{translucent:!0});var C=m(e);t=c(C,"ION-TOOLBAR",{});var D=m(t);r=c(D,"ION-BUTTONS",{slot:!0});var H=m(r);n=c(H,"ION-BUTTON",{title:!0,alt:!0,"data-svelte-h":!0}),oe(n)!=="svelte-7ppz3r"&&(n.innerHTML=l),H.forEach(a),f=T(D),d=c(D,"ION-BUTTONS",{slot:!0});var P=m(d);h=c(P,"ION-BUTTON",{"data-svelte-h":!0}),oe(h)!=="svelte-nf50hj"&&(h.innerHTML=k),P.forEach(a),g=T(D),_=c(D,"ION-TITLE",{});var Q=m(_);p=Ie(Q,u),Q.forEach(a),D.forEach(a),b=T(C),O=c(C,"ION-SEGMENT",{value:!0,"data-svelte-h":!0}),oe(O)!=="svelte-lue4c9"&&(O.innerHTML=w),C.forEach(a),R=T(E),S&&S.l(E),A=De(),this.h()},h(){v(n,"title","Atrás"),v(n,"alt","Atrás"),v(r,"slot","start"),v(d,"slot","end"),v(O,"value","list"),v(e,"translucent","")},m(E,C){x(E,e,C),o(e,t),o(t,r),o(r,n),o(t,f),o(t,d),o(d,h),o(t,g),o(t,_),o(_,p),o(e,b),o(e,O),x(E,R,C),S&&S.m(E,C),x(E,A,C),q||(V=[ce(n,"click",i[17]),ce(h,"click",i[20]),ce(O,"ionChange",i[21])],q=!0)},p(E,C){C[0]&64&&u!==(u=(E[6].name?E[6].name.toUpperCase():"")+"")&&Le(p,u),z===(z=F(E))&&S?S.p(E,C):(S&&S.d(1),S=z&&z(E),S&&(S.c(),S.m(A.parentNode,A)))},d(E){E&&(a(e),a(R),a(A)),S&&S.d(E),q=!1,Be(V)}}}function Oo(i){let e,t,r,n=i[2]&&qt(i);return{c(){e=N(),n&&n.c(),t=De(),this.h()},l(l){an("svelte-kn0kph",Rt.head).forEach(a),e=T(l),n&&n.l(l),t=De(),this.h()},h(){Rt.title="Rutaflow - Detalles de ruta"},m(l,f){x(l,e,f),n&&n.m(l,f),x(l,t,f),r=!0},p(l,f){l[2]?n?(n.p(l,f),f[0]&4&&lt(n,1)):(n=qt(l),n.c(),lt(n,1),n.m(t.parentNode,t)):n&&(pn(),at(n,1,1,()=>{n=null}),un())},i(l){r||(lt(n),r=!0)},o(l){at(n),r=!1},d(l){l&&(a(e),a(t)),n&&n.d(l)}}}function Pe(i,e=""){let t="#ffffff";return i==="pending"&&!e?t="#f2e300":i=="pending"&&e?t="#F6A833":i==="completed"&&(t="#44d900"),t}function Xe(i){let e="";return i=="pending"?e="Pendiente":i=="completed"&&(e="Completado"),e}function Me(i){i.slice(0,1)==="#"&&(i=i.slice(1)),i.length===3&&(i=i.split("").map(function(l){return l+l}).join(""));const e=parseInt(i.substr(0,2),16),t=parseInt(i.substr(2,2),16),r=parseInt(i.substr(4,2),16);return(e*299+t*587+r*114)/1e3>=128?"#414040":"#fff"}const No=i=>i.mandatory==="1",To=i=>i.img;function Co(i,e,t){let r;sn(i,An,U=>t(19,r=U));var n=this&&this.__awaiter||function(U,W,M,G){function K(B){return B instanceof M?B:new M(function(Y){Y(B)})}return new(M||(M=Promise))(function(B,Y){function ae(Z){try{J(G.next(Z))}catch(I){Y(I)}}function de(Z){try{J(G.throw(Z))}catch(I){Y(I)}}function J(Z){Z.done?B(Z.value):K(Z.value).then(ae,de)}J((G=G.apply(U,W||[])).next())})};let{routeId:l}=e,{driverId:f}=e,d=it,h=new Object,k=!0,g=!1,_=[],u={},p=[],b=[],O,w=!1,R="list",A;const q=()=>n(void 0,void 0,void 0,function*(){yield z(l),O.complete()});Ze(()=>n(void 0,void 0,void 0,function*(){yield z(l)}));function V(U){return n(this,void 0,void 0,function*(){if(t(9,R=U),R==="map"){yield cn(),A=document.getElementById("g_map");const W=new google.maps.Map(A,{zoom:8,center:{lat:20.6745683,lng:-103.3986104},mapId:"4504f8b37365c3d0"}),M=new google.maps.LatLngBounds,{AdvancedMarkerElement:G,PinElement:K}=yield google.maps.importLibrary("marker");navigator.geolocation?navigator.geolocation.getCurrentPosition(function(B){const Y=new google.maps.LatLng(B.coords.latitude,B.coords.longitude);new google.maps.Marker({position:Y,map:W,icon:{path:google.maps.SymbolPath.CIRCLE,fillColor:"#0062ff",fillOpacity:1,scale:6,strokeColor:"#ffffff",strokeWeight:2}}),new google.maps.Circle({strokeColor:"#00BFFF",strokeOpacity:.5,strokeWeight:1,fillColor:"#00BFFF",fillOpacity:.2,map:W,center:Y,radius:B.coords.accuracy}),M.extend(Y)},function(B){console.error("Error retrieving location:",B)}):console.error("Geolocation not supported by this browser."),u.lat1===u.lat2&&u.lon1===u.lon2?F(M,W,{lat:u.lat2,lon:u.lon2,color:u.color,title:u.destination},{type:"icon",iconClass:"icon-home",title:"Origen/Destino",glyph:`0,${String(_.length+1)}`}):(F(M,W,{lat:u.lat1,lon:u.lon1,color:u.color,title:u.origin},{type:"icon",iconClass:"icon-home",title:"Origen",glyph:"0"}),F(M,W,{lat:u.lat2,lon:u.lon2,color:u.color,title:u.destination},{type:"icon",iconClass:"icon-flag",title:"Destino",glyph:String(_.length+1)})),_.forEach((B,Y)=>{const ae=parseFloat(B.lat),de=parseFloat(B.lon),J=new google.maps.LatLng(ae,de),Z=new google.maps.Marker({position:{lat:ae,lng:de},map:W,title:B.title}),I=new K({background:Pe(B.status,B.date_service),borderColor:"#000",glyphColor:"#000",glyph:(parseInt(B.pos)+1).toString()});new G({map:W,position:J,content:I.element,title:"Parada "+(parseInt(B.pos)+1).toString()+": "+B.title}).addListener("click",function(j){E(B,!1)}),M.extend(Z.getPosition())}),W.fitBounds(M)}})}function F(U,W,M,G){return n(this,void 0,void 0,function*(){let K;const B=parseFloat(M.lat),Y=parseFloat(M.lon),ae=new google.maps.LatLng(B,Y),{AdvancedMarkerElement:de,PinElement:J}=yield google.maps.importLibrary("marker");G.type=="icon"?(K=document.createElement("i"),K.className=`${G.iconClass} icon`,K.style.fontSize="14px",K.style.color=Me(M.color),K.style.fontWeight="600"):G.type=="text";const Z=new google.maps.Marker({position:{lat:B,lng:Y},map:W,title:`${G.title}. ${M.title}`}),I=new J({background:M.color,borderColor:"#000",glyphColor:Me(M.color),glyph:G.glyph});return new de({map:W,position:ae,content:I.element,title:G.title+": "+M.title}).addListener("click",function(j){C(u,G.title=="Destino"||G.title=="Origen/Destino")}),Z})}function z(U){return n(this,void 0,void 0,function*(){let W=new FormData;W.append("id_route",U),W=ne(W);try{const G=yield(yield fetch(`${d}api/admin/report/seguimiento_list.php`,{method:"POST",body:W})).json();t(6,u=G.data.seguimiento_list[0]),t(5,_=G.data.event_list),t(7,p=G.data.checklist),b=G.data.expenses,u&&t(4,g=u.km_inicial=="0"&&u.gas_inicial=="0"),t(3,k=!1)}catch(M){t(3,k=!1),console.error("Error fetching data:",M)}})}const S=U=>new Promise((W,M)=>{let G=new FormData;G.append("id_route",U.id_route),G.append("id_event",U.id_event),G=ne(G),fetch(`${d}api/admin/evidence/evidence_by_event.php`,{method:"POST",body:G}).then(K=>K.json()).then(K=>{W(K.data.event_evidence[0])}).catch(K=>{console.error("Error fetching data:",K),M(K)})}),E=(U,W)=>{S(U).then(M=>{M&&(U.img=M.img,U.driver_comments=M.driver_comments,U.comments=M.comments),Ue("modal-delivery-info",St,{delivery:U,isLast:W}).then(G=>{}).finally(()=>{z(l)})})},C=(U,W)=>{var M=new Object;W?M={title:U.destination,line1:U.dest_address}:M={title:U.origin,line1:U.origin_address},M.client_name=U.client_name,M.client_phone=U.tel,M.id_route=U.id_route;var G=!0;Ue("modal-delivery-info",St,{delivery:M,isLast:W,flag:G})},D=(U,W,M)=>{var G=!1;return w||(w=!0,Ue("modal-checklist",en,{checklist:U,driverId:W,routeId:M,isLast:G}).then(K=>{w=!1}),Q(M,"checklist")),""},H=U=>n(void 0,void 0,void 0,function*(){return yield z(U),b.length>0?Ue("modal-expense-detail",po,{routeId:U,expenses:b}).then(W=>{}):Ue("modal-expense",ut,{routeId:U}).then(W=>{}),""}),P=U=>{if(U.tracking_type=="subscription"){if(U.subscriber_info&&U.payment_type==="cash"&&new Date(U.subscriber_info.payment_next)<new Date)return!0}else if(U.tracking_type=="ecommerce"&&Number(U.payment_pending)>0)return!0;return!1};function Q(U,W){let M=new FormData;return M.append("id_route",U),M.append("status",W),M=ne(M),fetch(`${d}api/admin/route/change_status.php`,{method:"POST",body:M}).then(G=>G.json()).then(G=>{}).catch(G=>{console.error("Error fetching data:",G)}),""}const X=()=>{h.type=="super"||h.type=="admin"?qe("/drivers/me"):h.id_driver&&qe(`/drivers/${h.id_driver}`)},ee=(U,W)=>n(void 0,void 0,void 0,function*(){yield(yield je.create({header:U||"Error",message:W||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()});function ne(U){return U.append("token",h.token),U.append("id_user_over",h.id_user),U}const ie=()=>H(l),ve=U=>V(U.detail.value);function ue(U){Se[U?"unshift":"push"](()=>{O=U,t(8,O)})}const _e=()=>{C(u,!1)},be=U=>{const W=_.findIndex(Y=>Y.id_event===U.id_event),M=W===0,G=W>0?_[W-1]:null,K=M||G&&G.img!==null,B=U.img!==null&&U.img!=="";K||M&&!B?E(U,!1):ee("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")},fe=()=>{C(u,!0)};function me(U){Se[U?"unshift":"push"](()=>{O=U,t(8,O)})}const ke=()=>{C(u,!1)},Oe=U=>{const W=_.findIndex(Y=>Y.id_event===U.id_event),M=W===0,G=W>0?_[W-1]:null,K=M||G&&G.img!==null,B=U.img!==null&&U.img!=="";K||M&&!B?E(U,!1):ee("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")},we=()=>{C(u,!0)};function Te(U){Se[U?"unshift":"push"](()=>{O=U,t(8,O)})}const he=()=>{C(u,!1)},Ne=U=>{const W=_.findIndex(Y=>Y.id_event===U.id_event),M=W===0,G=W>0?_[W-1]:null,K=M||G&&G.img!==null,B=U.img!==null&&U.img!=="";K||M&&!B?E(U,!1):ee("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")},Ce=()=>{C(u,!0)};return i.$$set=U=>{"routeId"in U&&t(0,l=U.routeId),"driverId"in U&&t(1,f=U.driverId)},i.$$.update=()=>{i.$$.dirty[0]&524293&&(t(0,{routeId:l,driverId:f}=r.params,l,(t(1,f),t(19,r),t(2,h),t(0,l))),t(2,h=JSON.parse(localStorage.getItem("userSession"))),h?h.id_user&&(h.type=="admin"||h.type=="super")?(z(l),qe(`/drivers/me/routes/${l}`)):h.id_user&&h.id_driver&&(z(l),qe(`/drivers/${h.id_driver}/routes/${l}`)):qe("/"))},[l,f,h,k,g,_,u,p,O,R,q,V,E,C,D,H,P,X,ee,r,ie,ve,ue,_e,be,fe,me,ke,Oe,we,Te,he,Ne,Ce]}class Do extends Je{constructor(e){super(),Ye(this,e,Co,Oo,We,{routeId:0,driverId:1},null,[-1,-1])}}export{Do as component};

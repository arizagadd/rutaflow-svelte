import{s as ve,j as R,k as H,l as be,h as c,m as C,i as g,p as ke,o as ge,e as p,t as U,b as m,q as k,r as V,d as $,v as F,w as _,x as ee,y as Q,z as Ie,A as Ee,n as ie,f as P,B as G,C as _e}from"../chunks/index.BYLndrM5.js";import{S as ye,i as Ne,t as x,a as oe,c as Oe,b as Te,d as Ae,m as we,e as De,g as Se}from"../chunks/index.BNHbygFo.js";import{l as Le,p as Re,e as te,u as de,d as he}from"../chunks/index.BkNRZlP6.js";import"../chunks/index-48209844.IIRtDZyg.js";import{I as Ce,a as He}from"../chunks/IonPage.KvUD72q2.js";import{g as W}from"../chunks/entry.DD9R0qop.js";import"../chunks/authStore.Dl96eK1q.js";function re(t,e,o){const l=t.slice();return l[19]=e[o],l}function se(t,e,o){const l=t.slice();return l[19]=e[o],l}function ae(t){let e,o;return e=new Ce({props:{$$slots:{default:[je]},$$scope:{ctx:t}}}),{c(){Te(e.$$.fragment)},l(l){Ae(e.$$.fragment,l)},m(l,n){we(e,l,n),o=!0},p(l,n){const a={};n&16777279&&(a.$$scope={dirty:n,ctx:l}),e.$set(a)},i(l){o||(x(e.$$.fragment,l),o=!0)},o(l){oe(e.$$.fragment,l),o=!1},d(l){De(e,l)}}}function Me(t){let e=[],o=new Map,l,n=te(t[2].filter(t[13]));const a=i=>i[19].id_route;for(let i=0;i<n.length;i+=1){let r=re(t,n,i),s=a(r);o.set(s,e[i]=ue(s,r))}return{c(){for(let i=0;i<e.length;i+=1)e[i].c();l=H()},l(i){for(let r=0;r<e.length;r+=1)e[r].l(i);l=H()},m(i,r){for(let s=0;s<e.length;s+=1)e[s]&&e[s].m(i,r);g(i,l,r)},p(i,r){r&901&&(n=te(i[2].filter(i[13])),e=de(e,r,a,1,i,n,o,l.parentNode,he,ue,l,re))},d(i){i&&c(l);for(let r=0;r<e.length;r+=1)e[r].d(i)}}}function Be(t){let e=[],o=new Map,l,n=te(t[2]);const a=i=>i[19].id_route;for(let i=0;i<n.length;i+=1){let r=se(t,n,i),s=a(r);o.set(s,e[i]=ce(s,r))}return{c(){for(let i=0;i<e.length;i+=1)e[i].c();l=H()},l(i){for(let r=0;r<e.length;r+=1)e[r].l(i);l=H()},m(i,r){for(let s=0;s<e.length;s+=1)e[s]&&e[s].m(i,r);g(i,l,r)},p(i,r){r&900&&(n=te(i[2]),e=de(e,r,a,1,i,n,o,l.parentNode,he,ce,l,se))},d(i){i&&c(l);for(let r=0;r<e.length;r+=1)e[r].d(i)}}}function Pe(t){let e=t[8]("false")+"",o;return{c(){o=U(e)},l(l){o=V(l,e)},m(l,n){g(l,o,n)},p:ie,d(l){l&&c(o)}}}function Ue(t){let e=t[8]("true")+"",o,l,n;function a(s,u){return s[19].status!="completed"&&s[19].status!="cancelled"?qe:Ve}let i=a(t),r=i(t);return{c(){o=U(e),l=R(),r.c(),n=H()},l(s){o=V(s,e),l=C(s),r.l(s),n=H()},m(s,u){g(s,o,u),g(s,l,u),r.m(s,u),g(s,n,u)},p(s,u){i===(i=a(s))&&r?r.p(s,u):(r.d(1),r=i(s),r&&(r.c(),r.m(n.parentNode,n)))},d(s){s&&(c(o),c(l),c(n)),r.d(s)}}}function Ve(t){let e=t[8]("false")+"",o;return{c(){o=U(e)},l(l){o=V(l,e)},m(l,n){g(l,o,n)},p:ie,d(l){l&&c(o)}}}function qe(t){let e,o,l,n,a=t[9](t[19].name.charAt(0))+"",i,r,s,u,A,y=t[19].name+"",b,B,N,I,E=t[19].date_start+"",w,q,f,O,M,D;return{c(){e=p("ion-item"),o=p("ion-avatar"),l=p("div"),n=p("div"),i=U(a),s=R(),u=p("ion-label"),A=p("h2"),b=U(y),B=R(),N=p("h3"),I=U("Inicio: "),w=U(E),q=R(),f=p("div"),O=R(),this.h()},l(S){e=m(S,"ION-ITEM",{button:!0});var v=k(e);o=m(v,"ION-AVATAR",{slot:!0});var L=k(o);l=m(L,"DIV",{class:!0,style:!0,title:!0});var h=k(l);n=m(h,"DIV",{class:!0,style:!0});var d=k(n);i=V(d,a),d.forEach(c),h.forEach(c),L.forEach(c),s=C(v),u=m(v,"ION-LABEL",{});var T=k(u);A=m(T,"H2",{});var z=k(A);b=V(z,y),z.forEach(c),B=C(T),N=m(T,"H3",{class:!0});var j=k(N);I=V(j,"Inicio: "),w=V(j,E),j.forEach(c),T.forEach(c),q=C(v),f=m(v,"DIV",{slot:!0}),k(f).forEach(c),O=C(v),v.forEach(c),this.h()},h(){P(n,"class","route-symbol svelte-1xh3ip"),P(n,"style",""),P(l,"class","route-color svelte-1xh3ip"),G(l,"background-color",Y(t[19].status)),G(l,"color",ne(Y(t[19].status))),P(l,"title",r=le(t[19].status)),F(o,"slot","start"),P(N,"class","text-muted svelte-1xh3ip"),P(f,"slot","end"),F(e,"button","")},m(S,v){g(S,e,v),_(e,o),_(o,l),_(l,n),_(n,i),_(e,s),_(e,u),_(u,A),_(A,b),_(u,B),_(u,N),_(N,I),_(N,w),_(e,q),_(e,f),_(e,O),M||(D=ee(e,"click",function(){_e(t[7](t[19].id_route,t[19].status))&&t[7](t[19].id_route,t[19].status).apply(this,arguments)}),M=!0)},p(S,v){t=S,v&5&&a!==(a=t[9](t[19].name.charAt(0))+"")&&Q(i,a),v&5&&G(l,"background-color",Y(t[19].status)),v&5&&G(l,"color",ne(Y(t[19].status))),v&5&&r!==(r=le(t[19].status))&&P(l,"title",r),v&5&&y!==(y=t[19].name+"")&&Q(b,y),v&5&&E!==(E=t[19].date_start+"")&&Q(w,E)},d(S){S&&c(e),M=!1,D()}}}function ue(t,e){let o,l,n;function a(s,u){return u&5&&(l=null),l==null&&(l=!!pe(s[19].date_start)),l?Ue:Pe}let i=a(e,-1),r=i(e);return{key:t,first:null,c(){o=H(),r.c(),n=H(),this.h()},l(s){o=H(),r.l(s),n=H(),this.h()},h(){this.first=o},m(s,u){g(s,o,u),r.m(s,u),g(s,n,u)},p(s,u){e=s,i===(i=a(e,u))&&r?r.p(e,u):(r.d(1),r=i(e),r&&(r.c(),r.m(n.parentNode,n)))},d(s){s&&(c(o),c(n)),r.d(s)}}}function ze(t){let e=t[8]("false")+"",o;return{c(){o=U(e)},l(l){o=V(l,e)},m(l,n){g(l,o,n)},p:ie,d(l){l&&c(o)}}}function Fe(t){let e=t[8]("true")+"",o,l,n,a,i,r,s=t[9](t[19].name.charAt(0))+"",u,A,y,b,B,N=(t[19].name?t[19].name.toUpperCase():"")+"",I,E,w,q,f=t[19].date_start+"",O,M,D,S,v,L;return{c(){o=U(e),l=R(),n=p("ion-item"),a=p("ion-avatar"),i=p("div"),r=p("div"),u=U(s),y=R(),b=p("ion-label"),B=p("h2"),I=U(N),E=R(),w=p("h3"),q=U("Inicio: "),O=U(f),M=R(),D=p("div"),S=R(),this.h()},l(h){o=V(h,e),l=C(h),n=m(h,"ION-ITEM",{button:!0});var d=k(n);a=m(d,"ION-AVATAR",{slot:!0});var T=k(a);i=m(T,"DIV",{class:!0,style:!0,title:!0});var z=k(i);r=m(z,"DIV",{class:!0,style:!0});var j=k(r);u=V(j,s),j.forEach(c),z.forEach(c),T.forEach(c),y=C(d),b=m(d,"ION-LABEL",{});var K=k(b);B=m(K,"H2",{});var X=k(B);I=V(X,N),X.forEach(c),E=C(K),w=m(K,"H3",{class:!0});var J=k(w);q=V(J,"Inicio: "),O=V(J,f),J.forEach(c),K.forEach(c),M=C(d),D=m(d,"DIV",{slot:!0}),k(D).forEach(c),S=C(d),d.forEach(c),this.h()},h(){P(r,"class","route-symbol svelte-1xh3ip"),P(r,"style",""),P(i,"class","route-color svelte-1xh3ip"),G(i,"background-color",Y(t[19].status)),G(i,"color",ne(Y(t[19].status))),P(i,"title",A=le(t[19].status)),F(a,"slot","start"),P(w,"class","text-muted svelte-1xh3ip"),P(D,"slot","end"),F(n,"button","")},m(h,d){g(h,o,d),g(h,l,d),g(h,n,d),_(n,a),_(a,i),_(i,r),_(r,u),_(n,y),_(n,b),_(b,B),_(B,I),_(b,E),_(b,w),_(w,q),_(w,O),_(n,M),_(n,D),_(n,S),v||(L=ee(n,"click",function(){_e(t[7](t[19].id_route,t[19].status))&&t[7](t[19].id_route,t[19].status).apply(this,arguments)}),v=!0)},p(h,d){t=h,d&4&&s!==(s=t[9](t[19].name.charAt(0))+"")&&Q(u,s),d&4&&G(i,"background-color",Y(t[19].status)),d&4&&G(i,"color",ne(Y(t[19].status))),d&4&&A!==(A=le(t[19].status))&&P(i,"title",A),d&4&&N!==(N=(t[19].name?t[19].name.toUpperCase():"")+"")&&Q(I,N),d&4&&f!==(f=t[19].date_start+"")&&Q(O,f)},d(h){h&&(c(o),c(l),c(n)),v=!1,L()}}}function ce(t,e){let o,l,n;function a(s,u){return u&4&&(l=null),l==null&&(l=!!pe(s[19].date_start)),l?Fe:ze}let i=a(e,-1),r=i(e);return{key:t,first:null,c(){o=H(),r.c(),n=H(),this.h()},l(s){o=H(),r.l(s),n=H(),this.h()},h(){this.first=o},m(s,u){g(s,o,u),r.m(s,u),g(s,n,u)},p(s,u){e=s,i===(i=a(e,u))&&r?r.p(e,u):(r.d(1),r=i(e),r&&(r.c(),r.m(n.parentNode,n)))},d(s){s&&(c(o),c(n)),r.d(s)}}}function fe(t){let e,o='<ion-row class="h-full items-center"><ion-col class="text-center"><h2 class="text-3xl text-muted mb-4 svelte-1xh3ip">No hay rutas pendientes para hoy</h2> <p class="text-muted svelte-1xh3ip">Espere indicaciones de su supervisor</p></ion-col></ion-row>';return{c(){e=p("ion-grid"),e.innerHTML=o,this.h()},l(l){e=m(l,"ION-GRID",{class:!0,"data-svelte-h":!0}),$(e)!=="svelte-3d9uou"&&(e.innerHTML=o),this.h()},h(){F(e,"class","ion-text-center h-full")},m(l,n){g(l,e,n)},d(l){l&&c(e)}}}function je(t){let e,o,l,n,a=t[1].name+"",i,r,s,u="RUTAS DEL DÍA",A,y,b,B=`<ion-icon icon="${Le}"></ion-icon>`,N,I,E,w='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Jale para actualizar" refreshing-spinner="circles" refreshing-text="Actualizando..."></ion-refresher-content>',q,f,O,M,D;function S(d,T){return d[0]=="me"&&d[4]?Be:Me}let v=S(t),L=v(t),h=!t[3]&&fe();return{c(){e=p("ion-header"),o=p("ion-toolbar"),l=p("ion-buttons"),n=p("ion-button"),i=U(a),r=R(),s=p("ion-title"),s.textContent=u,A=R(),y=p("ion-buttons"),b=p("ion-button"),b.innerHTML=B,N=R(),I=p("ion-content"),E=p("ion-refresher"),E.innerHTML=w,q=R(),f=p("ion-list"),L.c(),O=R(),h&&h.c(),this.h()},l(d){e=m(d,"ION-HEADER",{translucent:!0});var T=k(e);o=m(T,"ION-TOOLBAR",{});var z=k(o);l=m(z,"ION-BUTTONS",{slot:!0});var j=k(l);n=m(j,"ION-BUTTON",{});var K=k(n);i=V(K,a),K.forEach(c),j.forEach(c),r=C(z),s=m(z,"ION-TITLE",{"data-svelte-h":!0}),$(s)!=="svelte-1oi1i0m"&&(s.textContent=u),A=C(z),y=m(z,"ION-BUTTONS",{slot:!0});var X=k(y);b=m(X,"ION-BUTTON",{title:!0,alt:!0,"data-svelte-h":!0}),$(b)!=="svelte-1itonhq"&&(b.innerHTML=B),X.forEach(c),z.forEach(c),T.forEach(c),N=C(d),I=m(d,"ION-CONTENT",{});var J=k(I);E=m(J,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),$(E)!=="svelte-1wkherr"&&(E.innerHTML=w),q=C(J),f=m(J,"ION-LIST",{});var Z=k(f);L.l(Z),O=C(Z),h&&h.l(Z),Z.forEach(c),J.forEach(c),this.h()},h(){F(l,"slot","secondary"),F(b,"title","Salir"),F(b,"alt","Salir"),F(y,"slot","primary"),F(e,"translucent",""),F(E,"slot","fixed")},m(d,T){g(d,e,T),_(e,o),_(o,l),_(l,n),_(n,i),_(o,r),_(o,s),_(o,A),_(o,y),_(y,b),g(d,N,T),g(d,I,T),_(I,E),t[12](E),_(I,q),_(I,f),L.m(f,null),_(f,O),h&&h.m(f,null),M||(D=[ee(b,"click",t[10]),ee(E,"ionRefresh",t[6])],M=!0)},p(d,T){T&2&&a!==(a=d[1].name+"")&&Q(i,a),v===(v=S(d))&&L?L.p(d,T):(L.d(1),L=v(d),L&&(L.c(),L.m(f,O))),d[3]?h&&(h.d(1),h=null):h||(h=fe(),h.c(),h.m(f,null))},d(d){d&&(c(e),c(N),c(I)),t[12](null),L.d(),h&&h.d(),M=!1,Ie(D)}}}function Je(t){let e,o,l,n=t[1]&&ae(t);return{c(){e=R(),n&&n.c(),o=H(),this.h()},l(a){be("svelte-qavk4j",document.head).forEach(c),e=C(a),n&&n.l(a),o=H(),this.h()},h(){document.title="Rutas - Rutaflow"},m(a,i){g(a,e,i),n&&n.m(a,i),g(a,o,i),l=!0},p(a,[i]){a[1]?n?(n.p(a,i),i&2&&x(n,1)):(n=ae(a),n.c(),x(n,1),n.m(o.parentNode,o)):n&&(Se(),oe(n,1,1,()=>{n=null}),Oe())},i(a){l||(x(n),l=!0)},o(a){oe(n),l=!1},d(a){a&&(c(e),c(o)),n&&n.d(a)}}}function pe(t){var e=me();const o=t.split(" ")[0];return e===o}function Y(t){let e="#ffffff";return t==="pending"?e="#FAD733":t==="completed"?e="#27C24C":t=="enroute"?e="#3BBAC2":t=="paused"?e="#949DB9":t=="cancelled"?e="#F05050":t=="checklist"?e="#F6A833":t=="checklist-pending"&&(e="#E98C00"),e}function le(t){let e="";return t==="pending"?e="Pendiente":t==="completed"?e="Completado":t=="enroute"?e="En ruta":t=="paused"?e="Pausado":t=="cancelled"?e="Cancelado":t=="checklist"?e="En checklist":t=="checklist-pending"&&(e="Pendiente de aprobar checklist"),e}function ne(t){t.slice(0,1)==="#"&&(t=t.slice(1)),t.length===3&&(t=t.split("").map(function(a){return a+a}).join(""));const e=parseInt(t.substr(0,2),16),o=parseInt(t.substr(2,2),16),l=parseInt(t.substr(4,2),16);return(e*299+o*587+l*114)/1e3>=128?"#414040":"#fff"}function me(){var t=new Date,e=t.getDate(),o=t.getMonth()+1,l=t.getFullYear();return e<10&&(e="0"+e),o<10&&(o="0"+o),t=l+"-"+o+"-"+e,t}function Ge(t,e,o){let l;ke(t,Re,f=>o(11,l=f));let{driverId:n}=e,a=[],i=!1,r=!1,s=new Object,u;const A=async()=>{await y(),u.complete()};ge(async()=>{await A()});function y(f){var O=me();const M=new FormData;M.append("actual_date",O),fetch("https://dev.rutaflow.com/api/admin/report/seguimiento_list.php",{method:"POST",body:M}).then(D=>D.json()).then(D=>{const S=D;o(2,a=S.data.seguimiento_list),S.data.event_list}).catch(D=>{console.error("Error fetching data:",D)})}function b(f,O){O=="checklist-pending"?I("Checklist Pendiente de Autorizar","La lista de requerimientos de ruta está en revisión, podrás inciar la ruta una vez autorizado el checklist."):W(`/drivers/${n}/routes/${f}`)}function B(f){return f=="true"?o(3,i=!0):o(3,i=!1),""}const N=f=>f.charAt(0).toUpperCase()+f.slice(1),I=async(f,O)=>{await(await He.create({header:f||"Error",message:O||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()},E=()=>{W("/"),o(4,r=!1),localStorage.removeItem("userSession")};function w(f){Ee[f?"unshift":"push"](()=>{u=f,o(5,u)})}const q=f=>f.id_driver===n;return t.$$set=f=>{"driverId"in f&&o(0,n=f.driverId)},t.$$.update=()=>{if(t.$$.dirty&2051){o(0,{driverId:n}=l.params,n);const f=localStorage.getItem("userSession");o(1,s=JSON.parse(f)),s?n=="me"&&s.id_user?s.type=="admin"||s.type=="superadmin"?(W("/drivers/me"),y(),o(4,r=!0)):(I("Usuario no autorizado","Este usuario no tiene acceso a la app de Rutaflow, entrar en contacto con soporte"),W("/")):s&&n&&(W(`/drivers/${s.id_driver}`),y()):(I("Sesión cerrada","Será redireccionado para volver a ingresar"),W("/"))}},[n,s,a,i,r,u,A,b,B,N,E,l,w,q]}class xe extends ye{constructor(e){super(),Ne(this,e,Ge,Je,ve,{driverId:0})}}export{xe as component};

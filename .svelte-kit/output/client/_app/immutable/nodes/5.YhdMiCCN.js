import{Z as kt,s as Je,e as d,j as w,b as f,q as g,d as le,h as c,m as N,v as b,i as W,w as r,x as fe,n as Me,z as Ue,_ as Tn,k as Ae,B as u,o as et,$ as It,t as Oe,r as ye,f as j,a0 as Cn,a1 as lt,A as De,y as Pe,F as Ot,J as Ln,a2 as mt,a3 as Fe,a4 as yt,a5 as wt,l as Mn,p as Sn}from"../chunks/index.CdEBkEwf.js";import{S as Ye,i as Qe,t as $e,a as it,b as vn,d as gn,m as bn,e as En,c as Pn,g as An}from"../chunks/index.c2pjNB5R.js";import{e as He,u as rt,d as st,g as Ve,a as Ge,h as ze,b as Dn,c as xn,i as kn,f as Bn,j as In,k as Un,m as Hn,n as ht,t as vt,s as Rn,o as zn,q as Nt,r as On,v as yn,w as Tt,x as je,y as Vn,z as Fn,A as Ct,B as jn,C as Wn,I as qn,D as Gn,E as Kn,F as Xn,p as Jn}from"../chunks/index.Dm0_WTgQ.js";import"../chunks/index-48209844.IIRtDZyg.js";import{m as tt,D as at,a as qe,W as Yn,b as Qn}from"../chunks/overlays-33ae3ea0.nC7PV_6b.js";import{q as Zn,t as $n}from"../chunks/ion-modal.CsJaVgKZ.js";import{g as Ze}from"../chunks/entry.cQM2eaz1.js";const ei=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global,ti=(l,e)=>{if(!customElements.get(l)){class t extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const n={};for(const o of this.attributes)n[o.name]=o.value;new e({target:this.shadowRoot,props:n})}}customElements.define(l,t)}},ni=function(l){return document.createElement(l).constructor!==HTMLElement},ii=(l,e)=>{ni(l)||ti(l,e)},We=async(l,e,t)=>{Zn(),$n(),ii(l,e);const i=await tt.create({component:l,componentProps:t});return i.present(),await i.onWillDismiss()};let nt=kt({km_inicial:[],gas_inicial:[],km_final:[],gas_final:[]}),wn=kt({flag:[]});function oi(l){let e,t,i,n,o="Cancelar",s,a,h="Captura de Km/Gas",E,m,_,v="Confirmar",p,k,O,y,B,P,R;return{c(){e=d("ion-header"),t=d("ion-toolbar"),i=d("ion-buttons"),n=d("ion-button"),n.textContent=o,s=w(),a=d("ion-title"),a.textContent=h,E=w(),m=d("ion-buttons"),_=d("ion-button"),_.textContent=v,p=w(),k=d("ion-content"),O=d("ion-item"),y=d("ion-input"),this.h()},l(U){e=f(U,"ION-HEADER",{translucent:!0});var Q=g(e);t=f(Q,"ION-TOOLBAR",{});var q=g(t);i=f(q,"ION-BUTTONS",{slot:!0});var L=g(i);n=f(L,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),le(n)!=="svelte-17pq4f4"&&(n.textContent=o),L.forEach(c),s=N(q),a=f(q,"ION-TITLE",{"data-svelte-h":!0}),le(a)!=="svelte-1yhkaq7"&&(a.textContent=h),E=N(q),m=f(q,"ION-BUTTONS",{slot:!0});var H=g(m);_=f(H,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),le(_)!=="svelte-cm6j4s"&&(_.textContent=v),H.forEach(c),q.forEach(c),Q.forEach(c),p=N(U),k=f(U,"ION-CONTENT",{fullscreen:!0});var x=g(k);O=f(x,"ION-ITEM",{});var I=g(O);y=f(I,"ION-INPUT",{class:!0,inputmode:!0,pattern:!0,type:!0,placeholder:!0,value:!0,required:!0});var A=g(y);A.forEach(c),I.forEach(c),x.forEach(c),this.h()},h(){b(n,"color","medium"),b(i,"slot","start"),b(_,"strong",""),b(m,"slot","end"),b(e,"translucent",""),b(y,"class","fin-km"),b(y,"inputmode","numeric"),b(y,"pattern","[0-9]*"),b(y,"type","number"),b(y,"placeholder",B="Ingresa "+l[0]+" actual"),b(y,"value",l[1]),b(y,"required",""),b(k,"fullscreen","")},m(U,Q){W(U,e,Q),r(e,t),r(t,i),r(i,n),r(t,s),r(t,a),r(t,E),r(t,m),r(m,_),W(U,p,Q),W(U,k,Q),r(k,O),r(O,y),P||(R=[fe(n,"click",l[2]),fe(_,"click",l[3]),fe(y,"input",l[4])],P=!0)},p(U,[Q]){Q&1&&B!==(B="Ingresa "+U[0]+" actual")&&b(y,"placeholder",B),Q&2&&b(y,"value",U[1])},i:Me,o:Me,d(U){U&&(c(e),c(p),c(k)),P=!1,Ue(R)}}}function li(l,e,t){const i=Tn();let o=document.querySelector("ion-modal").componentProps.data_type,s="";wn.subscribe(_=>{o=_.flag[0],o=="km_final"||o=="km_inicial"?t(0,s="kilometraje"):t(0,s="litros de gasolina")});let a=0;function h(){tt.dismiss()}function E(){i("modalResult",{data:"Your data",role:"confirm"}),o=="km_inicial"?nt.update(v=>({...v,km_inicial:[a]})):o=="gas_inicial"?nt.update(v=>({...v,gas_inicial:[a]})):o=="km_final"?nt.update(v=>({...v,km_final:[a]})):o=="gas_final"&&nt.update(v=>({...v,gas_final:[a]})),h()}return[s,a,h,E,_=>t(1,a=_.target.value)]}class ri extends Ye{constructor(e){super(),Qe(this,e,li,oi,Je,{})}}const gt=kt({items:[],checkedIndices:[],mandatory:[]});function Pt(l,e,t){const i=l.slice();return i[56]=e[t],i[57]=e,i[58]=t,i}function si(l){let e,t,i,n,o,s="Kilometraje inicial",a,h,E=l[0]?l[0]+" km.":"Cargar km",m,_,v,p,k,O,y,B="Gasolina inicial (litros)",P,R,U=l[1]?l[1]+" litros":"Cargar gas",Q,q,L,H;return q=It(l[22][0]),{c(){e=d("ion-item"),t=d("ion-label"),i=d("input"),n=w(),o=d("p"),o.textContent=s,a=w(),h=d("ion-button"),m=Oe(E),_=w(),v=d("ion-item"),p=d("ion-label"),k=d("input"),O=w(),y=d("p"),y.textContent=B,P=w(),R=d("ion-button"),Q=Oe(U),this.h()},l(x){e=f(x,"ION-ITEM",{});var I=g(e);t=f(I,"ION-LABEL",{style:!0});var A=g(t);i=f(A,"INPUT",{id:!0,style:!0,type:!0}),n=N(A),o=f(A,"P",{style:!0,"data-svelte-h":!0}),le(o)!=="svelte-88twxi"&&(o.textContent=s),A.forEach(c),a=N(I),h=f(I,"ION-BUTTON",{fill:!0,size:!0,class:!0,"aria-selected":!0});var V=g(h);m=ye(V,E),V.forEach(c),I.forEach(c),_=N(x),v=f(x,"ION-ITEM",{});var M=g(v);p=f(M,"ION-LABEL",{style:!0});var X=g(p);k=f(X,"INPUT",{id:!0,style:!0,type:!0}),O=N(X),y=f(X,"P",{style:!0,"data-svelte-h":!0}),le(y)!=="svelte-1ux30eb"&&(y.textContent=B),X.forEach(c),P=N(M),R=f(M,"ION-BUTTON",{fill:!0,class:!0,size:!0,style:!0});var J=g(R);Q=ye(J,U),J.forEach(c),M.forEach(c),this.h()},h(){j(i,"id","chkbox-km-ini"),u(i,"pointer-events","auto"),j(i,"type","checkbox"),i.required=!0,u(o,"margin-left","10px"),u(t,"display","flex"),b(h,"fill","outline"),b(h,"size","small"),b(h,"class","loadKmInicial"),b(h,"aria-selected",""),j(k,"id","chkbox-gas-ini"),u(k,"pointer-events","auto"),j(k,"type","checkbox"),k.required=!0,u(y,"margin-left","10px"),u(p,"display","flex"),b(R,"fill","outline"),b(R,"class","loadGasInicial"),b(R,"size","small"),u(R,"height","16px "),q.p(i,k)},m(x,I){W(x,e,I),r(e,t),r(t,i),i.checked=~(l[4]||[]).indexOf(i.__value),l[29](i),r(t,n),r(t,o),r(e,a),r(e,h),r(h,m),W(x,_,I),W(x,v,I),r(v,p),r(p,k),l[31](k),k.checked=~(l[4]||[]).indexOf(k.__value),r(p,O),r(p,y),r(v,P),r(v,R),r(R,Q),L||(H=[fe(i,"change",l[28]),fe(h,"click",l[30]),fe(k,"change",l[32]),fe(R,"click",l[33])],L=!0)},p(x,I){I[0]&16&&(i.checked=~(x[4]||[]).indexOf(i.__value)),I[0]&1&&E!==(E=x[0]?x[0]+" km.":"Cargar km")&&Pe(m,E),I[0]&16&&(k.checked=~(x[4]||[]).indexOf(k.__value)),I[0]&2&&U!==(U=x[1]?x[1]+" litros":"Cargar gas")&&Pe(Q,U)},d(x){x&&(c(e),c(_),c(v)),l[29](null),l[31](null),q.r(),L=!1,Ue(H)}}}function ai(l){let e,t,i,n,o,s="Kilometraje final",a,h,E=l[2]?l[2]+" km.":"Cargar km",m,_,v,p,k,O,y,B="Gasolina final (litros)",P,R,U=l[3]?l[3]+" litros":"Cargar gas",Q,q,L,H;return q=It(l[22][0]),{c(){e=d("ion-item"),t=d("ion-label"),i=d("input"),n=w(),o=d("p"),o.textContent=s,a=w(),h=d("ion-button"),m=Oe(E),_=w(),v=d("ion-item"),p=d("ion-label"),k=d("input"),O=w(),y=d("p"),y.textContent=B,P=w(),R=d("ion-button"),Q=Oe(U),this.h()},l(x){e=f(x,"ION-ITEM",{});var I=g(e);t=f(I,"ION-LABEL",{style:!0});var A=g(t);i=f(A,"INPUT",{id:!0,style:!0,type:!0}),n=N(A),o=f(A,"P",{style:!0,"data-svelte-h":!0}),le(o)!=="svelte-ccmu71"&&(o.textContent=s),A.forEach(c),a=N(I),h=f(I,"ION-BUTTON",{fill:!0,size:!0,class:!0,"aria-selected":!0});var V=g(h);m=ye(V,E),V.forEach(c),I.forEach(c),_=N(x),v=f(x,"ION-ITEM",{});var M=g(v);p=f(M,"ION-LABEL",{style:!0});var X=g(p);k=f(X,"INPUT",{id:!0,style:!0,type:!0}),O=N(X),y=f(X,"P",{style:!0,"data-svelte-h":!0}),le(y)!=="svelte-wsoyd2"&&(y.textContent=B),X.forEach(c),P=N(M),R=f(M,"ION-BUTTON",{fill:!0,size:!0,class:!0});var J=g(R);Q=ye(J,U),J.forEach(c),M.forEach(c),this.h()},h(){j(i,"id","chkbox-km-fin"),u(i,"pointer-events","auto"),j(i,"type","checkbox"),i.required=!0,u(o,"margin-left","10px"),u(t,"display","flex"),b(h,"fill","outline"),b(h,"size","small"),b(h,"class","loadKmInicial"),b(h,"aria-selected",""),j(k,"id","chkbox-gas-fin"),u(k,"pointer-events","auto"),j(k,"type","checkbox"),k.required=!0,u(y,"margin-left","10px"),u(p,"display","flex"),b(R,"fill","outline"),b(R,"size","small"),b(R,"class","loadGasInicial"),q.p(i,k)},m(x,I){W(x,e,I),r(e,t),r(t,i),i.checked=~(l[4]||[]).indexOf(i.__value),l[23](i),r(t,n),r(t,o),r(e,a),r(e,h),r(h,m),W(x,_,I),W(x,v,I),r(v,p),r(p,k),k.checked=~(l[4]||[]).indexOf(k.__value),l[26](k),r(p,O),r(p,y),r(v,P),r(v,R),r(R,Q),L||(H=[fe(i,"change",l[21]),fe(h,"click",l[24]),fe(k,"change",l[25]),fe(R,"click",l[27])],L=!0)},p(x,I){I[0]&16&&(i.checked=~(x[4]||[]).indexOf(i.__value)),I[0]&4&&E!==(E=x[2]?x[2]+" km.":"Cargar km")&&Pe(m,E),I[0]&16&&(k.checked=~(x[4]||[]).indexOf(k.__value)),I[0]&8&&U!==(U=x[3]?x[3]+" litros":"Cargar gas")&&Pe(Q,U)},d(x){x&&(c(e),c(_),c(v)),l[23](null),l[26](null),q.r(),L=!1,Ue(H)}}}function ci(l){let e=[],t=new Map,i,n=He(l[14]);const o=s=>s[56].id_checklist_event;for(let s=0;s<n.length;s+=1){let a=Pt(l,n,s),h=o(a);t.set(h,e[s]=At(h,a))}return{c(){for(let s=0;s<e.length;s+=1)e[s].c();i=Ae()},l(s){for(let a=0;a<e.length;a+=1)e[a].l(s);i=Ae()},m(s,a){for(let h=0;h<e.length;h+=1)e[h]&&e[h].m(s,a);W(s,i,a)},p(s,a){a[0]&813168&&(n=He(s[14]),e=rt(e,a,o,1,s,n,t,i.parentNode,st,At,i,Pt))},d(s){s&&c(i);for(let a=0;a<e.length;a+=1)e[a].d(s)}}}function ui(l){let e,t=(l[13][l[56].id_checklist_event]?l[13][l[56].id_checklist_event]:"Cargar evidencia")+"",i;return{c(){e=d("label"),i=Oe(t),this.h()},l(n){e=f(n,"LABEL",{for:!0,class:!0});var o=g(e);i=ye(o,t),o.forEach(c),this.h()},h(){j(e,"for","chklist-"+l[56].id_checklist_event),j(e,"class","button-label")},m(n,o){W(n,e,o),r(e,i)},p(n,o){o[0]&8192&&t!==(t=(n[13][n[56].id_checklist_event]?n[13][n[56].id_checklist_event]:"Cargar evidencia")+"")&&Pe(i,t)},d(n){n&&c(e)}}}function di(l){let e;return{c(){e=d("ion-spinner"),this.h()},l(t){e=f(t,"ION-SPINNER",{name:!0,class:!0}),g(e).forEach(c),this.h()},h(){b(e,"name","dots"),b(e,"class","button-spinner")},m(t,i){W(t,e,i)},p:Me,d(t){t&&c(e)}}}function At(l,e){let t,i,n,o=e[56],s,a,h=e[56].item+"",E,m,_,v=e[56].mandatory=="1"?" * ":"",p,k,O,y,B,P,R,U,Q,q;const L=()=>e[35](n,o),H=()=>e[35](null,o);function x(){return e[36](e[56])}function I(X,J){return X[11][X[56].id_checklist_event]?di:ui}let A=I(e),V=A(e);function M(...X){return e[38](e[56],...X)}return U=It(e[22][0]),{key:l,first:null,c(){t=d("ion-item"),i=d("ion-label"),n=d("input"),s=w(),a=d("p"),E=Oe(h),m=w(),_=d("b"),p=Oe(v),k=w(),O=d("ion-button"),y=d("div"),V.c(),B=w(),P=d("input"),R=w(),this.h()},l(X){t=f(X,"ION-ITEM",{});var J=g(t);i=f(J,"ION-LABEL",{style:!0});var G=g(i);n=f(G,"INPUT",{id:!0,style:!0,type:!0}),s=N(G),a=f(G,"P",{style:!0});var ne=g(a);E=ye(ne,h),ne.forEach(c),m=N(G),_=f(G,"B",{style:!0});var _e=g(_);p=ye(_e,v),_e.forEach(c),G.forEach(c),k=N(J),O=f(J,"ION-BUTTON",{fill:!0,class:!0,size:!0});var D=g(O);y=f(D,"DIV",{class:!0});var se=g(y);V.l(se),B=N(se),P=f(se,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0,capture:!0}),se.forEach(c),D.forEach(c),R=N(J),J.forEach(c),this.h()},h(){j(n,"id",`chkbox-${e[56].id_checklist_event}`),u(n,"pointer-events","auto"),j(n,"type","checkbox"),n.__value=e[56].id_checklist_event,Cn(n,n.__value),n.required=!0,u(a,"margin-left","10px"),u(_,"margin-left","5px"),u(i,"display","flex"),u(P,"display","none"),j(P,"id","chklist-"+e[56].id_checklist_event),j(P,"name","fileToUpload"),j(P,"type","file"),j(P,"accept","image/*"),j(P,"capture","environment"),j(y,"class","button-content"),b(O,"fill","outline"),b(O,"class","loadEvidence"),b(O,"size","small"),U.p(n),this.first=t},m(X,J){W(X,t,J),r(t,i),r(i,n),n.checked=~(e[4]||[]).indexOf(n.__value),L(),r(i,s),r(i,a),r(a,E),r(i,m),r(i,_),r(_,p),r(t,k),r(t,O),r(O,y),V.m(y,null),r(y,B),r(y,P),e[37](P),r(t,R),Q||(q=[fe(n,"change",e[34]),fe(n,"change",x),fe(P,"change",M)],Q=!0)},p(X,J){e=X,J[0]&16&&(n.checked=~(e[4]||[]).indexOf(n.__value)),o!==e[56]&&(H(),o=e[56],L()),A===(A=I(e))&&V?V.p(e,J):(V.d(1),V=A(e),V&&(V.c(),V.m(y,B)))},d(X){X&&c(t),H(),V.d(),e[37](null),U.r(),Q=!1,Ue(q)}}}function Dt(l){let e,t='<ion-spinner name="dots" style="color:white;"></ion-spinner>';return{c(){e=d("div"),e.innerHTML=t,this.h()},l(i){e=f(i,"DIV",{class:!0,style:!0,"data-svelte-h":!0}),le(e)!=="svelte-1aosxw0"&&(e.innerHTML=t),this.h()},h(){j(e,"class","overlay"),u(e,"position","fixed"),u(e,"top","0"),u(e,"left","0"),u(e,"width","100vw"),u(e,"height","100vh"),u(e,"background","rgba(0, 0, 0, 0.5)"),u(e,"display","flex"),u(e,"align-items","center"),u(e,"justify-content","center"),u(e,"z-index","9999")},m(i,n){W(i,e,n)},d(i){i&&c(e)}}}function fi(l){let e,t,i,n,o="Cancelar",s,a,h="REQUERIMIENTOS DE RUTA",E,m,_,v,p,k,O,y="Confirmar",B,P,R,U;function Q(I,A){return I[15]?ai:si}let L=Q(l)(l),H=l[14]&&ci(l),x=l[12]&&Dt();return{c(){e=d("ion-header"),t=d("ion-toolbar"),i=d("ion-buttons"),n=d("ion-button"),n.textContent=o,s=w(),a=d("ion-title"),a.textContent=h,E=w(),m=d("ion-content"),_=d("ion-list"),L.c(),v=w(),H&&H.c(),p=w(),k=d("ion-footer"),O=d("ion-button"),O.textContent=y,B=w(),x&&x.c(),P=Ae(),this.h()},l(I){e=f(I,"ION-HEADER",{translucent:!0});var A=g(e);t=f(A,"ION-TOOLBAR",{});var V=g(t);i=f(V,"ION-BUTTONS",{slot:!0});var M=g(i);n=f(M,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),le(n)!=="svelte-1yhpw6u"&&(n.textContent=o),M.forEach(c),s=N(V),a=f(V,"ION-TITLE",{"data-svelte-h":!0}),le(a)!=="svelte-19bar5p"&&(a.textContent=h),V.forEach(c),A.forEach(c),E=N(I),m=f(I,"ION-CONTENT",{fullscreen:!0});var X=g(m);_=f(X,"ION-LIST",{});var J=g(_);L.l(J),v=N(J),H&&H.l(J),J.forEach(c),X.forEach(c),p=N(I),k=f(I,"ION-FOOTER",{});var G=g(k);O=f(G,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),le(O)!=="svelte-1k4i1so"&&(O.textContent=y),G.forEach(c),B=N(I),x&&x.l(I),P=Ae(),this.h()},h(){b(n,"color","medium"),b(i,"slot","start"),b(e,"translucent",""),b(m,"fullscreen",""),b(O,"fill","outline"),b(O,"color","tertiary"),b(O,"strong",""),u(O,"width","99%"),u(O,"height","auto")},m(I,A){W(I,e,A),r(e,t),r(t,i),r(i,n),r(t,s),r(t,a),W(I,E,A),W(I,m,A),r(m,_),L.m(_,null),r(_,v),H&&H.m(_,null),W(I,p,A),W(I,k,A),r(k,O),W(I,B,A),x&&x.m(I,A),W(I,P,A),R||(U=[fe(n,"click",l[16]),fe(O,"click",l[17])],R=!0)},p(I,A){L.p(I,A),I[14]&&H.p(I,A),I[12]?x||(x=Dt(),x.c(),x.m(P.parentNode,P)):x&&(x.d(1),x=null)},i:Me,o:Me,d(I){I&&(c(e),c(E),c(m),c(p),c(k),c(B),c(P)),L.d(),H&&H.d(),x&&x.d(I),R=!1,Ue(U)}}}function bt(l,e){if(typeof l=="object"&&l!==null||Array.isArray(l)){if(Array.isArray(l))return l.map(t=>bt(t,e)).flat();{const t=Object.keys(l);let i;return e=="id_checklist_event"?i=t.filter(o=>o.toLowerCase().includes("id_checklist_event")).map(o=>l[o]):e=="mandatory"?i=t.filter(o=>o.toLowerCase().includes("mandatory")).map(o=>l[o]):(console.error("Tipo de dato no reconocido."),i=!1),i}}else return console.error("Invalid input. Please provide a valid object or array."),[]}function hi(){return new Promise((l,e)=>{if(!navigator.geolocation)return e("Geoloc no soportada");navigator.geolocation.getCurrentPosition(t=>l({lat:+t.coords.latitude.toFixed(6),lng:+t.coords.longitude.toFixed(6)}),t=>e(t),{enableHighAccuracy:!0,maximumAge:0,timeout:8e3})})}function _i(l,e,t){let i=at,n=document.querySelector("ion-modal");const o=n.componentProps.checklist,s=n.componentProps.driverId,a=n.componentProps.routeId,h=n.componentProps.isLast;let E,m,_,v,p=[],k=null,O={},y,B,P,R,U={},Q=new Object,q=!1,L={},H={};et(()=>{Q=JSON.parse(localStorage.getItem("userSession")),h?console.log("Último checklist"):gt.update(T=>(T.mandatory=bt(o,"mandatory"),T.items=bt(o,"id_checklist_event"),T))});function x(T){t(11,U[T]=!0,U)}const I=async()=>{await(await qe.create({header:"Datos o checklist incompletos",message:"Carga la evidencia requerida y marca todas las casillas para confirmar",buttons:[{text:"Cerrar"}]})).present()},A=async(T,z)=>{await(await qe.create({header:T||"Error",message:z||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()},V=async T=>{await(await qe.create({header:"Datos inválidos",message:T=="km"?"Llena correctamente el campo de kilometraje inicial":"Llena correctamente el campo de gasolina inicial",buttons:[{text:"Cerrar"}]})).present()},M=()=>{tt.dismiss(),s?Ze(`/drivers/${s}`):Ze("/drivers/me")},X=async()=>{if(t(12,q=!0),h){var T=D(_,"km"),z=D(v,"gas");let S=new Object;S.km_final=T,S.gas_final=z,S.id_route=a,S.id_user_over=Q.id_user,S.token=Q.token,T&&z?(M(),Ve(`${i}api/admin/checklist/add_evidence.php`,function(Y){Y.success?(t(12,q=!1),A("Datos capturados","El kilometraje y gasolina final fueron registrados correctamente, espere aprobación para finalizar ruta")):(t(12,q=!1),A("Error","Vuelva a intentar capturar los datos solicitados"))},S)):I()}else{var C=D(E,"km"),F=D(m,"gas");let S=null;try{S=await hi()}catch(Y){console.warn("GPS no disponible:",Y)}gt.update(Y=>{Y.items;const ke=Y.mandatory;if(Y.items.filter((Ie,we)=>Y.mandatory[we]==="1").every(Ie=>Y.checkedIndices.includes(Ie))&&C&&F){let Ie=new FormData;Ie=oe(Ie),Ie.append("km_inicial",C),Ie.append("gas_inicial",F),Ie.append("id_route",a),S&&(Ie.append("lat",S.lat),Ie.append("lng",S.lng));for(const we in L)if(L.hasOwnProperty(we)){const{img:Re,img_id:Ke}=L[we];Ie.append(`selectedImages[${we}][img]`,Re),Ie.append(`selectedImages[${we}][img_id]`,Ke)}fetch(`${i}api/admin/checklist/add_evidence.php`,{method:"POST",body:Ie}).then(we=>we.json()).then(we=>{ke&&ke.some(Re=>Re==="1")?_e(a,"checklist-pending"):_e(a,"enroute")}).catch(we=>{console.error("Error fetching data:",we)}).finally(()=>{t(12,q=!1),M()})}else if(!ke&&C&&F){let Ie=new FormData;S&&(Ie.append("lat",S.lat),Ie.append("lng",S.lng)),Ie.append("km_inicial",C),Ie.append("gas_inicial",F),Ie=oe(Ie),fetch(`${i}api/admin/checklist/add_evidence.php`,{method:"POST",body:Ie}).then(we=>we.json()).then(we=>{_e(a,"enroute")}).catch(we=>{console.error("Error fetching data:",we)}).finally(()=>{t(12,q=!1),M()})}else I();return Y})}ae()},J=async(T,z)=>{x(z);const F=T.target.files[0],S=await G(F);if(S){let Y=new FormData;Y.append("fileToUpload",S),Y=oe(Y);try{const ke=await fetch(`${i}api/admin/manager/upload_img_driver.php`,{method:"POST",body:Y});if(ke.ok){const Ne=await ke.json();L={...L,[z]:{img:Ne.img,img_id:Ne.img_id}},t(13,H={...H,[z]:Ne.filename}),ne(z),t(6,O[z].checked=!0,O),t(11,U[z]=!1,U)}else console.error("File upload failed:",ke.statusText)}catch(ke){console.error("Error during file upload:",ke)}}},G=async T=>new Promise(z=>{const C=new Image;C.src=URL.createObjectURL(T),C.onload=()=>{const F=document.createElement("canvas"),S=F.getContext("2d"),Y=800,ke=600;let Ne=C.width,Ce=C.height;Ne>Y&&(Ce*=Y/Ne,Ne=Y),Ce>ke&&(Ne*=ke/Ce,Ce=ke),F.width=Ne,F.height=Ce,S.drawImage(C,0,0,Ne,Ce),F.toBlob(Ie=>{z(Ie),URL.revokeObjectURL(C.src),S.clearRect(0,0,F.width,F.height)},"image/jpeg",.7)}}),ne=T=>{gt.update(z=>(z.checkedIndices.indexOf(T)===-1?z.checkedIndices.push(T):console.error(`ID ${T} is already checked.`),z.items.forEach(F=>{F.id_checklist_event===T&&(F.checked=!0)}),z))};function _e(T,z){let C=new FormData;C.append("id_route",T),C.append("status",z),C=oe(C),fetch(`${i}api/admin/route/change_status.php`,{method:"POST",body:C}).then(F=>F.json()).then(F=>{}).catch(F=>{console.error("Error fetching data:",F)})}function D(T,z){return/^\d+$/.test(T)?parseInt(T,10):(V(z),null)}function se(T,z){me(z),n.componentProps.data_type=z,We("modal-gas-km",ri,{r:z}).then(()=>{nt.subscribe(C=>{ue(C,z)})})}function me(T){wn.update(z=>({...z,flag:[T]}))}function ue(T,z){t(0,E=T.km_inicial?T.km_inicial:null),t(1,m=T.gas_inicial?T.gas_inicial:null),t(2,_=T.km_final?T.km_final:null),t(3,v=T.gas_final?T.gas_final:null),z=="km_inicial"&&y&&t(7,y.checked=!0,y),z=="gas_inicial"&&B&&t(8,B.checked=!0,B),z=="km_final"&&P&&t(9,P.checked=!0,P),z=="gas_final"&&R&&t(10,R.checked=!0,R)}function ae(){nt.set({km_inicial:[],gas_inicial:[],km_final:[],gas_final:[]})}function oe(T){return T.append("token",Q.token),T.append("id_user_over",Q.id_user),T}const ce=[[]];function pe(){p=lt(ce[0],this.__value,this.checked),t(4,p)}function re(T){De[T?"unshift":"push"](()=>{P=T,t(9,P)})}const te=T=>se(T,"km_final");function be(){p=lt(ce[0],this.__value,this.checked),t(4,p)}function ve(T){De[T?"unshift":"push"](()=>{R=T,t(10,R)})}const Ee=T=>se(T,"gas_final");function de(){p=lt(ce[0],this.__value,this.checked),t(4,p)}function he(T){De[T?"unshift":"push"](()=>{y=T,t(7,y)})}const ee=T=>se(T,"km_inicial");function $(T){De[T?"unshift":"push"](()=>{B=T,t(8,B)})}function ie(){p=lt(ce[0],this.__value,this.checked),t(4,p)}const K=T=>se(T,"gas_inicial");function ge(){p=lt(ce[0],this.__value,this.checked),t(4,p)}function Se(T,z){De[T?"unshift":"push"](()=>{O[z.id_checklist_event]=T,t(6,O)})}const Le=T=>ne(T.id_checklist_event);function Te(T){De[T?"unshift":"push"](()=>{k=T,t(5,k)})}return[E,m,_,v,p,k,O,y,B,P,R,U,q,H,o,h,M,X,J,ne,se,pe,ce,re,te,be,ve,Ee,de,he,ee,$,ie,K,ge,Se,Le,Te,(T,z)=>J(z,T.id_checklist_event)]}class Nn extends Ye{constructor(e){super(),Qe(this,e,_i,fi,Je,{},null,[-1,-1])}}/*!
 * Signature Pad v5.0.10 | https://github.com/szimek/signature_pad
 * (c) 2025 Szymon Nowak | Released under the MIT license
 */class _t{constructor(e,t,i,n){if(isNaN(e)||isNaN(t))throw new Error(`Point is invalid: (${e}, ${t})`);this.x=+e,this.y=+t,this.pressure=i||0,this.time=n||Date.now()}distanceTo(e){return Math.sqrt(Math.pow(this.x-e.x,2)+Math.pow(this.y-e.y,2))}equals(e){return this.x===e.x&&this.y===e.y&&this.pressure===e.pressure&&this.time===e.time}velocityFrom(e){return this.time!==e.time?this.distanceTo(e)/(this.time-e.time):0}}class Lt{static fromPoints(e,t){const i=this.calculateControlPoints(e[0],e[1],e[2]).c2,n=this.calculateControlPoints(e[1],e[2],e[3]).c1;return new Lt(e[1],i,n,e[2],t.start,t.end)}static calculateControlPoints(e,t,i){const n=e.x-t.x,o=e.y-t.y,s=t.x-i.x,a=t.y-i.y,h={x:(e.x+t.x)/2,y:(e.y+t.y)/2},E={x:(t.x+i.x)/2,y:(t.y+i.y)/2},m=Math.sqrt(n*n+o*o),_=Math.sqrt(s*s+a*a),v=h.x-E.x,p=h.y-E.y,k=m+_==0?0:_/(m+_),O={x:E.x+v*k,y:E.y+p*k},y=t.x-O.x,B=t.y-O.y;return{c1:new _t(h.x+y,h.y+B),c2:new _t(E.x+y,E.y+B)}}constructor(e,t,i,n,o,s){this.startPoint=e,this.control2=t,this.control1=i,this.endPoint=n,this.startWidth=o,this.endWidth=s}length(){let t=0,i,n;for(let o=0;o<=10;o+=1){const s=o/10,a=this.point(s,this.startPoint.x,this.control1.x,this.control2.x,this.endPoint.x),h=this.point(s,this.startPoint.y,this.control1.y,this.control2.y,this.endPoint.y);if(o>0){const E=a-i,m=h-n;t+=Math.sqrt(E*E+m*m)}i=a,n=h}return t}point(e,t,i,n,o){return t*(1-e)*(1-e)*(1-e)+3*i*(1-e)*(1-e)*e+3*n*(1-e)*e*e+o*e*e*e}}class pi{constructor(){try{this._et=new EventTarget}catch{this._et=document}}addEventListener(e,t,i){this._et.addEventListener(e,t,i)}dispatchEvent(e){return this._et.dispatchEvent(e)}removeEventListener(e,t,i){this._et.removeEventListener(e,t,i)}}function mi(l,e=250){let t=0,i=null,n,o,s;const a=()=>{t=Date.now(),i=null,n=l.apply(o,s),i||(o=null,s=[])};return function(...E){const m=Date.now(),_=e-(m-t);return o=this,s=E,_<=0||_>e?(i&&(clearTimeout(i),i=null),t=m,n=l.apply(o,s),i||(o=null,s=[])):i||(i=window.setTimeout(a,_)),n}}class pt extends pi{constructor(e,t={}){var i,n,o;super(),this.canvas=e,this._drawingStroke=!1,this._isEmpty=!0,this._lastPoints=[],this._data=[],this._lastVelocity=0,this._lastWidth=0,this.velocityFilterWeight=t.velocityFilterWeight||.7,this.minWidth=t.minWidth||.5,this.maxWidth=t.maxWidth||2.5,this.throttle=(i=t.throttle)!==null&&i!==void 0?i:16,this.minDistance=(n=t.minDistance)!==null&&n!==void 0?n:5,this.dotSize=t.dotSize||0,this.penColor=t.penColor||"black",this.backgroundColor=t.backgroundColor||"rgba(0,0,0,0)",this.compositeOperation=t.compositeOperation||"source-over",this.canvasContextOptions=(o=t.canvasContextOptions)!==null&&o!==void 0?o:{},this._strokeMoveUpdate=this.throttle?mi(pt.prototype._strokeUpdate,this.throttle):pt.prototype._strokeUpdate,this._handleMouseDown=this._handleMouseDown.bind(this),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this._handleTouchStart=this._handleTouchStart.bind(this),this._handleTouchMove=this._handleTouchMove.bind(this),this._handleTouchEnd=this._handleTouchEnd.bind(this),this._handlePointerDown=this._handlePointerDown.bind(this),this._handlePointerMove=this._handlePointerMove.bind(this),this._handlePointerUp=this._handlePointerUp.bind(this),this._ctx=e.getContext("2d",this.canvasContextOptions),this.clear(),this.on()}clear(){const{_ctx:e,canvas:t}=this;e.fillStyle=this.backgroundColor,e.clearRect(0,0,t.width,t.height),e.fillRect(0,0,t.width,t.height),this._data=[],this._reset(this._getPointGroupOptions()),this._isEmpty=!0,this._strokePointerId=void 0}fromDataURL(e,t={}){return new Promise((i,n)=>{const o=new Image,s=t.ratio||window.devicePixelRatio||1,a=t.width||this.canvas.width/s,h=t.height||this.canvas.height/s,E=t.xOffset||0,m=t.yOffset||0;this._reset(this._getPointGroupOptions()),o.onload=()=>{this._ctx.drawImage(o,E,m,a,h),i()},o.onerror=_=>{n(_)},o.crossOrigin="anonymous",o.src=e,this._isEmpty=!1})}toDataURL(e="image/png",t){switch(e){case"image/svg+xml":return typeof t!="object"&&(t=void 0),`data:image/svg+xml;base64,${btoa(this.toSVG(t))}`;default:return typeof t!="number"&&(t=void 0),this.canvas.toDataURL(e,t)}}on(){this.canvas.style.touchAction="none",this.canvas.style.msTouchAction="none",this.canvas.style.userSelect="none";const e=/Macintosh/.test(navigator.userAgent)&&"ontouchstart"in document;window.PointerEvent&&!e?this._handlePointerEvents():(this._handleMouseEvents(),"ontouchstart"in window&&this._handleTouchEvents())}off(){this.canvas.style.touchAction="auto",this.canvas.style.msTouchAction="auto",this.canvas.style.userSelect="auto",this.canvas.removeEventListener("pointerdown",this._handlePointerDown),this.canvas.removeEventListener("mousedown",this._handleMouseDown),this.canvas.removeEventListener("touchstart",this._handleTouchStart),this._removeMoveUpEventListeners()}_getListenerFunctions(){var e;const t=window.document===this.canvas.ownerDocument?window:(e=this.canvas.ownerDocument.defaultView)!==null&&e!==void 0?e:this.canvas.ownerDocument;return{addEventListener:t.addEventListener.bind(t),removeEventListener:t.removeEventListener.bind(t)}}_removeMoveUpEventListeners(){const{removeEventListener:e}=this._getListenerFunctions();e("pointermove",this._handlePointerMove),e("pointerup",this._handlePointerUp),e("mousemove",this._handleMouseMove),e("mouseup",this._handleMouseUp),e("touchmove",this._handleTouchMove),e("touchend",this._handleTouchEnd)}isEmpty(){return this._isEmpty}fromData(e,{clear:t=!0}={}){t&&this.clear(),this._fromData(e,this._drawCurve.bind(this),this._drawDot.bind(this)),this._data=this._data.concat(e)}toData(){return this._data}_isLeftButtonPressed(e,t){return t?e.buttons===1:(e.buttons&1)===1}_pointerEventToSignatureEvent(e){return{event:e,type:e.type,x:e.clientX,y:e.clientY,pressure:"pressure"in e?e.pressure:0}}_touchEventToSignatureEvent(e){const t=e.changedTouches[0];return{event:e,type:e.type,x:t.clientX,y:t.clientY,pressure:t.force}}_handleMouseDown(e){!this._isLeftButtonPressed(e,!0)||this._drawingStroke||this._strokeBegin(this._pointerEventToSignatureEvent(e))}_handleMouseMove(e){if(!this._isLeftButtonPressed(e,!0)||!this._drawingStroke){this._strokeEnd(this._pointerEventToSignatureEvent(e),!1);return}this._strokeMoveUpdate(this._pointerEventToSignatureEvent(e))}_handleMouseUp(e){this._isLeftButtonPressed(e)||this._strokeEnd(this._pointerEventToSignatureEvent(e))}_handleTouchStart(e){e.targetTouches.length!==1||this._drawingStroke||(e.cancelable&&e.preventDefault(),this._strokeBegin(this._touchEventToSignatureEvent(e)))}_handleTouchMove(e){if(e.targetTouches.length===1){if(e.cancelable&&e.preventDefault(),!this._drawingStroke){this._strokeEnd(this._touchEventToSignatureEvent(e),!1);return}this._strokeMoveUpdate(this._touchEventToSignatureEvent(e))}}_handleTouchEnd(e){e.targetTouches.length===0&&(e.cancelable&&e.preventDefault(),this._strokeEnd(this._touchEventToSignatureEvent(e)))}_getPointerId(e){return e.persistentDeviceId||e.pointerId}_allowPointerId(e,t=!1){return typeof this._strokePointerId>"u"?t:this._getPointerId(e)===this._strokePointerId}_handlePointerDown(e){this._drawingStroke||!this._isLeftButtonPressed(e)||!this._allowPointerId(e,!0)||(this._strokePointerId=this._getPointerId(e),e.preventDefault(),this._strokeBegin(this._pointerEventToSignatureEvent(e)))}_handlePointerMove(e){if(this._allowPointerId(e)){if(!this._isLeftButtonPressed(e,!0)||!this._drawingStroke){this._strokeEnd(this._pointerEventToSignatureEvent(e),!1);return}e.preventDefault(),this._strokeMoveUpdate(this._pointerEventToSignatureEvent(e))}}_handlePointerUp(e){this._isLeftButtonPressed(e)||!this._allowPointerId(e)||(e.preventDefault(),this._strokeEnd(this._pointerEventToSignatureEvent(e)))}_getPointGroupOptions(e){return{penColor:e&&"penColor"in e?e.penColor:this.penColor,dotSize:e&&"dotSize"in e?e.dotSize:this.dotSize,minWidth:e&&"minWidth"in e?e.minWidth:this.minWidth,maxWidth:e&&"maxWidth"in e?e.maxWidth:this.maxWidth,velocityFilterWeight:e&&"velocityFilterWeight"in e?e.velocityFilterWeight:this.velocityFilterWeight,compositeOperation:e&&"compositeOperation"in e?e.compositeOperation:this.compositeOperation}}_strokeBegin(e){if(!this.dispatchEvent(new CustomEvent("beginStroke",{detail:e,cancelable:!0})))return;const{addEventListener:i}=this._getListenerFunctions();switch(e.event.type){case"mousedown":i("mousemove",this._handleMouseMove,{passive:!1}),i("mouseup",this._handleMouseUp,{passive:!1});break;case"touchstart":i("touchmove",this._handleTouchMove,{passive:!1}),i("touchend",this._handleTouchEnd,{passive:!1});break;case"pointerdown":i("pointermove",this._handlePointerMove,{passive:!1}),i("pointerup",this._handlePointerUp,{passive:!1});break}this._drawingStroke=!0;const n=this._getPointGroupOptions(),o=Object.assign(Object.assign({},n),{points:[]});this._data.push(o),this._reset(n),this._strokeUpdate(e)}_strokeUpdate(e){if(!this._drawingStroke)return;if(this._data.length===0){this._strokeBegin(e);return}this.dispatchEvent(new CustomEvent("beforeUpdateStroke",{detail:e}));const t=this._createPoint(e.x,e.y,e.pressure),i=this._data[this._data.length-1],n=i.points,o=n.length>0&&n[n.length-1],s=o?t.distanceTo(o)<=this.minDistance:!1,a=this._getPointGroupOptions(i);if(!o||!(o&&s)){const h=this._addPoint(t,a);o?h&&this._drawCurve(h,a):this._drawDot(t,a),n.push({time:t.time,x:t.x,y:t.y,pressure:t.pressure})}this.dispatchEvent(new CustomEvent("afterUpdateStroke",{detail:e}))}_strokeEnd(e,t=!0){this._removeMoveUpEventListeners(),this._drawingStroke&&(t&&this._strokeUpdate(e),this._drawingStroke=!1,this._strokePointerId=void 0,this.dispatchEvent(new CustomEvent("endStroke",{detail:e})))}_handlePointerEvents(){this._drawingStroke=!1,this.canvas.addEventListener("pointerdown",this._handlePointerDown,{passive:!1})}_handleMouseEvents(){this._drawingStroke=!1,this.canvas.addEventListener("mousedown",this._handleMouseDown,{passive:!1})}_handleTouchEvents(){this.canvas.addEventListener("touchstart",this._handleTouchStart,{passive:!1})}_reset(e){this._lastPoints=[],this._lastVelocity=0,this._lastWidth=(e.minWidth+e.maxWidth)/2,this._ctx.fillStyle=e.penColor,this._ctx.globalCompositeOperation=e.compositeOperation}_createPoint(e,t,i){const n=this.canvas.getBoundingClientRect();return new _t(e-n.left,t-n.top,i,new Date().getTime())}_addPoint(e,t){const{_lastPoints:i}=this;if(i.push(e),i.length>2){i.length===3&&i.unshift(i[0]);const n=this._calculateCurveWidths(i[1],i[2],t),o=Lt.fromPoints(i,n);return i.shift(),o}return null}_calculateCurveWidths(e,t,i){const n=i.velocityFilterWeight*t.velocityFrom(e)+(1-i.velocityFilterWeight)*this._lastVelocity,o=this._strokeWidth(n,i),s={end:o,start:this._lastWidth};return this._lastVelocity=n,this._lastWidth=o,s}_strokeWidth(e,t){return Math.max(t.maxWidth/(e+1),t.minWidth)}_drawCurveSegment(e,t,i){const n=this._ctx;n.moveTo(e,t),n.arc(e,t,i,0,2*Math.PI,!1),this._isEmpty=!1}_drawCurve(e,t){const i=this._ctx,n=e.endWidth-e.startWidth,o=Math.ceil(e.length())*2;i.beginPath(),i.fillStyle=t.penColor;for(let s=0;s<o;s+=1){const a=s/o,h=a*a,E=h*a,m=1-a,_=m*m,v=_*m;let p=v*e.startPoint.x;p+=3*_*a*e.control1.x,p+=3*m*h*e.control2.x,p+=E*e.endPoint.x;let k=v*e.startPoint.y;k+=3*_*a*e.control1.y,k+=3*m*h*e.control2.y,k+=E*e.endPoint.y;const O=Math.min(e.startWidth+E*n,t.maxWidth);this._drawCurveSegment(p,k,O)}i.closePath(),i.fill()}_drawDot(e,t){const i=this._ctx,n=t.dotSize>0?t.dotSize:(t.minWidth+t.maxWidth)/2;i.beginPath(),this._drawCurveSegment(e.x,e.y,n),i.closePath(),i.fillStyle=t.penColor,i.fill()}_fromData(e,t,i){for(const n of e){const{points:o}=n,s=this._getPointGroupOptions(n);if(o.length>1)for(let a=0;a<o.length;a+=1){const h=o[a],E=new _t(h.x,h.y,h.pressure,h.time);a===0&&this._reset(s);const m=this._addPoint(E,s);m&&t(m,s)}else this._reset(s),i(o[0],s)}}toSVG({includeBackgroundColor:e=!1}={}){const t=this._data,i=Math.max(window.devicePixelRatio||1,1),n=0,o=0,s=this.canvas.width/i,a=this.canvas.height/i,h=document.createElementNS("http://www.w3.org/2000/svg","svg");if(h.setAttribute("xmlns","http://www.w3.org/2000/svg"),h.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),h.setAttribute("viewBox",`${n} ${o} ${s} ${a}`),h.setAttribute("width",s.toString()),h.setAttribute("height",a.toString()),e&&this.backgroundColor){const E=document.createElement("rect");E.setAttribute("width","100%"),E.setAttribute("height","100%"),E.setAttribute("fill",this.backgroundColor),h.appendChild(E)}return this._fromData(t,(E,{penColor:m})=>{const _=document.createElement("path");if(!isNaN(E.control1.x)&&!isNaN(E.control1.y)&&!isNaN(E.control2.x)&&!isNaN(E.control2.y)){const v=`M ${E.startPoint.x.toFixed(3)},${E.startPoint.y.toFixed(3)} C ${E.control1.x.toFixed(3)},${E.control1.y.toFixed(3)} ${E.control2.x.toFixed(3)},${E.control2.y.toFixed(3)} ${E.endPoint.x.toFixed(3)},${E.endPoint.y.toFixed(3)}`;_.setAttribute("d",v),_.setAttribute("stroke-width",(E.endWidth*2.25).toFixed(3)),_.setAttribute("stroke",m),_.setAttribute("fill","none"),_.setAttribute("stroke-linecap","round"),h.appendChild(_)}},(E,{penColor:m,dotSize:_,minWidth:v,maxWidth:p})=>{const k=document.createElement("circle"),O=_>0?_:(v+p)/2;k.setAttribute("r",O.toString()),k.setAttribute("cx",E.x.toString()),k.setAttribute("cy",E.y.toString()),k.setAttribute("fill",m),h.appendChild(k)}),h.outerHTML}}function vi(l){let e,t;return{c(){e=d("div"),t=d("canvas"),this.h()},l(i){e=f(i,"DIV",{class:!0,style:!0});var n=g(e);t=f(n,"CANVAS",{class:!0,style:!0}),g(t).forEach(c),n.forEach(c),this.h()},h(){j(t,"class","signature-canvas"),u(t,"position","absolute"),u(t,"top","0"),u(t,"left","0"),u(t,"width","100%"),u(t,"height","100%"),u(t,"display","block"),j(e,"class","signature-container"),u(e,"position","relative"),u(e,"width","100%"),u(e,"height","150px"),u(e,"border","1px solid #ccc"),u(e,"border-radius","4px"),u(e,"touch-action","none"),u(e,"-ms-touch-action","none")},m(i,n){W(i,e,n),r(e,t),l[5](t),l[6](e)},p:Me,i:Me,o:Me,d(i){i&&c(e),l[5](null),l[6](null)}}}function gi(l,e,t){let i,n,o,s;function a(){o&&o.clear()}async function h(p="image/png"){return!o||o.isEmpty()?(await(await qe.create({header:"Firma vacía",message:"No existe firma por guardar",buttons:[{text:"Cerrar"}]})).present(),null):o.toDataURL(p)}function E(){m(),o&&o.clear()}function m(){const p=Math.max(window.devicePixelRatio||1,1),k=n.clientWidth,O=n.clientHeight;if(!k||!O)return;const y=32767,B=Math.min(p,y/k,y/O);t(0,i.width=Math.floor(k*B),i),t(0,i.height=Math.floor(O*B),i);const P=i.getContext("2d");try{P.scale(B,B)}catch(R){console.warn("Canvas scale failed:",R)}}et(async()=>{await Ot(),m(),o=new pt(i,{backgroundColor:"rgba(255, 255, 255, 0)",penColor:"black"}),s=new ResizeObserver(m),s.observe(n)}),Ln(()=>{s&&s.disconnect()});function _(p){De[p?"unshift":"push"](()=>{i=p,t(0,i)})}function v(p){De[p?"unshift":"push"](()=>{n=p,t(1,n)})}return[i,n,a,h,E,_,v]}class bi extends Ye{constructor(e){super(),Qe(this,e,gi,vi,Je,{clear:2,save:3,reset:4})}get clear(){return this.$$.ctx[2]}get save(){return this.$$.ctx[3]}get reset(){return this.$$.ctx[4]}}function xt(l,e,t){const i=l.slice();return i[58]=e[t],i[60]=t,i}function Ei(l){let e,t,i,n,o;return{c(){e=d("ion-buttons"),t=d("ion-button"),i=Oe("Confirmar"),this.h()},l(s){e=f(s,"ION-BUTTONS",{slot:!0});var a=g(e);t=f(a,"ION-BUTTON",{strong:!0,disabled:!0});var h=g(t);i=ye(h,"Confirmar"),h.forEach(c),a.forEach(c),this.h()},h(){b(t,"strong",""),b(t,"disabled",l[12].status=="completed"),b(e,"slot","end")},m(s,a){W(s,e,a),r(e,t),r(t,i),n||(o=fe(t,"click",l[24]),n=!0)},p:Me,d(s){s&&c(e),n=!1,o()}}}function ki(l){let e,t,i,n,o,s="Empresa",a,h,E=l[12].enterprise_name+"",m;return{c(){e=d("ion-item"),t=d("ion-icon"),i=w(),n=d("ion-label"),o=d("p"),o.textContent=s,a=w(),h=d("h2"),m=Oe(E),this.h()},l(_){e=f(_,"ION-ITEM",{});var v=g(e);t=f(v,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(c),i=N(v),n=f(v,"ION-LABEL",{});var p=g(n);o=f(p,"P",{"data-svelte-h":!0}),le(o)!=="svelte-6noid3"&&(o.textContent=s),a=N(p),h=f(p,"H2",{});var k=g(h);m=ye(k,E),k.forEach(c),p.forEach(c),v.forEach(c),this.h()},h(){b(t,"icon",yn),b(t,"slot","start")},m(_,v){W(_,e,v),r(e,t),r(e,i),r(e,n),r(n,o),r(n,a),r(n,h),r(h,m)},p:Me,d(_){_&&c(e)}}}function Ii(l){let e,t,i,n,o,s="Negocio",a,h,E=l[12].client_name+"",m;return{c(){e=d("ion-item"),t=d("ion-icon"),i=w(),n=d("ion-label"),o=d("p"),o.textContent=s,a=w(),h=d("h2"),m=Oe(E),this.h()},l(_){e=f(_,"ION-ITEM",{});var v=g(e);t=f(v,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(c),i=N(v),n=f(v,"ION-LABEL",{});var p=g(n);o=f(p,"P",{"data-svelte-h":!0}),le(o)!=="svelte-57b1dg"&&(o.textContent=s),a=N(p),h=f(p,"H2",{});var k=g(h);m=ye(k,E),k.forEach(c),p.forEach(c),v.forEach(c),this.h()},h(){b(t,"icon",yn),b(t,"slot","start")},m(_,v){W(_,e,v),r(e,t),r(e,i),r(e,n),r(n,o),r(n,a),r(n,h),r(h,m)},p:Me,d(_){_&&c(e)}}}function Oi(l){let e,t,i,n,o,s="Teléfono de Negocio",a,h,E=l[12].client_phone+"",m;return{c(){e=d("ion-item"),t=d("ion-icon"),i=w(),n=d("ion-label"),o=d("p"),o.textContent=s,a=w(),h=d("h2"),m=Oe(E),this.h()},l(_){e=f(_,"ION-ITEM",{href:!0});var v=g(e);t=f(v,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(c),i=N(v),n=f(v,"ION-LABEL",{class:!0});var p=g(n);o=f(p,"P",{"data-svelte-h":!0}),le(o)!=="svelte-1u5l7fz"&&(o.textContent=s),a=N(p),h=f(p,"H2",{});var k=g(h);m=ye(k,E),k.forEach(c),p.forEach(c),v.forEach(c),this.h()},h(){b(t,"icon",Dn),b(t,"slot","start"),b(n,"class","ion-text-wrap"),b(e,"href","tel:"+l[12].client_phone)},m(_,v){W(_,e,v),r(e,t),r(e,i),r(e,n),r(n,o),r(n,a),r(n,h),r(h,m)},p:Me,d(_){_&&c(e)}}}function yi(l){let e,t,i,n,o,s="Domicilio Alternativo",a,h,E=l[12].line2+"",m,_,v;return{c(){e=d("ion-item"),t=d("ion-icon"),i=w(),n=d("ion-label"),o=d("p"),o.textContent=s,a=w(),h=d("h2"),m=Oe(E),_=w(),v=d("ion-icon"),this.h()},l(p){e=f(p,"ION-ITEM",{href:!0});var k=g(e);t=f(k,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(c),i=N(k),n=f(k,"ION-LABEL",{class:!0});var O=g(n);o=f(O,"P",{"data-svelte-h":!0}),le(o)!=="svelte-1ub9uzw"&&(o.textContent=s),a=N(O),h=f(O,"H2",{});var y=g(h);m=ye(y,E),y.forEach(c),O.forEach(c),_=N(k),v=f(k,"ION-ICON",{icon:!0,slot:!0}),g(v).forEach(c),k.forEach(c),this.h()},h(){b(t,"icon",Tt),b(t,"slot","start"),b(n,"class","ion-text-wrap"),b(v,"icon",je),b(v,"slot","end"),b(e,"href","https://www.google.com/maps/searhc/?api=1&query="+l[12].line2)},m(p,k){W(p,e,k),r(e,t),r(e,i),r(e,n),r(n,o),r(n,a),r(n,h),r(h,m),r(e,_),r(e,v)},p:Me,d(p){p&&c(e)}}}function wi(l){let e,t,i,n,o,s="Domicilio",a,h,E=l[12].line1+"",m,_,v,p,k=l[12].line2&&l[12].line2.trim().length,O,y=k&&Ni(l);return{c(){e=d("ion-item"),t=d("ion-icon"),i=w(),n=d("ion-label"),o=d("p"),o.textContent=s,a=w(),h=d("h2"),m=Oe(E),_=w(),v=d("ion-icon"),p=w(),y&&y.c(),O=Ae(),this.h()},l(B){e=f(B,"ION-ITEM",{href:!0});var P=g(e);t=f(P,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(c),i=N(P),n=f(P,"ION-LABEL",{class:!0});var R=g(n);o=f(R,"P",{"data-svelte-h":!0}),le(o)!=="svelte-cbm7q1"&&(o.textContent=s),a=N(R),h=f(R,"H2",{});var U=g(h);m=ye(U,E),U.forEach(c),R.forEach(c),_=N(P),v=f(P,"ION-ICON",{icon:!0,slot:!0}),g(v).forEach(c),P.forEach(c),p=N(B),y&&y.l(B),O=Ae(),this.h()},h(){b(t,"icon",Tt),b(t,"slot","start"),b(n,"class","ion-text-wrap"),b(v,"icon",je),b(v,"slot","end"),b(e,"href","https://www.google.com/maps/search/?api=1&query="+l[12].line1)},m(B,P){W(B,e,P),r(e,t),r(e,i),r(e,n),r(n,o),r(n,a),r(n,h),r(h,m),r(e,_),r(e,v),W(B,p,P),y&&y.m(B,P),W(B,O,P)},p(B,P){k&&y.p(B,P)},d(B){B&&(c(e),c(p),c(O)),y&&y.d(B)}}}function Ni(l){let e,t,i,n,o,s="Domicilio Alternativo",a,h,E=l[12].line2+"",m,_,v;return{c(){e=d("ion-item"),t=d("ion-icon"),i=w(),n=d("ion-label"),o=d("p"),o.textContent=s,a=w(),h=d("h2"),m=Oe(E),_=w(),v=d("ion-icon"),this.h()},l(p){e=f(p,"ION-ITEM",{href:!0});var k=g(e);t=f(k,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(c),i=N(k),n=f(k,"ION-LABEL",{class:!0});var O=g(n);o=f(O,"P",{"data-svelte-h":!0}),le(o)!=="svelte-1ub9uzw"&&(o.textContent=s),a=N(O),h=f(O,"H2",{});var y=g(h);m=ye(y,E),y.forEach(c),O.forEach(c),_=N(k),v=f(k,"ION-ICON",{icon:!0,slot:!0}),g(v).forEach(c),k.forEach(c),this.h()},h(){b(t,"icon",Tt),b(t,"slot","start"),b(n,"class","ion-text-wrap"),b(v,"icon",je),b(v,"slot","end"),b(e,"href","https://www.google.com/maps/search/?api=1&query="+l[12].line2)},m(p,k){W(p,e,k),r(e,t),r(e,i),r(e,n),r(n,o),r(n,a),r(n,h),r(h,m),r(e,_),r(e,v)},p:Me,d(p){p&&c(e)}}}function Ti(l){let e,t,i,n,o,s="Contacto del Cliente",a,h,E,m,_=l[16]&&l[16]==="1"&&Ci(l);return{c(){e=d("ion-item"),t=d("ion-icon"),i=w(),n=d("ion-label"),o=d("p"),o.textContent=s,a=w(),h=d("h2"),E=Oe(l[18]),m=w(),_&&_.c(),this.h()},l(v){e=f(v,"ION-ITEM",{});var p=g(e);t=f(p,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(c),i=N(p),n=f(p,"ION-LABEL",{class:!0});var k=g(n);o=f(k,"P",{"data-svelte-h":!0}),le(o)!=="svelte-1utsyb6"&&(o.textContent=s),a=N(k),h=f(k,"H2",{});var O=g(h);E=ye(O,l[18]),O.forEach(c),k.forEach(c),m=N(p),_&&_.l(p),p.forEach(c),this.h()},h(){b(t,"icon",xn),b(t,"slot","start"),b(n,"class","ion-text-wrap")},m(v,p){W(v,e,p),r(e,t),r(e,i),r(e,n),r(n,o),r(n,a),r(n,h),r(h,E),r(e,m),_&&_.m(e,null)},p(v,p){v[16]&&v[16]==="1"&&_.p(v,p)},d(v){v&&c(e),_&&_.d()}}}function Ci(l){let e,t=`<ion-icon icon="${Vn}" slot="start"></ion-icon>
                        Notificar Cliente`,i,n;return{c(){e=d("ion-button"),e.innerHTML=t,this.h()},l(o){e=f(o,"ION-BUTTON",{fill:!0,style:!0,"data-svelte-h":!0}),le(e)!=="svelte-149vhpt"&&(e.innerHTML=t),this.h()},h(){b(e,"fill","outline"),u(e,"margin-left","16px")},m(o,s){W(o,e,s),i||(n=fe(e,"click",l[25]),i=!0)},p:Me,d(o){o&&c(e),i=!1,n()}}}function Li(l){let e,t,i,n,o,s="Notas de ubicación",a,h,E;return{c(){e=d("ion-item"),t=d("ion-icon"),i=w(),n=d("ion-label"),o=d("p"),o.textContent=s,a=w(),h=d("h2"),E=Oe(l[19]),this.h()},l(m){e=f(m,"ION-ITEM",{});var _=g(e);t=f(_,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(c),i=N(_),n=f(_,"ION-LABEL",{class:!0});var v=g(n);o=f(v,"P",{"data-svelte-h":!0}),le(o)!=="svelte-nhm2ft"&&(o.textContent=s),a=N(v),h=f(v,"H2",{});var p=g(h);E=ye(p,l[19]),p.forEach(c),v.forEach(c),_.forEach(c),this.h()},h(){b(t,"icon",kn),b(t,"slot","start"),b(n,"class","ion-text-wrap")},m(m,_){W(m,e,_),r(e,t),r(e,i),r(e,n),r(n,o),r(n,a),r(n,h),r(h,E)},p:Me,d(m){m&&c(e)}}}function Mi(l){let e,t,i,n,o,s="Horarios",a,h,E=l[12].schedule+"",m;return{c(){e=d("ion-item"),t=d("ion-icon"),i=w(),n=d("ion-label"),o=d("p"),o.textContent=s,a=w(),h=d("h2"),m=Oe(E),this.h()},l(_){e=f(_,"ION-ITEM",{});var v=g(e);t=f(v,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(c),i=N(v),n=f(v,"ION-LABEL",{});var p=g(n);o=f(p,"P",{"data-svelte-h":!0}),le(o)!=="svelte-11q7hm5"&&(o.textContent=s),a=N(p),h=f(p,"H2",{});var k=g(h);m=ye(k,E),k.forEach(c),p.forEach(c),v.forEach(c),this.h()},h(){b(t,"icon",Bn),b(t,"slot","start")},m(_,v){W(_,e,v),r(e,t),r(e,i),r(e,n),r(n,o),r(n,a),r(n,h),r(h,m)},p:Me,d(_){_&&c(e)}}}function Si(l){let e,t,i,n,o,s="Notas del operador",a,h,E=l[12].driver_comments+"",m;return{c(){e=d("ion-item"),t=d("ion-icon"),i=w(),n=d("ion-label"),o=d("p"),o.textContent=s,a=w(),h=d("h2"),m=Oe(E),this.h()},l(_){e=f(_,"ION-ITEM",{});var v=g(e);t=f(v,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(c),i=N(v),n=f(v,"ION-LABEL",{});var p=g(n);o=f(p,"P",{"data-svelte-h":!0}),le(o)!=="svelte-1yk9qp4"&&(o.textContent=s),a=N(p),h=f(p,"H2",{});var k=g(h);m=ye(k,E),k.forEach(c),p.forEach(c),v.forEach(c),this.h()},h(){b(t,"icon",In),b(t,"slot","start")},m(_,v){W(_,e,v),r(e,t),r(e,i),r(e,n),r(n,o),r(n,a),r(n,h),r(h,m)},p:Me,d(_){_&&c(e)}}}function Pi(l){let e,t=l[12].logistic_comments!="<br>"&&Ai(l);return{c(){t&&t.c(),e=Ae()},l(i){t&&t.l(i),e=Ae()},m(i,n){t&&t.m(i,n),W(i,e,n)},p(i,n){i[12].logistic_comments!="<br>"&&t.p(i,n)},d(i){i&&c(e),t&&t.d(i)}}}function Ai(l){let e,t,i,n,o,s="Comentarios logísticos",a,h,E=l[12].logistic_comments+"",m;return{c(){e=d("ion-item"),t=d("ion-icon"),i=w(),n=d("ion-label"),o=d("p"),o.textContent=s,a=w(),h=d("h2"),m=Oe(E),this.h()},l(_){e=f(_,"ION-ITEM",{});var v=g(e);t=f(v,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(c),i=N(v),n=f(v,"ION-LABEL",{class:!0});var p=g(n);o=f(p,"P",{"data-svelte-h":!0}),le(o)!=="svelte-1iz85r6"&&(o.textContent=s),a=N(p),h=f(p,"H2",{});var k=g(h);m=ye(k,E),k.forEach(c),p.forEach(c),v.forEach(c),this.h()},h(){b(t,"icon",kn),b(t,"slot","start"),b(n,"class","ion-text-wrap")},m(_,v){W(_,e,v),r(e,t),r(e,i),r(e,n),r(n,o),r(n,a),r(n,h),r(h,m)},p:Me,d(_){_&&c(e)}}}function Di(l){let e,t,i,n,o="<p>Etiqueta</p>",s,a,h=(l[12].tag?l[12].tag:"")+"",E;return{c(){e=d("ion-item"),t=d("ion-icon"),i=w(),n=d("ion-label"),n.innerHTML=o,s=w(),a=d("div"),E=Oe(h),this.h()},l(m){e=f(m,"ION-ITEM",{});var _=g(e);t=f(_,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(c),i=N(_),n=f(_,"ION-LABEL",{class:!0,"data-svelte-h":!0}),le(n)!=="svelte-50rr6d"&&(n.innerHTML=o),s=N(_),a=f(_,"DIV",{class:!0,style:!0});var v=g(a);E=ye(v,h),v.forEach(c),_.forEach(c),this.h()},h(){b(t,"icon",Un),b(t,"slot","start"),b(n,"class","ion-text-wrap"),j(a,"class","stop-tag"),u(a,"background-color",l[20]),u(a,"border","1px solid "+l[21]),u(a,"color",l[12].tag_color),u(a,"font-size","14px"),u(a,"text-align","center"),u(a,"align-content","center"),u(a,"border-radius","20px"),u(a,"white-space","normal"),u(a,"padding","4px 8px"),u(a,"width","auto",1),u(a,"display","inline-block")},m(m,_){W(m,e,_),r(e,t),r(e,i),r(e,n),r(e,s),r(e,a),r(a,E)},p:Me,d(m){m&&c(e)}}}function xi(l){let e,t,i,n,o="<p>Estado de entrega</p>",s,a,h,E="Entregado",m,_,v="No Entregado",p,k,O="Entrega Parcial",y,B,P,R,U,Q="<p>Notas</p>",q,L,H,x,I,A,V,M=l[12].status!=="completed"&&l[17]==="1"&&Bi(l),X=l[5]===!0&&Bt(l),J=(l[6]===!0||l[6]===!1&&l[5]===!1)&&Ut(l);return{c(){e=d("ion-item"),t=d("ion-icon"),i=w(),n=d("ion-label"),n.innerHTML=o,s=w(),a=d("ion-select"),h=d("ion-select-option"),h.textContent=E,m=w(),_=d("ion-select-option"),_.textContent=v,p=w(),k=d("ion-select-option"),k.textContent=O,y=w(),B=d("ion-item"),P=d("ion-icon"),R=w(),U=d("ion-label"),U.innerHTML=Q,q=w(),L=d("ion-textarea"),H=w(),M&&M.c(),x=w(),I=d("section"),X&&X.c(),A=w(),J&&J.c(),this.h()},l(G){e=f(G,"ION-ITEM",{});var ne=g(e);t=f(ne,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(c),i=N(ne),n=f(ne,"ION-LABEL",{class:!0,"data-svelte-h":!0}),le(n)!=="svelte-1ql9csq"&&(n.innerHTML=o),s=N(ne),a=f(ne,"ION-SELECT",{value:!0});var _e=g(a);h=f(_e,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),le(h)!=="svelte-1nhq8vd"&&(h.textContent=E),m=N(_e),_=f(_e,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),le(_)!=="svelte-dhd4r3"&&(_.textContent=v),p=N(_e),k=f(_e,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),le(k)!=="svelte-17taxwo"&&(k.textContent=O),_e.forEach(c),ne.forEach(c),y=N(G),B=f(G,"ION-ITEM",{});var D=g(B);P=f(D,"ION-ICON",{icon:!0,slot:!0}),g(P).forEach(c),R=N(D),U=f(D,"ION-LABEL",{class:!0,"data-svelte-h":!0}),le(U)!=="svelte-c9yniu"&&(U.innerHTML=Q),q=N(D),L=f(D,"ION-TEXTAREA",{placeholder:!0}),g(L).forEach(c),D.forEach(c),H=N(G),M&&M.l(G),x=N(G),I=f(G,"SECTION",{style:!0});var se=g(I);X&&X.l(se),A=N(se),J&&J.l(se),se.forEach(c),this.h()},h(){b(t,"icon",Hn),b(t,"slot","start"),b(n,"class","ion-text-wrap"),b(h,"value","delivered"),b(_,"value","notdelivered"),b(k,"value","partialdeliver"),b(a,"value",l[15]?l[15]:"delivered"),b(P,"icon",ht),b(P,"slot","start"),b(U,"class","ion-text-wrap"),b(L,"placeholder","Escribe aquí..."),u(I,"display","flex"),u(I,"gap","8px"),u(I,"padding","16px 16px 6px")},m(G,ne){W(G,e,ne),r(e,t),r(e,i),r(e,n),r(e,s),r(e,a),r(a,h),r(a,m),r(a,_),r(a,p),r(a,k),l[34](a),W(G,y,ne),W(G,B,ne),r(B,P),r(B,R),r(B,U),r(B,q),r(B,L),l[35](L),W(G,H,ne),M&&M.m(G,ne),W(G,x,ne),W(G,I,ne),X&&X.m(I,null),r(I,A),J&&J.m(I,null),V=!0},p(G,ne){G[12].status!=="completed"&&G[17]==="1"&&M.p(G,ne),G[5]===!0?X?X.p(G,ne):(X=Bt(G),X.c(),X.m(I,A)):X&&(X.d(1),X=null),G[6]===!0||G[6]===!1&&G[5]===!1?J?J.p(G,ne):(J=Ut(G),J.c(),J.m(I,null)):J&&(J.d(1),J=null)},i(G){V||($e(M),V=!0)},o(G){it(M),V=!1},d(G){G&&(c(e),c(y),c(B),c(H),c(x),c(I)),l[34](null),l[35](null),M&&M.d(G),X&&X.d(),J&&J.d()}}}function Bi(l){let e,t,i="<p>Firma de entregado</p>",n,o,s,a,h,E,m,_,v,p,k,O,y,B,P,R,U,Q,q={};return a=new bi({props:q}),l[36](a),{c(){e=d("section"),t=d("ion-label"),t.innerHTML=i,n=w(),o=d("br"),s=w(),vn(a.$$.fragment),h=w(),E=d("section"),m=d("ion-button"),_=d("ion-icon"),v=Oe(`
                        Borrar`),k=w(),O=d("ion-button"),y=d("ion-icon"),B=Oe(`
                        Guardar`),this.h()},l(L){e=f(L,"SECTION",{style:!0});var H=g(e);t=f(H,"ION-LABEL",{class:!0,style:!0,"data-svelte-h":!0}),le(t)!=="svelte-1lie3gz"&&(t.innerHTML=i),n=N(H),o=f(H,"BR",{}),s=N(H),gn(a.$$.fragment,H),H.forEach(c),h=N(L),E=f(L,"SECTION",{style:!0});var x=g(E);m=f(x,"ION-BUTTON",{style:!0,fill:!0,disabled:!0});var I=g(m);_=f(I,"ION-ICON",{icon:!0,slot:!0}),g(_).forEach(c),v=ye(I,`
                        Borrar`),I.forEach(c),k=N(x),O=f(x,"ION-BUTTON",{style:!0,disabled:!0});var A=g(O);y=f(A,"ION-ICON",{icon:!0,slot:!0}),g(y).forEach(c),B=ye(A,`
                        Guardar`),A.forEach(c),x.forEach(c),this.h()},h(){b(t,"class","ion-text-wrap"),u(t,"padding","10px 0px"),u(e,"display","flex"),u(e,"flex-direction","column"),u(e,"align-items","center"),u(e,"padding","0px 16px 16px"),b(_,"icon",vt),b(_,"slot","start"),u(m,"flex","1"),b(m,"fill","outline"),b(m,"disabled",p=l[11]||l[12].status=="completed"),b(y,"icon",Rn),b(y,"slot","start"),u(O,"flex","1"),b(O,"disabled",P=l[11]||l[12].status=="completed"),u(E,"display","flex"),u(E,"gap","8px"),u(E,"padding","0px 16px")},m(L,H){W(L,e,H),r(e,t),r(e,n),r(e,o),r(e,s),bn(a,e,null),W(L,h,H),W(L,E,H),r(E,m),r(m,_),r(m,v),r(E,k),r(E,O),r(O,y),r(O,B),R=!0,U||(Q=[fe(m,"click",l[32]),fe(O,"click",l[31])],U=!0)},p(L,H){const x={};a.$set(x),(!R||H[0]&2048&&p!==(p=L[11]||L[12].status=="completed"))&&b(m,"disabled",p),(!R||H[0]&2048&&P!==(P=L[11]||L[12].status=="completed"))&&b(O,"disabled",P)},i(L){R||($e(a.$$.fragment,L),R=!0)},o(L){it(a.$$.fragment,L),R=!1},d(L){L&&(c(e),c(h),c(E)),l[36](null),En(a),U=!1,Ue(Q)}}}function Bt(l){let e,t=`<ion-icon icon="${Fn}" slot="start"></ion-icon>
                        Ingreso`,i,n;return{c(){e=d("ion-button"),e.innerHTML=t,this.h()},l(o){e=f(o,"ION-BUTTON",{id:!0,style:!0,"data-svelte-h":!0}),le(e)!=="svelte-izs0s1"&&(e.innerHTML=t),this.h()},h(){b(e,"id","checkInBtn"),u(e,"flex","1")},m(o,s){W(o,e,s),i||(n=fe(e,"click",l[26]),i=!0)},p:Me,d(o){o&&c(e),i=!1,n()}}}function Ut(l){let e,t,i,n,o,s;return{c(){e=d("ion-button"),t=d("ion-icon"),i=Oe(`
                        Salida`),this.h()},l(a){e=f(a,"ION-BUTTON",{id:!0,style:!0,disabled:!0});var h=g(e);t=f(h,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(c),i=ye(h,`
                        Salida`),h.forEach(c),this.h()},h(){b(t,"icon",zn),b(t,"slot","start"),b(e,"id","checkOutBtn"),u(e,"flex","1"),b(e,"disabled",n=l[6]===!1)},m(a,h){W(a,e,h),r(e,t),r(e,i),o||(s=fe(e,"click",l[27]),o=!0)},p(a,h){h[0]&64&&n!==(n=a[6]===!1)&&b(e,"disabled",n)},d(a){a&&c(e),o=!1,s()}}}function Ui(l){let e,t,i,n,o,s,a,h;return{c(){e=d("section"),t=d("ion-button"),i=d("label"),n=d("ion-icon"),o=Oe(`
                        Subir Evidencia
                        `),s=d("input"),this.h()},l(E){e=f(E,"SECTION",{style:!0});var m=g(e);t=f(m,"ION-BUTTON",{fill:!0,class:!0,style:!0,disabled:!0});var _=g(t);i=f(_,"LABEL",{for:!0,style:!0});var v=g(i);n=f(v,"ION-ICON",{icon:!0,slot:!0,style:!0}),g(n).forEach(c),o=ye(v,`
                        Subir Evidencia
                        `),s=f(v,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0,capture:!0}),v.forEach(c),_.forEach(c),m.forEach(c),this.h()},h(){b(n,"icon",Nt),b(n,"slot","start"),u(n,"vertical-align","middle"),u(s,"display","none"),j(s,"id","eventEvidence"),j(s,"name","fileToUpload"),j(s,"type","file"),s.multiple=!0,j(s,"accept","image/*"),j(s,"capture","environment"),j(i,"for","eventEvidence"),u(i,"width","100%"),u(i,"height","100%"),b(t,"fill","outline"),b(t,"class","loadEvidence"),u(t,"flex","1"),u(t,"display","flex"),u(t,"align-items","center"),u(t,"gap","8px"),b(t,"disabled",l[12].status=="completed"),u(e,"display","flex"),u(e,"gap","8px"),u(e,"padding","0px 16px")},m(E,m){W(E,e,m),r(e,t),r(t,i),r(i,n),r(i,o),r(i,s),a||(h=[fe(s,"change",l[22]),fe(s,"click",l[23])],a=!0)},p:Me,d(E){E&&c(e),a=!1,Ue(h)}}}function Ht(l){let e,t,i=He(l[3]),n=[];for(let o=0;o<i.length;o+=1)n[o]=Rt(xt(l,i,o));return{c(){e=d("section"),t=d("div");for(let o=0;o<n.length;o+=1)n[o].c();this.h()},l(o){e=f(o,"SECTION",{});var s=g(e);t=f(s,"DIV",{class:!0,style:!0});var a=g(t);for(let h=0;h<n.length;h+=1)n[h].l(a);a.forEach(c),s.forEach(c),this.h()},h(){j(t,"class","image-grid"),u(t,"display","grid"),u(t,"grid-template-columns","repeat(auto-fill, minmax(100px, 1fr))"),u(t,"gap","10px"),u(t,"padding","0px 10px")},m(o,s){W(o,e,s),r(e,t);for(let a=0;a<n.length;a+=1)n[a]&&n[a].m(t,null)},p(o,s){if(s[0]&1342181384){i=He(o[3]);let a;for(a=0;a<i.length;a+=1){const h=xt(o,i,a);n[a]?n[a].p(h,s):(n[a]=Rt(h),n[a].c(),n[a].m(t,null))}for(;a<n.length;a+=1)n[a].d(1);n.length=i.length}},d(o){o&&c(e),mt(n,o)}}}function Hi(l){let e,t=`<ion-icon icon="${vt}"></ion-icon>`,i,n;function o(){return l[38](l[60])}return{c(){e=d("button"),e.innerHTML=t,this.h()},l(s){e=f(s,"BUTTON",{class:!0,style:!0,"data-svelte-h":!0}),le(e)!=="svelte-mf38w5"&&(e.innerHTML=t),this.h()},h(){j(e,"class","remove-button"),u(e,"position","absolute"),u(e,"top","5px"),u(e,"right","5px"),u(e,"border","none"),u(e,"cursor","pointer"),u(e,"font-size","18px"),u(e,"background","white"),u(e,"border-radius","50%"),u(e,"padding","3px 4px 0px"),u(e,"box-shadow","2px 2px 6px rgba(0, 0, 0, 0.3)"),u(e,"color","#0000008f")},m(s,a){W(s,e,a),i||(n=fe(e,"click",o),i=!0)},p(s,a){l=s},d(s){s&&c(e),i=!1,n()}}}function Rt(l){let e,t,i,n,o,s,a;function h(){return l[37](l[58])}let E=l[12].status!=="completed"&&Hi(l);return{c(){e=d("div"),t=d("ion-img"),n=w(),E&&E.c(),o=w(),this.h()},l(m){e=f(m,"DIV",{class:!0,style:!0});var _=g(e);t=f(_,"ION-IMG",{src:!0,alt:!0,style:!0}),g(t).forEach(c),n=N(_),E&&E.l(_),o=N(_),_.forEach(c),this.h()},h(){Fe(t.src,i=l[58])||b(t,"src",i),b(t,"alt","Evidencia fotográfica"),u(t,"width","100%"),u(t,"height","100px"),u(t,"object-fit","cover"),u(t,"cursor","pointer"),u(t,"border","1px solid #ccc"),u(t,"border-radius","4px"),u(t,"margin-top","16px"),j(e,"class","image-container"),u(e,"position","relative")},m(m,_){W(m,e,_),r(e,t),r(e,n),E&&E.m(e,null),r(e,o),s||(a=fe(t,"click",h),s=!0)},p(m,_){l=m,_[0]&8&&!Fe(t.src,i=l[58])&&b(t,"src",i),l[12].status!=="completed"&&E.p(l,_)},d(m){m&&c(e),E&&E.d(),s=!1,a()}}}function zt(l){let e,t='<ion-spinner name="dots" style="color:white;"></ion-spinner>';return{c(){e=d("div"),e.innerHTML=t,this.h()},l(i){e=f(i,"DIV",{class:!0,style:!0,"data-svelte-h":!0}),le(e)!=="svelte-1aosxw0"&&(e.innerHTML=t),this.h()},h(){j(e,"class","overlay"),u(e,"position","fixed"),u(e,"top","0"),u(e,"left","0"),u(e,"width","100vw"),u(e,"height","100vh"),u(e,"background","rgba(0, 0, 0, 0.5)"),u(e,"display","flex"),u(e,"align-items","center"),u(e,"justify-content","center"),u(e,"z-index","9999")},m(i,n){W(i,e,n)},d(i){i&&c(e)}}}function Vt(l){let e,t,i,n,o,s,a=`<ion-icon icon="${Ct}"></ion-icon>`,h,E;return{c(){e=d("div"),t=d("div"),i=d("ion-img"),o=w(),s=d("button"),s.innerHTML=a,this.h()},l(m){e=f(m,"DIV",{class:!0,style:!0});var _=g(e);t=f(_,"DIV",{class:!0,style:!0});var v=g(t);i=f(v,"ION-IMG",{src:!0,alt:!0,style:!0}),g(i).forEach(c),o=N(v),s=f(v,"BUTTON",{class:!0,style:!0,"data-svelte-h":!0}),le(s)!=="svelte-183t4ti"&&(s.innerHTML=a),v.forEach(c),_.forEach(c),this.h()},h(){Fe(i.src,n=l[8])||b(i,"src",n),b(i,"alt","Evidencia fotográfica"),u(i,"width","100%"),u(i,"height","auto"),j(s,"class","close-button"),u(s,"position","absolute"),u(s,"top","5px"),u(s,"right","5px"),u(s,"background","white"),u(s,"color","#444444d1"),u(s,"border","none"),u(s,"cursor","pointer"),u(s,"padding","2px 2px 0px 6px"),u(s,"border-radius","50%"),u(s,"font-size","20px"),j(t,"class","modal-content"),u(t,"position","relative"),u(t,"background","white"),u(t,"padding","20px"),u(t,"border-radius","8px"),u(t,"max-width","90vw"),u(t,"max-height","90vh"),u(t,"overflow","auto"),j(e,"class","modal-overlay"),u(e,"position","fixed"),u(e,"top","0"),u(e,"left","0"),u(e,"width","100vw"),u(e,"height","100vh"),u(e,"background","rgba(0, 0, 0, 0.8)"),u(e,"display","flex"),u(e,"justify-content","center"),u(e,"align-items","center"),u(e,"z-index","1000")},m(m,_){W(m,e,_),r(e,t),r(t,i),r(t,o),r(t,s),h||(E=[fe(s,"click",l[29]),fe(t,"click",yt(l[33])),fe(e,"click",l[29])],h=!0)},p(m,_){_[0]&256&&!Fe(i.src,n=m[8])&&b(i,"src",n)},d(m){m&&c(e),h=!1,Ue(E)}}}function Ri(l){let e,t,i,n,o="Cerrar",s,a,h=l[12].title+"",E,m,_,v,p,k,O=l[12].client_phone&&l[12].client_phone.trim().length,y,B,P,R,U=l[12].schedule&&l[12].schedule.trim().length,Q,q,L=l[12].logistic_comments&&l[12].logistic_comments.trim().length,H,x,I,A,V,M,X,J,G,ne,_e=(!l[13]&&!l[14]||l[13]&&l[14])&&Ei(l);function D(K,ge){return K[12].client_name!=null?Ii:ki}let me=D(l)(l),ue=O&&Oi(l);function ae(K,ge){if(K[12].line1&&K[12].line1.trim().length)return wi;if(K[12].line2&&K[12].line2.trim().length)return yi}let oe=ae(l),ce=oe&&oe(l),pe=l[18]&&Ti(l),re=l[19]&&l[19]!=="<br>"&&Li(l),te=U&&Mi(l),be=l[12].driver_comments&&Si(l),ve=L&&Pi(l),Ee=l[12].tag&&l[12].tag_color&&Di(l),de=!l[14]&&xi(l),he=(l[13]&&l[14]||!l[13]&&!l[14])&&Ui(l),ee=l[2]&&Ht(l),$=l[4]&&zt(),ie=l[7]&&Vt(l);return{c(){e=d("ion-header"),t=d("ion-toolbar"),i=d("ion-buttons"),n=d("ion-button"),n.textContent=o,s=w(),a=d("ion-title"),E=Oe(h),m=w(),_e&&_e.c(),_=w(),v=d("ion-content"),p=d("ion-list"),me.c(),k=w(),ue&&ue.c(),y=w(),ce&&ce.c(),B=w(),pe&&pe.c(),P=w(),re&&re.c(),R=w(),te&&te.c(),Q=w(),be&&be.c(),q=w(),ve&&ve.c(),H=w(),Ee&&Ee.c(),x=w(),de&&de.c(),I=w(),he&&he.c(),A=w(),ee&&ee.c(),V=w(),$&&$.c(),M=w(),ie&&ie.c(),X=Ae(),this.h()},l(K){e=f(K,"ION-HEADER",{translucent:!0});var ge=g(e);t=f(ge,"ION-TOOLBAR",{});var Se=g(t);i=f(Se,"ION-BUTTONS",{slot:!0});var Le=g(i);n=f(Le,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),le(n)!=="svelte-2ks32x"&&(n.textContent=o),Le.forEach(c),s=N(Se),a=f(Se,"ION-TITLE",{style:!0,title:!0});var Te=g(a);E=ye(Te,h),Te.forEach(c),m=N(Se),_e&&_e.l(Se),Se.forEach(c),ge.forEach(c),_=N(K),v=f(K,"ION-CONTENT",{fullscreen:!0});var Z=g(v);p=f(Z,"ION-LIST",{});var T=g(p);me.l(T),k=N(T),ue&&ue.l(T),y=N(T),ce&&ce.l(T),B=N(T),pe&&pe.l(T),P=N(T),re&&re.l(T),R=N(T),te&&te.l(T),Q=N(T),be&&be.l(T),q=N(T),ve&&ve.l(T),H=N(T),Ee&&Ee.l(T),x=N(T),de&&de.l(T),I=N(T),he&&he.l(T),A=N(T),ee&&ee.l(T),T.forEach(c),Z.forEach(c),V=N(K),$&&$.l(K),M=N(K),ie&&ie.l(K),X=Ae(),this.h()},h(){b(n,"color","medium"),b(i,"slot","start"),u(a,"text-align","center"),b(a,"title",l[12].title),b(e,"translucent",""),b(v,"fullscreen","")},m(K,ge){W(K,e,ge),r(e,t),r(t,i),r(i,n),r(t,s),r(t,a),r(a,E),r(t,m),_e&&_e.m(t,null),W(K,_,ge),W(K,v,ge),r(v,p),me.m(p,null),r(p,k),ue&&ue.m(p,null),r(p,y),ce&&ce.m(p,null),r(p,B),pe&&pe.m(p,null),r(p,P),re&&re.m(p,null),r(p,R),te&&te.m(p,null),r(p,Q),be&&be.m(p,null),r(p,q),ve&&ve.m(p,null),r(p,H),Ee&&Ee.m(p,null),r(p,x),de&&de.m(p,null),r(p,I),he&&he.m(p,null),r(p,A),ee&&ee.m(p,null),W(K,V,ge),$&&$.m(K,ge),W(K,M,ge),ie&&ie.m(K,ge),W(K,X,ge),J=!0,G||(ne=fe(n,"click",l[0]),G=!0)},p(K,ge){(!K[13]&&!K[14]||K[13]&&K[14])&&_e.p(K,ge),me.p(K,ge),O&&ue.p(K,ge),ce&&ce.p(K,ge),K[18]&&pe.p(K,ge),K[19]&&K[19]!=="<br>"&&re.p(K,ge),U&&te.p(K,ge),K[12].driver_comments&&be.p(K,ge),L&&ve.p(K,ge),K[12].tag&&K[12].tag_color&&Ee.p(K,ge),K[14]||de.p(K,ge),(K[13]&&K[14]||!K[13]&&!K[14])&&he.p(K,ge),K[2]?ee?ee.p(K,ge):(ee=Ht(K),ee.c(),ee.m(p,null)):ee&&(ee.d(1),ee=null),K[4]?$||($=zt(),$.c(),$.m(M.parentNode,M)):$&&($.d(1),$=null),K[7]?ie?ie.p(K,ge):(ie=Vt(K),ie.c(),ie.m(X.parentNode,X)):ie&&(ie.d(1),ie=null)},i(K){J||($e(de),J=!0)},o(K){it(de),J=!1},d(K){K&&(c(e),c(_),c(v),c(V),c(M),c(X)),_e&&_e.d(),me.d(),ue&&ue.d(),ce&&ce.d(),pe&&pe.d(),re&&re.d(),te&&te.d(),be&&be.d(),ve&&ve.d(),Ee&&Ee.d(),de&&de.d(),he&&he.d(),ee&&ee.d(),$&&$.d(K),ie&&ie.d(K),G=!1,ne()}}}function zi(l){const[e,t]=l.split(","),i=e.match(/:(.*?);/)[1],n=atob(t),o=n.length,s=new Uint8Array(o);for(let a=0;a<o;a++)s[a]=n.charCodeAt(a);return new Blob([s],{type:i})}function Vi(l,e,t){let i=at,n=document.querySelector("ion-modal"),o=n.componentProps.delivery,s=n.componentProps.isLast||!1,a=n.componentProps.flag||!1,h=o.driver_comments?o.driver_comments:"",E=o.deliver_status?o.deliver_status:"",m=o.img?o.img:"",_=o.img_id?o.img_id:"",v=m?Ge(m):new Array,p=_?Ge(_):new Array,k={latitude:null,longitude:null},O=o.stopsApproval,y=o.smsActive,B=o.signatureActive,P=!1,R=!0,U=!1,Q=o.phone_notification,q=o.comments_ext,L=!1,H="",x=new Object,I="",A=o.tag_color?ze(o.tag_color,.2):"",V=o.tag_color?ze(o.tag_color,.3):"",M,X=!1;et(()=>{x=JSON.parse(localStorage.getItem("userSession")),J()});function J(){o.date_service?o.date_service&&!o.date_completed&&!o.service_time?(t(5,R=!1),t(6,U=!0)):o.date_service&&o.date_completed&&o.service_time&&(t(5,R=!1),t(6,U=!1)):(t(5,R=!0),t(6,U=!1))}const G=async(C,F)=>{await(await qe.create({header:C||"Error",message:F||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()},ne=async(C="",F="",S="",Y=function(Ne={}){},ke={})=>{await(await qe.create({header:C||"Error",message:F||"Vuelva a intentar",buttons:[{text:"No",role:"cancel",handler:()=>{}},{text:"Sí",handler:()=>{t(4,P=!0),Ve(S,function(Ce={}){t(4,P=!1),Y(Ce)},ke)}}]})).present()};async function _e(C,F){await(await qe.create({header:"¿Cómo quieres notificar?",message:`Elige el medio para enviar mensaje a ${C.title} (${F})`,buttons:[{text:"SMS",handler:()=>re("sms",C,F)},{text:"WhatsApp",handler:()=>re("whatsapp",C,F)}]})).present()}const D=async C=>{if(v.length>=5){G("Límite de evidencias","Solo se permite subir 5 fotos por parada");return}if(a&&s&&v.length>=1){G("Límite de evidencias","Para el final de la ruta solo se permite subir 1 foto");return}const S=C.target.files[0];if(S)try{t(4,P=!0);const Y=await ue(S);Y&&Ve(`${i}api/admin/manager/upload_img_driver.php`,function(ke){ke.success?(t(2,m=m?`${m},${ke.img}`:ke.img),_=_?`${_},${ke.img_id}`:ke.img_id,t(3,v=Ge(m)),p=Ge(_)):G("Carga fallida","Actualiza la página y vuelve a intentar. Si el problema persiste, contacta a soporte.")},{fileToUpload:Y})}catch(Y){console.error("Compression error:",Y)}finally{t(4,P=!1)}};function se(C){var F=o.service_time;!F&&R&&!s&&!a&&(C.preventDefault(),G("Registrar Ingreso","Antes de subir la evidencia registra el ingreso a la actual parada."))}function me(){var C=a?o.date_completed:!1;if(!C&&!R&&U&&!s&&!a){var F=new Object;F.id_event=o.id_event,F.type="checkout",F.id_user_over=x.id_user,F.token=x.token,ne("Registrar Salida","¿Completaste tu entrega?",i+"api/admin/route/record_check_date.php",function(S){S.minutes&&G("Tiempo por parada","Completaste la parada en "+S.minutes+" minutos.")},F)}}const ue=async C=>new Promise(F=>{const S=new Image;S.src=URL.createObjectURL(C),S.onload=()=>{const Y=document.createElement("canvas"),ke=Y.getContext("2d"),Ne=800,Ce=600;let Ie=S.width,we=S.height;Ie>Ne&&(we*=Ne/Ie,Ie=Ne),we>Ce&&(Ie*=Ce/we,we=Ce),Y.width=Ie,Y.height=we,ke.drawImage(S,0,0,Ie,we),Y.toBlob(Re=>{F(Re),URL.revokeObjectURL(S.src),ke.clearRect(0,0,Y.width,Y.height)},"image/jpeg",.7)}});async function ae(){try{if(n!=null&&n.isConnected){await n.dismiss({data:Date.now()});return}const C=await tt.getTop();C&&await C.dismiss({data:Date.now()})}catch{console.warn("Close Modal Safe: modal ya cerrado o inexistente")}}const oe=async()=>{if(!P){t(4,P=!0);try{if(t(2,m=v.join(",")),_=p.join(","),me(),await pe())if(I.value=="delivered"||I.value!=="delivered"&&(h.value||o.driver_comments)||a&&s){const F={id_route:o.id_route,...!a&&!s&&{id_event:o.id_event},...!a&&!s&&{comments:h.value},...!a&&!s&&{deliver_status:I.value},img:m,img_id:_,lat:k.latitude,lon:k.longitude,...O==="0"&&{approve:"0"},...s&&{isLast:!0},...a&&s&&{destiny:!0},id_user_over:x.id_user,token:x.token};F.img&&F.img_id||m?Ve(`${i}api/admin/evidence/send_evidence.php`,function(S){if(S.success==!0){ae();const Y=F.id_route;s&&(ce("","",Y,s),O=="0"&&$(Y,"completed"))}else t(4,P=!1),G("Carga fallida","Actualiza la página y vuelve a intentar cargar la información!")},F):G("Información incompleta","Cargar evidencia fotográfica faltante para completar parada.")}else G("Motivo de status de entrega","Favor de ingresar en notas el motivo por el que la entrega no fue entregada correctamente");else G("Ubicación faltante","Asegúrate darle permisos a Rutaflow para acceder a tu ubicación")}catch(C){console.error("Error fetching data:",C)}finally{t(4,P=!1)}}},ce=(C,F,S,Y)=>{n.componentProps.routeId=S,n.componentProps.driverId=o.id_driver,We("modal-km-gas",Nn,{checklist:C,driverId:F,routeId:S,isLast:Y}).then(ke=>{})},pe=async()=>navigator.geolocation?new Promise((C,F)=>{navigator.geolocation.getCurrentPosition(S=>{k.latitude=S.coords.latitude,k.longitude=S.coords.longitude,C(!0)},S=>{console.error("Error getting location:",S),C(!1)})}):(console.error("Geolocation is not supported by your browser"),!1);async function re(C,F,S){const Y={};if(C==="sms"){Y.id_user_over=x.id_user,Y.token=x.token,Y.client_phone=S,Y.client_name=F.title,Y.delivery_phone=F.client_phone,Y.enterprise_name=F.enterprise_name,Ve(`${i}api/admin/message_central/send_sms.php`,te("SMS",F.title,S),Y);return}try{var ke=F.client_phone?`
Si deseas contactarnos, entra al siguiente link: https://wa.me/${F.client_phone}.`:".";Y.text=`*Rutaflow*

El repartidor va en camino a tu domicilio ${F.title}${ke}

Enviado por _${F.enterprise_name}_`,Y.phone=S;const Ce=await(await fetch(`${Yn}`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`${Qn}`},body:JSON.stringify(Y)})).json();te("WHATSAPP",F.title,S)(Ce)}catch(Ne){console.error(Ne),G("WHATSAPP no enviado","Ocurrió un error de red.")}}function te(C,F,S){return Y=>{Y.success?G(`${C} enviado`,`Se envió correctamente un ${C} a ${F} con número ${S}.`):G(`${C} no enviado`,`Hubo un error al enviar ${C} a ${F} (${S}).`)}}function be(C){C.stopPropagation(),_e(o,Q)}function ve(){t(5,R=!1),t(6,U=!0),de(o.id_event,"checkin")}function Ee(){t(6,U=!1),t(5,R=!1),de(o.id_event,"checkout")}async function de(C,F){if(F){let S=new Object;S.type=F,S.id_event=C,S.id_user_over=x.id_user,S.token=x.token;try{Ve(`${i}api/admin/route/record_check_date.php`,function(Y){Y.minutes&&G("Tiempo por parada","Completaste la parada en "+Y.minutes+" minutos.")},S)}catch(Y){console.error("Error during file upload:",Y)}finally{}}}const he=C=>{t(8,H=C),t(7,L=!0)},ee=()=>{t(7,L=!1),t(8,H="")};function $(C,F){let S=new Object;return S.id_route=C,S.status=F,S.id_user_over=x.id_user,S.token=x.token,Ve(`${i}api/admin/route/change_status.php`,function(){},S),""}function ie(C=0){var F=On(C,v,p,m);t(3,v=F.files),p=F.img_ids,t(2,m=F.selectedImages)}async function K(){const C=await M.save();if(C){t(11,X=!0);let F=zi(C);Ve(`${i}api/admin/manager/upload_img_driver.php`,function(S){S.success?(t(2,m=m?`${m},${S.img}`:S.img),_=_?`${_},${S.img_id}`:S.img_id,t(3,v=Ge(m)),p=Ge(_)):G("Carga fallida","Actualiza la página y vuelve a intentar. Si el problema persiste, contacta a soporte.")},{fileToUpload:F})}}function ge(){M.clear()}function Se(C){wt.call(this,l,C)}function Le(C){De[C?"unshift":"push"](()=>{I=C,t(9,I)})}function Te(C){De[C?"unshift":"push"](()=>{h=C,t(1,h)})}function Z(C){De[C?"unshift":"push"](()=>{M=C,t(10,M)})}return[ae,h,m,v,P,R,U,L,H,I,M,X,o,s,a,E,y,B,Q,q,A,V,D,se,oe,be,ve,Ee,he,ee,ie,K,ge,Se,Le,Te,Z,C=>he(C),C=>ie(C)]}class Ft extends Ye{constructor(e){super(),Qe(this,e,Vi,Ri,Je,{closeModal:0},null,[-1,-1])}get closeModal(){return this.$$.ctx[0]}}function jt(l,e,t){const i=l.slice();return i[32]=e[t],i[34]=t,i}function Wt(l){let e,t,i=He(l[1]),n=[];for(let o=0;o<i.length;o+=1)n[o]=qt(jt(l,i,o));return{c(){e=d("section"),t=d("div");for(let o=0;o<n.length;o+=1)n[o].c();this.h()},l(o){e=f(o,"SECTION",{});var s=g(e);t=f(s,"DIV",{class:!0,style:!0});var a=g(t);for(let h=0;h<n.length;h+=1)n[h].l(a);a.forEach(c),s.forEach(c),this.h()},h(){j(t,"class","image-grid"),u(t,"display","grid"),u(t,"grid-template-columns","repeat(auto-fill, minmax(100px, 1fr))"),u(t,"gap","10px"),u(t,"padding","0px 10px")},m(o,s){W(o,e,s),r(e,t);for(let a=0;a<n.length;a+=1)n[a]&&n[a].m(t,null)},p(o,s){if(s[0]&32770){i=He(o[1]);let a;for(a=0;a<i.length;a+=1){const h=jt(o,i,a);n[a]?n[a].p(h,s):(n[a]=qt(h),n[a].c(),n[a].m(t,null))}for(;a<n.length;a+=1)n[a].d(1);n.length=i.length}},d(o){o&&c(e),mt(n,o)}}}function qt(l){let e,t,i,n,o,s=`<ion-icon icon="${vt}"></ion-icon>`,a,h,E;function m(){return l[22](l[32])}function _(){return l[23](l[34])}return{c(){e=d("div"),t=d("ion-img"),n=w(),o=d("button"),o.innerHTML=s,a=w(),this.h()},l(v){e=f(v,"DIV",{class:!0,style:!0});var p=g(e);t=f(p,"ION-IMG",{src:!0,alt:!0,style:!0}),g(t).forEach(c),n=N(p),o=f(p,"BUTTON",{class:!0,style:!0,"data-svelte-h":!0}),le(o)!=="svelte-zguiov"&&(o.innerHTML=s),a=N(p),p.forEach(c),this.h()},h(){Fe(t.src,i=l[32])||b(t,"src",i),b(t,"alt","Evidencia fotográfica"),u(t,"width","100%"),u(t,"height","100px"),u(t,"object-fit","cover"),u(t,"cursor","pointer"),u(t,"border","1px solid #ccc"),u(t,"border-radius","4px"),u(t,"margin-top","16px"),j(o,"class","remove-button"),u(o,"position","absolute"),u(o,"top","5px"),u(o,"right","5px"),u(o,"border","none"),u(o,"cursor","pointer"),u(o,"font-size","18px"),u(o,"background","white"),u(o,"border-radius","50%"),u(o,"padding","3px 4px 0px"),u(o,"box-shadow","2px 2px 6px rgba(0, 0, 0, 0.3)"),u(o,"color","#0000008f"),j(e,"class","image-container"),u(e,"position","relative")},m(v,p){W(v,e,p),r(e,t),r(e,n),r(e,o),r(e,a),h||(E=[fe(t,"click",m),fe(o,"click",_)],h=!0)},p(v,p){l=v,p[0]&2&&!Fe(t.src,i=l[32])&&b(t,"src",i)},d(v){v&&c(e),h=!1,Ue(E)}}}function Gt(l){let e,t='<ion-spinner name="dots" style="color:white;"></ion-spinner>';return{c(){e=d("div"),e.innerHTML=t,this.h()},l(i){e=f(i,"DIV",{class:!0,style:!0,"data-svelte-h":!0}),le(e)!=="svelte-h8s7r2"&&(e.innerHTML=t),this.h()},h(){j(e,"class","overlay"),u(e,"position","fixed"),u(e,"top","0"),u(e,"left","0"),u(e,"width","100vw"),u(e,"height","100vh"),u(e,"background","rgba(0, 0, 0, 0.5)"),u(e,"display","flex"),u(e,"align-items","center"),u(e,"justify-content","center"),u(e,"z-index","9999")},m(i,n){W(i,e,n)},d(i){i&&c(e)}}}function Kt(l){let e,t,i,n,o,s,a=`<ion-icon icon="${Ct}"></ion-icon>`,h,E;return{c(){e=d("div"),t=d("div"),i=d("ion-img"),o=w(),s=d("button"),s.innerHTML=a,this.h()},l(m){e=f(m,"DIV",{class:!0,style:!0});var _=g(e);t=f(_,"DIV",{class:!0,style:!0});var v=g(t);i=f(v,"ION-IMG",{src:!0,alt:!0,style:!0}),g(i).forEach(c),o=N(v),s=f(v,"BUTTON",{class:!0,style:!0,"data-svelte-h":!0}),le(s)!=="svelte-g0qr0o"&&(s.innerHTML=a),v.forEach(c),_.forEach(c),this.h()},h(){Fe(i.src,n=l[8])||b(i,"src",n),b(i,"alt","Evidencia fotográfica"),u(i,"width","100%"),u(i,"height","auto"),j(s,"class","close-button"),u(s,"position","absolute"),u(s,"top","5px"),u(s,"right","5px"),u(s,"background","white"),u(s,"color","#444444d1"),u(s,"border","none"),u(s,"cursor","pointer"),u(s,"padding","2px 2px 0px 6px"),u(s,"border-radius","50%"),u(s,"font-size","20px"),j(t,"class","modal-content"),u(t,"position","relative"),u(t,"background","white"),u(t,"padding","20px"),u(t,"border-radius","8px"),u(t,"max-width","90vw"),u(t,"max-height","90vh"),u(t,"overflow","auto"),j(e,"class","modal-overlay"),u(e,"position","fixed"),u(e,"top","0"),u(e,"left","0"),u(e,"width","100vw"),u(e,"height","100vh"),u(e,"background","rgba(0, 0, 0, 0.8)"),u(e,"display","flex"),u(e,"justify-content","center"),u(e,"align-items","center"),u(e,"z-index","1000")},m(m,_){W(m,e,_),r(e,t),r(t,i),r(t,o),r(t,s),h||(E=[fe(s,"click",l[16]),fe(t,"click",yt(l[17])),fe(e,"click",l[16])],h=!0)},p(m,_){_[0]&256&&!Fe(i.src,n=m[8])&&b(i,"src",n)},d(m){m&&c(e),h=!1,Ue(E)}}}function Fi(l){let e,t,i,n,o="Cancelar",s,a,h="AGREGAR GASTO",E,m,_,v="Confirmar",p,k,O,y,B,P,R,U,Q,q,L,H,x,I,A,V,M,X,J='Tipo de pago <ion-text color="danger">(Obligatorio)</ion-text>',G,ne,_e="Efectivo",D,se,me="Tarjeta",ue,ae,oe="Transferencia",ce,pe,re,te,be,ve,Ee,de,he,ee,$=`<ion-icon icon="${Nt}" slot="start"></ion-icon>
                        Subir Evidencia`,ie,K,ge,Se,Le,Te,Z,T,z=l[0]&&Wt(l),C=l[6]&&Gt(),F=l[7]&&Kt(l);return{c(){e=d("ion-header"),t=d("ion-toolbar"),i=d("ion-buttons"),n=d("ion-button"),n.textContent=o,s=w(),a=d("ion-title"),a.textContent=h,E=w(),m=d("ion-buttons"),_=d("ion-button"),_.textContent=v,p=w(),k=d("ion-content"),O=d("ion-list"),y=d("ion-item"),B=d("ion-icon"),P=w(),R=d("ion-input"),U=w(),Q=d("ion-item"),q=d("ion-icon"),L=w(),H=d("ion-input"),x=w(),I=d("ion-item"),A=d("ion-icon"),V=w(),M=d("ion-select"),X=d("div"),X.innerHTML=J,G=w(),ne=d("ion-select-option"),ne.textContent=_e,D=w(),se=d("ion-select-option"),se.textContent=me,ue=w(),ae=d("ion-select-option"),ae.textContent=oe,ce=w(),pe=d("ion-item"),re=d("ion-icon"),te=w(),be=d("ion-textarea"),ve=w(),Ee=d("section"),de=d("label"),he=d("ion-button"),ee=d("label"),ee.innerHTML=$,ie=w(),K=d("input"),ge=w(),z&&z.c(),Se=w(),C&&C.c(),Le=w(),F&&F.c(),Te=Ae(),this.h()},l(S){e=f(S,"ION-HEADER",{translucent:!0});var Y=g(e);t=f(Y,"ION-TOOLBAR",{});var ke=g(t);i=f(ke,"ION-BUTTONS",{slot:!0});var Ne=g(i);n=f(Ne,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),le(n)!=="svelte-1f8rjcf"&&(n.textContent=o),Ne.forEach(c),s=N(ke),a=f(ke,"ION-TITLE",{title:!0,"data-svelte-h":!0}),le(a)!=="svelte-efps2s"&&(a.textContent=h),E=N(ke),m=f(ke,"ION-BUTTONS",{slot:!0});var Ce=g(m);_=f(Ce,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),le(_)!=="svelte-k5zoz0"&&(_.textContent=v),Ce.forEach(c),ke.forEach(c),Y.forEach(c),p=N(S),k=f(S,"ION-CONTENT",{fullscreen:!0});var Ie=g(k);O=f(Ie,"ION-LIST",{});var we=g(O);y=f(we,"ION-ITEM",{});var Re=g(y);B=f(Re,"ION-ICON",{icon:!0,slot:!0}),g(B).forEach(c),P=N(Re),R=f(Re,"ION-INPUT",{label:!0,type:!0,placeholder:!0,value:!0}),g(R).forEach(c),Re.forEach(c),U=N(we),Q=f(we,"ION-ITEM",{});var Ke=g(Q);q=f(Ke,"ION-ICON",{icon:!0,slot:!0}),g(q).forEach(c),L=N(Ke),H=f(Ke,"ION-INPUT",{label:!0,type:!0,value:!0}),g(H).forEach(c),Ke.forEach(c),x=N(we),I=f(we,"ION-ITEM",{});var ct=g(I);A=f(ct,"ION-ICON",{icon:!0,slot:!0}),g(A).forEach(c),V=N(ct),M=f(ct,"ION-SELECT",{placeholder:!0,value:!0});var Xe=g(M);X=f(Xe,"DIV",{slot:!0,"data-svelte-h":!0}),le(X)!=="svelte-wl764p"&&(X.innerHTML=J),G=N(Xe),ne=f(Xe,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),le(ne)!=="svelte-i9crym"&&(ne.textContent=_e),D=N(Xe),se=f(Xe,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),le(se)!=="svelte-fx0z11"&&(se.textContent=me),ue=N(Xe),ae=f(Xe,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),le(ae)!=="svelte-1c24jf2"&&(ae.textContent=oe),Xe.forEach(c),ct.forEach(c),ce=N(we),pe=f(we,"ION-ITEM",{});var ut=g(pe);re=f(ut,"ION-ICON",{icon:!0,slot:!0}),g(re).forEach(c),te=N(ut),be=f(ut,"ION-TEXTAREA",{label:!0,placeholder:!0}),g(be).forEach(c),ut.forEach(c),ve=N(we),Ee=f(we,"SECTION",{});var Mt=g(Ee);de=f(Mt,"LABEL",{for:!0,style:!0});var St=g(de);he=f(St,"ION-BUTTON",{fill:!0,size:!0,class:!0,expand:!0});var dt=g(he);ee=f(dt,"LABEL",{for:!0,style:!0,"data-svelte-h":!0}),le(ee)!=="svelte-1m9yw22"&&(ee.innerHTML=$),ie=N(dt),K=f(dt,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0,capture:!0}),dt.forEach(c),St.forEach(c),Mt.forEach(c),ge=N(we),z&&z.l(we),we.forEach(c),Ie.forEach(c),Se=N(S),C&&C.l(S),Le=N(S),F&&F.l(S),Te=Ae(),this.h()},h(){b(n,"color","medium"),b(i,"slot","start"),b(a,"title",""),b(_,"strong",""),b(m,"slot","end"),b(e,"translucent",""),b(B,"icon",In),b(B,"slot","start"),b(R,"label","Concepto"),b(R,"type","text"),b(R,"placeholder","Escribe aquí..."),b(R,"value",l[9]?l[9]:""),b(q,"icon",ht),b(q,"slot","start"),b(H,"label","Monto $"),b(H,"type","number"),b(H,"value",l[10]?l[10]:""),b(A,"icon",jn),b(A,"slot","start"),j(X,"slot","label"),b(ne,"value","cash"),b(se,"value","card"),b(ae,"value","transfer"),b(M,"placeholder","Tipo de pago"),b(M,"value",l[11]?l[11]:""),b(re,"icon",ht),b(re,"slot","start"),b(be,"label","Comentarios"),b(be,"placeholder","Escribe aquí..."),j(ee,"for","eventEvidence"),u(ee,"width","100%"),u(ee,"padding","8px"),u(K,"display","none"),j(K,"id","eventEvidence"),j(K,"name","fileToUpload"),j(K,"type","file"),j(K,"accept","image/*"),j(K,"capture","environment"),b(he,"fill","outline"),b(he,"size","small"),b(he,"class","loadEvidence"),b(he,"expand","block"),j(de,"for","eventEvidence"),u(de,"display","block"),u(de,"width","100%"),b(k,"fullscreen","")},m(S,Y){W(S,e,Y),r(e,t),r(t,i),r(i,n),r(t,s),r(t,a),r(t,E),r(t,m),r(m,_),W(S,p,Y),W(S,k,Y),r(k,O),r(O,y),r(y,B),r(y,P),r(y,R),l[18](R),r(O,U),r(O,Q),r(Q,q),r(Q,L),r(Q,H),l[19](H),r(O,x),r(O,I),r(I,A),r(I,V),r(I,M),r(M,X),r(M,G),r(M,ne),r(M,D),r(M,se),r(M,ue),r(M,ae),l[20](M),r(O,ce),r(O,pe),r(pe,re),r(pe,te),r(pe,be),l[21](be),r(O,ve),r(O,Ee),r(Ee,de),r(de,he),r(he,ee),r(he,ie),r(he,K),r(O,ge),z&&z.m(O,null),W(S,Se,Y),C&&C.m(S,Y),W(S,Le,Y),F&&F.m(S,Y),W(S,Te,Y),Z||(T=[fe(n,"click",l[13]),fe(_,"click",l[14]),fe(K,"change",l[12])],Z=!0)},p(S,Y){S[0]?z?z.p(S,Y):(z=Wt(S),z.c(),z.m(O,null)):z&&(z.d(1),z=null),S[6]?C||(C=Gt(),C.c(),C.m(Le.parentNode,Le)):C&&(C.d(1),C=null),S[7]?F?F.p(S,Y):(F=Kt(S),F.c(),F.m(Te.parentNode,Te)):F&&(F.d(1),F=null)},i:Me,o:Me,d(S){S&&(c(e),c(p),c(k),c(Se),c(Le),c(Te)),l[18](null),l[19](null),l[20](null),l[21](null),z&&z.d(),C&&C.d(S),F&&F.d(S),Z=!1,Ue(T)}}}function ji(l,e,t){let i=at,n=document.querySelector("ion-modal"),o=n.componentProps.routeId,s=n.componentProps.ex_concept,a=n.componentProps.ex_amount,h=n.componentProps.ex_type,E=n.componentProps.id_expense,m="",_=new Array,v="",p="",k=0,O="",y="",B=!1,P=new Object,R=!1,U="";et(()=>{P=JSON.parse(localStorage.getItem("userSession"))});const Q=async(D,se)=>{await(await qe.create({header:D||"Error",message:se||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()},q=async D=>{t(6,B=!0);const me=D.target.files[0],ue=await L(me);if(ue){var ae=new Object;ae.fileToUpload=ue,ae.id_user_over=P.id_user,ae.token=P.token;try{Ve(`${i}api/admin/manager/upload_img_driver.php`,function(oe){oe.success?(t(0,m=oe.img),t(1,_=Ge(m)),v=oe.img_id):Q("Error","No se pudo subir la imagen"),t(6,B=!1)},ae)}catch(oe){console.error("Error during file upload:",oe)}finally{t(6,B=!1)}}},L=async D=>new Promise(se=>{const me=new Image;me.src=URL.createObjectURL(D),me.onload=()=>{const ue=document.createElement("canvas"),ae=ue.getContext("2d"),oe=800,ce=600;let pe=me.width,re=me.height;pe>oe&&(re*=oe/pe,pe=oe),re>ce&&(pe*=ce/re,re=ce),ue.width=pe,ue.height=re,ae.drawImage(me,0,0,pe,re),ue.toBlob(te=>{se(te),URL.revokeObjectURL(me.src),ae.clearRect(0,0,ue.width,ue.height)},"image/jpeg",.7)}}),H=()=>{tt.dismiss()},x=()=>{var D=new Object;D.id_route=o,D.comments=O.value,D.type=p.value,D.img=m,D.img_id=v,D.amount=k.value,D.concept=y.value,D.status="done",D.id_expense=E||"null",D.id_user_over=P.id_user,D.token=P.token,!v||!m||!k.value||!y.value?Q("Datos incompletos","Llena los datos requeridos para completar el registro"):Ve(`${i}api/admin/expenses/add_expense.php`,function(se){H()},D)},I=D=>{t(8,U=D),t(7,R=!0)},A=()=>{t(7,R=!1),t(8,U="")};function V(D){wt.call(this,l,D)}function M(D){De[D?"unshift":"push"](()=>{y=D,t(5,y)})}function X(D){De[D?"unshift":"push"](()=>{k=D,t(3,k)})}function J(D){De[D?"unshift":"push"](()=>{p=D,t(2,p)})}function G(D){De[D?"unshift":"push"](()=>{O=D,t(4,O)})}return[m,_,p,k,O,y,B,R,U,s,a,h,q,H,x,I,A,V,M,X,J,G,D=>I(D),D=>removeFile(D)]}class Et extends Ye{constructor(e){super(),Qe(this,e,ji,Fi,Je,{},null,[-1,-1])}}function Xt(l,e,t){const i=l.slice();return i[32]=e[t],i[34]=t,i}function Jt(l,e,t){const i=l.slice();return i[35]=e[t],i}function Yt(l){let e,t,i,n,o,s,a=l[35].label+"",h,E,m,_;function v(){return l[18](l[35])}return{c(){e=d("div"),t=d("ion-button"),i=d("ion-icon"),o=w(),s=d("div"),h=Oe(a),E=w(),this.h()},l(p){e=f(p,"DIV",{class:!0});var k=g(e);t=f(k,"ION-BUTTON",{color:!0,fill:!0,size:!0});var O=g(t);i=f(O,"ION-ICON",{slot:!0,icon:!0}),g(i).forEach(c),O.forEach(c),o=N(k),s=f(k,"DIV",{class:!0,style:!0});var y=g(s);h=ye(y,a),y.forEach(c),E=N(k),k.forEach(c),this.h()},h(){b(i,"slot","icon-only"),b(i,"icon",l[35].icon),b(t,"color",n=l[6]===l[35].id?"primary":"medium"),b(t,"fill","clear"),b(t,"size","small"),j(s,"class","motive-caption"),u(s,"font-size","11px"),u(s,"margin-top","2px"),u(s,"text-align","center"),u(s,"line-height","1.1"),j(e,"class","motive-button")},m(p,k){W(p,e,k),r(e,t),r(t,i),r(e,o),r(e,s),r(s,h),r(e,E),m||(_=fe(t,"click",v),m=!0)},p(p,k){l=p,k[0]&64&&n!==(n=l[6]===l[35].id?"primary":"medium")&&b(t,"color",n)},d(p){p&&c(e),m=!1,_()}}}function Qt(l){let e;return{c(){e=d("div"),this.h()},l(t){e=f(t,"DIV",{id:!0,style:!0}),g(e).forEach(c),this.h()},h(){j(e,"id","motive-map"),u(e,"height","220px"),u(e,"margin","12px 16px"),u(e,"border-radius","8px")},m(t,i){W(t,e,i),l[19](e)},p:Me,d(t){t&&c(e),l[19](null)}}}function Zt(l){let e,t,i=He(l[1]),n=[];for(let o=0;o<i.length;o+=1)n[o]=$t(Xt(l,i,o));return{c(){e=d("section"),t=d("div");for(let o=0;o<n.length;o+=1)n[o].c();this.h()},l(o){e=f(o,"SECTION",{});var s=g(e);t=f(s,"DIV",{class:!0,style:!0});var a=g(t);for(let h=0;h<n.length;h+=1)n[h].l(a);a.forEach(c),s.forEach(c),this.h()},h(){j(t,"class","image-grid"),u(t,"display","grid"),u(t,"grid-template-columns","repeat(auto-fill, minmax(100px, 1fr))"),u(t,"gap","10px"),u(t,"padding","0px 10px")},m(o,s){W(o,e,s),r(e,t);for(let a=0;a<n.length;a+=1)n[a]&&n[a].m(t,null)},p(o,s){if(s[0]&73730){i=He(o[1]);let a;for(a=0;a<i.length;a+=1){const h=Xt(o,i,a);n[a]?n[a].p(h,s):(n[a]=$t(h),n[a].c(),n[a].m(t,null))}for(;a<n.length;a+=1)n[a].d(1);n.length=i.length}},d(o){o&&c(e),mt(n,o)}}}function $t(l){let e,t,i,n,o,s=`<ion-icon icon="${vt}"></ion-icon>`,a,h,E;function m(){return l[21](l[32])}function _(){return l[22](l[34])}return{c(){e=d("div"),t=d("ion-img"),n=w(),o=d("button"),o.innerHTML=s,a=w(),this.h()},l(v){e=f(v,"DIV",{class:!0,style:!0});var p=g(e);t=f(p,"ION-IMG",{src:!0,alt:!0,style:!0}),g(t).forEach(c),n=N(p),o=f(p,"BUTTON",{class:!0,style:!0,"data-svelte-h":!0}),le(o)!=="svelte-ulzohx"&&(o.innerHTML=s),a=N(p),p.forEach(c),this.h()},h(){Fe(t.src,i=l[32])||b(t,"src",i),b(t,"alt","Evidencia fotográfica"),u(t,"width","100%"),u(t,"height","100px"),u(t,"object-fit","cover"),u(t,"cursor","pointer"),u(t,"border","1px solid #ccc"),u(t,"border-radius","4px"),u(t,"margin-top","16px"),j(o,"class","remove-button"),u(o,"position","absolute"),u(o,"top","5px"),u(o,"right","5px"),u(o,"border","none"),u(o,"cursor","pointer"),u(o,"font-size","18px"),u(o,"background","white"),u(o,"border-radius","50%"),u(o,"padding","3px 4px 0px"),u(o,"box-shadow","2px 2px 6px rgba(0, 0, 0, 0.3)"),u(o,"color","#0000008f"),j(e,"class","image-container"),u(e,"position","relative")},m(v,p){W(v,e,p),r(e,t),r(e,n),r(e,o),r(e,a),h||(E=[fe(t,"click",m),fe(o,"click",_)],h=!0)},p(v,p){l=v,p[0]&2&&!Fe(t.src,i=l[32])&&b(t,"src",i)},d(v){v&&c(e),h=!1,Ue(E)}}}function en(l){let e,t='<ion-spinner name="dots" style="color:white;"></ion-spinner>';return{c(){e=d("div"),e.innerHTML=t,this.h()},l(i){e=f(i,"DIV",{class:!0,style:!0,"data-svelte-h":!0}),le(e)!=="svelte-1mz0rrk"&&(e.innerHTML=t),this.h()},h(){j(e,"class","overlay"),u(e,"position","fixed"),u(e,"top","0"),u(e,"left","0"),u(e,"width","100vw"),u(e,"height","100vh"),u(e,"background","rgba(0, 0, 0, 0.5)"),u(e,"display","flex"),u(e,"align-items","center"),u(e,"justify-content","center"),u(e,"z-index","9999")},m(i,n){W(i,e,n)},d(i){i&&c(e)}}}function tn(l){let e,t,i,n,o,s,a=`<ion-icon icon="${Ct}"></ion-icon>`,h,E;return{c(){e=d("div"),t=d("div"),i=d("ion-img"),o=w(),s=d("button"),s.innerHTML=a,this.h()},l(m){e=f(m,"DIV",{class:!0,style:!0});var _=g(e);t=f(_,"DIV",{class:!0,style:!0});var v=g(t);i=f(v,"ION-IMG",{src:!0,alt:!0,style:!0}),g(i).forEach(c),o=N(v),s=f(v,"BUTTON",{class:!0,style:!0,"data-svelte-h":!0}),le(s)!=="svelte-1fdruw6"&&(s.innerHTML=a),v.forEach(c),_.forEach(c),this.h()},h(){Fe(i.src,n=l[5])||b(i,"src",n),b(i,"alt","Evidencia fotográfica"),u(i,"width","100%"),u(i,"height","auto"),j(s,"class","close-button"),u(s,"position","absolute"),u(s,"top","5px"),u(s,"right","5px"),u(s,"background","white"),u(s,"color","#444444d1"),u(s,"border","none"),u(s,"cursor","pointer"),u(s,"padding","2px 2px 0px 6px"),u(s,"border-radius","50%"),u(s,"font-size","20px"),j(t,"class","modal-content"),u(t,"position","relative"),u(t,"background","white"),u(t,"padding","20px"),u(t,"border-radius","8px"),u(t,"max-width","90vw"),u(t,"max-height","90vh"),u(t,"overflow","auto"),j(e,"class","modal-overlay"),u(e,"position","fixed"),u(e,"top","0"),u(e,"left","0"),u(e,"width","100vw"),u(e,"height","100vh"),u(e,"background","rgba(0, 0, 0, 0.8)"),u(e,"display","flex"),u(e,"justify-content","center"),u(e,"align-items","center"),u(e,"z-index","1000")},m(m,_){W(m,e,_),r(e,t),r(t,i),r(t,o),r(t,s),h||(E=[fe(s,"click",l[14]),fe(t,"click",yt(l[17])),fe(e,"click",l[14])],h=!0)},p(m,_){_[0]&32&&!Fe(i.src,n=m[5])&&b(i,"src",n)},d(m){m&&c(e),h=!1,Ue(E)}}}function Wi(l){let e,t,i,n,o="Cancelar",s,a,h="AGREGAR INCIDENCIA",E,m,_,v="Confirmar",p,k,O,y,B,P,R,U,Q,q,L,H,x,I,A,V,M=`<ion-icon icon="${Nt}" slot="start"></ion-icon>
            Subir Evidencia`,X,J,G,ne,_e,D,se,me,ue=He(l[9]),ae=[];for(let te=0;te<ue.length;te+=1)ae[te]=Yt(Jt(l,ue,te));let oe=l[7].lat&&Qt(l),ce=l[0]&&Zt(l),pe=l[3]&&en(),re=l[4]&&tn(l);return{c(){e=d("ion-header"),t=d("ion-toolbar"),i=d("ion-buttons"),n=d("ion-button"),n.textContent=o,s=w(),a=d("ion-title"),a.textContent=h,E=w(),m=d("ion-buttons"),_=d("ion-button"),_.textContent=v,p=w(),k=d("ion-content"),O=d("ion-list"),y=d("ion-item"),B=d("div");for(let te=0;te<ae.length;te+=1)ae[te].c();P=w(),oe&&oe.c(),R=w(),U=d("ion-item"),Q=d("ion-icon"),q=w(),L=d("ion-textarea"),H=w(),x=d("section"),I=d("label"),A=d("ion-button"),V=d("label"),V.innerHTML=M,X=w(),J=d("input"),G=w(),ce&&ce.c(),ne=w(),pe&&pe.c(),_e=w(),re&&re.c(),D=Ae(),this.h()},l(te){e=f(te,"ION-HEADER",{translucent:!0});var be=g(e);t=f(be,"ION-TOOLBAR",{});var ve=g(t);i=f(ve,"ION-BUTTONS",{slot:!0});var Ee=g(i);n=f(Ee,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),le(n)!=="svelte-1f8rjcf"&&(n.textContent=o),Ee.forEach(c),s=N(ve),a=f(ve,"ION-TITLE",{title:!0,"data-svelte-h":!0}),le(a)!=="svelte-zr4yw3"&&(a.textContent=h),E=N(ve),m=f(ve,"ION-BUTTONS",{slot:!0});var de=g(m);_=f(de,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),le(_)!=="svelte-1afq5zm"&&(_.textContent=v),de.forEach(c),ve.forEach(c),be.forEach(c),p=N(te),k=f(te,"ION-CONTENT",{fullscreen:!0});var he=g(k);O=f(he,"ION-LIST",{});var ee=g(O);y=f(ee,"ION-ITEM",{lines:!0,class:!0,style:!0});var $=g(y);B=f($,"DIV",{class:!0,style:!0});var ie=g(B);for(let Te=0;Te<ae.length;Te+=1)ae[Te].l(ie);ie.forEach(c),$.forEach(c),P=N(ee),oe&&oe.l(ee),R=N(ee),U=f(ee,"ION-ITEM",{});var K=g(U);Q=f(K,"ION-ICON",{icon:!0,slot:!0}),g(Q).forEach(c),q=N(K),L=f(K,"ION-TEXTAREA",{label:!0,placeholder:!0}),g(L).forEach(c),K.forEach(c),H=N(ee),x=f(ee,"SECTION",{});var ge=g(x);I=f(ge,"LABEL",{for:!0,style:!0});var Se=g(I);A=f(Se,"ION-BUTTON",{fill:!0,size:!0,class:!0,expand:!0});var Le=g(A);V=f(Le,"LABEL",{for:!0,style:!0,"data-svelte-h":!0}),le(V)!=="svelte-1tbnglg"&&(V.innerHTML=M),X=N(Le),J=f(Le,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0,capture:!0}),Le.forEach(c),Se.forEach(c),ge.forEach(c),G=N(ee),ce&&ce.l(ee),ee.forEach(c),he.forEach(c),ne=N(te),pe&&pe.l(te),_e=N(te),re&&re.l(te),D=Ae(),this.h()},h(){b(n,"color","medium"),b(i,"slot","start"),b(a,"title",""),b(_,"strong",""),b(m,"slot","end"),b(e,"translucent",""),j(B,"class","motive-grid"),u(B,"display","flex"),u(B,"gap","8px"),u(B,"flex-wrap","wrap"),u(B,"justify-content","center"),u(B,"margin-top","6px"),b(y,"lines","none"),b(y,"class","motive-item"),u(y,"display","grid"),u(y,"justify-content","center"),u(y,"margin-bottom","15px"),b(Q,"icon",ht),b(Q,"slot","start"),b(L,"label","Comentarios"),b(L,"placeholder","Escribe aquí..."),j(V,"for","eventEvidence"),u(V,"width","100%"),u(V,"padding","8px"),u(J,"display","none"),j(J,"id","eventEvidence"),j(J,"name","fileToUpload"),j(J,"type","file"),j(J,"accept","image/*"),j(J,"capture","environment"),b(A,"fill","outline"),b(A,"size","small"),b(A,"class","loadEvidence"),b(A,"expand","block"),j(I,"for","eventEvidence"),u(I,"display","block"),u(I,"width","100%"),b(k,"fullscreen","")},m(te,be){W(te,e,be),r(e,t),r(t,i),r(i,n),r(t,s),r(t,a),r(t,E),r(t,m),r(m,_),W(te,p,be),W(te,k,be),r(k,O),r(O,y),r(y,B);for(let ve=0;ve<ae.length;ve+=1)ae[ve]&&ae[ve].m(B,null);r(O,P),oe&&oe.m(O,null),r(O,R),r(O,U),r(U,Q),r(U,q),r(U,L),l[20](L),r(O,H),r(O,x),r(x,I),r(I,A),r(A,V),r(A,X),r(A,J),r(O,G),ce&&ce.m(O,null),W(te,ne,be),pe&&pe.m(te,be),W(te,_e,be),re&&re.m(te,be),W(te,D,be),se||(me=[fe(n,"click",l[11]),fe(_,"click",l[12]),fe(J,"change",l[10])],se=!0)},p(te,be){if(be[0]&33344){ue=He(te[9]);let ve;for(ve=0;ve<ue.length;ve+=1){const Ee=Jt(te,ue,ve);ae[ve]?ae[ve].p(Ee,be):(ae[ve]=Yt(Ee),ae[ve].c(),ae[ve].m(B,null))}for(;ve<ae.length;ve+=1)ae[ve].d(1);ae.length=ue.length}te[7].lat?oe?oe.p(te,be):(oe=Qt(te),oe.c(),oe.m(O,R)):oe&&(oe.d(1),oe=null),te[0]?ce?ce.p(te,be):(ce=Zt(te),ce.c(),ce.m(O,null)):ce&&(ce.d(1),ce=null),te[3]?pe||(pe=en(),pe.c(),pe.m(_e.parentNode,_e)):pe&&(pe.d(1),pe=null),te[4]?re?re.p(te,be):(re=tn(te),re.c(),re.m(D.parentNode,D)):re&&(re.d(1),re=null)},i:Me,o:Me,d(te){te&&(c(e),c(p),c(k),c(ne),c(_e),c(D)),mt(ae,te),oe&&oe.d(),l[20](null),ce&&ce.d(),pe&&pe.d(te),re&&re.d(te),se=!1,Ue(me)}}}function qi(l,e,t){let i=at,o=document.querySelector("ion-modal").componentProps.routeId,s="",a=s?Ge(s):new Array,h="",E=!1,m=new Object,_=!1,v="",p="",k={lat:null,lng:null},O,y,B;const P=[{id:"car_accident",icon:"/car-accident.svg",label:"Accidente"},{id:"hospital",icon:"/hospital.svg",label:"Hospital"},{id:"wc",icon:"/toilet.svg",label:"Baño"},{id:"restaurant",icon:"/restaurant.svg",label:"Restaurant"},{id:"parking",icon:"/parking.svg",label:"Parking"}];et(()=>{m=JSON.parse(localStorage.getItem("userSession"))});const R=async(D,se)=>{await(await qe.create({header:D||"Error",message:se||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()},U=async D=>{if(a.length>=5){R("Límite de evidencias","Solo se permite subir 5 fotos por parada");return}t(3,E=!0);const me=D.target.files[0],ue=await Q(me);if(ue){var ae=new Object;ae.fileToUpload=ue,ae.id_user_over=m.id_user,ae.token=m.token;try{Ve(`${i}api/admin/manager/upload_img_driver.php`,function(oe){oe.success?(t(0,s=s?`${s},${oe.img}`:oe.img),t(1,a=Ge(s))):R("Error","No se pudo subir la imagen"),t(3,E=!1)},ae)}catch(oe){console.error("Error during file upload:",oe)}finally{t(3,E=!1)}}},Q=async D=>new Promise(se=>{const me=new Image;me.src=URL.createObjectURL(D),me.onload=()=>{const ue=document.createElement("canvas"),ae=ue.getContext("2d"),oe=800,ce=600;let pe=me.width,re=me.height;pe>oe&&(re*=oe/pe,pe=oe),re>ce&&(pe*=ce/re,re=ce),ue.width=pe,ue.height=re,ae.drawImage(me,0,0,pe,re),ue.toBlob(te=>{se(te),URL.revokeObjectURL(me.src),ae.clearRect(0,0,ue.width,ue.height)},"image/jpeg",.7)}}),q=()=>{tt.dismiss()},L=()=>{var D=new Object;t(0,s=a.join(",")),D.id_route=o,D.comments=h.value,D.lat=k.lat,D.lng=k.lng,D.type=p,D.img=s,D.id_user_over=m.id_user,D.token=m.token,D.id_driver=m.id_driver,!p||!s||!D.comments||!D.img?R("Datos incompletos","Llena los datos requeridos para completar el registro"):!D.lat||!D.lng?R("Ubicación no disponible","Por favor, asegúrate de que la ubicación está activada en tu dispositivo."):Ve(`${i}api/admin/incidence/add_incidence.php`,function(se){se?R("Éxito","Incidencia registrada correctamente"):R("Error","No se pudo registrar la incidencia. Por favor, inténtalo de nuevo."),q()},D)},H=D=>{t(5,v=D),t(4,_=!0)},x=()=>{t(4,_=!1),t(5,v="")};async function I(D){t(6,p=D),t(3,E=!0),navigator.geolocation&&navigator.geolocation.getCurrentPosition(async se=>{t(7,k.lat=se.coords.latitude,k),t(7,k.lng=se.coords.longitude,k),await A()},()=>console.log("Geolocalización denegada"))}async function A(){if(await Ot(),!O)return;const{Map:D}=await google.maps.importLibrary("maps"),{AdvancedMarkerElement:se}=await google.maps.importLibrary("marker");y?y.setCenter(k):y=new D(O,{zoom:15,center:k,mapId:"4504f8b37365c3d0"});const me=P.find(oe=>oe.id===p);if(!me)return;B&&B.setMap(null);const ue=document.createElement("div");ue.style.cssText=`
      display:flex;align-items:center;justify-content:center;
      width:38px;height:38px;border-radius:50%;
      background:#ffffff;border:2px solid #d13434;
      box-shadow:0 0 4px rgba(0,0,0,.3);
  `;const ae=document.createElement("ion-icon");ae.setAttribute("icon",me.icon),ae.style.cssText="font-size:24px;color:#d13434;",ue.appendChild(ae),B=new se({map:y,position:k,title:me.label,content:ue}),t(3,E=!1)}function V(D=0){var se=On(D,a,[""],s);t(1,a=se.files),t(0,s=se.selectedImages)}function M(D){wt.call(this,l,D)}const X=D=>I(D.id);function J(D){De[D?"unshift":"push"](()=>{O=D,t(8,O)})}function G(D){De[D?"unshift":"push"](()=>{h=D,t(2,h)})}return[s,a,h,E,_,v,p,k,O,P,U,q,L,H,x,I,V,M,X,J,G,D=>H(D),D=>V(D)]}class Gi extends Ye{constructor(e){super(),Qe(this,e,qi,Wi,Je,{},null,[-1,-1])}}function nn(l,e,t){const i=l.slice();return i[7]=e[t],i}function Ki(l){let e,t="Cargar gasto",i,n;function o(...s){return l[4](l[7],...s)}return{c(){e=d("ion-button"),e.textContent=t,this.h()},l(s){e=f(s,"ION-BUTTON",{fill:!0,size:!0,"aria-selected":!0,"data-svelte-h":!0}),le(e)!=="svelte-175aelj"&&(e.textContent=t),this.h()},h(){b(e,"fill","outline"),b(e,"size","small"),b(e,"aria-selected","")},m(s,a){W(s,e,a),i||(n=fe(e,"click",o),i=!0)},p(s,a){l=s},d(s){s&&c(e),i=!1,n()}}}function Xi(l){let e,t="Gasto completado";return{c(){e=d("ion-button"),e.textContent=t,this.h()},l(i){e=f(i,"ION-BUTTON",{fill:!0,size:!0,"aria-selected":!0,"data-svelte-h":!0}),le(e)!=="svelte-tlger7"&&(e.textContent=t),this.h()},h(){b(e,"fill","solid"),b(e,"size","small"),b(e,"aria-selected","")},m(i,n){W(i,e,n)},p:Me,d(i){i&&c(e)}}}function on(l,e){let t,i,n,o=e[7].concept+"",s,a,h;function E(v,p){return v[7].status=="done"?Xi:Ki}let _=E(e)(e);return{key:l,first:null,c(){t=d("ion-item"),i=d("ion-label"),n=d("p"),s=Oe(o),a=w(),_.c(),h=w(),this.h()},l(v){t=f(v,"ION-ITEM",{});var p=g(t);i=f(p,"ION-LABEL",{style:!0});var k=g(i);n=f(k,"P",{style:!0});var O=g(n);s=ye(O,o),O.forEach(c),k.forEach(c),a=N(p),_.l(p),h=N(p),p.forEach(c),this.h()},h(){u(n,"margin-left","10px"),u(i,"display","flex"),this.first=t},m(v,p){W(v,t,p),r(t,i),r(i,n),r(n,s),r(t,a),_.m(t,null),r(t,h)},p(v,p){e=v,_.p(e,p)},d(v){v&&c(t),_.d()}}}function Ji(l){let e,t,i,n,o=`<ion-icon style="font-size: 25px!important;" icon="${Wn}"></ion-icon>`,s,a,h="LISTA DE GASTOS",E,m,_,v=[],p=new Map,k,O,y,B="Cerrar",P,R,U=He(l[0]);const Q=q=>q[7].id_expenses;for(let q=0;q<U.length;q+=1){let L=nn(l,U,q),H=Q(L);p.set(H,v[q]=on(H,L))}return{c(){e=d("ion-header"),t=d("ion-toolbar"),i=d("ion-buttons"),n=d("ion-button"),n.innerHTML=o,s=w(),a=d("ion-title"),a.textContent=h,E=w(),m=d("ion-content"),_=d("ion-list");for(let q=0;q<v.length;q+=1)v[q].c();k=w(),O=d("ion-footer"),y=d("ion-button"),y.textContent=B,this.h()},l(q){e=f(q,"ION-HEADER",{translucent:!0});var L=g(e);t=f(L,"ION-TOOLBAR",{});var H=g(t);i=f(H,"ION-BUTTONS",{slot:!0});var x=g(i);n=f(x,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),le(n)!=="svelte-160xz3i"&&(n.innerHTML=o),x.forEach(c),s=N(H),a=f(H,"ION-TITLE",{"data-svelte-h":!0}),le(a)!=="svelte-1phn90x"&&(a.textContent=h),H.forEach(c),L.forEach(c),E=N(q),m=f(q,"ION-CONTENT",{fullscreen:!0});var I=g(m);_=f(I,"ION-LIST",{});var A=g(_);for(let M=0;M<v.length;M+=1)v[M].l(A);A.forEach(c),I.forEach(c),k=N(q),O=f(q,"ION-FOOTER",{});var V=g(O);y=f(V,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),le(y)!=="svelte-zv7v83"&&(y.textContent=B),V.forEach(c),this.h()},h(){b(n,"color","medium"),b(i,"slot","end"),b(e,"translucent",""),b(m,"fullscreen",""),b(y,"fill","outline"),b(y,"color","tertiary"),b(y,"strong",""),u(y,"width","99%"),u(y,"height","auto")},m(q,L){W(q,e,L),r(e,t),r(t,i),r(i,n),r(t,s),r(t,a),W(q,E,L),W(q,m,L),r(m,_);for(let H=0;H<v.length;H+=1)v[H]&&v[H].m(_,null);W(q,k,L),W(q,O,L),r(O,y),P||(R=[fe(n,"click",l[3]),fe(y,"click",l[1])],P=!0)},p(q,[L]){L&5&&(U=He(q[0]),v=rt(v,L,Q,1,q,U,p,_,st,on,null,nn))},i:Me,o:Me,d(q){q&&(c(e),c(E),c(m),c(k),c(O));for(let L=0;L<v.length;L+=1)v[L].d();P=!1,Ue(R)}}}function Yi(l){let e=document.querySelector("ion-modal");e.componentProps.routeId;let t=e.componentProps.expenses;et(()=>{});const i=()=>{tt.dismiss()};function n(a,h,E,m,_){e.componentProps.ex_amount=E,e.componentProps.ex_concept=h,e.componentProps.ex_type=m,e.componentProps.id_expense=_,We("modal-expense",Et,{amount:E,concept:h,type:m,id_expense:_}).then(()=>{}),i()}return[t,i,n,a=>{We("modal-expense",Et,{routeId:a}).then(h=>{}),i()},(a,h)=>n(h,a.concept,a.amount,a.type,a.id_expenses)]}class Qi extends Ye{constructor(e){super(),Qe(this,e,Yi,Ji,Je,{})}}const{document:ln}=ei;function rn(l,e,t){const i=l.slice();return i[55]=e[t],i[57]=t,i}function sn(l,e,t){const i=l.slice();return i[55]=e[t],i[57]=t,i}function an(l,e,t){const i=l.slice();return i[55]=e[t],i[57]=t,i}function cn(l){let e,t;return e=new qn({props:{$$slots:{default:[uo]},$$scope:{ctx:l}}}),{c(){vn(e.$$.fragment)},l(i){gn(e.$$.fragment,i)},m(i,n){bn(e,i,n),t=!0},p(i,n){const o={};n[0]&2043|n[1]&536870912&&(o.$$scope={dirty:n,ctx:i}),e.$set(o)},i(i){t||($e(e.$$.fragment,i),t=!0)},o(i){it(e.$$.fragment,i),t=!1},d(i){En(e,i)}}}function Zi(l){let e,t='<div id="g_map" style="width: 100%; height: 100vh;"></div>';return{c(){e=d("ion-content"),e.innerHTML=t},l(i){e=f(i,"ION-CONTENT",{"data-svelte-h":!0}),le(e)!=="svelte-h8v4nk"&&(e.innerHTML=t)},m(i,n){W(i,e,n)},p:Me,d(i){i&&c(e)}}}function $i(l){let e;function t(o,s){if(o[7].length>0)return to;if(!o[3])return eo}let i=t(l),n=i&&i(l);return{c(){n&&n.c(),e=Ae()},l(o){n&&n.l(o),e=Ae()},m(o,s){n&&n.m(o,s),W(o,e,s)},p(o,s){i===(i=t(o))&&n?n.p(o,s):(n&&n.d(1),n=i&&i(o),n&&(n.c(),n.m(e.parentNode,e)))},d(o){o&&c(e),n&&n.d(o)}}}function eo(l){let e,t,i,n='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Jala para actualizar" refreshing-spinner="circles" refreshing-text="Actualizando..."></ion-refresher-content>',o,s,a,h,E,m,_="0",v,p,k,O,y,B=l[6].origin+"",P,R,U,Q,q,L,H=[],x=new Map,I,A,V,M,X,J=l[5].length+1+"",G,ne,_e,D,se,me,ue=l[6].destination+"",ae,oe,ce,pe="",re,te,be,ve,Ee=l[4]&&un(l),de=He(l[5]);const he=ee=>ee[55].id_event;for(let ee=0;ee<de.length;ee+=1){let $=rn(l,de,ee),ie=he($);x.set(ie,H[ee]=fn(ie,$))}return{c(){Ee&&Ee.c(),e=w(),t=d("ion-content"),i=d("ion-refresher"),i.innerHTML=n,o=w(),s=d("ion-list"),a=d("ion-item"),h=d("ion-avatar"),E=d("div"),m=d("div"),m.textContent=_,p=w(),k=d("ion-label"),O=d("ion-text"),y=d("h3"),P=Oe(B),R=w(),U=d("div"),Q=w(),q=d("ion-icon"),L=w();for(let ee=0;ee<H.length;ee+=1)H[ee].c();I=w(),A=d("ion-item"),V=d("ion-avatar"),M=d("div"),X=d("div"),G=Oe(J),_e=w(),D=d("ion-label"),se=d("ion-text"),me=d("h3"),ae=Oe(ue),oe=w(),ce=d("div"),ce.innerHTML=pe,re=w(),te=d("ion-icon"),this.h()},l(ee){Ee&&Ee.l(ee),e=N(ee),t=f(ee,"ION-CONTENT",{});var $=g(t);i=f($,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),le(i)!=="svelte-1mlmyg"&&(i.innerHTML=n),o=N($),s=f($,"ION-LIST",{});var ie=g(s);a=f(ie,"ION-ITEM",{});var K=g(a);h=f(K,"ION-AVATAR",{slot:!0});var ge=g(h);E=f(ge,"DIV",{class:!0,title:!0,style:!0});var Se=g(E);m=f(Se,"DIV",{class:!0,"data-svelte-h":!0}),le(m)!=="svelte-b78non"&&(m.textContent=_),Se.forEach(c),ge.forEach(c),p=N(K),k=f(K,"ION-LABEL",{button:!0});var Le=g(k);O=f(Le,"ION-TEXT",{color:!0});var Te=g(O);y=f(Te,"H3",{});var Z=g(y);P=ye(Z,B),Z.forEach(c),Te.forEach(c),R=N(Le),U=f(Le,"DIV",{class:!0}),g(U).forEach(c),Le.forEach(c),Q=N(K),q=f(K,"ION-ICON",{icon:!0,slot:!0}),g(q).forEach(c),K.forEach(c),L=N(ie);for(let Ne=0;Ne<H.length;Ne+=1)H[Ne].l(ie);I=N(ie),A=f(ie,"ION-ITEM",{});var T=g(A);V=f(T,"ION-AVATAR",{slot:!0});var z=g(V);M=f(z,"DIV",{class:!0,title:!0,style:!0});var C=g(M);X=f(C,"DIV",{class:!0});var F=g(X);G=ye(F,J),F.forEach(c),C.forEach(c),z.forEach(c),_e=N(T),D=f(T,"ION-LABEL",{button:!0});var S=g(D);se=f(S,"ION-TEXT",{color:!0});var Y=g(se);me=f(Y,"H3",{});var ke=g(me);ae=ye(ke,ue),ke.forEach(c),Y.forEach(c),oe=N(S),ce=f(S,"DIV",{class:!0,"data-svelte-h":!0}),le(ce)!=="svelte-17oqe78"&&(ce.innerHTML=pe),S.forEach(c),re=N(T),te=f(T,"ION-ICON",{icon:!0,slot:!0}),g(te).forEach(c),T.forEach(c),ie.forEach(c),$.forEach(c),this.h()},h(){b(i,"slot","fixed"),j(m,"class","order svelte-1ita8l7"),j(E,"class","order-wrapper svelte-1ita8l7"),j(E,"title",v="$"+l[6].origin),u(E,"background-color",l[6].color),u(E,"color",xe(l[6].color)),b(h,"slot","start"),b(O,"color","#2e2e2e"),j(U,"class","sub svelte-1ita8l7"),b(k,"button",""),b(q,"icon",je),b(q,"slot","end"),j(X,"class","order svelte-1ita8l7"),j(M,"class","order-wrapper svelte-1ita8l7"),j(M,"title",ne="$"+l[6].destination),u(M,"background-color",l[6].color),u(M,"color",xe(l[6].color)),b(V,"slot","start"),b(se,"color","#2e2e2e"),j(ce,"class","sub svelte-1ita8l7"),b(D,"button",""),b(te,"icon",je),b(te,"slot","end")},m(ee,$){Ee&&Ee.m(ee,$),W(ee,e,$),W(ee,t,$),r(t,i),l[33](i),r(t,o),r(t,s),r(s,a),r(a,h),r(h,E),r(E,m),r(a,p),r(a,k),r(k,O),r(O,y),r(y,P),r(k,R),r(k,U),r(a,Q),r(a,q),r(s,L);for(let ie=0;ie<H.length;ie+=1)H[ie]&&H[ie].m(s,null);r(s,I),r(s,A),r(A,V),r(V,M),r(M,X),r(X,G),r(A,_e),r(A,D),r(D,se),r(se,me),r(me,ae),r(D,oe),r(D,ce),r(A,re),r(A,te),be||(ve=[fe(i,"ionRefresh",l[11]),fe(k,"click",l[34]),fe(D,"click",l[36])],be=!0)},p(ee,$){ee[4]?Ee?Ee.p(ee,$):(Ee=un(ee),Ee.c(),Ee.m(e.parentNode,e)):Ee&&(Ee.d(1),Ee=null),$[0]&64&&v!==(v="$"+ee[6].origin)&&j(E,"title",v),$[0]&64&&u(E,"background-color",ee[6].color),$[0]&64&&u(E,"color",xe(ee[6].color)),$[0]&64&&B!==(B=ee[6].origin+"")&&Pe(P,B),$[0]&1319968&&(de=He(ee[5]),H=rt(H,$,he,1,ee,de,x,s,st,fn,I,rn)),$[0]&32&&J!==(J=ee[5].length+1+"")&&Pe(G,J),$[0]&64&&ne!==(ne="$"+ee[6].destination)&&j(M,"title",ne),$[0]&64&&u(M,"background-color",ee[6].color),$[0]&64&&u(M,"color",xe(ee[6].color)),$[0]&64&&ue!==(ue=ee[6].destination+"")&&Pe(ae,ue)},d(ee){ee&&(c(e),c(t)),Ee&&Ee.d(ee),l[33](null);for(let $=0;$<H.length;$+=1)H[$].d();be=!1,Ue(ve)}}}function to(l){let e,t;function i(s,a){return a[0]&144&&(e=null),e==null&&(e=!!(s[7].filter(ho).every(_o)&&!s[4])),e?lo:oo}let n=i(l,[-1,-1]),o=n(l);return{c(){o.c(),t=Ae()},l(s){o.l(s),t=Ae()},m(s,a){o.m(s,a),W(s,t,a)},p(s,a){n===(n=i(s,a))&&o?o.p(s,a):(o.d(1),o=n(s),o&&(o.c(),o.m(t.parentNode,t)))},d(s){s&&c(t),o.d(s)}}}function un(l){let e=l[15]("",l[1],l[0])+"",t;return{c(){t=Oe(e)},l(i){t=ye(i,e)},m(i,n){W(i,t,n)},p(i,n){n[0]&3&&e!==(e=i[15]("",i[1],i[0])+"")&&Pe(t,e)},d(i){i&&c(t)}}}function dn(l){let e;return{c(){e=d("span"),this.h()},l(t){e=f(t,"SPAN",{class:!0}),g(e).forEach(c),this.h()},h(){j(e,"class","notes svelte-1ita8l7")},m(t,i){W(t,e,i)},d(t){t&&c(e)}}}function no(l){let e;return{c(){e=d("ion-icon"),this.h()},l(t){e=f(t,"ION-ICON",{icon:!0,slot:!0,style:!0}),g(e).forEach(c),this.h()},h(){b(e,"icon",je),b(e,"slot","end"),u(e,"color",Be(l[55].status,l[55].date_service))},m(t,i){W(t,e,i)},p(t,i){i[0]&32&&u(e,"color",Be(t[55].status,t[55].date_service))},d(t){t&&c(e)}}}function io(l){let e,t=(l[55].tag?l[55].tag:"")+"",i;return{c(){e=d("div"),i=Oe(t),this.h()},l(n){e=f(n,"DIV",{class:!0,slot:!0,style:!0});var o=g(e);i=ye(o,t),o.forEach(c),this.h()},h(){j(e,"class","stop-tag"),j(e,"slot","end"),u(e,"background-color",ze(l[55].tag_color,.3)),u(e,"border","1px solid "+ze(l[55].tag_color,.4)),u(e,"color",l[55].tag_color),u(e,"font-size","10px"),u(e,"text-align","center"),u(e,"align-content","center"),u(e,"border-radius","20px"),u(e,"white-space","normal"),u(e,"padding","3px 6px"),u(e,"width","auto",1),u(e,"display","inline-block"),u(e,"font-weight","500")},m(n,o){W(n,e,o),r(e,i)},p(n,o){o[0]&32&&t!==(t=(n[55].tag?n[55].tag:"")+"")&&Pe(i,t),o[0]&32&&u(e,"background-color",ze(n[55].tag_color,.3)),o[0]&32&&u(e,"border","1px solid "+ze(n[55].tag_color,.4)),o[0]&32&&u(e,"color",n[55].tag_color)},d(n){n&&c(e)}}}function fn(l,e){let t,i,n,o,s=parseInt(e[55].pos)+1+"",a,h,E,m,_,v,p=e[55].title+"",k,O,y=e[55].support_list&&e[55].support_list.length||e[18](e[55]),B,P,R,U=y&&dn();function Q(){return e[35](e[55])}function q(x,I){return x[55].tag_color&&x[55].tag?io:no}let L=q(e),H=L(e);return{key:l,first:null,c(){t=d("ion-item"),i=d("ion-avatar"),n=d("div"),o=d("div"),a=Oe(s),E=w(),m=d("ion-label"),_=d("ion-text"),v=d("h3"),k=Oe(p),O=w(),U&&U.c(),B=w(),H.c(),this.h()},l(x){t=f(x,"ION-ITEM",{});var I=g(t);i=f(I,"ION-AVATAR",{slot:!0});var A=g(i);n=f(A,"DIV",{class:!0,title:!0,style:!0});var V=g(n);o=f(V,"DIV",{class:!0});var M=g(o);a=ye(M,s),M.forEach(c),V.forEach(c),A.forEach(c),E=N(I),m=f(I,"ION-LABEL",{button:!0});var X=g(m);_=f(X,"ION-TEXT",{color:!0});var J=g(_);v=f(J,"H3",{});var G=g(v);k=ye(G,p),O=N(G),U&&U.l(G),G.forEach(c),J.forEach(c),X.forEach(c),B=N(I),H.l(I),I.forEach(c),this.h()},h(){j(o,"class","order svelte-1ita8l7"),j(n,"class","order-wrapper svelte-1ita8l7"),j(n,"title",h=ot(e[55].status)),u(n,"background-color",Be(e[55].status,e[55].date_service)),u(n,"color",xe(Be(e[55].status))),b(i,"slot","start"),b(_,"color","#2e2e2e"),b(m,"button",""),this.first=t},m(x,I){W(x,t,I),r(t,i),r(i,n),r(n,o),r(o,a),r(t,E),r(t,m),r(m,_),r(_,v),r(v,k),r(v,O),U&&U.m(v,null),r(t,B),H.m(t,null),P||(R=fe(m,"click",Q),P=!0)},p(x,I){e=x,I[0]&32&&s!==(s=parseInt(e[55].pos)+1+"")&&Pe(a,s),I[0]&32&&h!==(h=ot(e[55].status))&&j(n,"title",h),I[0]&32&&u(n,"background-color",Be(e[55].status,e[55].date_service)),I[0]&32&&u(n,"color",xe(Be(e[55].status))),I[0]&32&&p!==(p=e[55].title+"")&&Pe(k,p),I[0]&32&&(y=e[55].support_list&&e[55].support_list.length||e[18](e[55])),y?U||(U=dn(),U.c(),U.m(v,null)):U&&(U.d(1),U=null),L===(L=q(e))&&H?H.p(e,I):(H.d(1),H=L(e),H&&(H.c(),H.m(t,null)))},d(x){x&&c(t),U&&U.d(),H.d(),P=!1,R()}}}function oo(l){let e=l[15](l[7],l[1],l[0])+"",t,i,n,o,s='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Pull to refresh" refreshing-spinner="circles" refreshing-text="Refreshing..."></ion-refresher-content>',a,h,E,m,_,v,p="0",k,O,y,B,P,R=l[6].origin+"",U,Q,q,L,H,x,I=[],A=new Map,V,M,X,J,G,ne=l[5].length+1+"",_e,D,se,me,ue,ae,oe=l[6].destination+"",ce,pe,re,te="",be,ve,Ee,de,he=He(l[5]);const ee=$=>$[55].id_event;for(let $=0;$<he.length;$+=1){let ie=sn(l,he,$),K=ee(ie);A.set(K,I[$]=_n(K,ie))}return{c(){t=Oe(e),i=w(),n=d("ion-content"),o=d("ion-refresher"),o.innerHTML=s,a=w(),h=d("ion-list"),E=d("ion-item"),m=d("ion-avatar"),_=d("div"),v=d("div"),v.textContent=p,O=w(),y=d("ion-label"),B=d("ion-text"),P=d("h3"),U=Oe(R),Q=w(),q=d("div"),L=w(),H=d("ion-icon"),x=w();for(let $=0;$<I.length;$+=1)I[$].c();V=w(),M=d("ion-item"),X=d("ion-avatar"),J=d("div"),G=d("div"),_e=Oe(ne),se=w(),me=d("ion-label"),ue=d("ion-text"),ae=d("h3"),ce=Oe(oe),pe=w(),re=d("div"),re.innerHTML=te,be=w(),ve=d("ion-icon"),this.h()},l($){t=ye($,e),i=N($),n=f($,"ION-CONTENT",{});var ie=g(n);o=f(ie,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),le(o)!=="svelte-1l8nqqz"&&(o.innerHTML=s),a=N(ie),h=f(ie,"ION-LIST",{});var K=g(h);E=f(K,"ION-ITEM",{});var ge=g(E);m=f(ge,"ION-AVATAR",{slot:!0});var Se=g(m);_=f(Se,"DIV",{class:!0,title:!0,style:!0});var Le=g(_);v=f(Le,"DIV",{class:!0,"data-svelte-h":!0}),le(v)!=="svelte-b78non"&&(v.textContent=p),Le.forEach(c),Se.forEach(c),O=N(ge),y=f(ge,"ION-LABEL",{button:!0});var Te=g(y);B=f(Te,"ION-TEXT",{color:!0});var Z=g(B);P=f(Z,"H3",{});var T=g(P);U=ye(T,R),T.forEach(c),Z.forEach(c),Q=N(Te),q=f(Te,"DIV",{class:!0}),g(q).forEach(c),Te.forEach(c),L=N(ge),H=f(ge,"ION-ICON",{icon:!0,slot:!0}),g(H).forEach(c),ge.forEach(c),x=N(K);for(let Ce=0;Ce<I.length;Ce+=1)I[Ce].l(K);V=N(K),M=f(K,"ION-ITEM",{});var z=g(M);X=f(z,"ION-AVATAR",{slot:!0});var C=g(X);J=f(C,"DIV",{class:!0,title:!0,style:!0});var F=g(J);G=f(F,"DIV",{class:!0});var S=g(G);_e=ye(S,ne),S.forEach(c),F.forEach(c),C.forEach(c),se=N(z),me=f(z,"ION-LABEL",{button:!0});var Y=g(me);ue=f(Y,"ION-TEXT",{color:!0});var ke=g(ue);ae=f(ke,"H3",{});var Ne=g(ae);ce=ye(Ne,oe),Ne.forEach(c),ke.forEach(c),pe=N(Y),re=f(Y,"DIV",{class:!0,"data-svelte-h":!0}),le(re)!=="svelte-1c76q1w"&&(re.innerHTML=te),Y.forEach(c),be=N(z),ve=f(z,"ION-ICON",{icon:!0,slot:!0}),g(ve).forEach(c),z.forEach(c),K.forEach(c),ie.forEach(c),this.h()},h(){b(o,"slot","fixed"),j(v,"class","order svelte-1ita8l7"),j(_,"class","order-wrapper svelte-1ita8l7"),j(_,"title",k="$"+l[6].origin),u(_,"background-color",l[6].color),u(_,"color",xe(l[6].color)),b(m,"slot","start"),b(B,"color","#2e2e2e"),j(q,"class","sub svelte-1ita8l7"),b(y,"button",""),b(H,"icon",je),b(H,"slot","end"),j(G,"class","order svelte-1ita8l7"),j(J,"class","order-wrapper svelte-1ita8l7"),j(J,"title",D="$"+l[6].destination),u(J,"background-color",l[6].color),u(J,"color",xe(l[6].color)),b(X,"slot","start"),b(ue,"color","#2e2e2e"),j(re,"class","sub svelte-1ita8l7"),b(me,"button",""),b(ve,"icon",je),b(ve,"slot","end")},m($,ie){W($,t,ie),W($,i,ie),W($,n,ie),r(n,o),l[29](o),r(n,a),r(n,h),r(h,E),r(E,m),r(m,_),r(_,v),r(E,O),r(E,y),r(y,B),r(B,P),r(P,U),r(y,Q),r(y,q),r(E,L),r(E,H),r(h,x);for(let K=0;K<I.length;K+=1)I[K]&&I[K].m(h,null);r(h,V),r(h,M),r(M,X),r(X,J),r(J,G),r(G,_e),r(M,se),r(M,me),r(me,ue),r(ue,ae),r(ae,ce),r(me,pe),r(me,re),r(M,be),r(M,ve),Ee||(de=[fe(o,"ionRefresh",l[11]),fe(y,"click",l[30]),fe(me,"click",l[32])],Ee=!0)},p($,ie){ie[0]&131&&e!==(e=$[15]($[7],$[1],$[0])+"")&&Pe(t,e),ie[0]&64&&k!==(k="$"+$[6].origin)&&j(_,"title",k),ie[0]&64&&u(_,"background-color",$[6].color),ie[0]&64&&u(_,"color",xe($[6].color)),ie[0]&64&&R!==(R=$[6].origin+"")&&Pe(U,R),ie[0]&1319968&&(he=He($[5]),I=rt(I,ie,ee,1,$,he,A,h,st,_n,V,sn)),ie[0]&32&&ne!==(ne=$[5].length+1+"")&&Pe(_e,ne),ie[0]&64&&D!==(D="$"+$[6].destination)&&j(J,"title",D),ie[0]&64&&u(J,"background-color",$[6].color),ie[0]&64&&u(J,"color",xe($[6].color)),ie[0]&64&&oe!==(oe=$[6].destination+"")&&Pe(ce,oe)},d($){$&&(c(t),c(i),c(n)),l[29](null);for(let ie=0;ie<I.length;ie+=1)I[ie].d();Ee=!1,Ue(de)}}}function lo(l){let e,t,i='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Jale para actualizar" refreshing-spinner="circles" refreshing-text="Actualizando..."></ion-refresher-content>',n,o,s,a,h,E,m="0",_,v,p,k,O,y=l[6].origin+"",B,P,R,U,Q,q,L=[],H=new Map,x,I,A,V,M,X=l[5].length+1+"",J,G,ne,_e,D,se,me=l[6].destination+"",ue,ae,oe,ce="",pe,re,te,be,ve=He(l[5]);const Ee=de=>de[55].id_event;for(let de=0;de<ve.length;de+=1){let he=an(l,ve,de),ee=Ee(he);H.set(ee,L[de]=mn(ee,he))}return{c(){e=d("ion-content"),t=d("ion-refresher"),t.innerHTML=i,n=w(),o=d("ion-list"),s=d("ion-item"),a=d("ion-avatar"),h=d("div"),E=d("div"),E.textContent=m,v=w(),p=d("ion-label"),k=d("ion-text"),O=d("h3"),B=Oe(y),P=w(),R=d("div"),U=w(),Q=d("ion-icon"),q=w();for(let de=0;de<L.length;de+=1)L[de].c();x=w(),I=d("ion-item"),A=d("ion-avatar"),V=d("div"),M=d("div"),J=Oe(X),ne=w(),_e=d("ion-label"),D=d("ion-text"),se=d("h3"),ue=Oe(me),ae=w(),oe=d("div"),oe.innerHTML=ce,pe=w(),re=d("ion-icon"),this.h()},l(de){e=f(de,"ION-CONTENT",{});var he=g(e);t=f(he,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),le(t)!=="svelte-vjbhg4"&&(t.innerHTML=i),n=N(he),o=f(he,"ION-LIST",{});var ee=g(o);s=f(ee,"ION-ITEM",{});var $=g(s);a=f($,"ION-AVATAR",{slot:!0});var ie=g(a);h=f(ie,"DIV",{class:!0,title:!0,style:!0});var K=g(h);E=f(K,"DIV",{class:!0,"data-svelte-h":!0}),le(E)!=="svelte-b78non"&&(E.textContent=m),K.forEach(c),ie.forEach(c),v=N($),p=f($,"ION-LABEL",{button:!0});var ge=g(p);k=f(ge,"ION-TEXT",{color:!0});var Se=g(k);O=f(Se,"H3",{});var Le=g(O);B=ye(Le,y),Le.forEach(c),Se.forEach(c),P=N(ge),R=f(ge,"DIV",{class:!0}),g(R).forEach(c),ge.forEach(c),U=N($),Q=f($,"ION-ICON",{icon:!0,slot:!0}),g(Q).forEach(c),$.forEach(c),q=N(ee);for(let Y=0;Y<L.length;Y+=1)L[Y].l(ee);x=N(ee),I=f(ee,"ION-ITEM",{});var Te=g(I);A=f(Te,"ION-AVATAR",{slot:!0});var Z=g(A);V=f(Z,"DIV",{class:!0,title:!0,style:!0});var T=g(V);M=f(T,"DIV",{class:!0});var z=g(M);J=ye(z,X),z.forEach(c),T.forEach(c),Z.forEach(c),ne=N(Te),_e=f(Te,"ION-LABEL",{button:!0});var C=g(_e);D=f(C,"ION-TEXT",{color:!0});var F=g(D);se=f(F,"H3",{});var S=g(se);ue=ye(S,me),S.forEach(c),F.forEach(c),ae=N(C),oe=f(C,"DIV",{class:!0,"data-svelte-h":!0}),le(oe)!=="svelte-1c76q1w"&&(oe.innerHTML=ce),C.forEach(c),pe=N(Te),re=f(Te,"ION-ICON",{icon:!0,slot:!0}),g(re).forEach(c),Te.forEach(c),ee.forEach(c),he.forEach(c),this.h()},h(){b(t,"slot","fixed"),j(E,"class","order svelte-1ita8l7"),j(h,"class","order-wrapper svelte-1ita8l7"),j(h,"title",_="$"+l[6].origin),u(h,"background-color",l[6].color),u(h,"color",xe(l[6].color)),b(a,"slot","start"),b(k,"color","#2e2e2e"),j(R,"class","sub svelte-1ita8l7"),b(p,"button",""),b(Q,"icon",je),b(Q,"slot","end"),j(M,"class","order svelte-1ita8l7"),j(V,"class","order-wrapper svelte-1ita8l7"),j(V,"title",G="$"+l[6].destination),u(V,"background-color",l[6].color),u(V,"color",xe(l[6].color)),b(A,"slot","start"),b(D,"color","#2e2e2e"),j(oe,"class","sub svelte-1ita8l7"),b(_e,"button",""),b(re,"icon",je),b(re,"slot","end")},m(de,he){W(de,e,he),r(e,t),l[25](t),r(e,n),r(e,o),r(o,s),r(s,a),r(a,h),r(h,E),r(s,v),r(s,p),r(p,k),r(k,O),r(O,B),r(p,P),r(p,R),r(s,U),r(s,Q),r(o,q);for(let ee=0;ee<L.length;ee+=1)L[ee]&&L[ee].m(o,null);r(o,x),r(o,I),r(I,A),r(A,V),r(V,M),r(M,J),r(I,ne),r(I,_e),r(_e,D),r(D,se),r(se,ue),r(_e,ae),r(_e,oe),r(I,pe),r(I,re),te||(be=[fe(t,"ionRefresh",l[11]),fe(p,"click",l[26]),fe(_e,"click",l[28])],te=!0)},p(de,he){he[0]&64&&_!==(_="$"+de[6].origin)&&j(h,"title",_),he[0]&64&&u(h,"background-color",de[6].color),he[0]&64&&u(h,"color",xe(de[6].color)),he[0]&64&&y!==(y=de[6].origin+"")&&Pe(B,y),he[0]&1319968&&(ve=He(de[5]),L=rt(L,he,Ee,1,de,ve,H,o,st,mn,x,an)),he[0]&32&&X!==(X=de[5].length+1+"")&&Pe(J,X),he[0]&64&&G!==(G="$"+de[6].destination)&&j(V,"title",G),he[0]&64&&u(V,"background-color",de[6].color),he[0]&64&&u(V,"color",xe(de[6].color)),he[0]&64&&me!==(me=de[6].destination+"")&&Pe(ue,me)},d(de){de&&c(e),l[25](null);for(let he=0;he<L.length;he+=1)L[he].d();te=!1,Ue(be)}}}function hn(l){let e;return{c(){e=d("span"),this.h()},l(t){e=f(t,"SPAN",{class:!0}),g(e).forEach(c),this.h()},h(){j(e,"class","notes svelte-1ita8l7")},m(t,i){W(t,e,i)},d(t){t&&c(e)}}}function ro(l){let e;return{c(){e=d("ion-icon"),this.h()},l(t){e=f(t,"ION-ICON",{icon:!0,slot:!0,style:!0}),g(e).forEach(c),this.h()},h(){b(e,"icon",je),b(e,"slot","end"),u(e,"color",Be(l[55].status,l[55].date_service))},m(t,i){W(t,e,i)},p(t,i){i[0]&32&&u(e,"color",Be(t[55].status,t[55].date_service))},d(t){t&&c(e)}}}function so(l){let e,t=(l[55].tag?l[55].tag:"")+"",i;return{c(){e=d("div"),i=Oe(t),this.h()},l(n){e=f(n,"DIV",{class:!0,slot:!0,style:!0});var o=g(e);i=ye(o,t),o.forEach(c),this.h()},h(){j(e,"class","stop-tag"),j(e,"slot","end"),u(e,"background-color",ze(l[55].tag_color,.3)),u(e,"border","1px solid "+ze(l[55].tag_color,.4)),u(e,"color",l[55].tag_color),u(e,"font-size","10px"),u(e,"text-align","center"),u(e,"align-content","center"),u(e,"border-radius","20px"),u(e,"white-space","normal"),u(e,"padding","3px 6px"),u(e,"width","auto",1),u(e,"display","inline-block"),u(e,"font-weight","500")},m(n,o){W(n,e,o),r(e,i)},p(n,o){o[0]&32&&t!==(t=(n[55].tag?n[55].tag:"")+"")&&Pe(i,t),o[0]&32&&u(e,"background-color",ze(n[55].tag_color,.3)),o[0]&32&&u(e,"border","1px solid "+ze(n[55].tag_color,.4)),o[0]&32&&u(e,"color",n[55].tag_color)},d(n){n&&c(e)}}}function _n(l,e){let t,i,n,o,s=parseInt(e[55].pos)+1+"",a,h,E,m,_,v,p=e[55].title+"",k,O,y=e[55].support_list&&e[55].support_list.length||e[18](e[55]),B,P,R="",U,Q,q,L=y&&hn();function H(){return e[31](e[55])}function x(V,M){return V[55].tag_color&&V[55].tag?so:ro}let I=x(e),A=I(e);return{key:l,first:null,c(){t=d("ion-item"),i=d("ion-avatar"),n=d("div"),o=d("div"),a=Oe(s),E=w(),m=d("ion-label"),_=d("ion-text"),v=d("h3"),k=Oe(p),O=w(),L&&L.c(),B=w(),P=d("div"),P.innerHTML=R,U=w(),A.c(),this.h()},l(V){t=f(V,"ION-ITEM",{});var M=g(t);i=f(M,"ION-AVATAR",{slot:!0});var X=g(i);n=f(X,"DIV",{class:!0,title:!0,style:!0});var J=g(n);o=f(J,"DIV",{class:!0});var G=g(o);a=ye(G,s),G.forEach(c),J.forEach(c),X.forEach(c),E=N(M),m=f(M,"ION-LABEL",{button:!0});var ne=g(m);_=f(ne,"ION-TEXT",{color:!0});var _e=g(_);v=f(_e,"H3",{});var D=g(v);k=ye(D,p),O=N(D),L&&L.l(D),D.forEach(c),_e.forEach(c),B=N(ne),P=f(ne,"DIV",{class:!0,"data-svelte-h":!0}),le(P)!=="svelte-1cx9r38"&&(P.innerHTML=R),ne.forEach(c),U=N(M),A.l(M),M.forEach(c),this.h()},h(){j(o,"class","order svelte-1ita8l7"),j(n,"class","order-wrapper svelte-1ita8l7"),j(n,"title",h=ot(e[55].status)),u(n,"background-color",Be(e[55].status,e[55].date_service)),u(n,"color",xe(Be(e[55].status))),b(i,"slot","start"),b(_,"color","#2e2e2e"),j(P,"class","sub svelte-1ita8l7"),b(m,"button",""),this.first=t},m(V,M){W(V,t,M),r(t,i),r(i,n),r(n,o),r(o,a),r(t,E),r(t,m),r(m,_),r(_,v),r(v,k),r(v,O),L&&L.m(v,null),r(m,B),r(m,P),r(t,U),A.m(t,null),Q||(q=fe(m,"click",H),Q=!0)},p(V,M){e=V,M[0]&32&&s!==(s=parseInt(e[55].pos)+1+"")&&Pe(a,s),M[0]&32&&h!==(h=ot(e[55].status))&&j(n,"title",h),M[0]&32&&u(n,"background-color",Be(e[55].status,e[55].date_service)),M[0]&32&&u(n,"color",xe(Be(e[55].status))),M[0]&32&&p!==(p=e[55].title+"")&&Pe(k,p),M[0]&32&&(y=e[55].support_list&&e[55].support_list.length||e[18](e[55])),y?L||(L=hn(),L.c(),L.m(v,null)):L&&(L.d(1),L=null),I===(I=x(e))&&A?A.p(e,M):(A.d(1),A=I(e),A&&(A.c(),A.m(t,null)))},d(V){V&&c(t),L&&L.d(),A.d(),Q=!1,q()}}}function pn(l){let e;return{c(){e=d("span"),this.h()},l(t){e=f(t,"SPAN",{class:!0}),g(e).forEach(c),this.h()},h(){j(e,"class","notes svelte-1ita8l7")},m(t,i){W(t,e,i)},d(t){t&&c(e)}}}function ao(l){let e;return{c(){e=d("ion-icon"),this.h()},l(t){e=f(t,"ION-ICON",{icon:!0,slot:!0,style:!0}),g(e).forEach(c),this.h()},h(){b(e,"icon",je),b(e,"slot","end"),u(e,"color",Be(l[55].status,l[55].date_service))},m(t,i){W(t,e,i)},p(t,i){i[0]&32&&u(e,"color",Be(t[55].status,t[55].date_service))},d(t){t&&c(e)}}}function co(l){let e,t=(l[55].tag?l[55].tag:"")+"",i;return{c(){e=d("div"),i=Oe(t),this.h()},l(n){e=f(n,"DIV",{class:!0,slot:!0,style:!0});var o=g(e);i=ye(o,t),o.forEach(c),this.h()},h(){j(e,"class","stop-tag"),j(e,"slot","end"),u(e,"background-color",ze(l[55].tag_color,.3)),u(e,"border","1px solid "+ze(l[55].tag_color,.4)),u(e,"color",l[55].tag_color),u(e,"font-size","10px"),u(e,"text-align","center"),u(e,"align-content","center"),u(e,"border-radius","20px"),u(e,"white-space","normal"),u(e,"padding","3px 6px"),u(e,"width","auto",1),u(e,"display","inline-block"),u(e,"font-weight","500")},m(n,o){W(n,e,o),r(e,i)},p(n,o){o[0]&32&&t!==(t=(n[55].tag?n[55].tag:"")+"")&&Pe(i,t),o[0]&32&&u(e,"background-color",ze(n[55].tag_color,.3)),o[0]&32&&u(e,"border","1px solid "+ze(n[55].tag_color,.4)),o[0]&32&&u(e,"color",n[55].tag_color)},d(n){n&&c(e)}}}function mn(l,e){let t,i,n,o,s=parseInt(e[55].pos)+1+"",a,h,E,m,_,v,p=e[55].title+"",k,O,y=e[55].support_list&&e[55].support_list.length||e[18](e[55]),B,P,R="",U,Q,q,L=y&&pn();function H(){return e[27](e[55])}function x(V,M){return V[55].tag_color&&V[55].tag?co:ao}let I=x(e),A=I(e);return{key:l,first:null,c(){t=d("ion-item"),i=d("ion-avatar"),n=d("div"),o=d("div"),a=Oe(s),E=w(),m=d("ion-label"),_=d("ion-text"),v=d("h3"),k=Oe(p),O=w(),L&&L.c(),B=w(),P=d("div"),P.innerHTML=R,U=w(),A.c(),this.h()},l(V){t=f(V,"ION-ITEM",{});var M=g(t);i=f(M,"ION-AVATAR",{slot:!0});var X=g(i);n=f(X,"DIV",{class:!0,title:!0,style:!0});var J=g(n);o=f(J,"DIV",{class:!0});var G=g(o);a=ye(G,s),G.forEach(c),J.forEach(c),X.forEach(c),E=N(M),m=f(M,"ION-LABEL",{button:!0});var ne=g(m);_=f(ne,"ION-TEXT",{color:!0});var _e=g(_);v=f(_e,"H3",{});var D=g(v);k=ye(D,p),O=N(D),L&&L.l(D),D.forEach(c),_e.forEach(c),B=N(ne),P=f(ne,"DIV",{class:!0,"data-svelte-h":!0}),le(P)!=="svelte-1cx9r38"&&(P.innerHTML=R),ne.forEach(c),U=N(M),A.l(M),M.forEach(c),this.h()},h(){j(o,"class","order svelte-1ita8l7"),j(n,"class","order-wrapper svelte-1ita8l7"),j(n,"title",h=ot(e[55].status)),u(n,"background-color",Be(e[55].status,e[55].date_service)),u(n,"color",xe(Be(e[55].status))),b(i,"slot","start"),b(_,"color","#2e2e2e"),j(P,"class","sub svelte-1ita8l7"),b(m,"button",""),this.first=t},m(V,M){W(V,t,M),r(t,i),r(i,n),r(n,o),r(o,a),r(t,E),r(t,m),r(m,_),r(_,v),r(v,k),r(v,O),L&&L.m(v,null),r(m,B),r(m,P),r(t,U),A.m(t,null),Q||(q=fe(m,"click",H),Q=!0)},p(V,M){e=V,M[0]&32&&s!==(s=parseInt(e[55].pos)+1+"")&&Pe(a,s),M[0]&32&&h!==(h=ot(e[55].status))&&j(n,"title",h),M[0]&32&&u(n,"background-color",Be(e[55].status,e[55].date_service)),M[0]&32&&u(n,"color",xe(Be(e[55].status))),M[0]&32&&p!==(p=e[55].title+"")&&Pe(k,p),M[0]&32&&(y=e[55].support_list&&e[55].support_list.length||e[18](e[55])),y?L||(L=pn(),L.c(),L.m(v,null)):L&&(L.d(1),L=null),I===(I=x(e))&&A?A.p(e,M):(A.d(1),A=I(e),A&&(A.c(),A.m(t,null)))},d(V){V&&c(t),L&&L.d(),A.d(),Q=!1,q()}}}function uo(l){let e,t,i,n,o=`<ion-icon icon="${Gn}"></ion-icon>`,s,a,h,E=`<ion-icon icon="${Kn}"></ion-icon>`,m,_,v=`<ion-icon icon="${Xn}"></ion-icon>`,p,k,O=(l[6].name?l[6].name.toUpperCase():"")+"",y,B,P,R='<ion-segment-button value="list"><ion-label>Paradas</ion-label></ion-segment-button> <ion-segment-button value="map"><ion-label>Mapa</ion-label></ion-segment-button>',U,Q,q,L;function H(A,V){if(A[9]==="list")return $i;if(A[9]==="map")return Zi}let x=H(l),I=x&&x(l);return{c(){e=d("ion-header"),t=d("ion-toolbar"),i=d("ion-buttons"),n=d("ion-button"),n.innerHTML=o,s=w(),a=d("ion-buttons"),h=d("ion-button"),h.innerHTML=E,m=w(),_=d("ion-button"),_.innerHTML=v,p=w(),k=d("ion-title"),y=Oe(O),B=w(),P=d("ion-segment"),P.innerHTML=R,U=w(),I&&I.c(),Q=Ae(),this.h()},l(A){e=f(A,"ION-HEADER",{translucent:!0});var V=g(e);t=f(V,"ION-TOOLBAR",{});var M=g(t);i=f(M,"ION-BUTTONS",{slot:!0});var X=g(i);n=f(X,"ION-BUTTON",{title:!0,alt:!0,"data-svelte-h":!0}),le(n)!=="svelte-1a21unf"&&(n.innerHTML=o),X.forEach(c),s=N(M),a=f(M,"ION-BUTTONS",{slot:!0});var J=g(a);h=f(J,"ION-BUTTON",{"data-svelte-h":!0}),le(h)!=="svelte-dy3728"&&(h.innerHTML=E),m=N(J),_=f(J,"ION-BUTTON",{"data-svelte-h":!0}),le(_)!=="svelte-1omw1hr"&&(_.innerHTML=v),J.forEach(c),p=N(M),k=f(M,"ION-TITLE",{});var G=g(k);y=ye(G,O),G.forEach(c),M.forEach(c),B=N(V),P=f(V,"ION-SEGMENT",{value:!0,"data-svelte-h":!0}),le(P)!=="svelte-1rseadq"&&(P.innerHTML=R),V.forEach(c),U=N(A),I&&I.l(A),Q=Ae(),this.h()},h(){b(n,"title","Atrás"),b(n,"alt","Atrás"),b(i,"slot","start"),b(a,"slot","end"),b(P,"value","list"),b(e,"translucent","")},m(A,V){W(A,e,V),r(e,t),r(t,i),r(i,n),r(t,s),r(t,a),r(a,h),r(a,m),r(a,_),r(t,p),r(t,k),r(k,y),r(e,B),r(e,P),W(A,U,V),I&&I.m(A,V),W(A,Q,V),q||(L=[fe(n,"click",l[19]),fe(h,"click",l[22]),fe(_,"click",l[23]),fe(P,"ionChange",l[24])],q=!0)},p(A,V){V[0]&64&&O!==(O=(A[6].name?A[6].name.toUpperCase():"")+"")&&Pe(y,O),x===(x=H(A))&&I?I.p(A,V):(I&&I.d(1),I=x&&x(A),I&&(I.c(),I.m(Q.parentNode,Q)))},d(A){A&&(c(e),c(U),c(Q)),I&&I.d(A),q=!1,Ue(L)}}}function fo(l){let e,t,i,n=l[2]&&cn(l);return{c(){e=w(),n&&n.c(),t=Ae(),this.h()},l(o){Mn("svelte-kn0kph",ln.head).forEach(c),e=N(o),n&&n.l(o),t=Ae(),this.h()},h(){ln.title="Rutaflow - Detalles de ruta"},m(o,s){W(o,e,s),n&&n.m(o,s),W(o,t,s),i=!0},p(o,s){o[2]?n?(n.p(o,s),s[0]&4&&$e(n,1)):(n=cn(o),n.c(),$e(n,1),n.m(t.parentNode,t)):n&&(An(),it(n,1,1,()=>{n=null}),Pn())},i(o){i||($e(n),i=!0)},o(o){it(n),i=!1},d(o){o&&(c(e),c(t)),n&&n.d(o)}}}function Be(l,e=""){let t="#ffffff";return l==="pending"&&!e?t="#f2e300":l=="pending"&&e?t="#F6A833":l==="completed"&&(t="#44d900"),t}function ot(l){let e="";return l=="pending"?e="Pendiente":l=="completed"&&(e="Completado"),e}function xe(l){l.slice(0,1)==="#"&&(l=l.slice(1)),l.length===3&&(l=l.split("").map(function(o){return o+o}).join(""));const e=parseInt(l.substr(0,2),16),t=parseInt(l.substr(2,2),16),i=parseInt(l.substr(4,2),16);return(e*299+t*587+i*114)/1e3>=128?"#414040":"#fff"}function ft(l,e){for(let t=0;t<e.length;t++)if(e[t].alias===l)return e[t].val;return""}const ho=l=>l.mandatory==="1",_o=l=>l.img;function po(l,e,t){let i;Sn(l,Jn,Z=>t(21,i=Z));var n=this&&this.__awaiter||function(Z,T,z,C){function F(S){return S instanceof z?S:new z(function(Y){Y(S)})}return new(z||(z=Promise))(function(S,Y){function ke(Ie){try{Ce(C.next(Ie))}catch(we){Y(we)}}function Ne(Ie){try{Ce(C.throw(Ie))}catch(we){Y(we)}}function Ce(Ie){Ie.done?S(Ie.value):F(Ie.value).then(ke,Ne)}Ce((C=C.apply(Z,T||[])).next())})};let{routeId:o}=e,{driverId:s}=e,a=at,h=new Object,E=!0,m=!1,_=[],v=[],p={},k=[],O=[],y,B=!1,P="list",R,U="",Q="",q="",L="0",H=new Object,x=null;const I={car_accident:"/car-accident.svg",restaurant:"/restaurant.svg",parking:"/parking.svg",hospital:"/hospital.svg",wc:"/toilet.svg"},A=()=>n(void 0,void 0,void 0,function*(){yield X(o),y.complete()});et(()=>n(void 0,void 0,void 0,function*(){pe(),yield X(o)}));function V(Z){return n(this,void 0,void 0,function*(){if(t(9,P=Z),P==="map"){yield Ot(),R=document.getElementById("g_map");const T=new google.maps.Map(R,{zoom:8,center:{lat:20.6745683,lng:-103.3986104},mapId:"4504f8b37365c3d0"}),z=new google.maps.LatLngBounds,{AdvancedMarkerElement:C,PinElement:F}=yield google.maps.importLibrary("marker");navigator.geolocation?navigator.geolocation.getCurrentPosition(function(S){const Y=new google.maps.LatLng(S.coords.latitude,S.coords.longitude);new google.maps.Marker({position:Y,map:T,icon:{path:google.maps.SymbolPath.CIRCLE,fillColor:"#0062ff",fillOpacity:1,scale:6,strokeColor:"#ffffff",strokeWeight:2}}),new google.maps.Circle({strokeColor:"#00BFFF",strokeOpacity:.5,strokeWeight:1,fillColor:"#00BFFF",fillOpacity:.2,map:T,center:Y,radius:S.coords.accuracy}),z.extend(Y)},function(S){console.error("Error retrieving location:",S)}):console.error("Geolocation not supported by this browser."),p.lat1===p.lat2&&p.lon1===p.lon2?M(z,T,{lat:p.lat2,lon:p.lon2,color:p.color,title:p.destination},{type:"icon",iconClass:"icon-home",title:"Origen/Destino",glyph:`0,${String(_.length+1)}`}):(M(z,T,{lat:p.lat1,lon:p.lon1,color:p.color,title:p.origin},{type:"icon",iconClass:"icon-home",title:"Origen",glyph:"0"}),M(z,T,{lat:p.lat2,lon:p.lon2,color:p.color,title:p.destination},{type:"icon",iconClass:"icon-flag",title:"Destino",glyph:String(_.length+1)})),_.forEach((S,Y)=>{const ke=parseFloat(S.lat),Ne=parseFloat(S.lon),Ce=new google.maps.LatLng(ke,Ne),Ie=new google.maps.Marker({position:{lat:ke,lng:Ne},map:T,title:S.title}),we=new F({background:Be(S.status,S.date_service),borderColor:"#000",glyphColor:"#000",glyph:(parseInt(S.pos)+1).toString()});new C({map:T,position:Ce,content:we.element,title:"Parada "+(parseInt(S.pos)+1).toString()+": "+S.title}).addListener("click",function(Ke){G(S,!1)}),z.extend(Ie.getPosition())}),v.forEach(S=>{const Y=+S.lat,ke=+S.lng;if(isNaN(Y)||isNaN(ke))return;const Ne=I[S.type]||"alert-sharp",Ce=document.createElement("div");Ce.style.cssText="display:flex;align-items:center;justify-content:center;transform:scale(.85);";const Ie=document.createElement("ion-icon");Ne.startsWith("/")?Ie.setAttribute("src",Ne):Ie.setAttribute("icon",Ne),Ie.style.cssText="font-size:20px;color:#d13434;",Ce.appendChild(Ie);const we=new F({background:"#fff",borderColor:"#000",glyph:Ce}),Re=new C({map:T,position:{lat:Y,lng:ke},content:we.element,title:S.motive||S.type});z.extend(Re.position)}),T.fitBounds(z)}})}function M(Z,T,z,C){return n(this,void 0,void 0,function*(){let F;const S=parseFloat(z.lat),Y=parseFloat(z.lon),ke=new google.maps.LatLng(S,Y),{AdvancedMarkerElement:Ne,PinElement:Ce}=yield google.maps.importLibrary("marker");C.type=="icon"?(F=document.createElement("i"),F.className=`${C.iconClass} icon`,F.style.fontSize="14px",F.style.color=xe(z.color),F.style.fontWeight="600"):C.type=="text";const Ie=new google.maps.Marker({position:{lat:S,lng:Y},map:T,title:`${C.title}. ${z.title}`}),we=new Ce({background:z.color,borderColor:"#000",glyphColor:xe(z.color),glyph:C.glyph});return new Ne({map:T,position:ke,content:we.element,title:C.title+": "+z.title}).addListener("click",function(Ke){ne(p,C.title=="Destino"||C.title=="Origen/Destino")}),Ie})}function X(Z){return n(this,void 0,void 0,function*(){let T=new FormData;T.append("id_route",Z),T=ce(T),T.append("id_enterprise",h.id_enterprise);try{const C=yield(yield fetch(`${a}api/admin/report/seguimiento_list.php`,{method:"POST",body:T})).json();t(6,p=C.data.seguimiento_list[0]),t(5,_=C.data.event_list),t(7,k=C.data.checklist),O=C.data.expenses,v=C.data.incidence_list,p&&t(4,m=p.km_inicial=="0"&&p.gas_inicial=="0"),t(3,E=!1)}catch(z){t(3,E=!1),console.error("Error fetching data:",z)}})}const J=Z=>new Promise((T,z)=>{let C=new FormData;C.append("id_route",Z.id_route),C.append("id_event",Z.id_event),C=ce(C),fetch(`${a}api/admin/evidence/evidence_by_event.php`,{method:"POST",body:C}).then(F=>F.json()).then(F=>{T(F.data.event_evidence[0])}).catch(F=>{console.error("Error fetching data:",F),z(F)})});function G(Z,T){return x||(x=n(this,void 0,void 0,function*(){let z=null;try{z=yield J(Z)}catch{}const C=Object.assign(Object.assign(Object.assign({},Z),{stopsApproval:U,smsActive:Q,signatureActive:q}),z||{});try{yield We("modal-delivery-info",Ft,{delivery:C,isLast:T})}finally{x=null,X(o)}}),x)}const ne=(Z,T)=>{var z=new Object;T?z={title:Z.destination,line1:Z.dest_address}:z={title:Z.origin,line1:Z.origin_address},z.enterprise_name=Z.enterprise_name,z.client_name=Z.client_name,z.client_phone=Z.tel,z.id_route=Z.id_route,z.stopsApproval=U,z.smsActive=Q;var C=!0;We("modal-delivery-info",Ft,{delivery:z,isLast:T,flag:C})},_e=(Z,T,z)=>{var C=!1;return B||(B=!0,We("modal-checklist",Nn,{checklist:Z,driverId:T,routeId:z,isLast:C}).then(F=>{B=!1}),ue(z,"checklist")),""},D=Z=>n(void 0,void 0,void 0,function*(){return yield X(Z),O.length>0?We("modal-expense-detail",Qi,{routeId:Z,expenses:O}).then(T=>{}):We("modal-expense",Et,{routeId:Z}).then(T=>{}),""}),se=Z=>n(void 0,void 0,void 0,function*(){return yield X(Z),We("modal-incidence",Gi,{routeId:Z}).then(T=>{}),""}),me=Z=>{if(Z.tracking_type=="subscription"){if(Z.subscriber_info&&Z.payment_type==="cash"&&new Date(Z.subscriber_info.payment_next)<new Date)return!0}else if(Z.tracking_type=="ecommerce"&&Number(Z.payment_pending)>0)return!0;return!1};function ue(Z,T){let z=new FormData;return z.append("id_route",Z),z.append("status",T),z=ce(z),fetch(`${a}api/admin/route/change_status.php`,{method:"POST",body:z}).then(C=>C.json()).then(C=>{}).catch(C=>{console.error("Error fetching data:",C)}),""}const ae=()=>{h.type=="super"||h.type=="admin"?Ze("/drivers/me"):h.id_driver&&Ze(`/drivers/${h.id_driver}`)},oe=(Z,T)=>n(void 0,void 0,void 0,function*(){yield(yield qe.create({header:Z||"Error",message:T||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()});function ce(Z){return Z.append("token",h.token),Z.append("id_user_over",h.id_user),Z}const pe=()=>n(void 0,void 0,void 0,function*(){if(h.id_enterprise){let Z=new FormData;Z.append("id_enterprise",h.id_enterprise),Z=ce(Z);try{const T=yield fetch(`${a}api/admin/enterprise/enterprise_settings.php`,{method:"POST",body:Z});T.ok?(H=(yield T.json()).nodos,U=ft("stops_wait_approval",H),Q=ft("sms_active",H),t(10,L=ft("stops_order_restriction",H)),q=ft("signature_active",H)):console.error("File upload failed:",T.statusText)}catch(T){console.error("Error during file upload:",T)}}}),re=()=>se(o),te=()=>D(o),be=Z=>V(Z.detail.value);function ve(Z){De[Z?"unshift":"push"](()=>{y=Z,t(8,y)})}const Ee=()=>{ne(p,!1)},de=Z=>{const T=_.findIndex(Y=>Y.id_event===Z.id_event),z=T===0,C=T>0?_[T-1]:null,F=z||C&&C.img!==null,S=Z.img!==null&&Z.img!=="";F||z&&!S||L=="1"?G(Z,!1):oe("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")},he=()=>{ne(p,!0)};function ee(Z){De[Z?"unshift":"push"](()=>{y=Z,t(8,y)})}const $=()=>{ne(p,!1)},ie=Z=>{const T=_.findIndex(Y=>Y.id_event===Z.id_event),z=T===0,C=T>0?_[T-1]:null,F=z||C&&C.img!==null,S=Z.img!==null&&Z.img!=="";F||z&&!S||L=="1"?G(Z,!1):oe("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")},K=()=>{ne(p,!0)};function ge(Z){De[Z?"unshift":"push"](()=>{y=Z,t(8,y)})}const Se=()=>{ne(p,!1)},Le=Z=>{const T=_.findIndex(Y=>Y.id_event===Z.id_event),z=T===0,C=T>0?_[T-1]:null,F=z||C&&C.img!==null,S=Z.img!==null&&Z.img!=="";F||z&&!S||L=="1"?G(Z,!1):oe("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")},Te=()=>{ne(p,!0)};return l.$$set=Z=>{"routeId"in Z&&t(0,o=Z.routeId),"driverId"in Z&&t(1,s=Z.driverId)},l.$$.update=()=>{l.$$.dirty[0]&2097157&&(t(0,{routeId:o,driverId:s}=i.params,o,(t(1,s),t(21,i),t(2,h),t(0,o))),t(2,h=JSON.parse(localStorage.getItem("userSession"))),h?h.id_user&&(h.type=="admin"||h.type=="super")?(X(o),Ze(`/drivers/me/routes/${o}`)):h.id_user&&h.id_driver&&(X(o),Ze(`/drivers/${h.id_driver}/routes/${o}`)):Ze("/"))},[o,s,h,E,m,_,p,k,y,P,L,A,V,G,ne,_e,D,se,me,ae,oe,i,re,te,be,ve,Ee,de,he,ee,$,ie,K,ge,Se,Le,Te]}class Oo extends Ye{constructor(e){super(),Qe(this,e,po,fo,Je,{routeId:0,driverId:1},null,[-1,-1])}}export{Oo as component};

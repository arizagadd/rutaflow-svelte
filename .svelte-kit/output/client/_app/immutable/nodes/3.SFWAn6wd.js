import{s as oe,e as f,b as _,q as I,h,v as g,i as ae,x as H,n as X,z as ue,o as ce,A as Y,j as L,d as Z,m as R,f as de,w as d,G as x}from"../chunks/index.BYLndrM5.js";import{S as re,i as ie,b as P,d as j,m as k,t as A,a as W,e as B,f as ee}from"../chunks/index.BNHbygFo.js";import"../chunks/index-48209844.IIRtDZyg.js";import{I as me,a as te}from"../chunks/IonPage.KvUD72q2.js";import{a as pe}from"../chunks/authStore.Dl96eK1q.js";import{g as E}from"../chunks/entry.B6U0hnRL.js";function fe(a){let e,o,n;return{c(){e=f("ion-input"),this.h()},l(t){e=_(t,"ION-INPUT",{type:!0,name:!0,placeholder:!0,value:!0}),I(e).forEach(h),this.h()},h(){g(e,"type",a[2]),g(e,"name",a[1]),g(e,"placeholder",a[3]),g(e,"value",a[0])},m(t,r){ae(t,e,r),o||(n=[H(e,"ionBlur",a[5]),H(e,"ionChange",a[4])],o=!0)},p(t,[r]){r&4&&g(e,"type",t[2]),r&2&&g(e,"name",t[1]),r&8&&g(e,"placeholder",t[3]),r&1&&g(e,"value",t[0])},i:X,o:X,d(t){t&&h(e),o=!1,ue(n)}}}function _e(a,e,o){let{name:n=""}=e,{type:t="text"}=e,{placeholder:r=""}=e,{value:u}=e;function v(i){o(0,u=i.target.value)}function l(){}return a.$$set=i=>{"name"in i&&o(1,n=i.name),"type"in i&&o(2,t=i.type),"placeholder"in i&&o(3,r=i.placeholder),"value"in i&&o(0,u=i.value)},[u,n,t,r,v,l]}class ne extends re{constructor(e){super(),ie(this,e,_e,fe,oe,{name:1,type:2,placeholder:3,value:0})}}function he(a){let e,o,n='<ion-col></ion-col> <ion-col class="w-80 text-center svelte-19nd3yu"><img src="/rutaflow.png" alt="Rutaflow" class="svelte-19nd3yu"/></ion-col> <ion-col></ion-col>',t,r,u,v,l,i,y,c,m,p,N,w,M,q,S,F='<ion-col class="signup-col"><ion-button class="submit-btn svelte-19nd3yu" color="#2c83d3" expand="block" type="submit">Ingresar</ion-button></ion-col>',T,D,J;function se(s){a[3](s)}let U={type:"text",placeholder:"Correo o Usuario",name:"email",required:!0};a[0].email!==void 0&&(U.value=a[0].email),c=new ne({props:U}),Y.push(()=>ee(c,"value",se));function le(s){a[4](s)}let z={type:"password",placeholder:"Contraseña",name:"password",required:!0};return a[0].password!==void 0&&(z.value=a[0].password),w=new ne({props:z}),Y.push(()=>ee(w,"value",le)),{c(){e=f("ion-content"),o=f("ion-row"),o.innerHTML=n,t=L(),r=f("div"),u=f("form"),v=f("ion-row"),l=f("ion-col"),i=f("ion-list"),y=f("ion-item"),P(c.$$.fragment),p=L(),N=f("ion-item"),P(w.$$.fragment),q=L(),S=f("ion-row"),S.innerHTML=F,this.h()},l(s){e=_(s,"ION-CONTENT",{class:!0,padding:!0});var b=I(e);o=_(b,"ION-ROW",{class:!0,"data-svelte-h":!0}),Z(o)!=="svelte-1mi73el"&&(o.innerHTML=n),t=R(b),r=_(b,"DIV",{class:!0});var C=I(r);u=_(C,"FORM",{});var O=I(u);v=_(O,"ION-ROW",{});var G=I(v);l=_(G,"ION-COL",{});var V=I(l);i=_(V,"ION-LIST",{});var $=I(i);y=_($,"ION-ITEM",{});var K=I(y);j(c.$$.fragment,K),K.forEach(h),p=R($),N=_($,"ION-ITEM",{});var Q=I(N);j(w.$$.fragment,Q),Q.forEach(h),$.forEach(h),V.forEach(h),G.forEach(h),q=R(O),S=_(O,"ION-ROW",{"data-svelte-h":!0}),Z(S)!=="svelte-19dro8s"&&(S.innerHTML=F),O.forEach(h),C.forEach(h),b.forEach(h),this.h()},h(){g(o,"class","logo-row svelte-19nd3yu"),de(r,"class","login-box svelte-19nd3yu"),g(e,"class","login-content"),g(e,"padding","")},m(s,b){ae(s,e,b),d(e,o),d(e,t),d(e,r),d(r,u),d(u,v),d(v,l),d(l,i),d(i,y),k(c,y,null),d(i,p),d(i,N),k(w,N,null),d(u,q),d(u,S),T=!0,D||(J=H(u,"submit",a[1]),D=!0)},p(s,b){const C={};!m&&b&1&&(m=!0,C.value=s[0].email,x(()=>m=!1)),c.$set(C);const O={};!M&&b&1&&(M=!0,O.value=s[0].password,x(()=>M=!1)),w.$set(O)},i(s){T||(A(c.$$.fragment,s),A(w.$$.fragment,s),T=!0)},o(s){W(c.$$.fragment,s),W(w.$$.fragment,s),T=!1},d(s){s&&h(e),B(c),B(w),D=!1,J()}}}function ge(a){let e,o;return e=new me({props:{$$slots:{default:[he]},$$scope:{ctx:a}}}),{c(){P(e.$$.fragment)},l(n){j(e.$$.fragment,n)},m(n,t){k(e,n,t),o=!0},p(n,[t]){const r={};t&33&&(r.$$scope={dirty:t,ctx:n}),e.$set(r)},i(n){o||(A(e.$$.fragment,n),o=!0)},o(n){W(e.$$.fragment,n),o=!1},d(n){B(e,n)}}}function ve(a,e,o){let n={},t=new Object;ce(()=>{localStorage.clear(),console.log("Cleared all sessions from localStorage")});const r=l=>{l.preventDefault(),console.log("submit",n);const i=async()=>{await(await te.create({header:"Datos inválidos",message:"El correo o la contraseña son incorrectos, vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()},y=async()=>{await(await te.create({header:"Sin perfil de operador",message:"Su cuenta no cuenta con un perfil de operador creado",buttons:[{text:"Cerrar"}]})).present()},c=new FormData;return c.append("email",n.email),c.append("pass",n.password),fetch("https://dev.rutaflow.com/api/admin/user/user_login.php",{method:"POST",body:c}).then(m=>m.json()).then(m=>{if(m.nodos.length){const p=m.nodos[0];localStorage.setItem("userSession",JSON.stringify(p)),pe.set({resolved:!0,id:p.id_driver?p.id_driver:"me",user:{userData:p}}),console.log(p),p.id_driver?E(`/drivers/${p.id_driver}`):(E("/drivers/me"),y())}else i()}).catch(m=>{i()})};function u(l){a.$$.not_equal(n.email,l)&&(n.email=l,o(0,n))}function v(l){a.$$.not_equal(n.password,l)&&(n.password=l,o(0,n))}return a.$$.update=()=>{a.$$.dirty&4&&(o(2,t=JSON.parse(localStorage.getItem("userSession"))),t?t.id_user&&(t.type=="admin"||t.type=="superadmin")?E("/drivers/me"):t.id_user&&t.id_driver&&E(`/drivers/${t.id_driver}`):E("/"))},[n,r,t,u,v]}class Ne extends re{constructor(e){super(),ie(this,e,ve,ge,oe,{})}}export{Ne as component};

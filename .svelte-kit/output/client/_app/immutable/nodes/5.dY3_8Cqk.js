import{Z as Ct,s as ot,e as c,j as N,b as u,q as b,d as Z,h as a,m as T,v as p,i as U,w as l,x as oe,n as Oe,z as We,_ as dn,B as q,o as st,k as He,$ as yt,t as ce,r as ue,f as Y,a0 as hn,a1 as at,A as ze,y as Pe,a2 as vt,l as pn,p as mn,F as vn}from"../chunks/index.BYLndrM5.js";import{S as lt,i as it,t as mt,a as kt,c as gn,b as bn,d as En,m as In,e as kn,g as On}from"../chunks/index.BNHbygFo.js";import{e as Ke,u as ct,d as ut,a as Nn,c as Ot,b as Tn,f as Cn,g as sn,h as yn,i as wn,j as cn,k as Ln,m as un,s as wt,n as rt,o as Sn,q as Pn,r as Mn,t as An,v as Bn,p as Dn}from"../chunks/index.BI6WKpRJ.js";import"../chunks/index-48209844.IIRtDZyg.js";import{m as ft,a as Je,I as zn}from"../chunks/IonPage.KvUD72q2.js";import{q as Hn,t as Rn}from"../chunks/ion-modal.CsJaVgKZ.js";import{g as Ye}from"../chunks/entry.Cz4PnlvI.js";const Un=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global,Fn=(i,e)=>{if(!customElements.get(i)){class t extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const n={};for(const r of this.attributes)n[r.name]=r.value;new e({target:this.shadowRoot,props:n})}}customElements.define(i,t)}},qn=function(i){return document.createElement(i).constructor!==HTMLElement},jn=(i,e)=>{qn(i)||Fn(i,e)},Xe=async(i,e,t)=>{Hn(),Rn(),jn(i,e);const o=await ft.create({component:i,componentProps:t});return o.present(),await o.onWillDismiss()};let et=Ct({km_inicial:[],gas_inicial:[],km_final:[],gas_final:[]}),fn=Ct({flag:[]});function Vn(i){let e,t,o,n,r="Cancelar",h,_,E="Captura de Km/Gas",O,k,f,s="Confirmar",g,d,m,v,w,y,z;return{c(){e=c("ion-header"),t=c("ion-toolbar"),o=c("ion-buttons"),n=c("ion-button"),n.textContent=r,h=N(),_=c("ion-title"),_.textContent=E,O=N(),k=c("ion-buttons"),f=c("ion-button"),f.textContent=s,g=N(),d=c("ion-content"),m=c("ion-item"),v=c("ion-input"),this.h()},l(M){e=u(M,"ION-HEADER",{translucent:!0});var H=b(e);t=u(H,"ION-TOOLBAR",{});var C=b(t);o=u(C,"ION-BUTTONS",{slot:!0});var L=b(o);n=u(L,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),Z(n)!=="svelte-17pq4f4"&&(n.textContent=r),L.forEach(a),h=T(C),_=u(C,"ION-TITLE",{"data-svelte-h":!0}),Z(_)!=="svelte-1yhkaq7"&&(_.textContent=E),O=T(C),k=u(C,"ION-BUTTONS",{slot:!0});var S=b(k);f=u(S,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),Z(f)!=="svelte-cm6j4s"&&(f.textContent=s),S.forEach(a),C.forEach(a),H.forEach(a),g=T(M),d=u(M,"ION-CONTENT",{fullscreen:!0});var I=b(d);m=u(I,"ION-ITEM",{});var B=b(m);v=u(B,"ION-INPUT",{class:!0,inputmode:!0,pattern:!0,type:!0,placeholder:!0,value:!0,required:!0});var R=b(v);R.forEach(a),B.forEach(a),I.forEach(a),this.h()},h(){p(n,"color","medium"),p(o,"slot","start"),p(f,"strong",""),p(k,"slot","end"),p(e,"translucent",""),p(v,"class","fin-km"),p(v,"inputmode","numeric"),p(v,"pattern","[0-9]*"),p(v,"type","number"),p(v,"placeholder",w="Ingresa "+i[0]+" actual"),p(v,"value",i[1]),p(v,"required",""),p(d,"fullscreen","")},m(M,H){U(M,e,H),l(e,t),l(t,o),l(o,n),l(t,h),l(t,_),l(t,O),l(t,k),l(k,f),U(M,g,H),U(M,d,H),l(d,m),l(m,v),y||(z=[oe(n,"click",i[2]),oe(f,"click",i[3]),oe(v,"input",i[4])],y=!0)},p(M,[H]){H&1&&w!==(w="Ingresa "+M[0]+" actual")&&p(v,"placeholder",w),H&2&&p(v,"value",M[1])},i:Oe,o:Oe,d(M){M&&(a(e),a(g),a(d)),y=!1,We(z)}}}function Gn(i,e,t){const o=dn();let n=document.querySelector("ion-modal"),r=n.componentProps.data_type;n.componentProps.isLast;let h;fn.subscribe(f=>{r=f.flag[0],r=="km_final"||r=="km_inicial"?t(0,h="kilometraje"):t(0,h="litros de gasolina")});let _=0;function E(){ft.dismiss()}function O(){o("modalResult",{data:"Your data",role:"confirm"}),r=="km_inicial"?et.update(s=>({...s,km_inicial:[_]})):r=="gas_inicial"?et.update(s=>({...s,gas_inicial:[_]})):r=="km_final"?et.update(s=>({...s,km_final:[_]})):r=="gas_final"&&et.update(s=>({...s,gas_final:[_]})),E()}return[h,_,E,O,f=>t(1,_=f.target.value)]}class Kn extends lt{constructor(e){super(),it(this,e,Gn,Vn,ot,{})}}const Et=Ct({items:[],checkedIndices:[],mandatory:[]});function zt(i,e,t){const o=i.slice();return o[51]=e[t],o[52]=e,o[53]=t,o}function Wn(i){let e,t,o,n,r,h="Kilometraje inicial",_,E,O=i[0]?i[0]+" km.":"Cargar km",k,f,s,g,d,m,v,w="Gasolina inicial (litros)",y,z,M=i[1]?i[1]+" litros":"Cargar gas",H,C,L,S;return C=yt(i[21][0]),{c(){e=c("ion-item"),t=c("ion-label"),o=c("input"),n=N(),r=c("p"),r.textContent=h,_=N(),E=c("ion-button"),k=ce(O),f=N(),s=c("ion-item"),g=c("ion-label"),d=c("input"),m=N(),v=c("p"),v.textContent=w,y=N(),z=c("ion-button"),H=ce(M),this.h()},l(I){e=u(I,"ION-ITEM",{});var B=b(e);t=u(B,"ION-LABEL",{style:!0});var R=b(t);o=u(R,"INPUT",{id:!0,style:!0,type:!0}),n=T(R),r=u(R,"P",{style:!0,"data-svelte-h":!0}),Z(r)!=="svelte-88twxi"&&(r.textContent=h),R.forEach(a),_=T(B),E=u(B,"ION-BUTTON",{fill:!0,size:!0,class:!0,"aria-selected":!0});var P=b(E);k=ue(P,O),P.forEach(a),B.forEach(a),f=T(I),s=u(I,"ION-ITEM",{});var V=b(s);g=u(V,"ION-LABEL",{style:!0});var G=b(g);d=u(G,"INPUT",{id:!0,style:!0,type:!0}),m=T(G),v=u(G,"P",{style:!0,"data-svelte-h":!0}),Z(v)!=="svelte-1ux30eb"&&(v.textContent=w),G.forEach(a),y=T(V),z=u(V,"ION-BUTTON",{fill:!0,class:!0,size:!0,style:!0});var J=b(z);H=ue(J,M),J.forEach(a),V.forEach(a),this.h()},h(){Y(o,"id","chkbox-km-ini"),q(o,"pointer-events","auto"),Y(o,"type","checkbox"),o.required=!0,q(r,"margin-left","10px"),q(t,"display","flex"),p(E,"fill","outline"),p(E,"size","small"),p(E,"class","loadKmInicial"),p(E,"aria-selected",""),Y(d,"id","chkbox-gas-ini"),q(d,"pointer-events","auto"),Y(d,"type","checkbox"),d.required=!0,q(v,"margin-left","10px"),q(g,"display","flex"),p(z,"fill","outline"),p(z,"class","loadGasInicial"),p(z,"size","small"),q(z,"height","16px "),C.p(o,d)},m(I,B){U(I,e,B),l(e,t),l(t,o),o.checked=~(i[4]||[]).indexOf(o.__value),i[28](o),l(t,n),l(t,r),l(e,_),l(e,E),l(E,k),U(I,f,B),U(I,s,B),l(s,g),l(g,d),i[30](d),d.checked=~(i[4]||[]).indexOf(d.__value),l(g,m),l(g,v),l(s,y),l(s,z),l(z,H),L||(S=[oe(o,"change",i[27]),oe(E,"click",i[29]),oe(d,"change",i[31]),oe(z,"click",i[32])],L=!0)},p(I,B){B[0]&16&&(o.checked=~(I[4]||[]).indexOf(o.__value)),B[0]&1&&O!==(O=I[0]?I[0]+" km.":"Cargar km")&&Pe(k,O),B[0]&16&&(d.checked=~(I[4]||[]).indexOf(d.__value)),B[0]&2&&M!==(M=I[1]?I[1]+" litros":"Cargar gas")&&Pe(H,M)},d(I){I&&(a(e),a(f),a(s)),i[28](null),i[30](null),C.r(),L=!1,We(S)}}}function Xn(i){let e,t,o,n,r,h="Kilometraje final",_,E,O=i[2]?i[2]+" km.":"Cargar km",k,f,s,g,d,m,v,w="Gasolina final (litros)",y,z,M=i[3]?i[3]+" litros":"Cargar gas",H,C,L,S;return C=yt(i[21][0]),{c(){e=c("ion-item"),t=c("ion-label"),o=c("input"),n=N(),r=c("p"),r.textContent=h,_=N(),E=c("ion-button"),k=ce(O),f=N(),s=c("ion-item"),g=c("ion-label"),d=c("input"),m=N(),v=c("p"),v.textContent=w,y=N(),z=c("ion-button"),H=ce(M),this.h()},l(I){e=u(I,"ION-ITEM",{});var B=b(e);t=u(B,"ION-LABEL",{style:!0});var R=b(t);o=u(R,"INPUT",{id:!0,style:!0,type:!0}),n=T(R),r=u(R,"P",{style:!0,"data-svelte-h":!0}),Z(r)!=="svelte-ccmu71"&&(r.textContent=h),R.forEach(a),_=T(B),E=u(B,"ION-BUTTON",{fill:!0,size:!0,class:!0,"aria-selected":!0});var P=b(E);k=ue(P,O),P.forEach(a),B.forEach(a),f=T(I),s=u(I,"ION-ITEM",{});var V=b(s);g=u(V,"ION-LABEL",{style:!0});var G=b(g);d=u(G,"INPUT",{id:!0,style:!0,type:!0}),m=T(G),v=u(G,"P",{style:!0,"data-svelte-h":!0}),Z(v)!=="svelte-wsoyd2"&&(v.textContent=w),G.forEach(a),y=T(V),z=u(V,"ION-BUTTON",{fill:!0,size:!0,class:!0});var J=b(z);H=ue(J,M),J.forEach(a),V.forEach(a),this.h()},h(){Y(o,"id","chkbox-km-fin"),q(o,"pointer-events","auto"),Y(o,"type","checkbox"),o.required=!0,q(r,"margin-left","10px"),q(t,"display","flex"),p(E,"fill","outline"),p(E,"size","small"),p(E,"class","loadKmInicial"),p(E,"aria-selected",""),Y(d,"id","chkbox-gas-fin"),q(d,"pointer-events","auto"),Y(d,"type","checkbox"),d.required=!0,q(v,"margin-left","10px"),q(g,"display","flex"),p(z,"fill","outline"),p(z,"size","small"),p(z,"class","loadGasInicial"),C.p(o,d)},m(I,B){U(I,e,B),l(e,t),l(t,o),o.checked=~(i[4]||[]).indexOf(o.__value),i[22](o),l(t,n),l(t,r),l(e,_),l(e,E),l(E,k),U(I,f,B),U(I,s,B),l(s,g),l(g,d),d.checked=~(i[4]||[]).indexOf(d.__value),i[25](d),l(g,m),l(g,v),l(s,y),l(s,z),l(z,H),L||(S=[oe(o,"change",i[20]),oe(E,"click",i[23]),oe(d,"change",i[24]),oe(z,"click",i[26])],L=!0)},p(I,B){B[0]&16&&(o.checked=~(I[4]||[]).indexOf(o.__value)),B[0]&4&&O!==(O=I[2]?I[2]+" km.":"Cargar km")&&Pe(k,O),B[0]&16&&(d.checked=~(I[4]||[]).indexOf(d.__value)),B[0]&8&&M!==(M=I[3]?I[3]+" litros":"Cargar gas")&&Pe(H,M)},d(I){I&&(a(e),a(f),a(s)),i[22](null),i[25](null),C.r(),L=!1,We(S)}}}function Jn(i){let e=[],t=new Map,o,n=Ke(i[13]);const r=h=>h[51].id_checklist_event;for(let h=0;h<n.length;h+=1){let _=zt(i,n,h),E=r(_);t.set(E,e[h]=Ht(E,_))}return{c(){for(let h=0;h<e.length;h+=1)e[h].c();o=He()},l(h){for(let _=0;_<e.length;_+=1)e[_].l(h);o=He()},m(h,_){for(let E=0;E<e.length;E+=1)e[E]&&e[E].m(h,_);U(h,o,_)},p(h,_){_[0]&407664&&(n=Ke(h[13]),e=ct(e,_,r,1,h,n,t,o.parentNode,ut,Ht,o,zt))},d(h){h&&a(o);for(let _=0;_<e.length;_+=1)e[_].d(h)}}}function Qn(i){let e,t=(i[12][i[51].id_checklist_event]?i[12][i[51].id_checklist_event]:"Cargar evidencia")+"",o;return{c(){e=c("label"),o=ce(t),this.h()},l(n){e=u(n,"LABEL",{for:!0,class:!0});var r=b(e);o=ue(r,t),r.forEach(a),this.h()},h(){Y(e,"for","chklist-"+i[51].id_checklist_event),Y(e,"class","button-label svelte-1ruehls")},m(n,r){U(n,e,r),l(e,o)},p(n,r){r[0]&4096&&t!==(t=(n[12][n[51].id_checklist_event]?n[12][n[51].id_checklist_event]:"Cargar evidencia")+"")&&Pe(o,t)},d(n){n&&a(e)}}}function Yn(i){let e;return{c(){e=c("ion-spinner"),this.h()},l(t){e=u(t,"ION-SPINNER",{name:!0,class:!0}),b(e).forEach(a),this.h()},h(){p(e,"name","dots"),p(e,"class","button-spinner svelte-1ruehls")},m(t,o){U(t,e,o)},p:Oe,d(t){t&&a(e)}}}function Ht(i,e){let t,o,n,r=e[51],h,_,E=e[51].item+"",O,k,f,s=e[51].mandatory=="1"?" * ":"",g,d,m,v,w,y,z,M,H,C;const L=()=>e[34](n,r),S=()=>e[34](null,r);function I(){return e[35](e[51])}function B(G,J){return G[11][G[51].id_checklist_event]?Yn:Qn}let R=B(e),P=R(e);function V(...G){return e[37](e[51],...G)}return M=yt(e[21][0]),{key:i,first:null,c(){t=c("ion-item"),o=c("ion-label"),n=c("input"),h=N(),_=c("p"),O=ce(E),k=N(),f=c("b"),g=ce(s),d=N(),m=c("ion-button"),v=c("div"),P.c(),w=N(),y=c("input"),z=N(),this.h()},l(G){t=u(G,"ION-ITEM",{});var J=b(t);o=u(J,"ION-LABEL",{style:!0});var x=b(o);n=u(x,"INPUT",{id:!0,style:!0,type:!0}),h=T(x),_=u(x,"P",{style:!0});var ge=b(_);O=ue(ge,E),k=T(ge),ge.forEach(a),f=u(x,"B",{style:!0});var j=b(f);g=ue(j,s),j.forEach(a),x.forEach(a),d=T(J),m=u(J,"ION-BUTTON",{fill:!0,class:!0,size:!0});var Q=b(m);v=u(Q,"DIV",{class:!0});var X=b(v);P.l(X),w=T(X),y=u(X,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0}),X.forEach(a),Q.forEach(a),z=T(J),J.forEach(a),this.h()},h(){Y(n,"id",`chkbox-${e[51].id_checklist_event}`),q(n,"pointer-events","auto"),Y(n,"type","checkbox"),n.__value=e[51].id_checklist_event,hn(n,n.__value),n.required=!0,q(_,"margin-left","10px"),q(f,"margin-left","5px"),q(o,"display","flex"),q(y,"display","none"),Y(y,"id","chklist-"+e[51].id_checklist_event),Y(y,"name","fileToUpload"),Y(y,"type","file"),Y(y,"accept","image/*"),Y(v,"class","button-content svelte-1ruehls"),p(m,"fill","outline"),p(m,"class","loadEvidence svelte-1ruehls"),p(m,"size","small"),M.p(n),this.first=t},m(G,J){U(G,t,J),l(t,o),l(o,n),n.checked=~(e[4]||[]).indexOf(n.__value),L(),l(o,h),l(o,_),l(_,O),l(_,k),l(o,f),l(f,g),l(t,d),l(t,m),l(m,v),P.m(v,null),l(v,w),l(v,y),e[36](y),l(t,z),H||(C=[oe(n,"change",e[33]),oe(n,"change",I),oe(y,"change",V)],H=!0)},p(G,J){e=G,J[0]&16&&(n.checked=~(e[4]||[]).indexOf(n.__value)),r!==e[51]&&(S(),r=e[51],L()),R===(R=B(e))&&P?P.p(e,J):(P.d(1),P=R(e),P&&(P.c(),P.m(v,w)))},d(G){G&&a(t),S(),P.d(),e[36](null),M.r(),H=!1,We(C)}}}function Zn(i){let e,t,o,n,r="Cancelar",h,_,E="REQUERIMIENTOS DE RUTA",O,k,f,s,g,d,m,v="Confirmar",w,y;function z(L,S){return L[14]?Xn:Wn}let H=z(i)(i),C=i[13]&&Jn(i);return{c(){e=c("ion-header"),t=c("ion-toolbar"),o=c("ion-buttons"),n=c("ion-button"),n.textContent=r,h=N(),_=c("ion-title"),_.textContent=E,O=N(),k=c("ion-content"),f=c("ion-list"),H.c(),s=N(),C&&C.c(),g=N(),d=c("ion-footer"),m=c("ion-button"),m.textContent=v,this.h()},l(L){e=u(L,"ION-HEADER",{translucent:!0});var S=b(e);t=u(S,"ION-TOOLBAR",{});var I=b(t);o=u(I,"ION-BUTTONS",{slot:!0});var B=b(o);n=u(B,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),Z(n)!=="svelte-1dnmkxs"&&(n.textContent=r),B.forEach(a),h=T(I),_=u(I,"ION-TITLE",{"data-svelte-h":!0}),Z(_)!=="svelte-19bar5p"&&(_.textContent=E),I.forEach(a),S.forEach(a),O=T(L),k=u(L,"ION-CONTENT",{fullscreen:!0});var R=b(k);f=u(R,"ION-LIST",{});var P=b(f);H.l(P),s=T(P),C&&C.l(P),P.forEach(a),R.forEach(a),g=T(L),d=u(L,"ION-FOOTER",{});var V=b(d);m=u(V,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),Z(m)!=="svelte-g82qqw"&&(m.textContent=v),V.forEach(a),this.h()},h(){p(n,"color","medium"),p(o,"slot","start"),p(e,"translucent",""),p(k,"fullscreen",""),p(m,"fill","outline"),p(m,"color","tertiary"),p(m,"strong",""),q(m,"width","99%"),q(m,"height","auto")},m(L,S){U(L,e,S),l(e,t),l(t,o),l(o,n),l(t,h),l(t,_),U(L,O,S),U(L,k,S),l(k,f),H.m(f,null),l(f,s),C&&C.m(f,null),U(L,g,S),U(L,d,S),l(d,m),w||(y=[oe(n,"click",i[15]),oe(m,"click",i[16])],w=!0)},p(L,S){H.p(L,S),L[13]&&C.p(L,S)},i:Oe,o:Oe,d(L){L&&(a(e),a(O),a(k),a(g),a(d)),H.d(),C&&C.d(),w=!1,We(y)}}}function Nt(i,e){if(typeof i=="object"&&i!==null||Array.isArray(i)){if(Array.isArray(i))return i.map(t=>Nt(t,e)).flat();{const t=Object.keys(i);let o;return e=="id_checklist_event"?o=t.filter(r=>r.toLowerCase().includes("id_checklist_event")).map(r=>i[r]):e=="mandatory"?o=t.filter(r=>r.toLowerCase().includes("mandatory")).map(r=>i[r]):(console.error("Tipo de dato no reconocido."),o=!1),o}}else return console.error("Invalid input. Please provide a valid object or array."),[]}function It(i,e){let t=new FormData;t.append("id_route",i),t.append("status",e),fetch("https://dev.rutaflow.com/api/admin/route/change_status.php",{method:"POST",body:t}).then(o=>o.json()).then(o=>{}).catch(o=>{console.error("Error fetching data:",o)})}function xn(i,e,t){let o=document.querySelector("ion-modal");const n=o.componentProps.checklist,r=o.componentProps.driverId,h=o.componentProps.routeId,_=o.componentProps.isLast;let E,O,k,f,s=[],g=null,d={},m,v,w,y,z={},M={},H={};st(()=>{_?console.log("Último checklist"):Et.update(D=>(D.mandatory=Nt(n,"mandatory"),D.items=Nt(n,"id_checklist_event"),D))});function C(D){t(11,z[D]=!0,z)}const L=async()=>{await(await Je.create({header:"Datos o checklist incompletos",message:"Carga la evidencia requerida y marca todas las casillas para confirmar",buttons:[{text:"Cerrar"}]})).present()},S=async()=>{await(await Je.create({header:"Datos capturados",message:"El kilometraje y gasolina final fueron registrados correctamente, espere aprobación para finalizar ruta",buttons:[{text:"Cerrar"}]})).present()},I=async D=>{await(await Je.create({header:"Datos inválidos",message:D=="km"?"Llena correctamente el campo de kilometraje inicial":"Llena correctamente el campo de gasolina inicial",buttons:[{text:"Cerrar"}]})).present()},B=()=>{ft.dismiss(),r?Ye(`/drivers/${r}`):Ye("/drivers/me")},R=()=>{if(_){var D=J(k,"km"),K=J(f,"gas");const pe=new FormData;pe.append("km_final",D),pe.append("gas_final",K),pe.append("id_route",h),D&&K?(B(),fetch("https://dev.rutaflow.com/api/admin/checklist/add_evidence.php",{method:"POST",body:pe}).then($=>$.json()).then($=>{S()}).catch($=>{console.error("Error fetching data:",$)})):L()}else{var fe=J(E,"km"),Ee=J(O,"gas");Et.update(pe=>{pe.items;const $=pe.mandatory;if(pe.items.filter((se,me)=>pe.mandatory[me]==="1").every(se=>pe.checkedIndices.includes(se))&&fe&&Ee){B();const se=new FormData;for(const me in M)if(M.hasOwnProperty(me)){const{img:Ue,img_id:Te}=M[me];se.append(`selectedImages[${me}][img]`,Ue),se.append(`selectedImages[${me}][img_id]`,Te)}se.append("km_inicial",fe),se.append("gas_inicial",Ee),se.append("id_route",h),fetch("https://dev.rutaflow.com/api/admin/checklist/add_evidence.php",{method:"POST",body:se}).then(me=>me.json()).then(me=>{$&&$.some(Ue=>Ue==="1")?It(h,"checklist-pending"):It(h,"enroute")}).catch(me=>{console.error("Error fetching data:",me)})}else if(!$&&fe&&Ee){var de=new FormData;de.append("km_inicial",fe),de.append("gas_inicial",Ee),fetch("https://dev.rutaflow.com/api/admin/checklist/add_evidence.php",{method:"POST",body:de}).then(se=>se.json()).then(se=>{It(h,"enroute")}).catch(se=>{console.error("Error fetching data:",se)})}else L();return pe})}Q()},P=async(D,K)=>{C(K);const Ee=D.target.files[0],pe=await V(Ee);if(pe){const $=new FormData;$.append("fileToUpload",pe);try{const _e=await fetch("https://dev.rutaflow.com/api/admin/manager/upload_img_driver.php",{method:"POST",body:$});if(_e.ok){const ae=await _e.json();M={...M,[K]:{img:ae.img,img_id:ae.img_id}},t(12,H={...H,[K]:ae.filename}),G(K),t(6,d[K].checked=!0,d),t(11,z[K]=!1,z)}else console.error("File upload failed:",_e.statusText)}catch(_e){console.error("Error during file upload:",_e)}}},V=async D=>new Promise(K=>{const fe=new FileReader;fe.onload=Ee=>{const pe=new Image;pe.src=Ee.target.result,pe.onload=()=>{const $=document.createElement("canvas"),_e=$.getContext("2d"),ae=800,de=600;let se=pe.width,me=pe.height;se>ae&&(me*=ae/se,se=ae),me>de&&(se*=de/me,me=de),$.width=se,$.height=me,_e.drawImage(pe,0,0,se,me),$.toBlob(Ue=>{K(Ue)},"image/jpeg",.7)}},fe.readAsDataURL(D)}),G=D=>{Et.update(K=>(K.checkedIndices.indexOf(D)===-1?K.checkedIndices.push(D):console.error(`ID ${D} is already checked.`),K.items.forEach(Ee=>{Ee.id_checklist_event===D&&(Ee.checked=!0)}),K))};function J(D,K){return/^\d+$/.test(D)?parseInt(D,10):(I(K),null)}function x(D,K){ge(K),o.componentProps.data_type=K,Xe("modal-gas-km",Kn,{r:K}).then(()=>{et.subscribe(fe=>{j(fe,K)})})}function ge(D){fn.update(K=>({...K,flag:[D]}))}function j(D,K){t(0,E=D.km_inicial?D.km_inicial:null),t(1,O=D.gas_inicial?D.gas_inicial:null),t(2,k=D.km_final?D.km_final:null),t(3,f=D.gas_final?D.gas_final:null),K=="km_inicial"&&m&&t(7,m.checked=!0,m),K=="gas_inicial"&&v&&t(8,v.checked=!0,v),K=="km_final"&&w&&t(9,w.checked=!0,w),K=="gas_final"&&y&&t(10,y.checked=!0,y)}function Q(){et.set({km_inicial:[],gas_inicial:[],km_final:[],gas_final:[]})}const X=[[]];function A(){s=at(X[0],this.__value,this.checked),t(4,s)}function F(D){ze[D?"unshift":"push"](()=>{w=D,t(9,w)})}const W=D=>x(D,"km_final");function ee(){s=at(X[0],this.__value,this.checked),t(4,s)}function te(D){ze[D?"unshift":"push"](()=>{y=D,t(10,y)})}const le=D=>x(D,"gas_final");function ne(){s=at(X[0],this.__value,this.checked),t(4,s)}function ie(D){ze[D?"unshift":"push"](()=>{m=D,t(7,m)})}const he=D=>x(D,"km_inicial");function Ie(D){ze[D?"unshift":"push"](()=>{v=D,t(8,v)})}function Ne(){s=at(X[0],this.__value,this.checked),t(4,s)}const Me=D=>x(D,"gas_inicial");function be(){s=at(X[0],this.__value,this.checked),t(4,s)}function Re(D,K){ze[D?"unshift":"push"](()=>{d[K.id_checklist_event]=D,t(6,d)})}const Ge=D=>G(D.id_checklist_event);function je(D){ze[D?"unshift":"push"](()=>{g=D,t(5,g)})}return[E,O,k,f,s,g,d,m,v,w,y,z,H,n,_,B,R,P,G,x,A,X,F,W,ee,te,le,ne,ie,he,Ie,Ne,Me,be,Re,Ge,je,(D,K)=>P(K,D.id_checklist_event)]}class _n extends lt{constructor(e){super(),it(this,e,xn,Zn,ot,{},null,[-1,-1])}}function $n(i){let e,t,o,n,r,h="Teléfono de Negocio",_,E,O=i[8].client_phone+"",k;return{c(){e=c("ion-item"),t=c("ion-icon"),o=N(),n=c("ion-label"),r=c("p"),r.textContent=h,_=N(),E=c("h2"),k=ce(O),this.h()},l(f){e=u(f,"ION-ITEM",{href:!0});var s=b(e);t=u(s,"ION-ICON",{icon:!0,slot:!0}),b(t).forEach(a),o=T(s),n=u(s,"ION-LABEL",{class:!0});var g=b(n);r=u(g,"P",{"data-svelte-h":!0}),Z(r)!=="svelte-1u5l7fz"&&(r.textContent=h),_=T(g),E=u(g,"H2",{});var d=b(E);k=ue(d,O),d.forEach(a),g.forEach(a),s.forEach(a),this.h()},h(){p(t,"icon",yn),p(t,"slot","start"),p(n,"class","ion-text-wrap"),p(e,"href","tel:"+i[8].client_phone)},m(f,s){U(f,e,s),l(e,t),l(e,o),l(e,n),l(n,r),l(n,_),l(n,E),l(E,k)},p:Oe,d(f){f&&a(e)}}}function eo(i){let e,t,o,n,r,h="Domicilio Alternativo",_,E,O=i[8].line2+"",k,f,s;return{c(){e=c("ion-item"),t=c("ion-icon"),o=N(),n=c("ion-label"),r=c("p"),r.textContent=h,_=N(),E=c("h2"),k=ce(O),f=N(),s=c("ion-icon"),this.h()},l(g){e=u(g,"ION-ITEM",{href:!0});var d=b(e);t=u(d,"ION-ICON",{icon:!0,slot:!0}),b(t).forEach(a),o=T(d),n=u(d,"ION-LABEL",{class:!0});var m=b(n);r=u(m,"P",{"data-svelte-h":!0}),Z(r)!=="svelte-1ub9uzw"&&(r.textContent=h),_=T(m),E=u(m,"H2",{});var v=b(E);k=ue(v,O),v.forEach(a),m.forEach(a),f=T(d),s=u(d,"ION-ICON",{icon:!0,slot:!0}),b(s).forEach(a),d.forEach(a),this.h()},h(){p(t,"icon",wt),p(t,"slot","start"),p(n,"class","ion-text-wrap"),p(s,"icon",rt),p(s,"slot","end"),p(e,"href","https://www.google.com/maps/searhc/?api=1&query="+i[8].line2)},m(g,d){U(g,e,d),l(e,t),l(e,o),l(e,n),l(n,r),l(n,_),l(n,E),l(E,k),l(e,f),l(e,s)},p:Oe,d(g){g&&a(e)}}}function to(i){let e,t,o,n,r,h="Domicilio",_,E,O=i[8].line1+"",k,f,s,g,d=i[8].line2&&i[8].line2.trim().length,m,v=d&&no(i);return{c(){e=c("ion-item"),t=c("ion-icon"),o=N(),n=c("ion-label"),r=c("p"),r.textContent=h,_=N(),E=c("h2"),k=ce(O),f=N(),s=c("ion-icon"),g=N(),v&&v.c(),m=He(),this.h()},l(w){e=u(w,"ION-ITEM",{href:!0});var y=b(e);t=u(y,"ION-ICON",{icon:!0,slot:!0}),b(t).forEach(a),o=T(y),n=u(y,"ION-LABEL",{class:!0});var z=b(n);r=u(z,"P",{"data-svelte-h":!0}),Z(r)!=="svelte-cbm7q1"&&(r.textContent=h),_=T(z),E=u(z,"H2",{});var M=b(E);k=ue(M,O),M.forEach(a),z.forEach(a),f=T(y),s=u(y,"ION-ICON",{icon:!0,slot:!0}),b(s).forEach(a),y.forEach(a),g=T(w),v&&v.l(w),m=He(),this.h()},h(){p(t,"icon",wt),p(t,"slot","start"),p(n,"class","ion-text-wrap"),p(s,"icon",rt),p(s,"slot","end"),p(e,"href","https://www.google.com/maps/search/?api=1&query="+i[8].line1)},m(w,y){U(w,e,y),l(e,t),l(e,o),l(e,n),l(n,r),l(n,_),l(n,E),l(E,k),l(e,f),l(e,s),U(w,g,y),v&&v.m(w,y),U(w,m,y)},p(w,y){d&&v.p(w,y)},d(w){w&&(a(e),a(g),a(m)),v&&v.d(w)}}}function no(i){let e,t,o,n,r,h="Domicilio Alternativo",_,E,O=i[8].line2+"",k,f,s;return{c(){e=c("ion-item"),t=c("ion-icon"),o=N(),n=c("ion-label"),r=c("p"),r.textContent=h,_=N(),E=c("h2"),k=ce(O),f=N(),s=c("ion-icon"),this.h()},l(g){e=u(g,"ION-ITEM",{href:!0});var d=b(e);t=u(d,"ION-ICON",{icon:!0,slot:!0}),b(t).forEach(a),o=T(d),n=u(d,"ION-LABEL",{class:!0});var m=b(n);r=u(m,"P",{"data-svelte-h":!0}),Z(r)!=="svelte-1ub9uzw"&&(r.textContent=h),_=T(m),E=u(m,"H2",{});var v=b(E);k=ue(v,O),v.forEach(a),m.forEach(a),f=T(d),s=u(d,"ION-ICON",{icon:!0,slot:!0}),b(s).forEach(a),d.forEach(a),this.h()},h(){p(t,"icon",wt),p(t,"slot","start"),p(n,"class","ion-text-wrap"),p(s,"icon",rt),p(s,"slot","end"),p(e,"href","https://www.google.com/maps/search/?api=1&query="+i[8].line2)},m(g,d){U(g,e,d),l(e,t),l(e,o),l(e,n),l(n,r),l(n,_),l(n,E),l(E,k),l(e,f),l(e,s)},p:Oe,d(g){g&&a(e)}}}function Rt(i){let e,t,o,n,r,h="Contacto del Cliente",_,E,O,k,f=i[2]&&i[2]==="1"&&Ut(i);return{c(){e=c("ion-item"),t=c("ion-icon"),o=N(),n=c("ion-label"),r=c("p"),r.textContent=h,_=N(),E=c("h2"),O=ce(i[6]),k=N(),f&&f.c(),this.h()},l(s){e=u(s,"ION-ITEM",{});var g=b(e);t=u(g,"ION-ICON",{icon:!0,slot:!0}),b(t).forEach(a),o=T(g),n=u(g,"ION-LABEL",{class:!0});var d=b(n);r=u(d,"P",{"data-svelte-h":!0}),Z(r)!=="svelte-1utsyb6"&&(r.textContent=h),_=T(d),E=u(d,"H2",{});var m=b(E);O=ue(m,i[6]),m.forEach(a),d.forEach(a),k=T(g),f&&f.l(g),g.forEach(a),this.h()},h(){p(t,"icon",wn),p(t,"slot","start"),p(n,"class","ion-text-wrap")},m(s,g){U(s,e,g),l(e,t),l(e,o),l(e,n),l(n,r),l(n,_),l(n,E),l(E,O),l(e,k),f&&f.m(e,null)},p(s,g){g&64&&Pe(O,s[6]),s[2]&&s[2]==="1"?f?f.p(s,g):(f=Ut(s),f.c(),f.m(e,null)):f&&(f.d(1),f=null)},d(s){s&&a(e),f&&f.d()}}}function Ut(i){let e,t=`<ion-icon icon="${Sn}" slot="start"></ion-icon>
                        Notificar Cliente`,o,n;return{c(){e=c("ion-button"),e.innerHTML=t,this.h()},l(r){e=u(r,"ION-BUTTON",{fill:!0,style:!0,"data-svelte-h":!0}),Z(e)!=="svelte-w3qtwm"&&(e.innerHTML=t),this.h()},h(){p(e,"fill","outline"),q(e,"margin-left","16px")},m(r,h){U(r,e,h),o||(n=oe(e,"click",i[12]),o=!0)},p:Oe,d(r){r&&a(e),o=!1,n()}}}function Ft(i){let e,t,o,n,r,h="Notas de ubicación",_,E,O;return{c(){e=c("ion-item"),t=c("ion-icon"),o=N(),n=c("ion-label"),r=c("p"),r.textContent=h,_=N(),E=c("h2"),O=ce(i[7]),this.h()},l(k){e=u(k,"ION-ITEM",{});var f=b(e);t=u(f,"ION-ICON",{icon:!0,slot:!0}),b(t).forEach(a),o=T(f),n=u(f,"ION-LABEL",{class:!0});var s=b(n);r=u(s,"P",{"data-svelte-h":!0}),Z(r)!=="svelte-nhm2ft"&&(r.textContent=h),_=T(s),E=u(s,"H2",{});var g=b(E);O=ue(g,i[7]),g.forEach(a),s.forEach(a),f.forEach(a),this.h()},h(){p(t,"icon",cn),p(t,"slot","start"),p(n,"class","ion-text-wrap")},m(k,f){U(k,e,f),l(e,t),l(e,o),l(e,n),l(n,r),l(n,_),l(n,E),l(E,O)},p(k,f){f&128&&Pe(O,k[7])},d(k){k&&a(e)}}}function oo(i){let e,t,o,n,r,h="Horarios",_,E,O=i[8].schedule+"",k;return{c(){e=c("ion-item"),t=c("ion-icon"),o=N(),n=c("ion-label"),r=c("p"),r.textContent=h,_=N(),E=c("h2"),k=ce(O),this.h()},l(f){e=u(f,"ION-ITEM",{});var s=b(e);t=u(s,"ION-ICON",{icon:!0,slot:!0}),b(t).forEach(a),o=T(s),n=u(s,"ION-LABEL",{});var g=b(n);r=u(g,"P",{"data-svelte-h":!0}),Z(r)!=="svelte-11q7hm5"&&(r.textContent=h),_=T(g),E=u(g,"H2",{});var d=b(E);k=ue(d,O),d.forEach(a),g.forEach(a),s.forEach(a),this.h()},h(){p(t,"icon",Ln),p(t,"slot","start")},m(f,s){U(f,e,s),l(e,t),l(e,o),l(e,n),l(n,r),l(n,_),l(n,E),l(E,k)},p:Oe,d(f){f&&a(e)}}}function lo(i){let e,t,o,n,r,h="Notas del operador",_,E,O=i[8].driver_comments+"",k;return{c(){e=c("ion-item"),t=c("ion-icon"),o=N(),n=c("ion-label"),r=c("p"),r.textContent=h,_=N(),E=c("h2"),k=ce(O),this.h()},l(f){e=u(f,"ION-ITEM",{});var s=b(e);t=u(s,"ION-ICON",{icon:!0,slot:!0}),b(t).forEach(a),o=T(s),n=u(s,"ION-LABEL",{});var g=b(n);r=u(g,"P",{"data-svelte-h":!0}),Z(r)!=="svelte-1yk9qp4"&&(r.textContent=h),_=T(g),E=u(g,"H2",{});var d=b(E);k=ue(d,O),d.forEach(a),g.forEach(a),s.forEach(a),this.h()},h(){p(t,"icon",un),p(t,"slot","start")},m(f,s){U(f,e,s),l(e,t),l(e,o),l(e,n),l(n,r),l(n,_),l(n,E),l(E,k)},p:Oe,d(f){f&&a(e)}}}function io(i){let e,t=i[8].logistic_comments!="<br>"&&ro(i);return{c(){t&&t.c(),e=He()},l(o){t&&t.l(o),e=He()},m(o,n){t&&t.m(o,n),U(o,e,n)},p(o,n){o[8].logistic_comments!="<br>"&&t.p(o,n)},d(o){o&&a(e),t&&t.d(o)}}}function ro(i){let e,t,o,n,r,h="Comentarios logísticos",_,E,O=i[8].logistic_comments+"",k;return{c(){e=c("ion-item"),t=c("ion-icon"),o=N(),n=c("ion-label"),r=c("p"),r.textContent=h,_=N(),E=c("h2"),k=ce(O),this.h()},l(f){e=u(f,"ION-ITEM",{});var s=b(e);t=u(s,"ION-ICON",{icon:!0,slot:!0}),b(t).forEach(a),o=T(s),n=u(s,"ION-LABEL",{class:!0});var g=b(n);r=u(g,"P",{"data-svelte-h":!0}),Z(r)!=="svelte-1iz85r6"&&(r.textContent=h),_=T(g),E=u(g,"H2",{});var d=b(E);k=ue(d,O),d.forEach(a),g.forEach(a),s.forEach(a),this.h()},h(){p(t,"icon",cn),p(t,"slot","start"),p(n,"class","ion-text-wrap")},m(f,s){U(f,e,s),l(e,t),l(e,o),l(e,n),l(n,r),l(n,_),l(n,E),l(E,k)},p:Oe,d(f){f&&a(e)}}}function qt(i){let e;return{c(){e=c("ion-spinner"),this.h()},l(t){e=u(t,"ION-SPINNER",{name:!0}),b(e).forEach(a),this.h()},h(){p(e,"name","dots")},m(t,o){U(t,e,o)},d(t){t&&a(e)}}}function jt(i){let e,t,o;return{c(){e=c("section"),t=c("ion-img"),this.h()},l(n){e=u(n,"SECTION",{});var r=b(e);t=u(r,"ION-IMG",{src:!0,alt:!0,style:!0}),b(t).forEach(a),r.forEach(a),this.h()},h(){vt(t.src,o=i[1])||p(t,"src",o),p(t,"alt","Evidencia fotográfica"),q(t,"max-width","100%"),q(t,"margin-top","16px")},m(n,r){U(n,e,r),l(e,t)},p(n,r){r&2&&!vt(t.src,o=n[1])&&p(t,"src",o)},d(n){n&&a(e)}}}function ao(i){let e,t,o,n,r="Cancelar",h,_,E=i[8].title+"",O,k,f,s,g="Confirmar",d,m,v,w,y,z,M,H,C="Negocio",L,S,I=i[8].client_name+"",B,R,P=i[8].client_phone&&i[8].client_phone.trim().length,V,G,J,x,ge=i[8].schedule&&i[8].schedule.trim().length,j,Q,X=i[8].logistic_comments&&i[8].logistic_comments.trim().length,A,F,W,ee,te,le,ne,ie,he,Ie,Ne,Me,be,Re,Ge,je,Ve,D,K,fe,Ee,pe,$,_e="Subir Evidencia",ae,de,se,me,Ue,Te,Be=P&&$n(i);function Ze(re,Le){if(re[8].line1&&re[8].line1.trim().length)return to;if(re[8].line2&&re[8].line2.trim().length)return eo}let Qe=Ze(i),Ce=Qe&&Qe(i),ke=i[6]&&Rt(i),ye=i[7]&&i[7]!=="<br>"&&Ft(i),Fe=ge&&oo(i),De=i[8].driver_comments&&lo(i),qe=X&&io(i),we=i[3]&&qt(),Se=i[1]&&jt(i);return{c(){e=c("ion-header"),t=c("ion-toolbar"),o=c("ion-buttons"),n=c("ion-button"),n.textContent=r,h=N(),_=c("ion-title"),O=ce(E),k=N(),f=c("ion-buttons"),s=c("ion-button"),s.textContent=g,d=N(),m=c("ion-content"),v=c("ion-list"),w=c("ion-item"),y=c("ion-icon"),z=N(),M=c("ion-label"),H=c("p"),H.textContent=C,L=N(),S=c("h2"),B=ce(I),R=N(),Be&&Be.c(),V=N(),Ce&&Ce.c(),G=N(),ke&&ke.c(),J=N(),ye&&ye.c(),x=N(),Fe&&Fe.c(),j=N(),De&&De.c(),Q=N(),qe&&qe.c(),A=N(),F=c("ion-item"),W=c("ion-icon"),ee=N(),te=c("ion-textarea"),le=N(),ne=c("section"),ie=c("ion-button"),he=c("ion-icon"),Ie=ce(`
                Ingreso`),Me=N(),be=c("ion-button"),Re=c("ion-icon"),Ge=ce(`
                Salida`),Ve=N(),D=c("section"),K=c("label"),fe=c("ion-button"),Ee=c("ion-icon"),pe=N(),$=c("label"),$.textContent=_e,ae=N(),de=c("input"),se=N(),we&&we.c(),me=N(),Se&&Se.c(),this.h()},l(re){e=u(re,"ION-HEADER",{translucent:!0});var Le=b(e);t=u(Le,"ION-TOOLBAR",{});var xe=b(t);o=u(xe,"ION-BUTTONS",{slot:!0});var Lt=b(o);n=u(Lt,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),Z(n)!=="svelte-1f8rjcf"&&(n.textContent=r),Lt.forEach(a),h=T(xe),_=u(xe,"ION-TITLE",{title:!0});var St=b(_);O=ue(St,E),St.forEach(a),k=T(xe),f=u(xe,"ION-BUTTONS",{slot:!0});var Pt=b(f);s=u(Pt,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),Z(s)!=="svelte-1ida0il"&&(s.textContent=g),Pt.forEach(a),xe.forEach(a),Le.forEach(a),d=T(re),m=u(re,"ION-CONTENT",{fullscreen:!0});var Mt=b(m);v=u(Mt,"ION-LIST",{});var ve=b(v);w=u(ve,"ION-ITEM",{});var _t=b(w);y=u(_t,"ION-ICON",{icon:!0,slot:!0}),b(y).forEach(a),z=T(_t),M=u(_t,"ION-LABEL",{});var dt=b(M);H=u(dt,"P",{"data-svelte-h":!0}),Z(H)!=="svelte-57b1dg"&&(H.textContent=C),L=T(dt),S=u(dt,"H2",{});var At=b(S);B=ue(At,I),At.forEach(a),dt.forEach(a),_t.forEach(a),R=T(ve),Be&&Be.l(ve),V=T(ve),Ce&&Ce.l(ve),G=T(ve),ke&&ke.l(ve),J=T(ve),ye&&ye.l(ve),x=T(ve),Fe&&Fe.l(ve),j=T(ve),De&&De.l(ve),Q=T(ve),qe&&qe.l(ve),A=T(ve),F=u(ve,"ION-ITEM",{});var ht=b(F);W=u(ht,"ION-ICON",{icon:!0,slot:!0}),b(W).forEach(a),ee=T(ht),te=u(ht,"ION-TEXTAREA",{label:!0,placeholder:!0}),b(te).forEach(a),ht.forEach(a),le=T(ve),ne=u(ve,"SECTION",{style:!0});var pt=b(ne);ie=u(pt,"ION-BUTTON",{id:!0,style:!0,disabled:!0});var gt=b(ie);he=u(gt,"ION-ICON",{icon:!0,slot:!0}),b(he).forEach(a),Ie=ue(gt,`
                Ingreso`),gt.forEach(a),Me=T(pt),be=u(pt,"ION-BUTTON",{id:!0,style:!0,disabled:!0});var bt=b(be);Re=u(bt,"ION-ICON",{icon:!0,slot:!0}),b(Re).forEach(a),Ge=ue(bt,`
                Salida`),bt.forEach(a),pt.forEach(a),Ve=T(ve),D=u(ve,"SECTION",{});var Bt=b(D);K=u(Bt,"LABEL",{for:!0,style:!0});var Dt=b(K);fe=u(Dt,"ION-BUTTON",{fill:!0,class:!0,expand:!0});var $e=b(fe);Ee=u($e,"ION-ICON",{icon:!0,slot:!0}),b(Ee).forEach(a),pe=T($e),$=u($e,"LABEL",{for:!0,style:!0,"data-svelte-h":!0}),Z($)!=="svelte-1as0od8"&&($.textContent=_e),ae=T($e),de=u($e,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0}),$e.forEach(a),Dt.forEach(a),Bt.forEach(a),se=T(ve),we&&we.l(ve),me=T(ve),Se&&Se.l(ve),ve.forEach(a),Mt.forEach(a),this.h()},h(){p(n,"color","medium"),p(o,"slot","start"),p(_,"title",i[8].title),p(s,"strong",""),p(f,"slot","end"),p(e,"translucent",""),p(y,"icon",Nn),p(y,"slot","start"),p(W,"icon",Ot),p(W,"slot","start"),p(te,"label","Notas"),p(te,"placeholder","Escribe aquí..."),p(he,"icon",Tn),p(he,"slot","start"),p(ie,"id","checkInBtn"),q(ie,"flex","1"),p(ie,"disabled",Ne=i[4]===!1),p(Re,"icon",Cn),p(Re,"slot","start"),p(be,"id","checkOutBtn"),q(be,"flex","1"),p(be,"disabled",je=i[5]===!1),q(ne,"display","flex"),q(ne,"gap","8px"),q(ne,"padding","16px"),p(Ee,"icon",sn),p(Ee,"slot","start"),Y($,"for","eventEvidence"),q($,"padding","8px 10px"),q(de,"display","none"),Y(de,"id","eventEvidence"),Y(de,"name","fileToUpload"),Y(de,"type","file"),Y(de,"accept","image/*"),p(fe,"fill","outline"),p(fe,"class","loadEvidence"),p(fe,"expand","block"),Y(K,"for","eventEvidence"),q(K,"display","block"),q(K,"width","100%"),p(m,"fullscreen","")},m(re,Le){U(re,e,Le),l(e,t),l(t,o),l(o,n),l(t,h),l(t,_),l(_,O),l(t,k),l(t,f),l(f,s),U(re,d,Le),U(re,m,Le),l(m,v),l(v,w),l(w,y),l(w,z),l(w,M),l(M,H),l(M,L),l(M,S),l(S,B),l(v,R),Be&&Be.m(v,null),l(v,V),Ce&&Ce.m(v,null),l(v,G),ke&&ke.m(v,null),l(v,J),ye&&ye.m(v,null),l(v,x),Fe&&Fe.m(v,null),l(v,j),De&&De.m(v,null),l(v,Q),qe&&qe.m(v,null),l(v,A),l(v,F),l(F,W),l(F,ee),l(F,te),i[15](te),l(v,le),l(v,ne),l(ne,ie),l(ie,he),l(ie,Ie),l(ne,Me),l(ne,be),l(be,Re),l(be,Ge),l(v,Ve),l(v,D),l(D,K),l(K,fe),l(fe,Ee),l(fe,pe),l(fe,$),l(fe,ae),l(fe,de),l(v,se),we&&we.m(v,null),l(v,me),Se&&Se.m(v,null),Ue||(Te=[oe(n,"click",i[10]),oe(s,"click",i[11]),oe(ie,"click",i[13]),oe(be,"click",i[14]),oe(de,"change",i[9])],Ue=!0)},p(re,[Le]){P&&Be.p(re,Le),Ce&&Ce.p(re,Le),re[6]?ke?ke.p(re,Le):(ke=Rt(re),ke.c(),ke.m(v,J)):ke&&(ke.d(1),ke=null),re[7]&&re[7]!=="<br>"?ye?ye.p(re,Le):(ye=Ft(re),ye.c(),ye.m(v,x)):ye&&(ye.d(1),ye=null),ge&&Fe.p(re,Le),re[8].driver_comments&&De.p(re,Le),X&&qe.p(re,Le),Le&16&&Ne!==(Ne=re[4]===!1)&&p(ie,"disabled",Ne),Le&32&&je!==(je=re[5]===!1)&&p(be,"disabled",je),re[3]?we||(we=qt(),we.c(),we.m(v,me)):we&&(we.d(1),we=null),re[1]?Se?Se.p(re,Le):(Se=jt(re),Se.c(),Se.m(v,null)):Se&&(Se.d(1),Se=null)},i:Oe,o:Oe,d(re){re&&(a(e),a(d),a(m)),Be&&Be.d(),Ce&&Ce.d(),ke&&ke.d(),ye&&ye.d(),Fe&&Fe.d(),De&&De.d(),qe&&qe.d(),i[15](null),we&&we.d(),Se&&Se.d(),Ue=!1,We(Te)}}}const Vt=/Teléfono:\s*(\d{10,})/;function Gt(i,e){for(let t=0;t<e.length;t++)if(e[t].alias===i)return e[t].val;return""}function so(i,e,t){let o=document.querySelector("ion-modal"),n=o.componentProps.delivery,r=o.componentProps.isLast,h=n.driver_comments?n.driver_comments:"",_=n.img?n.img:"",E="",O={latitude:null,longitude:null},k=new Object,f="",s="",g=!1,d=!0,m=!1,v="",w=n.comments_ext;st(()=>{V(),y()});function y(){n.date_service?n.date_service&&!n.date_completed&&!n.service_time?(t(4,d=!1),t(5,m=!0)):n.date_service&&n.date_completed&&n.service_time&&(t(4,d=!1),t(5,m=!1)):(t(4,d=!0),t(5,m=!1))}if(n.comments_ext){const j=n.comments_ext.match(Vt);j&&(v=j[1],w=n.comments_ext.replace(Vt,"").trim())}const z=async()=>{await(await Je.create({header:"SMS enviado",message:"Se envío correctamente un SMS a "+n.title+" con número de teléfono: "+v,buttons:[{text:"Cerrar"}]})).present()},M=async()=>{await(await Je.create({header:"SMS no enviado",message:"Hubo un error al enviar SMS a "+n.title+" con número de teléfono: "+phoneNumber0+". Por favor contacte a soporte.",buttons:[{text:"Cerrar"}]})).present()};async function H(j){await(await Je.create({header:"Tiempo por parada",message:"Completaste la parada en "+j+" minutos.",buttons:[{text:"Cerrar"}]})).present()}const C=async j=>{t(3,g=!0);const X=j.target.files[0],A=await L(X);if(A){const F=new FormData;F.append("fileToUpload",A);try{const W=await fetch("https://dev.rutaflow.com/api/admin/manager/upload_img_driver.php",{method:"POST",body:F});if(W.ok){const ee=await W.json();t(1,_=ee.img),E=ee.img_id}else console.error("File upload failed:",W.statusText)}catch(W){console.error("Error during file upload:",W)}finally{t(3,g=!1)}}},L=async j=>new Promise(Q=>{const X=new FileReader;X.onload=A=>{const F=new Image;F.src=A.target.result,F.onload=()=>{const W=document.createElement("canvas"),ee=W.getContext("2d"),te=800,le=600;let ne=F.width,ie=F.height;ne>te&&(ie*=te/ne,ne=te),ie>le&&(ne*=le/ie,ie=le),W.width=ne,W.height=ie,ee.drawImage(F,0,0,ne,ie),W.toBlob(he=>{Q(he)},"image/jpeg",.7)}},X.readAsDataURL(j)}),S=()=>{o.dismiss({data:Date.now()})},I=async()=>{try{if(await R()){const Q={id_route:n.id_route,id_event:n.id_event,comments:h.value,img:_,img_id:E,lat:O.latitude,lon:O.longitude,...f==="0"&&{approve:"0"},...r&&{isLast:!0}},X=new FormData;for(const te in Q)X.append(te,Q[te]);const F=await(await fetch("https://dev.rutaflow.com/api/admin/evidence/send_evidence.php",{method:"POST",body:X})).json();S();const W={},ee=Q.id_route;r&&B("","",ee,r)}}catch(j){console.error("Error fetching data:",j)}},B=(j,Q,X,A)=>{o.componentProps.routeId=X,o.componentProps.driverId=n.id_driver,Xe("modal-km-gas",_n,{checklist:j,driverId:Q,routeId:X,isLast:A}).then(F=>{})},R=async()=>navigator.geolocation?new Promise((j,Q)=>{navigator.geolocation.getCurrentPosition(X=>{O.latitude=X.coords.latitude,O.longitude=X.coords.longitude,j(!0)},X=>{console.error("Error getting location:",X),j(!1)})}):(console.error("Geolocation is not supported by your browser"),!1);async function P(j){j.stopPropagation();const Q=new FormData;Q.append("client_phone",v),Q.append("client_name",n.title),Q.append("delivery_phone",n.client_phone),Q.append("enterprise_name",n.enterprise_name);try{const X=await fetch("https://dev.rutaflow.com/api/admin/message_central/send_sms.php",{method:"POST",body:Q});if(X.ok){const A=await X.json();z()}else M()}catch(X){console.error("Error during file upload:",X)}}const V=async j=>{if(n.id_enterprise){const Q=new FormData;Q.append("id_enterprise",n.id_enterprise);try{const X=await fetch("https://dev.rutaflow.com/api/admin/enterprise/enterprise_settings.php",{method:"POST",body:Q});X.ok?(k=(await X.json()).nodos,f=Gt("stops_wait_approval",k),t(2,s=Gt("sms_active",k))):console.error("File upload failed:",X.statusText)}catch(X){console.error("Error during file upload:",X)}}};function G(){t(4,d=!1),t(5,m=!0),x(n.id_event,"checkin")}function J(){t(5,m=!1),t(4,d=!1),x(n.id_event,"checkout")}async function x(j,Q){if(Q){const X=new FormData;X.append("type",Q),X.append("id_event",j);try{const A=await fetch("https://dev.rutaflow.com/api/admin/route/record_check_date.php",{method:"POST",body:X});if(A.ok){const F=await A.json();F.minutes&&H(F.minutes)}else console.error("File upload failed:",A.statusText)}catch(A){console.error("Error during file upload:",A)}finally{}}}function ge(j){ze[j?"unshift":"push"](()=>{h=j,t(0,h)})}return[h,_,s,g,d,m,v,w,n,C,S,I,P,G,J,ge]}class co extends lt{constructor(e){super(),it(this,e,so,ao,ot,{})}}function Kt(i){let e;return{c(){e=c("ion-spinner"),this.h()},l(t){e=u(t,"ION-SPINNER",{name:!0}),b(e).forEach(a),this.h()},h(){p(e,"name","dots")},m(t,o){U(t,e,o)},d(t){t&&a(e)}}}function Wt(i){let e,t,o;return{c(){e=c("section"),t=c("ion-img"),this.h()},l(n){e=u(n,"SECTION",{});var r=b(e);t=u(r,"ION-IMG",{src:!0,alt:!0,style:!0}),b(t).forEach(a),r.forEach(a),this.h()},h(){vt(t.src,o=i[0])||p(t,"src",o),p(t,"alt","Evidencia fotográfica"),q(t,"max-width","100%"),q(t,"margin-top","16px")},m(n,r){U(n,e,r),l(e,t)},p(n,r){r&1&&!vt(t.src,o=n[0])&&p(t,"src",o)},d(n){n&&a(e)}}}function uo(i){let e,t,o,n,r="Cancelar",h,_,E="AGREGAR GASTO",O,k,f,s,g,d,m,v,w,y,z,M,H,C,L,S,I,B,R='Tipo de pago <ion-text color="danger">(Obligatorio)</ion-text>',P,V,G="Efectivo",J,x,ge="Tarjeta",j,Q,X="Transferencia",A,F,W,ee,te,le,ne,ie,he,Ie,Ne=`<ion-icon icon="${sn}" slot="start"></ion-icon>
                        Subir Evidencia`,Me,be,Re,Ge,je,Ve,D,K,fe="Confirmar",Ee,pe,$=i[5]&&Kt(),_e=i[0]&&Wt(i);return{c(){e=c("ion-header"),t=c("ion-toolbar"),o=c("ion-buttons"),n=c("ion-button"),n.textContent=r,h=N(),_=c("ion-title"),_.textContent=E,O=N(),k=c("ion-content"),f=c("ion-list"),s=c("ion-item"),g=c("ion-icon"),d=N(),m=c("ion-input"),v=N(),w=c("ion-item"),y=c("ion-icon"),z=N(),M=c("ion-input"),H=N(),C=c("ion-item"),L=c("ion-icon"),S=N(),I=c("ion-select"),B=c("div"),B.innerHTML=R,P=N(),V=c("ion-select-option"),V.textContent=G,J=N(),x=c("ion-select-option"),x.textContent=ge,j=N(),Q=c("ion-select-option"),Q.textContent=X,A=N(),F=c("ion-item"),W=c("ion-icon"),ee=N(),te=c("ion-textarea"),le=N(),ne=c("section"),ie=c("label"),he=c("ion-button"),Ie=c("label"),Ie.innerHTML=Ne,Me=N(),be=c("input"),Re=N(),$&&$.c(),Ge=N(),_e&&_e.c(),je=N(),Ve=c("ion-footer"),D=c("ion-toolbar"),K=c("ion-button"),K.textContent=fe,this.h()},l(ae){e=u(ae,"ION-HEADER",{translucent:!0});var de=b(e);t=u(de,"ION-TOOLBAR",{});var se=b(t);o=u(se,"ION-BUTTONS",{slot:!0});var me=b(o);n=u(me,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),Z(n)!=="svelte-1f8rjcf"&&(n.textContent=r),me.forEach(a),h=T(se),_=u(se,"ION-TITLE",{title:!0,"data-svelte-h":!0}),Z(_)!=="svelte-efps2s"&&(_.textContent=E),se.forEach(a),de.forEach(a),O=T(ae),k=u(ae,"ION-CONTENT",{fullscreen:!0});var Ue=b(k);f=u(Ue,"ION-LIST",{});var Te=b(f);s=u(Te,"ION-ITEM",{});var Be=b(s);g=u(Be,"ION-ICON",{icon:!0,slot:!0}),b(g).forEach(a),d=T(Be),m=u(Be,"ION-INPUT",{label:!0,type:!0,placeholder:!0,value:!0}),b(m).forEach(a),Be.forEach(a),v=T(Te),w=u(Te,"ION-ITEM",{});var Ze=b(w);y=u(Ze,"ION-ICON",{icon:!0,slot:!0}),b(y).forEach(a),z=T(Ze),M=u(Ze,"ION-INPUT",{label:!0,type:!0,value:!0}),b(M).forEach(a),Ze.forEach(a),H=T(Te),C=u(Te,"ION-ITEM",{});var Qe=b(C);L=u(Qe,"ION-ICON",{icon:!0,slot:!0}),b(L).forEach(a),S=T(Qe),I=u(Qe,"ION-SELECT",{placeholder:!0,value:!0});var Ce=b(I);B=u(Ce,"DIV",{slot:!0,"data-svelte-h":!0}),Z(B)!=="svelte-wl764p"&&(B.innerHTML=R),P=T(Ce),V=u(Ce,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),Z(V)!=="svelte-i9crym"&&(V.textContent=G),J=T(Ce),x=u(Ce,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),Z(x)!=="svelte-fx0z11"&&(x.textContent=ge),j=T(Ce),Q=u(Ce,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),Z(Q)!=="svelte-1c24jf2"&&(Q.textContent=X),Ce.forEach(a),Qe.forEach(a),A=T(Te),F=u(Te,"ION-ITEM",{});var ke=b(F);W=u(ke,"ION-ICON",{icon:!0,slot:!0}),b(W).forEach(a),ee=T(ke),te=u(ke,"ION-TEXTAREA",{label:!0,placeholder:!0}),b(te).forEach(a),ke.forEach(a),le=T(Te),ne=u(Te,"SECTION",{});var ye=b(ne);ie=u(ye,"LABEL",{for:!0,style:!0});var Fe=b(ie);he=u(Fe,"ION-BUTTON",{fill:!0,size:!0,class:!0,expand:!0});var De=b(he);Ie=u(De,"LABEL",{for:!0,style:!0,"data-svelte-h":!0}),Z(Ie)!=="svelte-1m9yw22"&&(Ie.innerHTML=Ne),Me=T(De),be=u(De,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0}),De.forEach(a),Fe.forEach(a),ye.forEach(a),Re=T(Te),$&&$.l(Te),Ge=T(Te),_e&&_e.l(Te),Te.forEach(a),Ue.forEach(a),je=T(ae),Ve=u(ae,"ION-FOOTER",{});var qe=b(Ve);D=u(qe,"ION-TOOLBAR",{});var we=b(D);K=u(we,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),Z(K)!=="svelte-1c7dl3f"&&(K.textContent=fe),we.forEach(a),qe.forEach(a),this.h()},h(){p(n,"color","medium"),p(o,"slot","start"),p(_,"title",""),p(e,"translucent",""),p(g,"icon",un),p(g,"slot","start"),p(m,"label","Concepto"),p(m,"type","text"),p(m,"placeholder","Escribe aquí..."),p(m,"value",i[6]?i[6]:""),p(y,"icon",Ot),p(y,"slot","start"),p(M,"label","Cantidad"),p(M,"type","number"),p(M,"value",i[7]?i[7]:""),p(L,"icon",Pn),p(L,"slot","start"),Y(B,"slot","label"),p(V,"value","cash"),p(x,"value","card"),p(Q,"value","transfer"),p(I,"placeholder","Tipo de pago"),p(I,"value",i[8]?i[8]:""),p(W,"icon",Ot),p(W,"slot","start"),p(te,"label","Comentarios"),p(te,"placeholder","Escribe aquí..."),Y(Ie,"for","eventEvidence"),q(Ie,"width","100%"),q(Ie,"padding","8px"),q(be,"display","none"),Y(be,"id","eventEvidence"),Y(be,"name","fileToUpload"),Y(be,"type","file"),Y(be,"accept","image/*"),p(he,"fill","outline"),p(he,"size","small"),p(he,"class","loadEvidence"),p(he,"expand","block"),Y(ie,"for","eventEvidence"),q(ie,"display","block"),q(ie,"width","100%"),p(k,"fullscreen",""),p(K,"fill","outline"),p(K,"color","tertiary"),p(K,"strong",""),q(K,"width","99%"),q(K,"height","auto")},m(ae,de){U(ae,e,de),l(e,t),l(t,o),l(o,n),l(t,h),l(t,_),U(ae,O,de),U(ae,k,de),l(k,f),l(f,s),l(s,g),l(s,d),l(s,m),i[12](m),l(f,v),l(f,w),l(w,y),l(w,z),l(w,M),i[13](M),l(f,H),l(f,C),l(C,L),l(C,S),l(C,I),l(I,B),l(I,P),l(I,V),l(I,J),l(I,x),l(I,j),l(I,Q),i[14](I),l(f,A),l(f,F),l(F,W),l(F,ee),l(F,te),i[15](te),l(f,le),l(f,ne),l(ne,ie),l(ie,he),l(he,Ie),l(he,Me),l(he,be),l(f,Re),$&&$.m(f,null),l(f,Ge),_e&&_e.m(f,null),U(ae,je,de),U(ae,Ve,de),l(Ve,D),l(D,K),Ee||(pe=[oe(n,"click",i[10]),oe(be,"change",i[9]),oe(K,"click",i[11])],Ee=!0)},p(ae,[de]){ae[5]?$||($=Kt(),$.c(),$.m(f,Ge)):$&&($.d(1),$=null),ae[0]?_e?_e.p(ae,de):(_e=Wt(ae),_e.c(),_e.m(f,null)):_e&&(_e.d(1),_e=null)},i:Oe,o:Oe,d(ae){ae&&(a(e),a(O),a(k),a(je),a(Ve)),i[12](null),i[13](null),i[14](null),i[15](null),$&&$.d(),_e&&_e.d(),Ee=!1,We(pe)}}}function fo(i,e,t){let o=document.querySelector("ion-modal"),n=o.componentProps.routeId,r=o.componentProps.ex_concept,h=o.componentProps.ex_amount,_=o.componentProps.ex_type,E=o.componentProps.id_expense,O="",k="",f="",s=0,g="",d="",m=!1;st(()=>{});const v=async(I,B)=>{await(await Je.create({header:I||"Error",message:B||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()},w=async I=>{t(5,m=!0);const R=I.target.files[0],P=await y(R);if(P){const V=new FormData;V.append("fileToUpload",P);try{const G=await fetch("https://dev.rutaflow.com/api/admin/manager/upload_img_driver.php",{method:"POST",body:V});if(G.ok){const J=await G.json();t(0,O=J.img),k=J.img_id}else console.error("File upload failed:",G.statusText)}catch(G){console.error("Error during file upload:",G)}finally{t(5,m=!1)}}},y=async I=>new Promise(B=>{const R=new FileReader;R.onload=P=>{const V=new Image;V.src=P.target.result,V.onload=()=>{const G=document.createElement("canvas"),J=G.getContext("2d"),x=800,ge=600;let j=V.width,Q=V.height;j>x&&(Q*=x/j,j=x),Q>ge&&(j*=ge/Q,Q=ge),G.width=j,G.height=Q,J.drawImage(V,0,0,j,Q),G.toBlob(X=>{B(X)},"image/jpeg",.7)}},R.readAsDataURL(I)}),z=()=>{ft.dismiss()},M=()=>{var I=new Object;I.id_route=n,I.comments=g.value,I.type=f.value,I.img=O,I.img_id=k,I.amount=s.value,I.concept=d.value,I.status="done",I.id_expense=E||"null";const B=new FormData;for(const R in I)B.append(R,I[R]);!k||!O||!g.value||!s.value||!d.value?v("Datos incompletos","Llena los datos requeridos para completar el registro"):fetch("https://dev.rutaflow.com/api/admin/expenses/add_expense.php",{method:"POST",body:B}).then(R=>R.json()).then(R=>{z()}).catch(R=>{console.error("Error fetching data:",R)})};function H(I){ze[I?"unshift":"push"](()=>{d=I,t(4,d)})}function C(I){ze[I?"unshift":"push"](()=>{s=I,t(2,s)})}function L(I){ze[I?"unshift":"push"](()=>{f=I,t(1,f)})}function S(I){ze[I?"unshift":"push"](()=>{g=I,t(3,g)})}return[O,f,s,g,d,m,r,h,_,w,z,M,H,C,L,S]}class Tt extends lt{constructor(e){super(),it(this,e,fo,uo,ot,{})}}function Xt(i,e,t){const o=i.slice();return o[7]=e[t],o}function _o(i){let e,t="Cargar gasto",o,n;function r(...h){return i[4](i[7],...h)}return{c(){e=c("ion-button"),e.textContent=t,this.h()},l(h){e=u(h,"ION-BUTTON",{fill:!0,size:!0,"aria-selected":!0,"data-svelte-h":!0}),Z(e)!=="svelte-175aelj"&&(e.textContent=t),this.h()},h(){p(e,"fill","outline"),p(e,"size","small"),p(e,"aria-selected","")},m(h,_){U(h,e,_),o||(n=oe(e,"click",r),o=!0)},p(h,_){i=h},d(h){h&&a(e),o=!1,n()}}}function ho(i){let e,t="Gasto completado";return{c(){e=c("ion-button"),e.textContent=t,this.h()},l(o){e=u(o,"ION-BUTTON",{fill:!0,size:!0,"aria-selected":!0,"data-svelte-h":!0}),Z(e)!=="svelte-tlger7"&&(e.textContent=t),this.h()},h(){p(e,"fill","solid"),p(e,"size","small"),p(e,"aria-selected","")},m(o,n){U(o,e,n)},p:Oe,d(o){o&&a(e)}}}function Jt(i,e){let t,o,n,r=e[7].concept+"",h,_,E;function O(s,g){return s[7].status=="done"?ho:_o}let f=O(e)(e);return{key:i,first:null,c(){t=c("ion-item"),o=c("ion-label"),n=c("p"),h=ce(r),_=N(),f.c(),E=N(),this.h()},l(s){t=u(s,"ION-ITEM",{});var g=b(t);o=u(g,"ION-LABEL",{style:!0});var d=b(o);n=u(d,"P",{style:!0});var m=b(n);h=ue(m,r),m.forEach(a),d.forEach(a),_=T(g),f.l(g),E=T(g),g.forEach(a),this.h()},h(){q(n,"margin-left","10px"),q(o,"display","flex"),this.first=t},m(s,g){U(s,t,g),l(t,o),l(o,n),l(n,h),l(t,_),f.m(t,null),l(t,E)},p(s,g){e=s,f.p(e,g)},d(s){s&&a(t),f.d()}}}function po(i){let e,t,o,n,r=`<ion-icon style="font-size: 25px!important;" icon="${Mn}"></ion-icon>`,h,_,E="LISTA DE GASTOS",O,k,f,s=[],g=new Map,d,m,v,w="Cerrar",y,z,M=Ke(i[0]);const H=C=>C[7].id_expenses;for(let C=0;C<M.length;C+=1){let L=Xt(i,M,C),S=H(L);g.set(S,s[C]=Jt(S,L))}return{c(){e=c("ion-header"),t=c("ion-toolbar"),o=c("ion-buttons"),n=c("ion-button"),n.innerHTML=r,h=N(),_=c("ion-title"),_.textContent=E,O=N(),k=c("ion-content"),f=c("ion-list");for(let C=0;C<s.length;C+=1)s[C].c();d=N(),m=c("ion-footer"),v=c("ion-button"),v.textContent=w,this.h()},l(C){e=u(C,"ION-HEADER",{translucent:!0});var L=b(e);t=u(L,"ION-TOOLBAR",{});var S=b(t);o=u(S,"ION-BUTTONS",{slot:!0});var I=b(o);n=u(I,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),Z(n)!=="svelte-160xz3i"&&(n.innerHTML=r),I.forEach(a),h=T(S),_=u(S,"ION-TITLE",{"data-svelte-h":!0}),Z(_)!=="svelte-1phn90x"&&(_.textContent=E),S.forEach(a),L.forEach(a),O=T(C),k=u(C,"ION-CONTENT",{fullscreen:!0});var B=b(k);f=u(B,"ION-LIST",{});var R=b(f);for(let V=0;V<s.length;V+=1)s[V].l(R);R.forEach(a),B.forEach(a),d=T(C),m=u(C,"ION-FOOTER",{});var P=b(m);v=u(P,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),Z(v)!=="svelte-zv7v83"&&(v.textContent=w),P.forEach(a),this.h()},h(){p(n,"color","medium"),p(o,"slot","end"),p(e,"translucent",""),p(k,"fullscreen",""),p(v,"fill","outline"),p(v,"color","tertiary"),p(v,"strong",""),q(v,"width","99%"),q(v,"height","auto")},m(C,L){U(C,e,L),l(e,t),l(t,o),l(o,n),l(t,h),l(t,_),U(C,O,L),U(C,k,L),l(k,f);for(let S=0;S<s.length;S+=1)s[S]&&s[S].m(f,null);U(C,d,L),U(C,m,L),l(m,v),y||(z=[oe(n,"click",i[3]),oe(v,"click",i[1])],y=!0)},p(C,[L]){L&5&&(M=Ke(C[0]),s=ct(s,L,H,1,C,M,g,f,ut,Jt,null,Xt))},i:Oe,o:Oe,d(C){C&&(a(e),a(O),a(k),a(d),a(m));for(let L=0;L<s.length;L+=1)s[L].d();y=!1,We(z)}}}function mo(i){let e=document.querySelector("ion-modal");e.componentProps.routeId;let t=e.componentProps.expenses;st(()=>{});const o=()=>{ft.dismiss()};function n(_,E,O,k,f){e.componentProps.ex_amount=O,e.componentProps.ex_concept=E,e.componentProps.ex_type=k,e.componentProps.id_expense=f,Xe("modal-expense",Tt,{amount:O,concept:E,type:k,id_expense:f}).then(()=>{}),o()}return[t,o,n,_=>{Xe("modal-expense",Tt,{routeId:_}).then(E=>{}),o()},(_,E)=>n(E,_.concept,_.amount,_.type,_.id_expenses)]}class vo extends lt{constructor(e){super(),it(this,e,mo,po,ot,{})}}const{document:Qt}=Un;function Yt(i,e,t){const o=i.slice();return o[34]=e[t],o}function Zt(i,e,t){const o=i.slice();return o[34]=e[t],o[36]=t,o}function xt(i,e,t){const o=i.slice();return o[34]=e[t],o[36]=t,o}function $t(i){let e,t;return e=new zn({props:{$$slots:{default:[No]},$$scope:{ctx:i}}}),{c(){bn(e.$$.fragment)},l(o){En(e.$$.fragment,o)},m(o,n){In(e,o,n),t=!0},p(o,n){const r={};n[0]&1019|n[1]&512&&(r.$$scope={dirty:n,ctx:o}),e.$set(r)},i(o){t||(mt(e.$$.fragment,o),t=!0)},o(o){kt(e.$$.fragment,o),t=!1},d(o){kn(e,o)}}}function go(i){let e,t='<div id="g_map" style="width: 100%; height: 100vh;"></div>';return{c(){e=c("ion-content"),e.innerHTML=t},l(o){e=u(o,"ION-CONTENT",{"data-svelte-h":!0}),Z(e)!=="svelte-1ydw6i9"&&(e.innerHTML=t)},m(o,n){U(o,e,n)},p:Oe,d(o){o&&a(e)}}}function bo(i){let e;function t(r,h){if(r[7].length>0)return Io;if(!r[3])return Eo}let o=t(i),n=o&&o(i);return{c(){n&&n.c(),e=He()},l(r){n&&n.l(r),e=He()},m(r,h){n&&n.m(r,h),U(r,e,h)},p(r,h){o===(o=t(r))&&n?n.p(r,h):(n&&n.d(1),n=o&&o(r),n&&(n.c(),n.m(e.parentNode,e)))},d(r){r&&a(e),n&&n.d(r)}}}function Eo(i){let e,t,o,n='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Jala para actualizar" refreshing-spinner="circles" refreshing-text="Actualizando..."></ion-refresher-content>',r,h,_=[],E=new Map,O,k,f=i[4]&&en(i),s=Ke(i[5]);const g=d=>d[34].id_event;for(let d=0;d<s.length;d+=1){let m=Yt(i,s,d),v=g(m);E.set(v,_[d]=nn(v,m))}return{c(){f&&f.c(),e=N(),t=c("ion-content"),o=c("ion-refresher"),o.innerHTML=n,r=N(),h=c("ion-list");for(let d=0;d<_.length;d+=1)_[d].c();this.h()},l(d){f&&f.l(d),e=T(d),t=u(d,"ION-CONTENT",{});var m=b(t);o=u(m,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),Z(o)!=="svelte-1srnbs3"&&(o.innerHTML=n),r=T(m),h=u(m,"ION-LIST",{});var v=b(h);for(let w=0;w<_.length;w+=1)_[w].l(v);v.forEach(a),m.forEach(a),this.h()},h(){p(o,"slot","fixed")},m(d,m){f&&f.m(d,m),U(d,e,m),U(d,t,m),l(t,o),i[26](o),l(t,r),l(t,h);for(let v=0;v<_.length;v+=1)_[v]&&_[v].m(h,null);O||(k=oe(o,"ionRefresh",i[10]),O=!0)},p(d,m){d[4]?f?f.p(d,m):(f=en(d),f.c(),f.m(e.parentNode,e)):f&&(f.d(1),f=null),m[0]&167968&&(s=Ke(d[5]),_=ct(_,m,g,1,d,s,E,h,ut,nn,null,Yt))},d(d){d&&(a(e),a(t)),f&&f.d(d),i[26](null);for(let m=0;m<_.length;m+=1)_[m].d();O=!1,k()}}}function Io(i){let e,t;function o(h,_){return _[0]&144&&(e=null),e==null&&(e=!!(h[7].filter(yo).every(wo)&&!h[4])),e?Oo:ko}let n=o(i,[-1,-1]),r=n(i);return{c(){r.c(),t=He()},l(h){r.l(h),t=He()},m(h,_){r.m(h,_),U(h,t,_)},p(h,_){n===(n=o(h,_))&&r?r.p(h,_):(r.d(1),r=n(h),r&&(r.c(),r.m(t.parentNode,t)))},d(h){h&&a(t),r.d(h)}}}function en(i){let e=i[13]("",i[1],i[0])+"",t;return{c(){t=ce(e)},l(o){t=ue(o,e)},m(o,n){U(o,t,n)},p(o,n){n[0]&3&&e!==(e=o[13]("",o[1],o[0])+"")&&Pe(t,e)},d(o){o&&a(t)}}}function tn(i){let e;return{c(){e=c("span"),this.h()},l(t){e=u(t,"SPAN",{class:!0}),b(e).forEach(a),this.h()},h(){Y(e,"class","notes svelte-egzizz")},m(t,o){U(t,e,o)},d(t){t&&a(e)}}}function nn(i,e){let t,o,n,r,h=parseInt(e[34].pos)+1+"",_,E,O,k,f,s,g=e[34].title+"",d,m,v=e[34].support_list&&e[34].support_list.length||e[15](e[34]),w,y,z,M,H,C=v&&tn();function L(){return e[27](e[34])}return{key:i,first:null,c(){t=c("ion-item"),o=c("ion-avatar"),n=c("div"),r=c("div"),_=ce(h),O=N(),k=c("ion-label"),f=c("ion-text"),s=c("h3"),d=ce(g),m=N(),C&&C.c(),w=N(),y=c("ion-icon"),z=N(),this.h()},l(S){t=u(S,"ION-ITEM",{});var I=b(t);o=u(I,"ION-AVATAR",{slot:!0});var B=b(o);n=u(B,"DIV",{class:!0,title:!0,style:!0});var R=b(n);r=u(R,"DIV",{class:!0});var P=b(r);_=ue(P,h),P.forEach(a),R.forEach(a),B.forEach(a),O=T(I),k=u(I,"ION-LABEL",{button:!0});var V=b(k);f=u(V,"ION-TEXT",{color:!0});var G=b(f);s=u(G,"H3",{});var J=b(s);d=ue(J,g),m=T(J),C&&C.l(J),J.forEach(a),G.forEach(a),V.forEach(a),w=T(I),y=u(I,"ION-ICON",{icon:!0,slot:!0,style:!0}),b(y).forEach(a),z=T(I),I.forEach(a),this.h()},h(){Y(r,"class","order svelte-egzizz"),Y(n,"class","order-wrapper svelte-egzizz"),Y(n,"title",E=tt(e[34].status)),q(n,"background-color",Ae(e[34].status)),q(n,"color",nt(Ae(e[34].status))),p(o,"slot","start"),p(f,"color","#2e2e2e"),p(k,"button",""),p(y,"icon",rt),p(y,"slot","end"),q(y,"color",Ae(e[34].status)),this.first=t},m(S,I){U(S,t,I),l(t,o),l(o,n),l(n,r),l(r,_),l(t,O),l(t,k),l(k,f),l(f,s),l(s,d),l(s,m),C&&C.m(s,null),l(t,w),l(t,y),l(t,z),M||(H=oe(k,"click",L),M=!0)},p(S,I){e=S,I[0]&32&&h!==(h=parseInt(e[34].pos)+1+"")&&Pe(_,h),I[0]&32&&E!==(E=tt(e[34].status))&&Y(n,"title",E),I[0]&32&&q(n,"background-color",Ae(e[34].status)),I[0]&32&&q(n,"color",nt(Ae(e[34].status))),I[0]&32&&g!==(g=e[34].title+"")&&Pe(d,g),I[0]&32&&(v=e[34].support_list&&e[34].support_list.length||e[15](e[34])),v?C||(C=tn(),C.c(),C.m(s,null)):C&&(C.d(1),C=null),I[0]&32&&q(y,"color",Ae(e[34].status))},d(S){S&&a(t),C&&C.d(),M=!1,H()}}}function ko(i){let e=i[13](i[7],i[1],i[0])+"",t,o,n,r,h='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Pull to refresh" refreshing-spinner="circles" refreshing-text="Refreshing..."></ion-refresher-content>',_,E,O=[],k=new Map,f,s,g=Ke(i[5]);const d=m=>m[34].id_event;for(let m=0;m<g.length;m+=1){let v=Zt(i,g,m),w=d(v);k.set(w,O[m]=ln(w,v))}return{c(){t=ce(e),o=N(),n=c("ion-content"),r=c("ion-refresher"),r.innerHTML=h,_=N(),E=c("ion-list");for(let m=0;m<O.length;m+=1)O[m].c();this.h()},l(m){t=ue(m,e),o=T(m),n=u(m,"ION-CONTENT",{});var v=b(n);r=u(v,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),Z(r)!=="svelte-dvt1s"&&(r.innerHTML=h),_=T(v),E=u(v,"ION-LIST",{});var w=b(E);for(let y=0;y<O.length;y+=1)O[y].l(w);w.forEach(a),v.forEach(a),this.h()},h(){p(r,"slot","fixed")},m(m,v){U(m,t,v),U(m,o,v),U(m,n,v),l(n,r),i[24](r),l(n,_),l(n,E);for(let w=0;w<O.length;w+=1)O[w]&&O[w].m(E,null);f||(s=oe(r,"ionRefresh",i[10]),f=!0)},p(m,v){v[0]&131&&e!==(e=m[13](m[7],m[1],m[0])+"")&&Pe(t,e),v[0]&299040&&(g=Ke(m[5]),O=ct(O,v,d,1,m,g,k,E,ut,ln,null,Zt))},d(m){m&&(a(t),a(o),a(n)),i[24](null);for(let v=0;v<O.length;v+=1)O[v].d();f=!1,s()}}}function Oo(i){let e,t,o='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Jale para actualizar" refreshing-spinner="circles" refreshing-text="Actualizando..."></ion-refresher-content>',n,r,h=[],_=new Map,E,O,k=Ke(i[5]);const f=s=>s[34].id_event;for(let s=0;s<k.length;s+=1){let g=xt(i,k,s),d=f(g);_.set(d,h[s]=an(d,g))}return{c(){e=c("ion-content"),t=c("ion-refresher"),t.innerHTML=o,n=N(),r=c("ion-list");for(let s=0;s<h.length;s+=1)h[s].c();this.h()},l(s){e=u(s,"ION-CONTENT",{});var g=b(e);t=u(g,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),Z(t)!=="svelte-15ukrgn"&&(t.innerHTML=o),n=T(g),r=u(g,"ION-LIST",{});var d=b(r);for(let m=0;m<h.length;m+=1)h[m].l(d);d.forEach(a),g.forEach(a),this.h()},h(){p(t,"slot","fixed")},m(s,g){U(s,e,g),l(e,t),i[22](t),l(e,n),l(e,r);for(let d=0;d<h.length;d+=1)h[d]&&h[d].m(r,null);E||(O=oe(t,"ionRefresh",i[10]),E=!0)},p(s,g){g[0]&299040&&(k=Ke(s[5]),h=ct(h,g,f,1,s,k,_,r,ut,an,null,xt))},d(s){s&&a(e),i[22](null);for(let g=0;g<h.length;g+=1)h[g].d();E=!1,O()}}}function on(i){let e;return{c(){e=c("span"),this.h()},l(t){e=u(t,"SPAN",{class:!0}),b(e).forEach(a),this.h()},h(){Y(e,"class","notes svelte-egzizz")},m(t,o){U(t,e,o)},d(t){t&&a(e)}}}function ln(i,e){let t,o,n,r,h=parseInt(e[34].pos)+1+"",_,E,O,k,f,s,g=e[34].title+"",d,m,v=e[34].support_list&&e[34].support_list.length||e[15](e[34]),w,y,z="",M,H,C,L,S,I=v&&on();function B(){return e[25](e[34],e[36])}return{key:i,first:null,c(){t=c("ion-item"),o=c("ion-avatar"),n=c("div"),r=c("div"),_=ce(h),O=N(),k=c("ion-label"),f=c("ion-text"),s=c("h3"),d=ce(g),m=N(),I&&I.c(),w=N(),y=c("div"),y.innerHTML=z,M=N(),H=c("ion-icon"),C=N(),this.h()},l(R){t=u(R,"ION-ITEM",{});var P=b(t);o=u(P,"ION-AVATAR",{slot:!0});var V=b(o);n=u(V,"DIV",{class:!0,title:!0,style:!0});var G=b(n);r=u(G,"DIV",{class:!0});var J=b(r);_=ue(J,h),J.forEach(a),G.forEach(a),V.forEach(a),O=T(P),k=u(P,"ION-LABEL",{button:!0});var x=b(k);f=u(x,"ION-TEXT",{color:!0});var ge=b(f);s=u(ge,"H3",{});var j=b(s);d=ue(j,g),m=T(j),I&&I.l(j),j.forEach(a),ge.forEach(a),w=T(x),y=u(x,"DIV",{class:!0,"data-svelte-h":!0}),Z(y)!=="svelte-qaecoo"&&(y.innerHTML=z),x.forEach(a),M=T(P),H=u(P,"ION-ICON",{icon:!0,slot:!0}),b(H).forEach(a),C=T(P),P.forEach(a),this.h()},h(){Y(r,"class","order svelte-egzizz"),Y(n,"class","order-wrapper svelte-egzizz"),Y(n,"title",E=tt(e[34].status)),q(n,"background-color",Ae(e[34].status)),q(n,"color",nt(Ae(e[34].status))),p(o,"slot","start"),p(f,"color","#2e2e2e"),Y(y,"class","sub svelte-egzizz"),p(k,"button",""),p(H,"icon",rt),p(H,"slot","end"),this.first=t},m(R,P){U(R,t,P),l(t,o),l(o,n),l(n,r),l(r,_),l(t,O),l(t,k),l(k,f),l(f,s),l(s,d),l(s,m),I&&I.m(s,null),l(k,w),l(k,y),l(t,M),l(t,H),l(t,C),L||(S=oe(k,"click",B),L=!0)},p(R,P){e=R,P[0]&32&&h!==(h=parseInt(e[34].pos)+1+"")&&Pe(_,h),P[0]&32&&E!==(E=tt(e[34].status))&&Y(n,"title",E),P[0]&32&&q(n,"background-color",Ae(e[34].status)),P[0]&32&&q(n,"color",nt(Ae(e[34].status))),P[0]&32&&g!==(g=e[34].title+"")&&Pe(d,g),P[0]&32&&(v=e[34].support_list&&e[34].support_list.length||e[15](e[34])),v?I||(I=on(),I.c(),I.m(s,null)):I&&(I.d(1),I=null)},d(R){R&&a(t),I&&I.d(),L=!1,S()}}}function rn(i){let e;return{c(){e=c("span"),this.h()},l(t){e=u(t,"SPAN",{class:!0}),b(e).forEach(a),this.h()},h(){Y(e,"class","notes svelte-egzizz")},m(t,o){U(t,e,o)},d(t){t&&a(e)}}}function an(i,e){let t,o,n,r,h=parseInt(e[34].pos)+1+"",_,E,O,k,f,s,g=e[34].title+"",d,m,v=e[34].support_list&&e[34].support_list.length||e[15](e[34]),w,y,z="",M,H,C,L,S,I=v&&rn();function B(){return e[23](e[34],e[36])}return{key:i,first:null,c(){t=c("ion-item"),o=c("ion-avatar"),n=c("div"),r=c("div"),_=ce(h),O=N(),k=c("ion-label"),f=c("ion-text"),s=c("h3"),d=ce(g),m=N(),I&&I.c(),w=N(),y=c("div"),y.innerHTML=z,M=N(),H=c("ion-icon"),C=N(),this.h()},l(R){t=u(R,"ION-ITEM",{});var P=b(t);o=u(P,"ION-AVATAR",{slot:!0});var V=b(o);n=u(V,"DIV",{class:!0,title:!0,style:!0});var G=b(n);r=u(G,"DIV",{class:!0});var J=b(r);_=ue(J,h),J.forEach(a),G.forEach(a),V.forEach(a),O=T(P),k=u(P,"ION-LABEL",{button:!0});var x=b(k);f=u(x,"ION-TEXT",{color:!0});var ge=b(f);s=u(ge,"H3",{});var j=b(s);d=ue(j,g),m=T(j),I&&I.l(j),j.forEach(a),ge.forEach(a),w=T(x),y=u(x,"DIV",{class:!0,"data-svelte-h":!0}),Z(y)!=="svelte-qaecoo"&&(y.innerHTML=z),x.forEach(a),M=T(P),H=u(P,"ION-ICON",{icon:!0,slot:!0}),b(H).forEach(a),C=T(P),P.forEach(a),this.h()},h(){Y(r,"class","order svelte-egzizz"),Y(n,"class","order-wrapper svelte-egzizz"),Y(n,"title",E=tt(e[34].status)),q(n,"background-color",Ae(e[34].status)),q(n,"color",nt(Ae(e[34].status))),p(o,"slot","start"),p(f,"color","#2e2e2e"),Y(y,"class","sub svelte-egzizz"),p(k,"button",""),p(H,"icon",rt),p(H,"slot","end"),this.first=t},m(R,P){U(R,t,P),l(t,o),l(o,n),l(n,r),l(r,_),l(t,O),l(t,k),l(k,f),l(f,s),l(s,d),l(s,m),I&&I.m(s,null),l(k,w),l(k,y),l(t,M),l(t,H),l(t,C),L||(S=oe(k,"click",B),L=!0)},p(R,P){e=R,P[0]&32&&h!==(h=parseInt(e[34].pos)+1+"")&&Pe(_,h),P[0]&32&&E!==(E=tt(e[34].status))&&Y(n,"title",E),P[0]&32&&q(n,"background-color",Ae(e[34].status)),P[0]&32&&q(n,"color",nt(Ae(e[34].status))),P[0]&32&&g!==(g=e[34].title+"")&&Pe(d,g),P[0]&32&&(v=e[34].support_list&&e[34].support_list.length||e[15](e[34])),v?I||(I=rn(),I.c(),I.m(s,null)):I&&(I.d(1),I=null)},d(R){R&&a(t),I&&I.d(),L=!1,S()}}}function No(i){let e,t,o,n,r=`<ion-icon icon="${An}"></ion-icon>`,h,_,E,O=`<ion-icon icon="${Bn}"></ion-icon>`,k,f,s=(i[6].name?i[6].name.toUpperCase():"")+"",g,d,m,v='<ion-segment-button value="list"><ion-label>Paradas</ion-label></ion-segment-button> <ion-segment-button value="map"><ion-label>Mapa</ion-label></ion-segment-button>',w,y,z,M;function H(S,I){if(S[9]==="list")return bo;if(S[9]==="map")return go}let C=H(i),L=C&&C(i);return{c(){e=c("ion-header"),t=c("ion-toolbar"),o=c("ion-buttons"),n=c("ion-button"),n.innerHTML=r,h=N(),_=c("ion-buttons"),E=c("ion-button"),E.innerHTML=O,k=N(),f=c("ion-title"),g=ce(s),d=N(),m=c("ion-segment"),m.innerHTML=v,w=N(),L&&L.c(),y=He(),this.h()},l(S){e=u(S,"ION-HEADER",{translucent:!0});var I=b(e);t=u(I,"ION-TOOLBAR",{});var B=b(t);o=u(B,"ION-BUTTONS",{slot:!0});var R=b(o);n=u(R,"ION-BUTTON",{title:!0,alt:!0,"data-svelte-h":!0}),Z(n)!=="svelte-7ppz3r"&&(n.innerHTML=r),R.forEach(a),h=T(B),_=u(B,"ION-BUTTONS",{slot:!0});var P=b(_);E=u(P,"ION-BUTTON",{"data-svelte-h":!0}),Z(E)!=="svelte-nf50hj"&&(E.innerHTML=O),P.forEach(a),k=T(B),f=u(B,"ION-TITLE",{});var V=b(f);g=ue(V,s),V.forEach(a),B.forEach(a),d=T(I),m=u(I,"ION-SEGMENT",{value:!0,"data-svelte-h":!0}),Z(m)!=="svelte-lue4c9"&&(m.innerHTML=v),I.forEach(a),w=T(S),L&&L.l(S),y=He(),this.h()},h(){p(n,"title","Atrás"),p(n,"alt","Atrás"),p(o,"slot","start"),p(_,"slot","end"),p(m,"value","list"),p(e,"translucent","")},m(S,I){U(S,e,I),l(e,t),l(t,o),l(o,n),l(t,h),l(t,_),l(_,E),l(t,k),l(t,f),l(f,g),l(e,d),l(e,m),U(S,w,I),L&&L.m(S,I),U(S,y,I),z||(M=[oe(n,"click",i[16]),oe(E,"click",i[20]),oe(m,"ionChange",i[21])],z=!0)},p(S,I){I[0]&64&&s!==(s=(S[6].name?S[6].name.toUpperCase():"")+"")&&Pe(g,s),C===(C=H(S))&&L?L.p(S,I):(L&&L.d(1),L=C&&C(S),L&&(L.c(),L.m(y.parentNode,y)))},d(S){S&&(a(e),a(w),a(y)),L&&L.d(S),z=!1,We(M)}}}function To(i){let e,t,o,n=i[2]&&$t(i);return{c(){e=N(),n&&n.c(),t=He(),this.h()},l(r){pn("svelte-kn0kph",Qt.head).forEach(a),e=T(r),n&&n.l(r),t=He(),this.h()},h(){Qt.title="Rutaflow - Detalles de ruta"},m(r,h){U(r,e,h),n&&n.m(r,h),U(r,t,h),o=!0},p(r,h){r[2]?n?(n.p(r,h),h[0]&4&&mt(n,1)):(n=$t(r),n.c(),mt(n,1),n.m(t.parentNode,t)):n&&(On(),kt(n,1,1,()=>{n=null}),gn())},i(r){o||(mt(n),o=!0)},o(r){kt(n),o=!1},d(r){r&&(a(e),a(t)),n&&n.d(r)}}}function Ae(i){let e="#ffffff";return i==="pending"?e="#f2e300":i==="completed"&&(e="#44d900"),e}function tt(i){let e="";return i=="pending"?e="Pendiente":i=="completed"&&(e="Completado"),e}function nt(i){i.slice(0,1)==="#"&&(i=i.slice(1)),i.length===3&&(i=i.split("").map(function(r){return r+r}).join(""));const e=parseInt(i.substr(0,2),16),t=parseInt(i.substr(2,2),16),o=parseInt(i.substr(4,2),16);return(e*299+t*587+o*114)/1e3>=128?"#414040":"#fff"}function Co(i,e){let t=new FormData;return t.append("id_route",i),t.append("status",e),fetch("https://dev.rutaflow.com/api/admin/route/change_status.php",{method:"POST",body:t}).then(o=>o.json()).then(o=>{}).catch(o=>{console.error("Error fetching data:",o)}),""}const yo=i=>i.mandatory==="1",wo=i=>i.img;function Lo(i,e,t){let o;mn(i,Dn,A=>t(19,o=A));var n=this&&this.__awaiter||function(A,F,W,ee){function te(le){return le instanceof W?le:new W(function(ne){ne(le)})}return new(W||(W=Promise))(function(le,ne){function ie(Ne){try{Ie(ee.next(Ne))}catch(Me){ne(Me)}}function he(Ne){try{Ie(ee.throw(Ne))}catch(Me){ne(Me)}}function Ie(Ne){Ne.done?le(Ne.value):te(Ne.value).then(ie,he)}Ie((ee=ee.apply(A,F||[])).next())})};let{routeId:r}=e,{driverId:h}=e,_=new Object,E=!0,O=!1,k=[],f={},s=[],g=[],d,m=!1,v="list",w;const y=()=>n(void 0,void 0,void 0,function*(){yield M(r),d.complete()});st(()=>n(void 0,void 0,void 0,function*(){yield M(r)}));function z(A){return n(this,void 0,void 0,function*(){if(t(9,v=A),v==="map"){yield vn(),w=document.getElementById("g_map");const F=new google.maps.Map(w,{zoom:8,center:{lat:20.6745683,lng:-103.3986104},mapId:"4504f8b37365c3d0"}),W=new google.maps.LatLngBounds,{AdvancedMarkerElement:ee,PinElement:te}=yield google.maps.importLibrary("marker");navigator.geolocation?navigator.geolocation.getCurrentPosition(function(le){const ne=new google.maps.LatLng(le.coords.latitude,le.coords.longitude);new google.maps.Marker({position:ne,map:F,icon:{path:google.maps.SymbolPath.CIRCLE,fillColor:"#0062ff",fillOpacity:1,scale:6,strokeColor:"#ffffff",strokeWeight:2}}),new google.maps.Circle({strokeColor:"#00BFFF",strokeOpacity:.5,strokeWeight:1,fillColor:"#00BFFF",fillOpacity:.2,map:F,center:ne,radius:le.coords.accuracy}),W.extend(ne)},function(le){console.error("Error retrieving location:",le)}):console.error("Geolocation not supported by this browser."),k.forEach((le,ne)=>{const ie=parseFloat(le.lat),he=parseFloat(le.lon),Ie=new google.maps.LatLng(ie,he),Ne=new google.maps.Marker({position:{lat:ie,lng:he},map:F,title:le.title}),Me=new te({background:Ae(le.status),borderColor:"#000",glyphColor:"#000",glyph:(parseInt(le.pos)+1).toString()});new ee({map:F,position:Ie,content:Me.element,title:"Parada "+(parseInt(le.pos)+1).toString()+": "+le.title}).addListener("click",function(Re){C(le,P(ne))}),W.extend(Ne.getPosition())}),F.fitBounds(W)}})}function M(A){return n(this,void 0,void 0,function*(){const F=new FormData;F.append("id_route",A);try{const ee=yield(yield fetch("https://dev.rutaflow.com/api/admin/report/seguimiento_list.php",{method:"POST",body:F})).json();t(6,f=ee.data.seguimiento_list[0]),t(5,k=ee.data.event_list),t(7,s=ee.data.checklist),g=ee.data.expenses,f&&t(4,O=f.km_inicial=="0"&&f.gas_inicial=="0"),t(3,E=!1)}catch(W){t(3,E=!1),console.error("Error fetching data:",W)}})}const H=A=>new Promise((F,W)=>{const ee=new FormData;ee.append("id_route",A.id_route),ee.append("id_event",A.id_event),fetch("https://dev.rutaflow.com/api/admin/evidence/evidence_by_event.php",{method:"POST",body:ee}).then(te=>te.json()).then(te=>{F(te.data.event_evidence[0])}).catch(te=>{console.error("Error fetching data:",te),W(te)})}),C=(A,F)=>{H(A).then(W=>{W&&(A.img=W.img,A.driver_comments=W.driver_comments,A.comments=W.comments),Xe("modal-delivery-info",co,{delivery:A,isLast:F}).then(ee=>{}).finally(()=>{M(r)})})},L=(A,F,W)=>{var ee=!1;return m||(m=!0,Xe("modal-checklist",_n,{checklist:A,driverId:F,routeId:W,isLast:ee}).then(te=>{m=!1}),Co(W,"checklist")),""},S=A=>n(void 0,void 0,void 0,function*(){return yield M(A),g.length>0?Xe("modal-expense-detail",vo,{routeId:A,expenses:g}).then(F=>{}):Xe("modal-expense",Tt,{routeId:A}).then(F=>{}),""}),I=A=>{if(A.tracking_type=="subscription"){if(A.subscriber_info&&A.payment_type==="cash"&&new Date(A.subscriber_info.payment_next)<new Date)return!0}else if(A.tracking_type=="ecommerce"&&Number(A.payment_pending)>0)return!0;return!1},B=()=>{_.id_driver?Ye(`/drivers/${_.id_driver}`):Ye("/drivers/me")},R=(A,F)=>n(void 0,void 0,void 0,function*(){yield(yield Je.create({header:A||"Error",message:F||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()});function P(A){return A===k.length-1}const V=()=>S(r),G=A=>z(A.detail.value);function J(A){ze[A?"unshift":"push"](()=>{d=A,t(8,d)})}const x=(A,F)=>C(A,P(F));function ge(A){ze[A?"unshift":"push"](()=>{d=A,t(8,d)})}const j=(A,F)=>C(A,P(F));function Q(A){ze[A?"unshift":"push"](()=>{d=A,t(8,d)})}const X=A=>{const F=k.findIndex(ne=>ne.id_event===A.id_event),W=F===0,ee=F>0?k[F-1]:null,te=W||ee&&ee.img!==null,le=A.img!==null&&A.img!=="";te||W&&!le?C(A):R("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")};return i.$$set=A=>{"routeId"in A&&t(0,r=A.routeId),"driverId"in A&&t(1,h=A.driverId)},i.$$.update=()=>{i.$$.dirty[0]&524293&&(t(0,{routeId:r,driverId:h}=o.params,r,(t(1,h),t(19,o),t(2,_),t(0,r))),t(2,_=JSON.parse(localStorage.getItem("userSession"))),_?_.id_user&&(_.type=="admin"||_.type=="superadmin")?(M(r),Ye(`/drivers/me/routes/${r}`)):_.id_user&&_.id_driver&&(M(r),Ye(`/drivers/${_.id_driver}/routes/${r}`)):Ye("/"))},[r,h,_,E,O,k,f,s,d,v,y,z,C,L,S,I,B,R,P,o,V,G,J,x,ge,j,Q,X]}class Ho extends lt{constructor(e){super(),it(this,e,Lo,To,ot,{routeId:0,driverId:1},null,[-1,-1])}}export{Ho as component};

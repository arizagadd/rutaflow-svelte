import{Z as dt,s as We,e as s,j as y,b as c,q as m,d as te,h as a,m as w,v,i as Q,w as o,x as ue,n as ze,z as Pe,_ as xt,B as O,o as Ze,k as Se,$ as _t,t as ve,r as ge,f as J,a0 as $t,a1 as Qe,A as Me,y as Le,a2 as en,a3 as Ke,a4 as tn,a5 as nn,l as on,p as ln,F as rn}from"../chunks/index.CdEBkEwf.js";import{S as Je,i as Ye,t as it,a as st,c as an,b as sn,d as cn,m as un,e as fn,g as dn}from"../chunks/index.c2pjNB5R.js";import{e as Be,u as xe,d as $e,a as _n,b as hn,c as pn,i as Wt,f as mn,g as Jt,h as vn,j as ct,k as gn,m as Yt,s as ht,n as Re,o as bn,q as En,t as In,r as kn,v as On,w as Nn,x as Tn,y as Cn,p as yn}from"../chunks/index.DgNUlIgc.js";import"../chunks/index-48209844.IIRtDZyg.js";import{m as et,D as rt,a as je,I as wn}from"../chunks/IonPage.xNVbkhx8.js";import{q as Ln,t as zn}from"../chunks/ion-modal.CsJaVgKZ.js";import{g as Fe}from"../chunks/entry.D4Gmz6gh.js";const An=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global,Sn=(r,e)=>{if(!customElements.get(r)){class t extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const n={};for(const i of this.attributes)n[i.name]=i.value;new e({target:this.shadowRoot,props:n})}}customElements.define(r,t)}},Mn=function(r){return document.createElement(r).constructor!==HTMLElement},Dn=(r,e)=>{Mn(r)||Sn(r,e)},Ue=async(r,e,t)=>{Ln(),zn(),Dn(r,e);const l=await et.create({component:r,componentProps:t});return l.present(),await l.onWillDismiss()};let Ge=dt({km_inicial:[],gas_inicial:[],km_final:[],gas_final:[]}),Qt=dt({flag:[]});function Pn(r){let e,t,l,n,i="Cancelar",d,u,_="Captura de Km/Gas",T,g,h,f="Confirmar",p,b,N,C,U,A,q;return{c(){e=s("ion-header"),t=s("ion-toolbar"),l=s("ion-buttons"),n=s("ion-button"),n.textContent=i,d=y(),u=s("ion-title"),u.textContent=_,T=y(),g=s("ion-buttons"),h=s("ion-button"),h.textContent=f,p=y(),b=s("ion-content"),N=s("ion-item"),C=s("ion-input"),this.h()},l(X){e=c(X,"ION-HEADER",{translucent:!0});var j=m(e);t=c(j,"ION-TOOLBAR",{});var M=m(t);l=c(M,"ION-BUTTONS",{slot:!0});var B=m(l);n=c(B,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),te(n)!=="svelte-17pq4f4"&&(n.textContent=i),B.forEach(a),d=w(M),u=c(M,"ION-TITLE",{"data-svelte-h":!0}),te(u)!=="svelte-1yhkaq7"&&(u.textContent=_),T=w(M),g=c(M,"ION-BUTTONS",{slot:!0});var I=m(g);h=c(I,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),te(h)!=="svelte-cm6j4s"&&(h.textContent=f),I.forEach(a),M.forEach(a),j.forEach(a),p=w(X),b=c(X,"ION-CONTENT",{fullscreen:!0});var S=m(b);N=c(S,"ION-ITEM",{});var H=m(N);C=c(H,"ION-INPUT",{class:!0,inputmode:!0,pattern:!0,type:!0,placeholder:!0,value:!0,required:!0});var P=m(C);P.forEach(a),H.forEach(a),S.forEach(a),this.h()},h(){v(n,"color","medium"),v(l,"slot","start"),v(h,"strong",""),v(g,"slot","end"),v(e,"translucent",""),v(C,"class","fin-km"),v(C,"inputmode","numeric"),v(C,"pattern","[0-9]*"),v(C,"type","number"),v(C,"placeholder",U="Ingresa "+r[0]+" actual"),v(C,"value",r[1]),v(C,"required",""),v(b,"fullscreen","")},m(X,j){Q(X,e,j),o(e,t),o(t,l),o(l,n),o(t,d),o(t,u),o(t,T),o(t,g),o(g,h),Q(X,p,j),Q(X,b,j),o(b,N),o(N,C),A||(q=[ue(n,"click",r[2]),ue(h,"click",r[3]),ue(C,"input",r[4])],A=!0)},p(X,[j]){j&1&&U!==(U="Ingresa "+X[0]+" actual")&&v(C,"placeholder",U),j&2&&v(C,"value",X[1])},i:ze,o:ze,d(X){X&&(a(e),a(p),a(b)),A=!1,Pe(q)}}}function Hn(r,e,t){const l=xt();let i=document.querySelector("ion-modal").componentProps.data_type,d;Qt.subscribe(h=>{i=h.flag[0],i=="km_final"||i=="km_inicial"?t(0,d="kilometraje"):t(0,d="litros de gasolina")});let u=0;function _(){et.dismiss()}function T(){l("modalResult",{data:"Your data",role:"confirm"}),i=="km_inicial"?Ge.update(f=>({...f,km_inicial:[u]})):i=="gas_inicial"?Ge.update(f=>({...f,gas_inicial:[u]})):i=="km_final"?Ge.update(f=>({...f,km_final:[u]})):i=="gas_final"&&Ge.update(f=>({...f,gas_final:[u]})),_()}return[d,u,_,T,h=>t(1,u=h.target.value)]}class Bn extends Je{constructor(e){super(),Ye(this,e,Hn,Pn,We,{})}}const at=dt({items:[],checkedIndices:[],mandatory:[]});function vt(r,e,t){const l=r.slice();return l[55]=e[t],l[56]=e,l[57]=t,l}function Rn(r){let e,t,l,n,i,d="Kilometraje inicial",u,_,T=r[0]?r[0]+" km.":"Cargar km",g,h,f,p,b,N,C,U="Gasolina inicial (litros)",A,q,X=r[1]?r[1]+" litros":"Cargar gas",j,M,B,I;return M=_t(r[21][0]),{c(){e=s("ion-item"),t=s("ion-label"),l=s("input"),n=y(),i=s("p"),i.textContent=d,u=y(),_=s("ion-button"),g=ve(T),h=y(),f=s("ion-item"),p=s("ion-label"),b=s("input"),N=y(),C=s("p"),C.textContent=U,A=y(),q=s("ion-button"),j=ve(X),this.h()},l(S){e=c(S,"ION-ITEM",{});var H=m(e);t=c(H,"ION-LABEL",{style:!0});var P=m(t);l=c(P,"INPUT",{id:!0,style:!0,type:!0}),n=w(P),i=c(P,"P",{style:!0,"data-svelte-h":!0}),te(i)!=="svelte-88twxi"&&(i.textContent=d),P.forEach(a),u=w(H),_=c(H,"ION-BUTTON",{fill:!0,size:!0,class:!0,"aria-selected":!0});var R=m(_);g=ge(R,T),R.forEach(a),H.forEach(a),h=w(S),f=c(S,"ION-ITEM",{});var G=m(f);p=c(G,"ION-LABEL",{style:!0});var K=m(p);b=c(K,"INPUT",{id:!0,style:!0,type:!0}),N=w(K),C=c(K,"P",{style:!0,"data-svelte-h":!0}),te(C)!=="svelte-1ux30eb"&&(C.textContent=U),K.forEach(a),A=w(G),q=c(G,"ION-BUTTON",{fill:!0,class:!0,size:!0,style:!0});var $=m(q);j=ge($,X),$.forEach(a),G.forEach(a),this.h()},h(){J(l,"id","chkbox-km-ini"),O(l,"pointer-events","auto"),J(l,"type","checkbox"),l.required=!0,O(i,"margin-left","10px"),O(t,"display","flex"),v(_,"fill","outline"),v(_,"size","small"),v(_,"class","loadKmInicial"),v(_,"aria-selected",""),J(b,"id","chkbox-gas-ini"),O(b,"pointer-events","auto"),J(b,"type","checkbox"),b.required=!0,O(C,"margin-left","10px"),O(p,"display","flex"),v(q,"fill","outline"),v(q,"class","loadGasInicial"),v(q,"size","small"),O(q,"height","16px "),M.p(l,b)},m(S,H){Q(S,e,H),o(e,t),o(t,l),l.checked=~(r[4]||[]).indexOf(l.__value),r[28](l),o(t,n),o(t,i),o(e,u),o(e,_),o(_,g),Q(S,h,H),Q(S,f,H),o(f,p),o(p,b),r[30](b),b.checked=~(r[4]||[]).indexOf(b.__value),o(p,N),o(p,C),o(f,A),o(f,q),o(q,j),B||(I=[ue(l,"change",r[27]),ue(_,"click",r[29]),ue(b,"change",r[31]),ue(q,"click",r[32])],B=!0)},p(S,H){H[0]&16&&(l.checked=~(S[4]||[]).indexOf(l.__value)),H[0]&1&&T!==(T=S[0]?S[0]+" km.":"Cargar km")&&Le(g,T),H[0]&16&&(b.checked=~(S[4]||[]).indexOf(b.__value)),H[0]&2&&X!==(X=S[1]?S[1]+" litros":"Cargar gas")&&Le(j,X)},d(S){S&&(a(e),a(h),a(f)),r[28](null),r[30](null),M.r(),B=!1,Pe(I)}}}function Un(r){let e,t,l,n,i,d="Kilometraje final",u,_,T=r[2]?r[2]+" km.":"Cargar km",g,h,f,p,b,N,C,U="Gasolina final (litros)",A,q,X=r[3]?r[3]+" litros":"Cargar gas",j,M,B,I;return M=_t(r[21][0]),{c(){e=s("ion-item"),t=s("ion-label"),l=s("input"),n=y(),i=s("p"),i.textContent=d,u=y(),_=s("ion-button"),g=ve(T),h=y(),f=s("ion-item"),p=s("ion-label"),b=s("input"),N=y(),C=s("p"),C.textContent=U,A=y(),q=s("ion-button"),j=ve(X),this.h()},l(S){e=c(S,"ION-ITEM",{});var H=m(e);t=c(H,"ION-LABEL",{style:!0});var P=m(t);l=c(P,"INPUT",{id:!0,style:!0,type:!0}),n=w(P),i=c(P,"P",{style:!0,"data-svelte-h":!0}),te(i)!=="svelte-ccmu71"&&(i.textContent=d),P.forEach(a),u=w(H),_=c(H,"ION-BUTTON",{fill:!0,size:!0,class:!0,"aria-selected":!0});var R=m(_);g=ge(R,T),R.forEach(a),H.forEach(a),h=w(S),f=c(S,"ION-ITEM",{});var G=m(f);p=c(G,"ION-LABEL",{style:!0});var K=m(p);b=c(K,"INPUT",{id:!0,style:!0,type:!0}),N=w(K),C=c(K,"P",{style:!0,"data-svelte-h":!0}),te(C)!=="svelte-wsoyd2"&&(C.textContent=U),K.forEach(a),A=w(G),q=c(G,"ION-BUTTON",{fill:!0,size:!0,class:!0});var $=m(q);j=ge($,X),$.forEach(a),G.forEach(a),this.h()},h(){J(l,"id","chkbox-km-fin"),O(l,"pointer-events","auto"),J(l,"type","checkbox"),l.required=!0,O(i,"margin-left","10px"),O(t,"display","flex"),v(_,"fill","outline"),v(_,"size","small"),v(_,"class","loadKmInicial"),v(_,"aria-selected",""),J(b,"id","chkbox-gas-fin"),O(b,"pointer-events","auto"),J(b,"type","checkbox"),b.required=!0,O(C,"margin-left","10px"),O(p,"display","flex"),v(q,"fill","outline"),v(q,"size","small"),v(q,"class","loadGasInicial"),M.p(l,b)},m(S,H){Q(S,e,H),o(e,t),o(t,l),l.checked=~(r[4]||[]).indexOf(l.__value),r[22](l),o(t,n),o(t,i),o(e,u),o(e,_),o(_,g),Q(S,h,H),Q(S,f,H),o(f,p),o(p,b),b.checked=~(r[4]||[]).indexOf(b.__value),r[25](b),o(p,N),o(p,C),o(f,A),o(f,q),o(q,j),B||(I=[ue(l,"change",r[20]),ue(_,"click",r[23]),ue(b,"change",r[24]),ue(q,"click",r[26])],B=!0)},p(S,H){H[0]&16&&(l.checked=~(S[4]||[]).indexOf(l.__value)),H[0]&4&&T!==(T=S[2]?S[2]+" km.":"Cargar km")&&Le(g,T),H[0]&16&&(b.checked=~(S[4]||[]).indexOf(b.__value)),H[0]&8&&X!==(X=S[3]?S[3]+" litros":"Cargar gas")&&Le(j,X)},d(S){S&&(a(e),a(h),a(f)),r[22](null),r[25](null),M.r(),B=!1,Pe(I)}}}function Vn(r){let e=[],t=new Map,l,n=Be(r[13]);const i=d=>d[55].id_checklist_event;for(let d=0;d<n.length;d+=1){let u=vt(r,n,d),_=i(u);t.set(_,e[d]=gt(_,u))}return{c(){for(let d=0;d<e.length;d+=1)e[d].c();l=Se()},l(d){for(let u=0;u<e.length;u+=1)e[u].l(d);l=Se()},m(d,u){for(let _=0;_<e.length;_+=1)e[_]&&e[_].m(d,u);Q(d,l,u)},p(d,u){u[0]&407664&&(n=Be(d[13]),e=xe(e,u,i,1,d,n,t,l.parentNode,$e,gt,l,vt))},d(d){d&&a(l);for(let u=0;u<e.length;u+=1)e[u].d(d)}}}function Fn(r){let e,t=(r[12][r[55].id_checklist_event]?r[12][r[55].id_checklist_event]:"Cargar evidencia")+"",l;return{c(){e=s("label"),l=ve(t),this.h()},l(n){e=c(n,"LABEL",{for:!0,class:!0});var i=m(e);l=ge(i,t),i.forEach(a),this.h()},h(){J(e,"for","chklist-"+r[55].id_checklist_event),J(e,"class","button-label svelte-1ruehls")},m(n,i){Q(n,e,i),o(e,l)},p(n,i){i[0]&4096&&t!==(t=(n[12][n[55].id_checklist_event]?n[12][n[55].id_checklist_event]:"Cargar evidencia")+"")&&Le(l,t)},d(n){n&&a(e)}}}function jn(r){let e;return{c(){e=s("ion-spinner"),this.h()},l(t){e=c(t,"ION-SPINNER",{name:!0,class:!0}),m(e).forEach(a),this.h()},h(){v(e,"name","dots"),v(e,"class","button-spinner svelte-1ruehls")},m(t,l){Q(t,e,l)},p:ze,d(t){t&&a(e)}}}function gt(r,e){let t,l,n,i=e[55],d,u,_=e[55].item+"",T,g,h,f=e[55].mandatory=="1"?" * ":"",p,b,N,C,U,A,q,X,j,M;const B=()=>e[34](n,i),I=()=>e[34](null,i);function S(){return e[35](e[55])}function H(K,$){return K[11][K[55].id_checklist_event]?jn:Fn}let P=H(e),R=P(e);function G(...K){return e[37](e[55],...K)}return X=_t(e[21][0]),{key:r,first:null,c(){t=s("ion-item"),l=s("ion-label"),n=s("input"),d=y(),u=s("p"),T=ve(_),g=y(),h=s("b"),p=ve(f),b=y(),N=s("ion-button"),C=s("div"),R.c(),U=y(),A=s("input"),q=y(),this.h()},l(K){t=c(K,"ION-ITEM",{});var $=m(t);l=c($,"ION-LABEL",{style:!0});var oe=m(l);n=c(oe,"INPUT",{id:!0,style:!0,type:!0}),d=w(oe),u=c(oe,"P",{style:!0});var le=m(u);T=ge(le,_),g=w(le),le.forEach(a),h=c(oe,"B",{style:!0});var fe=m(h);p=ge(fe,f),fe.forEach(a),oe.forEach(a),b=w($),N=c($,"ION-BUTTON",{fill:!0,class:!0,size:!0});var se=m(N);C=c(se,"DIV",{class:!0});var ae=m(C);R.l(ae),U=w(ae),A=c(ae,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0,capture:!0}),ae.forEach(a),se.forEach(a),q=w($),$.forEach(a),this.h()},h(){J(n,"id",`chkbox-${e[55].id_checklist_event}`),O(n,"pointer-events","auto"),J(n,"type","checkbox"),n.__value=e[55].id_checklist_event,$t(n,n.__value),n.required=!0,O(u,"margin-left","10px"),O(h,"margin-left","5px"),O(l,"display","flex"),O(A,"display","none"),J(A,"id","chklist-"+e[55].id_checklist_event),J(A,"name","fileToUpload"),J(A,"type","file"),J(A,"accept","image/*"),J(A,"capture","environment"),J(C,"class","button-content svelte-1ruehls"),v(N,"fill","outline"),v(N,"class","loadEvidence svelte-1ruehls"),v(N,"size","small"),X.p(n),this.first=t},m(K,$){Q(K,t,$),o(t,l),o(l,n),n.checked=~(e[4]||[]).indexOf(n.__value),B(),o(l,d),o(l,u),o(u,T),o(u,g),o(l,h),o(h,p),o(t,b),o(t,N),o(N,C),R.m(C,null),o(C,U),o(C,A),e[36](A),o(t,q),j||(M=[ue(n,"change",e[33]),ue(n,"change",S),ue(A,"change",G)],j=!0)},p(K,$){e=K,$[0]&16&&(n.checked=~(e[4]||[]).indexOf(n.__value)),i!==e[55]&&(I(),i=e[55],B()),P===(P=H(e))&&R?R.p(e,$):(R.d(1),R=P(e),R&&(R.c(),R.m(C,U)))},d(K){K&&a(t),I(),R.d(),e[36](null),X.r(),j=!1,Pe(M)}}}function qn(r){let e,t,l,n,i="Cancelar",d,u,_="REQUERIMIENTOS DE RUTA",T,g,h,f,p,b,N,C="Confirmar",U,A;function q(B,I){return B[14]?Un:Rn}let j=q(r)(r),M=r[13]&&Vn(r);return{c(){e=s("ion-header"),t=s("ion-toolbar"),l=s("ion-buttons"),n=s("ion-button"),n.textContent=i,d=y(),u=s("ion-title"),u.textContent=_,T=y(),g=s("ion-content"),h=s("ion-list"),j.c(),f=y(),M&&M.c(),p=y(),b=s("ion-footer"),N=s("ion-button"),N.textContent=C,this.h()},l(B){e=c(B,"ION-HEADER",{translucent:!0});var I=m(e);t=c(I,"ION-TOOLBAR",{});var S=m(t);l=c(S,"ION-BUTTONS",{slot:!0});var H=m(l);n=c(H,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),te(n)!=="svelte-1dnmkxs"&&(n.textContent=i),H.forEach(a),d=w(S),u=c(S,"ION-TITLE",{"data-svelte-h":!0}),te(u)!=="svelte-19bar5p"&&(u.textContent=_),S.forEach(a),I.forEach(a),T=w(B),g=c(B,"ION-CONTENT",{fullscreen:!0});var P=m(g);h=c(P,"ION-LIST",{});var R=m(h);j.l(R),f=w(R),M&&M.l(R),R.forEach(a),P.forEach(a),p=w(B),b=c(B,"ION-FOOTER",{});var G=m(b);N=c(G,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),te(N)!=="svelte-g82qqw"&&(N.textContent=C),G.forEach(a),this.h()},h(){v(n,"color","medium"),v(l,"slot","start"),v(e,"translucent",""),v(g,"fullscreen",""),v(N,"fill","outline"),v(N,"color","tertiary"),v(N,"strong",""),O(N,"width","99%"),O(N,"height","auto")},m(B,I){Q(B,e,I),o(e,t),o(t,l),o(l,n),o(t,d),o(t,u),Q(B,T,I),Q(B,g,I),o(g,h),j.m(h,null),o(h,f),M&&M.m(h,null),Q(B,p,I),Q(B,b,I),o(b,N),U||(A=[ue(n,"click",r[15]),ue(N,"click",r[16])],U=!0)},p(B,I){j.p(B,I),B[13]&&M.p(B,I)},i:ze,o:ze,d(B){B&&(a(e),a(T),a(g),a(p),a(b)),j.d(),M&&M.d(),U=!1,Pe(A)}}}function ut(r,e){if(typeof r=="object"&&r!==null||Array.isArray(r)){if(Array.isArray(r))return r.map(t=>ut(t,e)).flat();{const t=Object.keys(r);let l;return e=="id_checklist_event"?l=t.filter(i=>i.toLowerCase().includes("id_checklist_event")).map(i=>r[i]):e=="mandatory"?l=t.filter(i=>i.toLowerCase().includes("mandatory")).map(i=>r[i]):(console.error("Tipo de dato no reconocido."),l=!1),l}}else return console.error("Invalid input. Please provide a valid object or array."),[]}function Gn(r,e,t){let l=rt,n=document.querySelector("ion-modal");const i=n.componentProps.checklist,d=n.componentProps.driverId,u=n.componentProps.routeId,_=n.componentProps.isLast;let T,g,h,f,p=[],b=null,N={},C,U,A,q,X={},j=new Object,M={},B={};Ze(()=>{j=JSON.parse(localStorage.getItem("userSession")),_?console.log("Último checklist"):at.update(E=>(E.mandatory=ut(i,"mandatory"),E.items=ut(i,"id_checklist_event"),E))});function I(E){t(11,X[E]=!0,X)}const S=async()=>{await(await je.create({header:"Datos o checklist incompletos",message:"Carga la evidencia requerida y marca todas las casillas para confirmar",buttons:[{text:"Cerrar"}]})).present()},H=async()=>{await(await je.create({header:"Datos capturados",message:"El kilometraje y gasolina final fueron registrados correctamente, espere aprobación para finalizar ruta",buttons:[{text:"Cerrar"}]})).present()},P=async E=>{await(await je.create({header:"Datos inválidos",message:E=="km"?"Llena correctamente el campo de kilometraje inicial":"Llena correctamente el campo de gasolina inicial",buttons:[{text:"Cerrar"}]})).present()},R=()=>{et.dismiss(),d?Fe(`/drivers/${d}`):Fe("/drivers/me")},G=()=>{if(_){var E=fe(h,"km"),V=fe(f,"gas");let ne=new FormData;ne.append("km_final",E),ne.append("gas_final",V),ne.append("id_route",u),ne=de(ne),E&&V?(R(),fetch(`${l}api/admin/checklist/add_evidence.php`,{method:"POST",body:ne}).then(he=>he.json()).then(he=>{H()}).catch(he=>{console.error("Error fetching data:",he)})):S()}else{var ee=fe(T,"km"),Z=fe(g,"gas");at.update(ne=>{ne.items;const he=ne.mandatory;if(ne.items.filter((me,_e)=>ne.mandatory[_e]==="1").every(me=>ne.checkedIndices.includes(me))&&ee&&Z){R();let me=new FormData;me=de(me),me.append("km_inicial",ee),me.append("gas_inicial",Z),me.append("id_route",u);for(const _e in M)if(M.hasOwnProperty(_e)){const{img:He,img_id:qe}=M[_e];me.append(`selectedImages[${_e}][img]`,He),me.append(`selectedImages[${_e}][img_id]`,qe)}fetch(`${l}api/admin/checklist/add_evidence.php`,{method:"POST",body:me}).then(_e=>_e.json()).then(_e=>{he&&he.some(He=>He==="1")?le(u,"checklist-pending"):le(u,"enroute")}).catch(_e=>{console.error("Error fetching data:",_e)})}else if(!he&&ee&&Z){let me=new FormData;me.append("km_inicial",ee),me.append("gas_inicial",Z),me=de(me),fetch(`${l}api/admin/checklist/add_evidence.php`,{method:"POST",body:me}).then(_e=>_e.json()).then(_e=>{le(u,"enroute")}).catch(_e=>{console.error("Error fetching data:",_e)})}else S();return ne})}Ee()},K=async(E,V)=>{I(V);const Z=E.target.files[0],ne=await $(Z);if(ne){let he=new FormData;he.append("fileToUpload",ne),he=de(he);try{const ce=await fetch(`${l}api/admin/manager/upload_img_driver.php`,{method:"POST",body:he});if(ce.ok){const Ce=await ce.json();M={...M,[V]:{img:Ce.img,img_id:Ce.img_id}},t(12,B={...B,[V]:Ce.filename}),oe(V),t(6,N[V].checked=!0,N),t(11,X[V]=!1,X)}else console.error("File upload failed:",ce.statusText)}catch(ce){console.error("Error during file upload:",ce)}}},$=async E=>new Promise(V=>{const ee=new Image;ee.src=URL.createObjectURL(E),ee.onload=()=>{const Z=document.createElement("canvas"),ne=Z.getContext("2d"),he=800,ce=600;let Ce=ee.width,me=ee.height;Ce>he&&(me*=he/Ce,Ce=he),me>ce&&(Ce*=ce/me,me=ce),Z.width=Ce,Z.height=me,ne.drawImage(ee,0,0,Ce,me),Z.toBlob(_e=>{V(_e),URL.revokeObjectURL(ee.src),ne.clearRect(0,0,Z.width,Z.height)},"image/jpeg",.7)}}),oe=E=>{at.update(V=>(V.checkedIndices.indexOf(E)===-1?V.checkedIndices.push(E):console.error(`ID ${E} is already checked.`),V.items.forEach(Z=>{Z.id_checklist_event===E&&(Z.checked=!0)}),V))};function le(E,V){let ee=new FormData;ee.append("id_route",E),ee.append("status",V),ee=de(ee),fetch(`${l}api/admin/route/change_status.php`,{method:"POST",body:ee}).then(Z=>Z.json()).then(Z=>{}).catch(Z=>{console.error("Error fetching data:",Z)})}function fe(E,V){return/^\d+$/.test(E)?parseInt(E,10):(P(V),null)}function se(E,V){ae(V),n.componentProps.data_type=V,Ue("modal-gas-km",Bn,{r:V}).then(()=>{Ge.subscribe(ee=>{Ne(ee,V)})})}function ae(E){Qt.update(V=>({...V,flag:[E]}))}function Ne(E,V){t(0,T=E.km_inicial?E.km_inicial:null),t(1,g=E.gas_inicial?E.gas_inicial:null),t(2,h=E.km_final?E.km_final:null),t(3,f=E.gas_final?E.gas_final:null),V=="km_inicial"&&C&&t(7,C.checked=!0,C),V=="gas_inicial"&&U&&t(8,U.checked=!0,U),V=="km_final"&&A&&t(9,A.checked=!0,A),V=="gas_final"&&q&&t(10,q.checked=!0,q)}function Ee(){Ge.set({km_inicial:[],gas_inicial:[],km_final:[],gas_final:[]})}function de(E){return E.append("token",j.token),E.append("id_user_over",j.id_user),E}const Ie=[[]];function Te(){p=Qe(Ie[0],this.__value,this.checked),t(4,p)}function Oe(E){Me[E?"unshift":"push"](()=>{A=E,t(9,A)})}const ke=E=>se(E,"km_final");function pe(){p=Qe(Ie[0],this.__value,this.checked),t(4,p)}function ye(E){Me[E?"unshift":"push"](()=>{q=E,t(10,q)})}const we=E=>se(E,"gas_final");function be(){p=Qe(Ie[0],this.__value,this.checked),t(4,p)}function re(E){Me[E?"unshift":"push"](()=>{C=E,t(7,C)})}const x=E=>se(E,"km_inicial");function ie(E){Me[E?"unshift":"push"](()=>{U=E,t(8,U)})}function k(){p=Qe(Ie[0],this.__value,this.checked),t(4,p)}const L=E=>se(E,"gas_inicial");function D(){p=Qe(Ie[0],this.__value,this.checked),t(4,p)}function z(E,V){Me[E?"unshift":"push"](()=>{N[V.id_checklist_event]=E,t(6,N)})}const W=E=>oe(E.id_checklist_event);function F(E){Me[E?"unshift":"push"](()=>{b=E,t(5,b)})}return[T,g,h,f,p,b,N,C,U,A,q,X,B,i,_,R,G,K,oe,se,Te,Ie,Oe,ke,pe,ye,we,be,re,x,ie,k,L,D,z,W,F,(E,V)=>K(V,E.id_checklist_event)]}class Zt extends Je{constructor(e){super(),Ye(this,e,Gn,qn,We,{},null,[-1,-1])}}function bt(r,e,t){const l=r.slice();return l[51]=e[t],l[53]=t,l}function Kn(r){let e,t,l="Confirmar",n,i;return{c(){e=s("ion-buttons"),t=s("ion-button"),t.textContent=l,this.h()},l(d){e=c(d,"ION-BUTTONS",{slot:!0});var u=m(e);t=c(u,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),te(t)!=="svelte-1ida0il"&&(t.textContent=l),u.forEach(a),this.h()},h(){v(t,"strong",""),v(e,"slot","end")},m(d,u){Q(d,e,u),o(e,t),n||(i=ue(t,"click",r[21]),n=!0)},p:ze,d(d){d&&a(e),n=!1,i()}}}function Xn(r){let e,t,l,n,i,d="Teléfono de Negocio",u,_,T=r[12].client_phone+"",g;return{c(){e=s("ion-item"),t=s("ion-icon"),l=y(),n=s("ion-label"),i=s("p"),i.textContent=d,u=y(),_=s("h2"),g=ve(T),this.h()},l(h){e=c(h,"ION-ITEM",{href:!0});var f=m(e);t=c(f,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=w(f),n=c(f,"ION-LABEL",{class:!0});var p=m(n);i=c(p,"P",{"data-svelte-h":!0}),te(i)!=="svelte-1u5l7fz"&&(i.textContent=d),u=w(p),_=c(p,"H2",{});var b=m(_);g=ge(b,T),b.forEach(a),p.forEach(a),f.forEach(a),this.h()},h(){v(t,"icon",hn),v(t,"slot","start"),v(n,"class","ion-text-wrap"),v(e,"href","tel:"+r[12].client_phone)},m(h,f){Q(h,e,f),o(e,t),o(e,l),o(e,n),o(n,i),o(n,u),o(n,_),o(_,g)},p:ze,d(h){h&&a(e)}}}function Wn(r){let e,t,l,n,i,d="Domicilio Alternativo",u,_,T=r[12].line2+"",g,h,f;return{c(){e=s("ion-item"),t=s("ion-icon"),l=y(),n=s("ion-label"),i=s("p"),i.textContent=d,u=y(),_=s("h2"),g=ve(T),h=y(),f=s("ion-icon"),this.h()},l(p){e=c(p,"ION-ITEM",{href:!0});var b=m(e);t=c(b,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=w(b),n=c(b,"ION-LABEL",{class:!0});var N=m(n);i=c(N,"P",{"data-svelte-h":!0}),te(i)!=="svelte-1ub9uzw"&&(i.textContent=d),u=w(N),_=c(N,"H2",{});var C=m(_);g=ge(C,T),C.forEach(a),N.forEach(a),h=w(b),f=c(b,"ION-ICON",{icon:!0,slot:!0}),m(f).forEach(a),b.forEach(a),this.h()},h(){v(t,"icon",ht),v(t,"slot","start"),v(n,"class","ion-text-wrap"),v(f,"icon",Re),v(f,"slot","end"),v(e,"href","https://www.google.com/maps/searhc/?api=1&query="+r[12].line2)},m(p,b){Q(p,e,b),o(e,t),o(e,l),o(e,n),o(n,i),o(n,u),o(n,_),o(_,g),o(e,h),o(e,f)},p:ze,d(p){p&&a(e)}}}function Jn(r){let e,t,l,n,i,d="Domicilio",u,_,T=r[12].line1+"",g,h,f,p,b=r[12].line2&&r[12].line2.trim().length,N,C=b&&Yn(r);return{c(){e=s("ion-item"),t=s("ion-icon"),l=y(),n=s("ion-label"),i=s("p"),i.textContent=d,u=y(),_=s("h2"),g=ve(T),h=y(),f=s("ion-icon"),p=y(),C&&C.c(),N=Se(),this.h()},l(U){e=c(U,"ION-ITEM",{href:!0});var A=m(e);t=c(A,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=w(A),n=c(A,"ION-LABEL",{class:!0});var q=m(n);i=c(q,"P",{"data-svelte-h":!0}),te(i)!=="svelte-cbm7q1"&&(i.textContent=d),u=w(q),_=c(q,"H2",{});var X=m(_);g=ge(X,T),X.forEach(a),q.forEach(a),h=w(A),f=c(A,"ION-ICON",{icon:!0,slot:!0}),m(f).forEach(a),A.forEach(a),p=w(U),C&&C.l(U),N=Se(),this.h()},h(){v(t,"icon",ht),v(t,"slot","start"),v(n,"class","ion-text-wrap"),v(f,"icon",Re),v(f,"slot","end"),v(e,"href","https://www.google.com/maps/search/?api=1&query="+r[12].line1)},m(U,A){Q(U,e,A),o(e,t),o(e,l),o(e,n),o(n,i),o(n,u),o(n,_),o(_,g),o(e,h),o(e,f),Q(U,p,A),C&&C.m(U,A),Q(U,N,A)},p(U,A){b&&C.p(U,A)},d(U){U&&(a(e),a(p),a(N)),C&&C.d(U)}}}function Yn(r){let e,t,l,n,i,d="Domicilio Alternativo",u,_,T=r[12].line2+"",g,h,f;return{c(){e=s("ion-item"),t=s("ion-icon"),l=y(),n=s("ion-label"),i=s("p"),i.textContent=d,u=y(),_=s("h2"),g=ve(T),h=y(),f=s("ion-icon"),this.h()},l(p){e=c(p,"ION-ITEM",{href:!0});var b=m(e);t=c(b,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=w(b),n=c(b,"ION-LABEL",{class:!0});var N=m(n);i=c(N,"P",{"data-svelte-h":!0}),te(i)!=="svelte-1ub9uzw"&&(i.textContent=d),u=w(N),_=c(N,"H2",{});var C=m(_);g=ge(C,T),C.forEach(a),N.forEach(a),h=w(b),f=c(b,"ION-ICON",{icon:!0,slot:!0}),m(f).forEach(a),b.forEach(a),this.h()},h(){v(t,"icon",ht),v(t,"slot","start"),v(n,"class","ion-text-wrap"),v(f,"icon",Re),v(f,"slot","end"),v(e,"href","https://www.google.com/maps/search/?api=1&query="+r[12].line2)},m(p,b){Q(p,e,b),o(e,t),o(e,l),o(e,n),o(n,i),o(n,u),o(n,_),o(_,g),o(e,h),o(e,f)},p:ze,d(p){p&&a(e)}}}function Et(r){let e,t,l,n,i,d="Contacto del Cliente",u,_,T,g,h=r[16]&&r[16]==="1"&&Qn(r);return{c(){e=s("ion-item"),t=s("ion-icon"),l=y(),n=s("ion-label"),i=s("p"),i.textContent=d,u=y(),_=s("h2"),T=ve(r[6]),g=y(),h&&h.c(),this.h()},l(f){e=c(f,"ION-ITEM",{});var p=m(e);t=c(p,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=w(p),n=c(p,"ION-LABEL",{class:!0});var b=m(n);i=c(b,"P",{"data-svelte-h":!0}),te(i)!=="svelte-1utsyb6"&&(i.textContent=d),u=w(b),_=c(b,"H2",{});var N=m(_);T=ge(N,r[6]),N.forEach(a),b.forEach(a),g=w(p),h&&h.l(p),p.forEach(a),this.h()},h(){v(t,"icon",pn),v(t,"slot","start"),v(n,"class","ion-text-wrap")},m(f,p){Q(f,e,p),o(e,t),o(e,l),o(e,n),o(n,i),o(n,u),o(n,_),o(_,T),o(e,g),h&&h.m(e,null)},p(f,p){p[0]&64&&Le(T,f[6]),f[16]&&f[16]==="1"&&h.p(f,p)},d(f){f&&a(e),h&&h.d()}}}function Qn(r){let e,t=`<ion-icon icon="${bn}" slot="start"></ion-icon>
                        Notificar Cliente`,l,n;return{c(){e=s("ion-button"),e.innerHTML=t,this.h()},l(i){e=c(i,"ION-BUTTON",{fill:!0,style:!0,"data-svelte-h":!0}),te(e)!=="svelte-w3qtwm"&&(e.innerHTML=t),this.h()},h(){v(e,"fill","outline"),O(e,"margin-left","16px")},m(i,d){Q(i,e,d),l||(n=ue(e,"click",r[22]),l=!0)},p:ze,d(i){i&&a(e),l=!1,n()}}}function It(r){let e,t,l,n,i,d="Notas de ubicación",u,_,T;return{c(){e=s("ion-item"),t=s("ion-icon"),l=y(),n=s("ion-label"),i=s("p"),i.textContent=d,u=y(),_=s("h2"),T=ve(r[7]),this.h()},l(g){e=c(g,"ION-ITEM",{});var h=m(e);t=c(h,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=w(h),n=c(h,"ION-LABEL",{class:!0});var f=m(n);i=c(f,"P",{"data-svelte-h":!0}),te(i)!=="svelte-nhm2ft"&&(i.textContent=d),u=w(f),_=c(f,"H2",{});var p=m(_);T=ge(p,r[7]),p.forEach(a),f.forEach(a),h.forEach(a),this.h()},h(){v(t,"icon",Wt),v(t,"slot","start"),v(n,"class","ion-text-wrap")},m(g,h){Q(g,e,h),o(e,t),o(e,l),o(e,n),o(n,i),o(n,u),o(n,_),o(_,T)},p(g,h){h[0]&128&&Le(T,g[7])},d(g){g&&a(e)}}}function Zn(r){let e,t,l,n,i,d="Horarios",u,_,T=r[12].schedule+"",g;return{c(){e=s("ion-item"),t=s("ion-icon"),l=y(),n=s("ion-label"),i=s("p"),i.textContent=d,u=y(),_=s("h2"),g=ve(T),this.h()},l(h){e=c(h,"ION-ITEM",{});var f=m(e);t=c(f,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=w(f),n=c(f,"ION-LABEL",{});var p=m(n);i=c(p,"P",{"data-svelte-h":!0}),te(i)!=="svelte-11q7hm5"&&(i.textContent=d),u=w(p),_=c(p,"H2",{});var b=m(_);g=ge(b,T),b.forEach(a),p.forEach(a),f.forEach(a),this.h()},h(){v(t,"icon",mn),v(t,"slot","start")},m(h,f){Q(h,e,f),o(e,t),o(e,l),o(e,n),o(n,i),o(n,u),o(n,_),o(_,g)},p:ze,d(h){h&&a(e)}}}function xn(r){let e,t,l,n,i,d="Notas del operador",u,_,T=r[12].driver_comments+"",g;return{c(){e=s("ion-item"),t=s("ion-icon"),l=y(),n=s("ion-label"),i=s("p"),i.textContent=d,u=y(),_=s("h2"),g=ve(T),this.h()},l(h){e=c(h,"ION-ITEM",{});var f=m(e);t=c(f,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=w(f),n=c(f,"ION-LABEL",{});var p=m(n);i=c(p,"P",{"data-svelte-h":!0}),te(i)!=="svelte-1yk9qp4"&&(i.textContent=d),u=w(p),_=c(p,"H2",{});var b=m(_);g=ge(b,T),b.forEach(a),p.forEach(a),f.forEach(a),this.h()},h(){v(t,"icon",Jt),v(t,"slot","start")},m(h,f){Q(h,e,f),o(e,t),o(e,l),o(e,n),o(n,i),o(n,u),o(n,_),o(_,g)},p:ze,d(h){h&&a(e)}}}function $n(r){let e,t=r[12].logistic_comments!="<br>"&&eo(r);return{c(){t&&t.c(),e=Se()},l(l){t&&t.l(l),e=Se()},m(l,n){t&&t.m(l,n),Q(l,e,n)},p(l,n){l[12].logistic_comments!="<br>"&&t.p(l,n)},d(l){l&&a(e),t&&t.d(l)}}}function eo(r){let e,t,l,n,i,d="Comentarios logísticos",u,_,T=r[12].logistic_comments+"",g;return{c(){e=s("ion-item"),t=s("ion-icon"),l=y(),n=s("ion-label"),i=s("p"),i.textContent=d,u=y(),_=s("h2"),g=ve(T),this.h()},l(h){e=c(h,"ION-ITEM",{});var f=m(e);t=c(f,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=w(f),n=c(f,"ION-LABEL",{class:!0});var p=m(n);i=c(p,"P",{"data-svelte-h":!0}),te(i)!=="svelte-1iz85r6"&&(i.textContent=d),u=w(p),_=c(p,"H2",{});var b=m(_);g=ge(b,T),b.forEach(a),p.forEach(a),f.forEach(a),this.h()},h(){v(t,"icon",Wt),v(t,"slot","start"),v(n,"class","ion-text-wrap")},m(h,f){Q(h,e,f),o(e,t),o(e,l),o(e,n),o(n,i),o(n,u),o(n,_),o(_,g)},p:ze,d(h){h&&a(e)}}}function to(r){let e,t,l,n,i,d="Estado de entrega",u,_,T="Entregado",g,h,f="No Entregado",p,b,N="Entrega Parcial",C,U,A,q,X,j,M,B,I=r[4]===!0&&kt(r),S=(r[5]===!0||r[5]===!1&&r[4]===!1)&&Ot(r);return{c(){e=s("ion-item"),t=s("ion-icon"),l=y(),n=s("ion-select"),i=s("div"),i.textContent=d,u=y(),_=s("ion-select-option"),_.textContent=T,g=y(),h=s("ion-select-option"),h.textContent=f,p=y(),b=s("ion-select-option"),b.textContent=N,C=y(),U=s("ion-item"),A=s("ion-icon"),q=y(),X=s("ion-textarea"),j=y(),M=s("section"),I&&I.c(),B=y(),S&&S.c(),this.h()},l(H){e=c(H,"ION-ITEM",{});var P=m(e);t=c(P,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=w(P),n=c(P,"ION-SELECT",{value:!0});var R=m(n);i=c(R,"DIV",{slot:!0,"data-svelte-h":!0}),te(i)!=="svelte-1635zca"&&(i.textContent=d),u=w(R),_=c(R,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),te(_)!=="svelte-s33eln"&&(_.textContent=T),g=w(R),h=c(R,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),te(h)!=="svelte-1a859l3"&&(h.textContent=f),p=w(R),b=c(R,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),te(b)!=="svelte-1c4dcm8"&&(b.textContent=N),R.forEach(a),P.forEach(a),C=w(H),U=c(H,"ION-ITEM",{});var G=m(U);A=c(G,"ION-ICON",{icon:!0,slot:!0}),m(A).forEach(a),q=w(G),X=c(G,"ION-TEXTAREA",{label:!0,placeholder:!0}),m(X).forEach(a),G.forEach(a),j=w(H),M=c(H,"SECTION",{style:!0});var K=m(M);I&&I.l(K),B=w(K),S&&S.l(K),K.forEach(a),this.h()},h(){v(t,"icon",vn),v(t,"slot","start"),J(i,"slot","label"),v(_,"value","delivered"),v(h,"value","notdelivered"),v(b,"value","partialdeliver"),v(n,"value",r[15]?r[15]:"delivered"),v(A,"icon",ct),v(A,"slot","start"),v(X,"label","Notas"),v(X,"placeholder","Escribe aquí..."),O(M,"display","flex"),O(M,"gap","8px"),O(M,"padding","16px 16px 6px")},m(H,P){Q(H,e,P),o(e,t),o(e,l),o(e,n),o(n,i),o(n,u),o(n,_),o(n,g),o(n,h),o(n,p),o(n,b),r[29](n),Q(H,C,P),Q(H,U,P),o(U,A),o(U,q),o(U,X),r[30](X),Q(H,j,P),Q(H,M,P),I&&I.m(M,null),o(M,B),S&&S.m(M,null)},p(H,P){H[4]===!0?I?I.p(H,P):(I=kt(H),I.c(),I.m(M,B)):I&&(I.d(1),I=null),H[5]===!0||H[5]===!1&&H[4]===!1?S?S.p(H,P):(S=Ot(H),S.c(),S.m(M,null)):S&&(S.d(1),S=null)},d(H){H&&(a(e),a(C),a(U),a(j),a(M)),r[29](null),r[30](null),I&&I.d(),S&&S.d()}}}function kt(r){let e,t=`<ion-icon icon="${En}" slot="start"></ion-icon>
                        Ingreso`,l,n;return{c(){e=s("ion-button"),e.innerHTML=t,this.h()},l(i){e=c(i,"ION-BUTTON",{id:!0,style:!0,"data-svelte-h":!0}),te(e)!=="svelte-3onvnr"&&(e.innerHTML=t),this.h()},h(){v(e,"id","checkInBtn"),O(e,"flex","1")},m(i,d){Q(i,e,d),l||(n=ue(e,"click",r[23]),l=!0)},p:ze,d(i){i&&a(e),l=!1,n()}}}function Ot(r){let e,t,l,n,i,d;return{c(){e=s("ion-button"),t=s("ion-icon"),l=ve(`
                        Salida`),this.h()},l(u){e=c(u,"ION-BUTTON",{id:!0,style:!0,disabled:!0});var _=m(e);t=c(_,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=ge(_,`
                        Salida`),_.forEach(a),this.h()},h(){v(t,"icon",gn),v(t,"slot","start"),v(e,"id","checkOutBtn"),O(e,"flex","1"),v(e,"disabled",n=r[5]===!1)},m(u,_){Q(u,e,_),o(e,t),o(e,l),i||(d=ue(e,"click",r[24]),i=!0)},p(u,_){_[0]&32&&n!==(n=u[5]===!1)&&v(e,"disabled",n)},d(u){u&&a(e),i=!1,d()}}}function no(r){let e,t,l,n,i,d="Subir Evidencia",u,_,T,g;return{c(){e=s("section"),t=s("ion-button"),l=s("ion-icon"),n=y(),i=s("label"),i.textContent=d,u=y(),_=s("input"),this.h()},l(h){e=c(h,"SECTION",{style:!0});var f=m(e);t=c(f,"ION-BUTTON",{fill:!0,class:!0,style:!0});var p=m(t);l=c(p,"ION-ICON",{icon:!0,slot:!0}),m(l).forEach(a),n=w(p),i=c(p,"LABEL",{for:!0,"data-svelte-h":!0}),te(i)!=="svelte-1wg51s6"&&(i.textContent=d),u=w(p),_=c(p,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0,capture:!0}),p.forEach(a),f.forEach(a),this.h()},h(){v(l,"icon",Yt),v(l,"slot","start"),J(i,"for","eventEvidence"),O(_,"display","none"),J(_,"id","eventEvidence"),J(_,"name","fileToUpload"),J(_,"type","file"),_.multiple=!0,J(_,"accept","image/*"),J(_,"capture","environment"),v(t,"fill","outline"),v(t,"class","loadEvidence"),O(t,"flex","1"),O(e,"display","flex"),O(e,"gap","8px"),O(e,"padding","0px 16px")},m(h,f){Q(h,e,f),o(e,t),o(t,l),o(t,n),o(t,i),o(t,u),o(t,_),T||(g=[ue(_,"change",r[17]),ue(_,"click",r[18])],T=!0)},p:ze,d(h){h&&a(e),T=!1,Pe(g)}}}function Nt(r){let e,t,l=Be(r[2]),n=[];for(let i=0;i<l.length;i+=1)n[i]=Tt(bt(r,l,i));return{c(){e=s("section"),t=s("div");for(let i=0;i<n.length;i+=1)n[i].c();this.h()},l(i){e=c(i,"SECTION",{});var d=m(e);t=c(d,"DIV",{class:!0,style:!0});var u=m(t);for(let _=0;_<n.length;_+=1)n[_].l(u);u.forEach(a),d.forEach(a),this.h()},h(){J(t,"class","image-grid"),O(t,"display","grid"),O(t,"grid-template-columns","repeat(auto-fill, minmax(100px, 1fr))"),O(t,"gap","10px"),O(t,"padding","0px 10px")},m(i,d){Q(i,e,d),o(e,t);for(let u=0;u<n.length;u+=1)n[u]&&n[u].m(t,null)},p(i,d){if(d[0]&34603012){l=Be(i[2]);let u;for(u=0;u<l.length;u+=1){const _=bt(i,l,u);n[u]?n[u].p(_,d):(n[u]=Tt(_),n[u].c(),n[u].m(t,null))}for(;u<n.length;u+=1)n[u].d(1);n.length=l.length}},d(i){i&&a(e),en(n,i)}}}function Tt(r){let e,t,l,n,i,d=`<ion-icon icon="${In}"></ion-icon>`,u,_,T;function g(){return r[31](r[51])}function h(){return r[32](r[53])}return{c(){e=s("div"),t=s("ion-img"),n=y(),i=s("button"),i.innerHTML=d,u=y(),this.h()},l(f){e=c(f,"DIV",{class:!0,style:!0});var p=m(e);t=c(p,"ION-IMG",{src:!0,alt:!0,style:!0}),m(t).forEach(a),n=w(p),i=c(p,"BUTTON",{class:!0,style:!0,"data-svelte-h":!0}),te(i)!=="svelte-zguiov"&&(i.innerHTML=d),u=w(p),p.forEach(a),this.h()},h(){Ke(t.src,l=r[51])||v(t,"src",l),v(t,"alt","Evidencia fotográfica"),O(t,"width","100%"),O(t,"height","100px"),O(t,"object-fit","cover"),O(t,"cursor","pointer"),O(t,"border","1px solid #ccc"),O(t,"border-radius","4px"),O(t,"margin-top","16px"),J(i,"class","remove-button"),O(i,"position","absolute"),O(i,"top","5px"),O(i,"right","5px"),O(i,"border","none"),O(i,"cursor","pointer"),O(i,"font-size","18px"),O(i,"background","white"),O(i,"border-radius","50%"),O(i,"padding","3px 4px 0px"),O(i,"box-shadow","2px 2px 6px rgba(0, 0, 0, 0.3)"),O(i,"color","#0000008f"),J(e,"class","image-container"),O(e,"position","relative")},m(f,p){Q(f,e,p),o(e,t),o(e,n),o(e,i),o(e,u),_||(T=[ue(t,"click",g),ue(i,"click",h)],_=!0)},p(f,p){r=f,p[0]&4&&!Ke(t.src,l=r[51])&&v(t,"src",l)},d(f){f&&a(e),_=!1,Pe(T)}}}function Ct(r){let e,t='<ion-spinner name="dots" style="color:white;"></ion-spinner>';return{c(){e=s("div"),e.innerHTML=t,this.h()},l(l){e=c(l,"DIV",{class:!0,style:!0,"data-svelte-h":!0}),te(e)!=="svelte-h8s7r2"&&(e.innerHTML=t),this.h()},h(){J(e,"class","overlay"),O(e,"position","fixed"),O(e,"top","0"),O(e,"left","0"),O(e,"width","100vw"),O(e,"height","100vh"),O(e,"background","rgba(0, 0, 0, 0.5)"),O(e,"display","flex"),O(e,"align-items","center"),O(e,"justify-content","center"),O(e,"z-index","9999")},m(l,n){Q(l,e,n)},d(l){l&&a(e)}}}function yt(r){let e,t,l,n,i,d,u=`<ion-icon icon="${kn}"></ion-icon>`,_,T;return{c(){e=s("div"),t=s("div"),l=s("ion-img"),i=y(),d=s("button"),d.innerHTML=u,this.h()},l(g){e=c(g,"DIV",{class:!0,style:!0});var h=m(e);t=c(h,"DIV",{class:!0,style:!0});var f=m(t);l=c(f,"ION-IMG",{src:!0,alt:!0,style:!0}),m(l).forEach(a),i=w(f),d=c(f,"BUTTON",{class:!0,style:!0,"data-svelte-h":!0}),te(d)!=="svelte-g0qr0o"&&(d.innerHTML=u),f.forEach(a),h.forEach(a),this.h()},h(){Ke(l.src,n=r[10])||v(l,"src",n),v(l,"alt","Evidencia fotográfica"),O(l,"width","100%"),O(l,"height","auto"),J(d,"class","close-button"),O(d,"position","absolute"),O(d,"top","5px"),O(d,"right","5px"),O(d,"background","white"),O(d,"color","#444444d1"),O(d,"border","none"),O(d,"cursor","pointer"),O(d,"padding","2px 2px 0px 6px"),O(d,"border-radius","50%"),O(d,"font-size","20px"),J(t,"class","modal-content"),O(t,"position","relative"),O(t,"background","white"),O(t,"padding","20px"),O(t,"border-radius","8px"),O(t,"max-width","90vw"),O(t,"max-height","90vh"),O(t,"overflow","auto"),J(e,"class","modal-overlay"),O(e,"position","fixed"),O(e,"top","0"),O(e,"left","0"),O(e,"width","100vw"),O(e,"height","100vh"),O(e,"background","rgba(0, 0, 0, 0.8)"),O(e,"display","flex"),O(e,"justify-content","center"),O(e,"align-items","center"),O(e,"z-index","1000")},m(g,h){Q(g,e,h),o(e,t),o(t,l),o(t,i),o(t,d),_||(T=[ue(d,"click",r[26]),ue(t,"click",tn(r[27])),ue(e,"click",r[26])],_=!0)},p(g,h){h[0]&1024&&!Ke(l.src,n=g[10])&&v(l,"src",n)},d(g){g&&a(e),_=!1,Pe(T)}}}function oo(r){let e,t,l,n,i="Cerrar",d,u,_=r[12].title+"",T,g,h,f,p,b,N,C,U,A,q="Negocio",X,j,M=r[12].client_name+"",B,I,S=r[12].client_phone&&r[12].client_phone.trim().length,H,P,R,G,K=r[12].schedule&&r[12].schedule.trim().length,$,oe,le=r[12].logistic_comments&&r[12].logistic_comments.trim().length,fe,se,ae,Ne,Ee,de,Ie,Te,Oe,ke=(!r[13]&&!r[14]||r[13]&&r[14])&&Kn(r),pe=S&&Xn(r);function ye(E,V){if(E[12].line1&&E[12].line1.trim().length)return Jn;if(E[12].line2&&E[12].line2.trim().length)return Wn}let we=ye(r),be=we&&we(r),re=r[6]&&Et(r),x=r[7]&&r[7]!=="<br>"&&It(r),ie=K&&Zn(r),k=r[12].driver_comments&&xn(r),L=le&&$n(r),D=!r[14]&&to(r),z=(r[13]&&r[14]||!r[13]&&!r[14])&&no(r),W=r[1]&&Nt(r),F=r[3]&&Ct(),Y=r[9]&&yt(r);return{c(){e=s("ion-header"),t=s("ion-toolbar"),l=s("ion-buttons"),n=s("ion-button"),n.textContent=i,d=y(),u=s("ion-title"),T=ve(_),g=y(),ke&&ke.c(),h=y(),f=s("ion-content"),p=s("ion-list"),b=s("ion-item"),N=s("ion-icon"),C=y(),U=s("ion-label"),A=s("p"),A.textContent=q,X=y(),j=s("h2"),B=ve(M),I=y(),pe&&pe.c(),H=y(),be&&be.c(),P=y(),re&&re.c(),R=y(),x&&x.c(),G=y(),ie&&ie.c(),$=y(),k&&k.c(),oe=y(),L&&L.c(),fe=y(),se=y(),D&&D.c(),ae=y(),z&&z.c(),Ne=y(),W&&W.c(),Ee=y(),F&&F.c(),de=y(),Y&&Y.c(),Ie=Se(),this.h()},l(E){e=c(E,"ION-HEADER",{translucent:!0});var V=m(e);t=c(V,"ION-TOOLBAR",{});var ee=m(t);l=c(ee,"ION-BUTTONS",{slot:!0});var Z=m(l);n=c(Z,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),te(n)!=="svelte-2ks32x"&&(n.textContent=i),Z.forEach(a),d=w(ee),u=c(ee,"ION-TITLE",{style:!0,title:!0});var ne=m(u);T=ge(ne,_),ne.forEach(a),g=w(ee),ke&&ke.l(ee),ee.forEach(a),V.forEach(a),h=w(E),f=c(E,"ION-CONTENT",{fullscreen:!0});var he=m(f);p=c(he,"ION-LIST",{});var ce=m(p);b=c(ce,"ION-ITEM",{});var Ce=m(b);N=c(Ce,"ION-ICON",{icon:!0,slot:!0}),m(N).forEach(a),C=w(Ce),U=c(Ce,"ION-LABEL",{});var me=m(U);A=c(me,"P",{"data-svelte-h":!0}),te(A)!=="svelte-57b1dg"&&(A.textContent=q),X=w(me),j=c(me,"H2",{});var _e=m(j);B=ge(_e,M),_e.forEach(a),me.forEach(a),Ce.forEach(a),I=w(ce),pe&&pe.l(ce),H=w(ce),be&&be.l(ce),P=w(ce),re&&re.l(ce),R=w(ce),x&&x.l(ce),G=w(ce),ie&&ie.l(ce),$=w(ce),k&&k.l(ce),oe=w(ce),L&&L.l(ce),fe=w(ce),se=w(ce),D&&D.l(ce),ae=w(ce),z&&z.l(ce),Ne=w(ce),W&&W.l(ce),ce.forEach(a),he.forEach(a),Ee=w(E),F&&F.l(E),de=w(E),Y&&Y.l(E),Ie=Se(),this.h()},h(){v(n,"color","medium"),v(l,"slot","start"),O(u,"text-align","center"),v(u,"title",r[12].title),v(e,"translucent",""),v(N,"icon",_n),v(N,"slot","start"),v(f,"fullscreen","")},m(E,V){Q(E,e,V),o(e,t),o(t,l),o(l,n),o(t,d),o(t,u),o(u,T),o(t,g),ke&&ke.m(t,null),Q(E,h,V),Q(E,f,V),o(f,p),o(p,b),o(b,N),o(b,C),o(b,U),o(U,A),o(U,X),o(U,j),o(j,B),o(p,I),pe&&pe.m(p,null),o(p,H),be&&be.m(p,null),o(p,P),re&&re.m(p,null),o(p,R),x&&x.m(p,null),o(p,G),ie&&ie.m(p,null),o(p,$),k&&k.m(p,null),o(p,oe),L&&L.m(p,null),o(p,fe),o(p,se),D&&D.m(p,null),o(p,ae),z&&z.m(p,null),o(p,Ne),W&&W.m(p,null),Q(E,Ee,V),F&&F.m(E,V),Q(E,de,V),Y&&Y.m(E,V),Q(E,Ie,V),Te||(Oe=ue(n,"click",r[19]),Te=!0)},p(E,V){(!E[13]&&!E[14]||E[13]&&E[14])&&ke.p(E,V),S&&pe.p(E,V),be&&be.p(E,V),E[6]?re?re.p(E,V):(re=Et(E),re.c(),re.m(p,R)):re&&(re.d(1),re=null),E[7]&&E[7]!=="<br>"?x?x.p(E,V):(x=It(E),x.c(),x.m(p,G)):x&&(x.d(1),x=null),K&&ie.p(E,V),E[12].driver_comments&&k.p(E,V),le&&L.p(E,V),E[14]||D.p(E,V),(E[13]&&E[14]||!E[13]&&!E[14])&&z.p(E,V),E[1]?W?W.p(E,V):(W=Nt(E),W.c(),W.m(p,null)):W&&(W.d(1),W=null),E[3]?F||(F=Ct(),F.c(),F.m(de.parentNode,de)):F&&(F.d(1),F=null),E[9]?Y?Y.p(E,V):(Y=yt(E),Y.c(),Y.m(Ie.parentNode,Ie)):Y&&(Y.d(1),Y=null)},i:ze,o:ze,d(E){E&&(a(e),a(h),a(f),a(Ee),a(de),a(Ie)),ke&&ke.d(),pe&&pe.d(),be&&be.d(),re&&re.d(),x&&x.d(),ie&&ie.d(),k&&k.d(),L&&L.d(),D&&D.d(),z&&z.d(),W&&W.d(),F&&F.d(E),Y&&Y.d(E),Te=!1,Oe()}}}const wt=/Teléfono:\s*(\d{10,})/;function lt(r=""){return r.split(",").map(t=>t.trim())}function lo(r,e,t){let l=rt,n=document.querySelector("ion-modal"),i=n.componentProps.delivery,d=n.componentProps.isLast||!1,u=n.componentProps.flag||!1,_=i.driver_comments?i.driver_comments:"",T=i.deliver_status?i.deliver_status:"",g=i.img?i.img:"",h=i.img_id?i.img_id:"",f=g?lt(g):new Array,p=h?lt(h):new Array,b={latitude:null,longitude:null},N=i.stopsApproval,C=i.smsActive,U=!1,A=!0,q=!1,X="",j=i.comments_ext,M="",B=!1,I="",S=new Object,H="";Ze(()=>{S=JSON.parse(localStorage.getItem("userSession")),R()});async function P(z="",W,F={}){let Y=new FormData;t(3,U=!0);for(const[E,V]of Object.entries(F))Y.append(E,V);Y=we(Y);try{const E=await fetch(z,{method:"POST",body:Y});if(E.ok){const V=await E.json();W(V)}else console.error("Request failed:",E.statusText)}catch(E){console.error("Error during file upload:",E)}finally{t(3,U=!1)}}function R(){i.date_service?i.date_service&&!i.date_completed&&!i.service_time?(t(4,A=!1),t(5,q=!0)):i.date_service&&i.date_completed&&i.service_time&&(t(4,A=!1),t(5,q=!1)):(t(4,A=!0),t(5,q=!1))}if(i.comments_ext){const z=i.comments_ext.match(wt);z&&(X=z[1],j=i.comments_ext.replace(wt,"").trim())}const G=async(z,W)=>{await(await je.create({header:z||"Error",message:W||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()},K=async(z="",W="",F="",Y,E={})=>{await(await je.create({header:z||"Error",message:W||"Vuelva a intentar",buttons:[{text:"No",role:"cancel",handler:()=>{}},{text:"Sí",handler:()=>{P(F,Y,E)}}]})).present()},$=async z=>{if(f.length>=5){G("Límite de evidencias","Solo se permite subir 5 fotos por parada");return}if(u&&d&&f.length>=1){G("Límite de evidencias","Para el final de la ruta solo se permite subir 1 foto");return}const F=z.target.files[0];if(F)try{t(3,U=!0);const Y=await fe(F);if(Y){const E=new FormData;E.append("fileToUpload",Y),fetch(`${l}api/admin/manager/upload_img_driver.php`,{method:"POST",body:E}).then(V=>V.json()).then(V=>{t(1,g=g?`${g},${V.img}`:V.img),h=h?`${h},${V.img_id}`:V.img_id,t(2,f=lt(g)),p=lt(h)}).catch(V=>console.error("Upload error:",V))}}catch(Y){console.error("Compression error:",Y)}finally{t(3,U=!1)}};function oe(z){var W=i.service_time;!W&&A&&!d&&!u&&(z.preventDefault(),G("Registrar Ingreso","Antes de subir la evidencia registra el ingreso a la actual parada."))}function le(){var z=u?i.date_completed:!1;if(!z&&!A&&q&&!d&&!u){var W=new Object;W.id_event=i.id_event,W.type="checkout",K("Registrar Salida","¿Completaste tu entrega?",l+"api/admin/route/record_check_date.php",function(F){F.minutes&&G("Tiempo por parada","Completaste la parada en "+F.minutes+" minutos.")},W)}}const fe=async z=>new Promise(W=>{const F=new Image;F.src=URL.createObjectURL(z),F.onload=()=>{const Y=document.createElement("canvas"),E=Y.getContext("2d"),V=800,ee=600;let Z=F.width,ne=F.height;Z>V&&(ne*=V/Z,Z=V),ne>ee&&(Z*=ee/ne,ne=ee),Y.width=Z,Y.height=ne,E.drawImage(F,0,0,Z,ne),Y.toBlob(he=>{W(he),URL.revokeObjectURL(F.src),E.clearRect(0,0,Y.width,Y.height)},"image/jpeg",.7)}}),se=()=>{n.dismiss({data:Date.now()})};function ae(z){t(2,f=f.filter((W,F)=>F!==z))}const Ne=async()=>{try{if(t(3,U=!0),t(1,g=f.join(",")),h=p.join(","),le(),await de())if(H.value=="delivered"||H.value!=="delivered"&&(_.value||i.driver_comments)||u&&d){const W={id_route:i.id_route,...!u&&!d&&{id_event:i.id_event},...!u&&!d&&{comments:_.value},...!u&&!d&&{deliver_status:H.value},img:g,img_id:h,lat:b.latitude,lon:b.longitude,...N==="0"&&{approve:"0"},...d&&{isLast:!0},...u&&d&&{destiny:!0}};W.img&&W.img_id||g?P(`${l}api/admin/evidence/send_evidence.php`,function(F){if(F.success==!0){const Y=W.id_route;se(),d&&(Ee("","",Y,d),N=="0"&&be(Y,"completed"))}else G("Carga fallida","Actualiza la página y vuelve a intentar cargar la información!")},W):G("Información incompleta","Cargar evidencia fotográfica faltante para completar parada.")}else G("Motivo de status de entrega","Favor de ingresar en notas el motivo por el que la entrega no fue entregada correctamente");else G("Ubicación faltante","Asegúrate darle permisos a Rutaflow para acceder a tu ubicación")}catch(z){console.error("Error fetching data:",z)}finally{t(3,U=!1)}},Ee=(z,W,F,Y)=>{n.componentProps.routeId=F,n.componentProps.driverId=i.id_driver,Ue("modal-km-gas",Zt,{checklist:z,driverId:W,routeId:F,isLast:Y}).then(E=>{})},de=async()=>navigator.geolocation?new Promise((z,W)=>{navigator.geolocation.getCurrentPosition(F=>{b.latitude=F.coords.latitude,b.longitude=F.coords.longitude,z(!0)},F=>{console.error("Error getting location:",F),z(!1)})}):(console.error("Geolocation is not supported by your browser"),!1);async function Ie(z){z.stopPropagation();let W=new FormData;W.append("client_phone",X),W.append("client_name",i.title),W.append("delivery_phone",i.client_phone),W.append("enterprise_name",i.enterprise_name),W=we(W);try{const F=await fetch(`${l}api/admin/message_central/send_sms.php`,{method:"POST",body:W});if(F.ok){const Y=await F.json();G("SMS enviado","Se envío correctamente un SMS a "+i.title+" con número de teléfono: "+X)}else G("SMS no enviado","Hubo un error al enviar SMS a "+i.title+" con número de teléfono: "+phoneNumber0+". Por favor contacte a soporte.")}catch(F){console.error("Error during file upload:",F)}}function Te(){t(4,A=!1),t(5,q=!0),ke(i.id_event,"checkin")}function Oe(){t(5,q=!1),t(4,A=!1),ke(i.id_event,"checkout")}async function ke(z,W){if(W){let F=new FormData;F.append("type",W),F.append("id_event",z),F=we(F);try{const Y=await fetch(`${l}api/admin/route/record_check_date.php`,{method:"POST",body:F});if(Y.ok){const E=await Y.json();E.minutes&&G("Tiempo por parada","Completaste la parada en "+E.minutes+" minutos.")}else console.error("File upload failed:",Y.statusText)}catch(Y){console.error("Error during file upload:",Y)}finally{}}}const pe=z=>{t(10,I=z),t(9,B=!0)},ye=()=>{t(9,B=!1),t(10,I="")};function we(z){return z.append("token",S.token),z.append("id_user_over",S.id_user),z}function be(z,W){let F=new FormData;return F.append("id_route",z),F.append("status",W),F=we(F),fetch(`${l}api/admin/route/change_status.php`,{method:"POST",body:F}).then(Y=>Y.json()).then(Y=>{}).catch(Y=>{console.error("Error fetching data:",Y)}),""}function re(z){nn.call(this,r,z)}function x(z){Me[z?"unshift":"push"](()=>{M=z,t(8,M)})}function ie(z){Me[z?"unshift":"push"](()=>{H=z,t(11,H)})}function k(z){Me[z?"unshift":"push"](()=>{_=z,t(0,_)})}return[_,g,f,U,A,q,X,j,M,B,I,H,i,d,u,T,C,$,oe,se,ae,Ne,Ie,Te,Oe,pe,ye,re,x,ie,k,z=>pe(z),z=>ae(z)]}class Lt extends Je{constructor(e){super(),Ye(this,e,lo,oo,We,{},null,[-1,-1])}}function zt(r){let e,t,l;return{c(){e=s("section"),t=s("ion-img"),this.h()},l(n){e=c(n,"SECTION",{});var i=m(e);t=c(i,"ION-IMG",{src:!0,alt:!0,style:!0}),m(t).forEach(a),i.forEach(a),this.h()},h(){Ke(t.src,l=r[0])||v(t,"src",l),v(t,"alt","Evidencia fotográfica"),O(t,"max-width","100%"),O(t,"margin-top","16px")},m(n,i){Q(n,e,i),o(e,t)},p(n,i){i&1&&!Ke(t.src,l=n[0])&&v(t,"src",l)},d(n){n&&a(e)}}}function At(r){let e,t='<ion-spinner name="dots" style="color:white;"></ion-spinner>';return{c(){e=s("div"),e.innerHTML=t,this.h()},l(l){e=c(l,"DIV",{class:!0,style:!0,"data-svelte-h":!0}),te(e)!=="svelte-h8s7r2"&&(e.innerHTML=t),this.h()},h(){J(e,"class","overlay"),O(e,"position","fixed"),O(e,"top","0"),O(e,"left","0"),O(e,"width","100vw"),O(e,"height","100vh"),O(e,"background","rgba(0, 0, 0, 0.5)"),O(e,"display","flex"),O(e,"align-items","center"),O(e,"justify-content","center"),O(e,"z-index","9999")},m(l,n){Q(l,e,n)},d(l){l&&a(e)}}}function io(r){let e,t,l,n,i="Cancelar",d,u,_="AGREGAR GASTO",T,g,h,f="Confirmar",p,b,N,C,U,A,q,X,j,M,B,I,S,H,P,R,G,K,$='Tipo de pago <ion-text color="danger">(Obligatorio)</ion-text>',oe,le,fe="Efectivo",se,ae,Ne="Tarjeta",Ee,de,Ie="Transferencia",Te,Oe,ke,pe,ye,we,be,re,x,ie,k=`<ion-icon icon="${Yt}" slot="start"></ion-icon>
                        Subir Evidencia`,L,D,z,W,F,Y,E,V=r[0]&&zt(r),ee=r[5]&&At();return{c(){e=s("ion-header"),t=s("ion-toolbar"),l=s("ion-buttons"),n=s("ion-button"),n.textContent=i,d=y(),u=s("ion-title"),u.textContent=_,T=y(),g=s("ion-buttons"),h=s("ion-button"),h.textContent=f,p=y(),b=s("ion-content"),N=s("ion-list"),C=s("ion-item"),U=s("ion-icon"),A=y(),q=s("ion-input"),X=y(),j=s("ion-item"),M=s("ion-icon"),B=y(),I=s("ion-input"),S=y(),H=s("ion-item"),P=s("ion-icon"),R=y(),G=s("ion-select"),K=s("div"),K.innerHTML=$,oe=y(),le=s("ion-select-option"),le.textContent=fe,se=y(),ae=s("ion-select-option"),ae.textContent=Ne,Ee=y(),de=s("ion-select-option"),de.textContent=Ie,Te=y(),Oe=s("ion-item"),ke=s("ion-icon"),pe=y(),ye=s("ion-textarea"),we=y(),be=s("section"),re=s("label"),x=s("ion-button"),ie=s("label"),ie.innerHTML=k,L=y(),D=s("input"),z=y(),V&&V.c(),W=y(),ee&&ee.c(),F=Se(),this.h()},l(Z){e=c(Z,"ION-HEADER",{translucent:!0});var ne=m(e);t=c(ne,"ION-TOOLBAR",{});var he=m(t);l=c(he,"ION-BUTTONS",{slot:!0});var ce=m(l);n=c(ce,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),te(n)!=="svelte-1f8rjcf"&&(n.textContent=i),ce.forEach(a),d=w(he),u=c(he,"ION-TITLE",{title:!0,"data-svelte-h":!0}),te(u)!=="svelte-efps2s"&&(u.textContent=_),T=w(he),g=c(he,"ION-BUTTONS",{slot:!0});var Ce=m(g);h=c(Ce,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),te(h)!=="svelte-k5zoz0"&&(h.textContent=f),Ce.forEach(a),he.forEach(a),ne.forEach(a),p=w(Z),b=c(Z,"ION-CONTENT",{fullscreen:!0});var me=m(b);N=c(me,"ION-LIST",{});var _e=m(N);C=c(_e,"ION-ITEM",{});var He=m(C);U=c(He,"ION-ICON",{icon:!0,slot:!0}),m(U).forEach(a),A=w(He),q=c(He,"ION-INPUT",{label:!0,type:!0,placeholder:!0,value:!0}),m(q).forEach(a),He.forEach(a),X=w(_e),j=c(_e,"ION-ITEM",{});var qe=m(j);M=c(qe,"ION-ICON",{icon:!0,slot:!0}),m(M).forEach(a),B=w(qe),I=c(qe,"ION-INPUT",{label:!0,type:!0,value:!0}),m(I).forEach(a),qe.forEach(a),S=w(_e),H=c(_e,"ION-ITEM",{});var tt=m(H);P=c(tt,"ION-ICON",{icon:!0,slot:!0}),m(P).forEach(a),R=w(tt),G=c(tt,"ION-SELECT",{placeholder:!0,value:!0});var Ve=m(G);K=c(Ve,"DIV",{slot:!0,"data-svelte-h":!0}),te(K)!=="svelte-wl764p"&&(K.innerHTML=$),oe=w(Ve),le=c(Ve,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),te(le)!=="svelte-i9crym"&&(le.textContent=fe),se=w(Ve),ae=c(Ve,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),te(ae)!=="svelte-fx0z11"&&(ae.textContent=Ne),Ee=w(Ve),de=c(Ve,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),te(de)!=="svelte-1c24jf2"&&(de.textContent=Ie),Ve.forEach(a),tt.forEach(a),Te=w(_e),Oe=c(_e,"ION-ITEM",{});var nt=m(Oe);ke=c(nt,"ION-ICON",{icon:!0,slot:!0}),m(ke).forEach(a),pe=w(nt),ye=c(nt,"ION-TEXTAREA",{label:!0,placeholder:!0}),m(ye).forEach(a),nt.forEach(a),we=w(_e),be=c(_e,"SECTION",{});var pt=m(be);re=c(pt,"LABEL",{for:!0,style:!0});var mt=m(re);x=c(mt,"ION-BUTTON",{fill:!0,size:!0,class:!0,expand:!0});var ot=m(x);ie=c(ot,"LABEL",{for:!0,style:!0,"data-svelte-h":!0}),te(ie)!=="svelte-1m9yw22"&&(ie.innerHTML=k),L=w(ot),D=c(ot,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0,capture:!0}),ot.forEach(a),mt.forEach(a),pt.forEach(a),z=w(_e),V&&V.l(_e),_e.forEach(a),me.forEach(a),W=w(Z),ee&&ee.l(Z),F=Se(),this.h()},h(){v(n,"color","medium"),v(l,"slot","start"),v(u,"title",""),v(h,"strong",""),v(g,"slot","end"),v(e,"translucent",""),v(U,"icon",Jt),v(U,"slot","start"),v(q,"label","Concepto"),v(q,"type","text"),v(q,"placeholder","Escribe aquí..."),v(q,"value",r[6]?r[6]:""),v(M,"icon",ct),v(M,"slot","start"),v(I,"label","Cantidad"),v(I,"type","number"),v(I,"value",r[7]?r[7]:""),v(P,"icon",On),v(P,"slot","start"),J(K,"slot","label"),v(le,"value","cash"),v(ae,"value","card"),v(de,"value","transfer"),v(G,"placeholder","Tipo de pago"),v(G,"value",r[8]?r[8]:""),v(ke,"icon",ct),v(ke,"slot","start"),v(ye,"label","Comentarios"),v(ye,"placeholder","Escribe aquí..."),J(ie,"for","eventEvidence"),O(ie,"width","100%"),O(ie,"padding","8px"),O(D,"display","none"),J(D,"id","eventEvidence"),J(D,"name","fileToUpload"),J(D,"type","file"),J(D,"accept","image/*"),J(D,"capture","environment"),v(x,"fill","outline"),v(x,"size","small"),v(x,"class","loadEvidence"),v(x,"expand","block"),J(re,"for","eventEvidence"),O(re,"display","block"),O(re,"width","100%"),v(b,"fullscreen","")},m(Z,ne){Q(Z,e,ne),o(e,t),o(t,l),o(l,n),o(t,d),o(t,u),o(t,T),o(t,g),o(g,h),Q(Z,p,ne),Q(Z,b,ne),o(b,N),o(N,C),o(C,U),o(C,A),o(C,q),r[12](q),o(N,X),o(N,j),o(j,M),o(j,B),o(j,I),r[13](I),o(N,S),o(N,H),o(H,P),o(H,R),o(H,G),o(G,K),o(G,oe),o(G,le),o(G,se),o(G,ae),o(G,Ee),o(G,de),r[14](G),o(N,Te),o(N,Oe),o(Oe,ke),o(Oe,pe),o(Oe,ye),r[15](ye),o(N,we),o(N,be),o(be,re),o(re,x),o(x,ie),o(x,L),o(x,D),o(N,z),V&&V.m(N,null),Q(Z,W,ne),ee&&ee.m(Z,ne),Q(Z,F,ne),Y||(E=[ue(n,"click",r[10]),ue(h,"click",r[11]),ue(D,"change",r[9])],Y=!0)},p(Z,[ne]){Z[0]?V?V.p(Z,ne):(V=zt(Z),V.c(),V.m(N,null)):V&&(V.d(1),V=null),Z[5]?ee||(ee=At(),ee.c(),ee.m(F.parentNode,F)):ee&&(ee.d(1),ee=null)},i:ze,o:ze,d(Z){Z&&(a(e),a(p),a(b),a(W),a(F)),r[12](null),r[13](null),r[14](null),r[15](null),V&&V.d(),ee&&ee.d(Z),Y=!1,Pe(E)}}}function ro(r,e,t){let l=rt,n=document.querySelector("ion-modal"),i=n.componentProps.routeId,d=n.componentProps.ex_concept,u=n.componentProps.ex_amount,_=n.componentProps.ex_type,T=n.componentProps.id_expense,g="",h="",f="",p=0,b="",N="",C=!1,U=new Object;Ze(()=>{U=JSON.parse(localStorage.getItem("userSession"))});const A=async(R,G)=>{await(await je.create({header:R||"Error",message:G||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()},q=async R=>{t(5,C=!0);const K=R.target.files[0],$=await X(K);if($){let oe=new FormData;oe.append("fileToUpload",$),oe=B(oe);try{const le=await fetch(`${l}api/admin/manager/upload_img_driver.php`,{method:"POST",body:oe});if(le.ok){const fe=await le.json();t(0,g=fe.img),h=fe.img_id}else console.error("File upload failed:",le.statusText)}catch(le){console.error("Error during file upload:",le)}finally{t(5,C=!1)}}},X=async R=>new Promise(G=>{const K=new Image;K.src=URL.createObjectURL(R),K.onload=()=>{const $=document.createElement("canvas"),oe=$.getContext("2d"),le=800,fe=600;let se=K.width,ae=K.height;se>le&&(ae*=le/se,se=le),ae>fe&&(se*=fe/ae,ae=fe),$.width=se,$.height=ae,oe.drawImage(K,0,0,se,ae),$.toBlob(Ne=>{G(Ne),URL.revokeObjectURL(K.src),oe.clearRect(0,0,$.width,$.height)},"image/jpeg",.7)}}),j=()=>{et.dismiss()},M=()=>{var R=new Object;R.id_route=i,R.comments=b.value,R.type=f.value,R.img=g,R.img_id=h,R.amount=p.value,R.concept=N.value,R.status="done",R.id_expense=T||"null";let G=new FormData;for(const K in R)G.append(K,R[K]);G=B(G),!h||!g||!b.value||!p.value||!N.value?A("Datos incompletos","Llena los datos requeridos para completar el registro"):fetch(`${l}api/admin/expenses/add_expense.php`,{method:"POST",body:G}).then(K=>K.json()).then(K=>{j()}).catch(K=>{console.error("Error fetching data:",K)})};function B(R){return R.append("token",U.token),R.append("id_user_over",U.id_user),R}function I(R){Me[R?"unshift":"push"](()=>{N=R,t(4,N)})}function S(R){Me[R?"unshift":"push"](()=>{p=R,t(2,p)})}function H(R){Me[R?"unshift":"push"](()=>{f=R,t(1,f)})}function P(R){Me[R?"unshift":"push"](()=>{b=R,t(3,b)})}return[g,f,p,b,N,C,d,u,_,q,j,M,I,S,H,P]}class ft extends Je{constructor(e){super(),Ye(this,e,ro,io,We,{})}}function St(r,e,t){const l=r.slice();return l[7]=e[t],l}function ao(r){let e,t="Cargar gasto",l,n;function i(...d){return r[4](r[7],...d)}return{c(){e=s("ion-button"),e.textContent=t,this.h()},l(d){e=c(d,"ION-BUTTON",{fill:!0,size:!0,"aria-selected":!0,"data-svelte-h":!0}),te(e)!=="svelte-175aelj"&&(e.textContent=t),this.h()},h(){v(e,"fill","outline"),v(e,"size","small"),v(e,"aria-selected","")},m(d,u){Q(d,e,u),l||(n=ue(e,"click",i),l=!0)},p(d,u){r=d},d(d){d&&a(e),l=!1,n()}}}function so(r){let e,t="Gasto completado";return{c(){e=s("ion-button"),e.textContent=t,this.h()},l(l){e=c(l,"ION-BUTTON",{fill:!0,size:!0,"aria-selected":!0,"data-svelte-h":!0}),te(e)!=="svelte-tlger7"&&(e.textContent=t),this.h()},h(){v(e,"fill","solid"),v(e,"size","small"),v(e,"aria-selected","")},m(l,n){Q(l,e,n)},p:ze,d(l){l&&a(e)}}}function Mt(r,e){let t,l,n,i=e[7].concept+"",d,u,_;function T(f,p){return f[7].status=="done"?so:ao}let h=T(e)(e);return{key:r,first:null,c(){t=s("ion-item"),l=s("ion-label"),n=s("p"),d=ve(i),u=y(),h.c(),_=y(),this.h()},l(f){t=c(f,"ION-ITEM",{});var p=m(t);l=c(p,"ION-LABEL",{style:!0});var b=m(l);n=c(b,"P",{style:!0});var N=m(n);d=ge(N,i),N.forEach(a),b.forEach(a),u=w(p),h.l(p),_=w(p),p.forEach(a),this.h()},h(){O(n,"margin-left","10px"),O(l,"display","flex"),this.first=t},m(f,p){Q(f,t,p),o(t,l),o(l,n),o(n,d),o(t,u),h.m(t,null),o(t,_)},p(f,p){e=f,h.p(e,p)},d(f){f&&a(t),h.d()}}}function co(r){let e,t,l,n,i=`<ion-icon style="font-size: 25px!important;" icon="${Nn}"></ion-icon>`,d,u,_="LISTA DE GASTOS",T,g,h,f=[],p=new Map,b,N,C,U="Cerrar",A,q,X=Be(r[0]);const j=M=>M[7].id_expenses;for(let M=0;M<X.length;M+=1){let B=St(r,X,M),I=j(B);p.set(I,f[M]=Mt(I,B))}return{c(){e=s("ion-header"),t=s("ion-toolbar"),l=s("ion-buttons"),n=s("ion-button"),n.innerHTML=i,d=y(),u=s("ion-title"),u.textContent=_,T=y(),g=s("ion-content"),h=s("ion-list");for(let M=0;M<f.length;M+=1)f[M].c();b=y(),N=s("ion-footer"),C=s("ion-button"),C.textContent=U,this.h()},l(M){e=c(M,"ION-HEADER",{translucent:!0});var B=m(e);t=c(B,"ION-TOOLBAR",{});var I=m(t);l=c(I,"ION-BUTTONS",{slot:!0});var S=m(l);n=c(S,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),te(n)!=="svelte-160xz3i"&&(n.innerHTML=i),S.forEach(a),d=w(I),u=c(I,"ION-TITLE",{"data-svelte-h":!0}),te(u)!=="svelte-1phn90x"&&(u.textContent=_),I.forEach(a),B.forEach(a),T=w(M),g=c(M,"ION-CONTENT",{fullscreen:!0});var H=m(g);h=c(H,"ION-LIST",{});var P=m(h);for(let G=0;G<f.length;G+=1)f[G].l(P);P.forEach(a),H.forEach(a),b=w(M),N=c(M,"ION-FOOTER",{});var R=m(N);C=c(R,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),te(C)!=="svelte-zv7v83"&&(C.textContent=U),R.forEach(a),this.h()},h(){v(n,"color","medium"),v(l,"slot","end"),v(e,"translucent",""),v(g,"fullscreen",""),v(C,"fill","outline"),v(C,"color","tertiary"),v(C,"strong",""),O(C,"width","99%"),O(C,"height","auto")},m(M,B){Q(M,e,B),o(e,t),o(t,l),o(l,n),o(t,d),o(t,u),Q(M,T,B),Q(M,g,B),o(g,h);for(let I=0;I<f.length;I+=1)f[I]&&f[I].m(h,null);Q(M,b,B),Q(M,N,B),o(N,C),A||(q=[ue(n,"click",r[3]),ue(C,"click",r[1])],A=!0)},p(M,[B]){B&5&&(X=Be(M[0]),f=xe(f,B,j,1,M,X,p,h,$e,Mt,null,St))},i:ze,o:ze,d(M){M&&(a(e),a(T),a(g),a(b),a(N));for(let B=0;B<f.length;B+=1)f[B].d();A=!1,Pe(q)}}}function uo(r){let e=document.querySelector("ion-modal");e.componentProps.routeId;let t=e.componentProps.expenses;Ze(()=>{});const l=()=>{et.dismiss()};function n(u,_,T,g,h){e.componentProps.ex_amount=T,e.componentProps.ex_concept=_,e.componentProps.ex_type=g,e.componentProps.id_expense=h,Ue("modal-expense",ft,{amount:T,concept:_,type:g,id_expense:h}).then(()=>{}),l()}return[t,l,n,u=>{Ue("modal-expense",ft,{routeId:u}).then(_=>{}),l()},(u,_)=>n(_,u.concept,u.amount,u.type,u.id_expenses)]}class fo extends Je{constructor(e){super(),Ye(this,e,uo,co,We,{})}}const{document:Dt}=An;function Pt(r,e,t){const l=r.slice();return l[48]=e[t],l[50]=t,l}function Ht(r,e,t){const l=r.slice();return l[48]=e[t],l[50]=t,l}function Bt(r,e,t){const l=r.slice();return l[48]=e[t],l[50]=t,l}function Rt(r){let e,t;return e=new wn({props:{$$slots:{default:[bo]},$$scope:{ctx:r}}}),{c(){sn(e.$$.fragment)},l(l){cn(e.$$.fragment,l)},m(l,n){un(e,l,n),t=!0},p(l,n){const i={};n[0]&1019|n[1]&4194304&&(i.$$scope={dirty:n,ctx:l}),e.$set(i)},i(l){t||(it(e.$$.fragment,l),t=!0)},o(l){st(e.$$.fragment,l),t=!1},d(l){fn(e,l)}}}function _o(r){let e,t='<div id="g_map" style="width: 100%; height: 100vh;"></div>';return{c(){e=s("ion-content"),e.innerHTML=t},l(l){e=c(l,"ION-CONTENT",{"data-svelte-h":!0}),te(e)!=="svelte-1ydw6i9"&&(e.innerHTML=t)},m(l,n){Q(l,e,n)},p:ze,d(l){l&&a(e)}}}function ho(r){let e;function t(i,d){if(i[7].length>0)return mo;if(!i[3])return po}let l=t(r),n=l&&l(r);return{c(){n&&n.c(),e=Se()},l(i){n&&n.l(i),e=Se()},m(i,d){n&&n.m(i,d),Q(i,e,d)},p(i,d){l===(l=t(i))&&n?n.p(i,d):(n&&n.d(1),n=l&&l(i),n&&(n.c(),n.m(e.parentNode,e)))},d(i){i&&a(e),n&&n.d(i)}}}function po(r){let e,t,l,n='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Jala para actualizar" refreshing-spinner="circles" refreshing-text="Actualizando..."></ion-refresher-content>',i,d,u,_,T,g,h="0",f,p,b,N,C,U=r[6].origin+"",A,q,X,j="",M,B,I,S=[],H=new Map,P,R,G,K,$,oe=r[5].length+1+"",le,fe,se,ae,Ne,Ee,de=r[6].destination+"",Ie,Te,Oe,ke="",pe,ye,we,be,re=r[4]&&Ut(r),x=Be(r[5]);const ie=k=>k[48].id_event;for(let k=0;k<x.length;k+=1){let L=Pt(r,x,k),D=ie(L);H.set(D,S[k]=Ft(D,L))}return{c(){re&&re.c(),e=y(),t=s("ion-content"),l=s("ion-refresher"),l.innerHTML=n,i=y(),d=s("ion-list"),u=s("ion-item"),_=s("ion-avatar"),T=s("div"),g=s("div"),g.textContent=h,p=y(),b=s("ion-label"),N=s("ion-text"),C=s("h3"),A=ve(U),q=y(),X=s("div"),X.innerHTML=j,M=y(),B=s("ion-icon"),I=y();for(let k=0;k<S.length;k+=1)S[k].c();P=y(),R=s("ion-item"),G=s("ion-avatar"),K=s("div"),$=s("div"),le=ve(oe),se=y(),ae=s("ion-label"),Ne=s("ion-text"),Ee=s("h3"),Ie=ve(de),Te=y(),Oe=s("div"),Oe.innerHTML=ke,pe=y(),ye=s("ion-icon"),this.h()},l(k){re&&re.l(k),e=w(k),t=c(k,"ION-CONTENT",{});var L=m(t);l=c(L,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),te(l)!=="svelte-1srnbs3"&&(l.innerHTML=n),i=w(L),d=c(L,"ION-LIST",{});var D=m(d);u=c(D,"ION-ITEM",{});var z=m(u);_=c(z,"ION-AVATAR",{slot:!0});var W=m(_);T=c(W,"DIV",{class:!0,title:!0,style:!0});var F=m(T);g=c(F,"DIV",{class:!0,"data-svelte-h":!0}),te(g)!=="svelte-3lvlrb"&&(g.textContent=h),F.forEach(a),W.forEach(a),p=w(z),b=c(z,"ION-LABEL",{button:!0});var Y=m(b);N=c(Y,"ION-TEXT",{color:!0});var E=m(N);C=c(E,"H3",{});var V=m(C);A=ge(V,U),V.forEach(a),E.forEach(a),q=w(Y),X=c(Y,"DIV",{class:!0,"data-svelte-h":!0}),te(X)!=="svelte-gz9kb"&&(X.innerHTML=j),Y.forEach(a),M=w(z),B=c(z,"ION-ICON",{icon:!0,slot:!0}),m(B).forEach(a),z.forEach(a),I=w(D);for(let _e=0;_e<S.length;_e+=1)S[_e].l(D);P=w(D),R=c(D,"ION-ITEM",{});var ee=m(R);G=c(ee,"ION-AVATAR",{slot:!0});var Z=m(G);K=c(Z,"DIV",{class:!0,title:!0,style:!0});var ne=m(K);$=c(ne,"DIV",{class:!0});var he=m($);le=ge(he,oe),he.forEach(a),ne.forEach(a),Z.forEach(a),se=w(ee),ae=c(ee,"ION-LABEL",{button:!0});var ce=m(ae);Ne=c(ce,"ION-TEXT",{color:!0});var Ce=m(Ne);Ee=c(Ce,"H3",{});var me=m(Ee);Ie=ge(me,de),me.forEach(a),Ce.forEach(a),Te=w(ce),Oe=c(ce,"DIV",{class:!0,"data-svelte-h":!0}),te(Oe)!=="svelte-130ohbs"&&(Oe.innerHTML=ke),ce.forEach(a),pe=w(ee),ye=c(ee,"ION-ICON",{icon:!0,slot:!0}),m(ye).forEach(a),ee.forEach(a),D.forEach(a),L.forEach(a),this.h()},h(){v(l,"slot","fixed"),J(g,"class","order svelte-egzizz"),J(T,"class","order-wrapper svelte-egzizz"),J(T,"title",f="$"+r[6].origin),O(T,"background-color",r[6].color),O(T,"color",Ae(r[6].color)),v(_,"slot","start"),v(N,"color","#2e2e2e"),J(X,"class","sub svelte-egzizz"),v(b,"button",""),v(B,"icon",Re),v(B,"slot","end"),J($,"class","order svelte-egzizz"),J(K,"class","order-wrapper svelte-egzizz"),J(K,"title",fe="$"+r[6].destination),O(K,"background-color",r[6].color),O(K,"color",Ae(r[6].color)),v(G,"slot","start"),v(Ne,"color","#2e2e2e"),J(Oe,"class","sub svelte-egzizz"),v(ae,"button",""),v(ye,"icon",Re),v(ye,"slot","end")},m(k,L){re&&re.m(k,L),Q(k,e,L),Q(k,t,L),o(t,l),r[30](l),o(t,i),o(t,d),o(d,u),o(u,_),o(_,T),o(T,g),o(u,p),o(u,b),o(b,N),o(N,C),o(C,A),o(b,q),o(b,X),o(u,M),o(u,B),o(d,I);for(let D=0;D<S.length;D+=1)S[D]&&S[D].m(d,null);o(d,P),o(d,R),o(R,G),o(G,K),o(K,$),o($,le),o(R,se),o(R,ae),o(ae,Ne),o(Ne,Ee),o(Ee,Ie),o(ae,Te),o(ae,Oe),o(R,pe),o(R,ye),we||(be=[ue(l,"ionRefresh",r[10]),ue(b,"click",r[31]),ue(ae,"click",r[33])],we=!0)},p(k,L){k[4]?re?re.p(k,L):(re=Ut(k),re.c(),re.m(e.parentNode,e)):re&&(re.d(1),re=null),L[0]&64&&f!==(f="$"+k[6].origin)&&J(T,"title",f),L[0]&64&&O(T,"background-color",k[6].color),L[0]&64&&O(T,"color",Ae(k[6].color)),L[0]&64&&U!==(U=k[6].origin+"")&&Le(A,U),L[0]&331808&&(x=Be(k[5]),S=xe(S,L,ie,1,k,x,H,d,$e,Ft,P,Pt)),L[0]&32&&oe!==(oe=k[5].length+1+"")&&Le(le,oe),L[0]&64&&fe!==(fe="$"+k[6].destination)&&J(K,"title",fe),L[0]&64&&O(K,"background-color",k[6].color),L[0]&64&&O(K,"color",Ae(k[6].color)),L[0]&64&&de!==(de=k[6].destination+"")&&Le(Ie,de)},d(k){k&&(a(e),a(t)),re&&re.d(k),r[30](null);for(let L=0;L<S.length;L+=1)S[L].d();we=!1,Pe(be)}}}function mo(r){let e,t;function l(d,u){return u[0]&144&&(e=null),e==null&&(e=!!(d[7].filter(Io).every(ko)&&!d[4])),e?go:vo}let n=l(r,[-1,-1]),i=n(r);return{c(){i.c(),t=Se()},l(d){i.l(d),t=Se()},m(d,u){i.m(d,u),Q(d,t,u)},p(d,u){n===(n=l(d,u))&&i?i.p(d,u):(i.d(1),i=n(d),i&&(i.c(),i.m(t.parentNode,t)))},d(d){d&&a(t),i.d(d)}}}function Ut(r){let e=r[14]("",r[1],r[0])+"",t;return{c(){t=ve(e)},l(l){t=ge(l,e)},m(l,n){Q(l,t,n)},p(l,n){n[0]&3&&e!==(e=l[14]("",l[1],l[0])+"")&&Le(t,e)},d(l){l&&a(t)}}}function Vt(r){let e;return{c(){e=s("span"),this.h()},l(t){e=c(t,"SPAN",{class:!0}),m(e).forEach(a),this.h()},h(){J(e,"class","notes svelte-egzizz")},m(t,l){Q(t,e,l)},d(t){t&&a(e)}}}function Ft(r,e){let t,l,n,i,d=parseInt(e[48].pos)+1+"",u,_,T,g,h,f,p=e[48].title+"",b,N,C=e[48].support_list&&e[48].support_list.length||e[16](e[48]),U,A,q,X,j=C&&Vt();function M(){return e[32](e[48])}return{key:r,first:null,c(){t=s("ion-item"),l=s("ion-avatar"),n=s("div"),i=s("div"),u=ve(d),T=y(),g=s("ion-label"),h=s("ion-text"),f=s("h3"),b=ve(p),N=y(),j&&j.c(),U=y(),A=s("ion-icon"),this.h()},l(B){t=c(B,"ION-ITEM",{});var I=m(t);l=c(I,"ION-AVATAR",{slot:!0});var S=m(l);n=c(S,"DIV",{class:!0,title:!0,style:!0});var H=m(n);i=c(H,"DIV",{class:!0});var P=m(i);u=ge(P,d),P.forEach(a),H.forEach(a),S.forEach(a),T=w(I),g=c(I,"ION-LABEL",{button:!0});var R=m(g);h=c(R,"ION-TEXT",{color:!0});var G=m(h);f=c(G,"H3",{});var K=m(f);b=ge(K,p),N=w(K),j&&j.l(K),K.forEach(a),G.forEach(a),R.forEach(a),U=w(I),A=c(I,"ION-ICON",{icon:!0,slot:!0,style:!0}),m(A).forEach(a),I.forEach(a),this.h()},h(){J(i,"class","order svelte-egzizz"),J(n,"class","order-wrapper svelte-egzizz"),J(n,"title",_=Xe(e[48].status)),O(n,"background-color",De(e[48].status,e[48].date_service)),O(n,"color",Ae(De(e[48].status))),v(l,"slot","start"),v(h,"color","#2e2e2e"),v(g,"button",""),v(A,"icon",Re),v(A,"slot","end"),O(A,"color",De(e[48].status,e[48].date_service)),this.first=t},m(B,I){Q(B,t,I),o(t,l),o(l,n),o(n,i),o(i,u),o(t,T),o(t,g),o(g,h),o(h,f),o(f,b),o(f,N),j&&j.m(f,null),o(t,U),o(t,A),q||(X=ue(g,"click",M),q=!0)},p(B,I){e=B,I[0]&32&&d!==(d=parseInt(e[48].pos)+1+"")&&Le(u,d),I[0]&32&&_!==(_=Xe(e[48].status))&&J(n,"title",_),I[0]&32&&O(n,"background-color",De(e[48].status,e[48].date_service)),I[0]&32&&O(n,"color",Ae(De(e[48].status))),I[0]&32&&p!==(p=e[48].title+"")&&Le(b,p),I[0]&32&&(C=e[48].support_list&&e[48].support_list.length||e[16](e[48])),C?j||(j=Vt(),j.c(),j.m(f,null)):j&&(j.d(1),j=null),I[0]&32&&O(A,"color",De(e[48].status,e[48].date_service))},d(B){B&&a(t),j&&j.d(),q=!1,X()}}}function vo(r){let e=r[14](r[7],r[1],r[0])+"",t,l,n,i,d='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Pull to refresh" refreshing-spinner="circles" refreshing-text="Refreshing..."></ion-refresher-content>',u,_,T,g,h,f,p="0",b,N,C,U,A,q=r[6].origin+"",X,j,M,B="",I,S,H,P=[],R=new Map,G,K,$,oe,le,fe=r[5].length+1+"",se,ae,Ne,Ee,de,Ie,Te=r[6].destination+"",Oe,ke,pe,ye="",we,be,re,x,ie=Be(r[5]);const k=L=>L[48].id_event;for(let L=0;L<ie.length;L+=1){let D=Ht(r,ie,L),z=k(D);R.set(z,P[L]=qt(z,D))}return{c(){t=ve(e),l=y(),n=s("ion-content"),i=s("ion-refresher"),i.innerHTML=d,u=y(),_=s("ion-list"),T=s("ion-item"),g=s("ion-avatar"),h=s("div"),f=s("div"),f.textContent=p,N=y(),C=s("ion-label"),U=s("ion-text"),A=s("h3"),X=ve(q),j=y(),M=s("div"),M.innerHTML=B,I=y(),S=s("ion-icon"),H=y();for(let L=0;L<P.length;L+=1)P[L].c();G=y(),K=s("ion-item"),$=s("ion-avatar"),oe=s("div"),le=s("div"),se=ve(fe),Ne=y(),Ee=s("ion-label"),de=s("ion-text"),Ie=s("h3"),Oe=ve(Te),ke=y(),pe=s("div"),pe.innerHTML=ye,we=y(),be=s("ion-icon"),this.h()},l(L){t=ge(L,e),l=w(L),n=c(L,"ION-CONTENT",{});var D=m(n);i=c(D,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),te(i)!=="svelte-dvt1s"&&(i.innerHTML=d),u=w(D),_=c(D,"ION-LIST",{});var z=m(_);T=c(z,"ION-ITEM",{});var W=m(T);g=c(W,"ION-AVATAR",{slot:!0});var F=m(g);h=c(F,"DIV",{class:!0,title:!0,style:!0});var Y=m(h);f=c(Y,"DIV",{class:!0,"data-svelte-h":!0}),te(f)!=="svelte-3lvlrb"&&(f.textContent=p),Y.forEach(a),F.forEach(a),N=w(W),C=c(W,"ION-LABEL",{button:!0});var E=m(C);U=c(E,"ION-TEXT",{color:!0});var V=m(U);A=c(V,"H3",{});var ee=m(A);X=ge(ee,q),ee.forEach(a),V.forEach(a),j=w(E),M=c(E,"DIV",{class:!0,"data-svelte-h":!0}),te(M)!=="svelte-gz9kb"&&(M.innerHTML=B),E.forEach(a),I=w(W),S=c(W,"ION-ICON",{icon:!0,slot:!0}),m(S).forEach(a),W.forEach(a),H=w(z);for(let He=0;He<P.length;He+=1)P[He].l(z);G=w(z),K=c(z,"ION-ITEM",{});var Z=m(K);$=c(Z,"ION-AVATAR",{slot:!0});var ne=m($);oe=c(ne,"DIV",{class:!0,title:!0,style:!0});var he=m(oe);le=c(he,"DIV",{class:!0});var ce=m(le);se=ge(ce,fe),ce.forEach(a),he.forEach(a),ne.forEach(a),Ne=w(Z),Ee=c(Z,"ION-LABEL",{button:!0});var Ce=m(Ee);de=c(Ce,"ION-TEXT",{color:!0});var me=m(de);Ie=c(me,"H3",{});var _e=m(Ie);Oe=ge(_e,Te),_e.forEach(a),me.forEach(a),ke=w(Ce),pe=c(Ce,"DIV",{class:!0,"data-svelte-h":!0}),te(pe)!=="svelte-130ohbs"&&(pe.innerHTML=ye),Ce.forEach(a),we=w(Z),be=c(Z,"ION-ICON",{icon:!0,slot:!0}),m(be).forEach(a),Z.forEach(a),z.forEach(a),D.forEach(a),this.h()},h(){v(i,"slot","fixed"),J(f,"class","order svelte-egzizz"),J(h,"class","order-wrapper svelte-egzizz"),J(h,"title",b="$"+r[6].origin),O(h,"background-color",r[6].color),O(h,"color",Ae(r[6].color)),v(g,"slot","start"),v(U,"color","#2e2e2e"),J(M,"class","sub svelte-egzizz"),v(C,"button",""),v(S,"icon",Re),v(S,"slot","end"),J(le,"class","order svelte-egzizz"),J(oe,"class","order-wrapper svelte-egzizz"),J(oe,"title",ae="$"+r[6].destination),O(oe,"background-color",r[6].color),O(oe,"color",Ae(r[6].color)),v($,"slot","start"),v(de,"color","#2e2e2e"),J(pe,"class","sub svelte-egzizz"),v(Ee,"button",""),v(be,"icon",Re),v(be,"slot","end")},m(L,D){Q(L,t,D),Q(L,l,D),Q(L,n,D),o(n,i),r[26](i),o(n,u),o(n,_),o(_,T),o(T,g),o(g,h),o(h,f),o(T,N),o(T,C),o(C,U),o(U,A),o(A,X),o(C,j),o(C,M),o(T,I),o(T,S),o(_,H);for(let z=0;z<P.length;z+=1)P[z]&&P[z].m(_,null);o(_,G),o(_,K),o(K,$),o($,oe),o(oe,le),o(le,se),o(K,Ne),o(K,Ee),o(Ee,de),o(de,Ie),o(Ie,Oe),o(Ee,ke),o(Ee,pe),o(K,we),o(K,be),re||(x=[ue(i,"ionRefresh",r[10]),ue(C,"click",r[27]),ue(Ee,"click",r[29])],re=!0)},p(L,D){D[0]&131&&e!==(e=L[14](L[7],L[1],L[0])+"")&&Le(t,e),D[0]&64&&b!==(b="$"+L[6].origin)&&J(h,"title",b),D[0]&64&&O(h,"background-color",L[6].color),D[0]&64&&O(h,"color",Ae(L[6].color)),D[0]&64&&q!==(q=L[6].origin+"")&&Le(X,q),D[0]&331808&&(ie=Be(L[5]),P=xe(P,D,k,1,L,ie,R,_,$e,qt,G,Ht)),D[0]&32&&fe!==(fe=L[5].length+1+"")&&Le(se,fe),D[0]&64&&ae!==(ae="$"+L[6].destination)&&J(oe,"title",ae),D[0]&64&&O(oe,"background-color",L[6].color),D[0]&64&&O(oe,"color",Ae(L[6].color)),D[0]&64&&Te!==(Te=L[6].destination+"")&&Le(Oe,Te)},d(L){L&&(a(t),a(l),a(n)),r[26](null);for(let D=0;D<P.length;D+=1)P[D].d();re=!1,Pe(x)}}}function go(r){let e,t,l='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Jale para actualizar" refreshing-spinner="circles" refreshing-text="Actualizando..."></ion-refresher-content>',n,i,d,u,_,T,g="0",h,f,p,b,N,C=r[6].origin+"",U,A,q,X="",j,M,B,I=[],S=new Map,H,P,R,G,K,$=r[5].length+1+"",oe,le,fe,se,ae,Ne,Ee=r[6].destination+"",de,Ie,Te,Oe="",ke,pe,ye,we,be=Be(r[5]);const re=x=>x[48].id_event;for(let x=0;x<be.length;x+=1){let ie=Bt(r,be,x),k=re(ie);S.set(k,I[x]=Kt(k,ie))}return{c(){e=s("ion-content"),t=s("ion-refresher"),t.innerHTML=l,n=y(),i=s("ion-list"),d=s("ion-item"),u=s("ion-avatar"),_=s("div"),T=s("div"),T.textContent=g,f=y(),p=s("ion-label"),b=s("ion-text"),N=s("h3"),U=ve(C),A=y(),q=s("div"),q.innerHTML=X,j=y(),M=s("ion-icon"),B=y();for(let x=0;x<I.length;x+=1)I[x].c();H=y(),P=s("ion-item"),R=s("ion-avatar"),G=s("div"),K=s("div"),oe=ve($),fe=y(),se=s("ion-label"),ae=s("ion-text"),Ne=s("h3"),de=ve(Ee),Ie=y(),Te=s("div"),Te.innerHTML=Oe,ke=y(),pe=s("ion-icon"),this.h()},l(x){e=c(x,"ION-CONTENT",{});var ie=m(e);t=c(ie,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),te(t)!=="svelte-15ukrgn"&&(t.innerHTML=l),n=w(ie),i=c(ie,"ION-LIST",{});var k=m(i);d=c(k,"ION-ITEM",{});var L=m(d);u=c(L,"ION-AVATAR",{slot:!0});var D=m(u);_=c(D,"DIV",{class:!0,title:!0,style:!0});var z=m(_);T=c(z,"DIV",{class:!0,"data-svelte-h":!0}),te(T)!=="svelte-3lvlrb"&&(T.textContent=g),z.forEach(a),D.forEach(a),f=w(L),p=c(L,"ION-LABEL",{button:!0});var W=m(p);b=c(W,"ION-TEXT",{color:!0});var F=m(b);N=c(F,"H3",{});var Y=m(N);U=ge(Y,C),Y.forEach(a),F.forEach(a),A=w(W),q=c(W,"DIV",{class:!0,"data-svelte-h":!0}),te(q)!=="svelte-gz9kb"&&(q.innerHTML=X),W.forEach(a),j=w(L),M=c(L,"ION-ICON",{icon:!0,slot:!0}),m(M).forEach(a),L.forEach(a),B=w(k);for(let Ce=0;Ce<I.length;Ce+=1)I[Ce].l(k);H=w(k),P=c(k,"ION-ITEM",{});var E=m(P);R=c(E,"ION-AVATAR",{slot:!0});var V=m(R);G=c(V,"DIV",{class:!0,title:!0,style:!0});var ee=m(G);K=c(ee,"DIV",{class:!0});var Z=m(K);oe=ge(Z,$),Z.forEach(a),ee.forEach(a),V.forEach(a),fe=w(E),se=c(E,"ION-LABEL",{button:!0});var ne=m(se);ae=c(ne,"ION-TEXT",{color:!0});var he=m(ae);Ne=c(he,"H3",{});var ce=m(Ne);de=ge(ce,Ee),ce.forEach(a),he.forEach(a),Ie=w(ne),Te=c(ne,"DIV",{class:!0,"data-svelte-h":!0}),te(Te)!=="svelte-130ohbs"&&(Te.innerHTML=Oe),ne.forEach(a),ke=w(E),pe=c(E,"ION-ICON",{icon:!0,slot:!0}),m(pe).forEach(a),E.forEach(a),k.forEach(a),ie.forEach(a),this.h()},h(){v(t,"slot","fixed"),J(T,"class","order svelte-egzizz"),J(_,"class","order-wrapper svelte-egzizz"),J(_,"title",h="$"+r[6].origin),O(_,"background-color",r[6].color),O(_,"color",Ae(r[6].color)),v(u,"slot","start"),v(b,"color","#2e2e2e"),J(q,"class","sub svelte-egzizz"),v(p,"button",""),v(M,"icon",Re),v(M,"slot","end"),J(K,"class","order svelte-egzizz"),J(G,"class","order-wrapper svelte-egzizz"),J(G,"title",le="$"+r[6].destination),O(G,"background-color",r[6].color),O(G,"color",Ae(r[6].color)),v(R,"slot","start"),v(ae,"color","#2e2e2e"),J(Te,"class","sub svelte-egzizz"),v(se,"button",""),v(pe,"icon",Re),v(pe,"slot","end")},m(x,ie){Q(x,e,ie),o(e,t),r[22](t),o(e,n),o(e,i),o(i,d),o(d,u),o(u,_),o(_,T),o(d,f),o(d,p),o(p,b),o(b,N),o(N,U),o(p,A),o(p,q),o(d,j),o(d,M),o(i,B);for(let k=0;k<I.length;k+=1)I[k]&&I[k].m(i,null);o(i,H),o(i,P),o(P,R),o(R,G),o(G,K),o(K,oe),o(P,fe),o(P,se),o(se,ae),o(ae,Ne),o(Ne,de),o(se,Ie),o(se,Te),o(P,ke),o(P,pe),ye||(we=[ue(t,"ionRefresh",r[10]),ue(p,"click",r[23]),ue(se,"click",r[25])],ye=!0)},p(x,ie){ie[0]&64&&h!==(h="$"+x[6].origin)&&J(_,"title",h),ie[0]&64&&O(_,"background-color",x[6].color),ie[0]&64&&O(_,"color",Ae(x[6].color)),ie[0]&64&&C!==(C=x[6].origin+"")&&Le(U,C),ie[0]&331808&&(be=Be(x[5]),I=xe(I,ie,re,1,x,be,S,i,$e,Kt,H,Bt)),ie[0]&32&&$!==($=x[5].length+1+"")&&Le(oe,$),ie[0]&64&&le!==(le="$"+x[6].destination)&&J(G,"title",le),ie[0]&64&&O(G,"background-color",x[6].color),ie[0]&64&&O(G,"color",Ae(x[6].color)),ie[0]&64&&Ee!==(Ee=x[6].destination+"")&&Le(de,Ee)},d(x){x&&a(e),r[22](null);for(let ie=0;ie<I.length;ie+=1)I[ie].d();ye=!1,Pe(we)}}}function jt(r){let e;return{c(){e=s("span"),this.h()},l(t){e=c(t,"SPAN",{class:!0}),m(e).forEach(a),this.h()},h(){J(e,"class","notes svelte-egzizz")},m(t,l){Q(t,e,l)},d(t){t&&a(e)}}}function qt(r,e){let t,l,n,i,d=parseInt(e[48].pos)+1+"",u,_,T,g,h,f,p=e[48].title+"",b,N,C=e[48].support_list&&e[48].support_list.length||e[16](e[48]),U,A,q="",X,j,M,B,I=C&&jt();function S(){return e[28](e[48])}return{key:r,first:null,c(){t=s("ion-item"),l=s("ion-avatar"),n=s("div"),i=s("div"),u=ve(d),T=y(),g=s("ion-label"),h=s("ion-text"),f=s("h3"),b=ve(p),N=y(),I&&I.c(),U=y(),A=s("div"),A.innerHTML=q,X=y(),j=s("ion-icon"),this.h()},l(H){t=c(H,"ION-ITEM",{});var P=m(t);l=c(P,"ION-AVATAR",{slot:!0});var R=m(l);n=c(R,"DIV",{class:!0,title:!0,style:!0});var G=m(n);i=c(G,"DIV",{class:!0});var K=m(i);u=ge(K,d),K.forEach(a),G.forEach(a),R.forEach(a),T=w(P),g=c(P,"ION-LABEL",{button:!0});var $=m(g);h=c($,"ION-TEXT",{color:!0});var oe=m(h);f=c(oe,"H3",{});var le=m(f);b=ge(le,p),N=w(le),I&&I.l(le),le.forEach(a),oe.forEach(a),U=w($),A=c($,"DIV",{class:!0,"data-svelte-h":!0}),te(A)!=="svelte-qaecoo"&&(A.innerHTML=q),$.forEach(a),X=w(P),j=c(P,"ION-ICON",{icon:!0,slot:!0}),m(j).forEach(a),P.forEach(a),this.h()},h(){J(i,"class","order svelte-egzizz"),J(n,"class","order-wrapper svelte-egzizz"),J(n,"title",_=Xe(e[48].status)),O(n,"background-color",De(e[48].status,e[48].date_service)),O(n,"color",Ae(De(e[48].status))),v(l,"slot","start"),v(h,"color","#2e2e2e"),J(A,"class","sub svelte-egzizz"),v(g,"button",""),v(j,"icon",Re),v(j,"slot","end"),this.first=t},m(H,P){Q(H,t,P),o(t,l),o(l,n),o(n,i),o(i,u),o(t,T),o(t,g),o(g,h),o(h,f),o(f,b),o(f,N),I&&I.m(f,null),o(g,U),o(g,A),o(t,X),o(t,j),M||(B=ue(g,"click",S),M=!0)},p(H,P){e=H,P[0]&32&&d!==(d=parseInt(e[48].pos)+1+"")&&Le(u,d),P[0]&32&&_!==(_=Xe(e[48].status))&&J(n,"title",_),P[0]&32&&O(n,"background-color",De(e[48].status,e[48].date_service)),P[0]&32&&O(n,"color",Ae(De(e[48].status))),P[0]&32&&p!==(p=e[48].title+"")&&Le(b,p),P[0]&32&&(C=e[48].support_list&&e[48].support_list.length||e[16](e[48])),C?I||(I=jt(),I.c(),I.m(f,null)):I&&(I.d(1),I=null)},d(H){H&&a(t),I&&I.d(),M=!1,B()}}}function Gt(r){let e;return{c(){e=s("span"),this.h()},l(t){e=c(t,"SPAN",{class:!0}),m(e).forEach(a),this.h()},h(){J(e,"class","notes svelte-egzizz")},m(t,l){Q(t,e,l)},d(t){t&&a(e)}}}function Kt(r,e){let t,l,n,i,d=parseInt(e[48].pos)+1+"",u,_,T,g,h,f,p=e[48].title+"",b,N,C=e[48].support_list&&e[48].support_list.length||e[16](e[48]),U,A,q="",X,j,M,B,I=C&&Gt();function S(){return e[24](e[48])}return{key:r,first:null,c(){t=s("ion-item"),l=s("ion-avatar"),n=s("div"),i=s("div"),u=ve(d),T=y(),g=s("ion-label"),h=s("ion-text"),f=s("h3"),b=ve(p),N=y(),I&&I.c(),U=y(),A=s("div"),A.innerHTML=q,X=y(),j=s("ion-icon"),this.h()},l(H){t=c(H,"ION-ITEM",{});var P=m(t);l=c(P,"ION-AVATAR",{slot:!0});var R=m(l);n=c(R,"DIV",{class:!0,title:!0,style:!0});var G=m(n);i=c(G,"DIV",{class:!0});var K=m(i);u=ge(K,d),K.forEach(a),G.forEach(a),R.forEach(a),T=w(P),g=c(P,"ION-LABEL",{button:!0});var $=m(g);h=c($,"ION-TEXT",{color:!0});var oe=m(h);f=c(oe,"H3",{});var le=m(f);b=ge(le,p),N=w(le),I&&I.l(le),le.forEach(a),oe.forEach(a),U=w($),A=c($,"DIV",{class:!0,"data-svelte-h":!0}),te(A)!=="svelte-qaecoo"&&(A.innerHTML=q),$.forEach(a),X=w(P),j=c(P,"ION-ICON",{icon:!0,slot:!0}),m(j).forEach(a),P.forEach(a),this.h()},h(){J(i,"class","order svelte-egzizz"),J(n,"class","order-wrapper svelte-egzizz"),J(n,"title",_=Xe(e[48].status)),O(n,"background-color",De(e[48].status,e[48].date_service)),O(n,"color",Ae(De(e[48].status))),v(l,"slot","start"),v(h,"color","#2e2e2e"),J(A,"class","sub svelte-egzizz"),v(g,"button",""),v(j,"icon",Re),v(j,"slot","end"),this.first=t},m(H,P){Q(H,t,P),o(t,l),o(l,n),o(n,i),o(i,u),o(t,T),o(t,g),o(g,h),o(h,f),o(f,b),o(f,N),I&&I.m(f,null),o(g,U),o(g,A),o(t,X),o(t,j),M||(B=ue(g,"click",S),M=!0)},p(H,P){e=H,P[0]&32&&d!==(d=parseInt(e[48].pos)+1+"")&&Le(u,d),P[0]&32&&_!==(_=Xe(e[48].status))&&J(n,"title",_),P[0]&32&&O(n,"background-color",De(e[48].status,e[48].date_service)),P[0]&32&&O(n,"color",Ae(De(e[48].status))),P[0]&32&&p!==(p=e[48].title+"")&&Le(b,p),P[0]&32&&(C=e[48].support_list&&e[48].support_list.length||e[16](e[48])),C?I||(I=Gt(),I.c(),I.m(f,null)):I&&(I.d(1),I=null)},d(H){H&&a(t),I&&I.d(),M=!1,B()}}}function bo(r){let e,t,l,n,i=`<ion-icon icon="${Tn}"></ion-icon>`,d,u,_,T=`<ion-icon icon="${Cn}"></ion-icon>`,g,h,f=(r[6].name?r[6].name.toUpperCase():"")+"",p,b,N,C='<ion-segment-button value="list"><ion-label>Paradas</ion-label></ion-segment-button> <ion-segment-button value="map"><ion-label>Mapa</ion-label></ion-segment-button>',U,A,q,X;function j(I,S){if(I[9]==="list")return ho;if(I[9]==="map")return _o}let M=j(r),B=M&&M(r);return{c(){e=s("ion-header"),t=s("ion-toolbar"),l=s("ion-buttons"),n=s("ion-button"),n.innerHTML=i,d=y(),u=s("ion-buttons"),_=s("ion-button"),_.innerHTML=T,g=y(),h=s("ion-title"),p=ve(f),b=y(),N=s("ion-segment"),N.innerHTML=C,U=y(),B&&B.c(),A=Se(),this.h()},l(I){e=c(I,"ION-HEADER",{translucent:!0});var S=m(e);t=c(S,"ION-TOOLBAR",{});var H=m(t);l=c(H,"ION-BUTTONS",{slot:!0});var P=m(l);n=c(P,"ION-BUTTON",{title:!0,alt:!0,"data-svelte-h":!0}),te(n)!=="svelte-7ppz3r"&&(n.innerHTML=i),P.forEach(a),d=w(H),u=c(H,"ION-BUTTONS",{slot:!0});var R=m(u);_=c(R,"ION-BUTTON",{"data-svelte-h":!0}),te(_)!=="svelte-nf50hj"&&(_.innerHTML=T),R.forEach(a),g=w(H),h=c(H,"ION-TITLE",{});var G=m(h);p=ge(G,f),G.forEach(a),H.forEach(a),b=w(S),N=c(S,"ION-SEGMENT",{value:!0,"data-svelte-h":!0}),te(N)!=="svelte-lue4c9"&&(N.innerHTML=C),S.forEach(a),U=w(I),B&&B.l(I),A=Se(),this.h()},h(){v(n,"title","Atrás"),v(n,"alt","Atrás"),v(l,"slot","start"),v(u,"slot","end"),v(N,"value","list"),v(e,"translucent","")},m(I,S){Q(I,e,S),o(e,t),o(t,l),o(l,n),o(t,d),o(t,u),o(u,_),o(t,g),o(t,h),o(h,p),o(e,b),o(e,N),Q(I,U,S),B&&B.m(I,S),Q(I,A,S),q||(X=[ue(n,"click",r[17]),ue(_,"click",r[20]),ue(N,"ionChange",r[21])],q=!0)},p(I,S){S[0]&64&&f!==(f=(I[6].name?I[6].name.toUpperCase():"")+"")&&Le(p,f),M===(M=j(I))&&B?B.p(I,S):(B&&B.d(1),B=M&&M(I),B&&(B.c(),B.m(A.parentNode,A)))},d(I){I&&(a(e),a(U),a(A)),B&&B.d(I),q=!1,Pe(X)}}}function Eo(r){let e,t,l,n=r[2]&&Rt(r);return{c(){e=y(),n&&n.c(),t=Se(),this.h()},l(i){on("svelte-kn0kph",Dt.head).forEach(a),e=w(i),n&&n.l(i),t=Se(),this.h()},h(){Dt.title="Rutaflow - Detalles de ruta"},m(i,d){Q(i,e,d),n&&n.m(i,d),Q(i,t,d),l=!0},p(i,d){i[2]?n?(n.p(i,d),d[0]&4&&it(n,1)):(n=Rt(i),n.c(),it(n,1),n.m(t.parentNode,t)):n&&(dn(),st(n,1,1,()=>{n=null}),an())},i(i){l||(it(n),l=!0)},o(i){st(n),l=!1},d(i){i&&(a(e),a(t)),n&&n.d(i)}}}function De(r,e=""){let t="#ffffff";return r==="pending"&&!e?t="#f2e300":r=="pending"&&e?t="#F6A833":r==="completed"&&(t="#44d900"),t}function Xe(r){let e="";return r=="pending"?e="Pendiente":r=="completed"&&(e="Completado"),e}function Ae(r){r.slice(0,1)==="#"&&(r=r.slice(1)),r.length===3&&(r=r.split("").map(function(i){return i+i}).join(""));const e=parseInt(r.substr(0,2),16),t=parseInt(r.substr(2,2),16),l=parseInt(r.substr(4,2),16);return(e*299+t*587+l*114)/1e3>=128?"#414040":"#fff"}function Xt(r,e){for(let t=0;t<e.length;t++)if(e[t].alias===r)return e[t].val;return""}const Io=r=>r.mandatory==="1",ko=r=>r.img;function Oo(r,e,t){let l;ln(r,yn,k=>t(19,l=k));var n=this&&this.__awaiter||function(k,L,D,z){function W(F){return F instanceof D?F:new D(function(Y){Y(F)})}return new(D||(D=Promise))(function(F,Y){function E(Z){try{ee(z.next(Z))}catch(ne){Y(ne)}}function V(Z){try{ee(z.throw(Z))}catch(ne){Y(ne)}}function ee(Z){Z.done?F(Z.value):W(Z.value).then(E,V)}ee((z=z.apply(k,L||[])).next())})};let{routeId:i}=e,{driverId:d}=e,u=rt,_=new Object,T=!0,g=!1,h=[],f={},p=[],b=[],N,C=!1,U="list",A,q="",X="",j=new Object;const M=()=>n(void 0,void 0,void 0,function*(){yield S(i),N.complete()});Ze(()=>n(void 0,void 0,void 0,function*(){ae(),yield S(i)}));function B(k){return n(this,void 0,void 0,function*(){if(t(9,U=k),U==="map"){yield rn(),A=document.getElementById("g_map");const L=new google.maps.Map(A,{zoom:8,center:{lat:20.6745683,lng:-103.3986104},mapId:"4504f8b37365c3d0"}),D=new google.maps.LatLngBounds,{AdvancedMarkerElement:z,PinElement:W}=yield google.maps.importLibrary("marker");navigator.geolocation?navigator.geolocation.getCurrentPosition(function(F){const Y=new google.maps.LatLng(F.coords.latitude,F.coords.longitude);new google.maps.Marker({position:Y,map:L,icon:{path:google.maps.SymbolPath.CIRCLE,fillColor:"#0062ff",fillOpacity:1,scale:6,strokeColor:"#ffffff",strokeWeight:2}}),new google.maps.Circle({strokeColor:"#00BFFF",strokeOpacity:.5,strokeWeight:1,fillColor:"#00BFFF",fillOpacity:.2,map:L,center:Y,radius:F.coords.accuracy}),D.extend(Y)},function(F){console.error("Error retrieving location:",F)}):console.error("Geolocation not supported by this browser."),f.lat1===f.lat2&&f.lon1===f.lon2?I(D,L,{lat:f.lat2,lon:f.lon2,color:f.color,title:f.destination},{type:"icon",iconClass:"icon-home",title:"Origen/Destino",glyph:`0,${String(h.length+1)}`}):(I(D,L,{lat:f.lat1,lon:f.lon1,color:f.color,title:f.origin},{type:"icon",iconClass:"icon-home",title:"Origen",glyph:"0"}),I(D,L,{lat:f.lat2,lon:f.lon2,color:f.color,title:f.destination},{type:"icon",iconClass:"icon-flag",title:"Destino",glyph:String(h.length+1)})),h.forEach((F,Y)=>{const E=parseFloat(F.lat),V=parseFloat(F.lon),ee=new google.maps.LatLng(E,V),Z=new google.maps.Marker({position:{lat:E,lng:V},map:L,title:F.title}),ne=new W({background:De(F.status,F.date_service),borderColor:"#000",glyphColor:"#000",glyph:(parseInt(F.pos)+1).toString()});new z({map:L,position:ee,content:ne.element,title:"Parada "+(parseInt(F.pos)+1).toString()+": "+F.title}).addListener("click",function(ce){P(F,!1)}),D.extend(Z.getPosition())}),L.fitBounds(D)}})}function I(k,L,D,z){return n(this,void 0,void 0,function*(){let W;const F=parseFloat(D.lat),Y=parseFloat(D.lon),E=new google.maps.LatLng(F,Y),{AdvancedMarkerElement:V,PinElement:ee}=yield google.maps.importLibrary("marker");z.type=="icon"?(W=document.createElement("i"),W.className=`${z.iconClass} icon`,W.style.fontSize="14px",W.style.color=Ae(D.color),W.style.fontWeight="600"):z.type=="text";const Z=new google.maps.Marker({position:{lat:F,lng:Y},map:L,title:`${z.title}. ${D.title}`}),ne=new ee({background:D.color,borderColor:"#000",glyphColor:Ae(D.color),glyph:z.glyph});return new V({map:L,position:E,content:ne.element,title:z.title+": "+D.title}).addListener("click",function(ce){R(f,z.title=="Destino"||z.title=="Origen/Destino")}),Z})}function S(k){return n(this,void 0,void 0,function*(){let L=new FormData;L.append("id_route",k),L=se(L);try{const z=yield(yield fetch(`${u}api/admin/report/seguimiento_list.php`,{method:"POST",body:L})).json();t(6,f=z.data.seguimiento_list[0]),t(5,h=z.data.event_list),t(7,p=z.data.checklist),b=z.data.expenses,f&&t(4,g=f.km_inicial=="0"&&f.gas_inicial=="0"),t(3,T=!1)}catch(D){t(3,T=!1),console.error("Error fetching data:",D)}})}const H=k=>new Promise((L,D)=>{let z=new FormData;z.append("id_route",k.id_route),z.append("id_event",k.id_event),z=se(z),fetch(`${u}api/admin/evidence/evidence_by_event.php`,{method:"POST",body:z}).then(W=>W.json()).then(W=>{L(W.data.event_evidence[0])}).catch(W=>{console.error("Error fetching data:",W),D(W)})}),P=(k,L)=>{H(k).then(D=>{k.stopsApproval=q,k.smsActive=X,D&&(k.img=D.img,k.driver_comments=D.driver_comments,k.comments=D.comments),Ue("modal-delivery-info",Lt,{delivery:k,isLast:L}).then(z=>{}).finally(()=>{S(i)})})},R=(k,L)=>{var D=new Object;L?D={title:k.destination,line1:k.dest_address}:D={title:k.origin,line1:k.origin_address},D.client_name=k.client_name,D.client_phone=k.tel,D.id_route=k.id_route,D.stopsApproval=q,D.smsActive=X;var z=!0;Ue("modal-delivery-info",Lt,{delivery:D,isLast:L,flag:z})},G=(k,L,D)=>{var z=!1;return C||(C=!0,Ue("modal-checklist",Zt,{checklist:k,driverId:L,routeId:D,isLast:z}).then(W=>{C=!1}),oe(D,"checklist")),""},K=k=>n(void 0,void 0,void 0,function*(){return yield S(k),b.length>0?Ue("modal-expense-detail",fo,{routeId:k,expenses:b}).then(L=>{}):Ue("modal-expense",ft,{routeId:k}).then(L=>{}),""}),$=k=>{if(k.tracking_type=="subscription"){if(k.subscriber_info&&k.payment_type==="cash"&&new Date(k.subscriber_info.payment_next)<new Date)return!0}else if(k.tracking_type=="ecommerce"&&Number(k.payment_pending)>0)return!0;return!1};function oe(k,L){let D=new FormData;return D.append("id_route",k),D.append("status",L),D=se(D),fetch(`${u}api/admin/route/change_status.php`,{method:"POST",body:D}).then(z=>z.json()).then(z=>{}).catch(z=>{console.error("Error fetching data:",z)}),""}const le=()=>{_.type=="super"||_.type=="admin"?Fe("/drivers/me"):_.id_driver&&Fe(`/drivers/${_.id_driver}`)},fe=(k,L)=>n(void 0,void 0,void 0,function*(){yield(yield je.create({header:k||"Error",message:L||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()});function se(k){return k.append("token",_.token),k.append("id_user_over",_.id_user),k}const ae=()=>n(void 0,void 0,void 0,function*(){if(_.id_enterprise){let k=new FormData;k.append("id_enterprise",_.id_enterprise),k=se(k);try{const L=yield fetch(`${u}api/admin/enterprise/enterprise_settings.php`,{method:"POST",body:k});L.ok?(j=(yield L.json()).nodos,q=Xt("stops_wait_approval",j),X=Xt("sms_active",j)):console.error("File upload failed:",L.statusText)}catch(L){console.error("Error during file upload:",L)}}}),Ne=()=>K(i),Ee=k=>B(k.detail.value);function de(k){Me[k?"unshift":"push"](()=>{N=k,t(8,N)})}const Ie=()=>{R(f,!1)},Te=k=>{const L=h.findIndex(Y=>Y.id_event===k.id_event),D=L===0,z=L>0?h[L-1]:null,W=D||z&&z.img!==null,F=k.img!==null&&k.img!=="";W||D&&!F?P(k,!1):fe("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")},Oe=()=>{R(f,!0)};function ke(k){Me[k?"unshift":"push"](()=>{N=k,t(8,N)})}const pe=()=>{R(f,!1)},ye=k=>{const L=h.findIndex(Y=>Y.id_event===k.id_event),D=L===0,z=L>0?h[L-1]:null,W=D||z&&z.img!==null,F=k.img!==null&&k.img!=="";W||D&&!F?P(k,!1):fe("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")},we=()=>{R(f,!0)};function be(k){Me[k?"unshift":"push"](()=>{N=k,t(8,N)})}const re=()=>{R(f,!1)},x=k=>{const L=h.findIndex(Y=>Y.id_event===k.id_event),D=L===0,z=L>0?h[L-1]:null,W=D||z&&z.img!==null,F=k.img!==null&&k.img!=="";W||D&&!F?P(k,!1):fe("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")},ie=()=>{R(f,!0)};return r.$$set=k=>{"routeId"in k&&t(0,i=k.routeId),"driverId"in k&&t(1,d=k.driverId)},r.$$.update=()=>{r.$$.dirty[0]&524293&&(t(0,{routeId:i,driverId:d}=l.params,i,(t(1,d),t(19,l),t(2,_),t(0,i))),t(2,_=JSON.parse(localStorage.getItem("userSession"))),_?_.id_user&&(_.type=="admin"||_.type=="super")?(S(i),Fe(`/drivers/me/routes/${i}`)):_.id_user&&_.id_driver&&(S(i),Fe(`/drivers/${_.id_driver}/routes/${i}`)):Fe("/"))},[i,d,_,T,g,h,f,p,N,U,M,B,P,R,G,K,$,le,fe,l,Ne,Ee,de,Ie,Te,Oe,ke,pe,ye,we,be,re,x,ie]}class Ao extends Je{constructor(e){super(),Ye(this,e,Oo,Eo,We,{routeId:0,driverId:1},null,[-1,-1])}}export{Ao as component};

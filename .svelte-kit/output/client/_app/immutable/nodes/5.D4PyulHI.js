import{Z as mt,s as Ye,e as c,j as T,b as u,q as E,d as J,h as a,m as C,v as m,i as U,w as l,x as ne,n as Ne,z as Ue,_ as xt,B as V,o as ot,k as Me,$ as vt,t as ue,r as fe,f as W,a0 as $t,a1 as nt,A as Pe,y as we,a2 as ut,l as en,p as tn,F as nn}from"../chunks/index.BYLndrM5.js";import{S as Ze,i as xe,t as ct,a as _t,c as on,b as ln,d as rn,m as an,e as sn,g as cn}from"../chunks/index.BNHbygFo.js";import{e as Re,u as lt,d as it,a as un,c as dt,b as Xt,f as fn,g as _n,i as Jt,h as dn,j as Qt,s as gt,k as $e,m as hn,n as pn,o as mn,q as vn,r as gn,p as bn}from"../chunks/index.kLV6oKSN.js";import"../chunks/index-48209844.IIRtDZyg.js";import{m as rt,a as Ke,I as En}from"../chunks/IonPage.KvUD72q2.js";import{q as In,t as kn}from"../chunks/ion-modal.CsJaVgKZ.js";import{g as Ge}from"../chunks/entry.CDO_KCFi.js";const On=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global,Nn=(i,e)=>{if(!customElements.get(i)){class t extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const n={};for(const r of this.attributes)n[r.name]=r.value;new e({target:this.shadowRoot,props:n})}}customElements.define(i,t)}},Tn=function(i){return document.createElement(i).constructor!==HTMLElement},Cn=(i,e)=>{Tn(i)||Nn(i,e)},qe=async(i,e,t)=>{In(),kn(),Cn(i,e);const o=await rt.create({component:i,componentProps:t});return o.present(),await o.onWillDismiss()};let Xe=mt({km_inicial:[],gas_inicial:[],km_final:[],gas_final:[]}),Yt=mt({flag:[]});function yn(i){let e,t,o,n,r="Cancelar",h,_,g="Captura de Km/Gas",O,k,f,s="Confirmar",p,d,v,I,M,S,R;return{c(){e=c("ion-header"),t=c("ion-toolbar"),o=c("ion-buttons"),n=c("ion-button"),n.textContent=r,h=T(),_=c("ion-title"),_.textContent=g,O=T(),k=c("ion-buttons"),f=c("ion-button"),f.textContent=s,p=T(),d=c("ion-content"),v=c("ion-item"),I=c("ion-input"),this.h()},l(D){e=u(D,"ION-HEADER",{translucent:!0});var q=E(e);t=u(q,"ION-TOOLBAR",{});var N=E(t);o=u(N,"ION-BUTTONS",{slot:!0});var y=E(o);n=u(y,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),J(n)!=="svelte-17pq4f4"&&(n.textContent=r),y.forEach(a),h=C(N),_=u(N,"ION-TITLE",{"data-svelte-h":!0}),J(_)!=="svelte-1yhkaq7"&&(_.textContent=g),O=C(N),k=u(N,"ION-BUTTONS",{slot:!0});var w=E(k);f=u(w,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),J(f)!=="svelte-cm6j4s"&&(f.textContent=s),w.forEach(a),N.forEach(a),q.forEach(a),p=C(D),d=u(D,"ION-CONTENT",{fullscreen:!0});var b=E(d);v=u(b,"ION-ITEM",{});var A=E(v);I=u(A,"ION-INPUT",{class:!0,inputmode:!0,pattern:!0,type:!0,placeholder:!0,value:!0,required:!0});var L=E(I);L.forEach(a),A.forEach(a),b.forEach(a),this.h()},h(){m(n,"color","medium"),m(o,"slot","start"),m(f,"strong",""),m(k,"slot","end"),m(e,"translucent",""),m(I,"class","fin-km"),m(I,"inputmode","numeric"),m(I,"pattern","[0-9]*"),m(I,"type","number"),m(I,"placeholder",M="Ingresa "+i[0]+" actual"),m(I,"value",i[1]),m(I,"required",""),m(d,"fullscreen","")},m(D,q){U(D,e,q),l(e,t),l(t,o),l(o,n),l(t,h),l(t,_),l(t,O),l(t,k),l(k,f),U(D,p,q),U(D,d,q),l(d,v),l(v,I),S||(R=[ne(n,"click",i[2]),ne(f,"click",i[3]),ne(I,"input",i[4])],S=!0)},p(D,[q]){q&1&&M!==(M="Ingresa "+D[0]+" actual")&&m(I,"placeholder",M),q&2&&m(I,"value",D[1])},i:Ne,o:Ne,d(D){D&&(a(e),a(p),a(d)),S=!1,Ue(R)}}}function wn(i,e,t){const o=xt();let n=document.querySelector("ion-modal"),r=n.componentProps.data_type;n.componentProps.isLast;let h;Yt.subscribe(f=>{r=f.flag[0],r=="km_final"||r=="km_inicial"?t(0,h="kilometraje"):t(0,h="litros de gasolina")});let _=0;function g(){rt.dismiss()}function O(){o("modalResult",{data:"Your data",role:"confirm"}),r=="km_inicial"?Xe.update(s=>({...s,km_inicial:[_]})):r=="gas_inicial"?Xe.update(s=>({...s,gas_inicial:[_]})):r=="km_final"?Xe.update(s=>({...s,km_final:[_]})):r=="gas_final"&&Xe.update(s=>({...s,gas_final:[_]})),g()}return[h,_,g,O,f=>t(1,_=f.target.value)]}class Ln extends Ze{constructor(e){super(),xe(this,e,wn,yn,Ye,{})}}const ft=mt({items:[],checkedIndices:[],mandatory:[]});function kt(i,e,t){const o=i.slice();return o[51]=e[t],o[52]=e,o[53]=t,o}function Sn(i){let e,t,o,n,r,h="Kilometraje inicial",_,g,O=i[0]?i[0]+" km.":"Cargar km",k,f,s,p,d,v,I,M="Gasolina inicial (litros)",S,R,D=i[1]?i[1]+" litros":"Cargar gas",q,N,y,w;return N=vt(i[21][0]),{c(){e=c("ion-item"),t=c("ion-label"),o=c("input"),n=T(),r=c("p"),r.textContent=h,_=T(),g=c("ion-button"),k=ue(O),f=T(),s=c("ion-item"),p=c("ion-label"),d=c("input"),v=T(),I=c("p"),I.textContent=M,S=T(),R=c("ion-button"),q=ue(D),this.h()},l(b){e=u(b,"ION-ITEM",{});var A=E(e);t=u(A,"ION-LABEL",{style:!0});var L=E(t);o=u(L,"INPUT",{id:!0,style:!0,type:!0}),n=C(L),r=u(L,"P",{style:!0,"data-svelte-h":!0}),J(r)!=="svelte-88twxi"&&(r.textContent=h),L.forEach(a),_=C(A),g=u(A,"ION-BUTTON",{fill:!0,size:!0,class:!0,"aria-selected":!0});var P=E(g);k=fe(P,O),P.forEach(a),A.forEach(a),f=C(b),s=u(b,"ION-ITEM",{});var B=E(s);p=u(B,"ION-LABEL",{style:!0});var F=E(p);d=u(F,"INPUT",{id:!0,style:!0,type:!0}),v=C(F),I=u(F,"P",{style:!0,"data-svelte-h":!0}),J(I)!=="svelte-1ux30eb"&&(I.textContent=M),F.forEach(a),S=C(B),R=u(B,"ION-BUTTON",{fill:!0,class:!0,size:!0,style:!0});var j=E(R);q=fe(j,D),j.forEach(a),B.forEach(a),this.h()},h(){W(o,"id","chkbox-km-ini"),V(o,"pointer-events","auto"),W(o,"type","checkbox"),o.required=!0,V(r,"margin-left","10px"),V(t,"display","flex"),m(g,"fill","outline"),m(g,"size","small"),m(g,"class","loadKmInicial"),m(g,"aria-selected",""),W(d,"id","chkbox-gas-ini"),V(d,"pointer-events","auto"),W(d,"type","checkbox"),d.required=!0,V(I,"margin-left","10px"),V(p,"display","flex"),m(R,"fill","outline"),m(R,"class","loadGasInicial"),m(R,"size","small"),V(R,"height","16px "),N.p(o,d)},m(b,A){U(b,e,A),l(e,t),l(t,o),o.checked=~(i[4]||[]).indexOf(o.__value),i[28](o),l(t,n),l(t,r),l(e,_),l(e,g),l(g,k),U(b,f,A),U(b,s,A),l(s,p),l(p,d),i[30](d),d.checked=~(i[4]||[]).indexOf(d.__value),l(p,v),l(p,I),l(s,S),l(s,R),l(R,q),y||(w=[ne(o,"change",i[27]),ne(g,"click",i[29]),ne(d,"change",i[31]),ne(R,"click",i[32])],y=!0)},p(b,A){A[0]&16&&(o.checked=~(b[4]||[]).indexOf(o.__value)),A[0]&1&&O!==(O=b[0]?b[0]+" km.":"Cargar km")&&we(k,O),A[0]&16&&(d.checked=~(b[4]||[]).indexOf(d.__value)),A[0]&2&&D!==(D=b[1]?b[1]+" litros":"Cargar gas")&&we(q,D)},d(b){b&&(a(e),a(f),a(s)),i[28](null),i[30](null),N.r(),y=!1,Ue(w)}}}function Pn(i){let e,t,o,n,r,h="Kilometraje final",_,g,O=i[2]?i[2]+" km.":"Cargar km",k,f,s,p,d,v,I,M="Gasolina final (litros)",S,R,D=i[3]?i[3]+" litros":"Cargar gas",q,N,y,w;return N=vt(i[21][0]),{c(){e=c("ion-item"),t=c("ion-label"),o=c("input"),n=T(),r=c("p"),r.textContent=h,_=T(),g=c("ion-button"),k=ue(O),f=T(),s=c("ion-item"),p=c("ion-label"),d=c("input"),v=T(),I=c("p"),I.textContent=M,S=T(),R=c("ion-button"),q=ue(D),this.h()},l(b){e=u(b,"ION-ITEM",{});var A=E(e);t=u(A,"ION-LABEL",{style:!0});var L=E(t);o=u(L,"INPUT",{id:!0,style:!0,type:!0}),n=C(L),r=u(L,"P",{style:!0,"data-svelte-h":!0}),J(r)!=="svelte-ccmu71"&&(r.textContent=h),L.forEach(a),_=C(A),g=u(A,"ION-BUTTON",{fill:!0,size:!0,class:!0,"aria-selected":!0});var P=E(g);k=fe(P,O),P.forEach(a),A.forEach(a),f=C(b),s=u(b,"ION-ITEM",{});var B=E(s);p=u(B,"ION-LABEL",{style:!0});var F=E(p);d=u(F,"INPUT",{id:!0,style:!0,type:!0}),v=C(F),I=u(F,"P",{style:!0,"data-svelte-h":!0}),J(I)!=="svelte-wsoyd2"&&(I.textContent=M),F.forEach(a),S=C(B),R=u(B,"ION-BUTTON",{fill:!0,size:!0,class:!0});var j=E(R);q=fe(j,D),j.forEach(a),B.forEach(a),this.h()},h(){W(o,"id","chkbox-km-fin"),V(o,"pointer-events","auto"),W(o,"type","checkbox"),o.required=!0,V(r,"margin-left","10px"),V(t,"display","flex"),m(g,"fill","outline"),m(g,"size","small"),m(g,"class","loadKmInicial"),m(g,"aria-selected",""),W(d,"id","chkbox-gas-fin"),V(d,"pointer-events","auto"),W(d,"type","checkbox"),d.required=!0,V(I,"margin-left","10px"),V(p,"display","flex"),m(R,"fill","outline"),m(R,"size","small"),m(R,"class","loadGasInicial"),N.p(o,d)},m(b,A){U(b,e,A),l(e,t),l(t,o),o.checked=~(i[4]||[]).indexOf(o.__value),i[22](o),l(t,n),l(t,r),l(e,_),l(e,g),l(g,k),U(b,f,A),U(b,s,A),l(s,p),l(p,d),d.checked=~(i[4]||[]).indexOf(d.__value),i[25](d),l(p,v),l(p,I),l(s,S),l(s,R),l(R,q),y||(w=[ne(o,"change",i[20]),ne(g,"click",i[23]),ne(d,"change",i[24]),ne(R,"click",i[26])],y=!0)},p(b,A){A[0]&16&&(o.checked=~(b[4]||[]).indexOf(o.__value)),A[0]&4&&O!==(O=b[2]?b[2]+" km.":"Cargar km")&&we(k,O),A[0]&16&&(d.checked=~(b[4]||[]).indexOf(d.__value)),A[0]&8&&D!==(D=b[3]?b[3]+" litros":"Cargar gas")&&we(q,D)},d(b){b&&(a(e),a(f),a(s)),i[22](null),i[25](null),N.r(),y=!1,Ue(w)}}}function Mn(i){let e=[],t=new Map,o,n=Re(i[13]);const r=h=>h[51].id_checklist_event;for(let h=0;h<n.length;h+=1){let _=kt(i,n,h),g=r(_);t.set(g,e[h]=Ot(g,_))}return{c(){for(let h=0;h<e.length;h+=1)e[h].c();o=Me()},l(h){for(let _=0;_<e.length;_+=1)e[_].l(h);o=Me()},m(h,_){for(let g=0;g<e.length;g+=1)e[g]&&e[g].m(h,_);U(h,o,_)},p(h,_){_[0]&407664&&(n=Re(h[13]),e=lt(e,_,r,1,h,n,t,o.parentNode,it,Ot,o,kt))},d(h){h&&a(o);for(let _=0;_<e.length;_+=1)e[_].d(h)}}}function An(i){let e,t=(i[12][i[51].id_checklist_event]?i[12][i[51].id_checklist_event]:"Cargar evidencia")+"",o;return{c(){e=c("label"),o=ue(t),this.h()},l(n){e=u(n,"LABEL",{for:!0,class:!0});var r=E(e);o=fe(r,t),r.forEach(a),this.h()},h(){W(e,"for","chklist-"+i[51].id_checklist_event),W(e,"class","button-label svelte-1ruehls")},m(n,r){U(n,e,r),l(e,o)},p(n,r){r[0]&4096&&t!==(t=(n[12][n[51].id_checklist_event]?n[12][n[51].id_checklist_event]:"Cargar evidencia")+"")&&we(o,t)},d(n){n&&a(e)}}}function Dn(i){let e;return{c(){e=c("ion-spinner"),this.h()},l(t){e=u(t,"ION-SPINNER",{name:!0,class:!0}),E(e).forEach(a),this.h()},h(){m(e,"name","dots"),m(e,"class","button-spinner svelte-1ruehls")},m(t,o){U(t,e,o)},p:Ne,d(t){t&&a(e)}}}function Ot(i,e){let t,o,n,r=e[51],h,_,g=e[51].item+"",O,k,f,s,p,d,v,I,M,S;const R=()=>e[34](n,r),D=()=>e[34](null,r);function q(){return e[35](e[51])}function N(A,L){return A[11][A[51].id_checklist_event]?Dn:An}let y=N(e),w=y(e);function b(...A){return e[37](e[51],...A)}return I=vt(e[21][0]),{key:i,first:null,c(){t=c("ion-item"),o=c("ion-label"),n=c("input"),h=T(),_=c("p"),O=ue(g),k=T(),f=c("ion-button"),s=c("div"),w.c(),p=T(),d=c("input"),v=T(),this.h()},l(A){t=u(A,"ION-ITEM",{});var L=E(t);o=u(L,"ION-LABEL",{style:!0});var P=E(o);n=u(P,"INPUT",{id:!0,style:!0,type:!0}),h=C(P),_=u(P,"P",{style:!0});var B=E(_);O=fe(B,g),B.forEach(a),P.forEach(a),k=C(L),f=u(L,"ION-BUTTON",{fill:!0,class:!0,size:!0});var F=E(f);s=u(F,"DIV",{class:!0});var j=E(s);w.l(j),p=C(j),d=u(j,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0}),j.forEach(a),F.forEach(a),v=C(L),L.forEach(a),this.h()},h(){W(n,"id",`chkbox-${e[51].id_checklist_event}`),V(n,"pointer-events","auto"),W(n,"type","checkbox"),n.__value=e[51].id_checklist_event,$t(n,n.__value),n.required=!0,V(_,"margin-left","10px"),V(o,"display","flex"),V(d,"display","none"),W(d,"id","chklist-"+e[51].id_checklist_event),W(d,"name","fileToUpload"),W(d,"type","file"),W(d,"accept","image/*"),W(s,"class","button-content svelte-1ruehls"),m(f,"fill","outline"),m(f,"class","loadEvidence svelte-1ruehls"),m(f,"size","small"),I.p(n),this.first=t},m(A,L){U(A,t,L),l(t,o),l(o,n),n.checked=~(e[4]||[]).indexOf(n.__value),R(),l(o,h),l(o,_),l(_,O),l(t,k),l(t,f),l(f,s),w.m(s,null),l(s,p),l(s,d),e[36](d),l(t,v),M||(S=[ne(n,"change",e[33]),ne(n,"change",q),ne(d,"change",b)],M=!0)},p(A,L){e=A,L[0]&16&&(n.checked=~(e[4]||[]).indexOf(n.__value)),r!==e[51]&&(D(),r=e[51],R()),y===(y=N(e))&&w?w.p(e,L):(w.d(1),w=y(e),w&&(w.c(),w.m(s,p)))},d(A){A&&a(t),D(),w.d(),e[36](null),I.r(),M=!1,Ue(S)}}}function Bn(i){let e,t,o,n,r="Cancelar",h,_,g="REQUERIMIENTOS DE RUTA",O,k,f,s,p,d,v,I="Confirmar",M,S;function R(y,w){return y[14]?Pn:Sn}let q=R(i)(i),N=i[13]&&Mn(i);return{c(){e=c("ion-header"),t=c("ion-toolbar"),o=c("ion-buttons"),n=c("ion-button"),n.textContent=r,h=T(),_=c("ion-title"),_.textContent=g,O=T(),k=c("ion-content"),f=c("ion-list"),q.c(),s=T(),N&&N.c(),p=T(),d=c("ion-footer"),v=c("ion-button"),v.textContent=I,this.h()},l(y){e=u(y,"ION-HEADER",{translucent:!0});var w=E(e);t=u(w,"ION-TOOLBAR",{});var b=E(t);o=u(b,"ION-BUTTONS",{slot:!0});var A=E(o);n=u(A,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),J(n)!=="svelte-1dnmkxs"&&(n.textContent=r),A.forEach(a),h=C(b),_=u(b,"ION-TITLE",{"data-svelte-h":!0}),J(_)!=="svelte-19bar5p"&&(_.textContent=g),b.forEach(a),w.forEach(a),O=C(y),k=u(y,"ION-CONTENT",{fullscreen:!0});var L=E(k);f=u(L,"ION-LIST",{});var P=E(f);q.l(P),s=C(P),N&&N.l(P),P.forEach(a),L.forEach(a),p=C(y),d=u(y,"ION-FOOTER",{});var B=E(d);v=u(B,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),J(v)!=="svelte-g82qqw"&&(v.textContent=I),B.forEach(a),this.h()},h(){m(n,"color","medium"),m(o,"slot","start"),m(e,"translucent",""),m(k,"fullscreen",""),m(v,"fill","outline"),m(v,"color","tertiary"),m(v,"strong",""),V(v,"width","99%"),V(v,"height","auto")},m(y,w){U(y,e,w),l(e,t),l(t,o),l(o,n),l(t,h),l(t,_),U(y,O,w),U(y,k,w),l(k,f),q.m(f,null),l(f,s),N&&N.m(f,null),U(y,p,w),U(y,d,w),l(d,v),M||(S=[ne(n,"click",i[15]),ne(v,"click",i[16])],M=!0)},p(y,w){q.p(y,w),y[13]&&N.p(y,w)},i:Ne,o:Ne,d(y){y&&(a(e),a(O),a(k),a(p),a(d)),q.d(),N&&N.d(),M=!1,Ue(S)}}}function ht(i,e){if(typeof i=="object"&&i!==null||Array.isArray(i)){if(Array.isArray(i))return i.map(t=>ht(t,e)).flat();{const t=Object.keys(i);let o;return e=="id_checklist_event"?o=t.filter(r=>r.toLowerCase().includes("id_checklist_event")).map(r=>i[r]):e=="mandatory"?o=t.filter(r=>r.toLowerCase().includes("mandatory")).map(r=>i[r]):(console.error("Tipo de dato no reconocido."),o=!1),o}}else return console.error("Invalid input. Please provide a valid object or array."),[]}function st(i,e){let t=new FormData;t.append("id_route",i),t.append("status",e),fetch("https://dev.rutaflow.com/api/admin/route/change_status.php",{method:"POST",body:t}).then(o=>o.json()).then(o=>{}).catch(o=>{console.error("Error fetching data:",o)})}function zn(i,e,t){let o=document.querySelector("ion-modal");const n=o.componentProps.checklist,r=o.componentProps.driverId,h=o.componentProps.routeId,_=o.componentProps.isLast;let g,O,k,f,s=[],p=null,d={},v,I,M,S,R={},D={},q={};ot(()=>{_?console.log("Último checklist"):ft.update(z=>(z.mandatory=ht(n,"mandatory"),z.items=ht(n,"id_checklist_event"),z))});function N(z){t(11,R[z]=!0,R)}const y=async()=>{await(await Ke.create({header:"Datos o checklist incompletos",message:"Carga la evidencia requerida y marca todas las casillas para confirmar",buttons:[{text:"Cerrar"}]})).present()},w=async()=>{await(await Ke.create({header:"Datos capturados",message:"El kilometraje y gasolina final fueron registrados correctamente, espere aprobación para finalizar ruta",buttons:[{text:"Cerrar"}]})).present()},b=async z=>{await(await Ke.create({header:"Datos inválidos",message:z=="km"?"Llena correctamente el campo de kilometraje inicial":"Llena correctamente el campo de gasolina inicial",buttons:[{text:"Cerrar"}]})).present()},A=()=>{rt.dismiss(),r?Ge(`/drivers/${r}`):Ge("/drivers/me")},L=()=>{if(_){var z=j(k,"km"),G=j(f,"gas");const ge=new FormData;ge.append("km_final",z),ge.append("gas_final",G),ge.append("id_route",h),z&&G?(A(),fetch("https://dev.rutaflow.com/api/admin/checklist/add_evidence.php",{method:"POST",body:ge}).then(Z=>Z.json()).then(Z=>{w()}).catch(Z=>{console.error("Error fetching data:",Z)})):y()}else{var pe=j(g,"km"),Ce=j(O,"gas");ft.update(ge=>{const Z=ge.items,Q=ge.mandatory;if(Z.every(te=>ge.checkedIndices.includes(te))&&pe&&Ce){A();const te=new FormData;for(const ae in D)if(D.hasOwnProperty(ae)){const{img:Ie,img_id:oe}=D[ae];te.append(`selectedImages[${ae}][img]`,Ie),te.append(`selectedImages[${ae}][img_id]`,oe)}te.append("km_inicial",pe),te.append("gas_inicial",Ce),te.append("id_route",h),fetch("https://dev.rutaflow.com/api/admin/checklist/add_evidence.php",{method:"POST",body:te}).then(ae=>ae.json()).then(ae=>{Q&&Q[0]=="1"?st(h,"checklist-pending"):st(h,"enroute")}).catch(ae=>{console.error("Error fetching data:",ae)})}else if(!Q&&pe&&Ce){var ce=new FormData;ce.append("km_inicial",pe),ce.append("gas_inicial",Ce),fetch("https://dev.rutaflow.com/api/admin/checklist/add_evidence.php",{method:"POST",body:ce}).then(te=>te.json()).then(te=>{st(h,"enroute")}).catch(te=>{console.error("Error fetching data:",te)})}else y();return ge})}de()},P=async(z,G)=>{N(G);const Ce=z.target.files[0],ge=await B(Ce);if(ge){const Z=new FormData;Z.append("fileToUpload",ge);try{const Q=await fetch("https://dev.rutaflow.com/api/admin/manager/upload_img_driver.php",{method:"POST",body:Z});if(Q.ok){const Y=await Q.json();D={...D,[G]:{img:Y.img,img_id:Y.img_id}},t(12,q={...q,[G]:Y.filename}),F(G),t(6,d[G].checked=!0,d),t(11,R[G]=!1,R)}else console.error("File upload failed:",Q.statusText)}catch(Q){console.error("Error during file upload:",Q)}}},B=async z=>new Promise(G=>{const pe=new FileReader;pe.onload=Ce=>{const ge=new Image;ge.src=Ce.target.result,ge.onload=()=>{const Z=document.createElement("canvas"),Q=Z.getContext("2d"),Y=800,ce=600;let te=ge.width,ae=ge.height;te>Y&&(ae*=Y/te,te=Y),ae>ce&&(te*=ce/ae,ae=ce),Z.width=te,Z.height=ae,Q.drawImage(ge,0,0,te,ae),Z.toBlob(Ie=>{G(Ie)},"image/jpeg",.7)}},pe.readAsDataURL(z)}),F=z=>{ft.update(G=>(G.checkedIndices.indexOf(z)===-1?G.checkedIndices.push(z):console.error(`ID ${z} is already checked.`),G.items.forEach(Ce=>{Ce.id_checklist_event===z&&(Ce.checked=!0)}),G))};function j(z,G){return/^\d+$/.test(z)?parseInt(z,10):(b(G),null)}function X(z,G){_e(G),o.componentProps.data_type=G,qe("modal-gas-km",Ln,{r:G}).then(()=>{Xe.subscribe(pe=>{ee(pe,G)})})}function _e(z){Yt.update(G=>({...G,flag:[z]}))}function ee(z,G){t(0,g=z.km_inicial?z.km_inicial:null),t(1,O=z.gas_inicial?z.gas_inicial:null),t(2,k=z.km_final?z.km_final:null),t(3,f=z.gas_final?z.gas_final:null),G=="km_inicial"&&t(7,v.checked=!0,v),G=="gas_inicial"&&t(8,I.checked=!0,I),G=="km_final"&&t(9,M.checked=!0,M),G=="gas_final"&&t(10,S.checked=!0,S)}function de(){Xe.set({km_inicial:[],gas_inicial:[],km_final:[],gas_final:[]})}const be=[[]];function H(){s=nt(be[0],this.__value,this.checked),t(4,s)}function K(z){Pe[z?"unshift":"push"](()=>{M=z,t(9,M)})}const x=z=>X(z,"km_final");function le(){s=nt(be[0],this.__value,this.checked),t(4,s)}function ie(z){Pe[z?"unshift":"push"](()=>{S=z,t(10,S)})}const he=z=>X(z,"gas_final");function Ee(){s=nt(be[0],this.__value,this.checked),t(4,s)}function me(z){Pe[z?"unshift":"push"](()=>{v=z,t(7,v)})}const re=z=>X(z,"km_inicial");function ve(z){Pe[z?"unshift":"push"](()=>{I=z,t(8,I)})}function Te(){s=nt(be[0],this.__value,this.checked),t(4,s)}const Oe=z=>X(z,"gas_inicial");function Le(){s=nt(be[0],this.__value,this.checked),t(4,s)}function ze(z,G){Pe[z?"unshift":"push"](()=>{d[G.id_checklist_event]=z,t(6,d)})}const ye=z=>F(z.id_checklist_event);function He(z){Pe[z?"unshift":"push"](()=>{p=z,t(5,p)})}return[g,O,k,f,s,p,d,v,I,M,S,R,q,n,_,A,L,P,F,X,H,be,K,x,le,ie,he,Ee,me,re,ve,Te,Oe,Le,ze,ye,He,(z,G)=>P(G,z.id_checklist_event)]}class Zt extends Ze{constructor(e){super(),xe(this,e,zn,Bn,Ye,{},null,[-1,-1])}}function Hn(i){let e,t,o,n,r,h="Teléfono de Negocio",_,g,O=i[6].client_phone+"",k;return{c(){e=c("ion-item"),t=c("ion-icon"),o=T(),n=c("ion-label"),r=c("p"),r.textContent=h,_=T(),g=c("h2"),k=ue(O),this.h()},l(f){e=u(f,"ION-ITEM",{href:!0});var s=E(e);t=u(s,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(a),o=C(s),n=u(s,"ION-LABEL",{class:!0});var p=E(n);r=u(p,"P",{"data-svelte-h":!0}),J(r)!=="svelte-1u5l7fz"&&(r.textContent=h),_=C(p),g=u(p,"H2",{});var d=E(g);k=fe(d,O),d.forEach(a),p.forEach(a),s.forEach(a),this.h()},h(){m(t,"icon",fn),m(t,"slot","start"),m(n,"class","ion-text-wrap"),m(e,"href","tel:"+i[6].client_phone)},m(f,s){U(f,e,s),l(e,t),l(e,o),l(e,n),l(n,r),l(n,_),l(n,g),l(g,k)},p:Ne,d(f){f&&a(e)}}}function Rn(i){let e,t,o,n,r,h="Domicilio Alternativo",_,g,O=i[6].line2+"",k,f,s;return{c(){e=c("ion-item"),t=c("ion-icon"),o=T(),n=c("ion-label"),r=c("p"),r.textContent=h,_=T(),g=c("h2"),k=ue(O),f=T(),s=c("ion-icon"),this.h()},l(p){e=u(p,"ION-ITEM",{href:!0});var d=E(e);t=u(d,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(a),o=C(d),n=u(d,"ION-LABEL",{class:!0});var v=E(n);r=u(v,"P",{"data-svelte-h":!0}),J(r)!=="svelte-1ub9uzw"&&(r.textContent=h),_=C(v),g=u(v,"H2",{});var I=E(g);k=fe(I,O),I.forEach(a),v.forEach(a),f=C(d),s=u(d,"ION-ICON",{icon:!0,slot:!0}),E(s).forEach(a),d.forEach(a),this.h()},h(){m(t,"icon",gt),m(t,"slot","start"),m(n,"class","ion-text-wrap"),m(s,"icon",$e),m(s,"slot","end"),m(e,"href","https://www.google.com/maps/searhc/?api=1&query="+i[6].line2)},m(p,d){U(p,e,d),l(e,t),l(e,o),l(e,n),l(n,r),l(n,_),l(n,g),l(g,k),l(e,f),l(e,s)},p:Ne,d(p){p&&a(e)}}}function Un(i){let e,t,o,n,r,h="Domicilio",_,g,O=i[6].line1+"",k,f,s,p,d=i[6].line2&&i[6].line2.trim().length,v,I=d&&qn(i);return{c(){e=c("ion-item"),t=c("ion-icon"),o=T(),n=c("ion-label"),r=c("p"),r.textContent=h,_=T(),g=c("h2"),k=ue(O),f=T(),s=c("ion-icon"),p=T(),I&&I.c(),v=Me(),this.h()},l(M){e=u(M,"ION-ITEM",{href:!0});var S=E(e);t=u(S,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(a),o=C(S),n=u(S,"ION-LABEL",{class:!0});var R=E(n);r=u(R,"P",{"data-svelte-h":!0}),J(r)!=="svelte-cbm7q1"&&(r.textContent=h),_=C(R),g=u(R,"H2",{});var D=E(g);k=fe(D,O),D.forEach(a),R.forEach(a),f=C(S),s=u(S,"ION-ICON",{icon:!0,slot:!0}),E(s).forEach(a),S.forEach(a),p=C(M),I&&I.l(M),v=Me(),this.h()},h(){m(t,"icon",gt),m(t,"slot","start"),m(n,"class","ion-text-wrap"),m(s,"icon",$e),m(s,"slot","end"),m(e,"href","https://www.google.com/maps/search/?api=1&query="+i[6].line1)},m(M,S){U(M,e,S),l(e,t),l(e,o),l(e,n),l(n,r),l(n,_),l(n,g),l(g,k),l(e,f),l(e,s),U(M,p,S),I&&I.m(M,S),U(M,v,S)},p(M,S){d&&I.p(M,S)},d(M){M&&(a(e),a(p),a(v)),I&&I.d(M)}}}function qn(i){let e,t,o,n,r,h="Domicilio Alternativo",_,g,O=i[6].line2+"",k,f,s;return{c(){e=c("ion-item"),t=c("ion-icon"),o=T(),n=c("ion-label"),r=c("p"),r.textContent=h,_=T(),g=c("h2"),k=ue(O),f=T(),s=c("ion-icon"),this.h()},l(p){e=u(p,"ION-ITEM",{href:!0});var d=E(e);t=u(d,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(a),o=C(d),n=u(d,"ION-LABEL",{class:!0});var v=E(n);r=u(v,"P",{"data-svelte-h":!0}),J(r)!=="svelte-1ub9uzw"&&(r.textContent=h),_=C(v),g=u(v,"H2",{});var I=E(g);k=fe(I,O),I.forEach(a),v.forEach(a),f=C(d),s=u(d,"ION-ICON",{icon:!0,slot:!0}),E(s).forEach(a),d.forEach(a),this.h()},h(){m(t,"icon",gt),m(t,"slot","start"),m(n,"class","ion-text-wrap"),m(s,"icon",$e),m(s,"slot","end"),m(e,"href","https://www.google.com/maps/search/?api=1&query="+i[6].line2)},m(p,d){U(p,e,d),l(e,t),l(e,o),l(e,n),l(n,r),l(n,_),l(n,g),l(g,k),l(e,f),l(e,s)},p:Ne,d(p){p&&a(e)}}}function Nt(i){let e,t,o,n,r,h="Contacto del Cliente",_,g,O,k,f=i[2]&&i[2]==="1"&&Tt(i);return{c(){e=c("ion-item"),t=c("ion-icon"),o=T(),n=c("ion-label"),r=c("p"),r.textContent=h,_=T(),g=c("h2"),O=ue(i[4]),k=T(),f&&f.c(),this.h()},l(s){e=u(s,"ION-ITEM",{});var p=E(e);t=u(p,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(a),o=C(p),n=u(p,"ION-LABEL",{class:!0});var d=E(n);r=u(d,"P",{"data-svelte-h":!0}),J(r)!=="svelte-1utsyb6"&&(r.textContent=h),_=C(d),g=u(d,"H2",{});var v=E(g);O=fe(v,i[4]),v.forEach(a),d.forEach(a),k=C(p),f&&f.l(p),p.forEach(a),this.h()},h(){m(t,"icon",_n),m(t,"slot","start"),m(n,"class","ion-text-wrap")},m(s,p){U(s,e,p),l(e,t),l(e,o),l(e,n),l(n,r),l(n,_),l(n,g),l(g,O),l(e,k),f&&f.m(e,null)},p(s,p){p&16&&we(O,s[4]),s[2]&&s[2]==="1"?f?f.p(s,p):(f=Tt(s),f.c(),f.m(e,null)):f&&(f.d(1),f=null)},d(s){s&&a(e),f&&f.d()}}}function Tt(i){let e,t=`<ion-icon icon="${hn}" slot="start"></ion-icon>
                        Notificar Cliente`,o,n;return{c(){e=c("ion-button"),e.innerHTML=t,this.h()},l(r){e=u(r,"ION-BUTTON",{fill:!0,style:!0,"data-svelte-h":!0}),J(e)!=="svelte-w3qtwm"&&(e.innerHTML=t),this.h()},h(){m(e,"fill","outline"),V(e,"margin-left","16px")},m(r,h){U(r,e,h),o||(n=ne(e,"click",i[10]),o=!0)},p:Ne,d(r){r&&a(e),o=!1,n()}}}function Ct(i){let e,t,o,n,r,h="Notas de ubicación",_,g,O;return{c(){e=c("ion-item"),t=c("ion-icon"),o=T(),n=c("ion-label"),r=c("p"),r.textContent=h,_=T(),g=c("h2"),O=ue(i[5]),this.h()},l(k){e=u(k,"ION-ITEM",{});var f=E(e);t=u(f,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(a),o=C(f),n=u(f,"ION-LABEL",{class:!0});var s=E(n);r=u(s,"P",{"data-svelte-h":!0}),J(r)!=="svelte-nhm2ft"&&(r.textContent=h),_=C(s),g=u(s,"H2",{});var p=E(g);O=fe(p,i[5]),p.forEach(a),s.forEach(a),f.forEach(a),this.h()},h(){m(t,"icon",Jt),m(t,"slot","start"),m(n,"class","ion-text-wrap")},m(k,f){U(k,e,f),l(e,t),l(e,o),l(e,n),l(n,r),l(n,_),l(n,g),l(g,O)},p(k,f){f&32&&we(O,k[5])},d(k){k&&a(e)}}}function Fn(i){let e,t,o,n,r,h="Horarios",_,g,O=i[6].schedule+"",k;return{c(){e=c("ion-item"),t=c("ion-icon"),o=T(),n=c("ion-label"),r=c("p"),r.textContent=h,_=T(),g=c("h2"),k=ue(O),this.h()},l(f){e=u(f,"ION-ITEM",{});var s=E(e);t=u(s,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(a),o=C(s),n=u(s,"ION-LABEL",{});var p=E(n);r=u(p,"P",{"data-svelte-h":!0}),J(r)!=="svelte-11q7hm5"&&(r.textContent=h),_=C(p),g=u(p,"H2",{});var d=E(g);k=fe(d,O),d.forEach(a),p.forEach(a),s.forEach(a),this.h()},h(){m(t,"icon",dn),m(t,"slot","start")},m(f,s){U(f,e,s),l(e,t),l(e,o),l(e,n),l(n,r),l(n,_),l(n,g),l(g,k)},p:Ne,d(f){f&&a(e)}}}function jn(i){let e,t,o,n,r,h="Notas del operador",_,g,O=i[6].driver_comments+"",k;return{c(){e=c("ion-item"),t=c("ion-icon"),o=T(),n=c("ion-label"),r=c("p"),r.textContent=h,_=T(),g=c("h2"),k=ue(O),this.h()},l(f){e=u(f,"ION-ITEM",{});var s=E(e);t=u(s,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(a),o=C(s),n=u(s,"ION-LABEL",{});var p=E(n);r=u(p,"P",{"data-svelte-h":!0}),J(r)!=="svelte-1yk9qp4"&&(r.textContent=h),_=C(p),g=u(p,"H2",{});var d=E(g);k=fe(d,O),d.forEach(a),p.forEach(a),s.forEach(a),this.h()},h(){m(t,"icon",Qt),m(t,"slot","start")},m(f,s){U(f,e,s),l(e,t),l(e,o),l(e,n),l(n,r),l(n,_),l(n,g),l(g,k)},p:Ne,d(f){f&&a(e)}}}function Vn(i){let e,t=i[6].logistic_comments!="<br>"&&Gn(i);return{c(){t&&t.c(),e=Me()},l(o){t&&t.l(o),e=Me()},m(o,n){t&&t.m(o,n),U(o,e,n)},p(o,n){o[6].logistic_comments!="<br>"&&t.p(o,n)},d(o){o&&a(e),t&&t.d(o)}}}function Gn(i){let e,t,o,n,r,h="Comentarios logísticos",_,g,O=i[6].logistic_comments+"",k;return{c(){e=c("ion-item"),t=c("ion-icon"),o=T(),n=c("ion-label"),r=c("p"),r.textContent=h,_=T(),g=c("h2"),k=ue(O),this.h()},l(f){e=u(f,"ION-ITEM",{});var s=E(e);t=u(s,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(a),o=C(s),n=u(s,"ION-LABEL",{class:!0});var p=E(n);r=u(p,"P",{"data-svelte-h":!0}),J(r)!=="svelte-1iz85r6"&&(r.textContent=h),_=C(p),g=u(p,"H2",{});var d=E(g);k=fe(d,O),d.forEach(a),p.forEach(a),s.forEach(a),this.h()},h(){m(t,"icon",Jt),m(t,"slot","start"),m(n,"class","ion-text-wrap")},m(f,s){U(f,e,s),l(e,t),l(e,o),l(e,n),l(n,r),l(n,_),l(n,g),l(g,k)},p:Ne,d(f){f&&a(e)}}}function yt(i){let e;return{c(){e=c("ion-spinner"),this.h()},l(t){e=u(t,"ION-SPINNER",{name:!0}),E(e).forEach(a),this.h()},h(){m(e,"name","dots")},m(t,o){U(t,e,o)},d(t){t&&a(e)}}}function wt(i){let e,t,o;return{c(){e=c("section"),t=c("ion-img"),this.h()},l(n){e=u(n,"SECTION",{});var r=E(e);t=u(r,"ION-IMG",{src:!0,alt:!0,style:!0}),E(t).forEach(a),r.forEach(a),this.h()},h(){ut(t.src,o=i[1])||m(t,"src",o),m(t,"alt","Evidencia fotográfica"),V(t,"max-width","100%"),V(t,"margin-top","16px")},m(n,r){U(n,e,r),l(e,t)},p(n,r){r&2&&!ut(t.src,o=n[1])&&m(t,"src",o)},d(n){n&&a(e)}}}function Kn(i){let e,t,o,n,r="Cancelar",h,_,g=i[6].title+"",O,k,f,s,p="Confirmar",d,v,I,M,S,R,D,q,N="Negocio",y,w,b=i[6].client_name+"",A,L,P=i[6].client_phone&&i[6].client_phone.trim().length,B,F,j,X,_e=i[6].schedule&&i[6].schedule.trim().length,ee,de,be=i[6].logistic_comments&&i[6].logistic_comments.trim().length,H,K,x,le,ie,he,Ee,me,re,ve,Te,Oe,Le="Subir Evidencia",ze,ye,He,Ae,z,G,pe=P&&Hn(i);function Ce($,ke){if($[6].line1&&$[6].line1.trim().length)return Un;if($[6].line2&&$[6].line2.trim().length)return Rn}let ge=Ce(i),Z=ge&&ge(i),Q=i[4]&&Nt(i),Y=i[5]&&i[5]!=="<br>"&&Ct(i),ce=_e&&Fn(i),te=i[6].driver_comments&&jn(i),ae=be&&Vn(i),Ie=i[3]&&yt(),oe=i[1]&&wt(i);return{c(){e=c("ion-header"),t=c("ion-toolbar"),o=c("ion-buttons"),n=c("ion-button"),n.textContent=r,h=T(),_=c("ion-title"),O=ue(g),k=T(),f=c("ion-buttons"),s=c("ion-button"),s.textContent=p,d=T(),v=c("ion-content"),I=c("ion-list"),M=c("ion-item"),S=c("ion-icon"),R=T(),D=c("ion-label"),q=c("p"),q.textContent=N,y=T(),w=c("h2"),A=ue(b),L=T(),pe&&pe.c(),B=T(),Z&&Z.c(),F=T(),Q&&Q.c(),j=T(),Y&&Y.c(),X=T(),ce&&ce.c(),ee=T(),te&&te.c(),de=T(),ae&&ae.c(),H=T(),K=c("ion-item"),x=c("ion-icon"),le=T(),ie=c("ion-textarea"),he=T(),Ee=c("section"),me=c("label"),re=c("ion-button"),ve=c("ion-icon"),Te=T(),Oe=c("label"),Oe.textContent=Le,ze=T(),ye=c("input"),He=T(),Ie&&Ie.c(),Ae=T(),oe&&oe.c(),this.h()},l($){e=u($,"ION-HEADER",{translucent:!0});var ke=E(e);t=u(ke,"ION-TOOLBAR",{});var De=E(t);o=u(De,"ION-BUTTONS",{slot:!0});var Be=E(o);n=u(Be,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),J(n)!=="svelte-1f8rjcf"&&(n.textContent=r),Be.forEach(a),h=C(De),_=u(De,"ION-TITLE",{title:!0});var Fe=E(_);O=fe(Fe,g),Fe.forEach(a),k=C(De),f=u(De,"ION-BUTTONS",{slot:!0});var et=E(f);s=u(et,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),J(s)!=="svelte-1ida0il"&&(s.textContent=p),et.forEach(a),De.forEach(a),ke.forEach(a),d=C($),v=u($,"ION-CONTENT",{fullscreen:!0});var tt=E(v);I=u(tt,"ION-LIST",{});var se=E(I);M=u(se,"ION-ITEM",{});var je=E(M);S=u(je,"ION-ICON",{icon:!0,slot:!0}),E(S).forEach(a),R=C(je),D=u(je,"ION-LABEL",{});var Ve=E(D);q=u(Ve,"P",{"data-svelte-h":!0}),J(q)!=="svelte-57b1dg"&&(q.textContent=N),y=C(Ve),w=u(Ve,"H2",{});var bt=E(w);A=fe(bt,b),bt.forEach(a),Ve.forEach(a),je.forEach(a),L=C(se),pe&&pe.l(se),B=C(se),Z&&Z.l(se),F=C(se),Q&&Q.l(se),j=C(se),Y&&Y.l(se),X=C(se),ce&&ce.l(se),ee=C(se),te&&te.l(se),de=C(se),ae&&ae.l(se),H=C(se),K=u(se,"ION-ITEM",{});var at=E(K);x=u(at,"ION-ICON",{icon:!0,slot:!0}),E(x).forEach(a),le=C(at),ie=u(at,"ION-TEXTAREA",{label:!0,placeholder:!0}),E(ie).forEach(a),at.forEach(a),he=C(se),Ee=u(se,"SECTION",{});var Et=E(Ee);me=u(Et,"LABEL",{for:!0,style:!0});var It=E(me);re=u(It,"ION-BUTTON",{fill:!0,class:!0,expand:!0});var We=E(re);ve=u(We,"ION-ICON",{icon:!0,slot:!0}),E(ve).forEach(a),Te=C(We),Oe=u(We,"LABEL",{for:!0,style:!0,"data-svelte-h":!0}),J(Oe)!=="svelte-1as0od8"&&(Oe.textContent=Le),ze=C(We),ye=u(We,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0}),We.forEach(a),It.forEach(a),Et.forEach(a),He=C(se),Ie&&Ie.l(se),Ae=C(se),oe&&oe.l(se),se.forEach(a),tt.forEach(a),this.h()},h(){m(n,"color","medium"),m(o,"slot","start"),m(_,"title",i[6].title),m(s,"strong",""),m(f,"slot","end"),m(e,"translucent",""),m(S,"icon",un),m(S,"slot","start"),m(x,"icon",dt),m(x,"slot","start"),m(ie,"label","Notas"),m(ie,"placeholder","Escribe aquí..."),m(ve,"icon",Xt),m(ve,"slot","start"),W(Oe,"for","eventEvidence"),V(Oe,"padding","8px 10px"),V(ye,"display","none"),W(ye,"id","eventEvidence"),W(ye,"name","fileToUpload"),W(ye,"type","file"),W(ye,"accept","image/*"),m(re,"fill","outline"),m(re,"class","loadEvidence"),m(re,"expand","block"),W(me,"for","eventEvidence"),V(me,"display","block"),V(me,"width","100%"),m(v,"fullscreen","")},m($,ke){U($,e,ke),l(e,t),l(t,o),l(o,n),l(t,h),l(t,_),l(_,O),l(t,k),l(t,f),l(f,s),U($,d,ke),U($,v,ke),l(v,I),l(I,M),l(M,S),l(M,R),l(M,D),l(D,q),l(D,y),l(D,w),l(w,A),l(I,L),pe&&pe.m(I,null),l(I,B),Z&&Z.m(I,null),l(I,F),Q&&Q.m(I,null),l(I,j),Y&&Y.m(I,null),l(I,X),ce&&ce.m(I,null),l(I,ee),te&&te.m(I,null),l(I,de),ae&&ae.m(I,null),l(I,H),l(I,K),l(K,x),l(K,le),l(K,ie),i[11](ie),l(I,he),l(I,Ee),l(Ee,me),l(me,re),l(re,ve),l(re,Te),l(re,Oe),l(re,ze),l(re,ye),l(I,He),Ie&&Ie.m(I,null),l(I,Ae),oe&&oe.m(I,null),z||(G=[ne(n,"click",i[8]),ne(s,"click",i[9]),ne(ye,"change",i[7])],z=!0)},p($,[ke]){P&&pe.p($,ke),Z&&Z.p($,ke),$[4]?Q?Q.p($,ke):(Q=Nt($),Q.c(),Q.m(I,j)):Q&&(Q.d(1),Q=null),$[5]&&$[5]!=="<br>"?Y?Y.p($,ke):(Y=Ct($),Y.c(),Y.m(I,X)):Y&&(Y.d(1),Y=null),_e&&ce.p($,ke),$[6].driver_comments&&te.p($,ke),be&&ae.p($,ke),$[3]?Ie||(Ie=yt(),Ie.c(),Ie.m(I,Ae)):Ie&&(Ie.d(1),Ie=null),$[1]?oe?oe.p($,ke):(oe=wt($),oe.c(),oe.m(I,null)):oe&&(oe.d(1),oe=null)},i:Ne,o:Ne,d($){$&&(a(e),a(d),a(v)),pe&&pe.d(),Z&&Z.d(),Q&&Q.d(),Y&&Y.d(),ce&&ce.d(),te&&te.d(),ae&&ae.d(),i[11](null),Ie&&Ie.d(),oe&&oe.d(),z=!1,Ue(G)}}}const Lt=/Teléfono:\s*(\d{10,})/;function St(i,e){for(let t=0;t<e.length;t++)if(e[t].alias===i)return e[t].val;return""}function Wn(i,e,t){let o=document.querySelector("ion-modal"),n=o.componentProps.delivery,r=o.componentProps.isLast,h=n.driver_comments?n.driver_comments:"",_=n.img?n.img:"",g="",O={latitude:null,longitude:null},k=new Object,f="",s="",p=!1,d="",v=n.comments_ext;if(ot(()=>{b()}),n.comments_ext){const L=n.comments_ext.match(Lt);L&&(d=L[1],v=n.comments_ext.replace(Lt,"").trim())}const I=async()=>{await(await Ke.create({header:"SMS enviado",message:"Se envío correctamente un SMS a "+n.title+" con número de teléfono: "+d,buttons:[{text:"Cerrar"}]})).present()},M=async()=>{await(await Ke.create({header:"SMS no enviado",message:"Hubo un error al enviar SMS a "+n.title+" con número de teléfono: "+phoneNumber0+". Por favor contacte a soporte.",buttons:[{text:"Cerrar"}]})).present()},S=async L=>{t(3,p=!0);const B=L.target.files[0],F=await R(B);if(F){const j=new FormData;j.append("fileToUpload",F);try{const X=await fetch("https://dev.rutaflow.com/api/admin/manager/upload_img_driver.php",{method:"POST",body:j});if(X.ok){const _e=await X.json();t(1,_=_e.img),g=_e.img_id}else console.error("File upload failed:",X.statusText)}catch(X){console.error("Error during file upload:",X)}finally{t(3,p=!1)}}},R=async L=>new Promise(P=>{const B=new FileReader;B.onload=F=>{const j=new Image;j.src=F.target.result,j.onload=()=>{const X=document.createElement("canvas"),_e=X.getContext("2d"),ee=800,de=600;let be=j.width,H=j.height;be>ee&&(H*=ee/be,be=ee),H>de&&(be*=de/H,H=de),X.width=be,X.height=H,_e.drawImage(j,0,0,be,H),X.toBlob(K=>{P(K)},"image/jpeg",.7)}},B.readAsDataURL(L)}),D=()=>{o.dismiss({data:Date.now()})},q=async()=>{try{if(await y()){const P={id_route:n.id_route,id_event:n.id_event,comments:h.value,img:_,img_id:g,lat:O.latitude,lon:O.longitude,...f==="0"&&{approve:"0"},...r&&{isLast:!0}},B=new FormData;for(const ee in P)B.append(ee,P[ee]);const j=await(await fetch("https://dev.rutaflow.com/api/admin/evidence/send_evidence.php",{method:"POST",body:B})).json();D();const X={},_e=P.id_route;r&&N("","",_e,r)}}catch(L){console.error("Error fetching data:",L)}},N=(L,P,B,F)=>{o.componentProps.routeId=B,o.componentProps.driverId=n.id_driver,qe("modal-km-gas",Zt,{checklist:L,driverId:P,routeId:B,isLast:F}).then(j=>{})},y=async()=>navigator.geolocation?new Promise((L,P)=>{navigator.geolocation.getCurrentPosition(B=>{O.latitude=B.coords.latitude,O.longitude=B.coords.longitude,L(!0)},B=>{console.error("Error getting location:",B),L(!1)})}):(console.error("Geolocation is not supported by your browser"),!1);async function w(L){L.stopPropagation();const P=new FormData;P.append("client_phone",d),P.append("client_name",n.title),P.append("delivery_phone",n.client_phone),P.append("enterprise_name",n.enterprise_name);try{const B=await fetch("https://dev.rutaflow.com/api/admin/message_central/send_sms.php",{method:"POST",body:P});if(B.ok){const F=await B.json();I()}else M()}catch(B){console.error("Error during file upload:",B)}}const b=async L=>{if(n.id_enterprise){const P=new FormData;P.append("id_enterprise",n.id_enterprise);try{const B=await fetch("https://dev.rutaflow.com/api/admin/enterprise/enterprise_settings.php",{method:"POST",body:P});B.ok?(k=(await B.json()).nodos,f=St("stops_wait_approval",k),t(2,s=St("sms_active",k))):console.error("File upload failed:",B.statusText)}catch(B){console.error("Error during file upload:",B)}}};function A(L){Pe[L?"unshift":"push"](()=>{h=L,t(0,h)})}return[h,_,s,p,d,v,n,S,D,q,w,A]}class Xn extends Ze{constructor(e){super(),xe(this,e,Wn,Kn,Ye,{})}}function Pt(i){let e;return{c(){e=c("ion-spinner"),this.h()},l(t){e=u(t,"ION-SPINNER",{name:!0}),E(e).forEach(a),this.h()},h(){m(e,"name","dots")},m(t,o){U(t,e,o)},d(t){t&&a(e)}}}function Mt(i){let e,t,o;return{c(){e=c("section"),t=c("ion-img"),this.h()},l(n){e=u(n,"SECTION",{});var r=E(e);t=u(r,"ION-IMG",{src:!0,alt:!0,style:!0}),E(t).forEach(a),r.forEach(a),this.h()},h(){ut(t.src,o=i[0])||m(t,"src",o),m(t,"alt","Evidencia fotográfica"),V(t,"max-width","100%"),V(t,"margin-top","16px")},m(n,r){U(n,e,r),l(e,t)},p(n,r){r&1&&!ut(t.src,o=n[0])&&m(t,"src",o)},d(n){n&&a(e)}}}function Jn(i){let e,t,o,n,r="Cancelar",h,_,g="AGREGAR GASTO",O,k,f,s,p,d,v,I,M,S,R,D,q,N,y,w,b,A,L='Tipo de pago <ion-text color="danger">(Obligatorio)</ion-text>',P,B,F="Efectivo",j,X,_e="Tarjeta",ee,de,be="Transferencia",H,K,x,le,ie,he,Ee,me,re,ve,Te=`<ion-icon icon="${Xt}" slot="start"></ion-icon>
                        Subir Evidencia`,Oe,Le,ze,ye,He,Ae,z,G,pe="Confirmar",Ce,ge,Z=i[5]&&Pt(),Q=i[0]&&Mt(i);return{c(){e=c("ion-header"),t=c("ion-toolbar"),o=c("ion-buttons"),n=c("ion-button"),n.textContent=r,h=T(),_=c("ion-title"),_.textContent=g,O=T(),k=c("ion-content"),f=c("ion-list"),s=c("ion-item"),p=c("ion-icon"),d=T(),v=c("ion-input"),I=T(),M=c("ion-item"),S=c("ion-icon"),R=T(),D=c("ion-input"),q=T(),N=c("ion-item"),y=c("ion-icon"),w=T(),b=c("ion-select"),A=c("div"),A.innerHTML=L,P=T(),B=c("ion-select-option"),B.textContent=F,j=T(),X=c("ion-select-option"),X.textContent=_e,ee=T(),de=c("ion-select-option"),de.textContent=be,H=T(),K=c("ion-item"),x=c("ion-icon"),le=T(),ie=c("ion-textarea"),he=T(),Ee=c("section"),me=c("label"),re=c("ion-button"),ve=c("label"),ve.innerHTML=Te,Oe=T(),Le=c("input"),ze=T(),Z&&Z.c(),ye=T(),Q&&Q.c(),He=T(),Ae=c("ion-footer"),z=c("ion-toolbar"),G=c("ion-button"),G.textContent=pe,this.h()},l(Y){e=u(Y,"ION-HEADER",{translucent:!0});var ce=E(e);t=u(ce,"ION-TOOLBAR",{});var te=E(t);o=u(te,"ION-BUTTONS",{slot:!0});var ae=E(o);n=u(ae,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),J(n)!=="svelte-1f8rjcf"&&(n.textContent=r),ae.forEach(a),h=C(te),_=u(te,"ION-TITLE",{title:!0,"data-svelte-h":!0}),J(_)!=="svelte-efps2s"&&(_.textContent=g),te.forEach(a),ce.forEach(a),O=C(Y),k=u(Y,"ION-CONTENT",{fullscreen:!0});var Ie=E(k);f=u(Ie,"ION-LIST",{});var oe=E(f);s=u(oe,"ION-ITEM",{});var $=E(s);p=u($,"ION-ICON",{icon:!0,slot:!0}),E(p).forEach(a),d=C($),v=u($,"ION-INPUT",{label:!0,type:!0,placeholder:!0,value:!0}),E(v).forEach(a),$.forEach(a),I=C(oe),M=u(oe,"ION-ITEM",{});var ke=E(M);S=u(ke,"ION-ICON",{icon:!0,slot:!0}),E(S).forEach(a),R=C(ke),D=u(ke,"ION-INPUT",{label:!0,type:!0,value:!0}),E(D).forEach(a),ke.forEach(a),q=C(oe),N=u(oe,"ION-ITEM",{});var De=E(N);y=u(De,"ION-ICON",{icon:!0,slot:!0}),E(y).forEach(a),w=C(De),b=u(De,"ION-SELECT",{placeholder:!0,value:!0});var Be=E(b);A=u(Be,"DIV",{slot:!0,"data-svelte-h":!0}),J(A)!=="svelte-wl764p"&&(A.innerHTML=L),P=C(Be),B=u(Be,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),J(B)!=="svelte-i9crym"&&(B.textContent=F),j=C(Be),X=u(Be,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),J(X)!=="svelte-fx0z11"&&(X.textContent=_e),ee=C(Be),de=u(Be,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),J(de)!=="svelte-1c24jf2"&&(de.textContent=be),Be.forEach(a),De.forEach(a),H=C(oe),K=u(oe,"ION-ITEM",{});var Fe=E(K);x=u(Fe,"ION-ICON",{icon:!0,slot:!0}),E(x).forEach(a),le=C(Fe),ie=u(Fe,"ION-TEXTAREA",{label:!0,placeholder:!0}),E(ie).forEach(a),Fe.forEach(a),he=C(oe),Ee=u(oe,"SECTION",{});var et=E(Ee);me=u(et,"LABEL",{for:!0,style:!0});var tt=E(me);re=u(tt,"ION-BUTTON",{fill:!0,size:!0,class:!0,expand:!0});var se=E(re);ve=u(se,"LABEL",{for:!0,style:!0,"data-svelte-h":!0}),J(ve)!=="svelte-1m9yw22"&&(ve.innerHTML=Te),Oe=C(se),Le=u(se,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0}),se.forEach(a),tt.forEach(a),et.forEach(a),ze=C(oe),Z&&Z.l(oe),ye=C(oe),Q&&Q.l(oe),oe.forEach(a),Ie.forEach(a),He=C(Y),Ae=u(Y,"ION-FOOTER",{});var je=E(Ae);z=u(je,"ION-TOOLBAR",{});var Ve=E(z);G=u(Ve,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),J(G)!=="svelte-1c7dl3f"&&(G.textContent=pe),Ve.forEach(a),je.forEach(a),this.h()},h(){m(n,"color","medium"),m(o,"slot","start"),m(_,"title",""),m(e,"translucent",""),m(p,"icon",Qt),m(p,"slot","start"),m(v,"label","Concepto"),m(v,"type","text"),m(v,"placeholder","Escribe aquí..."),m(v,"value",i[6]?i[6]:""),m(S,"icon",dt),m(S,"slot","start"),m(D,"label","Cantidad"),m(D,"type","number"),m(D,"value",i[7]?i[7]:""),m(y,"icon",pn),m(y,"slot","start"),W(A,"slot","label"),m(B,"value","cash"),m(X,"value","card"),m(de,"value","transfer"),m(b,"placeholder","Tipo de pago"),m(b,"value",i[8]?i[8]:""),m(x,"icon",dt),m(x,"slot","start"),m(ie,"label","Comentarios"),m(ie,"placeholder","Escribe aquí..."),W(ve,"for","eventEvidence"),V(ve,"width","100%"),V(ve,"padding","8px"),V(Le,"display","none"),W(Le,"id","eventEvidence"),W(Le,"name","fileToUpload"),W(Le,"type","file"),W(Le,"accept","image/*"),m(re,"fill","outline"),m(re,"size","small"),m(re,"class","loadEvidence"),m(re,"expand","block"),W(me,"for","eventEvidence"),V(me,"display","block"),V(me,"width","100%"),m(k,"fullscreen",""),m(G,"fill","outline"),m(G,"color","tertiary"),m(G,"strong",""),V(G,"width","99%"),V(G,"height","auto")},m(Y,ce){U(Y,e,ce),l(e,t),l(t,o),l(o,n),l(t,h),l(t,_),U(Y,O,ce),U(Y,k,ce),l(k,f),l(f,s),l(s,p),l(s,d),l(s,v),i[12](v),l(f,I),l(f,M),l(M,S),l(M,R),l(M,D),i[13](D),l(f,q),l(f,N),l(N,y),l(N,w),l(N,b),l(b,A),l(b,P),l(b,B),l(b,j),l(b,X),l(b,ee),l(b,de),i[14](b),l(f,H),l(f,K),l(K,x),l(K,le),l(K,ie),i[15](ie),l(f,he),l(f,Ee),l(Ee,me),l(me,re),l(re,ve),l(re,Oe),l(re,Le),l(f,ze),Z&&Z.m(f,null),l(f,ye),Q&&Q.m(f,null),U(Y,He,ce),U(Y,Ae,ce),l(Ae,z),l(z,G),Ce||(ge=[ne(n,"click",i[10]),ne(Le,"change",i[9]),ne(G,"click",i[11])],Ce=!0)},p(Y,[ce]){Y[5]?Z||(Z=Pt(),Z.c(),Z.m(f,ye)):Z&&(Z.d(1),Z=null),Y[0]?Q?Q.p(Y,ce):(Q=Mt(Y),Q.c(),Q.m(f,null)):Q&&(Q.d(1),Q=null)},i:Ne,o:Ne,d(Y){Y&&(a(e),a(O),a(k),a(He),a(Ae)),i[12](null),i[13](null),i[14](null),i[15](null),Z&&Z.d(),Q&&Q.d(),Ce=!1,Ue(ge)}}}function Qn(i,e,t){let o=document.querySelector("ion-modal"),n=o.componentProps.routeId,r=o.componentProps.ex_concept,h=o.componentProps.ex_amount,_=o.componentProps.ex_type,g=o.componentProps.id_expense,O="",k="",f="",s=0,p="",d="",v=!1;ot(()=>{});const I=async(b,A)=>{await(await Ke.create({header:b||"Error",message:A||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()},M=async b=>{t(5,v=!0);const L=b.target.files[0],P=await S(L);if(P){const B=new FormData;B.append("fileToUpload",P);try{const F=await fetch("https://dev.rutaflow.com/api/admin/manager/upload_img_driver.php",{method:"POST",body:B});if(F.ok){const j=await F.json();t(0,O=j.img),k=j.img_id}else console.error("File upload failed:",F.statusText)}catch(F){console.error("Error during file upload:",F)}finally{t(5,v=!1)}}},S=async b=>new Promise(A=>{const L=new FileReader;L.onload=P=>{const B=new Image;B.src=P.target.result,B.onload=()=>{const F=document.createElement("canvas"),j=F.getContext("2d"),X=800,_e=600;let ee=B.width,de=B.height;ee>X&&(de*=X/ee,ee=X),de>_e&&(ee*=_e/de,de=_e),F.width=ee,F.height=de,j.drawImage(B,0,0,ee,de),F.toBlob(be=>{A(be)},"image/jpeg",.7)}},L.readAsDataURL(b)}),R=()=>{rt.dismiss()},D=()=>{var b=new Object;b.id_route=n,b.comments=p.value,b.type=f.value,b.img=O,b.img_id=k,b.amount=s.value,b.concept=d.value,b.status="done",b.id_expense=g||"null";const A=new FormData;for(const L in b)A.append(L,b[L]);!k||!O||!p.value||!s.value||!d.value?I("Datos incompletos","Llena los datos requeridos para completar el registro"):fetch("https://dev.rutaflow.com/api/admin/expenses/add_expense.php",{method:"POST",body:A}).then(L=>L.json()).then(L=>{R()}).catch(L=>{console.error("Error fetching data:",L)})};function q(b){Pe[b?"unshift":"push"](()=>{d=b,t(4,d)})}function N(b){Pe[b?"unshift":"push"](()=>{s=b,t(2,s)})}function y(b){Pe[b?"unshift":"push"](()=>{f=b,t(1,f)})}function w(b){Pe[b?"unshift":"push"](()=>{p=b,t(3,p)})}return[O,f,s,p,d,v,r,h,_,M,R,D,q,N,y,w]}class pt extends Ze{constructor(e){super(),xe(this,e,Qn,Jn,Ye,{})}}function At(i,e,t){const o=i.slice();return o[7]=e[t],o}function Yn(i){let e,t="Cargar gasto",o,n;function r(...h){return i[4](i[7],...h)}return{c(){e=c("ion-button"),e.textContent=t,this.h()},l(h){e=u(h,"ION-BUTTON",{fill:!0,size:!0,"aria-selected":!0,"data-svelte-h":!0}),J(e)!=="svelte-175aelj"&&(e.textContent=t),this.h()},h(){m(e,"fill","outline"),m(e,"size","small"),m(e,"aria-selected","")},m(h,_){U(h,e,_),o||(n=ne(e,"click",r),o=!0)},p(h,_){i=h},d(h){h&&a(e),o=!1,n()}}}function Zn(i){let e,t="Gasto completado";return{c(){e=c("ion-button"),e.textContent=t,this.h()},l(o){e=u(o,"ION-BUTTON",{fill:!0,size:!0,"aria-selected":!0,"data-svelte-h":!0}),J(e)!=="svelte-tlger7"&&(e.textContent=t),this.h()},h(){m(e,"fill","solid"),m(e,"size","small"),m(e,"aria-selected","")},m(o,n){U(o,e,n)},p:Ne,d(o){o&&a(e)}}}function Dt(i,e){let t,o,n,r=e[7].concept+"",h,_,g;function O(s,p){return s[7].status=="done"?Zn:Yn}let f=O(e)(e);return{key:i,first:null,c(){t=c("ion-item"),o=c("ion-label"),n=c("p"),h=ue(r),_=T(),f.c(),g=T(),this.h()},l(s){t=u(s,"ION-ITEM",{});var p=E(t);o=u(p,"ION-LABEL",{style:!0});var d=E(o);n=u(d,"P",{style:!0});var v=E(n);h=fe(v,r),v.forEach(a),d.forEach(a),_=C(p),f.l(p),g=C(p),p.forEach(a),this.h()},h(){V(n,"margin-left","10px"),V(o,"display","flex"),this.first=t},m(s,p){U(s,t,p),l(t,o),l(o,n),l(n,h),l(t,_),f.m(t,null),l(t,g)},p(s,p){e=s,f.p(e,p)},d(s){s&&a(t),f.d()}}}function xn(i){let e,t,o,n,r=`<ion-icon style="font-size: 25px!important;" icon="${mn}"></ion-icon>`,h,_,g="LISTA DE GASTOS",O,k,f,s=[],p=new Map,d,v,I,M="Cerrar",S,R,D=Re(i[0]);const q=N=>N[7].id_expenses;for(let N=0;N<D.length;N+=1){let y=At(i,D,N),w=q(y);p.set(w,s[N]=Dt(w,y))}return{c(){e=c("ion-header"),t=c("ion-toolbar"),o=c("ion-buttons"),n=c("ion-button"),n.innerHTML=r,h=T(),_=c("ion-title"),_.textContent=g,O=T(),k=c("ion-content"),f=c("ion-list");for(let N=0;N<s.length;N+=1)s[N].c();d=T(),v=c("ion-footer"),I=c("ion-button"),I.textContent=M,this.h()},l(N){e=u(N,"ION-HEADER",{translucent:!0});var y=E(e);t=u(y,"ION-TOOLBAR",{});var w=E(t);o=u(w,"ION-BUTTONS",{slot:!0});var b=E(o);n=u(b,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),J(n)!=="svelte-160xz3i"&&(n.innerHTML=r),b.forEach(a),h=C(w),_=u(w,"ION-TITLE",{"data-svelte-h":!0}),J(_)!=="svelte-1phn90x"&&(_.textContent=g),w.forEach(a),y.forEach(a),O=C(N),k=u(N,"ION-CONTENT",{fullscreen:!0});var A=E(k);f=u(A,"ION-LIST",{});var L=E(f);for(let B=0;B<s.length;B+=1)s[B].l(L);L.forEach(a),A.forEach(a),d=C(N),v=u(N,"ION-FOOTER",{});var P=E(v);I=u(P,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),J(I)!=="svelte-zv7v83"&&(I.textContent=M),P.forEach(a),this.h()},h(){m(n,"color","medium"),m(o,"slot","end"),m(e,"translucent",""),m(k,"fullscreen",""),m(I,"fill","outline"),m(I,"color","tertiary"),m(I,"strong",""),V(I,"width","99%"),V(I,"height","auto")},m(N,y){U(N,e,y),l(e,t),l(t,o),l(o,n),l(t,h),l(t,_),U(N,O,y),U(N,k,y),l(k,f);for(let w=0;w<s.length;w+=1)s[w]&&s[w].m(f,null);U(N,d,y),U(N,v,y),l(v,I),S||(R=[ne(n,"click",i[3]),ne(I,"click",i[1])],S=!0)},p(N,[y]){y&5&&(D=Re(N[0]),s=lt(s,y,q,1,N,D,p,f,it,Dt,null,At))},i:Ne,o:Ne,d(N){N&&(a(e),a(O),a(k),a(d),a(v));for(let y=0;y<s.length;y+=1)s[y].d();S=!1,Ue(R)}}}function $n(i){let e=document.querySelector("ion-modal");e.componentProps.routeId;let t=e.componentProps.expenses;ot(()=>{});const o=()=>{rt.dismiss()};function n(_,g,O,k,f){e.componentProps.ex_amount=O,e.componentProps.ex_concept=g,e.componentProps.ex_type=k,e.componentProps.id_expense=f,qe("modal-expense",pt,{amount:O,concept:g,type:k,id_expense:f}).then(()=>{}),o()}return[t,o,n,_=>{qe("modal-expense",pt,{routeId:_}).then(g=>{}),o()},(_,g)=>n(g,_.concept,_.amount,_.type,_.id_expenses)]}class eo extends Ze{constructor(e){super(),xe(this,e,$n,xn,Ye,{})}}const{document:Bt}=On;function zt(i,e,t){const o=i.slice();return o[34]=e[t],o}function Ht(i,e,t){const o=i.slice();return o[34]=e[t],o[36]=t,o}function Rt(i,e,t){const o=i.slice();return o[34]=e[t],o[36]=t,o}function Ut(i){let e,t;return e=new En({props:{$$slots:{default:[ao]},$$scope:{ctx:i}}}),{c(){ln(e.$$.fragment)},l(o){rn(e.$$.fragment,o)},m(o,n){an(e,o,n),t=!0},p(o,n){const r={};n[0]&1019|n[1]&512&&(r.$$scope={dirty:n,ctx:o}),e.$set(r)},i(o){t||(ct(e.$$.fragment,o),t=!0)},o(o){_t(e.$$.fragment,o),t=!1},d(o){sn(e,o)}}}function to(i){let e,t='<div id="g_map" style="width: 100%; height: 100vh;"></div>';return{c(){e=c("ion-content"),e.innerHTML=t},l(o){e=u(o,"ION-CONTENT",{"data-svelte-h":!0}),J(e)!=="svelte-1ydw6i9"&&(e.innerHTML=t)},m(o,n){U(o,e,n)},p:Ne,d(o){o&&a(e)}}}function no(i){let e;function t(r,h){if(r[7].length>0)return lo;if(!r[3])return oo}let o=t(i),n=o&&o(i);return{c(){n&&n.c(),e=Me()},l(r){n&&n.l(r),e=Me()},m(r,h){n&&n.m(r,h),U(r,e,h)},p(r,h){o===(o=t(r))&&n?n.p(r,h):(n&&n.d(1),n=o&&o(r),n&&(n.c(),n.m(e.parentNode,e)))},d(r){r&&a(e),n&&n.d(r)}}}function oo(i){let e,t,o,n='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Jala para actualizar" refreshing-spinner="circles" refreshing-text="Actualizando..."></ion-refresher-content>',r,h,_=[],g=new Map,O,k,f=i[4]&&qt(i),s=Re(i[5]);const p=d=>d[34].id_event;for(let d=0;d<s.length;d+=1){let v=zt(i,s,d),I=p(v);g.set(I,_[d]=jt(I,v))}return{c(){f&&f.c(),e=T(),t=c("ion-content"),o=c("ion-refresher"),o.innerHTML=n,r=T(),h=c("ion-list");for(let d=0;d<_.length;d+=1)_[d].c();this.h()},l(d){f&&f.l(d),e=C(d),t=u(d,"ION-CONTENT",{});var v=E(t);o=u(v,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),J(o)!=="svelte-1srnbs3"&&(o.innerHTML=n),r=C(v),h=u(v,"ION-LIST",{});var I=E(h);for(let M=0;M<_.length;M+=1)_[M].l(I);I.forEach(a),v.forEach(a),this.h()},h(){m(o,"slot","fixed")},m(d,v){f&&f.m(d,v),U(d,e,v),U(d,t,v),l(t,o),i[26](o),l(t,r),l(t,h);for(let I=0;I<_.length;I+=1)_[I]&&_[I].m(h,null);O||(k=ne(o,"ionRefresh",i[10]),O=!0)},p(d,v){d[4]?f?f.p(d,v):(f=qt(d),f.c(),f.m(e.parentNode,e)):f&&(f.d(1),f=null),v[0]&167968&&(s=Re(d[5]),_=lt(_,v,p,1,d,s,g,h,it,jt,null,zt))},d(d){d&&(a(e),a(t)),f&&f.d(d),i[26](null);for(let v=0;v<_.length;v+=1)_[v].d();O=!1,k()}}}function lo(i){let e,t;function o(h,_){return _[0]&128&&(e=null),e==null&&(e=!!h[7].every(uo)),e?ro:io}let n=o(i,[-1,-1]),r=n(i);return{c(){r.c(),t=Me()},l(h){r.l(h),t=Me()},m(h,_){r.m(h,_),U(h,t,_)},p(h,_){n===(n=o(h,_))&&r?r.p(h,_):(r.d(1),r=n(h),r&&(r.c(),r.m(t.parentNode,t)))},d(h){h&&a(t),r.d(h)}}}function qt(i){let e=i[13]("",i[1],i[0])+"",t;return{c(){t=ue(e)},l(o){t=fe(o,e)},m(o,n){U(o,t,n)},p(o,n){n[0]&3&&e!==(e=o[13]("",o[1],o[0])+"")&&we(t,e)},d(o){o&&a(t)}}}function Ft(i){let e;return{c(){e=c("span"),this.h()},l(t){e=u(t,"SPAN",{class:!0}),E(e).forEach(a),this.h()},h(){W(e,"class","notes svelte-egzizz")},m(t,o){U(t,e,o)},d(t){t&&a(e)}}}function jt(i,e){let t,o,n,r,h=parseInt(e[34].pos)+1+"",_,g,O,k,f,s,p=e[34].title+"",d,v,I=e[34].support_list&&e[34].support_list.length||e[15](e[34]),M,S,R,D,q,N=I&&Ft();function y(){return e[27](e[34])}return{key:i,first:null,c(){t=c("ion-item"),o=c("ion-avatar"),n=c("div"),r=c("div"),_=ue(h),O=T(),k=c("ion-label"),f=c("ion-text"),s=c("h3"),d=ue(p),v=T(),N&&N.c(),M=T(),S=c("ion-icon"),R=T(),this.h()},l(w){t=u(w,"ION-ITEM",{});var b=E(t);o=u(b,"ION-AVATAR",{slot:!0});var A=E(o);n=u(A,"DIV",{class:!0,title:!0,style:!0});var L=E(n);r=u(L,"DIV",{class:!0});var P=E(r);_=fe(P,h),P.forEach(a),L.forEach(a),A.forEach(a),O=C(b),k=u(b,"ION-LABEL",{button:!0});var B=E(k);f=u(B,"ION-TEXT",{color:!0});var F=E(f);s=u(F,"H3",{});var j=E(s);d=fe(j,p),v=C(j),N&&N.l(j),j.forEach(a),F.forEach(a),B.forEach(a),M=C(b),S=u(b,"ION-ICON",{icon:!0,slot:!0,style:!0}),E(S).forEach(a),R=C(b),b.forEach(a),this.h()},h(){W(r,"class","order svelte-egzizz"),W(n,"class","order-wrapper svelte-egzizz"),W(n,"title",g=Je(e[34].status)),V(n,"background-color",Se(e[34].status)),V(n,"color",Qe(Se(e[34].status))),m(o,"slot","start"),m(f,"color","#2e2e2e"),m(k,"button",""),m(S,"icon",$e),m(S,"slot","end"),V(S,"color",Se(e[34].status)),this.first=t},m(w,b){U(w,t,b),l(t,o),l(o,n),l(n,r),l(r,_),l(t,O),l(t,k),l(k,f),l(f,s),l(s,d),l(s,v),N&&N.m(s,null),l(t,M),l(t,S),l(t,R),D||(q=ne(k,"click",y),D=!0)},p(w,b){e=w,b[0]&32&&h!==(h=parseInt(e[34].pos)+1+"")&&we(_,h),b[0]&32&&g!==(g=Je(e[34].status))&&W(n,"title",g),b[0]&32&&V(n,"background-color",Se(e[34].status)),b[0]&32&&V(n,"color",Qe(Se(e[34].status))),b[0]&32&&p!==(p=e[34].title+"")&&we(d,p),b[0]&32&&(I=e[34].support_list&&e[34].support_list.length||e[15](e[34])),I?N||(N=Ft(),N.c(),N.m(s,null)):N&&(N.d(1),N=null),b[0]&32&&V(S,"color",Se(e[34].status))},d(w){w&&a(t),N&&N.d(),D=!1,q()}}}function io(i){let e=i[13](i[7],i[1],i[0])+"",t,o,n,r,h='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Pull to refresh" refreshing-spinner="circles" refreshing-text="Refreshing..."></ion-refresher-content>',_,g,O=[],k=new Map,f,s,p=Re(i[5]);const d=v=>v[34].id_event;for(let v=0;v<p.length;v+=1){let I=Ht(i,p,v),M=d(I);k.set(M,O[v]=Gt(M,I))}return{c(){t=ue(e),o=T(),n=c("ion-content"),r=c("ion-refresher"),r.innerHTML=h,_=T(),g=c("ion-list");for(let v=0;v<O.length;v+=1)O[v].c();this.h()},l(v){t=fe(v,e),o=C(v),n=u(v,"ION-CONTENT",{});var I=E(n);r=u(I,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),J(r)!=="svelte-dvt1s"&&(r.innerHTML=h),_=C(I),g=u(I,"ION-LIST",{});var M=E(g);for(let S=0;S<O.length;S+=1)O[S].l(M);M.forEach(a),I.forEach(a),this.h()},h(){m(r,"slot","fixed")},m(v,I){U(v,t,I),U(v,o,I),U(v,n,I),l(n,r),i[24](r),l(n,_),l(n,g);for(let M=0;M<O.length;M+=1)O[M]&&O[M].m(g,null);f||(s=ne(r,"ionRefresh",i[10]),f=!0)},p(v,I){I[0]&131&&e!==(e=v[13](v[7],v[1],v[0])+"")&&we(t,e),I[0]&299040&&(p=Re(v[5]),O=lt(O,I,d,1,v,p,k,g,it,Gt,null,Ht))},d(v){v&&(a(t),a(o),a(n)),i[24](null);for(let I=0;I<O.length;I+=1)O[I].d();f=!1,s()}}}function ro(i){let e,t,o='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Jale para actualizar" refreshing-spinner="circles" refreshing-text="Actualizando..."></ion-refresher-content>',n,r,h=[],_=new Map,g,O,k=Re(i[5]);const f=s=>s[34].id_event;for(let s=0;s<k.length;s+=1){let p=Rt(i,k,s),d=f(p);_.set(d,h[s]=Wt(d,p))}return{c(){e=c("ion-content"),t=c("ion-refresher"),t.innerHTML=o,n=T(),r=c("ion-list");for(let s=0;s<h.length;s+=1)h[s].c();this.h()},l(s){e=u(s,"ION-CONTENT",{});var p=E(e);t=u(p,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),J(t)!=="svelte-15ukrgn"&&(t.innerHTML=o),n=C(p),r=u(p,"ION-LIST",{});var d=E(r);for(let v=0;v<h.length;v+=1)h[v].l(d);d.forEach(a),p.forEach(a),this.h()},h(){m(t,"slot","fixed")},m(s,p){U(s,e,p),l(e,t),i[22](t),l(e,n),l(e,r);for(let d=0;d<h.length;d+=1)h[d]&&h[d].m(r,null);g||(O=ne(t,"ionRefresh",i[10]),g=!0)},p(s,p){p[0]&299040&&(k=Re(s[5]),h=lt(h,p,f,1,s,k,_,r,it,Wt,null,Rt))},d(s){s&&a(e),i[22](null);for(let p=0;p<h.length;p+=1)h[p].d();g=!1,O()}}}function Vt(i){let e;return{c(){e=c("span"),this.h()},l(t){e=u(t,"SPAN",{class:!0}),E(e).forEach(a),this.h()},h(){W(e,"class","notes svelte-egzizz")},m(t,o){U(t,e,o)},d(t){t&&a(e)}}}function Gt(i,e){let t,o,n,r,h=parseInt(e[34].pos)+1+"",_,g,O,k,f,s,p=e[34].title+"",d,v,I=e[34].support_list&&e[34].support_list.length||e[15](e[34]),M,S,R="",D,q,N,y,w,b=I&&Vt();function A(){return e[25](e[34],e[36])}return{key:i,first:null,c(){t=c("ion-item"),o=c("ion-avatar"),n=c("div"),r=c("div"),_=ue(h),O=T(),k=c("ion-label"),f=c("ion-text"),s=c("h3"),d=ue(p),v=T(),b&&b.c(),M=T(),S=c("div"),S.innerHTML=R,D=T(),q=c("ion-icon"),N=T(),this.h()},l(L){t=u(L,"ION-ITEM",{});var P=E(t);o=u(P,"ION-AVATAR",{slot:!0});var B=E(o);n=u(B,"DIV",{class:!0,title:!0,style:!0});var F=E(n);r=u(F,"DIV",{class:!0});var j=E(r);_=fe(j,h),j.forEach(a),F.forEach(a),B.forEach(a),O=C(P),k=u(P,"ION-LABEL",{button:!0});var X=E(k);f=u(X,"ION-TEXT",{color:!0});var _e=E(f);s=u(_e,"H3",{});var ee=E(s);d=fe(ee,p),v=C(ee),b&&b.l(ee),ee.forEach(a),_e.forEach(a),M=C(X),S=u(X,"DIV",{class:!0,"data-svelte-h":!0}),J(S)!=="svelte-qaecoo"&&(S.innerHTML=R),X.forEach(a),D=C(P),q=u(P,"ION-ICON",{icon:!0,slot:!0}),E(q).forEach(a),N=C(P),P.forEach(a),this.h()},h(){W(r,"class","order svelte-egzizz"),W(n,"class","order-wrapper svelte-egzizz"),W(n,"title",g=Je(e[34].status)),V(n,"background-color",Se(e[34].status)),V(n,"color",Qe(Se(e[34].status))),m(o,"slot","start"),m(f,"color","#2e2e2e"),W(S,"class","sub svelte-egzizz"),m(k,"button",""),m(q,"icon",$e),m(q,"slot","end"),this.first=t},m(L,P){U(L,t,P),l(t,o),l(o,n),l(n,r),l(r,_),l(t,O),l(t,k),l(k,f),l(f,s),l(s,d),l(s,v),b&&b.m(s,null),l(k,M),l(k,S),l(t,D),l(t,q),l(t,N),y||(w=ne(k,"click",A),y=!0)},p(L,P){e=L,P[0]&32&&h!==(h=parseInt(e[34].pos)+1+"")&&we(_,h),P[0]&32&&g!==(g=Je(e[34].status))&&W(n,"title",g),P[0]&32&&V(n,"background-color",Se(e[34].status)),P[0]&32&&V(n,"color",Qe(Se(e[34].status))),P[0]&32&&p!==(p=e[34].title+"")&&we(d,p),P[0]&32&&(I=e[34].support_list&&e[34].support_list.length||e[15](e[34])),I?b||(b=Vt(),b.c(),b.m(s,null)):b&&(b.d(1),b=null)},d(L){L&&a(t),b&&b.d(),y=!1,w()}}}function Kt(i){let e;return{c(){e=c("span"),this.h()},l(t){e=u(t,"SPAN",{class:!0}),E(e).forEach(a),this.h()},h(){W(e,"class","notes svelte-egzizz")},m(t,o){U(t,e,o)},d(t){t&&a(e)}}}function Wt(i,e){let t,o,n,r,h=parseInt(e[34].pos)+1+"",_,g,O,k,f,s,p=e[34].title+"",d,v,I=e[34].support_list&&e[34].support_list.length||e[15](e[34]),M,S,R="",D,q,N,y,w,b=I&&Kt();function A(){return e[23](e[34],e[36])}return{key:i,first:null,c(){t=c("ion-item"),o=c("ion-avatar"),n=c("div"),r=c("div"),_=ue(h),O=T(),k=c("ion-label"),f=c("ion-text"),s=c("h3"),d=ue(p),v=T(),b&&b.c(),M=T(),S=c("div"),S.innerHTML=R,D=T(),q=c("ion-icon"),N=T(),this.h()},l(L){t=u(L,"ION-ITEM",{});var P=E(t);o=u(P,"ION-AVATAR",{slot:!0});var B=E(o);n=u(B,"DIV",{class:!0,title:!0,style:!0});var F=E(n);r=u(F,"DIV",{class:!0});var j=E(r);_=fe(j,h),j.forEach(a),F.forEach(a),B.forEach(a),O=C(P),k=u(P,"ION-LABEL",{button:!0});var X=E(k);f=u(X,"ION-TEXT",{color:!0});var _e=E(f);s=u(_e,"H3",{});var ee=E(s);d=fe(ee,p),v=C(ee),b&&b.l(ee),ee.forEach(a),_e.forEach(a),M=C(X),S=u(X,"DIV",{class:!0,"data-svelte-h":!0}),J(S)!=="svelte-qaecoo"&&(S.innerHTML=R),X.forEach(a),D=C(P),q=u(P,"ION-ICON",{icon:!0,slot:!0}),E(q).forEach(a),N=C(P),P.forEach(a),this.h()},h(){W(r,"class","order svelte-egzizz"),W(n,"class","order-wrapper svelte-egzizz"),W(n,"title",g=Je(e[34].status)),V(n,"background-color",Se(e[34].status)),V(n,"color",Qe(Se(e[34].status))),m(o,"slot","start"),m(f,"color","#2e2e2e"),W(S,"class","sub svelte-egzizz"),m(k,"button",""),m(q,"icon",$e),m(q,"slot","end"),this.first=t},m(L,P){U(L,t,P),l(t,o),l(o,n),l(n,r),l(r,_),l(t,O),l(t,k),l(k,f),l(f,s),l(s,d),l(s,v),b&&b.m(s,null),l(k,M),l(k,S),l(t,D),l(t,q),l(t,N),y||(w=ne(k,"click",A),y=!0)},p(L,P){e=L,P[0]&32&&h!==(h=parseInt(e[34].pos)+1+"")&&we(_,h),P[0]&32&&g!==(g=Je(e[34].status))&&W(n,"title",g),P[0]&32&&V(n,"background-color",Se(e[34].status)),P[0]&32&&V(n,"color",Qe(Se(e[34].status))),P[0]&32&&p!==(p=e[34].title+"")&&we(d,p),P[0]&32&&(I=e[34].support_list&&e[34].support_list.length||e[15](e[34])),I?b||(b=Kt(),b.c(),b.m(s,null)):b&&(b.d(1),b=null)},d(L){L&&a(t),b&&b.d(),y=!1,w()}}}function ao(i){let e,t,o,n,r=`<ion-icon icon="${vn}"></ion-icon>`,h,_,g,O=`<ion-icon icon="${gn}"></ion-icon>`,k,f,s=(i[6].name?i[6].name.toUpperCase():"")+"",p,d,v,I='<ion-segment-button value="list"><ion-label>Paradas</ion-label></ion-segment-button> <ion-segment-button value="map"><ion-label>Mapa</ion-label></ion-segment-button>',M,S,R,D;function q(w,b){if(w[9]==="list")return no;if(w[9]==="map")return to}let N=q(i),y=N&&N(i);return{c(){e=c("ion-header"),t=c("ion-toolbar"),o=c("ion-buttons"),n=c("ion-button"),n.innerHTML=r,h=T(),_=c("ion-buttons"),g=c("ion-button"),g.innerHTML=O,k=T(),f=c("ion-title"),p=ue(s),d=T(),v=c("ion-segment"),v.innerHTML=I,M=T(),y&&y.c(),S=Me(),this.h()},l(w){e=u(w,"ION-HEADER",{translucent:!0});var b=E(e);t=u(b,"ION-TOOLBAR",{});var A=E(t);o=u(A,"ION-BUTTONS",{slot:!0});var L=E(o);n=u(L,"ION-BUTTON",{title:!0,alt:!0,"data-svelte-h":!0}),J(n)!=="svelte-7ppz3r"&&(n.innerHTML=r),L.forEach(a),h=C(A),_=u(A,"ION-BUTTONS",{slot:!0});var P=E(_);g=u(P,"ION-BUTTON",{"data-svelte-h":!0}),J(g)!=="svelte-nf50hj"&&(g.innerHTML=O),P.forEach(a),k=C(A),f=u(A,"ION-TITLE",{});var B=E(f);p=fe(B,s),B.forEach(a),A.forEach(a),d=C(b),v=u(b,"ION-SEGMENT",{value:!0,"data-svelte-h":!0}),J(v)!=="svelte-lue4c9"&&(v.innerHTML=I),b.forEach(a),M=C(w),y&&y.l(w),S=Me(),this.h()},h(){m(n,"title","Atrás"),m(n,"alt","Atrás"),m(o,"slot","start"),m(_,"slot","end"),m(v,"value","list"),m(e,"translucent","")},m(w,b){U(w,e,b),l(e,t),l(t,o),l(o,n),l(t,h),l(t,_),l(_,g),l(t,k),l(t,f),l(f,p),l(e,d),l(e,v),U(w,M,b),y&&y.m(w,b),U(w,S,b),R||(D=[ne(n,"click",i[16]),ne(g,"click",i[20]),ne(v,"ionChange",i[21])],R=!0)},p(w,b){b[0]&64&&s!==(s=(w[6].name?w[6].name.toUpperCase():"")+"")&&we(p,s),N===(N=q(w))&&y?y.p(w,b):(y&&y.d(1),y=N&&N(w),y&&(y.c(),y.m(S.parentNode,S)))},d(w){w&&(a(e),a(M),a(S)),y&&y.d(w),R=!1,Ue(D)}}}function so(i){let e,t,o,n=i[2]&&Ut(i);return{c(){e=T(),n&&n.c(),t=Me(),this.h()},l(r){en("svelte-kn0kph",Bt.head).forEach(a),e=C(r),n&&n.l(r),t=Me(),this.h()},h(){Bt.title="Rutaflow - Detalles de ruta"},m(r,h){U(r,e,h),n&&n.m(r,h),U(r,t,h),o=!0},p(r,h){r[2]?n?(n.p(r,h),h[0]&4&&ct(n,1)):(n=Ut(r),n.c(),ct(n,1),n.m(t.parentNode,t)):n&&(cn(),_t(n,1,1,()=>{n=null}),on())},i(r){o||(ct(n),o=!0)},o(r){_t(n),o=!1},d(r){r&&(a(e),a(t)),n&&n.d(r)}}}function Se(i){let e="#ffffff";return i==="pending"?e="#f2e300":i==="completed"&&(e="#44d900"),e}function Je(i){let e="";return i=="pending"?e="Pendiente":i=="completed"&&(e="Completado"),e}function Qe(i){i.slice(0,1)==="#"&&(i=i.slice(1)),i.length===3&&(i=i.split("").map(function(r){return r+r}).join(""));const e=parseInt(i.substr(0,2),16),t=parseInt(i.substr(2,2),16),o=parseInt(i.substr(4,2),16);return(e*299+t*587+o*114)/1e3>=128?"#414040":"#fff"}function co(i,e){let t=new FormData;return t.append("id_route",i),t.append("status",e),fetch("https://dev.rutaflow.com/api/admin/route/change_status.php",{method:"POST",body:t}).then(o=>o.json()).then(o=>{}).catch(o=>{console.error("Error fetching data:",o)}),""}const uo=i=>i.img;function fo(i,e,t){let o;tn(i,bn,H=>t(19,o=H));var n=this&&this.__awaiter||function(H,K,x,le){function ie(he){return he instanceof x?he:new x(function(Ee){Ee(he)})}return new(x||(x=Promise))(function(he,Ee){function me(Te){try{ve(le.next(Te))}catch(Oe){Ee(Oe)}}function re(Te){try{ve(le.throw(Te))}catch(Oe){Ee(Oe)}}function ve(Te){Te.done?he(Te.value):ie(Te.value).then(me,re)}ve((le=le.apply(H,K||[])).next())})};let{routeId:r}=e,{driverId:h}=e,_=new Object,g=!0,O=!1,k=[],f={},s=[],p=[],d,v=!1,I="list",M;const S=()=>n(void 0,void 0,void 0,function*(){yield D(r),d.complete()});ot(()=>n(void 0,void 0,void 0,function*(){yield S()}));function R(H){return n(this,void 0,void 0,function*(){if(t(9,I=H),I==="map"){yield nn(),M=document.getElementById("g_map");const K=new google.maps.Map(M,{zoom:8,center:{lat:20.6745683,lng:-103.3986104},mapId:"4504f8b37365c3d0"}),x=new google.maps.LatLngBounds,{AdvancedMarkerElement:le,PinElement:ie}=yield google.maps.importLibrary("marker");k.forEach((he,Ee)=>{const me=parseFloat(he.lat),re=parseFloat(he.lon),ve=new google.maps.LatLng(me,re),Te=new google.maps.Marker({position:{lat:me,lng:re},map:K,title:he.title}),Oe=new ie({background:Se(he.status),borderColor:"#000",glyphColor:"#000",glyph:(parseInt(he.pos)+1).toString()});new le({map:K,position:ve,content:Oe.element,title:"Parada "+(parseInt(he.pos)+1).toString()+": "+he.title}).addListener("click",function(ze){N(he,P(Ee))}),x.extend(Te.getPosition())}),K.fitBounds(x)}})}function D(H){return n(this,void 0,void 0,function*(){const K=new FormData;K.append("id_route",H);try{const le=yield(yield fetch("https://dev.rutaflow.com/api/admin/report/seguimiento_list.php",{method:"POST",body:K})).json();t(6,f=le.data.seguimiento_list[0]),t(5,k=le.data.event_list),t(7,s=le.data.checklist),p=le.data.expenses,f&&t(4,O=f.km_inicial=="0"&&f.gas_inicial=="0"),t(3,g=!1)}catch(x){t(3,g=!1),console.error("Error fetching data:",x)}})}const q=H=>new Promise((K,x)=>{const le=new FormData;le.append("id_route",H.id_route),le.append("id_event",H.id_event),fetch("https://dev.rutaflow.com/api/admin/evidence/evidence_by_event.php",{method:"POST",body:le}).then(ie=>ie.json()).then(ie=>{K(ie.data.event_evidence[0])}).catch(ie=>{console.error("Error fetching data:",ie),x(ie)})}),N=(H,K)=>{q(H).then(x=>{x&&(H.img=x.img,H.driver_comments=x.driver_comments,H.comments=x.comments),qe("modal-delivery-info",Xn,{delivery:H,isLast:K}).then(le=>{}).finally(()=>{D(r)})})},y=(H,K,x)=>{var le=!1;return v||(v=!0,qe("modal-checklist",Zt,{checklist:H,driverId:K,routeId:x,isLast:le}).then(ie=>{v=!1}),co(x,"checklist")),""},w=H=>n(void 0,void 0,void 0,function*(){return yield D(H),p.length>0?qe("modal-expense-detail",eo,{routeId:H,expenses:p}).then(K=>{}):qe("modal-expense",pt,{routeId:H}).then(K=>{}),""}),b=H=>{if(H.tracking_type=="subscription"){if(H.subscriber_info&&H.payment_type==="cash"&&new Date(H.subscriber_info.payment_next)<new Date)return!0}else if(H.tracking_type=="ecommerce"&&Number(H.payment_pending)>0)return!0;return!1},A=()=>{_.id_driver?Ge(`/drivers/${_.id_driver}`):Ge("/drivers/me")},L=(H,K)=>n(void 0,void 0,void 0,function*(){yield(yield Ke.create({header:H||"Error",message:K||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()});function P(H){return H===k.length-1}const B=()=>w(r),F=H=>R(H.detail.value);function j(H){Pe[H?"unshift":"push"](()=>{d=H,t(8,d)})}const X=(H,K)=>N(H,P(K));function _e(H){Pe[H?"unshift":"push"](()=>{d=H,t(8,d)})}const ee=(H,K)=>N(H,P(K));function de(H){Pe[H?"unshift":"push"](()=>{d=H,t(8,d)})}const be=H=>{const K=k.findIndex(Ee=>Ee.id_event===H.id_event),x=K===0,le=K>0?k[K-1]:null,ie=x||le&&le.img!==null,he=H.img!==null&&H.img!=="";ie||x&&!he?N(H):L("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")};return i.$$set=H=>{"routeId"in H&&t(0,r=H.routeId),"driverId"in H&&t(1,h=H.driverId)},i.$$.update=()=>{i.$$.dirty[0]&524293&&(t(0,{routeId:r,driverId:h}=o.params,r,(t(1,h),t(19,o),t(2,_),t(0,r))),t(2,_=JSON.parse(localStorage.getItem("userSession"))),_?_.id_user&&(_.type=="admin"||_.type=="superadmin")?(D(r),Ge(`/drivers/me/routes/${r}`)):_.id_user&&_.id_driver&&(D(r),Ge(`/drivers/${_.id_driver}/routes/${r}`)):Ge("/"))},[r,h,_,g,O,k,f,s,d,I,S,R,N,y,w,b,A,L,P,o,B,F,j,X,_e,ee,de,be]}class Eo extends Ze{constructor(e){super(),xe(this,e,fo,so,Ye,{routeId:0,driverId:1},null,[-1,-1])}}export{Eo as component};

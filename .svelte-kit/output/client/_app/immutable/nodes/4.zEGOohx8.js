import{s as ve,j as L,k as H,l as be,h as c,m as R,i as g,p as ke,o as ge,e as p,t as U,b as m,q as k,r as V,d as $,v as F,w as _,x as ee,y as Q,z as Ie,A as Ee,n as ie,f as P,B as G,C as _e}from"../chunks/index.BzUyNcuj.js";import{S as ye,i as Ne,t as x,a as ne,c as Oe,b as Te,d as Ae,m as Se,e as we,g as De}from"../chunks/index.D9GPdhpm.js";import{l as Ce,p as Le,e as te,u as de,d as he}from"../chunks/index.BnjR_7h_.js";import"../chunks/index-6e05b96e.C_9q9BoX.js";import{I as Re,a as He}from"../chunks/IonPage.xQ4lM5iK.js";import{g as W}from"../chunks/entry.CGLtPgHd.js";function re(t,e,n){const l=t.slice();return l[18]=e[n],l}function se(t,e,n){const l=t.slice();return l[18]=e[n],l}function ae(t){let e,n;return e=new Re({props:{$$slots:{default:[je]},$$scope:{ctx:t}}}),{c(){Te(e.$$.fragment)},l(l){Ae(e.$$.fragment,l)},m(l,o){Se(e,l,o),n=!0},p(l,o){const a={};o&8388671&&(a.$$scope={dirty:o,ctx:l}),e.$set(a)},i(l){n||(x(e.$$.fragment,l),n=!0)},o(l){ne(e.$$.fragment,l),n=!1},d(l){we(e,l)}}}function Me(t){let e=[],n=new Map,l,o=te(t[2].filter(t[13]));const a=i=>i[18].id_route;for(let i=0;i<o.length;i+=1){let r=re(t,o,i),s=a(r);n.set(s,e[i]=ue(s,r))}return{c(){for(let i=0;i<e.length;i+=1)e[i].c();l=H()},l(i){for(let r=0;r<e.length;r+=1)e[r].l(i);l=H()},m(i,r){for(let s=0;s<e.length;s+=1)e[s]&&e[s].m(i,r);g(i,l,r)},p(i,r){r&901&&(o=te(i[2].filter(i[13])),e=de(e,r,a,1,i,o,n,l.parentNode,he,ue,l,re))},d(i){i&&c(l);for(let r=0;r<e.length;r+=1)e[r].d(i)}}}function Be(t){let e=[],n=new Map,l,o=te(t[2]);const a=i=>i[18].id_route;for(let i=0;i<o.length;i+=1){let r=se(t,o,i),s=a(r);n.set(s,e[i]=ce(s,r))}return{c(){for(let i=0;i<e.length;i+=1)e[i].c();l=H()},l(i){for(let r=0;r<e.length;r+=1)e[r].l(i);l=H()},m(i,r){for(let s=0;s<e.length;s+=1)e[s]&&e[s].m(i,r);g(i,l,r)},p(i,r){r&900&&(o=te(i[2]),e=de(e,r,a,1,i,o,n,l.parentNode,he,ce,l,se))},d(i){i&&c(l);for(let r=0;r<e.length;r+=1)e[r].d(i)}}}function Pe(t){let e=t[8]("false")+"",n;return{c(){n=U(e)},l(l){n=V(l,e)},m(l,o){g(l,n,o)},p:ie,d(l){l&&c(n)}}}function Ue(t){let e=t[8]("true")+"",n,l,o;function a(s,u){return s[18].status!="completed"&&s[18].status!="cancelled"?qe:Ve}let i=a(t),r=i(t);return{c(){n=U(e),l=L(),r.c(),o=H()},l(s){n=V(s,e),l=R(s),r.l(s),o=H()},m(s,u){g(s,n,u),g(s,l,u),r.m(s,u),g(s,o,u)},p(s,u){i===(i=a(s))&&r?r.p(s,u):(r.d(1),r=i(s),r&&(r.c(),r.m(o.parentNode,o)))},d(s){s&&(c(n),c(l),c(o)),r.d(s)}}}function Ve(t){let e=t[8]("false")+"",n;return{c(){n=U(e)},l(l){n=V(l,e)},m(l,o){g(l,n,o)},p:ie,d(l){l&&c(n)}}}function qe(t){let e,n,l,o,a=t[9](t[18].name.charAt(0))+"",i,r,s,u,C,I=t[18].name+"",b,B,N,E,y=t[18].date_start+"",A,q,f,O,M,S;return{c(){e=p("ion-item"),n=p("ion-avatar"),l=p("div"),o=p("div"),i=U(a),s=L(),u=p("ion-label"),C=p("h2"),b=U(I),B=L(),N=p("h3"),E=U("Inicio: "),A=U(y),q=L(),f=p("div"),O=L(),this.h()},l(w){e=m(w,"ION-ITEM",{button:!0});var v=k(e);n=m(v,"ION-AVATAR",{slot:!0});var D=k(n);l=m(D,"DIV",{class:!0,style:!0,title:!0});var h=k(l);o=m(h,"DIV",{class:!0,style:!0});var d=k(o);i=V(d,a),d.forEach(c),h.forEach(c),D.forEach(c),s=R(v),u=m(v,"ION-LABEL",{});var T=k(u);C=m(T,"H2",{});var z=k(C);b=V(z,I),z.forEach(c),B=R(T),N=m(T,"H3",{class:!0});var j=k(N);E=V(j,"Inicio: "),A=V(j,y),j.forEach(c),T.forEach(c),q=R(v),f=m(v,"DIV",{slot:!0}),k(f).forEach(c),O=R(v),v.forEach(c),this.h()},h(){P(o,"class","route-symbol svelte-1xh3ip"),P(o,"style",""),P(l,"class","route-color svelte-1xh3ip"),G(l,"background-color",Y(t[18].status)),G(l,"color",oe(Y(t[18].status))),P(l,"title",r=le(t[18].status)),F(n,"slot","start"),P(N,"class","text-muted svelte-1xh3ip"),P(f,"slot","end"),F(e,"button","")},m(w,v){g(w,e,v),_(e,n),_(n,l),_(l,o),_(o,i),_(e,s),_(e,u),_(u,C),_(C,b),_(u,B),_(u,N),_(N,E),_(N,A),_(e,q),_(e,f),_(e,O),M||(S=ee(e,"click",function(){_e(t[7](t[18].id_route,t[18].status))&&t[7](t[18].id_route,t[18].status).apply(this,arguments)}),M=!0)},p(w,v){t=w,v&5&&a!==(a=t[9](t[18].name.charAt(0))+"")&&Q(i,a),v&5&&G(l,"background-color",Y(t[18].status)),v&5&&G(l,"color",oe(Y(t[18].status))),v&5&&r!==(r=le(t[18].status))&&P(l,"title",r),v&5&&I!==(I=t[18].name+"")&&Q(b,I),v&5&&y!==(y=t[18].date_start+"")&&Q(A,y)},d(w){w&&c(e),M=!1,S()}}}function ue(t,e){let n,l,o;function a(s,u){return u&5&&(l=null),l==null&&(l=!!pe(s[18].date_start)),l?Ue:Pe}let i=a(e,-1),r=i(e);return{key:t,first:null,c(){n=H(),r.c(),o=H(),this.h()},l(s){n=H(),r.l(s),o=H(),this.h()},h(){this.first=n},m(s,u){g(s,n,u),r.m(s,u),g(s,o,u)},p(s,u){e=s,i===(i=a(e,u))&&r?r.p(e,u):(r.d(1),r=i(e),r&&(r.c(),r.m(o.parentNode,o)))},d(s){s&&(c(n),c(o)),r.d(s)}}}function ze(t){let e=t[8]("false")+"",n;return{c(){n=U(e)},l(l){n=V(l,e)},m(l,o){g(l,n,o)},p:ie,d(l){l&&c(n)}}}function Fe(t){let e=t[8]("true")+"",n,l,o,a,i,r,s=t[9](t[18].name.charAt(0))+"",u,C,I,b,B,N=(t[18].name?t[18].name.toUpperCase():"")+"",E,y,A,q,f=t[18].date_start+"",O,M,S,w,v,D;return{c(){n=U(e),l=L(),o=p("ion-item"),a=p("ion-avatar"),i=p("div"),r=p("div"),u=U(s),I=L(),b=p("ion-label"),B=p("h2"),E=U(N),y=L(),A=p("h3"),q=U("Inicio: "),O=U(f),M=L(),S=p("div"),w=L(),this.h()},l(h){n=V(h,e),l=R(h),o=m(h,"ION-ITEM",{button:!0});var d=k(o);a=m(d,"ION-AVATAR",{slot:!0});var T=k(a);i=m(T,"DIV",{class:!0,style:!0,title:!0});var z=k(i);r=m(z,"DIV",{class:!0,style:!0});var j=k(r);u=V(j,s),j.forEach(c),z.forEach(c),T.forEach(c),I=R(d),b=m(d,"ION-LABEL",{});var K=k(b);B=m(K,"H2",{});var X=k(B);E=V(X,N),X.forEach(c),y=R(K),A=m(K,"H3",{class:!0});var J=k(A);q=V(J,"Inicio: "),O=V(J,f),J.forEach(c),K.forEach(c),M=R(d),S=m(d,"DIV",{slot:!0}),k(S).forEach(c),w=R(d),d.forEach(c),this.h()},h(){P(r,"class","route-symbol svelte-1xh3ip"),P(r,"style",""),P(i,"class","route-color svelte-1xh3ip"),G(i,"background-color",Y(t[18].status)),G(i,"color",oe(Y(t[18].status))),P(i,"title",C=le(t[18].status)),F(a,"slot","start"),P(A,"class","text-muted svelte-1xh3ip"),P(S,"slot","end"),F(o,"button","")},m(h,d){g(h,n,d),g(h,l,d),g(h,o,d),_(o,a),_(a,i),_(i,r),_(r,u),_(o,I),_(o,b),_(b,B),_(B,E),_(b,y),_(b,A),_(A,q),_(A,O),_(o,M),_(o,S),_(o,w),v||(D=ee(o,"click",function(){_e(t[7](t[18].id_route,t[18].status))&&t[7](t[18].id_route,t[18].status).apply(this,arguments)}),v=!0)},p(h,d){t=h,d&4&&s!==(s=t[9](t[18].name.charAt(0))+"")&&Q(u,s),d&4&&G(i,"background-color",Y(t[18].status)),d&4&&G(i,"color",oe(Y(t[18].status))),d&4&&C!==(C=le(t[18].status))&&P(i,"title",C),d&4&&N!==(N=(t[18].name?t[18].name.toUpperCase():"")+"")&&Q(E,N),d&4&&f!==(f=t[18].date_start+"")&&Q(O,f)},d(h){h&&(c(n),c(l),c(o)),v=!1,D()}}}function ce(t,e){let n,l,o;function a(s,u){return u&4&&(l=null),l==null&&(l=!!pe(s[18].date_start)),l?Fe:ze}let i=a(e,-1),r=i(e);return{key:t,first:null,c(){n=H(),r.c(),o=H(),this.h()},l(s){n=H(),r.l(s),o=H(),this.h()},h(){this.first=n},m(s,u){g(s,n,u),r.m(s,u),g(s,o,u)},p(s,u){e=s,i===(i=a(e,u))&&r?r.p(e,u):(r.d(1),r=i(e),r&&(r.c(),r.m(o.parentNode,o)))},d(s){s&&(c(n),c(o)),r.d(s)}}}function fe(t){let e,n='<ion-row class="h-full items-center"><ion-col class="text-center"><h2 class="text-3xl text-muted mb-4 svelte-1xh3ip">No hay rutas pendientes para hoy</h2> <p class="text-muted svelte-1xh3ip">Espere indicaciones de su supervisor</p></ion-col></ion-row>';return{c(){e=p("ion-grid"),e.innerHTML=n,this.h()},l(l){e=m(l,"ION-GRID",{class:!0,"data-svelte-h":!0}),$(e)!=="svelte-3d9uou"&&(e.innerHTML=n),this.h()},h(){F(e,"class","ion-text-center h-full")},m(l,o){g(l,e,o)},d(l){l&&c(e)}}}function je(t){let e,n,l,o,a=t[1].name+"",i,r,s,u="RUTAS DEL DÍA",C,I,b,B=`<ion-icon icon="${Ce}"></ion-icon>`,N,E,y,A='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Jale para actualizar" refreshing-spinner="circles" refreshing-text="Actualizando..."></ion-refresher-content>',q,f,O,M,S;function w(d,T){return d[0]=="me"&&d[4]?Be:Me}let v=w(t),D=v(t),h=!t[3]&&fe();return{c(){e=p("ion-header"),n=p("ion-toolbar"),l=p("ion-buttons"),o=p("ion-button"),i=U(a),r=L(),s=p("ion-title"),s.textContent=u,C=L(),I=p("ion-buttons"),b=p("ion-button"),b.innerHTML=B,N=L(),E=p("ion-content"),y=p("ion-refresher"),y.innerHTML=A,q=L(),f=p("ion-list"),D.c(),O=L(),h&&h.c(),this.h()},l(d){e=m(d,"ION-HEADER",{translucent:!0});var T=k(e);n=m(T,"ION-TOOLBAR",{});var z=k(n);l=m(z,"ION-BUTTONS",{slot:!0});var j=k(l);o=m(j,"ION-BUTTON",{});var K=k(o);i=V(K,a),K.forEach(c),j.forEach(c),r=R(z),s=m(z,"ION-TITLE",{"data-svelte-h":!0}),$(s)!=="svelte-1oi1i0m"&&(s.textContent=u),C=R(z),I=m(z,"ION-BUTTONS",{slot:!0});var X=k(I);b=m(X,"ION-BUTTON",{title:!0,alt:!0,"data-svelte-h":!0}),$(b)!=="svelte-1itonhq"&&(b.innerHTML=B),X.forEach(c),z.forEach(c),T.forEach(c),N=R(d),E=m(d,"ION-CONTENT",{});var J=k(E);y=m(J,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),$(y)!=="svelte-1wkherr"&&(y.innerHTML=A),q=R(J),f=m(J,"ION-LIST",{});var Z=k(f);D.l(Z),O=R(Z),h&&h.l(Z),Z.forEach(c),J.forEach(c),this.h()},h(){F(l,"slot","secondary"),F(b,"title","Salir"),F(b,"alt","Salir"),F(I,"slot","primary"),F(e,"translucent",""),F(y,"slot","fixed")},m(d,T){g(d,e,T),_(e,n),_(n,l),_(l,o),_(o,i),_(n,r),_(n,s),_(n,C),_(n,I),_(I,b),g(d,N,T),g(d,E,T),_(E,y),t[12](y),_(E,q),_(E,f),D.m(f,null),_(f,O),h&&h.m(f,null),M||(S=[ee(b,"click",t[10]),ee(y,"ionRefresh",t[6])],M=!0)},p(d,T){T&2&&a!==(a=d[1].name+"")&&Q(i,a),v===(v=w(d))&&D?D.p(d,T):(D.d(1),D=v(d),D&&(D.c(),D.m(f,O))),d[3]?h&&(h.d(1),h=null):h||(h=fe(),h.c(),h.m(f,null))},d(d){d&&(c(e),c(N),c(E)),t[12](null),D.d(),h&&h.d(),M=!1,Ie(S)}}}function Je(t){let e,n,l,o=t[1]&&ae(t);return{c(){e=L(),o&&o.c(),n=H(),this.h()},l(a){be("svelte-qavk4j",document.head).forEach(c),e=R(a),o&&o.l(a),n=H(),this.h()},h(){document.title="Rutas - Rutaflow"},m(a,i){g(a,e,i),o&&o.m(a,i),g(a,n,i),l=!0},p(a,[i]){a[1]?o?(o.p(a,i),i&2&&x(o,1)):(o=ae(a),o.c(),x(o,1),o.m(n.parentNode,n)):o&&(De(),ne(o,1,1,()=>{o=null}),Oe())},i(a){l||(x(o),l=!0)},o(a){ne(o),l=!1},d(a){a&&(c(e),c(n)),o&&o.d(a)}}}function pe(t){var e=me();const n=t.split(" ")[0];return e===n}function Y(t){let e="#ffffff";return t==="pending"?e="#FAD733":t==="completed"?e="#27C24C":t=="enroute"?e="#3BBAC2":t=="paused"?e="#949DB9":t=="cancelled"?e="#F05050":t=="checklist"?e="#F6A833":t=="checklist-pending"&&(e="#E98C00"),e}function le(t){let e="";return t==="pending"?e="Pendiente":t==="completed"?e="Completado":t=="enroute"?e="En ruta":t=="paused"?e="Pausado":t=="cancelled"?e="Cancelado":t=="checklist"?e="En checklist":t=="checklist-pending"&&(e="Pendiente de aprobar checklist"),e}function oe(t){t.slice(0,1)==="#"&&(t=t.slice(1)),t.length===3&&(t=t.split("").map(function(a){return a+a}).join(""));const e=parseInt(t.substr(0,2),16),n=parseInt(t.substr(2,2),16),l=parseInt(t.substr(4,2),16);return(e*299+n*587+l*114)/1e3>=128?"#414040":"#fff"}function me(){var t=new Date,e=t.getDate(),n=t.getMonth()+1,l=t.getFullYear();return e<10&&(e="0"+e),n<10&&(n="0"+n),t=l+"-"+n+"-"+e,t}function Ge(t,e,n){let l;ke(t,Le,f=>n(11,l=f));let{driverId:o}=e,a=[],i=!1,r=!1,s=new Object,u;const C=async()=>{await I(),u.complete()};ge(async()=>{o==="41"&&(localStorage.clear(),console.log("Cleared session from localStorage")),await I()});function I(f){var O=me();const M=new FormData;M.append("actual_date",O),fetch("https://app.rutaflow.com/api/admin/report/seguimiento_list.php",{method:"POST",body:M}).then(S=>S.json()).then(S=>{const w=S;n(2,a=w.data.seguimiento_list),w.data.event_list}).catch(S=>{console.error("Error fetching data:",S)})}function b(f,O){O=="checklist-pending"?E("Checklist Pendiente de Autorizar","La lista de requerimientos de ruta está en revisión, podrás inciar la ruta una vez autorizado el checklist."):W(`/drivers/${o}/routes/${f}`)}function B(f){return f=="true"?n(3,i=!0):n(3,i=!1),""}const N=f=>f.charAt(0).toUpperCase()+f.slice(1),E=async(f,O)=>{await(await He.create({header:f||"Error",message:O||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()},y=()=>{W("/"),n(4,r=!1),localStorage.removeItem("userSession")};function A(f){Ee[f?"unshift":"push"](()=>{u=f,n(5,u)})}const q=f=>f.id_driver===o;return t.$$set=f=>{"driverId"in f&&n(0,o=f.driverId)},t.$$.update=()=>{if(t.$$.dirty&2051){n(0,{driverId:o}=l.params,o);const f=localStorage.getItem("userSession");n(1,s=JSON.parse(f)),s?o=="me"&&s.id_user?s.type=="admin"||s.type=="super"?(W("/drivers/me"),I(),n(4,r=!0)):(E("Usuario no autorizado","Este usuario no tiene acceso a la app de Rutaflow, entrar en contacto con soporte"),W("/")):s&&o&&(W(`/drivers/${s.id_driver}`),I()):(E("Sesión cerrada","Será redireccionado para volver a ingresar"),W("/"))}},[o,s,a,i,r,u,C,b,B,N,y,l,A,q]}class $e extends ye{constructor(e){super(),Ne(this,e,Ge,Je,ve,{driverId:0})}}export{$e as component};

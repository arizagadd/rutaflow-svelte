import{Z as it,s as Fe,e as c,j as A,b as u,q as g,d as Z,h as s,m as D,v as E,i as z,w as i,x,n as Oe,z as De,_ as Ut,B as K,o as Ht,k as Ne,$ as lt,t as ie,r as le,f as G,a0 as Rt,y as ge,a1 as qe,A as Ie,a2 as Ze,l as qt,p as pt}from"../chunks/index.BYLndrM5.js";import{S as je,i as Ve,t as Xe,a as et,c as zt,b as Ft,d as jt,m as Vt,e as Kt,g as Gt}from"../chunks/index.BNHbygFo.js";import{e as Ae,u as Qe,d as xe,a as Wt,c as tt,b as Dt,i as Pt,f as Xt,g as St,s as rt,h as Re,j as Jt,k as Yt,m as Zt,p as Qt}from"../chunks/index.0JcMHLFT.js";import{g as Se}from"../chunks/entry.Ba4VUuUh.js";import"../chunks/index-48209844.IIRtDZyg.js";import{m as at,a as Je,I as xt}from"../chunks/IonPage.KvUD72q2.js";import{q as $t,t as en}from"../chunks/ion-modal.CsJaVgKZ.js";const tn=(l,e)=>{if(!customElements.get(l)){class t extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const n={};for(const r of this.attributes)n[r.name]=r.value;new e({target:this.shadowRoot,props:n})}}customElements.define(l,t)}},nn=function(l){return document.createElement(l).constructor!==HTMLElement},on=(l,e)=>{nn(l)||tn(l,e)},ze=async(l,e,t)=>{$t(),en(),on(l,e);const o=await at.create({component:l,componentProps:t});return o.present(),await o.onWillDismiss()};let Me=it({km_inicial:[],gas_inicial:[],km_final:[],gas_final:[]}),Bt=it({flag:[]});function ln(l){let e,t,o,n,r="Cancelar",_,p,h="Captura de Km/Gas",T,k,v,a="Confirmar",I,m,d,f,N,y,O;return{c(){e=c("ion-header"),t=c("ion-toolbar"),o=c("ion-buttons"),n=c("ion-button"),n.textContent=r,_=A(),p=c("ion-title"),p.textContent=h,T=A(),k=c("ion-buttons"),v=c("ion-button"),v.textContent=a,I=A(),m=c("ion-content"),d=c("ion-item"),f=c("ion-input"),this.h()},l(B){e=u(B,"ION-HEADER",{translucent:!0});var w=g(e);t=u(w,"ION-TOOLBAR",{});var P=g(t);o=u(P,"ION-BUTTONS",{slot:!0});var U=g(o);n=u(U,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),Z(n)!=="svelte-17pq4f4"&&(n.textContent=r),U.forEach(s),_=D(P),p=u(P,"ION-TITLE",{"data-svelte-h":!0}),Z(p)!=="svelte-1yhkaq7"&&(p.textContent=h),T=D(P),k=u(P,"ION-BUTTONS",{slot:!0});var S=g(k);v=u(S,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),Z(v)!=="svelte-cm6j4s"&&(v.textContent=a),S.forEach(s),P.forEach(s),w.forEach(s),I=D(B),m=u(B,"ION-CONTENT",{fullscreen:!0});var b=g(m);d=u(b,"ION-ITEM",{});var L=g(d);f=u(L,"ION-INPUT",{class:!0,inputmode:!0,pattern:!0,type:!0,placeholder:!0,value:!0,required:!0});var H=g(f);H.forEach(s),L.forEach(s),b.forEach(s),this.h()},h(){E(n,"color","medium"),E(o,"slot","start"),E(v,"strong",""),E(k,"slot","end"),E(e,"translucent",""),E(f,"class","fin-km"),E(f,"inputmode","numeric"),E(f,"pattern","[0-9]*"),E(f,"type","number"),E(f,"placeholder",N="Ingresa "+l[0]+" actual"),E(f,"value",l[1]),E(f,"required",""),E(m,"fullscreen","")},m(B,w){z(B,e,w),i(e,t),i(t,o),i(o,n),i(t,_),i(t,p),i(t,T),i(t,k),i(k,v),z(B,I,w),z(B,m,w),i(m,d),i(d,f),y||(O=[x(n,"click",l[2]),x(v,"click",l[3]),x(f,"input",l[4])],y=!0)},p(B,[w]){w&1&&N!==(N="Ingresa "+B[0]+" actual")&&E(f,"placeholder",N),w&2&&E(f,"value",B[1])},i:Oe,o:Oe,d(B){B&&(s(e),s(I),s(m)),y=!1,De(O)}}}function rn(l,e,t){const o=Ut();let n=document.querySelector("ion-modal"),r=n.componentProps.data_type;n.componentProps.isLast;let _;Bt.subscribe(v=>{r=v.flag[0],r=="km_final"||r=="km_inicial"?t(0,_="kilometraje"):t(0,_="litros de gasolina")});let p=0;function h(){at.dismiss()}function T(){o("modalResult",{data:"Your data",role:"confirm"}),r=="km_inicial"?Me.update(a=>({...a,km_inicial:[p]})):r=="gas_inicial"?Me.update(a=>({...a,gas_inicial:[p]})):r=="km_final"?Me.update(a=>({...a,km_final:[p]})):r=="gas_final"&&Me.update(a=>({...a,gas_final:[p]})),h()}return[_,p,h,T,v=>t(1,p=v.target.value)]}class an extends je{constructor(e){super(),Ve(this,e,rn,ln,Fe,{})}}const Ye=it({items:[],checkedIndices:[],mandatory:[]});function mt(l,e,t){const o=l.slice();return o[49]=e[t],o[50]=e,o[51]=t,o}function sn(l){let e,t,o,n,r,_="Kilometraje inicial",p,h,T=l[0]?l[0]+" km.":"Cargar km",k,v,a,I,m,d,f,N="Gasolina inicial (litros)",y,O,B=l[1]?l[1]+" litros":"Cargar gas",w,P,U,S;return P=lt(l[20][0]),{c(){e=c("ion-item"),t=c("ion-label"),o=c("input"),n=A(),r=c("p"),r.textContent=_,p=A(),h=c("ion-button"),k=ie(T),v=A(),a=c("ion-item"),I=c("ion-label"),m=c("input"),d=A(),f=c("p"),f.textContent=N,y=A(),O=c("ion-button"),w=ie(B),this.h()},l(b){e=u(b,"ION-ITEM",{});var L=g(e);t=u(L,"ION-LABEL",{style:!0});var H=g(t);o=u(H,"INPUT",{id:!0,style:!0,type:!0}),n=D(H),r=u(H,"P",{style:!0,"data-svelte-h":!0}),Z(r)!=="svelte-88twxi"&&(r.textContent=_),H.forEach(s),p=D(L),h=u(L,"ION-BUTTON",{fill:!0,size:!0,class:!0,"aria-selected":!0});var M=g(h);k=le(M,T),M.forEach(s),L.forEach(s),v=D(b),a=u(b,"ION-ITEM",{});var q=g(a);I=u(q,"ION-LABEL",{style:!0});var C=g(I);m=u(C,"INPUT",{id:!0,style:!0,type:!0}),d=D(C),f=u(C,"P",{style:!0,"data-svelte-h":!0}),Z(f)!=="svelte-1ux30eb"&&(f.textContent=N),C.forEach(s),y=D(q),O=u(q,"ION-BUTTON",{fill:!0,class:!0,size:!0,style:!0});var F=g(O);w=le(F,B),F.forEach(s),q.forEach(s),this.h()},h(){G(o,"id","chkbox-km-ini"),K(o,"pointer-events","auto"),G(o,"type","checkbox"),o.required=!0,K(r,"margin-left","10px"),K(t,"display","flex"),E(h,"fill","outline"),E(h,"size","small"),E(h,"class","loadKmInicial"),E(h,"aria-selected",""),G(m,"id","chkbox-gas-ini"),K(m,"pointer-events","auto"),G(m,"type","checkbox"),m.required=!0,K(f,"margin-left","10px"),K(I,"display","flex"),E(O,"fill","outline"),E(O,"class","loadGasInicial"),E(O,"size","small"),K(O,"height","16px "),P.p(o,m)},m(b,L){z(b,e,L),i(e,t),i(t,o),o.checked=~(l[4]||[]).indexOf(o.__value),l[27](o),i(t,n),i(t,r),i(e,p),i(e,h),i(h,k),z(b,v,L),z(b,a,L),i(a,I),i(I,m),l[29](m),m.checked=~(l[4]||[]).indexOf(m.__value),i(I,d),i(I,f),i(a,y),i(a,O),i(O,w),U||(S=[x(o,"change",l[26]),x(h,"click",l[28]),x(m,"change",l[30]),x(O,"click",l[31])],U=!0)},p(b,L){L[0]&16&&(o.checked=~(b[4]||[]).indexOf(o.__value)),L[0]&1&&T!==(T=b[0]?b[0]+" km.":"Cargar km")&&ge(k,T),L[0]&16&&(m.checked=~(b[4]||[]).indexOf(m.__value)),L[0]&2&&B!==(B=b[1]?b[1]+" litros":"Cargar gas")&&ge(w,B)},d(b){b&&(s(e),s(v),s(a)),l[27](null),l[29](null),P.r(),U=!1,De(S)}}}function cn(l){let e,t,o,n,r,_="Kilometraje final",p,h,T=l[2]?l[2]+" km.":"Cargar km",k,v,a,I,m,d,f,N="Gasolina final (litros)",y,O,B=l[3]?l[3]+" litros":"Cargar gas",w,P,U,S;return P=lt(l[20][0]),{c(){e=c("ion-item"),t=c("ion-label"),o=c("input"),n=A(),r=c("p"),r.textContent=_,p=A(),h=c("ion-button"),k=ie(T),v=A(),a=c("ion-item"),I=c("ion-label"),m=c("input"),d=A(),f=c("p"),f.textContent=N,y=A(),O=c("ion-button"),w=ie(B),this.h()},l(b){e=u(b,"ION-ITEM",{});var L=g(e);t=u(L,"ION-LABEL",{style:!0});var H=g(t);o=u(H,"INPUT",{id:!0,style:!0,type:!0}),n=D(H),r=u(H,"P",{style:!0,"data-svelte-h":!0}),Z(r)!=="svelte-ccmu71"&&(r.textContent=_),H.forEach(s),p=D(L),h=u(L,"ION-BUTTON",{fill:!0,size:!0,class:!0,"aria-selected":!0});var M=g(h);k=le(M,T),M.forEach(s),L.forEach(s),v=D(b),a=u(b,"ION-ITEM",{});var q=g(a);I=u(q,"ION-LABEL",{style:!0});var C=g(I);m=u(C,"INPUT",{id:!0,style:!0,type:!0}),d=D(C),f=u(C,"P",{style:!0,"data-svelte-h":!0}),Z(f)!=="svelte-wsoyd2"&&(f.textContent=N),C.forEach(s),y=D(q),O=u(q,"ION-BUTTON",{fill:!0,size:!0,class:!0});var F=g(O);w=le(F,B),F.forEach(s),q.forEach(s),this.h()},h(){G(o,"id","chkbox-km-fin"),K(o,"pointer-events","auto"),G(o,"type","checkbox"),o.required=!0,K(r,"margin-left","10px"),K(t,"display","flex"),E(h,"fill","outline"),E(h,"size","small"),E(h,"class","loadKmInicial"),E(h,"aria-selected",""),G(m,"id","chkbox-gas-fin"),K(m,"pointer-events","auto"),G(m,"type","checkbox"),m.required=!0,K(f,"margin-left","10px"),K(I,"display","flex"),E(O,"fill","outline"),E(O,"size","small"),E(O,"class","loadGasInicial"),P.p(o,m)},m(b,L){z(b,e,L),i(e,t),i(t,o),o.checked=~(l[4]||[]).indexOf(o.__value),l[21](o),i(t,n),i(t,r),i(e,p),i(e,h),i(h,k),z(b,v,L),z(b,a,L),i(a,I),i(I,m),m.checked=~(l[4]||[]).indexOf(m.__value),l[24](m),i(I,d),i(I,f),i(a,y),i(a,O),i(O,w),U||(S=[x(o,"change",l[19]),x(h,"click",l[22]),x(m,"change",l[23]),x(O,"click",l[25])],U=!0)},p(b,L){L[0]&16&&(o.checked=~(b[4]||[]).indexOf(o.__value)),L[0]&4&&T!==(T=b[2]?b[2]+" km.":"Cargar km")&&ge(k,T),L[0]&16&&(m.checked=~(b[4]||[]).indexOf(m.__value)),L[0]&8&&B!==(B=b[3]?b[3]+" litros":"Cargar gas")&&ge(w,B)},d(b){b&&(s(e),s(v),s(a)),l[21](null),l[24](null),P.r(),U=!1,De(S)}}}function un(l){let e=[],t=new Map,o,n=Ae(l[12]);const r=_=>_[49].id_checklist_event;for(let _=0;_<n.length;_+=1){let p=mt(l,n,_),h=r(p);t.set(h,e[_]=vt(h,p))}return{c(){for(let _=0;_<e.length;_+=1)e[_].c();o=Ne()},l(_){for(let p=0;p<e.length;p+=1)e[p].l(_);o=Ne()},m(_,p){for(let h=0;h<e.length;h+=1)e[h]&&e[h].m(_,p);z(_,o,p)},p(_,p){p[0]&202864&&(n=Ae(_[12]),e=Qe(e,p,r,1,_,n,t,o.parentNode,xe,vt,o,mt))},d(_){_&&s(o);for(let p=0;p<e.length;p+=1)e[p].d(_)}}}function vt(l,e){let t,o,n,r=e[49],_,p,h=e[49].item+"",T,k,v,a,I=(e[11][e[49].id_checklist_event]?e[11][e[49].id_checklist_event]:"Cargar evidencia")+"",m,d,f,N,y,O,B;const w=()=>e[33](n,r),P=()=>e[33](null,r);function U(){return e[34](e[49])}function S(...b){return e[36](e[49],...b)}return y=lt(e[20][0]),{key:l,first:null,c(){t=c("ion-item"),o=c("ion-label"),n=c("input"),_=A(),p=c("p"),T=ie(h),k=A(),v=c("ion-button"),a=c("label"),m=ie(I),d=A(),f=c("input"),N=A(),this.h()},l(b){t=u(b,"ION-ITEM",{});var L=g(t);o=u(L,"ION-LABEL",{style:!0});var H=g(o);n=u(H,"INPUT",{id:!0,style:!0,type:!0}),_=D(H),p=u(H,"P",{style:!0});var M=g(p);T=le(M,h),M.forEach(s),H.forEach(s),k=D(L),v=u(L,"ION-BUTTON",{fill:!0,class:!0,size:!0});var q=g(v);a=u(q,"LABEL",{for:!0});var C=g(a);m=le(C,I),C.forEach(s),d=D(q),f=u(q,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0}),q.forEach(s),N=D(L),L.forEach(s),this.h()},h(){G(n,"id",`chkbox-${e[49].id_checklist_event}`),K(n,"pointer-events","auto"),G(n,"type","checkbox"),n.__value=e[49].id_checklist_event,Rt(n,n.__value),n.required=!0,K(p,"margin-left","10px"),K(o,"display","flex"),G(a,"for","chklist-"+e[49].id_checklist_event),K(f,"display","none"),G(f,"id","chklist-"+e[49].id_checklist_event),G(f,"name","fileToUpload"),G(f,"type","file"),G(f,"accept","image/*"),E(v,"fill","outline"),E(v,"class","loadEvidence svelte-1lh6nay"),E(v,"size","small"),y.p(n),this.first=t},m(b,L){z(b,t,L),i(t,o),i(o,n),n.checked=~(e[4]||[]).indexOf(n.__value),w(),i(o,_),i(o,p),i(p,T),i(t,k),i(t,v),i(v,a),i(a,m),i(v,d),i(v,f),e[35](f),i(t,N),O||(B=[x(n,"change",e[32]),x(n,"change",U),x(f,"change",S)],O=!0)},p(b,L){e=b,L[0]&16&&(n.checked=~(e[4]||[]).indexOf(n.__value)),r!==e[49]&&(P(),r=e[49],w()),L[0]&2048&&I!==(I=(e[11][e[49].id_checklist_event]?e[11][e[49].id_checklist_event]:"Cargar evidencia")+"")&&ge(m,I)},d(b){b&&s(t),P(),e[35](null),y.r(),O=!1,De(B)}}}function fn(l){let e,t,o,n,r="Cancelar",_,p,h="Requerimientos de ruta",T,k,v,a,I,m,d,f="Confirmar",N,y;function O(U,S){return U[13]?cn:sn}let w=O(l)(l),P=l[12]&&un(l);return{c(){e=c("ion-header"),t=c("ion-toolbar"),o=c("ion-buttons"),n=c("ion-button"),n.textContent=r,_=A(),p=c("ion-title"),p.textContent=h,T=A(),k=c("ion-content"),v=c("ion-list"),w.c(),a=A(),P&&P.c(),I=A(),m=c("ion-footer"),d=c("ion-button"),d.textContent=f,this.h()},l(U){e=u(U,"ION-HEADER",{translucent:!0});var S=g(e);t=u(S,"ION-TOOLBAR",{});var b=g(t);o=u(b,"ION-BUTTONS",{slot:!0});var L=g(o);n=u(L,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),Z(n)!=="svelte-1dnmkxs"&&(n.textContent=r),L.forEach(s),_=D(b),p=u(b,"ION-TITLE",{"data-svelte-h":!0}),Z(p)!=="svelte-ucox25"&&(p.textContent=h),b.forEach(s),S.forEach(s),T=D(U),k=u(U,"ION-CONTENT",{fullscreen:!0});var H=g(k);v=u(H,"ION-LIST",{});var M=g(v);w.l(M),a=D(M),P&&P.l(M),M.forEach(s),H.forEach(s),I=D(U),m=u(U,"ION-FOOTER",{});var q=g(m);d=u(q,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),Z(d)!=="svelte-g82qqw"&&(d.textContent=f),q.forEach(s),this.h()},h(){E(n,"color","medium"),E(o,"slot","start"),E(e,"translucent",""),E(k,"fullscreen",""),E(d,"fill","outline"),E(d,"color","tertiary"),E(d,"strong",""),K(d,"width","99%"),K(d,"height","auto")},m(U,S){z(U,e,S),i(e,t),i(t,o),i(o,n),i(t,_),i(t,p),z(U,T,S),z(U,k,S),i(k,v),w.m(v,null),i(v,a),P&&P.m(v,null),z(U,I,S),z(U,m,S),i(m,d),N||(y=[x(n,"click",l[14]),x(d,"click",l[15])],N=!0)},p(U,S){w.p(U,S),U[12]&&P.p(U,S)},i:Oe,o:Oe,d(U){U&&(s(e),s(T),s(k),s(I),s(m)),w.d(),P&&P.d(),N=!1,De(y)}}}function nt(l,e){if(typeof l=="object"&&l!==null||Array.isArray(l)){if(Array.isArray(l))return l.map(t=>nt(t,e)).flat();{const t=Object.keys(l);let o;return e=="id_checklist_event"?o=t.filter(r=>r.toLowerCase().includes("id_checklist_event")).map(r=>l[r]):e=="mandatory"?o=t.filter(r=>r.toLowerCase().includes("mandatory")).map(r=>l[r]):(console.error("Tipo de dato no reconocido."),o=!1),o}}else return console.error("Invalid input. Please provide a valid object or array."),[]}function $e(l,e){let t=new FormData;t.append("id_route",l),t.append("status",e),fetch("https://rutaflow-app-development.up.railway.app/api/admin/route/change_status.php",{method:"POST",body:t}).then(o=>o.json()).then(o=>{}).catch(o=>{console.error("Error fetching data:",o)})}function _n(l,e,t){let o=document.querySelector("ion-modal");const n=o.componentProps.checklist,r=o.componentProps.driverId,_=o.componentProps.routeId,p=o.componentProps.isLast;let h,T,k,v,a=[],I=null,m={},d,f,N,y,O={},B={};Ht(()=>{p?console.log("Último checklist"):Ye.update(R=>(R.mandatory=nt(n,"mandatory"),R.items=nt(n,"id_checklist_event"),R))});const w=async()=>{await(await Je.create({header:"Datos o checklist incompletos",message:"Carga la evidencia requerida y marca todas las casillas para confirmar",buttons:[{text:"Cerrar"}]})).present()},P=async()=>{await(await Je.create({header:"Datos capturados",message:"El kilometraje y gasolina final fueron registrados correctamente, espere aprobación para finalizar ruta",buttons:[{text:"Cerrar"}]})).present()},U=async R=>{await(await Je.create({header:"Datos inválidos",message:R=="km"?"Llena correctamente el campo de kilometraje inicial":"Llena correctamente el campo de gasolina inicial",buttons:[{text:"Cerrar"}]})).present()},S=()=>{at.dismiss(),r?Se(`/drivers/${r}`):Se("/drivers/me")},b=()=>{if(p){var R=q(k,"km"),W=q(v,"gas");const Y=new FormData;Y.append("km_final",R),Y.append("gas_final",W),Y.append("id_route",_),R&&W?(S(),fetch("https://rutaflow-app-development.up.railway.app/api/admin/checklist/add_evidence.php",{method:"POST",body:Y}).then($=>$.json()).then($=>{P()}).catch($=>{console.error("Error fetching data:",$)})):w()}else{var ee=q(h,"km"),ne=q(T,"gas");Ye.update(Y=>{const $=Y.items,oe=Y.mandatory;if($.every(Q=>Y.checkedIndices.includes(Q))&&ee&&ne){S();const Q=new FormData;for(const V in O)if(O.hasOwnProperty(V)){const{img:se,img_id:we}=O[V];Q.append(`selectedImages[${V}][img]`,se),Q.append(`selectedImages[${V}][img_id]`,we)}Q.append("km_inicial",ee),Q.append("gas_inicial",ne),Q.append("id_route",_),fetch("https://rutaflow-app-development.up.railway.app/api/admin/checklist/add_evidence.php",{method:"POST",body:Q}).then(V=>V.json()).then(V=>{oe&&oe[0]=="1"?$e(_,"checklist-pending"):$e(_,"enroute")}).catch(V=>{console.error("Error fetching data:",V)})}else w();return Y})}J()},L=async(R,W)=>{const ne=R.target.files[0],Y=await H(ne);if(Y){const $=new FormData;$.append("fileToUpload",Y);try{const oe=await fetch("https://rutaflow-app-development.up.railway.app/api/admin/manager/upload_img_driver.php",{method:"POST",body:$});if(oe.ok){const fe=await oe.json();O={...O,[W]:{img:fe.img,img_id:fe.img_id}},t(11,B={...B,[W]:fe.filename}),M(W),t(6,m[W].checked=!0,m)}else console.error("File upload failed:",oe.statusText)}catch(oe){console.error("Error during file upload:",oe)}}},H=async R=>new Promise(W=>{const ee=new FileReader;ee.onload=ne=>{const Y=new Image;Y.src=ne.target.result,Y.onload=()=>{const $=document.createElement("canvas"),oe=$.getContext("2d"),fe=800,Q=600;let V=Y.width,se=Y.height;V>fe&&(se*=fe/V,V=fe),se>Q&&(V*=Q/se,se=Q),$.width=V,$.height=se,oe.drawImage(Y,0,0,V,se),$.toBlob(we=>{W(we)},"image/jpeg",.7)}},ee.readAsDataURL(R)}),M=R=>{Ye.update(W=>(W.checkedIndices.indexOf(R)===-1?W.checkedIndices.push(R):console.error(`ID ${R} is already checked.`),W.items.forEach(ne=>{ne.id_checklist_event===R&&(ne.checked=!0)}),W))};function q(R,W){return/^\d+$/.test(R)?parseInt(R,10):(U(W),null)}function C(R,W){F(W),o.componentProps.data_type=W,ze("modal-gas-km",an,{r:W}).then(()=>{Me.subscribe(ee=>{j(ee,W)})})}function F(R){Bt.update(W=>({...W,flag:[R]}))}function j(R,W){t(0,h=R.km_inicial?R.km_inicial:null),t(1,T=R.gas_inicial?R.gas_inicial:null),t(2,k=R.km_final?R.km_final:null),t(3,v=R.gas_final?R.gas_final:null),W=="km_inicial"&&t(7,d.checked=!0,d),W=="gas_inicial"&&t(8,f.checked=!0,f),W=="km_final"&&t(9,N.checked=!0,N),W=="gas_final"&&t(10,y.checked=!0,y)}function J(){Me.set({km_inicial:[],gas_inicial:[],km_final:[],gas_final:[]})}const X=[[]];function ce(){a=qe(X[0],this.__value,this.checked),t(4,a)}function _e(R){Ie[R?"unshift":"push"](()=>{N=R,t(9,N)})}const me=R=>C(R,"km_final");function ve(){a=qe(X[0],this.__value,this.checked),t(4,a)}function te(R){Ie[R?"unshift":"push"](()=>{y=R,t(10,y)})}const ae=R=>C(R,"gas_final");function be(){a=qe(X[0],this.__value,this.checked),t(4,a)}function Ee(R){Ie[R?"unshift":"push"](()=>{d=R,t(7,d)})}const re=R=>C(R,"km_inicial");function ye(R){Ie[R?"unshift":"push"](()=>{f=R,t(8,f)})}function Le(){a=qe(X[0],this.__value,this.checked),t(4,a)}const Te=R=>C(R,"gas_inicial");function ue(){a=qe(X[0],this.__value,this.checked),t(4,a)}function he(R,W){Ie[R?"unshift":"push"](()=>{m[W.id_checklist_event]=R,t(6,m)})}const de=R=>M(R.id_checklist_event);function Ce(R){Ie[R?"unshift":"push"](()=>{I=R,t(5,I)})}return[h,T,k,v,a,I,m,d,f,N,y,B,n,p,S,b,L,M,C,ce,X,_e,me,ve,te,ae,be,Ee,re,ye,Le,Te,ue,he,de,Ce,(R,W)=>L(W,R.id_checklist_event)]}class Mt extends je{constructor(e){super(),Ve(this,e,_n,fn,Fe,{},null,[-1,-1])}}function dn(l){let e,t,o,n,r,_="Domicilio 2",p,h,T=l[2].line2+"",k,v,a;return{c(){e=c("ion-item"),t=c("ion-icon"),o=A(),n=c("ion-label"),r=c("p"),r.textContent=_,p=A(),h=c("h2"),k=ie(T),v=A(),a=c("ion-icon"),this.h()},l(I){e=u(I,"ION-ITEM",{href:!0});var m=g(e);t=u(m,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(s),o=D(m),n=u(m,"ION-LABEL",{class:!0});var d=g(n);r=u(d,"P",{"data-svelte-h":!0}),Z(r)!=="svelte-1qy148r"&&(r.textContent=_),p=D(d),h=u(d,"H2",{});var f=g(h);k=le(f,T),f.forEach(s),d.forEach(s),v=D(m),a=u(m,"ION-ICON",{icon:!0,slot:!0}),g(a).forEach(s),m.forEach(s),this.h()},h(){E(t,"icon",rt),E(t,"slot","start"),E(n,"class","ion-text-wrap"),E(a,"icon",Re),E(a,"slot","end"),E(e,"href","https://www.google.com/maps/searhc/?api=1&query="+l[2].line2)},m(I,m){z(I,e,m),i(e,t),i(e,o),i(e,n),i(n,r),i(n,p),i(n,h),i(h,k),i(e,v),i(e,a)},p:Oe,d(I){I&&s(e)}}}function hn(l){let e,t,o,n,r,_="Domicilio 1",p,h,T=l[2].line1+"",k,v,a,I,m=l[2].line2&&l[2].line2.trim().length,d,f=m&&pn(l);return{c(){e=c("ion-item"),t=c("ion-icon"),o=A(),n=c("ion-label"),r=c("p"),r.textContent=_,p=A(),h=c("h2"),k=ie(T),v=A(),a=c("ion-icon"),I=A(),f&&f.c(),d=Ne(),this.h()},l(N){e=u(N,"ION-ITEM",{href:!0});var y=g(e);t=u(y,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(s),o=D(y),n=u(y,"ION-LABEL",{class:!0});var O=g(n);r=u(O,"P",{"data-svelte-h":!0}),Z(r)!=="svelte-1ehcrdm"&&(r.textContent=_),p=D(O),h=u(O,"H2",{});var B=g(h);k=le(B,T),B.forEach(s),O.forEach(s),v=D(y),a=u(y,"ION-ICON",{icon:!0,slot:!0}),g(a).forEach(s),y.forEach(s),I=D(N),f&&f.l(N),d=Ne(),this.h()},h(){E(t,"icon",rt),E(t,"slot","start"),E(n,"class","ion-text-wrap"),E(a,"icon",Re),E(a,"slot","end"),E(e,"href","https://www.google.com/maps/search/?api=1&query="+l[2].line1)},m(N,y){z(N,e,y),i(e,t),i(e,o),i(e,n),i(n,r),i(n,p),i(n,h),i(h,k),i(e,v),i(e,a),z(N,I,y),f&&f.m(N,y),z(N,d,y)},p(N,y){m&&f.p(N,y)},d(N){N&&(s(e),s(I),s(d)),f&&f.d(N)}}}function pn(l){let e,t,o,n,r,_="Domicilio 2",p,h,T=l[2].line2+"",k,v,a;return{c(){e=c("ion-item"),t=c("ion-icon"),o=A(),n=c("ion-label"),r=c("p"),r.textContent=_,p=A(),h=c("h2"),k=ie(T),v=A(),a=c("ion-icon"),this.h()},l(I){e=u(I,"ION-ITEM",{href:!0});var m=g(e);t=u(m,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(s),o=D(m),n=u(m,"ION-LABEL",{class:!0});var d=g(n);r=u(d,"P",{"data-svelte-h":!0}),Z(r)!=="svelte-1qy148r"&&(r.textContent=_),p=D(d),h=u(d,"H2",{});var f=g(h);k=le(f,T),f.forEach(s),d.forEach(s),v=D(m),a=u(m,"ION-ICON",{icon:!0,slot:!0}),g(a).forEach(s),m.forEach(s),this.h()},h(){E(t,"icon",rt),E(t,"slot","start"),E(n,"class","ion-text-wrap"),E(a,"icon",Re),E(a,"slot","end"),E(e,"href","https://www.google.com/maps/search/?api=1&query="+l[2].line2)},m(I,m){z(I,e,m),i(e,t),i(e,o),i(e,n),i(n,r),i(n,p),i(n,h),i(h,k),i(e,v),i(e,a)},p:Oe,d(I){I&&s(e)}}}function mn(l){let e,t=l[2].comments!="<br>"&&vn(l);return{c(){t&&t.c(),e=Ne()},l(o){t&&t.l(o),e=Ne()},m(o,n){t&&t.m(o,n),z(o,e,n)},p(o,n){o[2].comments!="<br>"&&t.p(o,n)},d(o){o&&s(e),t&&t.d(o)}}}function vn(l){let e,t,o,n,r,_="Notas de ubicación",p,h,T=l[2].comments+"",k;return{c(){e=c("ion-item"),t=c("ion-icon"),o=A(),n=c("ion-label"),r=c("p"),r.textContent=_,p=A(),h=c("h2"),k=ie(T),this.h()},l(v){e=u(v,"ION-ITEM",{});var a=g(e);t=u(a,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(s),o=D(a),n=u(a,"ION-LABEL",{class:!0});var I=g(n);r=u(I,"P",{"data-svelte-h":!0}),Z(r)!=="svelte-nhm2ft"&&(r.textContent=_),p=D(I),h=u(I,"H2",{});var m=g(h);k=le(m,T),m.forEach(s),I.forEach(s),a.forEach(s),this.h()},h(){E(t,"icon",Pt),E(t,"slot","start"),E(n,"class","ion-text-wrap")},m(v,a){z(v,e,a),i(e,t),i(e,o),i(e,n),i(n,r),i(n,p),i(n,h),i(h,k)},p:Oe,d(v){v&&s(e)}}}function gn(l){let e,t,o,n,r,_="Horarios",p,h,T=l[2].schedule+"",k;return{c(){e=c("ion-item"),t=c("ion-icon"),o=A(),n=c("ion-label"),r=c("p"),r.textContent=_,p=A(),h=c("h2"),k=ie(T),this.h()},l(v){e=u(v,"ION-ITEM",{});var a=g(e);t=u(a,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(s),o=D(a),n=u(a,"ION-LABEL",{});var I=g(n);r=u(I,"P",{"data-svelte-h":!0}),Z(r)!=="svelte-11q7hm5"&&(r.textContent=_),p=D(I),h=u(I,"H2",{});var m=g(h);k=le(m,T),m.forEach(s),I.forEach(s),a.forEach(s),this.h()},h(){E(t,"icon",Xt),E(t,"slot","start")},m(v,a){z(v,e,a),i(e,t),i(e,o),i(e,n),i(n,r),i(n,p),i(n,h),i(h,k)},p:Oe,d(v){v&&s(e)}}}function bn(l){let e,t,o,n,r,_="Notas del operador",p,h,T=l[2].driver_comments+"",k;return{c(){e=c("ion-item"),t=c("ion-icon"),o=A(),n=c("ion-label"),r=c("p"),r.textContent=_,p=A(),h=c("h2"),k=ie(T),this.h()},l(v){e=u(v,"ION-ITEM",{});var a=g(e);t=u(a,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(s),o=D(a),n=u(a,"ION-LABEL",{});var I=g(n);r=u(I,"P",{"data-svelte-h":!0}),Z(r)!=="svelte-1yk9qp4"&&(r.textContent=_),p=D(I),h=u(I,"H2",{});var m=g(h);k=le(m,T),m.forEach(s),I.forEach(s),a.forEach(s),this.h()},h(){E(t,"icon",St),E(t,"slot","start")},m(v,a){z(v,e,a),i(e,t),i(e,o),i(e,n),i(n,r),i(n,p),i(n,h),i(h,k)},p:Oe,d(v){v&&s(e)}}}function En(l){let e,t=l[2].logistic_comments!="<br>"&&In(l);return{c(){t&&t.c(),e=Ne()},l(o){t&&t.l(o),e=Ne()},m(o,n){t&&t.m(o,n),z(o,e,n)},p(o,n){o[2].logistic_comments!="<br>"&&t.p(o,n)},d(o){o&&s(e),t&&t.d(o)}}}function In(l){let e,t,o,n,r,_="Comentarios logísticos",p,h,T=l[2].logistic_comments+"",k;return{c(){e=c("ion-item"),t=c("ion-icon"),o=A(),n=c("ion-label"),r=c("p"),r.textContent=_,p=A(),h=c("h2"),k=ie(T),this.h()},l(v){e=u(v,"ION-ITEM",{});var a=g(e);t=u(a,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(s),o=D(a),n=u(a,"ION-LABEL",{class:!0});var I=g(n);r=u(I,"P",{"data-svelte-h":!0}),Z(r)!=="svelte-1iz85r6"&&(r.textContent=_),p=D(I),h=u(I,"H2",{});var m=g(h);k=le(m,T),m.forEach(s),I.forEach(s),a.forEach(s),this.h()},h(){E(t,"icon",Pt),E(t,"slot","start"),E(n,"class","ion-text-wrap")},m(v,a){z(v,e,a),i(e,t),i(e,o),i(e,n),i(n,r),i(n,p),i(n,h),i(h,k)},p:Oe,d(v){v&&s(e)}}}function gt(l){let e,t,o;return{c(){e=c("section"),t=c("ion-img"),this.h()},l(n){e=u(n,"SECTION",{});var r=g(e);t=u(r,"ION-IMG",{src:!0,alt:!0,style:!0}),g(t).forEach(s),r.forEach(s),this.h()},h(){Ze(t.src,o=l[1])||E(t,"src",o),E(t,"alt","Evidencia fotográfica"),K(t,"max-width","100%"),K(t,"margin-top","16px")},m(n,r){z(n,e,r),i(e,t)},p(n,r){r&2&&!Ze(t.src,o=n[1])&&E(t,"src",o)},d(n){n&&s(e)}}}function kn(l){let e,t,o,n,r="Cancelar",_,p,h=l[2].title+"",T,k,v,a,I="Confirmar",m,d,f,N,y,O,B,w,P="Cliente",U,S,b=l[2].client_name+"",L,H,M,q=l[2].comments&&l[2].comments.trim().length,C,F=l[2].schedule&&l[2].schedule.trim().length,j,J,X=l[2].logistic_comments&&l[2].logistic_comments.trim().length,ce,_e,me,ve,te,ae,be,Ee,re,ye,Le,Te,ue="Subir Evidencia",he,de,Ce,Pe,R;function W(V,se){if(V[2].line1&&V[2].line1.trim().length)return hn;if(V[2].line2&&V[2].line2.trim().length)return dn}let ee=W(l),ne=ee&&ee(l),Y=q&&mn(l),$=F&&gn(l),oe=l[2].driver_comments&&bn(l),fe=X&&En(l),Q=l[1]&&gt(l);return{c(){e=c("ion-header"),t=c("ion-toolbar"),o=c("ion-buttons"),n=c("ion-button"),n.textContent=r,_=A(),p=c("ion-title"),T=ie(h),k=A(),v=c("ion-buttons"),a=c("ion-button"),a.textContent=I,m=A(),d=c("ion-content"),f=c("ion-list"),N=c("ion-item"),y=c("ion-icon"),O=A(),B=c("ion-label"),w=c("p"),w.textContent=P,U=A(),S=c("h2"),L=ie(b),H=A(),ne&&ne.c(),M=A(),Y&&Y.c(),C=A(),$&&$.c(),j=A(),oe&&oe.c(),J=A(),fe&&fe.c(),ce=A(),_e=c("ion-item"),me=c("ion-icon"),ve=A(),te=c("ion-textarea"),ae=A(),be=c("section"),Ee=c("label"),re=c("ion-button"),ye=c("ion-icon"),Le=A(),Te=c("label"),Te.textContent=ue,he=A(),de=c("input"),Ce=A(),Q&&Q.c(),this.h()},l(V){e=u(V,"ION-HEADER",{translucent:!0});var se=g(e);t=u(se,"ION-TOOLBAR",{});var we=g(t);o=u(we,"ION-BUTTONS",{slot:!0});var st=g(o);n=u(st,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),Z(n)!=="svelte-1f8rjcf"&&(n.textContent=r),st.forEach(s),_=D(we),p=u(we,"ION-TITLE",{title:!0});var ct=g(p);T=le(ct,h),ct.forEach(s),k=D(we),v=u(we,"ION-BUTTONS",{slot:!0});var ut=g(v);a=u(ut,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),Z(a)!=="svelte-1ida0il"&&(a.textContent=I),ut.forEach(s),we.forEach(s),se.forEach(s),m=D(V),d=u(V,"ION-CONTENT",{fullscreen:!0});var ft=g(d);f=u(ft,"ION-LIST",{});var pe=g(f);N=u(pe,"ION-ITEM",{});var Ke=g(N);y=u(Ke,"ION-ICON",{icon:!0,slot:!0}),g(y).forEach(s),O=D(Ke),B=u(Ke,"ION-LABEL",{});var Ge=g(B);w=u(Ge,"P",{"data-svelte-h":!0}),Z(w)!=="svelte-jrq7ei"&&(w.textContent=P),U=D(Ge),S=u(Ge,"H2",{});var _t=g(S);L=le(_t,b),_t.forEach(s),Ge.forEach(s),Ke.forEach(s),H=D(pe),ne&&ne.l(pe),M=D(pe),Y&&Y.l(pe),C=D(pe),$&&$.l(pe),j=D(pe),oe&&oe.l(pe),J=D(pe),fe&&fe.l(pe),ce=D(pe),_e=u(pe,"ION-ITEM",{});var We=g(_e);me=u(We,"ION-ICON",{icon:!0,slot:!0}),g(me).forEach(s),ve=D(We),te=u(We,"ION-TEXTAREA",{label:!0,placeholder:!0}),g(te).forEach(s),We.forEach(s),ae=D(pe),be=u(pe,"SECTION",{});var dt=g(be);Ee=u(dt,"LABEL",{for:!0,style:!0});var ht=g(Ee);re=u(ht,"ION-BUTTON",{fill:!0,class:!0,expand:!0});var Be=g(re);ye=u(Be,"ION-ICON",{icon:!0,slot:!0}),g(ye).forEach(s),Le=D(Be),Te=u(Be,"LABEL",{for:!0,style:!0,"data-svelte-h":!0}),Z(Te)!=="svelte-1as0od8"&&(Te.textContent=ue),he=D(Be),de=u(Be,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0}),Be.forEach(s),ht.forEach(s),dt.forEach(s),Ce=D(pe),Q&&Q.l(pe),pe.forEach(s),ft.forEach(s),this.h()},h(){E(n,"color","medium"),E(o,"slot","start"),E(p,"title",l[2].title),E(a,"strong",""),E(v,"slot","end"),E(e,"translucent",""),E(y,"icon",Wt),E(y,"slot","start"),E(me,"icon",tt),E(me,"slot","start"),E(te,"label","Notas"),E(te,"placeholder","Escribe aquí..."),E(ye,"icon",Dt),E(ye,"slot","start"),G(Te,"for","eventEvidence"),K(Te,"padding","8px 10px"),K(de,"display","none"),G(de,"id","eventEvidence"),G(de,"name","fileToUpload"),G(de,"type","file"),G(de,"accept","image/*"),E(re,"fill","outline"),E(re,"class","loadEvidence"),E(re,"expand","block"),G(Ee,"for","eventEvidence"),K(Ee,"display","block"),K(Ee,"width","100%"),E(d,"fullscreen","")},m(V,se){z(V,e,se),i(e,t),i(t,o),i(o,n),i(t,_),i(t,p),i(p,T),i(t,k),i(t,v),i(v,a),z(V,m,se),z(V,d,se),i(d,f),i(f,N),i(N,y),i(N,O),i(N,B),i(B,w),i(B,U),i(B,S),i(S,L),i(f,H),ne&&ne.m(f,null),i(f,M),Y&&Y.m(f,null),i(f,C),$&&$.m(f,null),i(f,j),oe&&oe.m(f,null),i(f,J),fe&&fe.m(f,null),i(f,ce),i(f,_e),i(_e,me),i(_e,ve),i(_e,te),l[6](te),i(f,ae),i(f,be),i(be,Ee),i(Ee,re),i(re,ye),i(re,Le),i(re,Te),i(re,he),i(re,de),i(f,Ce),Q&&Q.m(f,null),Pe||(R=[x(n,"click",l[4]),x(a,"click",l[5]),x(de,"change",l[3])],Pe=!0)},p(V,[se]){ne&&ne.p(V,se),q&&Y.p(V,se),F&&$.p(V,se),V[2].driver_comments&&oe.p(V,se),X&&fe.p(V,se),V[1]?Q?Q.p(V,se):(Q=gt(V),Q.c(),Q.m(f,null)):Q&&(Q.d(1),Q=null)},i:Oe,o:Oe,d(V){V&&(s(e),s(m),s(d)),ne&&ne.d(),Y&&Y.d(),$&&$.d(),oe&&oe.d(),fe&&fe.d(),l[6](null),Q&&Q.d(),Pe=!1,De(R)}}}function On(l,e,t){let o=document.querySelector("ion-modal"),n=o.componentProps.delivery,r=o.componentProps.isLast,_=n.driver_comments?n.driver_comments:"",p=n.img?n.img:"",h="",T={latitude:null,longitude:null};const k=async N=>{const O=N.target.files[0],B=await v(O);if(B){const w=new FormData;w.append("fileToUpload",B);try{const P=await fetch("https://rutaflow-app-development.up.railway.app/api/admin/manager/upload_img_driver.php",{method:"POST",body:w});if(P.ok){const U=await P.json();t(1,p=U.img),h=U.img_id}else console.error("File upload failed:",P.statusText)}catch(P){console.error("Error during file upload:",P)}}},v=async N=>new Promise(y=>{const O=new FileReader;O.onload=B=>{const w=new Image;w.src=B.target.result,w.onload=()=>{const P=document.createElement("canvas"),U=P.getContext("2d"),S=800,b=600;let L=w.width,H=w.height;L>S&&(H*=S/L,L=S),H>b&&(L*=b/H,H=b),P.width=L,P.height=H,U.drawImage(w,0,0,L,H),P.toBlob(M=>{y(M)},"image/jpeg",.7)}},O.readAsDataURL(N)}),a=()=>{o.dismiss({data:Date.now()})},I=async()=>{try{const N=await d();if(console.log(N),N){const y={id_route:n.id_route,id_event:n.id_event,comments:_.value,img:p,img_id:h,lat:T.latitude,lon:T.longitude},O=new FormData;for(const S in y)O.append(S,y[S]);console.log(O);const w=await(await fetch("https://rutaflow-app-development.up.railway.app/api/admin/evidence/send_evidence.php",{method:"POST",body:O})).json();a();const P={},U=y.id_route;r&&m("","",U,r)}else console.log("No entré")}catch(N){console.error("Error fetching data:",N)}},m=(N,y,O,B)=>{o.componentProps.routeId=O,o.componentProps.driverId=n.id_driver,ze("modal-km-gas",Mt,{checklist:N,driverId:y,routeId:O,isLast:B}).then(w=>{})},d=async()=>navigator.geolocation?new Promise((N,y)=>{navigator.geolocation.getCurrentPosition(O=>{T.latitude=O.coords.latitude,T.longitude=O.coords.longitude,N(!0)},O=>{console.error("Error getting location:",O),N(!1)})}):(console.error("Geolocation is not supported by your browser"),!1);function f(N){Ie[N?"unshift":"push"](()=>{_=N,t(0,_)})}return[_,p,n,k,a,I,f]}class Nn extends je{constructor(e){super(),Ve(this,e,On,kn,Fe,{})}}function bt(l){let e,t,o;return{c(){e=c("section"),t=c("ion-img"),this.h()},l(n){e=u(n,"SECTION",{});var r=g(e);t=u(r,"ION-IMG",{src:!0,alt:!0,style:!0}),g(t).forEach(s),r.forEach(s),this.h()},h(){Ze(t.src,o=l[0])||E(t,"src",o),E(t,"alt","Evidencia fotográfica"),K(t,"max-width","100%"),K(t,"margin-top","16px")},m(n,r){z(n,e,r),i(e,t)},p(n,r){r&1&&!Ze(t.src,o=n[0])&&E(t,"src",o)},d(n){n&&s(e)}}}function Tn(l){let e,t,o,n,r="Cancelar",_,p,h="Agregar Gasto",T,k,v,a="Confirmar",I,m,d,f,N,y,O,B,w,P,U,S,b,L,H,M,q,C='<div slot="label">Tipo de pago <ion-text color="danger">(Obligatorio)</ion-text></div> <ion-select-option value="cash">Efectivo</ion-select-option> <ion-select-option value="cash">Tarjeta</ion-select-option> <ion-select-option value="transfer">Transferencia</ion-select-option>',F,j,J,X,ce,_e,me,ve,te,ae,be=`<ion-icon icon="${Dt}" slot="start"></ion-icon>
                        Subir Evidencia`,Ee,re,ye,Le,Te,ue=l[0]&&bt(l);return{c(){e=c("ion-header"),t=c("ion-toolbar"),o=c("ion-buttons"),n=c("ion-button"),n.textContent=r,_=A(),p=c("ion-title"),p.textContent=h,T=A(),k=c("ion-buttons"),v=c("ion-button"),v.textContent=a,I=A(),m=c("ion-content"),d=c("ion-list"),f=c("ion-item"),N=c("ion-icon"),y=A(),O=c("ion-input"),B=A(),w=c("ion-item"),P=c("ion-icon"),U=A(),S=c("ion-input"),b=A(),L=c("ion-item"),H=c("ion-icon"),M=A(),q=c("ion-select"),q.innerHTML=C,F=A(),j=c("ion-item"),J=c("ion-icon"),X=A(),ce=c("ion-textarea"),_e=A(),me=c("section"),ve=c("label"),te=c("ion-button"),ae=c("label"),ae.innerHTML=be,Ee=A(),re=c("input"),ye=A(),ue&&ue.c(),this.h()},l(he){e=u(he,"ION-HEADER",{translucent:!0});var de=g(e);t=u(de,"ION-TOOLBAR",{});var Ce=g(t);o=u(Ce,"ION-BUTTONS",{slot:!0});var Pe=g(o);n=u(Pe,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),Z(n)!=="svelte-1f8rjcf"&&(n.textContent=r),Pe.forEach(s),_=D(Ce),p=u(Ce,"ION-TITLE",{title:!0,"data-svelte-h":!0}),Z(p)!=="svelte-10xvxus"&&(p.textContent=h),T=D(Ce),k=u(Ce,"ION-BUTTONS",{slot:!0});var R=g(k);v=u(R,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),Z(v)!=="svelte-k5zoz0"&&(v.textContent=a),R.forEach(s),Ce.forEach(s),de.forEach(s),I=D(he),m=u(he,"ION-CONTENT",{fullscreen:!0});var W=g(m);d=u(W,"ION-LIST",{});var ee=g(d);f=u(ee,"ION-ITEM",{});var ne=g(f);N=u(ne,"ION-ICON",{icon:!0,slot:!0}),g(N).forEach(s),y=D(ne),O=u(ne,"ION-INPUT",{label:!0,type:!0,placeholder:!0}),g(O).forEach(s),ne.forEach(s),B=D(ee),w=u(ee,"ION-ITEM",{});var Y=g(w);P=u(Y,"ION-ICON",{icon:!0,slot:!0}),g(P).forEach(s),U=D(Y),S=u(Y,"ION-INPUT",{label:!0,type:!0}),g(S).forEach(s),Y.forEach(s),b=D(ee),L=u(ee,"ION-ITEM",{});var $=g(L);H=u($,"ION-ICON",{icon:!0,slot:!0}),g(H).forEach(s),M=D($),q=u($,"ION-SELECT",{placeholder:!0,"data-svelte-h":!0}),Z(q)!=="svelte-1y2o04l"&&(q.innerHTML=C),$.forEach(s),F=D(ee),j=u(ee,"ION-ITEM",{});var oe=g(j);J=u(oe,"ION-ICON",{icon:!0,slot:!0}),g(J).forEach(s),X=D(oe),ce=u(oe,"ION-TEXTAREA",{label:!0,placeholder:!0}),g(ce).forEach(s),oe.forEach(s),_e=D(ee),me=u(ee,"SECTION",{});var fe=g(me);ve=u(fe,"LABEL",{for:!0,style:!0});var Q=g(ve);te=u(Q,"ION-BUTTON",{fill:!0,size:!0,class:!0,expand:!0});var V=g(te);ae=u(V,"LABEL",{for:!0,style:!0,"data-svelte-h":!0}),Z(ae)!=="svelte-1m9yw22"&&(ae.innerHTML=be),Ee=D(V),re=u(V,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0}),V.forEach(s),Q.forEach(s),fe.forEach(s),ye=D(ee),ue&&ue.l(ee),ee.forEach(s),W.forEach(s),this.h()},h(){E(n,"color","medium"),E(o,"slot","start"),E(p,"title",""),E(v,"strong",""),E(k,"slot","end"),E(e,"translucent",""),E(N,"icon",St),E(N,"slot","start"),E(O,"label","Concepto"),E(O,"type","text"),E(O,"placeholder","Escribe aquí..."),E(P,"icon",tt),E(P,"slot","start"),E(S,"label","Cantidad"),E(S,"type","number"),E(H,"icon",Jt),E(H,"slot","start"),E(q,"placeholder","Tipo de pago"),E(J,"icon",tt),E(J,"slot","start"),E(ce,"label","Comentarios"),E(ce,"placeholder","Escribe aquí..."),G(ae,"for","eventEvidence"),K(ae,"width","100%"),K(ae,"padding","8px"),K(re,"display","none"),G(re,"id","eventEvidence"),G(re,"name","fileToUpload"),G(re,"type","file"),G(re,"accept","image/*"),E(te,"fill","outline"),E(te,"size","small"),E(te,"class","loadEvidence"),E(te,"expand","block"),G(ve,"for","eventEvidence"),K(ve,"display","block"),K(ve,"width","100%"),E(m,"fullscreen","")},m(he,de){z(he,e,de),i(e,t),i(t,o),i(o,n),i(t,_),i(t,p),i(t,T),i(t,k),i(k,v),z(he,I,de),z(he,m,de),i(m,d),i(d,f),i(f,N),i(f,y),i(f,O),l[8](O),i(d,B),i(d,w),i(w,P),i(w,U),i(w,S),l[9](S),i(d,b),i(d,L),i(L,H),i(L,M),i(L,q),l[10](q),i(d,F),i(d,j),i(j,J),i(j,X),i(j,ce),l[11](ce),i(d,_e),i(d,me),i(me,ve),i(ve,te),i(te,ae),i(te,Ee),i(te,re),i(d,ye),ue&&ue.m(d,null),Le||(Te=[x(n,"click",l[6]),x(v,"click",l[7]),x(re,"change",l[5])],Le=!0)},p(he,[de]){he[0]?ue?ue.p(he,de):(ue=bt(he),ue.c(),ue.m(d,null)):ue&&(ue.d(1),ue=null)},i:Oe,o:Oe,d(he){he&&(s(e),s(I),s(m)),l[8](null),l[9](null),l[10](null),l[11](null),ue&&ue.d(),Le=!1,De(Te)}}}function yn(l,e,t){let o=document.querySelector("ion-modal");o.componentProps.routeName;let n=o.componentProps.routeId,r="",_="",p="",h=0,T="",k="";const v=async O=>{const w=O.target.files[0],P=await a(w);if(P){const U=new FormData;U.append("fileToUpload",P);try{const S=await fetch("https://rutaflow-app-development.up.railway.app/api/admin/manager/upload_img_driver.php",{method:"POST",body:U});if(S.ok){const b=await S.json();t(0,r=b.img),_=b.img_id}else console.error("File upload failed:",S.statusText)}catch(S){console.error("Error during file upload:",S)}}},a=async O=>new Promise(B=>{const w=new FileReader;w.onload=P=>{const U=new Image;U.src=P.target.result,U.onload=()=>{const S=document.createElement("canvas"),b=S.getContext("2d"),L=800,H=600;let M=U.width,q=U.height;M>L&&(q*=L/M,M=L),q>H&&(M*=H/q,q=H),S.width=M,S.height=q,b.drawImage(U,0,0,M,q),S.toBlob(C=>{B(C)},"image/jpeg",.7)}},w.readAsDataURL(O)}),I=()=>{o.dismiss({data:Date.now()})},m=()=>{var O=new Object;O.id_route=n,O.comments=T.value,O.type=p.value,O.img=r,O.img_id=_,O.amount=h.value,O.concept=k.value;const B=new FormData;for(const w in O)B.append(w,O[w]);console.log(B),fetch("https://rutaflow-app-development.up.railway.app/api/admin/expenses/add_expense.php",{method:"POST",body:B}).then(w=>w.json()).then(w=>{I()}).catch(w=>{console.error("Error fetching data:",w)})};function d(O){Ie[O?"unshift":"push"](()=>{k=O,t(4,k)})}function f(O){Ie[O?"unshift":"push"](()=>{h=O,t(2,h)})}function N(O){Ie[O?"unshift":"push"](()=>{p=O,t(1,p)})}function y(O){Ie[O?"unshift":"push"](()=>{T=O,t(3,T)})}return[r,p,h,T,k,v,I,m,d,f,N,y]}class Cn extends je{constructor(e){super(),Ve(this,e,yn,Tn,Fe,{})}}function Et(l,e,t){const o=l.slice();return o[29]=e[t],o}function It(l,e,t){const o=l.slice();return o[29]=e[t],o[31]=t,o}function kt(l,e,t){const o=l.slice();return o[29]=e[t],o[31]=t,o}function Ot(l){let e,t;return e=new xt({props:{$$slots:{default:[Pn]},$$scope:{ctx:l}}}),{c(){Ft(e.$$.fragment)},l(o){jt(e.$$.fragment,o)},m(o,n){Vt(e,o,n),t=!0},p(o,n){const r={};n[0]&255|n[1]&16&&(r.$$scope={dirty:n,ctx:o}),e.$set(r)},i(o){t||(Xe(e.$$.fragment,o),t=!0)},o(o){et(e.$$.fragment,o),t=!1},d(o){Kt(e,o)}}}function wn(l){let e=l[7].mandatory&&Array.isArray(l[7].mandatory)&&l[7].mandatory[0]==="0",t,o,n,r='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Jala para actualizar" refreshing-spinner="circles" refreshing-text="Actualizando..."></ion-refresher-content>',_,p,h=[],T=new Map,k,v,a=e&&Nt(l),I=Ae(l[3]);const m=d=>d[29].id_event;for(let d=0;d<I.length;d+=1){let f=Et(l,I,d),N=m(f);T.set(N,h[d]=yt(N,f))}return{c(){a&&a.c(),t=A(),o=c("ion-content"),n=c("ion-refresher"),n.innerHTML=r,_=A(),p=c("ion-list");for(let d=0;d<h.length;d+=1)h[d].c();this.h()},l(d){a&&a.l(d),t=D(d),o=u(d,"ION-CONTENT",{});var f=g(o);n=u(f,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),Z(n)!=="svelte-1jkndk3"&&(n.innerHTML=r),_=D(f),p=u(f,"ION-LIST",{});var N=g(p);for(let y=0;y<h.length;y+=1)h[y].l(N);N.forEach(s),f.forEach(s),this.h()},h(){E(n,"slot","fixed")},m(d,f){a&&a.m(d,f),z(d,t,f),z(d,o,f),i(o,n),l[22](n),i(o,_),i(o,p);for(let N=0;N<h.length;N+=1)h[N]&&h[N].m(p,null);k||(v=x(n,"ionRefresh",l[8]),k=!0)},p(d,f){f[0]&128&&(e=d[7].mandatory&&Array.isArray(d[7].mandatory)&&d[7].mandatory[0]==="0"),e?a?a.p(d,f):(a=Nt(d),a.c(),a.m(t.parentNode,t)):a&&(a.d(1),a=null),f[0]&21e3&&(I=Ae(d[3]),h=Qe(h,f,m,1,d,I,T,p,xe,yt,null,Et))},d(d){d&&(s(t),s(o)),a&&a.d(d),l[22](null);for(let f=0;f<h.length;f+=1)h[f].d();k=!1,v()}}}function Ln(l){let e,t;function o(_,p){return p[0]&32&&(e=null),e==null&&(e=!!_[5].every(Bn)),e?Dn:An}let n=o(l,[-1,-1]),r=n(l);return{c(){r.c(),t=Ne()},l(_){r.l(_),t=Ne()},m(_,p){r.m(_,p),z(_,t,p)},p(_,p){n===(n=o(_,p))&&r?r.p(_,p):(r.d(1),r=n(_),r&&(r.c(),r.m(t.parentNode,t)))},d(_){_&&s(t),r.d(_)}}}function Nt(l){let e=ot(l[0],"enroute")+"",t;return{c(){t=ie(e)},l(o){t=le(o,e)},m(o,n){z(o,t,n)},p(o,n){n[0]&1&&e!==(e=ot(o[0],"enroute")+"")&&ge(t,e)},d(o){o&&s(t)}}}function Tt(l){let e;return{c(){e=c("span"),this.h()},l(t){e=u(t,"SPAN",{class:!0}),g(e).forEach(s),this.h()},h(){G(e,"class","notes svelte-ziybgw")},m(t,o){z(t,e,o)},d(t){t&&s(e)}}}function yt(l,e){let t,o,n,r,_=parseInt(e[29].pos)+1+"",p,h,T,k,v,a,I=e[29].title+"",m,d,f=e[29].support_list&&e[29].support_list.length||e[12](e[29]),N,y,O,B,w,P=f&&Tt();function U(){return e[23](e[29])}return{key:l,first:null,c(){t=c("ion-item"),o=c("ion-avatar"),n=c("div"),r=c("div"),p=ie(_),T=A(),k=c("ion-label"),v=c("ion-text"),a=c("h3"),m=ie(I),d=A(),P&&P.c(),N=A(),y=c("ion-icon"),O=A(),this.h()},l(S){t=u(S,"ION-ITEM",{});var b=g(t);o=u(b,"ION-AVATAR",{slot:!0});var L=g(o);n=u(L,"DIV",{class:!0,title:!0,style:!0});var H=g(n);r=u(H,"DIV",{class:!0});var M=g(r);p=le(M,_),M.forEach(s),H.forEach(s),L.forEach(s),T=D(b),k=u(b,"ION-LABEL",{button:!0});var q=g(k);v=u(q,"ION-TEXT",{color:!0});var C=g(v);a=u(C,"H3",{});var F=g(a);m=le(F,I),d=D(F),P&&P.l(F),F.forEach(s),C.forEach(s),q.forEach(s),N=D(b),y=u(b,"ION-ICON",{icon:!0,slot:!0,style:!0}),g(y).forEach(s),O=D(b),b.forEach(s),this.h()},h(){G(r,"class","order svelte-ziybgw"),G(n,"class","order-wrapper svelte-ziybgw"),G(n,"title",h=Ue(e[29].status)),K(n,"background-color",ke(e[29])),K(n,"color",He(ke(e[29]))),E(o,"slot","start"),E(v,"color","#2e2e2e"),E(k,"button",""),E(y,"icon",Re),E(y,"slot","end"),K(y,"color",ke(e[29])),this.first=t},m(S,b){z(S,t,b),i(t,o),i(o,n),i(n,r),i(r,p),i(t,T),i(t,k),i(k,v),i(v,a),i(a,m),i(a,d),P&&P.m(a,null),i(t,N),i(t,y),i(t,O),B||(w=x(k,"click",U),B=!0)},p(S,b){e=S,b[0]&8&&_!==(_=parseInt(e[29].pos)+1+"")&&ge(p,_),b[0]&8&&h!==(h=Ue(e[29].status))&&G(n,"title",h),b[0]&8&&K(n,"background-color",ke(e[29])),b[0]&8&&K(n,"color",He(ke(e[29]))),b[0]&8&&I!==(I=e[29].title+"")&&ge(m,I),b[0]&8&&(f=e[29].support_list&&e[29].support_list.length||e[12](e[29])),f?P||(P=Tt(),P.c(),P.m(a,null)):P&&(P.d(1),P=null),b[0]&8&&K(y,"color",ke(e[29]))},d(S){S&&s(t),P&&P.d(),B=!1,w()}}}function An(l){let e=l[10](l[5],l[1],l[0])+"",t,o,n,r,_='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Pull to refresh" refreshing-spinner="circles" refreshing-text="Refreshing..."></ion-refresher-content>',p,h,T=[],k=new Map,v,a,I=Ae(l[3]);const m=d=>d[29].id_event;for(let d=0;d<I.length;d+=1){let f=It(l,I,d),N=m(f);k.set(N,T[d]=wt(N,f))}return{c(){t=ie(e),o=A(),n=c("ion-content"),r=c("ion-refresher"),r.innerHTML=_,p=A(),h=c("ion-list");for(let d=0;d<T.length;d+=1)T[d].c();this.h()},l(d){t=le(d,e),o=D(d),n=u(d,"ION-CONTENT",{});var f=g(n);r=u(f,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),Z(r)!=="svelte-1poui8g"&&(r.innerHTML=_),p=D(f),h=u(f,"ION-LIST",{});var N=g(h);for(let y=0;y<T.length;y+=1)T[y].l(N);N.forEach(s),f.forEach(s),this.h()},h(){E(r,"slot","fixed")},m(d,f){z(d,t,f),z(d,o,f),z(d,n,f),i(n,r),l[20](r),i(n,p),i(n,h);for(let N=0;N<T.length;N+=1)T[N]&&T[N].m(h,null);v||(a=x(r,"ionRefresh",l[8]),v=!0)},p(d,f){f[0]&35&&e!==(e=d[10](d[5],d[1],d[0])+"")&&ge(t,e),f[0]&37384&&(I=Ae(d[3]),T=Qe(T,f,m,1,d,I,k,h,xe,wt,null,It))},d(d){d&&(s(t),s(o),s(n)),l[20](null);for(let f=0;f<T.length;f+=1)T[f].d();v=!1,a()}}}function Dn(l){let e,t,o='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Pull to refresh" refreshing-spinner="circles" refreshing-text="Refreshing..."></ion-refresher-content>',n,r,_=[],p=new Map,h,T,k=Ae(l[3]);const v=a=>a[29].id_event;for(let a=0;a<k.length;a+=1){let I=kt(l,k,a),m=v(I);p.set(m,_[a]=At(m,I))}return{c(){e=c("ion-content"),t=c("ion-refresher"),t.innerHTML=o,n=A(),r=c("ion-list");for(let a=0;a<_.length;a+=1)_[a].c();this.h()},l(a){e=u(a,"ION-CONTENT",{});var I=g(e);t=u(I,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),Z(t)!=="svelte-1poui8g"&&(t.innerHTML=o),n=D(I),r=u(I,"ION-LIST",{});var m=g(r);for(let d=0;d<_.length;d+=1)_[d].l(m);m.forEach(s),I.forEach(s),this.h()},h(){E(t,"slot","fixed")},m(a,I){z(a,e,I),i(e,t),l[18](t),i(e,n),i(e,r);for(let m=0;m<_.length;m+=1)_[m]&&_[m].m(r,null);h||(T=x(t,"ionRefresh",l[8]),h=!0)},p(a,I){I[0]&37384&&(k=Ae(a[3]),_=Qe(_,I,v,1,a,k,p,r,xe,At,null,kt))},d(a){a&&s(e),l[18](null);for(let I=0;I<_.length;I+=1)_[I].d();h=!1,T()}}}function Ct(l){let e;return{c(){e=c("span"),this.h()},l(t){e=u(t,"SPAN",{class:!0}),g(e).forEach(s),this.h()},h(){G(e,"class","notes svelte-ziybgw")},m(t,o){z(t,e,o)},d(t){t&&s(e)}}}function wt(l,e){let t,o,n,r,_=parseInt(e[29].pos)+1+"",p,h,T,k,v,a,I=e[29].title+"",m,d,f=e[29].support_list&&e[29].support_list.length||e[12](e[29]),N,y,O="",B,w,P,U,S,b=f&&Ct();function L(){return e[21](e[29],e[31])}return{key:l,first:null,c(){t=c("ion-item"),o=c("ion-avatar"),n=c("div"),r=c("div"),p=ie(_),T=A(),k=c("ion-label"),v=c("ion-text"),a=c("h3"),m=ie(I),d=A(),b&&b.c(),N=A(),y=c("div"),y.innerHTML=O,B=A(),w=c("ion-icon"),P=A(),this.h()},l(H){t=u(H,"ION-ITEM",{});var M=g(t);o=u(M,"ION-AVATAR",{slot:!0});var q=g(o);n=u(q,"DIV",{class:!0,title:!0,style:!0});var C=g(n);r=u(C,"DIV",{class:!0});var F=g(r);p=le(F,_),F.forEach(s),C.forEach(s),q.forEach(s),T=D(M),k=u(M,"ION-LABEL",{button:!0});var j=g(k);v=u(j,"ION-TEXT",{color:!0});var J=g(v);a=u(J,"H3",{});var X=g(a);m=le(X,I),d=D(X),b&&b.l(X),X.forEach(s),J.forEach(s),N=D(j),y=u(j,"DIV",{class:!0,"data-svelte-h":!0}),Z(y)!=="svelte-130ohbs"&&(y.innerHTML=O),j.forEach(s),B=D(M),w=u(M,"ION-ICON",{icon:!0,slot:!0}),g(w).forEach(s),P=D(M),M.forEach(s),this.h()},h(){G(r,"class","order svelte-ziybgw"),G(n,"class","order-wrapper svelte-ziybgw"),G(n,"title",h=Ue(e[29].status)),K(n,"background-color",ke(e[29])),K(n,"color",He(ke(e[29]))),E(o,"slot","start"),E(v,"color","#2e2e2e"),G(y,"class","sub svelte-ziybgw"),E(k,"button",""),E(w,"icon",Re),E(w,"slot","end"),this.first=t},m(H,M){z(H,t,M),i(t,o),i(o,n),i(n,r),i(r,p),i(t,T),i(t,k),i(k,v),i(v,a),i(a,m),i(a,d),b&&b.m(a,null),i(k,N),i(k,y),i(t,B),i(t,w),i(t,P),U||(S=x(k,"click",L),U=!0)},p(H,M){e=H,M[0]&8&&_!==(_=parseInt(e[29].pos)+1+"")&&ge(p,_),M[0]&8&&h!==(h=Ue(e[29].status))&&G(n,"title",h),M[0]&8&&K(n,"background-color",ke(e[29])),M[0]&8&&K(n,"color",He(ke(e[29]))),M[0]&8&&I!==(I=e[29].title+"")&&ge(m,I),M[0]&8&&(f=e[29].support_list&&e[29].support_list.length||e[12](e[29])),f?b||(b=Ct(),b.c(),b.m(a,null)):b&&(b.d(1),b=null)},d(H){H&&s(t),b&&b.d(),U=!1,S()}}}function Lt(l){let e;return{c(){e=c("span"),this.h()},l(t){e=u(t,"SPAN",{class:!0}),g(e).forEach(s),this.h()},h(){G(e,"class","notes svelte-ziybgw")},m(t,o){z(t,e,o)},d(t){t&&s(e)}}}function At(l,e){let t,o,n,r,_=parseInt(e[29].pos)+1+"",p,h,T,k,v,a,I=e[29].title+"",m,d,f=e[29].support_list&&e[29].support_list.length||e[12](e[29]),N,y,O="",B,w,P,U,S,b=f&&Lt();function L(){return e[19](e[29],e[31])}return{key:l,first:null,c(){t=c("ion-item"),o=c("ion-avatar"),n=c("div"),r=c("div"),p=ie(_),T=A(),k=c("ion-label"),v=c("ion-text"),a=c("h3"),m=ie(I),d=A(),b&&b.c(),N=A(),y=c("div"),y.innerHTML=O,B=A(),w=c("ion-icon"),P=A(),this.h()},l(H){t=u(H,"ION-ITEM",{});var M=g(t);o=u(M,"ION-AVATAR",{slot:!0});var q=g(o);n=u(q,"DIV",{class:!0,title:!0,style:!0});var C=g(n);r=u(C,"DIV",{class:!0});var F=g(r);p=le(F,_),F.forEach(s),C.forEach(s),q.forEach(s),T=D(M),k=u(M,"ION-LABEL",{button:!0});var j=g(k);v=u(j,"ION-TEXT",{color:!0});var J=g(v);a=u(J,"H3",{});var X=g(a);m=le(X,I),d=D(X),b&&b.l(X),X.forEach(s),J.forEach(s),N=D(j),y=u(j,"DIV",{class:!0,"data-svelte-h":!0}),Z(y)!=="svelte-130ohbs"&&(y.innerHTML=O),j.forEach(s),B=D(M),w=u(M,"ION-ICON",{icon:!0,slot:!0}),g(w).forEach(s),P=D(M),M.forEach(s),this.h()},h(){G(r,"class","order svelte-ziybgw"),G(n,"class","order-wrapper svelte-ziybgw"),G(n,"title",h=Ue(e[29].status)),K(n,"background-color",ke(e[29])),K(n,"color",He(ke(e[29]))),E(o,"slot","start"),E(v,"color","#2e2e2e"),G(y,"class","sub svelte-ziybgw"),E(k,"button",""),E(w,"icon",Re),E(w,"slot","end"),this.first=t},m(H,M){z(H,t,M),i(t,o),i(o,n),i(n,r),i(r,p),i(t,T),i(t,k),i(k,v),i(v,a),i(a,m),i(a,d),b&&b.m(a,null),i(k,N),i(k,y),i(t,B),i(t,w),i(t,P),U||(S=x(k,"click",L),U=!0)},p(H,M){e=H,M[0]&8&&_!==(_=parseInt(e[29].pos)+1+"")&&ge(p,_),M[0]&8&&h!==(h=Ue(e[29].status))&&G(n,"title",h),M[0]&8&&K(n,"background-color",ke(e[29])),M[0]&8&&K(n,"color",He(ke(e[29]))),M[0]&8&&I!==(I=e[29].title+"")&&ge(m,I),M[0]&8&&(f=e[29].support_list&&e[29].support_list.length||e[12](e[29])),f?b||(b=Lt(),b.c(),b.m(a,null)):b&&(b.d(1),b=null)},d(H){H&&s(t),b&&b.d(),U=!1,S()}}}function Pn(l){let e,t,o,n,r=`<ion-icon icon="${Yt}"></ion-icon>`,_,p,h,T=`<ion-icon icon="${Zt}"></ion-icon>`,k,v,a=l[2].name+"",I,m,d,f=l[4].name+"",N,y,O,B,w;function P(b,L){return b[5].length>0?Ln:wn}let U=P(l),S=U(l);return{c(){e=c("ion-header"),t=c("ion-toolbar"),o=c("ion-buttons"),n=c("ion-button"),n.innerHTML=r,_=A(),p=c("ion-buttons"),h=c("ion-button"),h.innerHTML=T,k=A(),v=c("ion-button"),I=ie(a),m=A(),d=c("ion-title"),N=ie(f),y=A(),S.c(),O=Ne(),this.h()},l(b){e=u(b,"ION-HEADER",{translucent:!0});var L=g(e);t=u(L,"ION-TOOLBAR",{});var H=g(t);o=u(H,"ION-BUTTONS",{slot:!0});var M=g(o);n=u(M,"ION-BUTTON",{title:!0,alt:!0,"data-svelte-h":!0}),Z(n)!=="svelte-7ppz3r"&&(n.innerHTML=r),M.forEach(s),_=D(H),p=u(H,"ION-BUTTONS",{slot:!0});var q=g(p);h=u(q,"ION-BUTTON",{"data-svelte-h":!0}),Z(h)!=="svelte-1mwna5t"&&(h.innerHTML=T),k=D(q),v=u(q,"ION-BUTTON",{});var C=g(v);I=le(C,a),C.forEach(s),q.forEach(s),m=D(H),d=u(H,"ION-TITLE",{});var F=g(d);N=le(F,f),F.forEach(s),H.forEach(s),L.forEach(s),y=D(b),S.l(b),O=Ne(),this.h()},h(){E(n,"title","Atrás"),E(n,"alt","Atrás"),E(o,"slot","start"),E(p,"slot","end"),E(e,"translucent","")},m(b,L){z(b,e,L),i(e,t),i(t,o),i(o,n),i(t,_),i(t,p),i(p,h),i(p,k),i(p,v),i(v,I),i(t,m),i(t,d),i(d,N),z(b,y,L),S.m(b,L),z(b,O,L),B||(w=[x(n,"click",l[13]),x(h,"click",l[17])],B=!0)},p(b,L){L[0]&4&&a!==(a=b[2].name+"")&&ge(I,a),L[0]&16&&f!==(f=b[4].name+"")&&ge(N,f),U===(U=P(b))&&S?S.p(b,L):(S.d(1),S=U(b),S&&(S.c(),S.m(O.parentNode,O)))},d(b){b&&(s(e),s(y),s(O)),S.d(b),B=!1,De(w)}}}function Sn(l){let e,t,o,n=l[2]&&Ot(l);return{c(){e=A(),n&&n.c(),t=Ne(),this.h()},l(r){qt("svelte-kn0kph",document.head).forEach(s),e=D(r),n&&n.l(r),t=Ne(),this.h()},h(){document.title="Rutaflow - Detalles de ruta"},m(r,_){z(r,e,_),n&&n.m(r,_),z(r,t,_),o=!0},p(r,_){r[2]?n?(n.p(r,_),_[0]&4&&Xe(n,1)):(n=Ot(r),n.c(),Xe(n,1),n.m(t.parentNode,t)):n&&(Gt(),et(n,1,1,()=>{n=null}),zt())},i(r){o||(Xe(n),o=!0)},o(r){et(n),o=!1},d(r){r&&(s(e),s(t)),n&&n.d(r)}}}function ke(l){let e="#ffffff";return l.status==="pending"?e="#f2e300":l.status==="completed"&&(e="#44d900"),e}function Ue(l){let e="";return l=="pending"?e="Pendiente":l=="completed"&&(e="Completado"),e}function He(l){l.slice(0,1)==="#"&&(l=l.slice(1)),l.length===3&&(l=l.split("").map(function(r){return r+r}).join(""));const e=parseInt(l.substr(0,2),16),t=parseInt(l.substr(2,2),16),o=parseInt(l.substr(4,2),16);return(e*299+t*587+o*114)/1e3>=128?"#414040":"#fff"}function ot(l,e){let t=new FormData;return t.append("id_route",l),t.append("status",e),fetch("https://rutaflow-app-development.up.railway.app/api/admin/route/change_status.php",{method:"POST",body:t}).then(o=>o.json()).then(o=>{}).catch(o=>{console.error("Error fetching data:",o)}),""}const Bn=l=>l.img;function Mn(l,e,t){let o,n;pt(l,Qt,C=>t(16,o=C)),pt(l,Ye,C=>t(7,n=C));var r=this&&this.__awaiter||function(C,F,j,J){function X(ce){return ce instanceof j?ce:new j(function(_e){_e(ce)})}return new(j||(j=Promise))(function(ce,_e){function me(ae){try{te(J.next(ae))}catch(be){_e(be)}}function ve(ae){try{te(J.throw(ae))}catch(be){_e(be)}}function te(ae){ae.done?ce(ae.value):X(ae.value).then(me,ve)}te((J=J.apply(C,F||[])).next())})};let{routeId:_}=e,{driverId:p}=e,h=new Object,T=[],k={},v={},a;const I=()=>r(void 0,void 0,void 0,function*(){yield m(_),a.complete()});function m(C){const F=new FormData;F.append("id_route",C),fetch("https://rutaflow-app-development.up.railway.app/api/admin/report/seguimiento_list.php",{method:"POST",body:F}).then(j=>j.json()).then(j=>{t(4,k=j.data.seguimiento_list[0]),t(3,T=j.data.event_list),t(5,v=j.data.checklist)}).catch(j=>{console.error("Error fetching data:",j)})}const d=C=>new Promise((F,j)=>{const J=new FormData;J.append("id_route",C.id_route),J.append("id_event",C.id_event),fetch("https://rutaflow-app-development.up.railway.app/api/admin/evidence/evidence_by_event.php",{method:"POST",body:J}).then(X=>X.json()).then(X=>{F(X.data.event_evidence[0])}).catch(X=>{console.error("Error fetching data:",X),j(X)})}),f=(C,F)=>{d(C).then(j=>{C.client_name=k.client_name,j&&(C.img=j.img,C.driver_comments=j.driver_comments,C.comments=j.comments),ze("modal-delivery-info",Nn,{delivery:C,isLast:F}).then(J=>{})})},N=(C,F,j)=>{var J=!1;return ze("modal-checklist",Mt,{checklist:C,driverId:F,routeId:j,isLast:J}).then(X=>{}),ot(j,"checklist"),""},y=(C,F)=>(ze("modal-expense",Cn,{routeName:C,routeId:F}).then(j=>{}),""),O=C=>{if(C.tracking_type=="subscription"){if(C.subscriber_info&&C.payment_type==="cash"&&new Date(C.subscriber_info.payment_next)<new Date)return!0}else if(C.tracking_type=="ecommerce"&&Number(C.payment_pending)>0)return!0;return!1},B=()=>{h.id_driver?Se(`/drivers/${h.id_driver}`):Se("/drivers/me")},w=(C,F)=>r(void 0,void 0,void 0,function*(){yield(yield Je.create({header:C||"Error",message:F||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()});function P(C){return C===T.length-1}const U=()=>y(k.name,_);function S(C){Ie[C?"unshift":"push"](()=>{a=C,t(6,a)})}const b=(C,F)=>f(C,P(F));function L(C){Ie[C?"unshift":"push"](()=>{a=C,t(6,a)})}const H=(C,F)=>f(C,P(F));function M(C){Ie[C?"unshift":"push"](()=>{a=C,t(6,a)})}const q=C=>{const F=T.findIndex(_e=>_e.id_event===C.id_event),j=F===0,J=F>0?T[F-1]:null,X=j||J&&J.img!==null,ce=C.img!==null&&C.img!=="";X||j&&!ce?f(C):w("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")};return l.$$set=C=>{"routeId"in C&&t(0,_=C.routeId),"driverId"in C&&t(1,p=C.driverId)},l.$$.update=()=>{l.$$.dirty[0]&65541&&(t(0,{routeId:_,driverId:p}=o.params,_,(t(1,p),t(16,o),t(2,h),t(0,_))),t(2,h=JSON.parse(localStorage.getItem("userSession"))),h?h.id_user&&(h.type=="admin"||h.type=="superadmin")?(Se(`/drivers/me/routes/${_}`),m(_)):h.id_user&&h.id_driver&&(m(_),Se(`/drivers/${h.id_driver}/routes/${_}`)):Se("/"))},[_,p,h,T,k,v,a,n,I,f,N,y,O,B,w,P,o,U,S,b,L,H,M,q]}class Vn extends je{constructor(e){super(),Ve(this,e,Mn,Sn,Fe,{routeId:0,driverId:1},null,[-1,-1])}}export{Vn as component};

import{Z as _t,s as Ye,e as s,j as y,b as c,q as p,d as ne,h as a,m as w,v as m,i as Z,w as o,x as ce,n as Ae,z as Be,_ as xt,B as k,o as $e,k as Me,$ as ht,t as he,r as pe,f as Y,a0 as $t,a1 as xe,A as De,y as ze,a2 as en,a3 as We,a4 as tn,a5 as nn,l as on,p as ln,F as rn}from"../chunks/index.CdEBkEwf.js";import{S as Qe,i as Ze,t as it,a as ct,c as an,b as sn,d as cn,m as un,e as fn,g as dn}from"../chunks/index.c2pjNB5R.js";import{e as Ue,u as et,d as tt,a as _n,b as hn,c as pn,i as Wt,f as mn,g as Jt,h as vn,j as ut,k as gn,m as Yt,s as pt,n as Ve,o as bn,q as En,t as In,r as kn,v as On,w as Nn,x as Tn,y as Cn,p as yn}from"../chunks/index.DDrvzIwm.js";import"../chunks/index-48209844.IIRtDZyg.js";import{m as nt,D as rt,a as Ke,I as wn}from"../chunks/IonPage.D_4pE1hZ.js";import{q as Ln,t as zn}from"../chunks/ion-modal.CsJaVgKZ.js";import{g as Ge}from"../chunks/entry.GZbPsMv8.js";const An=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global,Sn=(i,e)=>{if(!customElements.get(i)){class t extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const n={};for(const r of this.attributes)n[r.name]=r.value;new e({target:this.shadowRoot,props:n})}}customElements.define(i,t)}},Mn=function(i){return document.createElement(i).constructor!==HTMLElement},Dn=(i,e)=>{Mn(i)||Sn(i,e)},je=async(i,e,t)=>{Ln(),zn(),Dn(i,e);const l=await nt.create({component:i,componentProps:t});return l.present(),await l.onWillDismiss()};let Xe=_t({km_inicial:[],gas_inicial:[],km_final:[],gas_final:[]}),Qt=_t({flag:[]});function Pn(i){let e,t,l,n,r="Cancelar",d,u,_="Captura de Km/Gas",T,g,h,f="Confirmar",v,E,N,C,L,S,j;return{c(){e=s("ion-header"),t=s("ion-toolbar"),l=s("ion-buttons"),n=s("ion-button"),n.textContent=r,d=y(),u=s("ion-title"),u.textContent=_,T=y(),g=s("ion-buttons"),h=s("ion-button"),h.textContent=f,v=y(),E=s("ion-content"),N=s("ion-item"),C=s("ion-input"),this.h()},l(X){e=c(X,"ION-HEADER",{translucent:!0});var F=p(e);t=c(F,"ION-TOOLBAR",{});var A=p(t);l=c(A,"ION-BUTTONS",{slot:!0});var H=p(l);n=c(H,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),ne(n)!=="svelte-17pq4f4"&&(n.textContent=r),H.forEach(a),d=w(A),u=c(A,"ION-TITLE",{"data-svelte-h":!0}),ne(u)!=="svelte-1yhkaq7"&&(u.textContent=_),T=w(A),g=c(A,"ION-BUTTONS",{slot:!0});var I=p(g);h=c(I,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),ne(h)!=="svelte-cm6j4s"&&(h.textContent=f),I.forEach(a),A.forEach(a),F.forEach(a),v=w(X),E=c(X,"ION-CONTENT",{fullscreen:!0});var M=p(E);N=c(M,"ION-ITEM",{});var P=p(N);C=c(P,"ION-INPUT",{class:!0,inputmode:!0,pattern:!0,type:!0,placeholder:!0,value:!0,required:!0});var B=p(C);B.forEach(a),P.forEach(a),M.forEach(a),this.h()},h(){m(n,"color","medium"),m(l,"slot","start"),m(h,"strong",""),m(g,"slot","end"),m(e,"translucent",""),m(C,"class","fin-km"),m(C,"inputmode","numeric"),m(C,"pattern","[0-9]*"),m(C,"type","number"),m(C,"placeholder",L="Ingresa "+i[0]+" actual"),m(C,"value",i[1]),m(C,"required",""),m(E,"fullscreen","")},m(X,F){Z(X,e,F),o(e,t),o(t,l),o(l,n),o(t,d),o(t,u),o(t,T),o(t,g),o(g,h),Z(X,v,F),Z(X,E,F),o(E,N),o(N,C),S||(j=[ce(n,"click",i[2]),ce(h,"click",i[3]),ce(C,"input",i[4])],S=!0)},p(X,[F]){F&1&&L!==(L="Ingresa "+X[0]+" actual")&&m(C,"placeholder",L),F&2&&m(C,"value",X[1])},i:Ae,o:Ae,d(X){X&&(a(e),a(v),a(E)),S=!1,Be(j)}}}function Hn(i,e,t){const l=xt();let r=document.querySelector("ion-modal").componentProps.data_type,d;Qt.subscribe(h=>{r=h.flag[0],r=="km_final"||r=="km_inicial"?t(0,d="kilometraje"):t(0,d="litros de gasolina")});let u=0;function _(){nt.dismiss()}function T(){l("modalResult",{data:"Your data",role:"confirm"}),r=="km_inicial"?Xe.update(f=>({...f,km_inicial:[u]})):r=="gas_inicial"?Xe.update(f=>({...f,gas_inicial:[u]})):r=="km_final"?Xe.update(f=>({...f,km_final:[u]})):r=="gas_final"&&Xe.update(f=>({...f,gas_final:[u]})),_()}return[d,u,_,T,h=>t(1,u=h.target.value)]}class Bn extends Qe{constructor(e){super(),Ze(this,e,Hn,Pn,Ye,{})}}const at=_t({items:[],checkedIndices:[],mandatory:[]});function gt(i,e,t){const l=i.slice();return l[55]=e[t],l[56]=e,l[57]=t,l}function Rn(i){let e,t,l,n,r,d="Kilometraje inicial",u,_,T=i[0]?i[0]+" km.":"Cargar km",g,h,f,v,E,N,C,L="Gasolina inicial (litros)",S,j,X=i[1]?i[1]+" litros":"Cargar gas",F,A,H,I;return A=ht(i[21][0]),{c(){e=s("ion-item"),t=s("ion-label"),l=s("input"),n=y(),r=s("p"),r.textContent=d,u=y(),_=s("ion-button"),g=he(T),h=y(),f=s("ion-item"),v=s("ion-label"),E=s("input"),N=y(),C=s("p"),C.textContent=L,S=y(),j=s("ion-button"),F=he(X),this.h()},l(M){e=c(M,"ION-ITEM",{});var P=p(e);t=c(P,"ION-LABEL",{style:!0});var B=p(t);l=c(B,"INPUT",{id:!0,style:!0,type:!0}),n=w(B),r=c(B,"P",{style:!0,"data-svelte-h":!0}),ne(r)!=="svelte-88twxi"&&(r.textContent=d),B.forEach(a),u=w(P),_=c(P,"ION-BUTTON",{fill:!0,size:!0,class:!0,"aria-selected":!0});var R=p(_);g=pe(R,T),R.forEach(a),P.forEach(a),h=w(M),f=c(M,"ION-ITEM",{});var q=p(f);v=c(q,"ION-LABEL",{style:!0});var G=p(v);E=c(G,"INPUT",{id:!0,style:!0,type:!0}),N=w(G),C=c(G,"P",{style:!0,"data-svelte-h":!0}),ne(C)!=="svelte-1ux30eb"&&(C.textContent=L),G.forEach(a),S=w(q),j=c(q,"ION-BUTTON",{fill:!0,class:!0,size:!0,style:!0});var ee=p(j);F=pe(ee,X),ee.forEach(a),q.forEach(a),this.h()},h(){Y(l,"id","chkbox-km-ini"),k(l,"pointer-events","auto"),Y(l,"type","checkbox"),l.required=!0,k(r,"margin-left","10px"),k(t,"display","flex"),m(_,"fill","outline"),m(_,"size","small"),m(_,"class","loadKmInicial"),m(_,"aria-selected",""),Y(E,"id","chkbox-gas-ini"),k(E,"pointer-events","auto"),Y(E,"type","checkbox"),E.required=!0,k(C,"margin-left","10px"),k(v,"display","flex"),m(j,"fill","outline"),m(j,"class","loadGasInicial"),m(j,"size","small"),k(j,"height","16px "),A.p(l,E)},m(M,P){Z(M,e,P),o(e,t),o(t,l),l.checked=~(i[4]||[]).indexOf(l.__value),i[28](l),o(t,n),o(t,r),o(e,u),o(e,_),o(_,g),Z(M,h,P),Z(M,f,P),o(f,v),o(v,E),i[30](E),E.checked=~(i[4]||[]).indexOf(E.__value),o(v,N),o(v,C),o(f,S),o(f,j),o(j,F),H||(I=[ce(l,"change",i[27]),ce(_,"click",i[29]),ce(E,"change",i[31]),ce(j,"click",i[32])],H=!0)},p(M,P){P[0]&16&&(l.checked=~(M[4]||[]).indexOf(l.__value)),P[0]&1&&T!==(T=M[0]?M[0]+" km.":"Cargar km")&&ze(g,T),P[0]&16&&(E.checked=~(M[4]||[]).indexOf(E.__value)),P[0]&2&&X!==(X=M[1]?M[1]+" litros":"Cargar gas")&&ze(F,X)},d(M){M&&(a(e),a(h),a(f)),i[28](null),i[30](null),A.r(),H=!1,Be(I)}}}function Un(i){let e,t,l,n,r,d="Kilometraje final",u,_,T=i[2]?i[2]+" km.":"Cargar km",g,h,f,v,E,N,C,L="Gasolina final (litros)",S,j,X=i[3]?i[3]+" litros":"Cargar gas",F,A,H,I;return A=ht(i[21][0]),{c(){e=s("ion-item"),t=s("ion-label"),l=s("input"),n=y(),r=s("p"),r.textContent=d,u=y(),_=s("ion-button"),g=he(T),h=y(),f=s("ion-item"),v=s("ion-label"),E=s("input"),N=y(),C=s("p"),C.textContent=L,S=y(),j=s("ion-button"),F=he(X),this.h()},l(M){e=c(M,"ION-ITEM",{});var P=p(e);t=c(P,"ION-LABEL",{style:!0});var B=p(t);l=c(B,"INPUT",{id:!0,style:!0,type:!0}),n=w(B),r=c(B,"P",{style:!0,"data-svelte-h":!0}),ne(r)!=="svelte-ccmu71"&&(r.textContent=d),B.forEach(a),u=w(P),_=c(P,"ION-BUTTON",{fill:!0,size:!0,class:!0,"aria-selected":!0});var R=p(_);g=pe(R,T),R.forEach(a),P.forEach(a),h=w(M),f=c(M,"ION-ITEM",{});var q=p(f);v=c(q,"ION-LABEL",{style:!0});var G=p(v);E=c(G,"INPUT",{id:!0,style:!0,type:!0}),N=w(G),C=c(G,"P",{style:!0,"data-svelte-h":!0}),ne(C)!=="svelte-wsoyd2"&&(C.textContent=L),G.forEach(a),S=w(q),j=c(q,"ION-BUTTON",{fill:!0,size:!0,class:!0});var ee=p(j);F=pe(ee,X),ee.forEach(a),q.forEach(a),this.h()},h(){Y(l,"id","chkbox-km-fin"),k(l,"pointer-events","auto"),Y(l,"type","checkbox"),l.required=!0,k(r,"margin-left","10px"),k(t,"display","flex"),m(_,"fill","outline"),m(_,"size","small"),m(_,"class","loadKmInicial"),m(_,"aria-selected",""),Y(E,"id","chkbox-gas-fin"),k(E,"pointer-events","auto"),Y(E,"type","checkbox"),E.required=!0,k(C,"margin-left","10px"),k(v,"display","flex"),m(j,"fill","outline"),m(j,"size","small"),m(j,"class","loadGasInicial"),A.p(l,E)},m(M,P){Z(M,e,P),o(e,t),o(t,l),l.checked=~(i[4]||[]).indexOf(l.__value),i[22](l),o(t,n),o(t,r),o(e,u),o(e,_),o(_,g),Z(M,h,P),Z(M,f,P),o(f,v),o(v,E),E.checked=~(i[4]||[]).indexOf(E.__value),i[25](E),o(v,N),o(v,C),o(f,S),o(f,j),o(j,F),H||(I=[ce(l,"change",i[20]),ce(_,"click",i[23]),ce(E,"change",i[24]),ce(j,"click",i[26])],H=!0)},p(M,P){P[0]&16&&(l.checked=~(M[4]||[]).indexOf(l.__value)),P[0]&4&&T!==(T=M[2]?M[2]+" km.":"Cargar km")&&ze(g,T),P[0]&16&&(E.checked=~(M[4]||[]).indexOf(E.__value)),P[0]&8&&X!==(X=M[3]?M[3]+" litros":"Cargar gas")&&ze(F,X)},d(M){M&&(a(e),a(h),a(f)),i[22](null),i[25](null),A.r(),H=!1,Be(I)}}}function Vn(i){let e=[],t=new Map,l,n=Ue(i[13]);const r=d=>d[55].id_checklist_event;for(let d=0;d<n.length;d+=1){let u=gt(i,n,d),_=r(u);t.set(_,e[d]=bt(_,u))}return{c(){for(let d=0;d<e.length;d+=1)e[d].c();l=Me()},l(d){for(let u=0;u<e.length;u+=1)e[u].l(d);l=Me()},m(d,u){for(let _=0;_<e.length;_+=1)e[_]&&e[_].m(d,u);Z(d,l,u)},p(d,u){u[0]&407664&&(n=Ue(d[13]),e=et(e,u,r,1,d,n,t,l.parentNode,tt,bt,l,gt))},d(d){d&&a(l);for(let u=0;u<e.length;u+=1)e[u].d(d)}}}function Fn(i){let e,t=(i[12][i[55].id_checklist_event]?i[12][i[55].id_checklist_event]:"Cargar evidencia")+"",l;return{c(){e=s("label"),l=he(t),this.h()},l(n){e=c(n,"LABEL",{for:!0,class:!0});var r=p(e);l=pe(r,t),r.forEach(a),this.h()},h(){Y(e,"for","chklist-"+i[55].id_checklist_event),Y(e,"class","button-label svelte-1ruehls")},m(n,r){Z(n,e,r),o(e,l)},p(n,r){r[0]&4096&&t!==(t=(n[12][n[55].id_checklist_event]?n[12][n[55].id_checklist_event]:"Cargar evidencia")+"")&&ze(l,t)},d(n){n&&a(e)}}}function jn(i){let e;return{c(){e=s("ion-spinner"),this.h()},l(t){e=c(t,"ION-SPINNER",{name:!0,class:!0}),p(e).forEach(a),this.h()},h(){m(e,"name","dots"),m(e,"class","button-spinner svelte-1ruehls")},m(t,l){Z(t,e,l)},p:Ae,d(t){t&&a(e)}}}function bt(i,e){let t,l,n,r=e[55],d,u,_=e[55].item+"",T,g,h,f=e[55].mandatory=="1"?" * ":"",v,E,N,C,L,S,j,X,F,A;const H=()=>e[34](n,r),I=()=>e[34](null,r);function M(){return e[35](e[55])}function P(G,ee){return G[11][G[55].id_checklist_event]?jn:Fn}let B=P(e),R=B(e);function q(...G){return e[37](e[55],...G)}return X=ht(e[21][0]),{key:i,first:null,c(){t=s("ion-item"),l=s("ion-label"),n=s("input"),d=y(),u=s("p"),T=he(_),g=y(),h=s("b"),v=he(f),E=y(),N=s("ion-button"),C=s("div"),R.c(),L=y(),S=s("input"),j=y(),this.h()},l(G){t=c(G,"ION-ITEM",{});var ee=p(t);l=c(ee,"ION-LABEL",{style:!0});var le=p(l);n=c(le,"INPUT",{id:!0,style:!0,type:!0}),d=w(le),u=c(le,"P",{style:!0});var oe=p(u);T=pe(oe,_),g=w(oe),oe.forEach(a),h=c(le,"B",{style:!0});var de=p(h);v=pe(de,f),de.forEach(a),le.forEach(a),E=w(ee),N=c(ee,"ION-BUTTON",{fill:!0,class:!0,size:!0});var se=p(N);C=c(se,"DIV",{class:!0});var re=p(C);R.l(re),L=w(re),S=c(re,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0,capture:!0}),re.forEach(a),se.forEach(a),j=w(ee),ee.forEach(a),this.h()},h(){Y(n,"id",`chkbox-${e[55].id_checklist_event}`),k(n,"pointer-events","auto"),Y(n,"type","checkbox"),n.__value=e[55].id_checklist_event,$t(n,n.__value),n.required=!0,k(u,"margin-left","10px"),k(h,"margin-left","5px"),k(l,"display","flex"),k(S,"display","none"),Y(S,"id","chklist-"+e[55].id_checklist_event),Y(S,"name","fileToUpload"),Y(S,"type","file"),Y(S,"accept","image/*"),Y(S,"capture","environment"),Y(C,"class","button-content svelte-1ruehls"),m(N,"fill","outline"),m(N,"class","loadEvidence svelte-1ruehls"),m(N,"size","small"),X.p(n),this.first=t},m(G,ee){Z(G,t,ee),o(t,l),o(l,n),n.checked=~(e[4]||[]).indexOf(n.__value),H(),o(l,d),o(l,u),o(u,T),o(u,g),o(l,h),o(h,v),o(t,E),o(t,N),o(N,C),R.m(C,null),o(C,L),o(C,S),e[36](S),o(t,j),F||(A=[ce(n,"change",e[33]),ce(n,"change",M),ce(S,"change",q)],F=!0)},p(G,ee){e=G,ee[0]&16&&(n.checked=~(e[4]||[]).indexOf(n.__value)),r!==e[55]&&(I(),r=e[55],H()),B===(B=P(e))&&R?R.p(e,ee):(R.d(1),R=B(e),R&&(R.c(),R.m(C,L)))},d(G){G&&a(t),I(),R.d(),e[36](null),X.r(),F=!1,Be(A)}}}function qn(i){let e,t,l,n,r="Cancelar",d,u,_="REQUERIMIENTOS DE RUTA",T,g,h,f,v,E,N,C="Confirmar",L,S;function j(H,I){return H[14]?Un:Rn}let F=j(i)(i),A=i[13]&&Vn(i);return{c(){e=s("ion-header"),t=s("ion-toolbar"),l=s("ion-buttons"),n=s("ion-button"),n.textContent=r,d=y(),u=s("ion-title"),u.textContent=_,T=y(),g=s("ion-content"),h=s("ion-list"),F.c(),f=y(),A&&A.c(),v=y(),E=s("ion-footer"),N=s("ion-button"),N.textContent=C,this.h()},l(H){e=c(H,"ION-HEADER",{translucent:!0});var I=p(e);t=c(I,"ION-TOOLBAR",{});var M=p(t);l=c(M,"ION-BUTTONS",{slot:!0});var P=p(l);n=c(P,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),ne(n)!=="svelte-1dnmkxs"&&(n.textContent=r),P.forEach(a),d=w(M),u=c(M,"ION-TITLE",{"data-svelte-h":!0}),ne(u)!=="svelte-19bar5p"&&(u.textContent=_),M.forEach(a),I.forEach(a),T=w(H),g=c(H,"ION-CONTENT",{fullscreen:!0});var B=p(g);h=c(B,"ION-LIST",{});var R=p(h);F.l(R),f=w(R),A&&A.l(R),R.forEach(a),B.forEach(a),v=w(H),E=c(H,"ION-FOOTER",{});var q=p(E);N=c(q,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),ne(N)!=="svelte-g82qqw"&&(N.textContent=C),q.forEach(a),this.h()},h(){m(n,"color","medium"),m(l,"slot","start"),m(e,"translucent",""),m(g,"fullscreen",""),m(N,"fill","outline"),m(N,"color","tertiary"),m(N,"strong",""),k(N,"width","99%"),k(N,"height","auto")},m(H,I){Z(H,e,I),o(e,t),o(t,l),o(l,n),o(t,d),o(t,u),Z(H,T,I),Z(H,g,I),o(g,h),F.m(h,null),o(h,f),A&&A.m(h,null),Z(H,v,I),Z(H,E,I),o(E,N),L||(S=[ce(n,"click",i[15]),ce(N,"click",i[16])],L=!0)},p(H,I){F.p(H,I),H[13]&&A.p(H,I)},i:Ae,o:Ae,d(H){H&&(a(e),a(T),a(g),a(v),a(E)),F.d(),A&&A.d(),L=!1,Be(S)}}}function ft(i,e){if(typeof i=="object"&&i!==null||Array.isArray(i)){if(Array.isArray(i))return i.map(t=>ft(t,e)).flat();{const t=Object.keys(i);let l;return e=="id_checklist_event"?l=t.filter(r=>r.toLowerCase().includes("id_checklist_event")).map(r=>i[r]):e=="mandatory"?l=t.filter(r=>r.toLowerCase().includes("mandatory")).map(r=>i[r]):(console.error("Tipo de dato no reconocido."),l=!1),l}}else return console.error("Invalid input. Please provide a valid object or array."),[]}function Gn(i,e,t){let l=rt,n=document.querySelector("ion-modal");const r=n.componentProps.checklist,d=n.componentProps.driverId,u=n.componentProps.routeId,_=n.componentProps.isLast;let T,g,h,f,v=[],E=null,N={},C,L,S,j,X={},F=new Object,A={},H={};$e(()=>{F=JSON.parse(localStorage.getItem("userSession")),_?console.log("Último checklist"):at.update(z=>(z.mandatory=ft(r,"mandatory"),z.items=ft(r,"id_checklist_event"),z))});function I(z){t(11,X[z]=!0,X)}const M=async()=>{await(await Ke.create({header:"Datos o checklist incompletos",message:"Carga la evidencia requerida y marca todas las casillas para confirmar",buttons:[{text:"Cerrar"}]})).present()},P=async()=>{await(await Ke.create({header:"Datos capturados",message:"El kilometraje y gasolina final fueron registrados correctamente, espere aprobación para finalizar ruta",buttons:[{text:"Cerrar"}]})).present()},B=async z=>{await(await Ke.create({header:"Datos inválidos",message:z=="km"?"Llena correctamente el campo de kilometraje inicial":"Llena correctamente el campo de gasolina inicial",buttons:[{text:"Cerrar"}]})).present()},R=()=>{nt.dismiss(),d?Ge(`/drivers/${d}`):Ge("/drivers/me")},q=()=>{if(_){var z=de(h,"km"),K=de(f,"gas");let U=new FormData;U.append("km_final",z),U.append("gas_final",K),U.append("id_route",u),U=_e(U),z&&K?(R(),fetch(`${l}api/admin/checklist/add_evidence.php`,{method:"POST",body:U}).then(te=>te.json()).then(te=>{P()}).catch(te=>{console.error("Error fetching data:",te)})):M()}else{var x=de(T,"km"),Q=de(g,"gas");at.update(U=>{U.items;const te=U.mandatory;if(U.items.filter((ge,fe)=>U.mandatory[fe]==="1").every(ge=>U.checkedIndices.includes(ge))&&x&&Q){R();let ge=new FormData;ge=_e(ge),ge.append("km_inicial",x),ge.append("gas_inicial",Q),ge.append("id_route",u);for(const fe in A)if(A.hasOwnProperty(fe)){const{img:Pe,img_id:we}=A[fe];ge.append(`selectedImages[${fe}][img]`,Pe),ge.append(`selectedImages[${fe}][img_id]`,we)}fetch(`${l}api/admin/checklist/add_evidence.php`,{method:"POST",body:ge}).then(fe=>fe.json()).then(fe=>{te&&te.some(Pe=>Pe==="1")?oe(u,"checklist-pending"):oe(u,"enroute")}).catch(fe=>{console.error("Error fetching data:",fe)})}else if(!te&&x&&Q){let ge=new FormData;ge.append("km_inicial",x),ge.append("gas_inicial",Q),ge=_e(ge),fetch(`${l}api/admin/checklist/add_evidence.php`,{method:"POST",body:ge}).then(fe=>fe.json()).then(fe=>{oe(u,"enroute")}).catch(fe=>{console.error("Error fetching data:",fe)})}else M();return U})}be()},G=async(z,K)=>{I(K);const Q=z.target.files[0],U=await ee(Q);if(U){let te=new FormData;te.append("fileToUpload",U),te=_e(te);try{const Ee=await fetch(`${l}api/admin/manager/upload_img_driver.php`,{method:"POST",body:te});if(Ee.ok){const Ce=await Ee.json();A={...A,[K]:{img:Ce.img,img_id:Ce.img_id}},t(12,H={...H,[K]:Ce.filename}),le(K),t(6,N[K].checked=!0,N),t(11,X[K]=!1,X)}else console.error("File upload failed:",Ee.statusText)}catch(Ee){console.error("Error during file upload:",Ee)}}},ee=async z=>new Promise(K=>{const x=new Image;x.src=URL.createObjectURL(z),x.onload=()=>{const Q=document.createElement("canvas"),U=Q.getContext("2d"),te=800,Ee=600;let Ce=x.width,ge=x.height;Ce>te&&(ge*=te/Ce,Ce=te),ge>Ee&&(Ce*=Ee/ge,ge=Ee),Q.width=Ce,Q.height=ge,U.drawImage(x,0,0,Ce,ge),Q.toBlob(fe=>{K(fe),URL.revokeObjectURL(x.src),U.clearRect(0,0,Q.width,Q.height)},"image/jpeg",.7)}}),le=z=>{at.update(K=>(K.checkedIndices.indexOf(z)===-1?K.checkedIndices.push(z):console.error(`ID ${z} is already checked.`),K.items.forEach(Q=>{Q.id_checklist_event===z&&(Q.checked=!0)}),K))};function oe(z,K){let x=new FormData;x.append("id_route",z),x.append("status",K),x=_e(x),fetch(`${l}api/admin/route/change_status.php`,{method:"POST",body:x}).then(Q=>Q.json()).then(Q=>{}).catch(Q=>{console.error("Error fetching data:",Q)})}function de(z,K){return/^\d+$/.test(z)?parseInt(z,10):(B(K),null)}function se(z,K){re(K),n.componentProps.data_type=K,je("modal-gas-km",Bn,{r:K}).then(()=>{Xe.subscribe(x=>{ye(x,K)})})}function re(z){Qt.update(K=>({...K,flag:[z]}))}function ye(z,K){t(0,T=z.km_inicial?z.km_inicial:null),t(1,g=z.gas_inicial?z.gas_inicial:null),t(2,h=z.km_final?z.km_final:null),t(3,f=z.gas_final?z.gas_final:null),K=="km_inicial"&&C&&t(7,C.checked=!0,C),K=="gas_inicial"&&L&&t(8,L.checked=!0,L),K=="km_final"&&S&&t(9,S.checked=!0,S),K=="gas_final"&&j&&t(10,j.checked=!0,j)}function be(){Xe.set({km_inicial:[],gas_inicial:[],km_final:[],gas_final:[]})}function _e(z){return z.append("token",F.token),z.append("id_user_over",F.id_user),z}const ke=[[]];function Oe(){v=xe(ke[0],this.__value,this.checked),t(4,v)}function Ie(z){De[z?"unshift":"push"](()=>{S=z,t(9,S)})}const Ne=z=>se(z,"km_final");function me(){v=xe(ke[0],this.__value,this.checked),t(4,v)}function Te(z){De[z?"unshift":"push"](()=>{j=z,t(10,j)})}const Le=z=>se(z,"gas_final");function ve(){v=xe(ke[0],this.__value,this.checked),t(4,v)}function ue(z){De[z?"unshift":"push"](()=>{C=z,t(7,C)})}const ie=z=>se(z,"km_inicial");function ae(z){De[z?"unshift":"push"](()=>{L=z,t(8,L)})}function $(){v=xe(ke[0],this.__value,this.checked),t(4,v)}const b=z=>se(z,"gas_inicial");function D(){v=xe(ke[0],this.__value,this.checked),t(4,v)}function O(z,K){De[z?"unshift":"push"](()=>{N[K.id_checklist_event]=z,t(6,N)})}const V=z=>le(z.id_checklist_event);function W(z){De[z?"unshift":"push"](()=>{E=z,t(5,E)})}return[T,g,h,f,v,E,N,C,L,S,j,X,H,r,_,R,q,G,le,se,Oe,ke,Ie,Ne,me,Te,Le,ve,ue,ie,ae,$,b,D,O,V,W,(z,K)=>G(K,z.id_checklist_event)]}class Zt extends Qe{constructor(e){super(),Ze(this,e,Gn,qn,Ye,{},null,[-1,-1])}}function Et(i,e,t){const l=i.slice();return l[51]=e[t],l[53]=t,l}function Kn(i){let e,t,l="Confirmar",n,r;return{c(){e=s("ion-buttons"),t=s("ion-button"),t.textContent=l,this.h()},l(d){e=c(d,"ION-BUTTONS",{slot:!0});var u=p(e);t=c(u,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),ne(t)!=="svelte-1ida0il"&&(t.textContent=l),u.forEach(a),this.h()},h(){m(t,"strong",""),m(e,"slot","end")},m(d,u){Z(d,e,u),o(e,t),n||(r=ce(t,"click",i[21]),n=!0)},p:Ae,d(d){d&&a(e),n=!1,r()}}}function Xn(i){let e,t,l,n,r,d="Teléfono de Negocio",u,_,T=i[12].client_phone+"",g;return{c(){e=s("ion-item"),t=s("ion-icon"),l=y(),n=s("ion-label"),r=s("p"),r.textContent=d,u=y(),_=s("h2"),g=he(T),this.h()},l(h){e=c(h,"ION-ITEM",{href:!0});var f=p(e);t=c(f,"ION-ICON",{icon:!0,slot:!0}),p(t).forEach(a),l=w(f),n=c(f,"ION-LABEL",{class:!0});var v=p(n);r=c(v,"P",{"data-svelte-h":!0}),ne(r)!=="svelte-1u5l7fz"&&(r.textContent=d),u=w(v),_=c(v,"H2",{});var E=p(_);g=pe(E,T),E.forEach(a),v.forEach(a),f.forEach(a),this.h()},h(){m(t,"icon",hn),m(t,"slot","start"),m(n,"class","ion-text-wrap"),m(e,"href","tel:"+i[12].client_phone)},m(h,f){Z(h,e,f),o(e,t),o(e,l),o(e,n),o(n,r),o(n,u),o(n,_),o(_,g)},p:Ae,d(h){h&&a(e)}}}function Wn(i){let e,t,l,n,r,d="Domicilio Alternativo",u,_,T=i[12].line2+"",g,h,f;return{c(){e=s("ion-item"),t=s("ion-icon"),l=y(),n=s("ion-label"),r=s("p"),r.textContent=d,u=y(),_=s("h2"),g=he(T),h=y(),f=s("ion-icon"),this.h()},l(v){e=c(v,"ION-ITEM",{href:!0});var E=p(e);t=c(E,"ION-ICON",{icon:!0,slot:!0}),p(t).forEach(a),l=w(E),n=c(E,"ION-LABEL",{class:!0});var N=p(n);r=c(N,"P",{"data-svelte-h":!0}),ne(r)!=="svelte-1ub9uzw"&&(r.textContent=d),u=w(N),_=c(N,"H2",{});var C=p(_);g=pe(C,T),C.forEach(a),N.forEach(a),h=w(E),f=c(E,"ION-ICON",{icon:!0,slot:!0}),p(f).forEach(a),E.forEach(a),this.h()},h(){m(t,"icon",pt),m(t,"slot","start"),m(n,"class","ion-text-wrap"),m(f,"icon",Ve),m(f,"slot","end"),m(e,"href","https://www.google.com/maps/searhc/?api=1&query="+i[12].line2)},m(v,E){Z(v,e,E),o(e,t),o(e,l),o(e,n),o(n,r),o(n,u),o(n,_),o(_,g),o(e,h),o(e,f)},p:Ae,d(v){v&&a(e)}}}function Jn(i){let e,t,l,n,r,d="Domicilio",u,_,T=i[12].line1+"",g,h,f,v,E=i[12].line2&&i[12].line2.trim().length,N,C=E&&Yn(i);return{c(){e=s("ion-item"),t=s("ion-icon"),l=y(),n=s("ion-label"),r=s("p"),r.textContent=d,u=y(),_=s("h2"),g=he(T),h=y(),f=s("ion-icon"),v=y(),C&&C.c(),N=Me(),this.h()},l(L){e=c(L,"ION-ITEM",{href:!0});var S=p(e);t=c(S,"ION-ICON",{icon:!0,slot:!0}),p(t).forEach(a),l=w(S),n=c(S,"ION-LABEL",{class:!0});var j=p(n);r=c(j,"P",{"data-svelte-h":!0}),ne(r)!=="svelte-cbm7q1"&&(r.textContent=d),u=w(j),_=c(j,"H2",{});var X=p(_);g=pe(X,T),X.forEach(a),j.forEach(a),h=w(S),f=c(S,"ION-ICON",{icon:!0,slot:!0}),p(f).forEach(a),S.forEach(a),v=w(L),C&&C.l(L),N=Me(),this.h()},h(){m(t,"icon",pt),m(t,"slot","start"),m(n,"class","ion-text-wrap"),m(f,"icon",Ve),m(f,"slot","end"),m(e,"href","https://www.google.com/maps/search/?api=1&query="+i[12].line1)},m(L,S){Z(L,e,S),o(e,t),o(e,l),o(e,n),o(n,r),o(n,u),o(n,_),o(_,g),o(e,h),o(e,f),Z(L,v,S),C&&C.m(L,S),Z(L,N,S)},p(L,S){E&&C.p(L,S)},d(L){L&&(a(e),a(v),a(N)),C&&C.d(L)}}}function Yn(i){let e,t,l,n,r,d="Domicilio Alternativo",u,_,T=i[12].line2+"",g,h,f;return{c(){e=s("ion-item"),t=s("ion-icon"),l=y(),n=s("ion-label"),r=s("p"),r.textContent=d,u=y(),_=s("h2"),g=he(T),h=y(),f=s("ion-icon"),this.h()},l(v){e=c(v,"ION-ITEM",{href:!0});var E=p(e);t=c(E,"ION-ICON",{icon:!0,slot:!0}),p(t).forEach(a),l=w(E),n=c(E,"ION-LABEL",{class:!0});var N=p(n);r=c(N,"P",{"data-svelte-h":!0}),ne(r)!=="svelte-1ub9uzw"&&(r.textContent=d),u=w(N),_=c(N,"H2",{});var C=p(_);g=pe(C,T),C.forEach(a),N.forEach(a),h=w(E),f=c(E,"ION-ICON",{icon:!0,slot:!0}),p(f).forEach(a),E.forEach(a),this.h()},h(){m(t,"icon",pt),m(t,"slot","start"),m(n,"class","ion-text-wrap"),m(f,"icon",Ve),m(f,"slot","end"),m(e,"href","https://www.google.com/maps/search/?api=1&query="+i[12].line2)},m(v,E){Z(v,e,E),o(e,t),o(e,l),o(e,n),o(n,r),o(n,u),o(n,_),o(_,g),o(e,h),o(e,f)},p:Ae,d(v){v&&a(e)}}}function It(i){let e,t,l,n,r,d="Contacto del Cliente",u,_,T,g,h=i[16]&&i[16]==="1"&&Qn(i);return{c(){e=s("ion-item"),t=s("ion-icon"),l=y(),n=s("ion-label"),r=s("p"),r.textContent=d,u=y(),_=s("h2"),T=he(i[6]),g=y(),h&&h.c(),this.h()},l(f){e=c(f,"ION-ITEM",{});var v=p(e);t=c(v,"ION-ICON",{icon:!0,slot:!0}),p(t).forEach(a),l=w(v),n=c(v,"ION-LABEL",{class:!0});var E=p(n);r=c(E,"P",{"data-svelte-h":!0}),ne(r)!=="svelte-1utsyb6"&&(r.textContent=d),u=w(E),_=c(E,"H2",{});var N=p(_);T=pe(N,i[6]),N.forEach(a),E.forEach(a),g=w(v),h&&h.l(v),v.forEach(a),this.h()},h(){m(t,"icon",pn),m(t,"slot","start"),m(n,"class","ion-text-wrap")},m(f,v){Z(f,e,v),o(e,t),o(e,l),o(e,n),o(n,r),o(n,u),o(n,_),o(_,T),o(e,g),h&&h.m(e,null)},p(f,v){v[0]&64&&ze(T,f[6]),f[16]&&f[16]==="1"&&h.p(f,v)},d(f){f&&a(e),h&&h.d()}}}function Qn(i){let e,t=`<ion-icon icon="${bn}" slot="start"></ion-icon>
                        Notificar Cliente`,l,n;return{c(){e=s("ion-button"),e.innerHTML=t,this.h()},l(r){e=c(r,"ION-BUTTON",{fill:!0,style:!0,"data-svelte-h":!0}),ne(e)!=="svelte-w3qtwm"&&(e.innerHTML=t),this.h()},h(){m(e,"fill","outline"),k(e,"margin-left","16px")},m(r,d){Z(r,e,d),l||(n=ce(e,"click",i[22]),l=!0)},p:Ae,d(r){r&&a(e),l=!1,n()}}}function kt(i){let e,t,l,n,r,d="Notas de ubicación",u,_,T;return{c(){e=s("ion-item"),t=s("ion-icon"),l=y(),n=s("ion-label"),r=s("p"),r.textContent=d,u=y(),_=s("h2"),T=he(i[7]),this.h()},l(g){e=c(g,"ION-ITEM",{});var h=p(e);t=c(h,"ION-ICON",{icon:!0,slot:!0}),p(t).forEach(a),l=w(h),n=c(h,"ION-LABEL",{class:!0});var f=p(n);r=c(f,"P",{"data-svelte-h":!0}),ne(r)!=="svelte-nhm2ft"&&(r.textContent=d),u=w(f),_=c(f,"H2",{});var v=p(_);T=pe(v,i[7]),v.forEach(a),f.forEach(a),h.forEach(a),this.h()},h(){m(t,"icon",Wt),m(t,"slot","start"),m(n,"class","ion-text-wrap")},m(g,h){Z(g,e,h),o(e,t),o(e,l),o(e,n),o(n,r),o(n,u),o(n,_),o(_,T)},p(g,h){h[0]&128&&ze(T,g[7])},d(g){g&&a(e)}}}function Zn(i){let e,t,l,n,r,d="Horarios",u,_,T=i[12].schedule+"",g;return{c(){e=s("ion-item"),t=s("ion-icon"),l=y(),n=s("ion-label"),r=s("p"),r.textContent=d,u=y(),_=s("h2"),g=he(T),this.h()},l(h){e=c(h,"ION-ITEM",{});var f=p(e);t=c(f,"ION-ICON",{icon:!0,slot:!0}),p(t).forEach(a),l=w(f),n=c(f,"ION-LABEL",{});var v=p(n);r=c(v,"P",{"data-svelte-h":!0}),ne(r)!=="svelte-11q7hm5"&&(r.textContent=d),u=w(v),_=c(v,"H2",{});var E=p(_);g=pe(E,T),E.forEach(a),v.forEach(a),f.forEach(a),this.h()},h(){m(t,"icon",mn),m(t,"slot","start")},m(h,f){Z(h,e,f),o(e,t),o(e,l),o(e,n),o(n,r),o(n,u),o(n,_),o(_,g)},p:Ae,d(h){h&&a(e)}}}function xn(i){let e,t,l,n,r,d="Notas del operador",u,_,T=i[12].driver_comments+"",g;return{c(){e=s("ion-item"),t=s("ion-icon"),l=y(),n=s("ion-label"),r=s("p"),r.textContent=d,u=y(),_=s("h2"),g=he(T),this.h()},l(h){e=c(h,"ION-ITEM",{});var f=p(e);t=c(f,"ION-ICON",{icon:!0,slot:!0}),p(t).forEach(a),l=w(f),n=c(f,"ION-LABEL",{});var v=p(n);r=c(v,"P",{"data-svelte-h":!0}),ne(r)!=="svelte-1yk9qp4"&&(r.textContent=d),u=w(v),_=c(v,"H2",{});var E=p(_);g=pe(E,T),E.forEach(a),v.forEach(a),f.forEach(a),this.h()},h(){m(t,"icon",Jt),m(t,"slot","start")},m(h,f){Z(h,e,f),o(e,t),o(e,l),o(e,n),o(n,r),o(n,u),o(n,_),o(_,g)},p:Ae,d(h){h&&a(e)}}}function $n(i){let e,t=i[12].logistic_comments!="<br>"&&eo(i);return{c(){t&&t.c(),e=Me()},l(l){t&&t.l(l),e=Me()},m(l,n){t&&t.m(l,n),Z(l,e,n)},p(l,n){l[12].logistic_comments!="<br>"&&t.p(l,n)},d(l){l&&a(e),t&&t.d(l)}}}function eo(i){let e,t,l,n,r,d="Comentarios logísticos",u,_,T=i[12].logistic_comments+"",g;return{c(){e=s("ion-item"),t=s("ion-icon"),l=y(),n=s("ion-label"),r=s("p"),r.textContent=d,u=y(),_=s("h2"),g=he(T),this.h()},l(h){e=c(h,"ION-ITEM",{});var f=p(e);t=c(f,"ION-ICON",{icon:!0,slot:!0}),p(t).forEach(a),l=w(f),n=c(f,"ION-LABEL",{class:!0});var v=p(n);r=c(v,"P",{"data-svelte-h":!0}),ne(r)!=="svelte-1iz85r6"&&(r.textContent=d),u=w(v),_=c(v,"H2",{});var E=p(_);g=pe(E,T),E.forEach(a),v.forEach(a),f.forEach(a),this.h()},h(){m(t,"icon",Wt),m(t,"slot","start"),m(n,"class","ion-text-wrap")},m(h,f){Z(h,e,f),o(e,t),o(e,l),o(e,n),o(n,r),o(n,u),o(n,_),o(_,g)},p:Ae,d(h){h&&a(e)}}}function to(i){let e,t,l,n,r,d="Estado de entrega",u,_,T="Entregado",g,h,f="No Entregado",v,E,N="Entrega Parcial",C,L,S,j,X,F,A,H,I=i[4]===!0&&Ot(i),M=(i[5]===!0||i[5]===!1&&i[4]===!1)&&Nt(i);return{c(){e=s("ion-item"),t=s("ion-icon"),l=y(),n=s("ion-select"),r=s("div"),r.textContent=d,u=y(),_=s("ion-select-option"),_.textContent=T,g=y(),h=s("ion-select-option"),h.textContent=f,v=y(),E=s("ion-select-option"),E.textContent=N,C=y(),L=s("ion-item"),S=s("ion-icon"),j=y(),X=s("ion-textarea"),F=y(),A=s("section"),I&&I.c(),H=y(),M&&M.c(),this.h()},l(P){e=c(P,"ION-ITEM",{});var B=p(e);t=c(B,"ION-ICON",{icon:!0,slot:!0}),p(t).forEach(a),l=w(B),n=c(B,"ION-SELECT",{value:!0});var R=p(n);r=c(R,"DIV",{slot:!0,"data-svelte-h":!0}),ne(r)!=="svelte-1635zca"&&(r.textContent=d),u=w(R),_=c(R,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),ne(_)!=="svelte-s33eln"&&(_.textContent=T),g=w(R),h=c(R,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),ne(h)!=="svelte-1a859l3"&&(h.textContent=f),v=w(R),E=c(R,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),ne(E)!=="svelte-1c4dcm8"&&(E.textContent=N),R.forEach(a),B.forEach(a),C=w(P),L=c(P,"ION-ITEM",{});var q=p(L);S=c(q,"ION-ICON",{icon:!0,slot:!0}),p(S).forEach(a),j=w(q),X=c(q,"ION-TEXTAREA",{label:!0,placeholder:!0}),p(X).forEach(a),q.forEach(a),F=w(P),A=c(P,"SECTION",{style:!0});var G=p(A);I&&I.l(G),H=w(G),M&&M.l(G),G.forEach(a),this.h()},h(){m(t,"icon",vn),m(t,"slot","start"),Y(r,"slot","label"),m(_,"value","delivered"),m(h,"value","notdelivered"),m(E,"value","partialdeliver"),m(n,"value",i[15]?i[15]:"delivered"),m(S,"icon",ut),m(S,"slot","start"),m(X,"label","Notas"),m(X,"placeholder","Escribe aquí..."),k(A,"display","flex"),k(A,"gap","8px"),k(A,"padding","16px 16px 6px")},m(P,B){Z(P,e,B),o(e,t),o(e,l),o(e,n),o(n,r),o(n,u),o(n,_),o(n,g),o(n,h),o(n,v),o(n,E),i[29](n),Z(P,C,B),Z(P,L,B),o(L,S),o(L,j),o(L,X),i[30](X),Z(P,F,B),Z(P,A,B),I&&I.m(A,null),o(A,H),M&&M.m(A,null)},p(P,B){P[4]===!0?I?I.p(P,B):(I=Ot(P),I.c(),I.m(A,H)):I&&(I.d(1),I=null),P[5]===!0||P[5]===!1&&P[4]===!1?M?M.p(P,B):(M=Nt(P),M.c(),M.m(A,null)):M&&(M.d(1),M=null)},d(P){P&&(a(e),a(C),a(L),a(F),a(A)),i[29](null),i[30](null),I&&I.d(),M&&M.d()}}}function Ot(i){let e,t=`<ion-icon icon="${En}" slot="start"></ion-icon>
                        Ingreso`,l,n;return{c(){e=s("ion-button"),e.innerHTML=t,this.h()},l(r){e=c(r,"ION-BUTTON",{id:!0,style:!0,"data-svelte-h":!0}),ne(e)!=="svelte-3onvnr"&&(e.innerHTML=t),this.h()},h(){m(e,"id","checkInBtn"),k(e,"flex","1")},m(r,d){Z(r,e,d),l||(n=ce(e,"click",i[23]),l=!0)},p:Ae,d(r){r&&a(e),l=!1,n()}}}function Nt(i){let e,t,l,n,r,d;return{c(){e=s("ion-button"),t=s("ion-icon"),l=he(`
                        Salida`),this.h()},l(u){e=c(u,"ION-BUTTON",{id:!0,style:!0,disabled:!0});var _=p(e);t=c(_,"ION-ICON",{icon:!0,slot:!0}),p(t).forEach(a),l=pe(_,`
                        Salida`),_.forEach(a),this.h()},h(){m(t,"icon",gn),m(t,"slot","start"),m(e,"id","checkOutBtn"),k(e,"flex","1"),m(e,"disabled",n=i[5]===!1)},m(u,_){Z(u,e,_),o(e,t),o(e,l),r||(d=ce(e,"click",i[24]),r=!0)},p(u,_){_[0]&32&&n!==(n=u[5]===!1)&&m(e,"disabled",n)},d(u){u&&a(e),r=!1,d()}}}function no(i){let e,t,l,n,r,d="Subir Evidencia",u,_,T,g;return{c(){e=s("section"),t=s("ion-button"),l=s("ion-icon"),n=y(),r=s("label"),r.textContent=d,u=y(),_=s("input"),this.h()},l(h){e=c(h,"SECTION",{style:!0});var f=p(e);t=c(f,"ION-BUTTON",{fill:!0,class:!0,style:!0});var v=p(t);l=c(v,"ION-ICON",{icon:!0,slot:!0}),p(l).forEach(a),n=w(v),r=c(v,"LABEL",{for:!0,"data-svelte-h":!0}),ne(r)!=="svelte-1wg51s6"&&(r.textContent=d),u=w(v),_=c(v,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0,capture:!0}),v.forEach(a),f.forEach(a),this.h()},h(){m(l,"icon",Yt),m(l,"slot","start"),Y(r,"for","eventEvidence"),k(_,"display","none"),Y(_,"id","eventEvidence"),Y(_,"name","fileToUpload"),Y(_,"type","file"),_.multiple=!0,Y(_,"accept","image/*"),Y(_,"capture","environment"),m(t,"fill","outline"),m(t,"class","loadEvidence"),k(t,"flex","1"),k(e,"display","flex"),k(e,"gap","8px"),k(e,"padding","0px 16px")},m(h,f){Z(h,e,f),o(e,t),o(t,l),o(t,n),o(t,r),o(t,u),o(t,_),T||(g=[ce(_,"change",i[17]),ce(_,"click",i[18])],T=!0)},p:Ae,d(h){h&&a(e),T=!1,Be(g)}}}function Tt(i){let e,t,l=Ue(i[2]),n=[];for(let r=0;r<l.length;r+=1)n[r]=Ct(Et(i,l,r));return{c(){e=s("section"),t=s("div");for(let r=0;r<n.length;r+=1)n[r].c();this.h()},l(r){e=c(r,"SECTION",{});var d=p(e);t=c(d,"DIV",{class:!0,style:!0});var u=p(t);for(let _=0;_<n.length;_+=1)n[_].l(u);u.forEach(a),d.forEach(a),this.h()},h(){Y(t,"class","image-grid"),k(t,"display","grid"),k(t,"grid-template-columns","repeat(auto-fill, minmax(100px, 1fr))"),k(t,"gap","10px"),k(t,"padding","0px 10px")},m(r,d){Z(r,e,d),o(e,t);for(let u=0;u<n.length;u+=1)n[u]&&n[u].m(t,null)},p(r,d){if(d[0]&34603012){l=Ue(r[2]);let u;for(u=0;u<l.length;u+=1){const _=Et(r,l,u);n[u]?n[u].p(_,d):(n[u]=Ct(_),n[u].c(),n[u].m(t,null))}for(;u<n.length;u+=1)n[u].d(1);n.length=l.length}},d(r){r&&a(e),en(n,r)}}}function Ct(i){let e,t,l,n,r,d=`<ion-icon icon="${In}"></ion-icon>`,u,_,T;function g(){return i[31](i[51])}function h(){return i[32](i[53])}return{c(){e=s("div"),t=s("ion-img"),n=y(),r=s("button"),r.innerHTML=d,u=y(),this.h()},l(f){e=c(f,"DIV",{class:!0,style:!0});var v=p(e);t=c(v,"ION-IMG",{src:!0,alt:!0,style:!0}),p(t).forEach(a),n=w(v),r=c(v,"BUTTON",{class:!0,style:!0,"data-svelte-h":!0}),ne(r)!=="svelte-zguiov"&&(r.innerHTML=d),u=w(v),v.forEach(a),this.h()},h(){We(t.src,l=i[51])||m(t,"src",l),m(t,"alt","Evidencia fotográfica"),k(t,"width","100%"),k(t,"height","100px"),k(t,"object-fit","cover"),k(t,"cursor","pointer"),k(t,"border","1px solid #ccc"),k(t,"border-radius","4px"),k(t,"margin-top","16px"),Y(r,"class","remove-button"),k(r,"position","absolute"),k(r,"top","5px"),k(r,"right","5px"),k(r,"border","none"),k(r,"cursor","pointer"),k(r,"font-size","18px"),k(r,"background","white"),k(r,"border-radius","50%"),k(r,"padding","3px 4px 0px"),k(r,"box-shadow","2px 2px 6px rgba(0, 0, 0, 0.3)"),k(r,"color","#0000008f"),Y(e,"class","image-container"),k(e,"position","relative")},m(f,v){Z(f,e,v),o(e,t),o(e,n),o(e,r),o(e,u),_||(T=[ce(t,"click",g),ce(r,"click",h)],_=!0)},p(f,v){i=f,v[0]&4&&!We(t.src,l=i[51])&&m(t,"src",l)},d(f){f&&a(e),_=!1,Be(T)}}}function yt(i){let e,t='<ion-spinner name="dots" style="color:white;"></ion-spinner>';return{c(){e=s("div"),e.innerHTML=t,this.h()},l(l){e=c(l,"DIV",{class:!0,style:!0,"data-svelte-h":!0}),ne(e)!=="svelte-h8s7r2"&&(e.innerHTML=t),this.h()},h(){Y(e,"class","overlay"),k(e,"position","fixed"),k(e,"top","0"),k(e,"left","0"),k(e,"width","100vw"),k(e,"height","100vh"),k(e,"background","rgba(0, 0, 0, 0.5)"),k(e,"display","flex"),k(e,"align-items","center"),k(e,"justify-content","center"),k(e,"z-index","9999")},m(l,n){Z(l,e,n)},d(l){l&&a(e)}}}function wt(i){let e,t,l,n,r,d,u=`<ion-icon icon="${kn}"></ion-icon>`,_,T;return{c(){e=s("div"),t=s("div"),l=s("ion-img"),r=y(),d=s("button"),d.innerHTML=u,this.h()},l(g){e=c(g,"DIV",{class:!0,style:!0});var h=p(e);t=c(h,"DIV",{class:!0,style:!0});var f=p(t);l=c(f,"ION-IMG",{src:!0,alt:!0,style:!0}),p(l).forEach(a),r=w(f),d=c(f,"BUTTON",{class:!0,style:!0,"data-svelte-h":!0}),ne(d)!=="svelte-g0qr0o"&&(d.innerHTML=u),f.forEach(a),h.forEach(a),this.h()},h(){We(l.src,n=i[10])||m(l,"src",n),m(l,"alt","Evidencia fotográfica"),k(l,"width","100%"),k(l,"height","auto"),Y(d,"class","close-button"),k(d,"position","absolute"),k(d,"top","5px"),k(d,"right","5px"),k(d,"background","white"),k(d,"color","#444444d1"),k(d,"border","none"),k(d,"cursor","pointer"),k(d,"padding","2px 2px 0px 6px"),k(d,"border-radius","50%"),k(d,"font-size","20px"),Y(t,"class","modal-content"),k(t,"position","relative"),k(t,"background","white"),k(t,"padding","20px"),k(t,"border-radius","8px"),k(t,"max-width","90vw"),k(t,"max-height","90vh"),k(t,"overflow","auto"),Y(e,"class","modal-overlay"),k(e,"position","fixed"),k(e,"top","0"),k(e,"left","0"),k(e,"width","100vw"),k(e,"height","100vh"),k(e,"background","rgba(0, 0, 0, 0.8)"),k(e,"display","flex"),k(e,"justify-content","center"),k(e,"align-items","center"),k(e,"z-index","1000")},m(g,h){Z(g,e,h),o(e,t),o(t,l),o(t,r),o(t,d),_||(T=[ce(d,"click",i[26]),ce(t,"click",tn(i[27])),ce(e,"click",i[26])],_=!0)},p(g,h){h[0]&1024&&!We(l.src,n=g[10])&&m(l,"src",n)},d(g){g&&a(e),_=!1,Be(T)}}}function oo(i){let e,t,l,n,r="Cerrar",d,u,_=i[12].title+"",T,g,h,f=(i[12].tag?i[12].tag:"")+"",v,E,N,C,L,S,j,X,F,A,H="Negocio",I,M,P=i[12].client_name+"",B,R,q=i[12].client_phone&&i[12].client_phone.trim().length,G,ee,le,oe,de=i[12].schedule&&i[12].schedule.trim().length,se,re,ye=i[12].logistic_comments&&i[12].logistic_comments.trim().length,be,_e,ke,Oe,Ie,Ne,me,Te,Le,ve=(!i[13]&&!i[14]||i[13]&&i[14])&&Kn(i),ue=q&&Xn(i);function ie(U,te){if(U[12].line1&&U[12].line1.trim().length)return Jn;if(U[12].line2&&U[12].line2.trim().length)return Wn}let ae=ie(i),$=ae&&ae(i),b=i[6]&&It(i),D=i[7]&&i[7]!=="<br>"&&kt(i),O=de&&Zn(i),V=i[12].driver_comments&&xn(i),W=ye&&$n(i),J=!i[14]&&to(i),z=(i[13]&&i[14]||!i[13]&&!i[14])&&no(i),K=i[1]&&Tt(i),x=i[3]&&yt(),Q=i[9]&&wt(i);return{c(){e=s("ion-header"),t=s("ion-toolbar"),l=s("ion-buttons"),n=s("ion-button"),n.textContent=r,d=y(),u=s("ion-title"),T=he(_),g=y(),h=s("div"),v=he(f),E=y(),ve&&ve.c(),N=y(),C=s("ion-content"),L=s("ion-list"),S=s("ion-item"),j=s("ion-icon"),X=y(),F=s("ion-label"),A=s("p"),A.textContent=H,I=y(),M=s("h2"),B=he(P),R=y(),ue&&ue.c(),G=y(),$&&$.c(),ee=y(),b&&b.c(),le=y(),D&&D.c(),oe=y(),O&&O.c(),se=y(),V&&V.c(),re=y(),W&&W.c(),be=y(),_e=y(),J&&J.c(),ke=y(),z&&z.c(),Oe=y(),K&&K.c(),Ie=y(),x&&x.c(),Ne=y(),Q&&Q.c(),me=Me(),this.h()},l(U){e=c(U,"ION-HEADER",{translucent:!0});var te=p(e);t=c(te,"ION-TOOLBAR",{});var Ee=p(t);l=c(Ee,"ION-BUTTONS",{slot:!0});var Ce=p(l);n=c(Ce,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),ne(n)!=="svelte-2ks32x"&&(n.textContent=r),Ce.forEach(a),d=w(Ee),u=c(Ee,"ION-TITLE",{style:!0,title:!0});var ge=p(u);T=pe(ge,_),ge.forEach(a),g=w(Ee),h=c(Ee,"DIV",{class:!0,style:!0});var fe=p(h);v=pe(fe,f),fe.forEach(a),E=w(Ee),ve&&ve.l(Ee),Ee.forEach(a),te.forEach(a),N=w(U),C=c(U,"ION-CONTENT",{fullscreen:!0});var Pe=p(C);L=c(Pe,"ION-LIST",{});var we=p(L);S=c(we,"ION-ITEM",{});var Fe=p(S);j=c(Fe,"ION-ICON",{icon:!0,slot:!0}),p(j).forEach(a),X=w(Fe),F=c(Fe,"ION-LABEL",{});var Re=p(F);A=c(Re,"P",{"data-svelte-h":!0}),ne(A)!=="svelte-57b1dg"&&(A.textContent=H),I=w(Re),M=c(Re,"H2",{});var qe=p(M);B=pe(qe,P),qe.forEach(a),Re.forEach(a),Fe.forEach(a),R=w(we),ue&&ue.l(we),G=w(we),$&&$.l(we),ee=w(we),b&&b.l(we),le=w(we),D&&D.l(we),oe=w(we),O&&O.l(we),se=w(we),V&&V.l(we),re=w(we),W&&W.l(we),be=w(we),_e=w(we),J&&J.l(we),ke=w(we),z&&z.l(we),Oe=w(we),K&&K.l(we),we.forEach(a),Pe.forEach(a),Ie=w(U),x&&x.l(U),Ne=w(U),Q&&Q.l(U),me=Me(),this.h()},h(){m(n,"color","medium"),m(l,"slot","start"),k(u,"text-align","center"),m(u,"title",i[12].title),Y(h,"class","stop-tag"),k(h,"background-color",i[12].tag_color?i[12].tag_color:""),k(h,"color","white"),k(h,"text-align","center"),k(h,"width","45%"),k(h,"border-radius","20px"),k(h,"left","50%"),k(h,"position","relative"),k(h,"transform","translateX(-50%)"),k(h,"white-space","normal"),m(e,"translucent",""),m(j,"icon",_n),m(j,"slot","start"),m(C,"fullscreen","")},m(U,te){Z(U,e,te),o(e,t),o(t,l),o(l,n),o(t,d),o(t,u),o(u,T),o(t,g),o(t,h),o(h,v),o(t,E),ve&&ve.m(t,null),Z(U,N,te),Z(U,C,te),o(C,L),o(L,S),o(S,j),o(S,X),o(S,F),o(F,A),o(F,I),o(F,M),o(M,B),o(L,R),ue&&ue.m(L,null),o(L,G),$&&$.m(L,null),o(L,ee),b&&b.m(L,null),o(L,le),D&&D.m(L,null),o(L,oe),O&&O.m(L,null),o(L,se),V&&V.m(L,null),o(L,re),W&&W.m(L,null),o(L,be),o(L,_e),J&&J.m(L,null),o(L,ke),z&&z.m(L,null),o(L,Oe),K&&K.m(L,null),Z(U,Ie,te),x&&x.m(U,te),Z(U,Ne,te),Q&&Q.m(U,te),Z(U,me,te),Te||(Le=ce(n,"click",i[19]),Te=!0)},p(U,te){(!U[13]&&!U[14]||U[13]&&U[14])&&ve.p(U,te),q&&ue.p(U,te),$&&$.p(U,te),U[6]?b?b.p(U,te):(b=It(U),b.c(),b.m(L,le)):b&&(b.d(1),b=null),U[7]&&U[7]!=="<br>"?D?D.p(U,te):(D=kt(U),D.c(),D.m(L,oe)):D&&(D.d(1),D=null),de&&O.p(U,te),U[12].driver_comments&&V.p(U,te),ye&&W.p(U,te),U[14]||J.p(U,te),(U[13]&&U[14]||!U[13]&&!U[14])&&z.p(U,te),U[1]?K?K.p(U,te):(K=Tt(U),K.c(),K.m(L,null)):K&&(K.d(1),K=null),U[3]?x||(x=yt(),x.c(),x.m(Ne.parentNode,Ne)):x&&(x.d(1),x=null),U[9]?Q?Q.p(U,te):(Q=wt(U),Q.c(),Q.m(me.parentNode,me)):Q&&(Q.d(1),Q=null)},i:Ae,o:Ae,d(U){U&&(a(e),a(N),a(C),a(Ie),a(Ne),a(me)),ve&&ve.d(),ue&&ue.d(),$&&$.d(),b&&b.d(),D&&D.d(),O&&O.d(),V&&V.d(),W&&W.d(),J&&J.d(),z&&z.d(),K&&K.d(),x&&x.d(U),Q&&Q.d(U),Te=!1,Le()}}}const Lt=/Teléfono:\s*(\d{10,})/;function lt(i=""){return i.split(",").map(t=>t.trim())}function lo(i,e,t){let l=rt,n=document.querySelector("ion-modal"),r=n.componentProps.delivery,d=n.componentProps.isLast||!1,u=n.componentProps.flag||!1,_=r.driver_comments?r.driver_comments:"",T=r.deliver_status?r.deliver_status:"",g=r.img?r.img:"",h=r.img_id?r.img_id:"",f=g?lt(g):new Array,v=h?lt(h):new Array,E={latitude:null,longitude:null},N=r.stopsApproval,C=r.smsActive,L=!1,S=!0,j=!1,X="",F=r.comments_ext,A="",H=!1,I="",M=new Object,P="";$e(()=>{M=JSON.parse(localStorage.getItem("userSession")),R()});async function B(O="",V,W={}){let J=new FormData;t(3,L=!0);for(const[z,K]of Object.entries(W))J.append(z,K);J=Le(J);try{const z=await fetch(O,{method:"POST",body:J});if(z.ok){const K=await z.json();V(K)}else console.error("Request failed:",z.statusText)}catch(z){console.error("Error during file upload:",z)}finally{t(3,L=!1)}}function R(){r.date_service?r.date_service&&!r.date_completed&&!r.service_time?(t(4,S=!1),t(5,j=!0)):r.date_service&&r.date_completed&&r.service_time&&(t(4,S=!1),t(5,j=!1)):(t(4,S=!0),t(5,j=!1))}if(r.comments_ext){const O=r.comments_ext.match(Lt);O&&(X=O[1],F=r.comments_ext.replace(Lt,"").trim())}const q=async(O,V)=>{await(await Ke.create({header:O||"Error",message:V||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()},G=async(O="",V="",W="",J,z={})=>{await(await Ke.create({header:O||"Error",message:V||"Vuelva a intentar",buttons:[{text:"No",role:"cancel",handler:()=>{}},{text:"Sí",handler:()=>{B(W,J,z)}}]})).present()},ee=async O=>{if(f.length>=5){q("Límite de evidencias","Solo se permite subir 5 fotos por parada");return}if(u&&d&&f.length>=1){q("Límite de evidencias","Para el final de la ruta solo se permite subir 1 foto");return}const W=O.target.files[0];if(W)try{t(3,L=!0);const J=await de(W);if(J){const z=new FormData;z.append("fileToUpload",J),fetch(`${l}api/admin/manager/upload_img_driver.php`,{method:"POST",body:z}).then(K=>K.json()).then(K=>{t(1,g=g?`${g},${K.img}`:K.img),h=h?`${h},${K.img_id}`:K.img_id,t(2,f=lt(g)),v=lt(h)}).catch(K=>console.error("Upload error:",K))}}catch(J){console.error("Compression error:",J)}finally{t(3,L=!1)}};function le(O){var V=r.service_time;!V&&S&&!d&&!u&&(O.preventDefault(),q("Registrar Ingreso","Antes de subir la evidencia registra el ingreso a la actual parada."))}function oe(){var O=u?r.date_completed:!1;if(!O&&!S&&j&&!d&&!u){var V=new Object;V.id_event=r.id_event,V.type="checkout",G("Registrar Salida","¿Completaste tu entrega?",l+"api/admin/route/record_check_date.php",function(W){W.minutes&&q("Tiempo por parada","Completaste la parada en "+W.minutes+" minutos.")},V)}}const de=async O=>new Promise(V=>{const W=new Image;W.src=URL.createObjectURL(O),W.onload=()=>{const J=document.createElement("canvas"),z=J.getContext("2d"),K=800,x=600;let Q=W.width,U=W.height;Q>K&&(U*=K/Q,Q=K),U>x&&(Q*=x/U,U=x),J.width=Q,J.height=U,z.drawImage(W,0,0,Q,U),J.toBlob(te=>{V(te),URL.revokeObjectURL(W.src),z.clearRect(0,0,J.width,J.height)},"image/jpeg",.7)}}),se=()=>{n.dismiss({data:Date.now()})};function re(O){t(2,f=f.filter((V,W)=>W!==O))}const ye=async()=>{try{if(t(3,L=!0),t(1,g=f.join(",")),h=v.join(","),oe(),await _e())if(P.value=="delivered"||P.value!=="delivered"&&(_.value||r.driver_comments)||u&&d){const V={id_route:r.id_route,...!u&&!d&&{id_event:r.id_event},...!u&&!d&&{comments:_.value},...!u&&!d&&{deliver_status:P.value},img:g,img_id:h,lat:E.latitude,lon:E.longitude,...N==="0"&&{approve:"0"},...d&&{isLast:!0},...u&&d&&{destiny:!0}};V.img&&V.img_id||g?B(`${l}api/admin/evidence/send_evidence.php`,function(W){if(W.success==!0){const J=V.id_route;se(),d&&(be("","",J,d),N=="0"&&ve(J,"completed"))}else q("Carga fallida","Actualiza la página y vuelve a intentar cargar la información!")},V):q("Información incompleta","Cargar evidencia fotográfica faltante para completar parada.")}else q("Motivo de status de entrega","Favor de ingresar en notas el motivo por el que la entrega no fue entregada correctamente");else q("Ubicación faltante","Asegúrate darle permisos a Rutaflow para acceder a tu ubicación")}catch(O){console.error("Error fetching data:",O)}finally{t(3,L=!1)}},be=(O,V,W,J)=>{n.componentProps.routeId=W,n.componentProps.driverId=r.id_driver,je("modal-km-gas",Zt,{checklist:O,driverId:V,routeId:W,isLast:J}).then(z=>{})},_e=async()=>navigator.geolocation?new Promise((O,V)=>{navigator.geolocation.getCurrentPosition(W=>{E.latitude=W.coords.latitude,E.longitude=W.coords.longitude,O(!0)},W=>{console.error("Error getting location:",W),O(!1)})}):(console.error("Geolocation is not supported by your browser"),!1);async function ke(O){O.stopPropagation();let V=new FormData;V.append("client_phone",X),V.append("client_name",r.title),V.append("delivery_phone",r.client_phone),V.append("enterprise_name",r.enterprise_name),V=Le(V);try{const W=await fetch(`${l}api/admin/message_central/send_sms.php`,{method:"POST",body:V});if(W.ok){const J=await W.json();q("SMS enviado","Se envío correctamente un SMS a "+r.title+" con número de teléfono: "+X)}else q("SMS no enviado","Hubo un error al enviar SMS a "+r.title+" con número de teléfono: "+phoneNumber0+". Por favor contacte a soporte.")}catch(W){console.error("Error during file upload:",W)}}function Oe(){t(4,S=!1),t(5,j=!0),Ne(r.id_event,"checkin")}function Ie(){t(5,j=!1),t(4,S=!1),Ne(r.id_event,"checkout")}async function Ne(O,V){if(V){let W=new FormData;W.append("type",V),W.append("id_event",O),W=Le(W);try{const J=await fetch(`${l}api/admin/route/record_check_date.php`,{method:"POST",body:W});if(J.ok){const z=await J.json();z.minutes&&q("Tiempo por parada","Completaste la parada en "+z.minutes+" minutos.")}else console.error("File upload failed:",J.statusText)}catch(J){console.error("Error during file upload:",J)}finally{}}}const me=O=>{t(10,I=O),t(9,H=!0)},Te=()=>{t(9,H=!1),t(10,I="")};function Le(O){return O.append("token",M.token),O.append("id_user_over",M.id_user),O}function ve(O,V){let W=new FormData;return W.append("id_route",O),W.append("status",V),W=Le(W),fetch(`${l}api/admin/route/change_status.php`,{method:"POST",body:W}).then(J=>J.json()).then(J=>{}).catch(J=>{console.error("Error fetching data:",J)}),""}function ue(O){nn.call(this,i,O)}function ie(O){De[O?"unshift":"push"](()=>{A=O,t(8,A)})}function ae(O){De[O?"unshift":"push"](()=>{P=O,t(11,P)})}function $(O){De[O?"unshift":"push"](()=>{_=O,t(0,_)})}return[_,g,f,L,S,j,X,F,A,H,I,P,r,d,u,T,C,ee,le,se,re,ye,ke,Oe,Ie,me,Te,ue,ie,ae,$,O=>me(O),O=>re(O)]}class zt extends Qe{constructor(e){super(),Ze(this,e,lo,oo,Ye,{},null,[-1,-1])}}function At(i){let e,t,l;return{c(){e=s("section"),t=s("ion-img"),this.h()},l(n){e=c(n,"SECTION",{});var r=p(e);t=c(r,"ION-IMG",{src:!0,alt:!0,style:!0}),p(t).forEach(a),r.forEach(a),this.h()},h(){We(t.src,l=i[0])||m(t,"src",l),m(t,"alt","Evidencia fotográfica"),k(t,"max-width","100%"),k(t,"margin-top","16px")},m(n,r){Z(n,e,r),o(e,t)},p(n,r){r&1&&!We(t.src,l=n[0])&&m(t,"src",l)},d(n){n&&a(e)}}}function St(i){let e,t='<ion-spinner name="dots" style="color:white;"></ion-spinner>';return{c(){e=s("div"),e.innerHTML=t,this.h()},l(l){e=c(l,"DIV",{class:!0,style:!0,"data-svelte-h":!0}),ne(e)!=="svelte-h8s7r2"&&(e.innerHTML=t),this.h()},h(){Y(e,"class","overlay"),k(e,"position","fixed"),k(e,"top","0"),k(e,"left","0"),k(e,"width","100vw"),k(e,"height","100vh"),k(e,"background","rgba(0, 0, 0, 0.5)"),k(e,"display","flex"),k(e,"align-items","center"),k(e,"justify-content","center"),k(e,"z-index","9999")},m(l,n){Z(l,e,n)},d(l){l&&a(e)}}}function io(i){let e,t,l,n,r="Cancelar",d,u,_="AGREGAR GASTO",T,g,h,f="Confirmar",v,E,N,C,L,S,j,X,F,A,H,I,M,P,B,R,q,G,ee='Tipo de pago <ion-text color="danger">(Obligatorio)</ion-text>',le,oe,de="Efectivo",se,re,ye="Tarjeta",be,_e,ke="Transferencia",Oe,Ie,Ne,me,Te,Le,ve,ue,ie,ae,$=`<ion-icon icon="${Yt}" slot="start"></ion-icon>
                        Subir Evidencia`,b,D,O,V,W,J,z,K=i[0]&&At(i),x=i[5]&&St();return{c(){e=s("ion-header"),t=s("ion-toolbar"),l=s("ion-buttons"),n=s("ion-button"),n.textContent=r,d=y(),u=s("ion-title"),u.textContent=_,T=y(),g=s("ion-buttons"),h=s("ion-button"),h.textContent=f,v=y(),E=s("ion-content"),N=s("ion-list"),C=s("ion-item"),L=s("ion-icon"),S=y(),j=s("ion-input"),X=y(),F=s("ion-item"),A=s("ion-icon"),H=y(),I=s("ion-input"),M=y(),P=s("ion-item"),B=s("ion-icon"),R=y(),q=s("ion-select"),G=s("div"),G.innerHTML=ee,le=y(),oe=s("ion-select-option"),oe.textContent=de,se=y(),re=s("ion-select-option"),re.textContent=ye,be=y(),_e=s("ion-select-option"),_e.textContent=ke,Oe=y(),Ie=s("ion-item"),Ne=s("ion-icon"),me=y(),Te=s("ion-textarea"),Le=y(),ve=s("section"),ue=s("label"),ie=s("ion-button"),ae=s("label"),ae.innerHTML=$,b=y(),D=s("input"),O=y(),K&&K.c(),V=y(),x&&x.c(),W=Me(),this.h()},l(Q){e=c(Q,"ION-HEADER",{translucent:!0});var U=p(e);t=c(U,"ION-TOOLBAR",{});var te=p(t);l=c(te,"ION-BUTTONS",{slot:!0});var Ee=p(l);n=c(Ee,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),ne(n)!=="svelte-1f8rjcf"&&(n.textContent=r),Ee.forEach(a),d=w(te),u=c(te,"ION-TITLE",{title:!0,"data-svelte-h":!0}),ne(u)!=="svelte-efps2s"&&(u.textContent=_),T=w(te),g=c(te,"ION-BUTTONS",{slot:!0});var Ce=p(g);h=c(Ce,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),ne(h)!=="svelte-k5zoz0"&&(h.textContent=f),Ce.forEach(a),te.forEach(a),U.forEach(a),v=w(Q),E=c(Q,"ION-CONTENT",{fullscreen:!0});var ge=p(E);N=c(ge,"ION-LIST",{});var fe=p(N);C=c(fe,"ION-ITEM",{});var Pe=p(C);L=c(Pe,"ION-ICON",{icon:!0,slot:!0}),p(L).forEach(a),S=w(Pe),j=c(Pe,"ION-INPUT",{label:!0,type:!0,placeholder:!0,value:!0}),p(j).forEach(a),Pe.forEach(a),X=w(fe),F=c(fe,"ION-ITEM",{});var we=p(F);A=c(we,"ION-ICON",{icon:!0,slot:!0}),p(A).forEach(a),H=w(we),I=c(we,"ION-INPUT",{label:!0,type:!0,value:!0}),p(I).forEach(a),we.forEach(a),M=w(fe),P=c(fe,"ION-ITEM",{});var Fe=p(P);B=c(Fe,"ION-ICON",{icon:!0,slot:!0}),p(B).forEach(a),R=w(Fe),q=c(Fe,"ION-SELECT",{placeholder:!0,value:!0});var Re=p(q);G=c(Re,"DIV",{slot:!0,"data-svelte-h":!0}),ne(G)!=="svelte-wl764p"&&(G.innerHTML=ee),le=w(Re),oe=c(Re,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),ne(oe)!=="svelte-i9crym"&&(oe.textContent=de),se=w(Re),re=c(Re,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),ne(re)!=="svelte-fx0z11"&&(re.textContent=ye),be=w(Re),_e=c(Re,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),ne(_e)!=="svelte-1c24jf2"&&(_e.textContent=ke),Re.forEach(a),Fe.forEach(a),Oe=w(fe),Ie=c(fe,"ION-ITEM",{});var qe=p(Ie);Ne=c(qe,"ION-ICON",{icon:!0,slot:!0}),p(Ne).forEach(a),me=w(qe),Te=c(qe,"ION-TEXTAREA",{label:!0,placeholder:!0}),p(Te).forEach(a),qe.forEach(a),Le=w(fe),ve=c(fe,"SECTION",{});var mt=p(ve);ue=c(mt,"LABEL",{for:!0,style:!0});var vt=p(ue);ie=c(vt,"ION-BUTTON",{fill:!0,size:!0,class:!0,expand:!0});var ot=p(ie);ae=c(ot,"LABEL",{for:!0,style:!0,"data-svelte-h":!0}),ne(ae)!=="svelte-1m9yw22"&&(ae.innerHTML=$),b=w(ot),D=c(ot,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0,capture:!0}),ot.forEach(a),vt.forEach(a),mt.forEach(a),O=w(fe),K&&K.l(fe),fe.forEach(a),ge.forEach(a),V=w(Q),x&&x.l(Q),W=Me(),this.h()},h(){m(n,"color","medium"),m(l,"slot","start"),m(u,"title",""),m(h,"strong",""),m(g,"slot","end"),m(e,"translucent",""),m(L,"icon",Jt),m(L,"slot","start"),m(j,"label","Concepto"),m(j,"type","text"),m(j,"placeholder","Escribe aquí..."),m(j,"value",i[6]?i[6]:""),m(A,"icon",ut),m(A,"slot","start"),m(I,"label","Cantidad"),m(I,"type","number"),m(I,"value",i[7]?i[7]:""),m(B,"icon",On),m(B,"slot","start"),Y(G,"slot","label"),m(oe,"value","cash"),m(re,"value","card"),m(_e,"value","transfer"),m(q,"placeholder","Tipo de pago"),m(q,"value",i[8]?i[8]:""),m(Ne,"icon",ut),m(Ne,"slot","start"),m(Te,"label","Comentarios"),m(Te,"placeholder","Escribe aquí..."),Y(ae,"for","eventEvidence"),k(ae,"width","100%"),k(ae,"padding","8px"),k(D,"display","none"),Y(D,"id","eventEvidence"),Y(D,"name","fileToUpload"),Y(D,"type","file"),Y(D,"accept","image/*"),Y(D,"capture","environment"),m(ie,"fill","outline"),m(ie,"size","small"),m(ie,"class","loadEvidence"),m(ie,"expand","block"),Y(ue,"for","eventEvidence"),k(ue,"display","block"),k(ue,"width","100%"),m(E,"fullscreen","")},m(Q,U){Z(Q,e,U),o(e,t),o(t,l),o(l,n),o(t,d),o(t,u),o(t,T),o(t,g),o(g,h),Z(Q,v,U),Z(Q,E,U),o(E,N),o(N,C),o(C,L),o(C,S),o(C,j),i[12](j),o(N,X),o(N,F),o(F,A),o(F,H),o(F,I),i[13](I),o(N,M),o(N,P),o(P,B),o(P,R),o(P,q),o(q,G),o(q,le),o(q,oe),o(q,se),o(q,re),o(q,be),o(q,_e),i[14](q),o(N,Oe),o(N,Ie),o(Ie,Ne),o(Ie,me),o(Ie,Te),i[15](Te),o(N,Le),o(N,ve),o(ve,ue),o(ue,ie),o(ie,ae),o(ie,b),o(ie,D),o(N,O),K&&K.m(N,null),Z(Q,V,U),x&&x.m(Q,U),Z(Q,W,U),J||(z=[ce(n,"click",i[10]),ce(h,"click",i[11]),ce(D,"change",i[9])],J=!0)},p(Q,[U]){Q[0]?K?K.p(Q,U):(K=At(Q),K.c(),K.m(N,null)):K&&(K.d(1),K=null),Q[5]?x||(x=St(),x.c(),x.m(W.parentNode,W)):x&&(x.d(1),x=null)},i:Ae,o:Ae,d(Q){Q&&(a(e),a(v),a(E),a(V),a(W)),i[12](null),i[13](null),i[14](null),i[15](null),K&&K.d(),x&&x.d(Q),J=!1,Be(z)}}}function ro(i,e,t){let l=rt,n=document.querySelector("ion-modal"),r=n.componentProps.routeId,d=n.componentProps.ex_concept,u=n.componentProps.ex_amount,_=n.componentProps.ex_type,T=n.componentProps.id_expense,g="",h="",f="",v=0,E="",N="",C=!1,L=new Object;$e(()=>{L=JSON.parse(localStorage.getItem("userSession"))});const S=async(R,q)=>{await(await Ke.create({header:R||"Error",message:q||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()},j=async R=>{t(5,C=!0);const G=R.target.files[0],ee=await X(G);if(ee){let le=new FormData;le.append("fileToUpload",ee),le=H(le);try{const oe=await fetch(`${l}api/admin/manager/upload_img_driver.php`,{method:"POST",body:le});if(oe.ok){const de=await oe.json();t(0,g=de.img),h=de.img_id}else console.error("File upload failed:",oe.statusText)}catch(oe){console.error("Error during file upload:",oe)}finally{t(5,C=!1)}}},X=async R=>new Promise(q=>{const G=new Image;G.src=URL.createObjectURL(R),G.onload=()=>{const ee=document.createElement("canvas"),le=ee.getContext("2d"),oe=800,de=600;let se=G.width,re=G.height;se>oe&&(re*=oe/se,se=oe),re>de&&(se*=de/re,re=de),ee.width=se,ee.height=re,le.drawImage(G,0,0,se,re),ee.toBlob(ye=>{q(ye),URL.revokeObjectURL(G.src),le.clearRect(0,0,ee.width,ee.height)},"image/jpeg",.7)}}),F=()=>{nt.dismiss()},A=()=>{var R=new Object;R.id_route=r,R.comments=E.value,R.type=f.value,R.img=g,R.img_id=h,R.amount=v.value,R.concept=N.value,R.status="done",R.id_expense=T||"null";let q=new FormData;for(const G in R)q.append(G,R[G]);q=H(q),!h||!g||!E.value||!v.value||!N.value?S("Datos incompletos","Llena los datos requeridos para completar el registro"):fetch(`${l}api/admin/expenses/add_expense.php`,{method:"POST",body:q}).then(G=>G.json()).then(G=>{F()}).catch(G=>{console.error("Error fetching data:",G)})};function H(R){return R.append("token",L.token),R.append("id_user_over",L.id_user),R}function I(R){De[R?"unshift":"push"](()=>{N=R,t(4,N)})}function M(R){De[R?"unshift":"push"](()=>{v=R,t(2,v)})}function P(R){De[R?"unshift":"push"](()=>{f=R,t(1,f)})}function B(R){De[R?"unshift":"push"](()=>{E=R,t(3,E)})}return[g,f,v,E,N,C,d,u,_,j,F,A,I,M,P,B]}class dt extends Qe{constructor(e){super(),Ze(this,e,ro,io,Ye,{})}}function Mt(i,e,t){const l=i.slice();return l[7]=e[t],l}function ao(i){let e,t="Cargar gasto",l,n;function r(...d){return i[4](i[7],...d)}return{c(){e=s("ion-button"),e.textContent=t,this.h()},l(d){e=c(d,"ION-BUTTON",{fill:!0,size:!0,"aria-selected":!0,"data-svelte-h":!0}),ne(e)!=="svelte-175aelj"&&(e.textContent=t),this.h()},h(){m(e,"fill","outline"),m(e,"size","small"),m(e,"aria-selected","")},m(d,u){Z(d,e,u),l||(n=ce(e,"click",r),l=!0)},p(d,u){i=d},d(d){d&&a(e),l=!1,n()}}}function so(i){let e,t="Gasto completado";return{c(){e=s("ion-button"),e.textContent=t,this.h()},l(l){e=c(l,"ION-BUTTON",{fill:!0,size:!0,"aria-selected":!0,"data-svelte-h":!0}),ne(e)!=="svelte-tlger7"&&(e.textContent=t),this.h()},h(){m(e,"fill","solid"),m(e,"size","small"),m(e,"aria-selected","")},m(l,n){Z(l,e,n)},p:Ae,d(l){l&&a(e)}}}function Dt(i,e){let t,l,n,r=e[7].concept+"",d,u,_;function T(f,v){return f[7].status=="done"?so:ao}let h=T(e)(e);return{key:i,first:null,c(){t=s("ion-item"),l=s("ion-label"),n=s("p"),d=he(r),u=y(),h.c(),_=y(),this.h()},l(f){t=c(f,"ION-ITEM",{});var v=p(t);l=c(v,"ION-LABEL",{style:!0});var E=p(l);n=c(E,"P",{style:!0});var N=p(n);d=pe(N,r),N.forEach(a),E.forEach(a),u=w(v),h.l(v),_=w(v),v.forEach(a),this.h()},h(){k(n,"margin-left","10px"),k(l,"display","flex"),this.first=t},m(f,v){Z(f,t,v),o(t,l),o(l,n),o(n,d),o(t,u),h.m(t,null),o(t,_)},p(f,v){e=f,h.p(e,v)},d(f){f&&a(t),h.d()}}}function co(i){let e,t,l,n,r=`<ion-icon style="font-size: 25px!important;" icon="${Nn}"></ion-icon>`,d,u,_="LISTA DE GASTOS",T,g,h,f=[],v=new Map,E,N,C,L="Cerrar",S,j,X=Ue(i[0]);const F=A=>A[7].id_expenses;for(let A=0;A<X.length;A+=1){let H=Mt(i,X,A),I=F(H);v.set(I,f[A]=Dt(I,H))}return{c(){e=s("ion-header"),t=s("ion-toolbar"),l=s("ion-buttons"),n=s("ion-button"),n.innerHTML=r,d=y(),u=s("ion-title"),u.textContent=_,T=y(),g=s("ion-content"),h=s("ion-list");for(let A=0;A<f.length;A+=1)f[A].c();E=y(),N=s("ion-footer"),C=s("ion-button"),C.textContent=L,this.h()},l(A){e=c(A,"ION-HEADER",{translucent:!0});var H=p(e);t=c(H,"ION-TOOLBAR",{});var I=p(t);l=c(I,"ION-BUTTONS",{slot:!0});var M=p(l);n=c(M,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),ne(n)!=="svelte-160xz3i"&&(n.innerHTML=r),M.forEach(a),d=w(I),u=c(I,"ION-TITLE",{"data-svelte-h":!0}),ne(u)!=="svelte-1phn90x"&&(u.textContent=_),I.forEach(a),H.forEach(a),T=w(A),g=c(A,"ION-CONTENT",{fullscreen:!0});var P=p(g);h=c(P,"ION-LIST",{});var B=p(h);for(let q=0;q<f.length;q+=1)f[q].l(B);B.forEach(a),P.forEach(a),E=w(A),N=c(A,"ION-FOOTER",{});var R=p(N);C=c(R,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),ne(C)!=="svelte-zv7v83"&&(C.textContent=L),R.forEach(a),this.h()},h(){m(n,"color","medium"),m(l,"slot","end"),m(e,"translucent",""),m(g,"fullscreen",""),m(C,"fill","outline"),m(C,"color","tertiary"),m(C,"strong",""),k(C,"width","99%"),k(C,"height","auto")},m(A,H){Z(A,e,H),o(e,t),o(t,l),o(l,n),o(t,d),o(t,u),Z(A,T,H),Z(A,g,H),o(g,h);for(let I=0;I<f.length;I+=1)f[I]&&f[I].m(h,null);Z(A,E,H),Z(A,N,H),o(N,C),S||(j=[ce(n,"click",i[3]),ce(C,"click",i[1])],S=!0)},p(A,[H]){H&5&&(X=Ue(A[0]),f=et(f,H,F,1,A,X,v,h,tt,Dt,null,Mt))},i:Ae,o:Ae,d(A){A&&(a(e),a(T),a(g),a(E),a(N));for(let H=0;H<f.length;H+=1)f[H].d();S=!1,Be(j)}}}function uo(i){let e=document.querySelector("ion-modal");e.componentProps.routeId;let t=e.componentProps.expenses;$e(()=>{});const l=()=>{nt.dismiss()};function n(u,_,T,g,h){e.componentProps.ex_amount=T,e.componentProps.ex_concept=_,e.componentProps.ex_type=g,e.componentProps.id_expense=h,je("modal-expense",dt,{amount:T,concept:_,type:g,id_expense:h}).then(()=>{}),l()}return[t,l,n,u=>{je("modal-expense",dt,{routeId:u}).then(_=>{}),l()},(u,_)=>n(_,u.concept,u.amount,u.type,u.id_expenses)]}class fo extends Qe{constructor(e){super(),Ze(this,e,uo,co,Ye,{})}}const{document:Pt}=An;function Ht(i,e,t){const l=i.slice();return l[49]=e[t],l[51]=t,l}function Bt(i,e,t){const l=i.slice();return l[49]=e[t],l[51]=t,l}function Rt(i,e,t){const l=i.slice();return l[49]=e[t],l[51]=t,l}function Ut(i){let e,t;return e=new wn({props:{$$slots:{default:[bo]},$$scope:{ctx:i}}}),{c(){sn(e.$$.fragment)},l(l){cn(e.$$.fragment,l)},m(l,n){un(e,l,n),t=!0},p(l,n){const r={};n[0]&2043|n[1]&8388608&&(r.$$scope={dirty:n,ctx:l}),e.$set(r)},i(l){t||(it(e.$$.fragment,l),t=!0)},o(l){ct(e.$$.fragment,l),t=!1},d(l){fn(e,l)}}}function _o(i){let e,t='<div id="g_map" style="width: 100%; height: 100vh;"></div>';return{c(){e=s("ion-content"),e.innerHTML=t},l(l){e=c(l,"ION-CONTENT",{"data-svelte-h":!0}),ne(e)!=="svelte-1ydw6i9"&&(e.innerHTML=t)},m(l,n){Z(l,e,n)},p:Ae,d(l){l&&a(e)}}}function ho(i){let e;function t(r,d){if(r[7].length>0)return mo;if(!r[3])return po}let l=t(i),n=l&&l(i);return{c(){n&&n.c(),e=Me()},l(r){n&&n.l(r),e=Me()},m(r,d){n&&n.m(r,d),Z(r,e,d)},p(r,d){l===(l=t(r))&&n?n.p(r,d):(n&&n.d(1),n=l&&l(r),n&&(n.c(),n.m(e.parentNode,e)))},d(r){r&&a(e),n&&n.d(r)}}}function po(i){let e,t,l,n='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Jala para actualizar" refreshing-spinner="circles" refreshing-text="Actualizando..."></ion-refresher-content>',r,d,u,_,T,g,h="0",f,v,E,N,C,L=i[6].origin+"",S,j,X,F="",A,H,I,M=[],P=new Map,B,R,q,G,ee,le=i[5].length+1+"",oe,de,se,re,ye,be,_e=i[6].destination+"",ke,Oe,Ie,Ne="",me,Te,Le,ve,ue=i[4]&&Vt(i),ie=Ue(i[5]);const ae=$=>$[49].id_event;for(let $=0;$<ie.length;$+=1){let b=Ht(i,ie,$),D=ae(b);P.set(D,M[$]=jt(D,b))}return{c(){ue&&ue.c(),e=y(),t=s("ion-content"),l=s("ion-refresher"),l.innerHTML=n,r=y(),d=s("ion-list"),u=s("ion-item"),_=s("ion-avatar"),T=s("div"),g=s("div"),g.textContent=h,v=y(),E=s("ion-label"),N=s("ion-text"),C=s("h3"),S=he(L),j=y(),X=s("div"),X.innerHTML=F,A=y(),H=s("ion-icon"),I=y();for(let $=0;$<M.length;$+=1)M[$].c();B=y(),R=s("ion-item"),q=s("ion-avatar"),G=s("div"),ee=s("div"),oe=he(le),se=y(),re=s("ion-label"),ye=s("ion-text"),be=s("h3"),ke=he(_e),Oe=y(),Ie=s("div"),Ie.innerHTML=Ne,me=y(),Te=s("ion-icon"),this.h()},l($){ue&&ue.l($),e=w($),t=c($,"ION-CONTENT",{});var b=p(t);l=c(b,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),ne(l)!=="svelte-1srnbs3"&&(l.innerHTML=n),r=w(b),d=c(b,"ION-LIST",{});var D=p(d);u=c(D,"ION-ITEM",{});var O=p(u);_=c(O,"ION-AVATAR",{slot:!0});var V=p(_);T=c(V,"DIV",{class:!0,title:!0,style:!0});var W=p(T);g=c(W,"DIV",{class:!0,"data-svelte-h":!0}),ne(g)!=="svelte-3lvlrb"&&(g.textContent=h),W.forEach(a),V.forEach(a),v=w(O),E=c(O,"ION-LABEL",{button:!0});var J=p(E);N=c(J,"ION-TEXT",{color:!0});var z=p(N);C=c(z,"H3",{});var K=p(C);S=pe(K,L),K.forEach(a),z.forEach(a),j=w(J),X=c(J,"DIV",{class:!0,"data-svelte-h":!0}),ne(X)!=="svelte-gz9kb"&&(X.innerHTML=F),J.forEach(a),A=w(O),H=c(O,"ION-ICON",{icon:!0,slot:!0}),p(H).forEach(a),O.forEach(a),I=w(D);for(let fe=0;fe<M.length;fe+=1)M[fe].l(D);B=w(D),R=c(D,"ION-ITEM",{});var x=p(R);q=c(x,"ION-AVATAR",{slot:!0});var Q=p(q);G=c(Q,"DIV",{class:!0,title:!0,style:!0});var U=p(G);ee=c(U,"DIV",{class:!0});var te=p(ee);oe=pe(te,le),te.forEach(a),U.forEach(a),Q.forEach(a),se=w(x),re=c(x,"ION-LABEL",{button:!0});var Ee=p(re);ye=c(Ee,"ION-TEXT",{color:!0});var Ce=p(ye);be=c(Ce,"H3",{});var ge=p(be);ke=pe(ge,_e),ge.forEach(a),Ce.forEach(a),Oe=w(Ee),Ie=c(Ee,"DIV",{class:!0,"data-svelte-h":!0}),ne(Ie)!=="svelte-130ohbs"&&(Ie.innerHTML=Ne),Ee.forEach(a),me=w(x),Te=c(x,"ION-ICON",{icon:!0,slot:!0}),p(Te).forEach(a),x.forEach(a),D.forEach(a),b.forEach(a),this.h()},h(){m(l,"slot","fixed"),Y(g,"class","order svelte-egzizz"),Y(T,"class","order-wrapper svelte-egzizz"),Y(T,"title",f="$"+i[6].origin),k(T,"background-color",i[6].color),k(T,"color",Se(i[6].color)),m(_,"slot","start"),m(N,"color","#2e2e2e"),Y(X,"class","sub svelte-egzizz"),m(E,"button",""),m(H,"icon",Ve),m(H,"slot","end"),Y(ee,"class","order svelte-egzizz"),Y(G,"class","order-wrapper svelte-egzizz"),Y(G,"title",de="$"+i[6].destination),k(G,"background-color",i[6].color),k(G,"color",Se(i[6].color)),m(q,"slot","start"),m(ye,"color","#2e2e2e"),Y(Ie,"class","sub svelte-egzizz"),m(re,"button",""),m(Te,"icon",Ve),m(Te,"slot","end")},m($,b){ue&&ue.m($,b),Z($,e,b),Z($,t,b),o(t,l),i[31](l),o(t,r),o(t,d),o(d,u),o(u,_),o(_,T),o(T,g),o(u,v),o(u,E),o(E,N),o(N,C),o(C,S),o(E,j),o(E,X),o(u,A),o(u,H),o(d,I);for(let D=0;D<M.length;D+=1)M[D]&&M[D].m(d,null);o(d,B),o(d,R),o(R,q),o(q,G),o(G,ee),o(ee,oe),o(R,se),o(R,re),o(re,ye),o(ye,be),o(be,ke),o(re,Oe),o(re,Ie),o(R,me),o(R,Te),Le||(ve=[ce(l,"ionRefresh",i[11]),ce(E,"click",i[32]),ce(re,"click",i[34])],Le=!0)},p($,b){$[4]?ue?ue.p($,b):(ue=Vt($),ue.c(),ue.m(e.parentNode,e)):ue&&(ue.d(1),ue=null),b[0]&64&&f!==(f="$"+$[6].origin)&&Y(T,"title",f),b[0]&64&&k(T,"background-color",$[6].color),b[0]&64&&k(T,"color",Se($[6].color)),b[0]&64&&L!==(L=$[6].origin+"")&&ze(S,L),b[0]&664608&&(ie=Ue($[5]),M=et(M,b,ae,1,$,ie,P,d,tt,jt,B,Ht)),b[0]&32&&le!==(le=$[5].length+1+"")&&ze(oe,le),b[0]&64&&de!==(de="$"+$[6].destination)&&Y(G,"title",de),b[0]&64&&k(G,"background-color",$[6].color),b[0]&64&&k(G,"color",Se($[6].color)),b[0]&64&&_e!==(_e=$[6].destination+"")&&ze(ke,_e)},d($){$&&(a(e),a(t)),ue&&ue.d($),i[31](null);for(let b=0;b<M.length;b+=1)M[b].d();Le=!1,Be(ve)}}}function mo(i){let e,t;function l(d,u){return u[0]&144&&(e=null),e==null&&(e=!!(d[7].filter(Io).every(ko)&&!d[4])),e?go:vo}let n=l(i,[-1,-1]),r=n(i);return{c(){r.c(),t=Me()},l(d){r.l(d),t=Me()},m(d,u){r.m(d,u),Z(d,t,u)},p(d,u){n===(n=l(d,u))&&r?r.p(d,u):(r.d(1),r=n(d),r&&(r.c(),r.m(t.parentNode,t)))},d(d){d&&a(t),r.d(d)}}}function Vt(i){let e=i[15]("",i[1],i[0])+"",t;return{c(){t=he(e)},l(l){t=pe(l,e)},m(l,n){Z(l,t,n)},p(l,n){n[0]&3&&e!==(e=l[15]("",l[1],l[0])+"")&&ze(t,e)},d(l){l&&a(t)}}}function Ft(i){let e;return{c(){e=s("span"),this.h()},l(t){e=c(t,"SPAN",{class:!0}),p(e).forEach(a),this.h()},h(){Y(e,"class","notes svelte-egzizz")},m(t,l){Z(t,e,l)},d(t){t&&a(e)}}}function jt(i,e){let t,l,n,r,d=parseInt(e[49].pos)+1+"",u,_,T,g,h,f,v=e[49].title+"",E,N,C=e[49].support_list&&e[49].support_list.length||e[17](e[49]),L,S,j,X,F=C&&Ft();function A(){return e[33](e[49])}return{key:i,first:null,c(){t=s("ion-item"),l=s("ion-avatar"),n=s("div"),r=s("div"),u=he(d),T=y(),g=s("ion-label"),h=s("ion-text"),f=s("h3"),E=he(v),N=y(),F&&F.c(),L=y(),S=s("ion-icon"),this.h()},l(H){t=c(H,"ION-ITEM",{});var I=p(t);l=c(I,"ION-AVATAR",{slot:!0});var M=p(l);n=c(M,"DIV",{class:!0,title:!0,style:!0});var P=p(n);r=c(P,"DIV",{class:!0});var B=p(r);u=pe(B,d),B.forEach(a),P.forEach(a),M.forEach(a),T=w(I),g=c(I,"ION-LABEL",{button:!0});var R=p(g);h=c(R,"ION-TEXT",{color:!0});var q=p(h);f=c(q,"H3",{});var G=p(f);E=pe(G,v),N=w(G),F&&F.l(G),G.forEach(a),q.forEach(a),R.forEach(a),L=w(I),S=c(I,"ION-ICON",{icon:!0,slot:!0,style:!0}),p(S).forEach(a),I.forEach(a),this.h()},h(){Y(r,"class","order svelte-egzizz"),Y(n,"class","order-wrapper svelte-egzizz"),Y(n,"title",_=Je(e[49].status)),k(n,"background-color",He(e[49].status,e[49].date_service)),k(n,"color",Se(He(e[49].status))),m(l,"slot","start"),m(h,"color","#2e2e2e"),m(g,"button",""),m(S,"icon",Ve),m(S,"slot","end"),k(S,"color",He(e[49].status,e[49].date_service)),this.first=t},m(H,I){Z(H,t,I),o(t,l),o(l,n),o(n,r),o(r,u),o(t,T),o(t,g),o(g,h),o(h,f),o(f,E),o(f,N),F&&F.m(f,null),o(t,L),o(t,S),j||(X=ce(g,"click",A),j=!0)},p(H,I){e=H,I[0]&32&&d!==(d=parseInt(e[49].pos)+1+"")&&ze(u,d),I[0]&32&&_!==(_=Je(e[49].status))&&Y(n,"title",_),I[0]&32&&k(n,"background-color",He(e[49].status,e[49].date_service)),I[0]&32&&k(n,"color",Se(He(e[49].status))),I[0]&32&&v!==(v=e[49].title+"")&&ze(E,v),I[0]&32&&(C=e[49].support_list&&e[49].support_list.length||e[17](e[49])),C?F||(F=Ft(),F.c(),F.m(f,null)):F&&(F.d(1),F=null),I[0]&32&&k(S,"color",He(e[49].status,e[49].date_service))},d(H){H&&a(t),F&&F.d(),j=!1,X()}}}function vo(i){let e=i[15](i[7],i[1],i[0])+"",t,l,n,r,d='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Pull to refresh" refreshing-spinner="circles" refreshing-text="Refreshing..."></ion-refresher-content>',u,_,T,g,h,f,v="0",E,N,C,L,S,j=i[6].origin+"",X,F,A,H="",I,M,P,B=[],R=new Map,q,G,ee,le,oe,de=i[5].length+1+"",se,re,ye,be,_e,ke,Oe=i[6].destination+"",Ie,Ne,me,Te="",Le,ve,ue,ie,ae=Ue(i[5]);const $=b=>b[49].id_event;for(let b=0;b<ae.length;b+=1){let D=Bt(i,ae,b),O=$(D);R.set(O,B[b]=Gt(O,D))}return{c(){t=he(e),l=y(),n=s("ion-content"),r=s("ion-refresher"),r.innerHTML=d,u=y(),_=s("ion-list"),T=s("ion-item"),g=s("ion-avatar"),h=s("div"),f=s("div"),f.textContent=v,N=y(),C=s("ion-label"),L=s("ion-text"),S=s("h3"),X=he(j),F=y(),A=s("div"),A.innerHTML=H,I=y(),M=s("ion-icon"),P=y();for(let b=0;b<B.length;b+=1)B[b].c();q=y(),G=s("ion-item"),ee=s("ion-avatar"),le=s("div"),oe=s("div"),se=he(de),ye=y(),be=s("ion-label"),_e=s("ion-text"),ke=s("h3"),Ie=he(Oe),Ne=y(),me=s("div"),me.innerHTML=Te,Le=y(),ve=s("ion-icon"),this.h()},l(b){t=pe(b,e),l=w(b),n=c(b,"ION-CONTENT",{});var D=p(n);r=c(D,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),ne(r)!=="svelte-dvt1s"&&(r.innerHTML=d),u=w(D),_=c(D,"ION-LIST",{});var O=p(_);T=c(O,"ION-ITEM",{});var V=p(T);g=c(V,"ION-AVATAR",{slot:!0});var W=p(g);h=c(W,"DIV",{class:!0,title:!0,style:!0});var J=p(h);f=c(J,"DIV",{class:!0,"data-svelte-h":!0}),ne(f)!=="svelte-3lvlrb"&&(f.textContent=v),J.forEach(a),W.forEach(a),N=w(V),C=c(V,"ION-LABEL",{button:!0});var z=p(C);L=c(z,"ION-TEXT",{color:!0});var K=p(L);S=c(K,"H3",{});var x=p(S);X=pe(x,j),x.forEach(a),K.forEach(a),F=w(z),A=c(z,"DIV",{class:!0,"data-svelte-h":!0}),ne(A)!=="svelte-gz9kb"&&(A.innerHTML=H),z.forEach(a),I=w(V),M=c(V,"ION-ICON",{icon:!0,slot:!0}),p(M).forEach(a),V.forEach(a),P=w(O);for(let Pe=0;Pe<B.length;Pe+=1)B[Pe].l(O);q=w(O),G=c(O,"ION-ITEM",{});var Q=p(G);ee=c(Q,"ION-AVATAR",{slot:!0});var U=p(ee);le=c(U,"DIV",{class:!0,title:!0,style:!0});var te=p(le);oe=c(te,"DIV",{class:!0});var Ee=p(oe);se=pe(Ee,de),Ee.forEach(a),te.forEach(a),U.forEach(a),ye=w(Q),be=c(Q,"ION-LABEL",{button:!0});var Ce=p(be);_e=c(Ce,"ION-TEXT",{color:!0});var ge=p(_e);ke=c(ge,"H3",{});var fe=p(ke);Ie=pe(fe,Oe),fe.forEach(a),ge.forEach(a),Ne=w(Ce),me=c(Ce,"DIV",{class:!0,"data-svelte-h":!0}),ne(me)!=="svelte-130ohbs"&&(me.innerHTML=Te),Ce.forEach(a),Le=w(Q),ve=c(Q,"ION-ICON",{icon:!0,slot:!0}),p(ve).forEach(a),Q.forEach(a),O.forEach(a),D.forEach(a),this.h()},h(){m(r,"slot","fixed"),Y(f,"class","order svelte-egzizz"),Y(h,"class","order-wrapper svelte-egzizz"),Y(h,"title",E="$"+i[6].origin),k(h,"background-color",i[6].color),k(h,"color",Se(i[6].color)),m(g,"slot","start"),m(L,"color","#2e2e2e"),Y(A,"class","sub svelte-egzizz"),m(C,"button",""),m(M,"icon",Ve),m(M,"slot","end"),Y(oe,"class","order svelte-egzizz"),Y(le,"class","order-wrapper svelte-egzizz"),Y(le,"title",re="$"+i[6].destination),k(le,"background-color",i[6].color),k(le,"color",Se(i[6].color)),m(ee,"slot","start"),m(_e,"color","#2e2e2e"),Y(me,"class","sub svelte-egzizz"),m(be,"button",""),m(ve,"icon",Ve),m(ve,"slot","end")},m(b,D){Z(b,t,D),Z(b,l,D),Z(b,n,D),o(n,r),i[27](r),o(n,u),o(n,_),o(_,T),o(T,g),o(g,h),o(h,f),o(T,N),o(T,C),o(C,L),o(L,S),o(S,X),o(C,F),o(C,A),o(T,I),o(T,M),o(_,P);for(let O=0;O<B.length;O+=1)B[O]&&B[O].m(_,null);o(_,q),o(_,G),o(G,ee),o(ee,le),o(le,oe),o(oe,se),o(G,ye),o(G,be),o(be,_e),o(_e,ke),o(ke,Ie),o(be,Ne),o(be,me),o(G,Le),o(G,ve),ue||(ie=[ce(r,"ionRefresh",i[11]),ce(C,"click",i[28]),ce(be,"click",i[30])],ue=!0)},p(b,D){D[0]&131&&e!==(e=b[15](b[7],b[1],b[0])+"")&&ze(t,e),D[0]&64&&E!==(E="$"+b[6].origin)&&Y(h,"title",E),D[0]&64&&k(h,"background-color",b[6].color),D[0]&64&&k(h,"color",Se(b[6].color)),D[0]&64&&j!==(j=b[6].origin+"")&&ze(X,j),D[0]&664608&&(ae=Ue(b[5]),B=et(B,D,$,1,b,ae,R,_,tt,Gt,q,Bt)),D[0]&32&&de!==(de=b[5].length+1+"")&&ze(se,de),D[0]&64&&re!==(re="$"+b[6].destination)&&Y(le,"title",re),D[0]&64&&k(le,"background-color",b[6].color),D[0]&64&&k(le,"color",Se(b[6].color)),D[0]&64&&Oe!==(Oe=b[6].destination+"")&&ze(Ie,Oe)},d(b){b&&(a(t),a(l),a(n)),i[27](null);for(let D=0;D<B.length;D+=1)B[D].d();ue=!1,Be(ie)}}}function go(i){let e,t,l='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Jale para actualizar" refreshing-spinner="circles" refreshing-text="Actualizando..."></ion-refresher-content>',n,r,d,u,_,T,g="0",h,f,v,E,N,C=i[6].origin+"",L,S,j,X="",F,A,H,I=[],M=new Map,P,B,R,q,G,ee=i[5].length+1+"",le,oe,de,se,re,ye,be=i[6].destination+"",_e,ke,Oe,Ie="",Ne,me,Te,Le,ve=Ue(i[5]);const ue=ie=>ie[49].id_event;for(let ie=0;ie<ve.length;ie+=1){let ae=Rt(i,ve,ie),$=ue(ae);M.set($,I[ie]=Xt($,ae))}return{c(){e=s("ion-content"),t=s("ion-refresher"),t.innerHTML=l,n=y(),r=s("ion-list"),d=s("ion-item"),u=s("ion-avatar"),_=s("div"),T=s("div"),T.textContent=g,f=y(),v=s("ion-label"),E=s("ion-text"),N=s("h3"),L=he(C),S=y(),j=s("div"),j.innerHTML=X,F=y(),A=s("ion-icon"),H=y();for(let ie=0;ie<I.length;ie+=1)I[ie].c();P=y(),B=s("ion-item"),R=s("ion-avatar"),q=s("div"),G=s("div"),le=he(ee),de=y(),se=s("ion-label"),re=s("ion-text"),ye=s("h3"),_e=he(be),ke=y(),Oe=s("div"),Oe.innerHTML=Ie,Ne=y(),me=s("ion-icon"),this.h()},l(ie){e=c(ie,"ION-CONTENT",{});var ae=p(e);t=c(ae,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),ne(t)!=="svelte-15ukrgn"&&(t.innerHTML=l),n=w(ae),r=c(ae,"ION-LIST",{});var $=p(r);d=c($,"ION-ITEM",{});var b=p(d);u=c(b,"ION-AVATAR",{slot:!0});var D=p(u);_=c(D,"DIV",{class:!0,title:!0,style:!0});var O=p(_);T=c(O,"DIV",{class:!0,"data-svelte-h":!0}),ne(T)!=="svelte-3lvlrb"&&(T.textContent=g),O.forEach(a),D.forEach(a),f=w(b),v=c(b,"ION-LABEL",{button:!0});var V=p(v);E=c(V,"ION-TEXT",{color:!0});var W=p(E);N=c(W,"H3",{});var J=p(N);L=pe(J,C),J.forEach(a),W.forEach(a),S=w(V),j=c(V,"DIV",{class:!0,"data-svelte-h":!0}),ne(j)!=="svelte-gz9kb"&&(j.innerHTML=X),V.forEach(a),F=w(b),A=c(b,"ION-ICON",{icon:!0,slot:!0}),p(A).forEach(a),b.forEach(a),H=w($);for(let Ce=0;Ce<I.length;Ce+=1)I[Ce].l($);P=w($),B=c($,"ION-ITEM",{});var z=p(B);R=c(z,"ION-AVATAR",{slot:!0});var K=p(R);q=c(K,"DIV",{class:!0,title:!0,style:!0});var x=p(q);G=c(x,"DIV",{class:!0});var Q=p(G);le=pe(Q,ee),Q.forEach(a),x.forEach(a),K.forEach(a),de=w(z),se=c(z,"ION-LABEL",{button:!0});var U=p(se);re=c(U,"ION-TEXT",{color:!0});var te=p(re);ye=c(te,"H3",{});var Ee=p(ye);_e=pe(Ee,be),Ee.forEach(a),te.forEach(a),ke=w(U),Oe=c(U,"DIV",{class:!0,"data-svelte-h":!0}),ne(Oe)!=="svelte-130ohbs"&&(Oe.innerHTML=Ie),U.forEach(a),Ne=w(z),me=c(z,"ION-ICON",{icon:!0,slot:!0}),p(me).forEach(a),z.forEach(a),$.forEach(a),ae.forEach(a),this.h()},h(){m(t,"slot","fixed"),Y(T,"class","order svelte-egzizz"),Y(_,"class","order-wrapper svelte-egzizz"),Y(_,"title",h="$"+i[6].origin),k(_,"background-color",i[6].color),k(_,"color",Se(i[6].color)),m(u,"slot","start"),m(E,"color","#2e2e2e"),Y(j,"class","sub svelte-egzizz"),m(v,"button",""),m(A,"icon",Ve),m(A,"slot","end"),Y(G,"class","order svelte-egzizz"),Y(q,"class","order-wrapper svelte-egzizz"),Y(q,"title",oe="$"+i[6].destination),k(q,"background-color",i[6].color),k(q,"color",Se(i[6].color)),m(R,"slot","start"),m(re,"color","#2e2e2e"),Y(Oe,"class","sub svelte-egzizz"),m(se,"button",""),m(me,"icon",Ve),m(me,"slot","end")},m(ie,ae){Z(ie,e,ae),o(e,t),i[23](t),o(e,n),o(e,r),o(r,d),o(d,u),o(u,_),o(_,T),o(d,f),o(d,v),o(v,E),o(E,N),o(N,L),o(v,S),o(v,j),o(d,F),o(d,A),o(r,H);for(let $=0;$<I.length;$+=1)I[$]&&I[$].m(r,null);o(r,P),o(r,B),o(B,R),o(R,q),o(q,G),o(G,le),o(B,de),o(B,se),o(se,re),o(re,ye),o(ye,_e),o(se,ke),o(se,Oe),o(B,Ne),o(B,me),Te||(Le=[ce(t,"ionRefresh",i[11]),ce(v,"click",i[24]),ce(se,"click",i[26])],Te=!0)},p(ie,ae){ae[0]&64&&h!==(h="$"+ie[6].origin)&&Y(_,"title",h),ae[0]&64&&k(_,"background-color",ie[6].color),ae[0]&64&&k(_,"color",Se(ie[6].color)),ae[0]&64&&C!==(C=ie[6].origin+"")&&ze(L,C),ae[0]&664608&&(ve=Ue(ie[5]),I=et(I,ae,ue,1,ie,ve,M,r,tt,Xt,P,Rt)),ae[0]&32&&ee!==(ee=ie[5].length+1+"")&&ze(le,ee),ae[0]&64&&oe!==(oe="$"+ie[6].destination)&&Y(q,"title",oe),ae[0]&64&&k(q,"background-color",ie[6].color),ae[0]&64&&k(q,"color",Se(ie[6].color)),ae[0]&64&&be!==(be=ie[6].destination+"")&&ze(_e,be)},d(ie){ie&&a(e),i[23](null);for(let ae=0;ae<I.length;ae+=1)I[ae].d();Te=!1,Be(Le)}}}function qt(i){let e;return{c(){e=s("span"),this.h()},l(t){e=c(t,"SPAN",{class:!0}),p(e).forEach(a),this.h()},h(){Y(e,"class","notes svelte-egzizz")},m(t,l){Z(t,e,l)},d(t){t&&a(e)}}}function Gt(i,e){let t,l,n,r,d=parseInt(e[49].pos)+1+"",u,_,T,g,h,f,v=e[49].title+"",E,N,C=e[49].support_list&&e[49].support_list.length||e[17](e[49]),L,S,j="",X,F,A,H,I=C&&qt();function M(){return e[29](e[49])}return{key:i,first:null,c(){t=s("ion-item"),l=s("ion-avatar"),n=s("div"),r=s("div"),u=he(d),T=y(),g=s("ion-label"),h=s("ion-text"),f=s("h3"),E=he(v),N=y(),I&&I.c(),L=y(),S=s("div"),S.innerHTML=j,X=y(),F=s("ion-icon"),this.h()},l(P){t=c(P,"ION-ITEM",{});var B=p(t);l=c(B,"ION-AVATAR",{slot:!0});var R=p(l);n=c(R,"DIV",{class:!0,title:!0,style:!0});var q=p(n);r=c(q,"DIV",{class:!0});var G=p(r);u=pe(G,d),G.forEach(a),q.forEach(a),R.forEach(a),T=w(B),g=c(B,"ION-LABEL",{button:!0});var ee=p(g);h=c(ee,"ION-TEXT",{color:!0});var le=p(h);f=c(le,"H3",{});var oe=p(f);E=pe(oe,v),N=w(oe),I&&I.l(oe),oe.forEach(a),le.forEach(a),L=w(ee),S=c(ee,"DIV",{class:!0,"data-svelte-h":!0}),ne(S)!=="svelte-qaecoo"&&(S.innerHTML=j),ee.forEach(a),X=w(B),F=c(B,"ION-ICON",{icon:!0,slot:!0}),p(F).forEach(a),B.forEach(a),this.h()},h(){Y(r,"class","order svelte-egzizz"),Y(n,"class","order-wrapper svelte-egzizz"),Y(n,"title",_=Je(e[49].status)),k(n,"background-color",He(e[49].status,e[49].date_service)),k(n,"color",Se(He(e[49].status))),m(l,"slot","start"),m(h,"color","#2e2e2e"),Y(S,"class","sub svelte-egzizz"),m(g,"button",""),m(F,"icon",Ve),m(F,"slot","end"),this.first=t},m(P,B){Z(P,t,B),o(t,l),o(l,n),o(n,r),o(r,u),o(t,T),o(t,g),o(g,h),o(h,f),o(f,E),o(f,N),I&&I.m(f,null),o(g,L),o(g,S),o(t,X),o(t,F),A||(H=ce(g,"click",M),A=!0)},p(P,B){e=P,B[0]&32&&d!==(d=parseInt(e[49].pos)+1+"")&&ze(u,d),B[0]&32&&_!==(_=Je(e[49].status))&&Y(n,"title",_),B[0]&32&&k(n,"background-color",He(e[49].status,e[49].date_service)),B[0]&32&&k(n,"color",Se(He(e[49].status))),B[0]&32&&v!==(v=e[49].title+"")&&ze(E,v),B[0]&32&&(C=e[49].support_list&&e[49].support_list.length||e[17](e[49])),C?I||(I=qt(),I.c(),I.m(f,null)):I&&(I.d(1),I=null)},d(P){P&&a(t),I&&I.d(),A=!1,H()}}}function Kt(i){let e;return{c(){e=s("span"),this.h()},l(t){e=c(t,"SPAN",{class:!0}),p(e).forEach(a),this.h()},h(){Y(e,"class","notes svelte-egzizz")},m(t,l){Z(t,e,l)},d(t){t&&a(e)}}}function Xt(i,e){let t,l,n,r,d=parseInt(e[49].pos)+1+"",u,_,T,g,h,f,v=e[49].title+"",E,N,C=e[49].support_list&&e[49].support_list.length||e[17](e[49]),L,S,j="",X,F,A,H,I=C&&Kt();function M(){return e[25](e[49])}return{key:i,first:null,c(){t=s("ion-item"),l=s("ion-avatar"),n=s("div"),r=s("div"),u=he(d),T=y(),g=s("ion-label"),h=s("ion-text"),f=s("h3"),E=he(v),N=y(),I&&I.c(),L=y(),S=s("div"),S.innerHTML=j,X=y(),F=s("ion-icon"),this.h()},l(P){t=c(P,"ION-ITEM",{});var B=p(t);l=c(B,"ION-AVATAR",{slot:!0});var R=p(l);n=c(R,"DIV",{class:!0,title:!0,style:!0});var q=p(n);r=c(q,"DIV",{class:!0});var G=p(r);u=pe(G,d),G.forEach(a),q.forEach(a),R.forEach(a),T=w(B),g=c(B,"ION-LABEL",{button:!0});var ee=p(g);h=c(ee,"ION-TEXT",{color:!0});var le=p(h);f=c(le,"H3",{});var oe=p(f);E=pe(oe,v),N=w(oe),I&&I.l(oe),oe.forEach(a),le.forEach(a),L=w(ee),S=c(ee,"DIV",{class:!0,"data-svelte-h":!0}),ne(S)!=="svelte-qaecoo"&&(S.innerHTML=j),ee.forEach(a),X=w(B),F=c(B,"ION-ICON",{icon:!0,slot:!0}),p(F).forEach(a),B.forEach(a),this.h()},h(){Y(r,"class","order svelte-egzizz"),Y(n,"class","order-wrapper svelte-egzizz"),Y(n,"title",_=Je(e[49].status)),k(n,"background-color",He(e[49].status,e[49].date_service)),k(n,"color",Se(He(e[49].status))),m(l,"slot","start"),m(h,"color","#2e2e2e"),Y(S,"class","sub svelte-egzizz"),m(g,"button",""),m(F,"icon",Ve),m(F,"slot","end"),this.first=t},m(P,B){Z(P,t,B),o(t,l),o(l,n),o(n,r),o(r,u),o(t,T),o(t,g),o(g,h),o(h,f),o(f,E),o(f,N),I&&I.m(f,null),o(g,L),o(g,S),o(t,X),o(t,F),A||(H=ce(g,"click",M),A=!0)},p(P,B){e=P,B[0]&32&&d!==(d=parseInt(e[49].pos)+1+"")&&ze(u,d),B[0]&32&&_!==(_=Je(e[49].status))&&Y(n,"title",_),B[0]&32&&k(n,"background-color",He(e[49].status,e[49].date_service)),B[0]&32&&k(n,"color",Se(He(e[49].status))),B[0]&32&&v!==(v=e[49].title+"")&&ze(E,v),B[0]&32&&(C=e[49].support_list&&e[49].support_list.length||e[17](e[49])),C?I||(I=Kt(),I.c(),I.m(f,null)):I&&(I.d(1),I=null)},d(P){P&&a(t),I&&I.d(),A=!1,H()}}}function bo(i){let e,t,l,n,r=`<ion-icon icon="${Tn}"></ion-icon>`,d,u,_,T=`<ion-icon icon="${Cn}"></ion-icon>`,g,h,f=(i[6].name?i[6].name.toUpperCase():"")+"",v,E,N,C='<ion-segment-button value="list"><ion-label>Paradas</ion-label></ion-segment-button> <ion-segment-button value="map"><ion-label>Mapa</ion-label></ion-segment-button>',L,S,j,X;function F(I,M){if(I[9]==="list")return ho;if(I[9]==="map")return _o}let A=F(i),H=A&&A(i);return{c(){e=s("ion-header"),t=s("ion-toolbar"),l=s("ion-buttons"),n=s("ion-button"),n.innerHTML=r,d=y(),u=s("ion-buttons"),_=s("ion-button"),_.innerHTML=T,g=y(),h=s("ion-title"),v=he(f),E=y(),N=s("ion-segment"),N.innerHTML=C,L=y(),H&&H.c(),S=Me(),this.h()},l(I){e=c(I,"ION-HEADER",{translucent:!0});var M=p(e);t=c(M,"ION-TOOLBAR",{});var P=p(t);l=c(P,"ION-BUTTONS",{slot:!0});var B=p(l);n=c(B,"ION-BUTTON",{title:!0,alt:!0,"data-svelte-h":!0}),ne(n)!=="svelte-7ppz3r"&&(n.innerHTML=r),B.forEach(a),d=w(P),u=c(P,"ION-BUTTONS",{slot:!0});var R=p(u);_=c(R,"ION-BUTTON",{"data-svelte-h":!0}),ne(_)!=="svelte-nf50hj"&&(_.innerHTML=T),R.forEach(a),g=w(P),h=c(P,"ION-TITLE",{});var q=p(h);v=pe(q,f),q.forEach(a),P.forEach(a),E=w(M),N=c(M,"ION-SEGMENT",{value:!0,"data-svelte-h":!0}),ne(N)!=="svelte-lue4c9"&&(N.innerHTML=C),M.forEach(a),L=w(I),H&&H.l(I),S=Me(),this.h()},h(){m(n,"title","Atrás"),m(n,"alt","Atrás"),m(l,"slot","start"),m(u,"slot","end"),m(N,"value","list"),m(e,"translucent","")},m(I,M){Z(I,e,M),o(e,t),o(t,l),o(l,n),o(t,d),o(t,u),o(u,_),o(t,g),o(t,h),o(h,v),o(e,E),o(e,N),Z(I,L,M),H&&H.m(I,M),Z(I,S,M),j||(X=[ce(n,"click",i[18]),ce(_,"click",i[21]),ce(N,"ionChange",i[22])],j=!0)},p(I,M){M[0]&64&&f!==(f=(I[6].name?I[6].name.toUpperCase():"")+"")&&ze(v,f),A===(A=F(I))&&H?H.p(I,M):(H&&H.d(1),H=A&&A(I),H&&(H.c(),H.m(S.parentNode,S)))},d(I){I&&(a(e),a(L),a(S)),H&&H.d(I),j=!1,Be(X)}}}function Eo(i){let e,t,l,n=i[2]&&Ut(i);return{c(){e=y(),n&&n.c(),t=Me(),this.h()},l(r){on("svelte-kn0kph",Pt.head).forEach(a),e=w(r),n&&n.l(r),t=Me(),this.h()},h(){Pt.title="Rutaflow - Detalles de ruta"},m(r,d){Z(r,e,d),n&&n.m(r,d),Z(r,t,d),l=!0},p(r,d){r[2]?n?(n.p(r,d),d[0]&4&&it(n,1)):(n=Ut(r),n.c(),it(n,1),n.m(t.parentNode,t)):n&&(dn(),ct(n,1,1,()=>{n=null}),an())},i(r){l||(it(n),l=!0)},o(r){ct(n),l=!1},d(r){r&&(a(e),a(t)),n&&n.d(r)}}}function He(i,e=""){let t="#ffffff";return i==="pending"&&!e?t="#f2e300":i=="pending"&&e?t="#F6A833":i==="completed"&&(t="#44d900"),t}function Je(i){let e="";return i=="pending"?e="Pendiente":i=="completed"&&(e="Completado"),e}function Se(i){i.slice(0,1)==="#"&&(i=i.slice(1)),i.length===3&&(i=i.split("").map(function(r){return r+r}).join(""));const e=parseInt(i.substr(0,2),16),t=parseInt(i.substr(2,2),16),l=parseInt(i.substr(4,2),16);return(e*299+t*587+l*114)/1e3>=128?"#414040":"#fff"}function st(i,e){for(let t=0;t<e.length;t++)if(e[t].alias===i)return e[t].val;return""}const Io=i=>i.mandatory==="1",ko=i=>i.img;function Oo(i,e,t){let l;ln(i,yn,b=>t(20,l=b));var n=this&&this.__awaiter||function(b,D,O,V){function W(J){return J instanceof O?J:new O(function(z){z(J)})}return new(O||(O=Promise))(function(J,z){function K(U){try{Q(V.next(U))}catch(te){z(te)}}function x(U){try{Q(V.throw(U))}catch(te){z(te)}}function Q(U){U.done?J(U.value):W(U.value).then(K,x)}Q((V=V.apply(b,D||[])).next())})};let{routeId:r}=e,{driverId:d}=e,u=rt,_=new Object,T=!0,g=!1,h=[],f={},v=[],E=[],N,C=!1,L="list",S,j="",X="",F="0",A=new Object;const H=()=>n(void 0,void 0,void 0,function*(){yield P(r),N.complete()});$e(()=>n(void 0,void 0,void 0,function*(){ye(),yield P(r)}));function I(b){return n(this,void 0,void 0,function*(){if(t(9,L=b),L==="map"){yield rn(),S=document.getElementById("g_map");const D=new google.maps.Map(S,{zoom:8,center:{lat:20.6745683,lng:-103.3986104},mapId:"4504f8b37365c3d0"}),O=new google.maps.LatLngBounds,{AdvancedMarkerElement:V,PinElement:W}=yield google.maps.importLibrary("marker");navigator.geolocation?navigator.geolocation.getCurrentPosition(function(J){const z=new google.maps.LatLng(J.coords.latitude,J.coords.longitude);new google.maps.Marker({position:z,map:D,icon:{path:google.maps.SymbolPath.CIRCLE,fillColor:"#0062ff",fillOpacity:1,scale:6,strokeColor:"#ffffff",strokeWeight:2}}),new google.maps.Circle({strokeColor:"#00BFFF",strokeOpacity:.5,strokeWeight:1,fillColor:"#00BFFF",fillOpacity:.2,map:D,center:z,radius:J.coords.accuracy}),O.extend(z)},function(J){console.error("Error retrieving location:",J)}):console.error("Geolocation not supported by this browser."),f.lat1===f.lat2&&f.lon1===f.lon2?M(O,D,{lat:f.lat2,lon:f.lon2,color:f.color,title:f.destination},{type:"icon",iconClass:"icon-home",title:"Origen/Destino",glyph:`0,${String(h.length+1)}`}):(M(O,D,{lat:f.lat1,lon:f.lon1,color:f.color,title:f.origin},{type:"icon",iconClass:"icon-home",title:"Origen",glyph:"0"}),M(O,D,{lat:f.lat2,lon:f.lon2,color:f.color,title:f.destination},{type:"icon",iconClass:"icon-flag",title:"Destino",glyph:String(h.length+1)})),h.forEach((J,z)=>{const K=parseFloat(J.lat),x=parseFloat(J.lon),Q=new google.maps.LatLng(K,x),U=new google.maps.Marker({position:{lat:K,lng:x},map:D,title:J.title}),te=new W({background:He(J.status,J.date_service),borderColor:"#000",glyphColor:"#000",glyph:(parseInt(J.pos)+1).toString()});new V({map:D,position:Q,content:te.element,title:"Parada "+(parseInt(J.pos)+1).toString()+": "+J.title}).addListener("click",function(Ce){R(J,!1)}),O.extend(U.getPosition())}),D.fitBounds(O)}})}function M(b,D,O,V){return n(this,void 0,void 0,function*(){let W;const J=parseFloat(O.lat),z=parseFloat(O.lon),K=new google.maps.LatLng(J,z),{AdvancedMarkerElement:x,PinElement:Q}=yield google.maps.importLibrary("marker");V.type=="icon"?(W=document.createElement("i"),W.className=`${V.iconClass} icon`,W.style.fontSize="14px",W.style.color=Se(O.color),W.style.fontWeight="600"):V.type=="text";const U=new google.maps.Marker({position:{lat:J,lng:z},map:D,title:`${V.title}. ${O.title}`}),te=new Q({background:O.color,borderColor:"#000",glyphColor:Se(O.color),glyph:V.glyph});return new x({map:D,position:K,content:te.element,title:V.title+": "+O.title}).addListener("click",function(Ce){q(f,V.title=="Destino"||V.title=="Origen/Destino")}),U})}function P(b){return n(this,void 0,void 0,function*(){let D=new FormData;D.append("id_route",b),D=re(D);try{const V=yield(yield fetch(`${u}api/admin/report/seguimiento_list.php`,{method:"POST",body:D})).json();t(6,f=V.data.seguimiento_list[0]),t(5,h=V.data.event_list),t(7,v=V.data.checklist),E=V.data.expenses,f&&t(4,g=f.km_inicial=="0"&&f.gas_inicial=="0"),t(3,T=!1)}catch(O){t(3,T=!1),console.error("Error fetching data:",O)}})}const B=b=>new Promise((D,O)=>{let V=new FormData;V.append("id_route",b.id_route),V.append("id_event",b.id_event),V=re(V),fetch(`${u}api/admin/evidence/evidence_by_event.php`,{method:"POST",body:V}).then(W=>W.json()).then(W=>{D(W.data.event_evidence[0])}).catch(W=>{console.error("Error fetching data:",W),O(W)})}),R=(b,D)=>{B(b).then(O=>{b.stopsApproval=j,b.smsActive=X,O&&(b.img=O.img,b.driver_comments=O.driver_comments,b.comments=O.comments),je("modal-delivery-info",zt,{delivery:b,isLast:D}).then(V=>{}).finally(()=>{P(r)})})},q=(b,D)=>{var O=new Object;D?O={title:b.destination,line1:b.dest_address}:O={title:b.origin,line1:b.origin_address},O.client_name=b.client_name,O.client_phone=b.tel,O.id_route=b.id_route,O.stopsApproval=j,O.smsActive=X;var V=!0;je("modal-delivery-info",zt,{delivery:O,isLast:D,flag:V})},G=(b,D,O)=>{var V=!1;return C||(C=!0,je("modal-checklist",Zt,{checklist:b,driverId:D,routeId:O,isLast:V}).then(W=>{C=!1}),oe(O,"checklist")),""},ee=b=>n(void 0,void 0,void 0,function*(){return yield P(b),E.length>0?je("modal-expense-detail",fo,{routeId:b,expenses:E}).then(D=>{}):je("modal-expense",dt,{routeId:b}).then(D=>{}),""}),le=b=>{if(b.tracking_type=="subscription"){if(b.subscriber_info&&b.payment_type==="cash"&&new Date(b.subscriber_info.payment_next)<new Date)return!0}else if(b.tracking_type=="ecommerce"&&Number(b.payment_pending)>0)return!0;return!1};function oe(b,D){let O=new FormData;return O.append("id_route",b),O.append("status",D),O=re(O),fetch(`${u}api/admin/route/change_status.php`,{method:"POST",body:O}).then(V=>V.json()).then(V=>{}).catch(V=>{console.error("Error fetching data:",V)}),""}const de=()=>{_.type=="super"||_.type=="admin"?Ge("/drivers/me"):_.id_driver&&Ge(`/drivers/${_.id_driver}`)},se=(b,D)=>n(void 0,void 0,void 0,function*(){yield(yield Ke.create({header:b||"Error",message:D||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()});function re(b){return b.append("token",_.token),b.append("id_user_over",_.id_user),b}const ye=()=>n(void 0,void 0,void 0,function*(){if(_.id_enterprise){let b=new FormData;b.append("id_enterprise",_.id_enterprise),b=re(b);try{const D=yield fetch(`${u}api/admin/enterprise/enterprise_settings.php`,{method:"POST",body:b});D.ok?(A=(yield D.json()).nodos,j=st("stops_wait_approval",A),X=st("sms_active",A),t(10,F=st("stops_order_restriction",A))):console.error("File upload failed:",D.statusText)}catch(D){console.error("Error during file upload:",D)}}}),be=()=>ee(r),_e=b=>I(b.detail.value);function ke(b){De[b?"unshift":"push"](()=>{N=b,t(8,N)})}const Oe=()=>{q(f,!1)},Ie=b=>{const D=h.findIndex(z=>z.id_event===b.id_event),O=D===0,V=D>0?h[D-1]:null,W=O||V&&V.img!==null,J=b.img!==null&&b.img!=="";W||O&&!J||F=="1"?R(b,!1):se("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")},Ne=()=>{q(f,!0)};function me(b){De[b?"unshift":"push"](()=>{N=b,t(8,N)})}const Te=()=>{q(f,!1)},Le=b=>{const D=h.findIndex(z=>z.id_event===b.id_event),O=D===0,V=D>0?h[D-1]:null,W=O||V&&V.img!==null,J=b.img!==null&&b.img!=="";W||O&&!J||F=="1"?R(b,!1):se("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")},ve=()=>{q(f,!0)};function ue(b){De[b?"unshift":"push"](()=>{N=b,t(8,N)})}const ie=()=>{q(f,!1)},ae=b=>{const D=h.findIndex(z=>z.id_event===b.id_event),O=D===0,V=D>0?h[D-1]:null,W=O||V&&V.img!==null,J=b.img!==null&&b.img!=="";W||O&&!J||F=="1"?R(b,!1):se("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")},$=()=>{q(f,!0)};return i.$$set=b=>{"routeId"in b&&t(0,r=b.routeId),"driverId"in b&&t(1,d=b.driverId)},i.$$.update=()=>{i.$$.dirty[0]&1048581&&(t(0,{routeId:r,driverId:d}=l.params,r,(t(1,d),t(20,l),t(2,_),t(0,r))),t(2,_=JSON.parse(localStorage.getItem("userSession"))),_?_.id_user&&(_.type=="admin"||_.type=="super")?(P(r),Ge(`/drivers/me/routes/${r}`)):_.id_user&&_.id_driver&&(P(r),Ge(`/drivers/${_.id_driver}/routes/${r}`)):Ge("/"))},[r,d,_,T,g,h,f,v,N,L,F,H,I,R,q,G,ee,le,de,se,l,be,_e,ke,Oe,Ie,Ne,me,Te,Le,ve,ue,ie,ae,$]}class Ao extends Qe{constructor(e){super(),Ze(this,e,Oo,Eo,Ye,{routeId:0,driverId:1},null,[-1,-1])}}export{Ao as component};

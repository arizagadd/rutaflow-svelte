import{Z as ht,s as We,e as c,j as w,b as u,q as E,d as K,h as a,m as L,v as p,i as R,w as l,x as Q,n as Ie,z as Ue,_ as Ft,B as j,o as st,k as Ce,$ as pt,t as re,r as ae,f as V,a0 as jt,y as we,a1 as $e,A as Te,a2 as at,l as Vt,p as Gt}from"../chunks/index.BYLndrM5.js";import{S as Xe,i as Je,t as rt,a as ut,c as Kt,b as xt,d as Wt,m as Xt,e as Jt,g as Yt}from"../chunks/index.BNHbygFo.js";import{e as Be,u as tt,d as nt,a as Zt,c as ft,b as Ut,f as Qt,i as Ht,g as $t,h as Rt,s as mt,j as Ye,k as en,m as tn,n as nn,o as on,p as ln}from"../chunks/index.BNrVHWD9.js";import{g as je}from"../chunks/entry.CeogqmVd.js";import"../chunks/index-48209844.IIRtDZyg.js";import{m as ot,a as et,I as rn}from"../chunks/IonPage.KvUD72q2.js";import{q as an,t as sn}from"../chunks/ion-modal.CsJaVgKZ.js";const cn=(i,e)=>{if(!customElements.get(i)){class t extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const n={};for(const r of this.attributes)n[r.name]=r.value;new e({target:this.shadowRoot,props:n})}}customElements.define(i,t)}},un=function(i){return document.createElement(i).constructor!==HTMLElement},fn=(i,e)=>{un(i)||cn(i,e)},Re=async(i,e,t)=>{an(),sn(),fn(i,e);const o=await ot.create({component:i,componentProps:t});return o.present(),await o.onWillDismiss()};let Ge=ht({km_inicial:[],gas_inicial:[],km_final:[],gas_final:[]}),qt=ht({flag:[]});function _n(i){let e,t,o,n,r="Cancelar",h,f,b="Captura de Km/Gas",k,I,_,s="Confirmar",m,d,g,v,T,C,B;return{c(){e=c("ion-header"),t=c("ion-toolbar"),o=c("ion-buttons"),n=c("ion-button"),n.textContent=r,h=w(),f=c("ion-title"),f.textContent=b,k=w(),I=c("ion-buttons"),_=c("ion-button"),_.textContent=s,m=w(),d=c("ion-content"),g=c("ion-item"),v=c("ion-input"),this.h()},l(P){e=u(P,"ION-HEADER",{translucent:!0});var A=E(e);t=u(A,"ION-TOOLBAR",{});var N=E(t);o=u(N,"ION-BUTTONS",{slot:!0});var D=E(o);n=u(D,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),K(n)!=="svelte-17pq4f4"&&(n.textContent=r),D.forEach(a),h=L(N),f=u(N,"ION-TITLE",{"data-svelte-h":!0}),K(f)!=="svelte-1yhkaq7"&&(f.textContent=b),k=L(N),I=u(N,"ION-BUTTONS",{slot:!0});var y=E(I);_=u(y,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),K(_)!=="svelte-cm6j4s"&&(_.textContent=s),y.forEach(a),N.forEach(a),A.forEach(a),m=L(P),d=u(P,"ION-CONTENT",{fullscreen:!0});var O=E(d);g=u(O,"ION-ITEM",{});var S=E(g);v=u(S,"ION-INPUT",{class:!0,inputmode:!0,pattern:!0,type:!0,placeholder:!0,value:!0,required:!0});var q=E(v);q.forEach(a),S.forEach(a),O.forEach(a),this.h()},h(){p(n,"color","medium"),p(o,"slot","start"),p(_,"strong",""),p(I,"slot","end"),p(e,"translucent",""),p(v,"class","fin-km"),p(v,"inputmode","numeric"),p(v,"pattern","[0-9]*"),p(v,"type","number"),p(v,"placeholder",T="Ingresa "+i[0]+" actual"),p(v,"value",i[1]),p(v,"required",""),p(d,"fullscreen","")},m(P,A){R(P,e,A),l(e,t),l(t,o),l(o,n),l(t,h),l(t,f),l(t,k),l(t,I),l(I,_),R(P,m,A),R(P,d,A),l(d,g),l(g,v),C||(B=[Q(n,"click",i[2]),Q(_,"click",i[3]),Q(v,"input",i[4])],C=!0)},p(P,[A]){A&1&&T!==(T="Ingresa "+P[0]+" actual")&&p(v,"placeholder",T),A&2&&p(v,"value",P[1])},i:Ie,o:Ie,d(P){P&&(a(e),a(m),a(d)),C=!1,Ue(B)}}}function dn(i,e,t){const o=Ft();let n=document.querySelector("ion-modal"),r=n.componentProps.data_type;n.componentProps.isLast;let h;qt.subscribe(_=>{r=_.flag[0],r=="km_final"||r=="km_inicial"?t(0,h="kilometraje"):t(0,h="litros de gasolina")});let f=0;function b(){ot.dismiss()}function k(){o("modalResult",{data:"Your data",role:"confirm"}),r=="km_inicial"?Ge.update(s=>({...s,km_inicial:[f]})):r=="gas_inicial"?Ge.update(s=>({...s,gas_inicial:[f]})):r=="km_final"?Ge.update(s=>({...s,km_final:[f]})):r=="gas_final"&&Ge.update(s=>({...s,gas_final:[f]})),b()}return[h,f,b,k,_=>t(1,f=_.target.value)]}class hn extends Xe{constructor(e){super(),Je(this,e,dn,_n,We,{})}}const ct=ht({items:[],checkedIndices:[],mandatory:[]});function gt(i,e,t){const o=i.slice();return o[49]=e[t],o[50]=e,o[51]=t,o}function pn(i){let e,t,o,n,r,h="Kilometraje inicial",f,b,k=i[0]?i[0]+" km.":"Cargar km",I,_,s,m,d,g,v,T="Gasolina inicial (litros)",C,B,P=i[1]?i[1]+" litros":"Cargar gas",A,N,D,y;return N=pt(i[20][0]),{c(){e=c("ion-item"),t=c("ion-label"),o=c("input"),n=w(),r=c("p"),r.textContent=h,f=w(),b=c("ion-button"),I=re(k),_=w(),s=c("ion-item"),m=c("ion-label"),d=c("input"),g=w(),v=c("p"),v.textContent=T,C=w(),B=c("ion-button"),A=re(P),this.h()},l(O){e=u(O,"ION-ITEM",{});var S=E(e);t=u(S,"ION-LABEL",{style:!0});var q=E(t);o=u(q,"INPUT",{id:!0,style:!0,type:!0}),n=L(q),r=u(q,"P",{style:!0,"data-svelte-h":!0}),K(r)!=="svelte-88twxi"&&(r.textContent=h),q.forEach(a),f=L(S),b=u(S,"ION-BUTTON",{fill:!0,size:!0,class:!0,"aria-selected":!0});var M=E(b);I=ae(M,k),M.forEach(a),S.forEach(a),_=L(O),s=u(O,"ION-ITEM",{});var z=E(s);m=u(z,"ION-LABEL",{style:!0});var x=E(m);d=u(x,"INPUT",{id:!0,style:!0,type:!0}),g=L(x),v=u(x,"P",{style:!0,"data-svelte-h":!0}),K(v)!=="svelte-1ux30eb"&&(v.textContent=T),x.forEach(a),C=L(z),B=u(z,"ION-BUTTON",{fill:!0,class:!0,size:!0,style:!0});var $=E(B);A=ae($,P),$.forEach(a),z.forEach(a),this.h()},h(){V(o,"id","chkbox-km-ini"),j(o,"pointer-events","auto"),V(o,"type","checkbox"),o.required=!0,j(r,"margin-left","10px"),j(t,"display","flex"),p(b,"fill","outline"),p(b,"size","small"),p(b,"class","loadKmInicial"),p(b,"aria-selected",""),V(d,"id","chkbox-gas-ini"),j(d,"pointer-events","auto"),V(d,"type","checkbox"),d.required=!0,j(v,"margin-left","10px"),j(m,"display","flex"),p(B,"fill","outline"),p(B,"class","loadGasInicial"),p(B,"size","small"),j(B,"height","16px "),N.p(o,d)},m(O,S){R(O,e,S),l(e,t),l(t,o),o.checked=~(i[4]||[]).indexOf(o.__value),i[27](o),l(t,n),l(t,r),l(e,f),l(e,b),l(b,I),R(O,_,S),R(O,s,S),l(s,m),l(m,d),i[29](d),d.checked=~(i[4]||[]).indexOf(d.__value),l(m,g),l(m,v),l(s,C),l(s,B),l(B,A),D||(y=[Q(o,"change",i[26]),Q(b,"click",i[28]),Q(d,"change",i[30]),Q(B,"click",i[31])],D=!0)},p(O,S){S[0]&16&&(o.checked=~(O[4]||[]).indexOf(o.__value)),S[0]&1&&k!==(k=O[0]?O[0]+" km.":"Cargar km")&&we(I,k),S[0]&16&&(d.checked=~(O[4]||[]).indexOf(d.__value)),S[0]&2&&P!==(P=O[1]?O[1]+" litros":"Cargar gas")&&we(A,P)},d(O){O&&(a(e),a(_),a(s)),i[27](null),i[29](null),N.r(),D=!1,Ue(y)}}}function mn(i){let e,t,o,n,r,h="Kilometraje final",f,b,k=i[2]?i[2]+" km.":"Cargar km",I,_,s,m,d,g,v,T="Gasolina final (litros)",C,B,P=i[3]?i[3]+" litros":"Cargar gas",A,N,D,y;return N=pt(i[20][0]),{c(){e=c("ion-item"),t=c("ion-label"),o=c("input"),n=w(),r=c("p"),r.textContent=h,f=w(),b=c("ion-button"),I=re(k),_=w(),s=c("ion-item"),m=c("ion-label"),d=c("input"),g=w(),v=c("p"),v.textContent=T,C=w(),B=c("ion-button"),A=re(P),this.h()},l(O){e=u(O,"ION-ITEM",{});var S=E(e);t=u(S,"ION-LABEL",{style:!0});var q=E(t);o=u(q,"INPUT",{id:!0,style:!0,type:!0}),n=L(q),r=u(q,"P",{style:!0,"data-svelte-h":!0}),K(r)!=="svelte-ccmu71"&&(r.textContent=h),q.forEach(a),f=L(S),b=u(S,"ION-BUTTON",{fill:!0,size:!0,class:!0,"aria-selected":!0});var M=E(b);I=ae(M,k),M.forEach(a),S.forEach(a),_=L(O),s=u(O,"ION-ITEM",{});var z=E(s);m=u(z,"ION-LABEL",{style:!0});var x=E(m);d=u(x,"INPUT",{id:!0,style:!0,type:!0}),g=L(x),v=u(x,"P",{style:!0,"data-svelte-h":!0}),K(v)!=="svelte-wsoyd2"&&(v.textContent=T),x.forEach(a),C=L(z),B=u(z,"ION-BUTTON",{fill:!0,size:!0,class:!0});var $=E(B);A=ae($,P),$.forEach(a),z.forEach(a),this.h()},h(){V(o,"id","chkbox-km-fin"),j(o,"pointer-events","auto"),V(o,"type","checkbox"),o.required=!0,j(r,"margin-left","10px"),j(t,"display","flex"),p(b,"fill","outline"),p(b,"size","small"),p(b,"class","loadKmInicial"),p(b,"aria-selected",""),V(d,"id","chkbox-gas-fin"),j(d,"pointer-events","auto"),V(d,"type","checkbox"),d.required=!0,j(v,"margin-left","10px"),j(m,"display","flex"),p(B,"fill","outline"),p(B,"size","small"),p(B,"class","loadGasInicial"),N.p(o,d)},m(O,S){R(O,e,S),l(e,t),l(t,o),o.checked=~(i[4]||[]).indexOf(o.__value),i[21](o),l(t,n),l(t,r),l(e,f),l(e,b),l(b,I),R(O,_,S),R(O,s,S),l(s,m),l(m,d),d.checked=~(i[4]||[]).indexOf(d.__value),i[24](d),l(m,g),l(m,v),l(s,C),l(s,B),l(B,A),D||(y=[Q(o,"change",i[19]),Q(b,"click",i[22]),Q(d,"change",i[23]),Q(B,"click",i[25])],D=!0)},p(O,S){S[0]&16&&(o.checked=~(O[4]||[]).indexOf(o.__value)),S[0]&4&&k!==(k=O[2]?O[2]+" km.":"Cargar km")&&we(I,k),S[0]&16&&(d.checked=~(O[4]||[]).indexOf(d.__value)),S[0]&8&&P!==(P=O[3]?O[3]+" litros":"Cargar gas")&&we(A,P)},d(O){O&&(a(e),a(_),a(s)),i[21](null),i[24](null),N.r(),D=!1,Ue(y)}}}function vn(i){let e=[],t=new Map,o,n=Be(i[12]);const r=h=>h[49].id_checklist_event;for(let h=0;h<n.length;h+=1){let f=gt(i,n,h),b=r(f);t.set(b,e[h]=Et(b,f))}return{c(){for(let h=0;h<e.length;h+=1)e[h].c();o=Ce()},l(h){for(let f=0;f<e.length;f+=1)e[f].l(h);o=Ce()},m(h,f){for(let b=0;b<e.length;b+=1)e[b]&&e[b].m(h,f);R(h,o,f)},p(h,f){f[0]&202864&&(n=Be(h[12]),e=tt(e,f,r,1,h,n,t,o.parentNode,nt,Et,o,gt))},d(h){h&&a(o);for(let f=0;f<e.length;f+=1)e[f].d(h)}}}function Et(i,e){let t,o,n,r=e[49],h,f,b=e[49].item+"",k,I,_,s,m=(e[11][e[49].id_checklist_event]?e[11][e[49].id_checklist_event]:"Cargar evidencia")+"",d,g,v,T,C,B,P;const A=()=>e[33](n,r),N=()=>e[33](null,r);function D(){return e[34](e[49])}function y(...O){return e[36](e[49],...O)}return C=pt(e[20][0]),{key:i,first:null,c(){t=c("ion-item"),o=c("ion-label"),n=c("input"),h=w(),f=c("p"),k=re(b),I=w(),_=c("ion-button"),s=c("label"),d=re(m),g=w(),v=c("input"),T=w(),this.h()},l(O){t=u(O,"ION-ITEM",{});var S=E(t);o=u(S,"ION-LABEL",{style:!0});var q=E(o);n=u(q,"INPUT",{id:!0,style:!0,type:!0}),h=L(q),f=u(q,"P",{style:!0});var M=E(f);k=ae(M,b),M.forEach(a),q.forEach(a),I=L(S),_=u(S,"ION-BUTTON",{fill:!0,class:!0,size:!0});var z=E(_);s=u(z,"LABEL",{for:!0});var x=E(s);d=ae(x,m),x.forEach(a),g=L(z),v=u(z,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0}),z.forEach(a),T=L(S),S.forEach(a),this.h()},h(){V(n,"id",`chkbox-${e[49].id_checklist_event}`),j(n,"pointer-events","auto"),V(n,"type","checkbox"),n.__value=e[49].id_checklist_event,jt(n,n.__value),n.required=!0,j(f,"margin-left","10px"),j(o,"display","flex"),V(s,"for","chklist-"+e[49].id_checklist_event),j(v,"display","none"),V(v,"id","chklist-"+e[49].id_checklist_event),V(v,"name","fileToUpload"),V(v,"type","file"),V(v,"accept","image/*"),p(_,"fill","outline"),p(_,"class","loadEvidence svelte-1lh6nay"),p(_,"size","small"),C.p(n),this.first=t},m(O,S){R(O,t,S),l(t,o),l(o,n),n.checked=~(e[4]||[]).indexOf(n.__value),A(),l(o,h),l(o,f),l(f,k),l(t,I),l(t,_),l(_,s),l(s,d),l(_,g),l(_,v),e[35](v),l(t,T),B||(P=[Q(n,"change",e[32]),Q(n,"change",D),Q(v,"change",y)],B=!0)},p(O,S){e=O,S[0]&16&&(n.checked=~(e[4]||[]).indexOf(n.__value)),r!==e[49]&&(N(),r=e[49],A()),S[0]&2048&&m!==(m=(e[11][e[49].id_checklist_event]?e[11][e[49].id_checklist_event]:"Cargar evidencia")+"")&&we(d,m)},d(O){O&&a(t),N(),e[35](null),C.r(),B=!1,Ue(P)}}}function bn(i){let e,t,o,n,r="Cancelar",h,f,b="Requerimientos de ruta",k,I,_,s,m,d,g,v="Confirmar",T,C;function B(D,y){return D[13]?mn:pn}let A=B(i)(i),N=i[12]&&vn(i);return{c(){e=c("ion-header"),t=c("ion-toolbar"),o=c("ion-buttons"),n=c("ion-button"),n.textContent=r,h=w(),f=c("ion-title"),f.textContent=b,k=w(),I=c("ion-content"),_=c("ion-list"),A.c(),s=w(),N&&N.c(),m=w(),d=c("ion-footer"),g=c("ion-button"),g.textContent=v,this.h()},l(D){e=u(D,"ION-HEADER",{translucent:!0});var y=E(e);t=u(y,"ION-TOOLBAR",{});var O=E(t);o=u(O,"ION-BUTTONS",{slot:!0});var S=E(o);n=u(S,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),K(n)!=="svelte-1dnmkxs"&&(n.textContent=r),S.forEach(a),h=L(O),f=u(O,"ION-TITLE",{"data-svelte-h":!0}),K(f)!=="svelte-ucox25"&&(f.textContent=b),O.forEach(a),y.forEach(a),k=L(D),I=u(D,"ION-CONTENT",{fullscreen:!0});var q=E(I);_=u(q,"ION-LIST",{});var M=E(_);A.l(M),s=L(M),N&&N.l(M),M.forEach(a),q.forEach(a),m=L(D),d=u(D,"ION-FOOTER",{});var z=E(d);g=u(z,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),K(g)!=="svelte-g82qqw"&&(g.textContent=v),z.forEach(a),this.h()},h(){p(n,"color","medium"),p(o,"slot","start"),p(e,"translucent",""),p(I,"fullscreen",""),p(g,"fill","outline"),p(g,"color","tertiary"),p(g,"strong",""),j(g,"width","99%"),j(g,"height","auto")},m(D,y){R(D,e,y),l(e,t),l(t,o),l(o,n),l(t,h),l(t,f),R(D,k,y),R(D,I,y),l(I,_),A.m(_,null),l(_,s),N&&N.m(_,null),R(D,m,y),R(D,d,y),l(d,g),T||(C=[Q(n,"click",i[14]),Q(g,"click",i[15])],T=!0)},p(D,y){A.p(D,y),D[12]&&N.p(D,y)},i:Ie,o:Ie,d(D){D&&(a(e),a(k),a(I),a(m),a(d)),A.d(),N&&N.d(),T=!1,Ue(C)}}}function _t(i,e){if(typeof i=="object"&&i!==null||Array.isArray(i)){if(Array.isArray(i))return i.map(t=>_t(t,e)).flat();{const t=Object.keys(i);let o;return e=="id_checklist_event"?o=t.filter(r=>r.toLowerCase().includes("id_checklist_event")).map(r=>i[r]):e=="mandatory"?o=t.filter(r=>r.toLowerCase().includes("mandatory")).map(r=>i[r]):(console.error("Tipo de dato no reconocido."),o=!1),o}}else return console.error("Invalid input. Please provide a valid object or array."),[]}function it(i,e){let t=new FormData;t.append("id_route",i),t.append("status",e),fetch("https://rutaflow-app-development.up.railway.app/api/admin/route/change_status.php",{method:"POST",body:t}).then(o=>o.json()).then(o=>{}).catch(o=>{console.error("Error fetching data:",o)})}function gn(i,e,t){let o=document.querySelector("ion-modal");const n=o.componentProps.checklist,r=o.componentProps.driverId,h=o.componentProps.routeId,f=o.componentProps.isLast;let b,k,I,_,s=[],m=null,d={},g,v,T,C,B={},P={};st(()=>{f?console.log("Último checklist"):ct.update(H=>(H.mandatory=_t(n,"mandatory"),H.items=_t(n,"id_checklist_event"),H))});const A=async()=>{await(await et.create({header:"Datos o checklist incompletos",message:"Carga la evidencia requerida y marca todas las casillas para confirmar",buttons:[{text:"Cerrar"}]})).present()},N=async()=>{await(await et.create({header:"Datos capturados",message:"El kilometraje y gasolina final fueron registrados correctamente, espere aprobación para finalizar ruta",buttons:[{text:"Cerrar"}]})).present()},D=async H=>{await(await et.create({header:"Datos inválidos",message:H=="km"?"Llena correctamente el campo de kilometraje inicial":"Llena correctamente el campo de gasolina inicial",buttons:[{text:"Cerrar"}]})).present()},y=()=>{ot.dismiss(),r?je(`/drivers/${r}`):je("/drivers/me")},O=()=>{if(f){var H=z(I,"km"),G=z(_,"gas");const ue=new FormData;ue.append("km_final",H),ue.append("gas_final",G),ue.append("id_route",h),H&&G?(y(),fetch("https://rutaflow-app-development.up.railway.app/api/admin/checklist/add_evidence.php",{method:"POST",body:ue}).then(ve=>ve.json()).then(ve=>{N()}).catch(ve=>{console.error("Error fetching data:",ve)})):A()}else{var ne=z(b,"km"),ce=z(k,"gas");ct.update(ue=>{const ve=ue.items,X=ue.mandatory;if(ve.every(Z=>ue.checkedIndices.includes(Z))&&ne&&ce){y();const Z=new FormData;for(const te in B)if(B.hasOwnProperty(te)){const{img:_e,img_id:W}=B[te];Z.append(`selectedImages[${te}][img]`,_e),Z.append(`selectedImages[${te}][img_id]`,W)}Z.append("km_inicial",ne),Z.append("gas_inicial",ce),Z.append("id_route",h),fetch("https://rutaflow-app-development.up.railway.app/api/admin/checklist/add_evidence.php",{method:"POST",body:Z}).then(te=>te.json()).then(te=>{X&&X[0]=="1"?it(h,"checklist-pending"):it(h,"enroute")}).catch(te=>{console.error("Error fetching data:",te)})}else if(!X&&ne&&ce){var oe=new FormData;oe.append("km_inicial",ne),oe.append("gas_inicial",ce),fetch("https://rutaflow-app-development.up.railway.app/api/admin/checklist/add_evidence.php",{method:"POST",body:oe}).then(Z=>Z.json()).then(Z=>{it(h,"enroute")}).catch(Z=>{console.error("Error fetching data:",Z)})}else A();return ue})}U()},S=async(H,G)=>{const ce=H.target.files[0],ue=await q(ce);if(ue){const ve=new FormData;ve.append("fileToUpload",ue);try{const X=await fetch("https://rutaflow-app-development.up.railway.app/api/admin/manager/upload_img_driver.php",{method:"POST",body:ve});if(X.ok){const Y=await X.json();B={...B,[G]:{img:Y.img,img_id:Y.img_id}},t(11,P={...P,[G]:Y.filename}),M(G),t(6,d[G].checked=!0,d)}else console.error("File upload failed:",X.statusText)}catch(X){console.error("Error during file upload:",X)}}},q=async H=>new Promise(G=>{const ne=new FileReader;ne.onload=ce=>{const ue=new Image;ue.src=ce.target.result,ue.onload=()=>{const ve=document.createElement("canvas"),X=ve.getContext("2d"),Y=800,oe=600;let Z=ue.width,te=ue.height;Z>Y&&(te*=Y/Z,Z=Y),te>oe&&(Z*=oe/te,te=oe),ve.width=Z,ve.height=te,X.drawImage(ue,0,0,Z,te),ve.toBlob(_e=>{G(_e)},"image/jpeg",.7)}},ne.readAsDataURL(H)}),M=H=>{ct.update(G=>(G.checkedIndices.indexOf(H)===-1?G.checkedIndices.push(H):console.error(`ID ${H} is already checked.`),G.items.forEach(ce=>{ce.id_checklist_event===H&&(ce.checked=!0)}),G))};function z(H,G){return/^\d+$/.test(H)?parseInt(H,10):(D(G),null)}function x(H,G){$(G),o.componentProps.data_type=G,Re("modal-gas-km",hn,{r:G}).then(()=>{Ge.subscribe(ne=>{ee(ne,G)})})}function $(H){qt.update(G=>({...G,flag:[H]}))}function ee(H,G){t(0,b=H.km_inicial?H.km_inicial:null),t(1,k=H.gas_inicial?H.gas_inicial:null),t(2,I=H.km_final?H.km_final:null),t(3,_=H.gas_final?H.gas_final:null),G=="km_inicial"&&t(7,g.checked=!0,g),G=="gas_inicial"&&t(8,v.checked=!0,v),G=="km_final"&&t(9,T.checked=!0,T),G=="gas_final"&&t(10,C.checked=!0,C)}function U(){Ge.set({km_inicial:[],gas_inicial:[],km_final:[],gas_final:[]})}const F=[[]];function J(){s=$e(F[0],this.__value,this.checked),t(4,s)}function le(H){Te[H?"unshift":"push"](()=>{T=H,t(9,T)})}const pe=H=>x(H,"km_final");function se(){s=$e(F[0],this.__value,this.checked),t(4,s)}function he(H){Te[H?"unshift":"push"](()=>{C=H,t(10,C)})}const Pe=H=>x(H,"gas_final");function ge(){s=$e(F[0],this.__value,this.checked),t(4,s)}function Le(H){Te[H?"unshift":"push"](()=>{g=H,t(7,g)})}const me=H=>x(H,"km_inicial");function fe(H){Te[H?"unshift":"push"](()=>{v=H,t(8,v)})}function ie(){s=$e(F[0],this.__value,this.checked),t(4,s)}const Ee=H=>x(H,"gas_inicial");function He(){s=$e(F[0],this.__value,this.checked),t(4,s)}function ke(H,G){Te[H?"unshift":"push"](()=>{d[G.id_checklist_event]=H,t(6,d)})}const Ne=H=>M(H.id_checklist_event);function De(H){Te[H?"unshift":"push"](()=>{m=H,t(5,m)})}return[b,k,I,_,s,m,d,g,v,T,C,P,n,f,y,O,S,M,x,J,F,le,pe,se,he,Pe,ge,Le,me,fe,ie,Ee,He,ke,Ne,De,(H,G)=>S(G,H.id_checklist_event)]}class zt extends Xe{constructor(e){super(),Je(this,e,gn,bn,We,{},null,[-1,-1])}}function En(i){let e,t,o,n,r,h="Teléfono",f,b,k=i[2].client_phone+"",I;return{c(){e=c("ion-item"),t=c("ion-icon"),o=w(),n=c("ion-label"),r=c("p"),r.textContent=h,f=w(),b=c("h2"),I=re(k),this.h()},l(_){e=u(_,"ION-ITEM",{href:!0});var s=E(e);t=u(s,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(a),o=L(s),n=u(s,"ION-LABEL",{class:!0});var m=E(n);r=u(m,"P",{"data-svelte-h":!0}),K(r)!=="svelte-9g5fr8"&&(r.textContent=h),f=L(m),b=u(m,"H2",{});var d=E(b);I=ae(d,k),d.forEach(a),m.forEach(a),s.forEach(a),this.h()},h(){p(t,"icon",Qt),p(t,"slot","start"),p(n,"class","ion-text-wrap"),p(e,"href","tel:"+i[2].client_phone)},m(_,s){R(_,e,s),l(e,t),l(e,o),l(e,n),l(n,r),l(n,f),l(n,b),l(b,I)},p:Ie,d(_){_&&a(e)}}}function In(i){let e,t,o,n,r,h="Domicilio 2",f,b,k=i[2].line2+"",I,_,s;return{c(){e=c("ion-item"),t=c("ion-icon"),o=w(),n=c("ion-label"),r=c("p"),r.textContent=h,f=w(),b=c("h2"),I=re(k),_=w(),s=c("ion-icon"),this.h()},l(m){e=u(m,"ION-ITEM",{href:!0});var d=E(e);t=u(d,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(a),o=L(d),n=u(d,"ION-LABEL",{class:!0});var g=E(n);r=u(g,"P",{"data-svelte-h":!0}),K(r)!=="svelte-1qy148r"&&(r.textContent=h),f=L(g),b=u(g,"H2",{});var v=E(b);I=ae(v,k),v.forEach(a),g.forEach(a),_=L(d),s=u(d,"ION-ICON",{icon:!0,slot:!0}),E(s).forEach(a),d.forEach(a),this.h()},h(){p(t,"icon",mt),p(t,"slot","start"),p(n,"class","ion-text-wrap"),p(s,"icon",Ye),p(s,"slot","end"),p(e,"href","https://www.google.com/maps/searhc/?api=1&query="+i[2].line2)},m(m,d){R(m,e,d),l(e,t),l(e,o),l(e,n),l(n,r),l(n,f),l(n,b),l(b,I),l(e,_),l(e,s)},p:Ie,d(m){m&&a(e)}}}function On(i){let e,t,o,n,r,h="Domicilio 1",f,b,k=i[2].line1+"",I,_,s,m,d=i[2].line2&&i[2].line2.trim().length,g,v=d&&kn(i);return{c(){e=c("ion-item"),t=c("ion-icon"),o=w(),n=c("ion-label"),r=c("p"),r.textContent=h,f=w(),b=c("h2"),I=re(k),_=w(),s=c("ion-icon"),m=w(),v&&v.c(),g=Ce(),this.h()},l(T){e=u(T,"ION-ITEM",{href:!0});var C=E(e);t=u(C,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(a),o=L(C),n=u(C,"ION-LABEL",{class:!0});var B=E(n);r=u(B,"P",{"data-svelte-h":!0}),K(r)!=="svelte-1ehcrdm"&&(r.textContent=h),f=L(B),b=u(B,"H2",{});var P=E(b);I=ae(P,k),P.forEach(a),B.forEach(a),_=L(C),s=u(C,"ION-ICON",{icon:!0,slot:!0}),E(s).forEach(a),C.forEach(a),m=L(T),v&&v.l(T),g=Ce(),this.h()},h(){p(t,"icon",mt),p(t,"slot","start"),p(n,"class","ion-text-wrap"),p(s,"icon",Ye),p(s,"slot","end"),p(e,"href","https://www.google.com/maps/search/?api=1&query="+i[2].line1)},m(T,C){R(T,e,C),l(e,t),l(e,o),l(e,n),l(n,r),l(n,f),l(n,b),l(b,I),l(e,_),l(e,s),R(T,m,C),v&&v.m(T,C),R(T,g,C)},p(T,C){d&&v.p(T,C)},d(T){T&&(a(e),a(m),a(g)),v&&v.d(T)}}}function kn(i){let e,t,o,n,r,h="Domicilio 2",f,b,k=i[2].line2+"",I,_,s;return{c(){e=c("ion-item"),t=c("ion-icon"),o=w(),n=c("ion-label"),r=c("p"),r.textContent=h,f=w(),b=c("h2"),I=re(k),_=w(),s=c("ion-icon"),this.h()},l(m){e=u(m,"ION-ITEM",{href:!0});var d=E(e);t=u(d,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(a),o=L(d),n=u(d,"ION-LABEL",{class:!0});var g=E(n);r=u(g,"P",{"data-svelte-h":!0}),K(r)!=="svelte-1qy148r"&&(r.textContent=h),f=L(g),b=u(g,"H2",{});var v=E(b);I=ae(v,k),v.forEach(a),g.forEach(a),_=L(d),s=u(d,"ION-ICON",{icon:!0,slot:!0}),E(s).forEach(a),d.forEach(a),this.h()},h(){p(t,"icon",mt),p(t,"slot","start"),p(n,"class","ion-text-wrap"),p(s,"icon",Ye),p(s,"slot","end"),p(e,"href","https://www.google.com/maps/search/?api=1&query="+i[2].line2)},m(m,d){R(m,e,d),l(e,t),l(e,o),l(e,n),l(n,r),l(n,f),l(n,b),l(b,I),l(e,_),l(e,s)},p:Ie,d(m){m&&a(e)}}}function Nn(i){let e,t=i[2].comments_ext!="<br>"&&Tn(i);return{c(){t&&t.c(),e=Ce()},l(o){t&&t.l(o),e=Ce()},m(o,n){t&&t.m(o,n),R(o,e,n)},p(o,n){o[2].comments_ext!="<br>"&&t.p(o,n)},d(o){o&&a(e),t&&t.d(o)}}}function Tn(i){let e,t,o,n,r,h="Notas de ubicación",f,b,k=i[2].comments_ext+"",I;return{c(){e=c("ion-item"),t=c("ion-icon"),o=w(),n=c("ion-label"),r=c("p"),r.textContent=h,f=w(),b=c("h2"),I=re(k),this.h()},l(_){e=u(_,"ION-ITEM",{});var s=E(e);t=u(s,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(a),o=L(s),n=u(s,"ION-LABEL",{class:!0});var m=E(n);r=u(m,"P",{"data-svelte-h":!0}),K(r)!=="svelte-nhm2ft"&&(r.textContent=h),f=L(m),b=u(m,"H2",{});var d=E(b);I=ae(d,k),d.forEach(a),m.forEach(a),s.forEach(a),this.h()},h(){p(t,"icon",Ht),p(t,"slot","start"),p(n,"class","ion-text-wrap")},m(_,s){R(_,e,s),l(e,t),l(e,o),l(e,n),l(n,r),l(n,f),l(n,b),l(b,I)},p:Ie,d(_){_&&a(e)}}}function yn(i){let e,t,o,n,r,h="Horarios",f,b,k=i[2].schedule+"",I;return{c(){e=c("ion-item"),t=c("ion-icon"),o=w(),n=c("ion-label"),r=c("p"),r.textContent=h,f=w(),b=c("h2"),I=re(k),this.h()},l(_){e=u(_,"ION-ITEM",{});var s=E(e);t=u(s,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(a),o=L(s),n=u(s,"ION-LABEL",{});var m=E(n);r=u(m,"P",{"data-svelte-h":!0}),K(r)!=="svelte-11q7hm5"&&(r.textContent=h),f=L(m),b=u(m,"H2",{});var d=E(b);I=ae(d,k),d.forEach(a),m.forEach(a),s.forEach(a),this.h()},h(){p(t,"icon",$t),p(t,"slot","start")},m(_,s){R(_,e,s),l(e,t),l(e,o),l(e,n),l(n,r),l(n,f),l(n,b),l(b,I)},p:Ie,d(_){_&&a(e)}}}function Cn(i){let e,t,o,n,r,h="Notas del operador",f,b,k=i[2].driver_comments+"",I;return{c(){e=c("ion-item"),t=c("ion-icon"),o=w(),n=c("ion-label"),r=c("p"),r.textContent=h,f=w(),b=c("h2"),I=re(k),this.h()},l(_){e=u(_,"ION-ITEM",{});var s=E(e);t=u(s,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(a),o=L(s),n=u(s,"ION-LABEL",{});var m=E(n);r=u(m,"P",{"data-svelte-h":!0}),K(r)!=="svelte-1yk9qp4"&&(r.textContent=h),f=L(m),b=u(m,"H2",{});var d=E(b);I=ae(d,k),d.forEach(a),m.forEach(a),s.forEach(a),this.h()},h(){p(t,"icon",Rt),p(t,"slot","start")},m(_,s){R(_,e,s),l(e,t),l(e,o),l(e,n),l(n,r),l(n,f),l(n,b),l(b,I)},p:Ie,d(_){_&&a(e)}}}function wn(i){let e,t=i[2].logistic_comments!="<br>"&&Ln(i);return{c(){t&&t.c(),e=Ce()},l(o){t&&t.l(o),e=Ce()},m(o,n){t&&t.m(o,n),R(o,e,n)},p(o,n){o[2].logistic_comments!="<br>"&&t.p(o,n)},d(o){o&&a(e),t&&t.d(o)}}}function Ln(i){let e,t,o,n,r,h="Comentarios logísticos",f,b,k=i[2].logistic_comments+"",I;return{c(){e=c("ion-item"),t=c("ion-icon"),o=w(),n=c("ion-label"),r=c("p"),r.textContent=h,f=w(),b=c("h2"),I=re(k),this.h()},l(_){e=u(_,"ION-ITEM",{});var s=E(e);t=u(s,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(a),o=L(s),n=u(s,"ION-LABEL",{class:!0});var m=E(n);r=u(m,"P",{"data-svelte-h":!0}),K(r)!=="svelte-1iz85r6"&&(r.textContent=h),f=L(m),b=u(m,"H2",{});var d=E(b);I=ae(d,k),d.forEach(a),m.forEach(a),s.forEach(a),this.h()},h(){p(t,"icon",Ht),p(t,"slot","start"),p(n,"class","ion-text-wrap")},m(_,s){R(_,e,s),l(e,t),l(e,o),l(e,n),l(n,r),l(n,f),l(n,b),l(b,I)},p:Ie,d(_){_&&a(e)}}}function It(i){let e,t,o;return{c(){e=c("section"),t=c("ion-img"),this.h()},l(n){e=u(n,"SECTION",{});var r=E(e);t=u(r,"ION-IMG",{src:!0,alt:!0,style:!0}),E(t).forEach(a),r.forEach(a),this.h()},h(){at(t.src,o=i[1])||p(t,"src",o),p(t,"alt","Evidencia fotográfica"),j(t,"max-width","100%"),j(t,"margin-top","16px")},m(n,r){R(n,e,r),l(e,t)},p(n,r){r&2&&!at(t.src,o=n[1])&&p(t,"src",o)},d(n){n&&a(e)}}}function Pn(i){let e,t,o,n,r="Cancelar",h,f,b=i[2].title+"",k,I,_,s,m="Confirmar",d,g,v,T,C,B,P,A,N="Cliente",D,y,O=i[2].client_name+"",S,q,M=i[2].client_phone&&i[2].client_phone.trim().length,z,x,$=i[2].comments_ext&&i[2].comments_ext.trim().length,ee,U=i[2].schedule&&i[2].schedule.trim().length,F,J,le=i[2].logistic_comments&&i[2].logistic_comments.trim().length,pe,se,he,Pe,ge,Le,me,fe,ie,Ee,He,ke,Ne="Subir Evidencia",De,Oe,H,G,ne,ce=M&&En(i);function ue(W,be){if(W[2].line1&&W[2].line1.trim().length)return On;if(W[2].line2&&W[2].line2.trim().length)return In}let ve=ue(i),X=ve&&ve(i),Y=$&&Nn(i),oe=U&&yn(i),Z=i[2].driver_comments&&Cn(i),te=le&&wn(i),_e=i[1]&&It(i);return{c(){e=c("ion-header"),t=c("ion-toolbar"),o=c("ion-buttons"),n=c("ion-button"),n.textContent=r,h=w(),f=c("ion-title"),k=re(b),I=w(),_=c("ion-buttons"),s=c("ion-button"),s.textContent=m,d=w(),g=c("ion-content"),v=c("ion-list"),T=c("ion-item"),C=c("ion-icon"),B=w(),P=c("ion-label"),A=c("p"),A.textContent=N,D=w(),y=c("h2"),S=re(O),q=w(),ce&&ce.c(),z=w(),X&&X.c(),x=w(),Y&&Y.c(),ee=w(),oe&&oe.c(),F=w(),Z&&Z.c(),J=w(),te&&te.c(),pe=w(),se=c("ion-item"),he=c("ion-icon"),Pe=w(),ge=c("ion-textarea"),Le=w(),me=c("section"),fe=c("label"),ie=c("ion-button"),Ee=c("ion-icon"),He=w(),ke=c("label"),ke.textContent=Ne,De=w(),Oe=c("input"),H=w(),_e&&_e.c(),this.h()},l(W){e=u(W,"ION-HEADER",{translucent:!0});var be=E(e);t=u(be,"ION-TOOLBAR",{});var Ae=E(t);o=u(Ae,"ION-BUTTONS",{slot:!0});var qe=E(o);n=u(qe,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),K(n)!=="svelte-1f8rjcf"&&(n.textContent=r),qe.forEach(a),h=L(Ae),f=u(Ae,"ION-TITLE",{title:!0});var Se=E(f);k=ae(Se,b),Se.forEach(a),I=L(Ae),_=u(Ae,"ION-BUTTONS",{slot:!0});var ze=E(_);s=u(ze,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),K(s)!=="svelte-1ida0il"&&(s.textContent=m),ze.forEach(a),Ae.forEach(a),be.forEach(a),d=L(W),g=u(W,"ION-CONTENT",{fullscreen:!0});var Ze=E(g);v=u(Ze,"ION-LIST",{});var de=E(v);T=u(de,"ION-ITEM",{});var Me=E(T);C=u(Me,"ION-ICON",{icon:!0,slot:!0}),E(C).forEach(a),B=L(Me),P=u(Me,"ION-LABEL",{});var Fe=E(P);A=u(Fe,"P",{"data-svelte-h":!0}),K(A)!=="svelte-jrq7ei"&&(A.textContent=N),D=L(Fe),y=u(Fe,"H2",{});var Qe=E(y);S=ae(Qe,O),Qe.forEach(a),Fe.forEach(a),Me.forEach(a),q=L(de),ce&&ce.l(de),z=L(de),X&&X.l(de),x=L(de),Y&&Y.l(de),ee=L(de),oe&&oe.l(de),F=L(de),Z&&Z.l(de),J=L(de),te&&te.l(de),pe=L(de),se=u(de,"ION-ITEM",{});var lt=E(se);he=u(lt,"ION-ICON",{icon:!0,slot:!0}),E(he).forEach(a),Pe=L(lt),ge=u(lt,"ION-TEXTAREA",{label:!0,placeholder:!0}),E(ge).forEach(a),lt.forEach(a),Le=L(de),me=u(de,"SECTION",{});var vt=E(me);fe=u(vt,"LABEL",{for:!0,style:!0});var bt=E(fe);ie=u(bt,"ION-BUTTON",{fill:!0,class:!0,expand:!0});var Ve=E(ie);Ee=u(Ve,"ION-ICON",{icon:!0,slot:!0}),E(Ee).forEach(a),He=L(Ve),ke=u(Ve,"LABEL",{for:!0,style:!0,"data-svelte-h":!0}),K(ke)!=="svelte-1as0od8"&&(ke.textContent=Ne),De=L(Ve),Oe=u(Ve,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0}),Ve.forEach(a),bt.forEach(a),vt.forEach(a),H=L(de),_e&&_e.l(de),de.forEach(a),Ze.forEach(a),this.h()},h(){p(n,"color","medium"),p(o,"slot","start"),p(f,"title",i[2].title),p(s,"strong",""),p(_,"slot","end"),p(e,"translucent",""),p(C,"icon",Zt),p(C,"slot","start"),p(he,"icon",ft),p(he,"slot","start"),p(ge,"label","Notas"),p(ge,"placeholder","Escribe aquí..."),p(Ee,"icon",Ut),p(Ee,"slot","start"),V(ke,"for","eventEvidence"),j(ke,"padding","8px 10px"),j(Oe,"display","none"),V(Oe,"id","eventEvidence"),V(Oe,"name","fileToUpload"),V(Oe,"type","file"),V(Oe,"accept","image/*"),p(ie,"fill","outline"),p(ie,"class","loadEvidence"),p(ie,"expand","block"),V(fe,"for","eventEvidence"),j(fe,"display","block"),j(fe,"width","100%"),p(g,"fullscreen","")},m(W,be){R(W,e,be),l(e,t),l(t,o),l(o,n),l(t,h),l(t,f),l(f,k),l(t,I),l(t,_),l(_,s),R(W,d,be),R(W,g,be),l(g,v),l(v,T),l(T,C),l(T,B),l(T,P),l(P,A),l(P,D),l(P,y),l(y,S),l(v,q),ce&&ce.m(v,null),l(v,z),X&&X.m(v,null),l(v,x),Y&&Y.m(v,null),l(v,ee),oe&&oe.m(v,null),l(v,F),Z&&Z.m(v,null),l(v,J),te&&te.m(v,null),l(v,pe),l(v,se),l(se,he),l(se,Pe),l(se,ge),i[6](ge),l(v,Le),l(v,me),l(me,fe),l(fe,ie),l(ie,Ee),l(ie,He),l(ie,ke),l(ie,De),l(ie,Oe),l(v,H),_e&&_e.m(v,null),G||(ne=[Q(n,"click",i[4]),Q(s,"click",i[5]),Q(Oe,"change",i[3])],G=!0)},p(W,[be]){M&&ce.p(W,be),X&&X.p(W,be),$&&Y.p(W,be),U&&oe.p(W,be),W[2].driver_comments&&Z.p(W,be),le&&te.p(W,be),W[1]?_e?_e.p(W,be):(_e=It(W),_e.c(),_e.m(v,null)):_e&&(_e.d(1),_e=null)},i:Ie,o:Ie,d(W){W&&(a(e),a(d),a(g)),ce&&ce.d(),X&&X.d(),Y&&Y.d(),oe&&oe.d(),Z&&Z.d(),te&&te.d(),i[6](null),_e&&_e.d(),G=!1,Ue(ne)}}}function An(i,e,t){let o=document.querySelector("ion-modal"),n=o.componentProps.delivery,r=o.componentProps.isLast,h=n.driver_comments?n.driver_comments:"",f=n.img?n.img:"",b="",k={latitude:null,longitude:null};const I=async T=>{const B=T.target.files[0],P=await _(B);if(P){const A=new FormData;A.append("fileToUpload",P);try{const N=await fetch("https://rutaflow-app-development.up.railway.app/api/admin/manager/upload_img_driver.php",{method:"POST",body:A});if(N.ok){const D=await N.json();t(1,f=D.img),b=D.img_id}else console.error("File upload failed:",N.statusText)}catch(N){console.error("Error during file upload:",N)}}},_=async T=>new Promise(C=>{const B=new FileReader;B.onload=P=>{const A=new Image;A.src=P.target.result,A.onload=()=>{const N=document.createElement("canvas"),D=N.getContext("2d"),y=800,O=600;let S=A.width,q=A.height;S>y&&(q*=y/S,S=y),q>O&&(S*=O/q,q=O),N.width=S,N.height=q,D.drawImage(A,0,0,S,q),N.toBlob(M=>{C(M)},"image/jpeg",.7)}},B.readAsDataURL(T)}),s=()=>{o.dismiss({data:Date.now()})},m=async()=>{try{const T=await g();if(console.log(T),T){const C={id_route:n.id_route,id_event:n.id_event,comments:h.value,img:f,img_id:b,lat:k.latitude,lon:k.longitude},B=new FormData;for(const y in C)B.append(y,C[y]);console.log(B);const A=await(await fetch("https://rutaflow-app-development.up.railway.app/api/admin/evidence/send_evidence.php",{method:"POST",body:B})).json();s();const N={},D=C.id_route;r&&d("","",D,r)}else console.log("No entré")}catch(T){console.error("Error fetching data:",T)}},d=(T,C,B,P)=>{o.componentProps.routeId=B,o.componentProps.driverId=n.id_driver,Re("modal-km-gas",zt,{checklist:T,driverId:C,routeId:B,isLast:P}).then(A=>{})},g=async()=>navigator.geolocation?new Promise((T,C)=>{navigator.geolocation.getCurrentPosition(B=>{k.latitude=B.coords.latitude,k.longitude=B.coords.longitude,T(!0)},B=>{console.error("Error getting location:",B),T(!1)})}):(console.error("Geolocation is not supported by your browser"),!1);function v(T){Te[T?"unshift":"push"](()=>{h=T,t(0,h)})}return[h,f,n,I,s,m,v]}class Sn extends Xe{constructor(e){super(),Je(this,e,An,Pn,We,{})}}function Ot(i){let e,t,o;return{c(){e=c("section"),t=c("ion-img"),this.h()},l(n){e=u(n,"SECTION",{});var r=E(e);t=u(r,"ION-IMG",{src:!0,alt:!0,style:!0}),E(t).forEach(a),r.forEach(a),this.h()},h(){at(t.src,o=i[0])||p(t,"src",o),p(t,"alt","Evidencia fotográfica"),j(t,"max-width","100%"),j(t,"margin-top","16px")},m(n,r){R(n,e,r),l(e,t)},p(n,r){r&1&&!at(t.src,o=n[0])&&p(t,"src",o)},d(n){n&&a(e)}}}function Bn(i){let e,t,o,n,r="Cancelar",h,f,b="Agregar Gasto",k,I,_,s,m,d,g,v,T,C,B,P,A,N,D,y,O,S,q='Tipo de pago <ion-text color="danger">(Obligatorio)</ion-text>',M,z,x="Efectivo",$,ee,U="Tarjeta",F,J,le="Transferencia",pe,se,he,Pe,ge,Le,me,fe,ie,Ee,He=`<ion-icon icon="${Ut}" slot="start"></ion-icon>
                        Subir Evidencia`,ke,Ne,De,Oe,H,G,ne,ce="Confirmar",ue,ve,X=i[0]&&Ot(i);return{c(){e=c("ion-header"),t=c("ion-toolbar"),o=c("ion-buttons"),n=c("ion-button"),n.textContent=r,h=w(),f=c("ion-title"),f.textContent=b,k=w(),I=c("ion-content"),_=c("ion-list"),s=c("ion-item"),m=c("ion-icon"),d=w(),g=c("ion-input"),v=w(),T=c("ion-item"),C=c("ion-icon"),B=w(),P=c("ion-input"),A=w(),N=c("ion-item"),D=c("ion-icon"),y=w(),O=c("ion-select"),S=c("div"),S.innerHTML=q,M=w(),z=c("ion-select-option"),z.textContent=x,$=w(),ee=c("ion-select-option"),ee.textContent=U,F=w(),J=c("ion-select-option"),J.textContent=le,pe=w(),se=c("ion-item"),he=c("ion-icon"),Pe=w(),ge=c("ion-textarea"),Le=w(),me=c("section"),fe=c("label"),ie=c("ion-button"),Ee=c("label"),Ee.innerHTML=He,ke=w(),Ne=c("input"),De=w(),X&&X.c(),Oe=w(),H=c("ion-footer"),G=c("ion-toolbar"),ne=c("ion-button"),ne.textContent=ce,this.h()},l(Y){e=u(Y,"ION-HEADER",{translucent:!0});var oe=E(e);t=u(oe,"ION-TOOLBAR",{});var Z=E(t);o=u(Z,"ION-BUTTONS",{slot:!0});var te=E(o);n=u(te,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),K(n)!=="svelte-1f8rjcf"&&(n.textContent=r),te.forEach(a),h=L(Z),f=u(Z,"ION-TITLE",{title:!0,"data-svelte-h":!0}),K(f)!=="svelte-10xvxus"&&(f.textContent=b),Z.forEach(a),oe.forEach(a),k=L(Y),I=u(Y,"ION-CONTENT",{fullscreen:!0});var _e=E(I);_=u(_e,"ION-LIST",{});var W=E(_);s=u(W,"ION-ITEM",{});var be=E(s);m=u(be,"ION-ICON",{icon:!0,slot:!0}),E(m).forEach(a),d=L(be),g=u(be,"ION-INPUT",{label:!0,type:!0,placeholder:!0,value:!0}),E(g).forEach(a),be.forEach(a),v=L(W),T=u(W,"ION-ITEM",{});var Ae=E(T);C=u(Ae,"ION-ICON",{icon:!0,slot:!0}),E(C).forEach(a),B=L(Ae),P=u(Ae,"ION-INPUT",{label:!0,type:!0,value:!0}),E(P).forEach(a),Ae.forEach(a),A=L(W),N=u(W,"ION-ITEM",{});var qe=E(N);D=u(qe,"ION-ICON",{icon:!0,slot:!0}),E(D).forEach(a),y=L(qe),O=u(qe,"ION-SELECT",{placeholder:!0,value:!0});var Se=E(O);S=u(Se,"DIV",{slot:!0,"data-svelte-h":!0}),K(S)!=="svelte-wl764p"&&(S.innerHTML=q),M=L(Se),z=u(Se,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),K(z)!=="svelte-i9crym"&&(z.textContent=x),$=L(Se),ee=u(Se,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),K(ee)!=="svelte-fx0z11"&&(ee.textContent=U),F=L(Se),J=u(Se,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),K(J)!=="svelte-1c24jf2"&&(J.textContent=le),Se.forEach(a),qe.forEach(a),pe=L(W),se=u(W,"ION-ITEM",{});var ze=E(se);he=u(ze,"ION-ICON",{icon:!0,slot:!0}),E(he).forEach(a),Pe=L(ze),ge=u(ze,"ION-TEXTAREA",{label:!0,placeholder:!0}),E(ge).forEach(a),ze.forEach(a),Le=L(W),me=u(W,"SECTION",{});var Ze=E(me);fe=u(Ze,"LABEL",{for:!0,style:!0});var de=E(fe);ie=u(de,"ION-BUTTON",{fill:!0,size:!0,class:!0,expand:!0});var Me=E(ie);Ee=u(Me,"LABEL",{for:!0,style:!0,"data-svelte-h":!0}),K(Ee)!=="svelte-1m9yw22"&&(Ee.innerHTML=He),ke=L(Me),Ne=u(Me,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0}),Me.forEach(a),de.forEach(a),Ze.forEach(a),De=L(W),X&&X.l(W),W.forEach(a),_e.forEach(a),Oe=L(Y),H=u(Y,"ION-FOOTER",{});var Fe=E(H);G=u(Fe,"ION-TOOLBAR",{});var Qe=E(G);ne=u(Qe,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),K(ne)!=="svelte-1c7dl3f"&&(ne.textContent=ce),Qe.forEach(a),Fe.forEach(a),this.h()},h(){p(n,"color","medium"),p(o,"slot","start"),p(f,"title",""),p(e,"translucent",""),p(m,"icon",Rt),p(m,"slot","start"),p(g,"label","Concepto"),p(g,"type","text"),p(g,"placeholder","Escribe aquí..."),p(g,"value",i[5]?i[5]:""),p(C,"icon",ft),p(C,"slot","start"),p(P,"label","Cantidad"),p(P,"type","number"),p(P,"value",i[6]?i[6]:""),p(D,"icon",en),p(D,"slot","start"),V(S,"slot","label"),p(z,"value","cash"),p(ee,"value","card"),p(J,"value","transfer"),p(O,"placeholder","Tipo de pago"),p(O,"value",i[7]?i[7]:""),p(he,"icon",ft),p(he,"slot","start"),p(ge,"label","Comentarios"),p(ge,"placeholder","Escribe aquí..."),V(Ee,"for","eventEvidence"),j(Ee,"width","100%"),j(Ee,"padding","8px"),j(Ne,"display","none"),V(Ne,"id","eventEvidence"),V(Ne,"name","fileToUpload"),V(Ne,"type","file"),V(Ne,"accept","image/*"),p(ie,"fill","outline"),p(ie,"size","small"),p(ie,"class","loadEvidence"),p(ie,"expand","block"),V(fe,"for","eventEvidence"),j(fe,"display","block"),j(fe,"width","100%"),p(I,"fullscreen",""),p(ne,"fill","outline"),p(ne,"color","tertiary"),p(ne,"strong",""),j(ne,"width","99%"),j(ne,"height","auto")},m(Y,oe){R(Y,e,oe),l(e,t),l(t,o),l(o,n),l(t,h),l(t,f),R(Y,k,oe),R(Y,I,oe),l(I,_),l(_,s),l(s,m),l(s,d),l(s,g),i[11](g),l(_,v),l(_,T),l(T,C),l(T,B),l(T,P),i[12](P),l(_,A),l(_,N),l(N,D),l(N,y),l(N,O),l(O,S),l(O,M),l(O,z),l(O,$),l(O,ee),l(O,F),l(O,J),i[13](O),l(_,pe),l(_,se),l(se,he),l(se,Pe),l(se,ge),i[14](ge),l(_,Le),l(_,me),l(me,fe),l(fe,ie),l(ie,Ee),l(ie,ke),l(ie,Ne),l(_,De),X&&X.m(_,null),R(Y,Oe,oe),R(Y,H,oe),l(H,G),l(G,ne),ue||(ve=[Q(n,"click",i[9]),Q(Ne,"change",i[8]),Q(ne,"click",i[10])],ue=!0)},p(Y,[oe]){Y[0]?X?X.p(Y,oe):(X=Ot(Y),X.c(),X.m(_,null)):X&&(X.d(1),X=null)},i:Ie,o:Ie,d(Y){Y&&(a(e),a(k),a(I),a(Oe),a(H)),i[11](null),i[12](null),i[13](null),i[14](null),X&&X.d(),ue=!1,Ue(ve)}}}function Dn(i,e,t){let o=document.querySelector("ion-modal"),n=o.componentProps.routeId,r=o.componentProps.ex_concept,h=o.componentProps.ex_amount,f=o.componentProps.ex_type,b=o.componentProps.id_expense,k="",I="",_="",s=0,m="",d="";st(()=>{});const g=async(y,O)=>{await(await et.create({header:y||"Error",message:O||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()},v=async y=>{const S=y.target.files[0],q=await T(S);if(q){const M=new FormData;M.append("fileToUpload",q);try{const z=await fetch("https://rutaflow-app-development.up.railway.app/api/admin/manager/upload_img_driver.php",{method:"POST",body:M});if(z.ok){const x=await z.json();t(0,k=x.img),I=x.img_id}else console.error("File upload failed:",z.statusText)}catch(z){console.error("Error during file upload:",z)}}},T=async y=>new Promise(O=>{const S=new FileReader;S.onload=q=>{const M=new Image;M.src=q.target.result,M.onload=()=>{const z=document.createElement("canvas"),x=z.getContext("2d"),$=800,ee=600;let U=M.width,F=M.height;U>$&&(F*=$/U,U=$),F>ee&&(U*=ee/F,F=ee),z.width=U,z.height=F,x.drawImage(M,0,0,U,F),z.toBlob(J=>{O(J)},"image/jpeg",.7)}},S.readAsDataURL(y)}),C=()=>{ot.dismiss()},B=()=>{var y=new Object;y.id_route=n,y.comments=m.value,y.type=_.value,y.img=k,y.img_id=I,y.amount=s.value,y.concept=d.value,y.status="done",y.id_expense=b||"null";const O=new FormData;for(const S in y)O.append(S,y[S]);!I||!k||!m.value||!s.value||!d.value?g("Datos incompletos","Llena los datos requeridos para completar el registro"):fetch("https://rutaflow-app-development.up.railway.app/api/admin/expenses/add_expense.php",{method:"POST",body:O}).then(S=>S.json()).then(S=>{C()}).catch(S=>{console.error("Error fetching data:",S)})};function P(y){Te[y?"unshift":"push"](()=>{d=y,t(4,d)})}function A(y){Te[y?"unshift":"push"](()=>{s=y,t(2,s)})}function N(y){Te[y?"unshift":"push"](()=>{_=y,t(1,_)})}function D(y){Te[y?"unshift":"push"](()=>{m=y,t(3,m)})}return[k,_,s,m,d,r,h,f,v,C,B,P,A,N,D]}class dt extends Xe{constructor(e){super(),Je(this,e,Dn,Bn,We,{})}}function kt(i,e,t){const o=i.slice();return o[7]=e[t],o}function Mn(i){let e,t="Cargar gasto",o,n;function r(...h){return i[4](i[7],...h)}return{c(){e=c("ion-button"),e.textContent=t,this.h()},l(h){e=u(h,"ION-BUTTON",{fill:!0,size:!0,"aria-selected":!0,"data-svelte-h":!0}),K(e)!=="svelte-175aelj"&&(e.textContent=t),this.h()},h(){p(e,"fill","outline"),p(e,"size","small"),p(e,"aria-selected","")},m(h,f){R(h,e,f),o||(n=Q(e,"click",r),o=!0)},p(h,f){i=h},d(h){h&&a(e),o=!1,n()}}}function Un(i){let e,t="Gasto completado";return{c(){e=c("ion-button"),e.textContent=t,this.h()},l(o){e=u(o,"ION-BUTTON",{fill:!0,size:!0,"aria-selected":!0,"data-svelte-h":!0}),K(e)!=="svelte-tlger7"&&(e.textContent=t),this.h()},h(){p(e,"fill","solid"),p(e,"size","small"),p(e,"aria-selected","")},m(o,n){R(o,e,n)},p:Ie,d(o){o&&a(e)}}}function Nt(i,e){let t,o,n,r=e[7].concept+"",h,f,b;function k(s,m){return s[7].status=="done"?Un:Mn}let _=k(e)(e);return{key:i,first:null,c(){t=c("ion-item"),o=c("ion-label"),n=c("p"),h=re(r),f=w(),_.c(),b=w(),this.h()},l(s){t=u(s,"ION-ITEM",{});var m=E(t);o=u(m,"ION-LABEL",{style:!0});var d=E(o);n=u(d,"P",{style:!0});var g=E(n);h=ae(g,r),g.forEach(a),d.forEach(a),f=L(m),_.l(m),b=L(m),m.forEach(a),this.h()},h(){j(n,"margin-left","10px"),j(o,"display","flex"),this.first=t},m(s,m){R(s,t,m),l(t,o),l(o,n),l(n,h),l(t,f),_.m(t,null),l(t,b)},p(s,m){e=s,_.p(e,m)},d(s){s&&a(t),_.d()}}}function Hn(i){let e,t,o,n,r=`<ion-icon style="font-size: 25px!important;" icon="${tn}"></ion-icon>`,h,f,b="Lista de gastos",k,I,_,s=[],m=new Map,d,g,v,T="Cerrar",C,B,P=Be(i[0]);const A=N=>N[7].id_expenses;for(let N=0;N<P.length;N+=1){let D=kt(i,P,N),y=A(D);m.set(y,s[N]=Nt(y,D))}return{c(){e=c("ion-header"),t=c("ion-toolbar"),o=c("ion-buttons"),n=c("ion-button"),n.innerHTML=r,h=w(),f=c("ion-title"),f.textContent=b,k=w(),I=c("ion-content"),_=c("ion-list");for(let N=0;N<s.length;N+=1)s[N].c();d=w(),g=c("ion-footer"),v=c("ion-button"),v.textContent=T,this.h()},l(N){e=u(N,"ION-HEADER",{translucent:!0});var D=E(e);t=u(D,"ION-TOOLBAR",{});var y=E(t);o=u(y,"ION-BUTTONS",{slot:!0});var O=E(o);n=u(O,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),K(n)!=="svelte-160xz3i"&&(n.innerHTML=r),O.forEach(a),h=L(y),f=u(y,"ION-TITLE",{"data-svelte-h":!0}),K(f)!=="svelte-e3wnox"&&(f.textContent=b),y.forEach(a),D.forEach(a),k=L(N),I=u(N,"ION-CONTENT",{fullscreen:!0});var S=E(I);_=u(S,"ION-LIST",{});var q=E(_);for(let z=0;z<s.length;z+=1)s[z].l(q);q.forEach(a),S.forEach(a),d=L(N),g=u(N,"ION-FOOTER",{});var M=E(g);v=u(M,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),K(v)!=="svelte-zv7v83"&&(v.textContent=T),M.forEach(a),this.h()},h(){p(n,"color","medium"),p(o,"slot","end"),p(e,"translucent",""),p(I,"fullscreen",""),p(v,"fill","outline"),p(v,"color","tertiary"),p(v,"strong",""),j(v,"width","99%"),j(v,"height","auto")},m(N,D){R(N,e,D),l(e,t),l(t,o),l(o,n),l(t,h),l(t,f),R(N,k,D),R(N,I,D),l(I,_);for(let y=0;y<s.length;y+=1)s[y]&&s[y].m(_,null);R(N,d,D),R(N,g,D),l(g,v),C||(B=[Q(n,"click",i[3]),Q(v,"click",i[1])],C=!0)},p(N,[D]){D&5&&(P=Be(N[0]),s=tt(s,D,A,1,N,P,m,_,nt,Nt,null,kt))},i:Ie,o:Ie,d(N){N&&(a(e),a(k),a(I),a(d),a(g));for(let D=0;D<s.length;D+=1)s[D].d();C=!1,Ue(B)}}}function Rn(i){let e=document.querySelector("ion-modal");e.componentProps.routeId;let t=e.componentProps.expenses;st(()=>{});const o=()=>{ot.dismiss()};function n(f,b,k,I,_){e.componentProps.ex_amount=k,e.componentProps.ex_concept=b,e.componentProps.ex_type=I,e.componentProps.id_expense=_,Re("modal-expense",dt,{amount:k,concept:b,type:I,id_expense:_}).then(()=>{}),o()}return[t,o,n,f=>{Re("modal-expense",dt,{routeId:f}).then(b=>{}),o()},(f,b)=>n(b,f.concept,f.amount,f.type,f.id_expenses)]}class qn extends Xe{constructor(e){super(),Je(this,e,Rn,Hn,We,{})}}function Tt(i,e,t){const o=i.slice();return o[30]=e[t],o}function yt(i,e,t){const o=i.slice();return o[30]=e[t],o[32]=t,o}function Ct(i,e,t){const o=i.slice();return o[30]=e[t],o[32]=t,o}function wt(i){let e,t;return e=new rn({props:{$$slots:{default:[Gn]},$$scope:{ctx:i}}}),{c(){xt(e.$$.fragment)},l(o){Wt(e.$$.fragment,o)},m(o,n){Xt(e,o,n),t=!0},p(o,n){const r={};n[0]&507|n[1]&32&&(r.$$scope={dirty:n,ctx:o}),e.$set(r)},i(o){t||(rt(e.$$.fragment,o),t=!0)},o(o){ut(e.$$.fragment,o),t=!1},d(o){Jt(e,o)}}}function zn(i){let e,t,o,n='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Jala para actualizar" refreshing-spinner="circles" refreshing-text="Actualizando..."></ion-refresher-content>',r,h,f=[],b=new Map,k,I,_=i[4]&&Lt(i),s=Be(i[5]);const m=d=>d[30].id_event;for(let d=0;d<s.length;d+=1){let g=Tt(i,s,d),v=m(g);b.set(v,f[d]=At(v,g))}return{c(){_&&_.c(),e=w(),t=c("ion-content"),o=c("ion-refresher"),o.innerHTML=n,r=w(),h=c("ion-list");for(let d=0;d<f.length;d+=1)f[d].c();this.h()},l(d){_&&_.l(d),e=L(d),t=u(d,"ION-CONTENT",{});var g=E(t);o=u(g,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),K(o)!=="svelte-19e7x43"&&(o.innerHTML=n),r=L(g),h=u(g,"ION-LIST",{});var v=E(h);for(let T=0;T<f.length;T+=1)f[T].l(v);v.forEach(a),g.forEach(a),this.h()},h(){p(o,"slot","fixed")},m(d,g){_&&_.m(d,g),R(d,e,g),R(d,t,g),l(t,o),i[23](o),l(t,r),l(t,h);for(let v=0;v<f.length;v+=1)f[v]&&f[v].m(h,null);k||(I=Q(o,"ionRefresh",i[9]),k=!0)},p(d,g){d[4]?_?_.p(d,g):(_=Lt(d),_.c(),_.m(e.parentNode,e)):_&&(_.d(1),_=null),g[0]&42016&&(s=Be(d[5]),f=tt(f,g,m,1,d,s,b,h,nt,At,null,Tt))},d(d){d&&(a(e),a(t)),_&&_.d(d),i[23](null);for(let g=0;g<f.length;g+=1)f[g].d();k=!1,I()}}}function Fn(i){let e,t;function o(h,f){return f[0]&128&&(e=null),e==null&&(e=!!h[7].every(Wn)),e?Vn:jn}let n=o(i,[-1,-1]),r=n(i);return{c(){r.c(),t=Ce()},l(h){r.l(h),t=Ce()},m(h,f){r.m(h,f),R(h,t,f)},p(h,f){n===(n=o(h,f))&&r?r.p(h,f):(r.d(1),r=n(h),r&&(r.c(),r.m(t.parentNode,t)))},d(h){h&&a(t),r.d(h)}}}function Lt(i){let e=i[11]("",i[1],i[0])+"",t;return{c(){t=re(e)},l(o){t=ae(o,e)},m(o,n){R(o,t,n)},p(o,n){n[0]&3&&e!==(e=o[11]("",o[1],o[0])+"")&&we(t,e)},d(o){o&&a(t)}}}function Pt(i){let e;return{c(){e=c("span"),this.h()},l(t){e=u(t,"SPAN",{class:!0}),E(e).forEach(a),this.h()},h(){V(e,"class","notes svelte-ziybgw")},m(t,o){R(t,e,o)},d(t){t&&a(e)}}}function At(i,e){let t,o,n,r,h=parseInt(e[30].pos)+1+"",f,b,k,I,_,s,m=e[30].title+"",d,g,v=e[30].support_list&&e[30].support_list.length||e[13](e[30]),T,C,B,P,A,N=v&&Pt();function D(){return e[24](e[30])}return{key:i,first:null,c(){t=c("ion-item"),o=c("ion-avatar"),n=c("div"),r=c("div"),f=re(h),k=w(),I=c("ion-label"),_=c("ion-text"),s=c("h3"),d=re(m),g=w(),N&&N.c(),T=w(),C=c("ion-icon"),B=w(),this.h()},l(y){t=u(y,"ION-ITEM",{});var O=E(t);o=u(O,"ION-AVATAR",{slot:!0});var S=E(o);n=u(S,"DIV",{class:!0,title:!0,style:!0});var q=E(n);r=u(q,"DIV",{class:!0});var M=E(r);f=ae(M,h),M.forEach(a),q.forEach(a),S.forEach(a),k=L(O),I=u(O,"ION-LABEL",{button:!0});var z=E(I);_=u(z,"ION-TEXT",{color:!0});var x=E(_);s=u(x,"H3",{});var $=E(s);d=ae($,m),g=L($),N&&N.l($),$.forEach(a),x.forEach(a),z.forEach(a),T=L(O),C=u(O,"ION-ICON",{icon:!0,slot:!0,style:!0}),E(C).forEach(a),B=L(O),O.forEach(a),this.h()},h(){V(r,"class","order svelte-ziybgw"),V(n,"class","order-wrapper svelte-ziybgw"),V(n,"title",b=Ke(e[30].status)),j(n,"background-color",ye(e[30])),j(n,"color",xe(ye(e[30]))),p(o,"slot","start"),p(_,"color","#2e2e2e"),p(I,"button",""),p(C,"icon",Ye),p(C,"slot","end"),j(C,"color",ye(e[30])),this.first=t},m(y,O){R(y,t,O),l(t,o),l(o,n),l(n,r),l(r,f),l(t,k),l(t,I),l(I,_),l(_,s),l(s,d),l(s,g),N&&N.m(s,null),l(t,T),l(t,C),l(t,B),P||(A=Q(I,"click",D),P=!0)},p(y,O){e=y,O[0]&32&&h!==(h=parseInt(e[30].pos)+1+"")&&we(f,h),O[0]&32&&b!==(b=Ke(e[30].status))&&V(n,"title",b),O[0]&32&&j(n,"background-color",ye(e[30])),O[0]&32&&j(n,"color",xe(ye(e[30]))),O[0]&32&&m!==(m=e[30].title+"")&&we(d,m),O[0]&32&&(v=e[30].support_list&&e[30].support_list.length||e[13](e[30])),v?N||(N=Pt(),N.c(),N.m(s,null)):N&&(N.d(1),N=null),O[0]&32&&j(C,"color",ye(e[30]))},d(y){y&&a(t),N&&N.d(),P=!1,A()}}}function jn(i){let e=i[11](i[7],i[1],i[0])+"",t,o,n,r,h='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Pull to refresh" refreshing-spinner="circles" refreshing-text="Refreshing..."></ion-refresher-content>',f,b,k=[],I=new Map,_,s,m=Be(i[5]);const d=g=>g[30].id_event;for(let g=0;g<m.length;g+=1){let v=yt(i,m,g),T=d(v);I.set(T,k[g]=Bt(T,v))}return{c(){t=re(e),o=w(),n=c("ion-content"),r=c("ion-refresher"),r.innerHTML=h,f=w(),b=c("ion-list");for(let g=0;g<k.length;g+=1)k[g].c();this.h()},l(g){t=ae(g,e),o=L(g),n=u(g,"ION-CONTENT",{});var v=E(n);r=u(v,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),K(r)!=="svelte-1poui8g"&&(r.innerHTML=h),f=L(v),b=u(v,"ION-LIST",{});var T=E(b);for(let C=0;C<k.length;C+=1)k[C].l(T);T.forEach(a),v.forEach(a),this.h()},h(){p(r,"slot","fixed")},m(g,v){R(g,t,v),R(g,o,v),R(g,n,v),l(n,r),i[21](r),l(n,f),l(n,b);for(let T=0;T<k.length;T+=1)k[T]&&k[T].m(b,null);_||(s=Q(r,"ionRefresh",i[9]),_=!0)},p(g,v){v[0]&131&&e!==(e=g[11](g[7],g[1],g[0])+"")&&we(t,e),v[0]&74784&&(m=Be(g[5]),k=tt(k,v,d,1,g,m,I,b,nt,Bt,null,yt))},d(g){g&&(a(t),a(o),a(n)),i[21](null);for(let v=0;v<k.length;v+=1)k[v].d();_=!1,s()}}}function Vn(i){let e,t,o='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Jale para actualizar" refreshing-spinner="circles" refreshing-text="Actualizando..."></ion-refresher-content>',n,r,h=[],f=new Map,b,k,I=Be(i[5]);const _=s=>s[30].id_event;for(let s=0;s<I.length;s+=1){let m=Ct(i,I,s),d=_(m);f.set(d,h[s]=Mt(d,m))}return{c(){e=c("ion-content"),t=c("ion-refresher"),t.innerHTML=o,n=w(),r=c("ion-list");for(let s=0;s<h.length;s+=1)h[s].c();this.h()},l(s){e=u(s,"ION-CONTENT",{});var m=E(e);t=u(m,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),K(t)!=="svelte-1t1tzpj"&&(t.innerHTML=o),n=L(m),r=u(m,"ION-LIST",{});var d=E(r);for(let g=0;g<h.length;g+=1)h[g].l(d);d.forEach(a),m.forEach(a),this.h()},h(){p(t,"slot","fixed")},m(s,m){R(s,e,m),l(e,t),i[19](t),l(e,n),l(e,r);for(let d=0;d<h.length;d+=1)h[d]&&h[d].m(r,null);b||(k=Q(t,"ionRefresh",i[9]),b=!0)},p(s,m){m[0]&74784&&(I=Be(s[5]),h=tt(h,m,_,1,s,I,f,r,nt,Mt,null,Ct))},d(s){s&&a(e),i[19](null);for(let m=0;m<h.length;m+=1)h[m].d();b=!1,k()}}}function St(i){let e;return{c(){e=c("span"),this.h()},l(t){e=u(t,"SPAN",{class:!0}),E(e).forEach(a),this.h()},h(){V(e,"class","notes svelte-ziybgw")},m(t,o){R(t,e,o)},d(t){t&&a(e)}}}function Bt(i,e){let t,o,n,r,h=parseInt(e[30].pos)+1+"",f,b,k,I,_,s,m=e[30].title+"",d,g,v=e[30].support_list&&e[30].support_list.length||e[13](e[30]),T,C,B="",P,A,N,D,y,O=v&&St();function S(){return e[22](e[30],e[32])}return{key:i,first:null,c(){t=c("ion-item"),o=c("ion-avatar"),n=c("div"),r=c("div"),f=re(h),k=w(),I=c("ion-label"),_=c("ion-text"),s=c("h3"),d=re(m),g=w(),O&&O.c(),T=w(),C=c("div"),C.innerHTML=B,P=w(),A=c("ion-icon"),N=w(),this.h()},l(q){t=u(q,"ION-ITEM",{});var M=E(t);o=u(M,"ION-AVATAR",{slot:!0});var z=E(o);n=u(z,"DIV",{class:!0,title:!0,style:!0});var x=E(n);r=u(x,"DIV",{class:!0});var $=E(r);f=ae($,h),$.forEach(a),x.forEach(a),z.forEach(a),k=L(M),I=u(M,"ION-LABEL",{button:!0});var ee=E(I);_=u(ee,"ION-TEXT",{color:!0});var U=E(_);s=u(U,"H3",{});var F=E(s);d=ae(F,m),g=L(F),O&&O.l(F),F.forEach(a),U.forEach(a),T=L(ee),C=u(ee,"DIV",{class:!0,"data-svelte-h":!0}),K(C)!=="svelte-130ohbs"&&(C.innerHTML=B),ee.forEach(a),P=L(M),A=u(M,"ION-ICON",{icon:!0,slot:!0}),E(A).forEach(a),N=L(M),M.forEach(a),this.h()},h(){V(r,"class","order svelte-ziybgw"),V(n,"class","order-wrapper svelte-ziybgw"),V(n,"title",b=Ke(e[30].status)),j(n,"background-color",ye(e[30])),j(n,"color",xe(ye(e[30]))),p(o,"slot","start"),p(_,"color","#2e2e2e"),V(C,"class","sub svelte-ziybgw"),p(I,"button",""),p(A,"icon",Ye),p(A,"slot","end"),this.first=t},m(q,M){R(q,t,M),l(t,o),l(o,n),l(n,r),l(r,f),l(t,k),l(t,I),l(I,_),l(_,s),l(s,d),l(s,g),O&&O.m(s,null),l(I,T),l(I,C),l(t,P),l(t,A),l(t,N),D||(y=Q(I,"click",S),D=!0)},p(q,M){e=q,M[0]&32&&h!==(h=parseInt(e[30].pos)+1+"")&&we(f,h),M[0]&32&&b!==(b=Ke(e[30].status))&&V(n,"title",b),M[0]&32&&j(n,"background-color",ye(e[30])),M[0]&32&&j(n,"color",xe(ye(e[30]))),M[0]&32&&m!==(m=e[30].title+"")&&we(d,m),M[0]&32&&(v=e[30].support_list&&e[30].support_list.length||e[13](e[30])),v?O||(O=St(),O.c(),O.m(s,null)):O&&(O.d(1),O=null)},d(q){q&&a(t),O&&O.d(),D=!1,y()}}}function Dt(i){let e;return{c(){e=c("span"),this.h()},l(t){e=u(t,"SPAN",{class:!0}),E(e).forEach(a),this.h()},h(){V(e,"class","notes svelte-ziybgw")},m(t,o){R(t,e,o)},d(t){t&&a(e)}}}function Mt(i,e){let t,o,n,r,h=parseInt(e[30].pos)+1+"",f,b,k,I,_,s,m=e[30].title+"",d,g,v=e[30].support_list&&e[30].support_list.length||e[13](e[30]),T,C,B="",P,A,N,D,y,O=v&&Dt();function S(){return e[20](e[30],e[32])}return{key:i,first:null,c(){t=c("ion-item"),o=c("ion-avatar"),n=c("div"),r=c("div"),f=re(h),k=w(),I=c("ion-label"),_=c("ion-text"),s=c("h3"),d=re(m),g=w(),O&&O.c(),T=w(),C=c("div"),C.innerHTML=B,P=w(),A=c("ion-icon"),N=w(),this.h()},l(q){t=u(q,"ION-ITEM",{});var M=E(t);o=u(M,"ION-AVATAR",{slot:!0});var z=E(o);n=u(z,"DIV",{class:!0,title:!0,style:!0});var x=E(n);r=u(x,"DIV",{class:!0});var $=E(r);f=ae($,h),$.forEach(a),x.forEach(a),z.forEach(a),k=L(M),I=u(M,"ION-LABEL",{button:!0});var ee=E(I);_=u(ee,"ION-TEXT",{color:!0});var U=E(_);s=u(U,"H3",{});var F=E(s);d=ae(F,m),g=L(F),O&&O.l(F),F.forEach(a),U.forEach(a),T=L(ee),C=u(ee,"DIV",{class:!0,"data-svelte-h":!0}),K(C)!=="svelte-130ohbs"&&(C.innerHTML=B),ee.forEach(a),P=L(M),A=u(M,"ION-ICON",{icon:!0,slot:!0}),E(A).forEach(a),N=L(M),M.forEach(a),this.h()},h(){V(r,"class","order svelte-ziybgw"),V(n,"class","order-wrapper svelte-ziybgw"),V(n,"title",b=Ke(e[30].status)),j(n,"background-color",ye(e[30])),j(n,"color",xe(ye(e[30]))),p(o,"slot","start"),p(_,"color","#2e2e2e"),V(C,"class","sub svelte-ziybgw"),p(I,"button",""),p(A,"icon",Ye),p(A,"slot","end"),this.first=t},m(q,M){R(q,t,M),l(t,o),l(o,n),l(n,r),l(r,f),l(t,k),l(t,I),l(I,_),l(_,s),l(s,d),l(s,g),O&&O.m(s,null),l(I,T),l(I,C),l(t,P),l(t,A),l(t,N),D||(y=Q(I,"click",S),D=!0)},p(q,M){e=q,M[0]&32&&h!==(h=parseInt(e[30].pos)+1+"")&&we(f,h),M[0]&32&&b!==(b=Ke(e[30].status))&&V(n,"title",b),M[0]&32&&j(n,"background-color",ye(e[30])),M[0]&32&&j(n,"color",xe(ye(e[30]))),M[0]&32&&m!==(m=e[30].title+"")&&we(d,m),M[0]&32&&(v=e[30].support_list&&e[30].support_list.length||e[13](e[30])),v?O||(O=Dt(),O.c(),O.m(s,null)):O&&(O.d(1),O=null)},d(q){q&&a(t),O&&O.d(),D=!1,y()}}}function Gn(i){let e,t,o,n,r=`<ion-icon icon="${nn}"></ion-icon>`,h,f,b,k=`<ion-icon icon="${on}"></ion-icon>`,I,_,s=i[6].name+"",m,d,g,v,T;function C(A,N){if(A[7].length>0)return Fn;if(!A[3])return zn}let B=C(i),P=B&&B(i);return{c(){e=c("ion-header"),t=c("ion-toolbar"),o=c("ion-buttons"),n=c("ion-button"),n.innerHTML=r,h=w(),f=c("ion-buttons"),b=c("ion-button"),b.innerHTML=k,I=w(),_=c("ion-title"),m=re(s),d=w(),P&&P.c(),g=Ce(),this.h()},l(A){e=u(A,"ION-HEADER",{translucent:!0});var N=E(e);t=u(N,"ION-TOOLBAR",{});var D=E(t);o=u(D,"ION-BUTTONS",{slot:!0});var y=E(o);n=u(y,"ION-BUTTON",{title:!0,alt:!0,"data-svelte-h":!0}),K(n)!=="svelte-7ppz3r"&&(n.innerHTML=r),y.forEach(a),h=L(D),f=u(D,"ION-BUTTONS",{slot:!0});var O=E(f);b=u(O,"ION-BUTTON",{"data-svelte-h":!0}),K(b)!=="svelte-nf50hj"&&(b.innerHTML=k),O.forEach(a),I=L(D),_=u(D,"ION-TITLE",{});var S=E(_);m=ae(S,s),S.forEach(a),D.forEach(a),N.forEach(a),d=L(A),P&&P.l(A),g=Ce(),this.h()},h(){p(n,"title","Atrás"),p(n,"alt","Atrás"),p(o,"slot","start"),p(f,"slot","end"),p(e,"translucent","")},m(A,N){R(A,e,N),l(e,t),l(t,o),l(o,n),l(t,h),l(t,f),l(f,b),l(t,I),l(t,_),l(_,m),R(A,d,N),P&&P.m(A,N),R(A,g,N),v||(T=[Q(n,"click",i[14]),Q(b,"click",i[18])],v=!0)},p(A,N){N[0]&64&&s!==(s=A[6].name+"")&&we(m,s),B===(B=C(A))&&P?P.p(A,N):(P&&P.d(1),P=B&&B(A),P&&(P.c(),P.m(g.parentNode,g)))},d(A){A&&(a(e),a(d),a(g)),P&&P.d(A),v=!1,Ue(T)}}}function Kn(i){let e,t,o,n=i[2]&&wt(i);return{c(){e=w(),n&&n.c(),t=Ce(),this.h()},l(r){Vt("svelte-kn0kph",document.head).forEach(a),e=L(r),n&&n.l(r),t=Ce(),this.h()},h(){document.title="Rutaflow - Detalles de ruta"},m(r,h){R(r,e,h),n&&n.m(r,h),R(r,t,h),o=!0},p(r,h){r[2]?n?(n.p(r,h),h[0]&4&&rt(n,1)):(n=wt(r),n.c(),rt(n,1),n.m(t.parentNode,t)):n&&(Yt(),ut(n,1,1,()=>{n=null}),Kt())},i(r){o||(rt(n),o=!0)},o(r){ut(n),o=!1},d(r){r&&(a(e),a(t)),n&&n.d(r)}}}function ye(i){let e="#ffffff";return i.status==="pending"?e="#f2e300":i.status==="completed"&&(e="#44d900"),e}function Ke(i){let e="";return i=="pending"?e="Pendiente":i=="completed"&&(e="Completado"),e}function xe(i){i.slice(0,1)==="#"&&(i=i.slice(1)),i.length===3&&(i=i.split("").map(function(r){return r+r}).join(""));const e=parseInt(i.substr(0,2),16),t=parseInt(i.substr(2,2),16),o=parseInt(i.substr(4,2),16);return(e*299+t*587+o*114)/1e3>=128?"#414040":"#fff"}function xn(i,e){let t=new FormData;return t.append("id_route",i),t.append("status",e),fetch("https://rutaflow-app-development.up.railway.app/api/admin/route/change_status.php",{method:"POST",body:t}).then(o=>o.json()).then(o=>{}).catch(o=>{console.error("Error fetching data:",o)}),""}const Wn=i=>i.img;function Xn(i,e,t){let o;Gt(i,ln,U=>t(17,o=U));var n=this&&this.__awaiter||function(U,F,J,le){function pe(se){return se instanceof J?se:new J(function(he){he(se)})}return new(J||(J=Promise))(function(se,he){function Pe(me){try{Le(le.next(me))}catch(fe){he(fe)}}function ge(me){try{Le(le.throw(me))}catch(fe){he(fe)}}function Le(me){me.done?se(me.value):pe(me.value).then(Pe,ge)}Le((le=le.apply(U,F||[])).next())})};let{routeId:r}=e,{driverId:h}=e,f=new Object,b=!0,k=!1,I=[],_={},s=[],m=[],d,g=!1;const v=()=>n(void 0,void 0,void 0,function*(){yield T(r),d.complete()});st(()=>{v()});function T(U){return n(this,void 0,void 0,function*(){const F=new FormData;F.append("id_route",U);try{const le=yield(yield fetch("https://rutaflow-app-development.up.railway.app/api/admin/report/seguimiento_list.php",{method:"POST",body:F})).json();t(6,_=le.data.seguimiento_list[0]),t(5,I=le.data.event_list),t(7,s=le.data.checklist),m=le.data.expenses,_&&t(4,k=_.km_inicial=="0"&&_.gas_inicial=="0"),t(3,b=!1)}catch(J){t(3,b=!1),console.error("Error fetching data:",J)}})}const C=U=>new Promise((F,J)=>{const le=new FormData;le.append("id_route",U.id_route),le.append("id_event",U.id_event),fetch("https://rutaflow-app-development.up.railway.app/api/admin/evidence/evidence_by_event.php",{method:"POST",body:le}).then(pe=>pe.json()).then(pe=>{F(pe.data.event_evidence[0])}).catch(pe=>{console.error("Error fetching data:",pe),J(pe)})}),B=(U,F)=>{C(U).then(J=>{J&&(U.img=J.img,U.driver_comments=J.driver_comments,U.comments=J.comments),Re("modal-delivery-info",Sn,{delivery:U,isLast:F}).then(le=>{})})},P=(U,F,J)=>{var le=!1;return g||(g=!0,Re("modal-checklist",zt,{checklist:U,driverId:F,routeId:J,isLast:le}).then(pe=>{g=!1}),xn(J,"checklist")),""},A=U=>n(void 0,void 0,void 0,function*(){return yield T(U),m.length>0?Re("modal-expense-detail",qn,{routeId:U,expenses:m}).then(F=>{}):Re("modal-expense",dt,{routeId:U}).then(F=>{}),""}),N=U=>{if(U.tracking_type=="subscription"){if(U.subscriber_info&&U.payment_type==="cash"&&new Date(U.subscriber_info.payment_next)<new Date)return!0}else if(U.tracking_type=="ecommerce"&&Number(U.payment_pending)>0)return!0;return!1},D=()=>{f.id_driver?je(`/drivers/${f.id_driver}`):je("/drivers/me")},y=(U,F)=>n(void 0,void 0,void 0,function*(){yield(yield et.create({header:U||"Error",message:F||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()});function O(U){return U===I.length-1}const S=()=>A(r);function q(U){Te[U?"unshift":"push"](()=>{d=U,t(8,d)})}const M=(U,F)=>B(U,O(F));function z(U){Te[U?"unshift":"push"](()=>{d=U,t(8,d)})}const x=(U,F)=>B(U,O(F));function $(U){Te[U?"unshift":"push"](()=>{d=U,t(8,d)})}const ee=U=>{const F=I.findIndex(he=>he.id_event===U.id_event),J=F===0,le=F>0?I[F-1]:null,pe=J||le&&le.img!==null,se=U.img!==null&&U.img!=="";pe||J&&!se?B(U):y("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")};return i.$$set=U=>{"routeId"in U&&t(0,r=U.routeId),"driverId"in U&&t(1,h=U.driverId)},i.$$.update=()=>{i.$$.dirty[0]&131077&&(t(0,{routeId:r,driverId:h}=o.params,r,(t(1,h),t(17,o),t(2,f),t(0,r))),t(2,f=JSON.parse(localStorage.getItem("userSession"))),f?f.id_user&&(f.type=="admin"||f.type=="superadmin")?(T(r),je(`/drivers/me/routes/${r}`)):f.id_user&&f.id_driver&&(T(r),je(`/drivers/${f.id_driver}/routes/${r}`)):je("/"))},[r,h,f,b,k,I,_,s,d,v,B,P,A,N,D,y,O,o,S,q,M,z,x,$,ee]}class no extends Xe{constructor(e){super(),Je(this,e,Xn,Kn,We,{routeId:0,driverId:1},null,[-1,-1])}}export{no as component};

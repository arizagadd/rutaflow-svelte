import{Z as at,s as Ke,e as c,j as C,b as u,q as g,d as X,h as s,m as w,v as b,i as z,w as i,x as Z,n as Ie,z as Be,_ as qt,B as V,o as zt,k as ye,$ as st,t as $,r as ee,f as K,a0 as Ft,y as ke,a1 as je,A as Ne,a2 as $e,l as jt,p as gt}from"../chunks/index.BYLndrM5.js";import{S as Ge,i as We,t as Ze,a as ot,c as Vt,b as Kt,d as Gt,m as Wt,e as Xt,g as Jt}from"../chunks/index.BNHbygFo.js";import{e as Se,u as et,d as tt,a as Yt,c as it,b as Bt,f as Zt,i as Mt,g as Qt,h as Ut,s as ct,j as Fe,k as xt,m as $t,n as en,p as tn}from"../chunks/index.CeQQYKs5.js";import{g as Me}from"../chunks/entry.BL0zc3kS.js";import"../chunks/index-48209844.IIRtDZyg.js";import{m as ut,a as Qe,I as nn}from"../chunks/IonPage.KvUD72q2.js";import{q as on,t as ln}from"../chunks/ion-modal.CsJaVgKZ.js";const rn=(l,e)=>{if(!customElements.get(l)){class t extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const n={};for(const r of this.attributes)n[r.name]=r.value;new e({target:this.shadowRoot,props:n})}}customElements.define(l,t)}},an=function(l){return document.createElement(l).constructor!==HTMLElement},sn=(l,e)=>{an(l)||rn(l,e)},Ve=async(l,e,t)=>{on(),ln(),sn(l,e);const o=await ut.create({component:l,componentProps:t});return o.present(),await o.onWillDismiss()};let Re=at({km_inicial:[],gas_inicial:[],km_final:[],gas_final:[]}),Ht=at({flag:[]});function cn(l){let e,t,o,n,r="Cancelar",d,h,f="Captura de Km/Gas",T,k,m,a="Confirmar",E,v,p,_,N,y,O;return{c(){e=c("ion-header"),t=c("ion-toolbar"),o=c("ion-buttons"),n=c("ion-button"),n.textContent=r,d=C(),h=c("ion-title"),h.textContent=f,T=C(),k=c("ion-buttons"),m=c("ion-button"),m.textContent=a,E=C(),v=c("ion-content"),p=c("ion-item"),_=c("ion-input"),this.h()},l(B){e=u(B,"ION-HEADER",{translucent:!0});var A=g(e);t=u(A,"ION-TOOLBAR",{});var P=g(t);o=u(P,"ION-BUTTONS",{slot:!0});var M=g(o);n=u(M,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),X(n)!=="svelte-17pq4f4"&&(n.textContent=r),M.forEach(s),d=w(P),h=u(P,"ION-TITLE",{"data-svelte-h":!0}),X(h)!=="svelte-1yhkaq7"&&(h.textContent=f),T=w(P),k=u(P,"ION-BUTTONS",{slot:!0});var S=g(k);m=u(S,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),X(m)!=="svelte-cm6j4s"&&(m.textContent=a),S.forEach(s),P.forEach(s),A.forEach(s),E=w(B),v=u(B,"ION-CONTENT",{fullscreen:!0});var I=g(v);p=u(I,"ION-ITEM",{});var D=g(p);_=u(D,"ION-INPUT",{class:!0,inputmode:!0,pattern:!0,type:!0,placeholder:!0,value:!0,required:!0});var H=g(_);H.forEach(s),D.forEach(s),I.forEach(s),this.h()},h(){b(n,"color","medium"),b(o,"slot","start"),b(m,"strong",""),b(k,"slot","end"),b(e,"translucent",""),b(_,"class","fin-km"),b(_,"inputmode","numeric"),b(_,"pattern","[0-9]*"),b(_,"type","number"),b(_,"placeholder",N="Ingresa "+l[0]+" actual"),b(_,"value",l[1]),b(_,"required",""),b(v,"fullscreen","")},m(B,A){z(B,e,A),i(e,t),i(t,o),i(o,n),i(t,d),i(t,h),i(t,T),i(t,k),i(k,m),z(B,E,A),z(B,v,A),i(v,p),i(p,_),y||(O=[Z(n,"click",l[2]),Z(m,"click",l[3]),Z(_,"input",l[4])],y=!0)},p(B,[A]){A&1&&N!==(N="Ingresa "+B[0]+" actual")&&b(_,"placeholder",N),A&2&&b(_,"value",B[1])},i:Ie,o:Ie,d(B){B&&(s(e),s(E),s(v)),y=!1,Be(O)}}}function un(l,e,t){const o=qt();let n=document.querySelector("ion-modal"),r=n.componentProps.data_type;n.componentProps.isLast;let d;Ht.subscribe(m=>{r=m.flag[0],r=="km_final"||r=="km_inicial"?t(0,d="kilometraje"):t(0,d="litros de gasolina")});let h=0;function f(){ut.dismiss()}function T(){o("modalResult",{data:"Your data",role:"confirm"}),r=="km_inicial"?Re.update(a=>({...a,km_inicial:[h]})):r=="gas_inicial"?Re.update(a=>({...a,gas_inicial:[h]})):r=="km_final"?Re.update(a=>({...a,km_final:[h]})):r=="gas_final"&&Re.update(a=>({...a,gas_final:[h]})),f()}return[d,h,f,T,m=>t(1,h=m.target.value)]}class fn extends Ge{constructor(e){super(),We(this,e,un,cn,Ke,{})}}const xe=at({items:[],checkedIndices:[],mandatory:[]});function bt(l,e,t){const o=l.slice();return o[49]=e[t],o[50]=e,o[51]=t,o}function _n(l){let e,t,o,n,r,d="Kilometraje inicial",h,f,T=l[0]?l[0]+" km.":"Cargar km",k,m,a,E,v,p,_,N="Gasolina inicial (litros)",y,O,B=l[1]?l[1]+" litros":"Cargar gas",A,P,M,S;return P=st(l[20][0]),{c(){e=c("ion-item"),t=c("ion-label"),o=c("input"),n=C(),r=c("p"),r.textContent=d,h=C(),f=c("ion-button"),k=$(T),m=C(),a=c("ion-item"),E=c("ion-label"),v=c("input"),p=C(),_=c("p"),_.textContent=N,y=C(),O=c("ion-button"),A=$(B),this.h()},l(I){e=u(I,"ION-ITEM",{});var D=g(e);t=u(D,"ION-LABEL",{style:!0});var H=g(t);o=u(H,"INPUT",{id:!0,style:!0,type:!0}),n=w(H),r=u(H,"P",{style:!0,"data-svelte-h":!0}),X(r)!=="svelte-88twxi"&&(r.textContent=d),H.forEach(s),h=w(D),f=u(D,"ION-BUTTON",{fill:!0,size:!0,class:!0,"aria-selected":!0});var U=g(f);k=ee(U,T),U.forEach(s),D.forEach(s),m=w(I),a=u(I,"ION-ITEM",{});var q=g(a);E=u(q,"ION-LABEL",{style:!0});var L=g(E);v=u(L,"INPUT",{id:!0,style:!0,type:!0}),p=w(L),_=u(L,"P",{style:!0,"data-svelte-h":!0}),X(_)!=="svelte-1ux30eb"&&(_.textContent=N),L.forEach(s),y=w(q),O=u(q,"ION-BUTTON",{fill:!0,class:!0,size:!0,style:!0});var F=g(O);A=ee(F,B),F.forEach(s),q.forEach(s),this.h()},h(){K(o,"id","chkbox-km-ini"),V(o,"pointer-events","auto"),K(o,"type","checkbox"),o.required=!0,V(r,"margin-left","10px"),V(t,"display","flex"),b(f,"fill","outline"),b(f,"size","small"),b(f,"class","loadKmInicial"),b(f,"aria-selected",""),K(v,"id","chkbox-gas-ini"),V(v,"pointer-events","auto"),K(v,"type","checkbox"),v.required=!0,V(_,"margin-left","10px"),V(E,"display","flex"),b(O,"fill","outline"),b(O,"class","loadGasInicial"),b(O,"size","small"),V(O,"height","16px "),P.p(o,v)},m(I,D){z(I,e,D),i(e,t),i(t,o),o.checked=~(l[4]||[]).indexOf(o.__value),l[27](o),i(t,n),i(t,r),i(e,h),i(e,f),i(f,k),z(I,m,D),z(I,a,D),i(a,E),i(E,v),l[29](v),v.checked=~(l[4]||[]).indexOf(v.__value),i(E,p),i(E,_),i(a,y),i(a,O),i(O,A),M||(S=[Z(o,"change",l[26]),Z(f,"click",l[28]),Z(v,"change",l[30]),Z(O,"click",l[31])],M=!0)},p(I,D){D[0]&16&&(o.checked=~(I[4]||[]).indexOf(o.__value)),D[0]&1&&T!==(T=I[0]?I[0]+" km.":"Cargar km")&&ke(k,T),D[0]&16&&(v.checked=~(I[4]||[]).indexOf(v.__value)),D[0]&2&&B!==(B=I[1]?I[1]+" litros":"Cargar gas")&&ke(A,B)},d(I){I&&(s(e),s(m),s(a)),l[27](null),l[29](null),P.r(),M=!1,Be(S)}}}function dn(l){let e,t,o,n,r,d="Kilometraje final",h,f,T=l[2]?l[2]+" km.":"Cargar km",k,m,a,E,v,p,_,N="Gasolina final (litros)",y,O,B=l[3]?l[3]+" litros":"Cargar gas",A,P,M,S;return P=st(l[20][0]),{c(){e=c("ion-item"),t=c("ion-label"),o=c("input"),n=C(),r=c("p"),r.textContent=d,h=C(),f=c("ion-button"),k=$(T),m=C(),a=c("ion-item"),E=c("ion-label"),v=c("input"),p=C(),_=c("p"),_.textContent=N,y=C(),O=c("ion-button"),A=$(B),this.h()},l(I){e=u(I,"ION-ITEM",{});var D=g(e);t=u(D,"ION-LABEL",{style:!0});var H=g(t);o=u(H,"INPUT",{id:!0,style:!0,type:!0}),n=w(H),r=u(H,"P",{style:!0,"data-svelte-h":!0}),X(r)!=="svelte-ccmu71"&&(r.textContent=d),H.forEach(s),h=w(D),f=u(D,"ION-BUTTON",{fill:!0,size:!0,class:!0,"aria-selected":!0});var U=g(f);k=ee(U,T),U.forEach(s),D.forEach(s),m=w(I),a=u(I,"ION-ITEM",{});var q=g(a);E=u(q,"ION-LABEL",{style:!0});var L=g(E);v=u(L,"INPUT",{id:!0,style:!0,type:!0}),p=w(L),_=u(L,"P",{style:!0,"data-svelte-h":!0}),X(_)!=="svelte-wsoyd2"&&(_.textContent=N),L.forEach(s),y=w(q),O=u(q,"ION-BUTTON",{fill:!0,size:!0,class:!0});var F=g(O);A=ee(F,B),F.forEach(s),q.forEach(s),this.h()},h(){K(o,"id","chkbox-km-fin"),V(o,"pointer-events","auto"),K(o,"type","checkbox"),o.required=!0,V(r,"margin-left","10px"),V(t,"display","flex"),b(f,"fill","outline"),b(f,"size","small"),b(f,"class","loadKmInicial"),b(f,"aria-selected",""),K(v,"id","chkbox-gas-fin"),V(v,"pointer-events","auto"),K(v,"type","checkbox"),v.required=!0,V(_,"margin-left","10px"),V(E,"display","flex"),b(O,"fill","outline"),b(O,"size","small"),b(O,"class","loadGasInicial"),P.p(o,v)},m(I,D){z(I,e,D),i(e,t),i(t,o),o.checked=~(l[4]||[]).indexOf(o.__value),l[21](o),i(t,n),i(t,r),i(e,h),i(e,f),i(f,k),z(I,m,D),z(I,a,D),i(a,E),i(E,v),v.checked=~(l[4]||[]).indexOf(v.__value),l[24](v),i(E,p),i(E,_),i(a,y),i(a,O),i(O,A),M||(S=[Z(o,"change",l[19]),Z(f,"click",l[22]),Z(v,"change",l[23]),Z(O,"click",l[25])],M=!0)},p(I,D){D[0]&16&&(o.checked=~(I[4]||[]).indexOf(o.__value)),D[0]&4&&T!==(T=I[2]?I[2]+" km.":"Cargar km")&&ke(k,T),D[0]&16&&(v.checked=~(I[4]||[]).indexOf(v.__value)),D[0]&8&&B!==(B=I[3]?I[3]+" litros":"Cargar gas")&&ke(A,B)},d(I){I&&(s(e),s(m),s(a)),l[21](null),l[24](null),P.r(),M=!1,Be(S)}}}function hn(l){let e=[],t=new Map,o,n=Se(l[12]);const r=d=>d[49].id_checklist_event;for(let d=0;d<n.length;d+=1){let h=bt(l,n,d),f=r(h);t.set(f,e[d]=Et(f,h))}return{c(){for(let d=0;d<e.length;d+=1)e[d].c();o=ye()},l(d){for(let h=0;h<e.length;h+=1)e[h].l(d);o=ye()},m(d,h){for(let f=0;f<e.length;f+=1)e[f]&&e[f].m(d,h);z(d,o,h)},p(d,h){h[0]&202864&&(n=Se(d[12]),e=et(e,h,r,1,d,n,t,o.parentNode,tt,Et,o,bt))},d(d){d&&s(o);for(let h=0;h<e.length;h+=1)e[h].d(d)}}}function Et(l,e){let t,o,n,r=e[49],d,h,f=e[49].item+"",T,k,m,a,E=(e[11][e[49].id_checklist_event]?e[11][e[49].id_checklist_event]:"Cargar evidencia")+"",v,p,_,N,y,O,B;const A=()=>e[33](n,r),P=()=>e[33](null,r);function M(){return e[34](e[49])}function S(...I){return e[36](e[49],...I)}return y=st(e[20][0]),{key:l,first:null,c(){t=c("ion-item"),o=c("ion-label"),n=c("input"),d=C(),h=c("p"),T=$(f),k=C(),m=c("ion-button"),a=c("label"),v=$(E),p=C(),_=c("input"),N=C(),this.h()},l(I){t=u(I,"ION-ITEM",{});var D=g(t);o=u(D,"ION-LABEL",{style:!0});var H=g(o);n=u(H,"INPUT",{id:!0,style:!0,type:!0}),d=w(H),h=u(H,"P",{style:!0});var U=g(h);T=ee(U,f),U.forEach(s),H.forEach(s),k=w(D),m=u(D,"ION-BUTTON",{fill:!0,class:!0,size:!0});var q=g(m);a=u(q,"LABEL",{for:!0});var L=g(a);v=ee(L,E),L.forEach(s),p=w(q),_=u(q,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0}),q.forEach(s),N=w(D),D.forEach(s),this.h()},h(){K(n,"id",`chkbox-${e[49].id_checklist_event}`),V(n,"pointer-events","auto"),K(n,"type","checkbox"),n.__value=e[49].id_checklist_event,Ft(n,n.__value),n.required=!0,V(h,"margin-left","10px"),V(o,"display","flex"),K(a,"for","chklist-"+e[49].id_checklist_event),V(_,"display","none"),K(_,"id","chklist-"+e[49].id_checklist_event),K(_,"name","fileToUpload"),K(_,"type","file"),K(_,"accept","image/*"),b(m,"fill","outline"),b(m,"class","loadEvidence svelte-1lh6nay"),b(m,"size","small"),y.p(n),this.first=t},m(I,D){z(I,t,D),i(t,o),i(o,n),n.checked=~(e[4]||[]).indexOf(n.__value),A(),i(o,d),i(o,h),i(h,T),i(t,k),i(t,m),i(m,a),i(a,v),i(m,p),i(m,_),e[35](_),i(t,N),O||(B=[Z(n,"change",e[32]),Z(n,"change",M),Z(_,"change",S)],O=!0)},p(I,D){e=I,D[0]&16&&(n.checked=~(e[4]||[]).indexOf(n.__value)),r!==e[49]&&(P(),r=e[49],A()),D[0]&2048&&E!==(E=(e[11][e[49].id_checklist_event]?e[11][e[49].id_checklist_event]:"Cargar evidencia")+"")&&ke(v,E)},d(I){I&&s(t),P(),e[35](null),y.r(),O=!1,Be(B)}}}function pn(l){let e,t,o,n,r="Cancelar",d,h,f="Requerimientos de ruta",T,k,m,a,E,v,p,_="Confirmar",N,y;function O(M,S){return M[13]?dn:_n}let A=O(l)(l),P=l[12]&&hn(l);return{c(){e=c("ion-header"),t=c("ion-toolbar"),o=c("ion-buttons"),n=c("ion-button"),n.textContent=r,d=C(),h=c("ion-title"),h.textContent=f,T=C(),k=c("ion-content"),m=c("ion-list"),A.c(),a=C(),P&&P.c(),E=C(),v=c("ion-footer"),p=c("ion-button"),p.textContent=_,this.h()},l(M){e=u(M,"ION-HEADER",{translucent:!0});var S=g(e);t=u(S,"ION-TOOLBAR",{});var I=g(t);o=u(I,"ION-BUTTONS",{slot:!0});var D=g(o);n=u(D,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),X(n)!=="svelte-1dnmkxs"&&(n.textContent=r),D.forEach(s),d=w(I),h=u(I,"ION-TITLE",{"data-svelte-h":!0}),X(h)!=="svelte-ucox25"&&(h.textContent=f),I.forEach(s),S.forEach(s),T=w(M),k=u(M,"ION-CONTENT",{fullscreen:!0});var H=g(k);m=u(H,"ION-LIST",{});var U=g(m);A.l(U),a=w(U),P&&P.l(U),U.forEach(s),H.forEach(s),E=w(M),v=u(M,"ION-FOOTER",{});var q=g(v);p=u(q,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),X(p)!=="svelte-g82qqw"&&(p.textContent=_),q.forEach(s),this.h()},h(){b(n,"color","medium"),b(o,"slot","start"),b(e,"translucent",""),b(k,"fullscreen",""),b(p,"fill","outline"),b(p,"color","tertiary"),b(p,"strong",""),V(p,"width","99%"),V(p,"height","auto")},m(M,S){z(M,e,S),i(e,t),i(t,o),i(o,n),i(t,d),i(t,h),z(M,T,S),z(M,k,S),i(k,m),A.m(m,null),i(m,a),P&&P.m(m,null),z(M,E,S),z(M,v,S),i(v,p),N||(y=[Z(n,"click",l[14]),Z(p,"click",l[15])],N=!0)},p(M,S){A.p(M,S),M[12]&&P.p(M,S)},i:Ie,o:Ie,d(M){M&&(s(e),s(T),s(k),s(E),s(v)),A.d(),P&&P.d(),N=!1,Be(y)}}}function lt(l,e){if(typeof l=="object"&&l!==null||Array.isArray(l)){if(Array.isArray(l))return l.map(t=>lt(t,e)).flat();{const t=Object.keys(l);let o;return e=="id_checklist_event"?o=t.filter(r=>r.toLowerCase().includes("id_checklist_event")).map(r=>l[r]):e=="mandatory"?o=t.filter(r=>r.toLowerCase().includes("mandatory")).map(r=>l[r]):(console.error("Tipo de dato no reconocido."),o=!1),o}}else return console.error("Invalid input. Please provide a valid object or array."),[]}function nt(l,e){let t=new FormData;t.append("id_route",l),t.append("status",e),fetch("https://app.rutaflow.com/api/admin/route/change_status.php",{method:"POST",body:t}).then(o=>o.json()).then(o=>{}).catch(o=>{console.error("Error fetching data:",o)})}function mn(l,e,t){let o=document.querySelector("ion-modal");const n=o.componentProps.checklist,r=o.componentProps.driverId,d=o.componentProps.routeId,h=o.componentProps.isLast;let f,T,k,m,a=[],E=null,v={},p,_,N,y,O={},B={};zt(()=>{h?console.log("Último checklist"):xe.update(R=>(R.mandatory=lt(n,"mandatory"),R.items=lt(n,"id_checklist_event"),R))});const A=async()=>{await(await Qe.create({header:"Datos o checklist incompletos",message:"Carga la evidencia requerida y marca todas las casillas para confirmar",buttons:[{text:"Cerrar"}]})).present()},P=async()=>{await(await Qe.create({header:"Datos capturados",message:"El kilometraje y gasolina final fueron registrados correctamente, espere aprobación para finalizar ruta",buttons:[{text:"Cerrar"}]})).present()},M=async R=>{await(await Qe.create({header:"Datos inválidos",message:R=="km"?"Llena correctamente el campo de kilometraje inicial":"Llena correctamente el campo de gasolina inicial",buttons:[{text:"Cerrar"}]})).present()},S=()=>{ut.dismiss(),r?Me(`/drivers/${r}`):Me("/drivers/me")},I=()=>{if(h){var R=q(k,"km"),G=q(m,"gas");const te=new FormData;te.append("km_final",R),te.append("gas_final",G),te.append("id_route",d),R&&G?(S(),fetch("https://app.rutaflow.com/api/admin/checklist/add_evidence.php",{method:"POST",body:te}).then(ce=>ce.json()).then(ce=>{P()}).catch(ce=>{console.error("Error fetching data:",ce)})):A()}else{var Q=q(f,"km"),re=q(T,"gas");xe.update(te=>{const ce=te.items,x=te.mandatory;if(ce.every(ne=>te.checkedIndices.includes(ne))&&Q&&re){S();const ne=new FormData;for(const Y in O)if(O.hasOwnProperty(Y)){const{img:me,img_id:de}=O[Y];ne.append(`selectedImages[${Y}][img]`,me),ne.append(`selectedImages[${Y}][img_id]`,de)}ne.append("km_inicial",Q),ne.append("gas_inicial",re),ne.append("id_route",d),fetch("https://app.rutaflow.com/api/admin/checklist/add_evidence.php",{method:"POST",body:ne}).then(Y=>Y.json()).then(Y=>{x&&x[0]=="1"?nt(d,"checklist-pending"):nt(d,"enroute")}).catch(Y=>{console.error("Error fetching data:",Y)})}else A();return te})}J()},D=async(R,G)=>{const re=R.target.files[0],te=await H(re);if(te){const ce=new FormData;ce.append("fileToUpload",te);try{const x=await fetch("https://app.rutaflow.com/api/admin/manager/upload_img_driver.php",{method:"POST",body:ce});if(x.ok){const fe=await x.json();O={...O,[G]:{img:fe.img,img_id:fe.img_id}},t(11,B={...B,[G]:fe.filename}),U(G),t(6,v[G].checked=!0,v)}else console.error("File upload failed:",x.statusText)}catch(x){console.error("Error during file upload:",x)}}},H=async R=>new Promise(G=>{const Q=new FileReader;Q.onload=re=>{const te=new Image;te.src=re.target.result,te.onload=()=>{const ce=document.createElement("canvas"),x=ce.getContext("2d"),fe=800,ne=600;let Y=te.width,me=te.height;Y>fe&&(me*=fe/Y,Y=fe),me>ne&&(Y*=ne/me,me=ne),ce.width=Y,ce.height=me,x.drawImage(te,0,0,Y,me),ce.toBlob(de=>{G(de)},"image/jpeg",.7)}},Q.readAsDataURL(R)}),U=R=>{xe.update(G=>(G.checkedIndices.indexOf(R)===-1?G.checkedIndices.push(R):console.error(`ID ${R} is already checked.`),G.items.forEach(re=>{re.id_checklist_event===R&&(re.checked=!0)}),G))};function q(R,G){return/^\d+$/.test(R)?parseInt(R,10):(M(G),null)}function L(R,G){F(G),o.componentProps.data_type=G,Ve("modal-gas-km",fn,{r:G}).then(()=>{Re.subscribe(Q=>{j(Q,G)})})}function F(R){Ht.update(G=>({...G,flag:[R]}))}function j(R,G){t(0,f=R.km_inicial?R.km_inicial:null),t(1,T=R.gas_inicial?R.gas_inicial:null),t(2,k=R.km_final?R.km_final:null),t(3,m=R.gas_final?R.gas_final:null),G=="km_inicial"&&t(7,p.checked=!0,p),G=="gas_inicial"&&t(8,_.checked=!0,_),G=="km_final"&&t(9,N.checked=!0,N),G=="gas_final"&&t(10,y.checked=!0,y)}function J(){Re.set({km_inicial:[],gas_inicial:[],km_final:[],gas_final:[]})}const W=[[]];function ue(){a=je(W[0],this.__value,this.checked),t(4,a)}function be(R){Ne[R?"unshift":"push"](()=>{N=R,t(9,N)})}const Ce=R=>L(R,"km_final");function _e(){a=je(W[0],this.__value,this.checked),t(4,a)}function ie(R){Ne[R?"unshift":"push"](()=>{y=R,t(10,y)})}const ae=R=>L(R,"gas_final");function ge(){a=je(W[0],this.__value,this.checked),t(4,a)}function Pe(R){Ne[R?"unshift":"push"](()=>{p=R,t(7,p)})}const ve=R=>L(R,"km_inicial");function Oe(R){Ne[R?"unshift":"push"](()=>{_=R,t(8,_)})}function pe(){a=je(W[0],this.__value,this.checked),t(4,a)}const De=R=>L(R,"gas_inicial");function se(){a=je(W[0],this.__value,this.checked),t(4,a)}function le(R,G){Ne[R?"unshift":"push"](()=>{v[G.id_checklist_event]=R,t(6,v)})}const we=R=>U(R.id_checklist_event);function Ae(R){Ne[R?"unshift":"push"](()=>{E=R,t(5,E)})}return[f,T,k,m,a,E,v,p,_,N,y,B,n,h,S,I,D,U,L,ue,W,be,Ce,_e,ie,ae,ge,Pe,ve,Oe,pe,De,se,le,we,Ae,(R,G)=>D(G,R.id_checklist_event)]}class Rt extends Ge{constructor(e){super(),We(this,e,mn,pn,Ke,{},null,[-1,-1])}}function vn(l){let e,t,o,n,r,d="Teléfono",h,f,T=l[2].client_phone+"",k;return{c(){e=c("ion-item"),t=c("ion-icon"),o=C(),n=c("ion-label"),r=c("p"),r.textContent=d,h=C(),f=c("h2"),k=$(T),this.h()},l(m){e=u(m,"ION-ITEM",{href:!0});var a=g(e);t=u(a,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(s),o=w(a),n=u(a,"ION-LABEL",{class:!0});var E=g(n);r=u(E,"P",{"data-svelte-h":!0}),X(r)!=="svelte-9g5fr8"&&(r.textContent=d),h=w(E),f=u(E,"H2",{});var v=g(f);k=ee(v,T),v.forEach(s),E.forEach(s),a.forEach(s),this.h()},h(){b(t,"icon",Zt),b(t,"slot","start"),b(n,"class","ion-text-wrap"),b(e,"href","tel:"+l[2].client_phone)},m(m,a){z(m,e,a),i(e,t),i(e,o),i(e,n),i(n,r),i(n,h),i(n,f),i(f,k)},p:Ie,d(m){m&&s(e)}}}function gn(l){let e,t,o,n,r,d="Domicilio 2",h,f,T=l[2].line2+"",k,m,a;return{c(){e=c("ion-item"),t=c("ion-icon"),o=C(),n=c("ion-label"),r=c("p"),r.textContent=d,h=C(),f=c("h2"),k=$(T),m=C(),a=c("ion-icon"),this.h()},l(E){e=u(E,"ION-ITEM",{href:!0});var v=g(e);t=u(v,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(s),o=w(v),n=u(v,"ION-LABEL",{class:!0});var p=g(n);r=u(p,"P",{"data-svelte-h":!0}),X(r)!=="svelte-1qy148r"&&(r.textContent=d),h=w(p),f=u(p,"H2",{});var _=g(f);k=ee(_,T),_.forEach(s),p.forEach(s),m=w(v),a=u(v,"ION-ICON",{icon:!0,slot:!0}),g(a).forEach(s),v.forEach(s),this.h()},h(){b(t,"icon",ct),b(t,"slot","start"),b(n,"class","ion-text-wrap"),b(a,"icon",Fe),b(a,"slot","end"),b(e,"href","https://www.google.com/maps/searhc/?api=1&query="+l[2].line2)},m(E,v){z(E,e,v),i(e,t),i(e,o),i(e,n),i(n,r),i(n,h),i(n,f),i(f,k),i(e,m),i(e,a)},p:Ie,d(E){E&&s(e)}}}function bn(l){let e,t,o,n,r,d="Domicilio 1",h,f,T=l[2].line1+"",k,m,a,E,v=l[2].line2&&l[2].line2.trim().length,p,_=v&&En(l);return{c(){e=c("ion-item"),t=c("ion-icon"),o=C(),n=c("ion-label"),r=c("p"),r.textContent=d,h=C(),f=c("h2"),k=$(T),m=C(),a=c("ion-icon"),E=C(),_&&_.c(),p=ye(),this.h()},l(N){e=u(N,"ION-ITEM",{href:!0});var y=g(e);t=u(y,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(s),o=w(y),n=u(y,"ION-LABEL",{class:!0});var O=g(n);r=u(O,"P",{"data-svelte-h":!0}),X(r)!=="svelte-1ehcrdm"&&(r.textContent=d),h=w(O),f=u(O,"H2",{});var B=g(f);k=ee(B,T),B.forEach(s),O.forEach(s),m=w(y),a=u(y,"ION-ICON",{icon:!0,slot:!0}),g(a).forEach(s),y.forEach(s),E=w(N),_&&_.l(N),p=ye(),this.h()},h(){b(t,"icon",ct),b(t,"slot","start"),b(n,"class","ion-text-wrap"),b(a,"icon",Fe),b(a,"slot","end"),b(e,"href","https://www.google.com/maps/search/?api=1&query="+l[2].line1)},m(N,y){z(N,e,y),i(e,t),i(e,o),i(e,n),i(n,r),i(n,h),i(n,f),i(f,k),i(e,m),i(e,a),z(N,E,y),_&&_.m(N,y),z(N,p,y)},p(N,y){v&&_.p(N,y)},d(N){N&&(s(e),s(E),s(p)),_&&_.d(N)}}}function En(l){let e,t,o,n,r,d="Domicilio 2",h,f,T=l[2].line2+"",k,m,a;return{c(){e=c("ion-item"),t=c("ion-icon"),o=C(),n=c("ion-label"),r=c("p"),r.textContent=d,h=C(),f=c("h2"),k=$(T),m=C(),a=c("ion-icon"),this.h()},l(E){e=u(E,"ION-ITEM",{href:!0});var v=g(e);t=u(v,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(s),o=w(v),n=u(v,"ION-LABEL",{class:!0});var p=g(n);r=u(p,"P",{"data-svelte-h":!0}),X(r)!=="svelte-1qy148r"&&(r.textContent=d),h=w(p),f=u(p,"H2",{});var _=g(f);k=ee(_,T),_.forEach(s),p.forEach(s),m=w(v),a=u(v,"ION-ICON",{icon:!0,slot:!0}),g(a).forEach(s),v.forEach(s),this.h()},h(){b(t,"icon",ct),b(t,"slot","start"),b(n,"class","ion-text-wrap"),b(a,"icon",Fe),b(a,"slot","end"),b(e,"href","https://www.google.com/maps/search/?api=1&query="+l[2].line2)},m(E,v){z(E,e,v),i(e,t),i(e,o),i(e,n),i(n,r),i(n,h),i(n,f),i(f,k),i(e,m),i(e,a)},p:Ie,d(E){E&&s(e)}}}function In(l){let e,t=l[2].comments!="<br>"&&kn(l);return{c(){t&&t.c(),e=ye()},l(o){t&&t.l(o),e=ye()},m(o,n){t&&t.m(o,n),z(o,e,n)},p(o,n){o[2].comments!="<br>"&&t.p(o,n)},d(o){o&&s(e),t&&t.d(o)}}}function kn(l){let e,t,o,n,r,d="Notas de ubicación",h,f,T=l[2].comments+"",k;return{c(){e=c("ion-item"),t=c("ion-icon"),o=C(),n=c("ion-label"),r=c("p"),r.textContent=d,h=C(),f=c("h2"),k=$(T),this.h()},l(m){e=u(m,"ION-ITEM",{});var a=g(e);t=u(a,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(s),o=w(a),n=u(a,"ION-LABEL",{class:!0});var E=g(n);r=u(E,"P",{"data-svelte-h":!0}),X(r)!=="svelte-nhm2ft"&&(r.textContent=d),h=w(E),f=u(E,"H2",{});var v=g(f);k=ee(v,T),v.forEach(s),E.forEach(s),a.forEach(s),this.h()},h(){b(t,"icon",Mt),b(t,"slot","start"),b(n,"class","ion-text-wrap")},m(m,a){z(m,e,a),i(e,t),i(e,o),i(e,n),i(n,r),i(n,h),i(n,f),i(f,k)},p:Ie,d(m){m&&s(e)}}}function On(l){let e,t,o,n,r,d="Horarios",h,f,T=l[2].schedule+"",k;return{c(){e=c("ion-item"),t=c("ion-icon"),o=C(),n=c("ion-label"),r=c("p"),r.textContent=d,h=C(),f=c("h2"),k=$(T),this.h()},l(m){e=u(m,"ION-ITEM",{});var a=g(e);t=u(a,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(s),o=w(a),n=u(a,"ION-LABEL",{});var E=g(n);r=u(E,"P",{"data-svelte-h":!0}),X(r)!=="svelte-11q7hm5"&&(r.textContent=d),h=w(E),f=u(E,"H2",{});var v=g(f);k=ee(v,T),v.forEach(s),E.forEach(s),a.forEach(s),this.h()},h(){b(t,"icon",Qt),b(t,"slot","start")},m(m,a){z(m,e,a),i(e,t),i(e,o),i(e,n),i(n,r),i(n,h),i(n,f),i(f,k)},p:Ie,d(m){m&&s(e)}}}function Nn(l){let e,t,o,n,r,d="Notas del operador",h,f,T=l[2].driver_comments+"",k;return{c(){e=c("ion-item"),t=c("ion-icon"),o=C(),n=c("ion-label"),r=c("p"),r.textContent=d,h=C(),f=c("h2"),k=$(T),this.h()},l(m){e=u(m,"ION-ITEM",{});var a=g(e);t=u(a,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(s),o=w(a),n=u(a,"ION-LABEL",{});var E=g(n);r=u(E,"P",{"data-svelte-h":!0}),X(r)!=="svelte-1yk9qp4"&&(r.textContent=d),h=w(E),f=u(E,"H2",{});var v=g(f);k=ee(v,T),v.forEach(s),E.forEach(s),a.forEach(s),this.h()},h(){b(t,"icon",Ut),b(t,"slot","start")},m(m,a){z(m,e,a),i(e,t),i(e,o),i(e,n),i(n,r),i(n,h),i(n,f),i(f,k)},p:Ie,d(m){m&&s(e)}}}function Tn(l){let e,t=l[2].logistic_comments!="<br>"&&yn(l);return{c(){t&&t.c(),e=ye()},l(o){t&&t.l(o),e=ye()},m(o,n){t&&t.m(o,n),z(o,e,n)},p(o,n){o[2].logistic_comments!="<br>"&&t.p(o,n)},d(o){o&&s(e),t&&t.d(o)}}}function yn(l){let e,t,o,n,r,d="Comentarios logísticos",h,f,T=l[2].logistic_comments+"",k;return{c(){e=c("ion-item"),t=c("ion-icon"),o=C(),n=c("ion-label"),r=c("p"),r.textContent=d,h=C(),f=c("h2"),k=$(T),this.h()},l(m){e=u(m,"ION-ITEM",{});var a=g(e);t=u(a,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(s),o=w(a),n=u(a,"ION-LABEL",{class:!0});var E=g(n);r=u(E,"P",{"data-svelte-h":!0}),X(r)!=="svelte-1iz85r6"&&(r.textContent=d),h=w(E),f=u(E,"H2",{});var v=g(f);k=ee(v,T),v.forEach(s),E.forEach(s),a.forEach(s),this.h()},h(){b(t,"icon",Mt),b(t,"slot","start"),b(n,"class","ion-text-wrap")},m(m,a){z(m,e,a),i(e,t),i(e,o),i(e,n),i(n,r),i(n,h),i(n,f),i(f,k)},p:Ie,d(m){m&&s(e)}}}function It(l){let e,t,o;return{c(){e=c("section"),t=c("ion-img"),this.h()},l(n){e=u(n,"SECTION",{});var r=g(e);t=u(r,"ION-IMG",{src:!0,alt:!0,style:!0}),g(t).forEach(s),r.forEach(s),this.h()},h(){$e(t.src,o=l[1])||b(t,"src",o),b(t,"alt","Evidencia fotográfica"),V(t,"max-width","100%"),V(t,"margin-top","16px")},m(n,r){z(n,e,r),i(e,t)},p(n,r){r&2&&!$e(t.src,o=n[1])&&b(t,"src",o)},d(n){n&&s(e)}}}function Cn(l){let e,t,o,n,r="Cancelar",d,h,f=l[2].title+"",T,k,m,a,E="Confirmar",v,p,_,N,y,O,B,A,P="Cliente",M,S,I=l[2].client_name+"",D,H,U=l[2].client_phone&&l[2].client_phone.trim().length,q,L,F=l[2].comments&&l[2].comments.trim().length,j,J=l[2].schedule&&l[2].schedule.trim().length,W,ue,be=l[2].logistic_comments&&l[2].logistic_comments.trim().length,Ce,_e,ie,ae,ge,Pe,ve,Oe,pe,De,se,le,we="Subir Evidencia",Ae,Le,R,G,Q,re=U&&vn(l);function te(oe,Ee){if(oe[2].line1&&oe[2].line1.trim().length)return bn;if(oe[2].line2&&oe[2].line2.trim().length)return gn}let ce=te(l),x=ce&&ce(l),fe=F&&In(l),ne=J&&On(l),Y=l[2].driver_comments&&Nn(l),me=be&&Tn(l),de=l[1]&&It(l);return{c(){e=c("ion-header"),t=c("ion-toolbar"),o=c("ion-buttons"),n=c("ion-button"),n.textContent=r,d=C(),h=c("ion-title"),T=$(f),k=C(),m=c("ion-buttons"),a=c("ion-button"),a.textContent=E,v=C(),p=c("ion-content"),_=c("ion-list"),N=c("ion-item"),y=c("ion-icon"),O=C(),B=c("ion-label"),A=c("p"),A.textContent=P,M=C(),S=c("h2"),D=$(I),H=C(),re&&re.c(),q=C(),x&&x.c(),L=C(),fe&&fe.c(),j=C(),ne&&ne.c(),W=C(),Y&&Y.c(),ue=C(),me&&me.c(),Ce=C(),_e=c("ion-item"),ie=c("ion-icon"),ae=C(),ge=c("ion-textarea"),Pe=C(),ve=c("section"),Oe=c("label"),pe=c("ion-button"),De=c("ion-icon"),se=C(),le=c("label"),le.textContent=we,Ae=C(),Le=c("input"),R=C(),de&&de.c(),this.h()},l(oe){e=u(oe,"ION-HEADER",{translucent:!0});var Ee=g(e);t=u(Ee,"ION-TOOLBAR",{});var Ue=g(t);o=u(Ue,"ION-BUTTONS",{slot:!0});var ft=g(o);n=u(ft,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),X(n)!=="svelte-1f8rjcf"&&(n.textContent=r),ft.forEach(s),d=w(Ue),h=u(Ue,"ION-TITLE",{title:!0});var _t=g(h);T=ee(_t,f),_t.forEach(s),k=w(Ue),m=u(Ue,"ION-BUTTONS",{slot:!0});var dt=g(m);a=u(dt,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),X(a)!=="svelte-1ida0il"&&(a.textContent=E),dt.forEach(s),Ue.forEach(s),Ee.forEach(s),v=w(oe),p=u(oe,"ION-CONTENT",{fullscreen:!0});var ht=g(p);_=u(ht,"ION-LIST",{});var he=g(_);N=u(he,"ION-ITEM",{});var Xe=g(N);y=u(Xe,"ION-ICON",{icon:!0,slot:!0}),g(y).forEach(s),O=w(Xe),B=u(Xe,"ION-LABEL",{});var Je=g(B);A=u(Je,"P",{"data-svelte-h":!0}),X(A)!=="svelte-jrq7ei"&&(A.textContent=P),M=w(Je),S=u(Je,"H2",{});var pt=g(S);D=ee(pt,I),pt.forEach(s),Je.forEach(s),Xe.forEach(s),H=w(he),re&&re.l(he),q=w(he),x&&x.l(he),L=w(he),fe&&fe.l(he),j=w(he),ne&&ne.l(he),W=w(he),Y&&Y.l(he),ue=w(he),me&&me.l(he),Ce=w(he),_e=u(he,"ION-ITEM",{});var Ye=g(_e);ie=u(Ye,"ION-ICON",{icon:!0,slot:!0}),g(ie).forEach(s),ae=w(Ye),ge=u(Ye,"ION-TEXTAREA",{label:!0,placeholder:!0}),g(ge).forEach(s),Ye.forEach(s),Pe=w(he),ve=u(he,"SECTION",{});var mt=g(ve);Oe=u(mt,"LABEL",{for:!0,style:!0});var vt=g(Oe);pe=u(vt,"ION-BUTTON",{fill:!0,class:!0,expand:!0});var He=g(pe);De=u(He,"ION-ICON",{icon:!0,slot:!0}),g(De).forEach(s),se=w(He),le=u(He,"LABEL",{for:!0,style:!0,"data-svelte-h":!0}),X(le)!=="svelte-1as0od8"&&(le.textContent=we),Ae=w(He),Le=u(He,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0}),He.forEach(s),vt.forEach(s),mt.forEach(s),R=w(he),de&&de.l(he),he.forEach(s),ht.forEach(s),this.h()},h(){b(n,"color","medium"),b(o,"slot","start"),b(h,"title",l[2].title),b(a,"strong",""),b(m,"slot","end"),b(e,"translucent",""),b(y,"icon",Yt),b(y,"slot","start"),b(ie,"icon",it),b(ie,"slot","start"),b(ge,"label","Notas"),b(ge,"placeholder","Escribe aquí..."),b(De,"icon",Bt),b(De,"slot","start"),K(le,"for","eventEvidence"),V(le,"padding","8px 10px"),V(Le,"display","none"),K(Le,"id","eventEvidence"),K(Le,"name","fileToUpload"),K(Le,"type","file"),K(Le,"accept","image/*"),b(pe,"fill","outline"),b(pe,"class","loadEvidence"),b(pe,"expand","block"),K(Oe,"for","eventEvidence"),V(Oe,"display","block"),V(Oe,"width","100%"),b(p,"fullscreen","")},m(oe,Ee){z(oe,e,Ee),i(e,t),i(t,o),i(o,n),i(t,d),i(t,h),i(h,T),i(t,k),i(t,m),i(m,a),z(oe,v,Ee),z(oe,p,Ee),i(p,_),i(_,N),i(N,y),i(N,O),i(N,B),i(B,A),i(B,M),i(B,S),i(S,D),i(_,H),re&&re.m(_,null),i(_,q),x&&x.m(_,null),i(_,L),fe&&fe.m(_,null),i(_,j),ne&&ne.m(_,null),i(_,W),Y&&Y.m(_,null),i(_,ue),me&&me.m(_,null),i(_,Ce),i(_,_e),i(_e,ie),i(_e,ae),i(_e,ge),l[6](ge),i(_,Pe),i(_,ve),i(ve,Oe),i(Oe,pe),i(pe,De),i(pe,se),i(pe,le),i(pe,Ae),i(pe,Le),i(_,R),de&&de.m(_,null),G||(Q=[Z(n,"click",l[4]),Z(a,"click",l[5]),Z(Le,"change",l[3])],G=!0)},p(oe,[Ee]){U&&re.p(oe,Ee),x&&x.p(oe,Ee),F&&fe.p(oe,Ee),J&&ne.p(oe,Ee),oe[2].driver_comments&&Y.p(oe,Ee),be&&me.p(oe,Ee),oe[1]?de?de.p(oe,Ee):(de=It(oe),de.c(),de.m(_,null)):de&&(de.d(1),de=null)},i:Ie,o:Ie,d(oe){oe&&(s(e),s(v),s(p)),re&&re.d(),x&&x.d(),fe&&fe.d(),ne&&ne.d(),Y&&Y.d(),me&&me.d(),l[6](null),de&&de.d(),G=!1,Be(Q)}}}function wn(l,e,t){let o=document.querySelector("ion-modal"),n=o.componentProps.delivery,r=o.componentProps.isLast,d=n.driver_comments?n.driver_comments:"",h=n.img?n.img:"",f="",T={latitude:null,longitude:null};const k=async N=>{const O=N.target.files[0],B=await m(O);if(B){const A=new FormData;A.append("fileToUpload",B);try{const P=await fetch("https://app.rutaflow.com/api/admin/manager/upload_img_driver.php",{method:"POST",body:A});if(P.ok){const M=await P.json();t(1,h=M.img),f=M.img_id}else console.error("File upload failed:",P.statusText)}catch(P){console.error("Error during file upload:",P)}}},m=async N=>new Promise(y=>{const O=new FileReader;O.onload=B=>{const A=new Image;A.src=B.target.result,A.onload=()=>{const P=document.createElement("canvas"),M=P.getContext("2d"),S=800,I=600;let D=A.width,H=A.height;D>S&&(H*=S/D,D=S),H>I&&(D*=I/H,H=I),P.width=D,P.height=H,M.drawImage(A,0,0,D,H),P.toBlob(U=>{y(U)},"image/jpeg",.7)}},O.readAsDataURL(N)}),a=()=>{o.dismiss({data:Date.now()})},E=async()=>{try{const N=await p();if(console.log(N),N){const y={id_route:n.id_route,id_event:n.id_event,comments:d.value,img:h,img_id:f,lat:T.latitude,lon:T.longitude},O=new FormData;for(const S in y)O.append(S,y[S]);console.log(O);const A=await(await fetch("https://app.rutaflow.com/api/admin/evidence/send_evidence.php",{method:"POST",body:O})).json();a();const P={},M=y.id_route;r&&v("","",M,r)}else console.log("No entré")}catch(N){console.error("Error fetching data:",N)}},v=(N,y,O,B)=>{o.componentProps.routeId=O,o.componentProps.driverId=n.id_driver,Ve("modal-km-gas",Rt,{checklist:N,driverId:y,routeId:O,isLast:B}).then(A=>{})},p=async()=>navigator.geolocation?new Promise((N,y)=>{navigator.geolocation.getCurrentPosition(O=>{T.latitude=O.coords.latitude,T.longitude=O.coords.longitude,N(!0)},O=>{console.error("Error getting location:",O),N(!1)})}):(console.error("Geolocation is not supported by your browser"),!1);function _(N){Ne[N?"unshift":"push"](()=>{d=N,t(0,d)})}return[d,h,n,k,a,E,_]}class Ln extends Ge{constructor(e){super(),We(this,e,wn,Cn,Ke,{})}}function kt(l){let e,t,o;return{c(){e=c("section"),t=c("ion-img"),this.h()},l(n){e=u(n,"SECTION",{});var r=g(e);t=u(r,"ION-IMG",{src:!0,alt:!0,style:!0}),g(t).forEach(s),r.forEach(s),this.h()},h(){$e(t.src,o=l[0])||b(t,"src",o),b(t,"alt","Evidencia fotográfica"),V(t,"max-width","100%"),V(t,"margin-top","16px")},m(n,r){z(n,e,r),i(e,t)},p(n,r){r&1&&!$e(t.src,o=n[0])&&b(t,"src",o)},d(n){n&&s(e)}}}function An(l){let e,t,o,n,r="Cancelar",d,h,f="Agregar Gasto",T,k,m,a="Confirmar",E,v,p,_,N,y,O,B,A,P,M,S,I,D,H,U,q,L='<div slot="label">Tipo de pago <ion-text color="danger">(Obligatorio)</ion-text></div> <ion-select-option value="cash">Efectivo</ion-select-option> <ion-select-option value="cash">Tarjeta</ion-select-option> <ion-select-option value="transfer">Transferencia</ion-select-option>',F,j,J,W,ue,be,Ce,_e,ie,ae,ge=`<ion-icon icon="${Bt}" slot="start"></ion-icon>
                        Subir Evidencia`,Pe,ve,Oe,pe,De,se=l[0]&&kt(l);return{c(){e=c("ion-header"),t=c("ion-toolbar"),o=c("ion-buttons"),n=c("ion-button"),n.textContent=r,d=C(),h=c("ion-title"),h.textContent=f,T=C(),k=c("ion-buttons"),m=c("ion-button"),m.textContent=a,E=C(),v=c("ion-content"),p=c("ion-list"),_=c("ion-item"),N=c("ion-icon"),y=C(),O=c("ion-input"),B=C(),A=c("ion-item"),P=c("ion-icon"),M=C(),S=c("ion-input"),I=C(),D=c("ion-item"),H=c("ion-icon"),U=C(),q=c("ion-select"),q.innerHTML=L,F=C(),j=c("ion-item"),J=c("ion-icon"),W=C(),ue=c("ion-textarea"),be=C(),Ce=c("section"),_e=c("label"),ie=c("ion-button"),ae=c("label"),ae.innerHTML=ge,Pe=C(),ve=c("input"),Oe=C(),se&&se.c(),this.h()},l(le){e=u(le,"ION-HEADER",{translucent:!0});var we=g(e);t=u(we,"ION-TOOLBAR",{});var Ae=g(t);o=u(Ae,"ION-BUTTONS",{slot:!0});var Le=g(o);n=u(Le,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),X(n)!=="svelte-1f8rjcf"&&(n.textContent=r),Le.forEach(s),d=w(Ae),h=u(Ae,"ION-TITLE",{title:!0,"data-svelte-h":!0}),X(h)!=="svelte-10xvxus"&&(h.textContent=f),T=w(Ae),k=u(Ae,"ION-BUTTONS",{slot:!0});var R=g(k);m=u(R,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),X(m)!=="svelte-k5zoz0"&&(m.textContent=a),R.forEach(s),Ae.forEach(s),we.forEach(s),E=w(le),v=u(le,"ION-CONTENT",{fullscreen:!0});var G=g(v);p=u(G,"ION-LIST",{});var Q=g(p);_=u(Q,"ION-ITEM",{});var re=g(_);N=u(re,"ION-ICON",{icon:!0,slot:!0}),g(N).forEach(s),y=w(re),O=u(re,"ION-INPUT",{label:!0,type:!0,placeholder:!0}),g(O).forEach(s),re.forEach(s),B=w(Q),A=u(Q,"ION-ITEM",{});var te=g(A);P=u(te,"ION-ICON",{icon:!0,slot:!0}),g(P).forEach(s),M=w(te),S=u(te,"ION-INPUT",{label:!0,type:!0}),g(S).forEach(s),te.forEach(s),I=w(Q),D=u(Q,"ION-ITEM",{});var ce=g(D);H=u(ce,"ION-ICON",{icon:!0,slot:!0}),g(H).forEach(s),U=w(ce),q=u(ce,"ION-SELECT",{placeholder:!0,"data-svelte-h":!0}),X(q)!=="svelte-1y2o04l"&&(q.innerHTML=L),ce.forEach(s),F=w(Q),j=u(Q,"ION-ITEM",{});var x=g(j);J=u(x,"ION-ICON",{icon:!0,slot:!0}),g(J).forEach(s),W=w(x),ue=u(x,"ION-TEXTAREA",{label:!0,placeholder:!0}),g(ue).forEach(s),x.forEach(s),be=w(Q),Ce=u(Q,"SECTION",{});var fe=g(Ce);_e=u(fe,"LABEL",{for:!0,style:!0});var ne=g(_e);ie=u(ne,"ION-BUTTON",{fill:!0,size:!0,class:!0,expand:!0});var Y=g(ie);ae=u(Y,"LABEL",{for:!0,style:!0,"data-svelte-h":!0}),X(ae)!=="svelte-1m9yw22"&&(ae.innerHTML=ge),Pe=w(Y),ve=u(Y,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0}),Y.forEach(s),ne.forEach(s),fe.forEach(s),Oe=w(Q),se&&se.l(Q),Q.forEach(s),G.forEach(s),this.h()},h(){b(n,"color","medium"),b(o,"slot","start"),b(h,"title",""),b(m,"strong",""),b(k,"slot","end"),b(e,"translucent",""),b(N,"icon",Ut),b(N,"slot","start"),b(O,"label","Concepto"),b(O,"type","text"),b(O,"placeholder","Escribe aquí..."),b(P,"icon",it),b(P,"slot","start"),b(S,"label","Cantidad"),b(S,"type","number"),b(H,"icon",xt),b(H,"slot","start"),b(q,"placeholder","Tipo de pago"),b(J,"icon",it),b(J,"slot","start"),b(ue,"label","Comentarios"),b(ue,"placeholder","Escribe aquí..."),K(ae,"for","eventEvidence"),V(ae,"width","100%"),V(ae,"padding","8px"),V(ve,"display","none"),K(ve,"id","eventEvidence"),K(ve,"name","fileToUpload"),K(ve,"type","file"),K(ve,"accept","image/*"),b(ie,"fill","outline"),b(ie,"size","small"),b(ie,"class","loadEvidence"),b(ie,"expand","block"),K(_e,"for","eventEvidence"),V(_e,"display","block"),V(_e,"width","100%"),b(v,"fullscreen","")},m(le,we){z(le,e,we),i(e,t),i(t,o),i(o,n),i(t,d),i(t,h),i(t,T),i(t,k),i(k,m),z(le,E,we),z(le,v,we),i(v,p),i(p,_),i(_,N),i(_,y),i(_,O),l[8](O),i(p,B),i(p,A),i(A,P),i(A,M),i(A,S),l[9](S),i(p,I),i(p,D),i(D,H),i(D,U),i(D,q),l[10](q),i(p,F),i(p,j),i(j,J),i(j,W),i(j,ue),l[11](ue),i(p,be),i(p,Ce),i(Ce,_e),i(_e,ie),i(ie,ae),i(ie,Pe),i(ie,ve),i(p,Oe),se&&se.m(p,null),pe||(De=[Z(n,"click",l[6]),Z(m,"click",l[7]),Z(ve,"change",l[5])],pe=!0)},p(le,[we]){le[0]?se?se.p(le,we):(se=kt(le),se.c(),se.m(p,null)):se&&(se.d(1),se=null)},i:Ie,o:Ie,d(le){le&&(s(e),s(E),s(v)),l[8](null),l[9](null),l[10](null),l[11](null),se&&se.d(),pe=!1,Be(De)}}}function Dn(l,e,t){let o=document.querySelector("ion-modal");o.componentProps.routeName;let n=o.componentProps.routeId,r="",d="",h="",f=0,T="",k="";const m=async O=>{const A=O.target.files[0],P=await a(A);if(P){const M=new FormData;M.append("fileToUpload",P);try{const S=await fetch("https://app.rutaflow.com/api/admin/manager/upload_img_driver.php",{method:"POST",body:M});if(S.ok){const I=await S.json();t(0,r=I.img),d=I.img_id}else console.error("File upload failed:",S.statusText)}catch(S){console.error("Error during file upload:",S)}}},a=async O=>new Promise(B=>{const A=new FileReader;A.onload=P=>{const M=new Image;M.src=P.target.result,M.onload=()=>{const S=document.createElement("canvas"),I=S.getContext("2d"),D=800,H=600;let U=M.width,q=M.height;U>D&&(q*=D/U,U=D),q>H&&(U*=H/q,q=H),S.width=U,S.height=q,I.drawImage(M,0,0,U,q),S.toBlob(L=>{B(L)},"image/jpeg",.7)}},A.readAsDataURL(O)}),E=()=>{o.dismiss({data:Date.now()})},v=()=>{var O=new Object;O.id_route=n,O.comments=T.value,O.type=h.value,O.img=r,O.img_id=d,O.amount=f.value,O.concept=k.value;const B=new FormData;for(const A in O)B.append(A,O[A]);console.log(B),fetch("https://app.rutaflow.com/api/admin/expenses/add_expense.php",{method:"POST",body:B}).then(A=>A.json()).then(A=>{E()}).catch(A=>{console.error("Error fetching data:",A)})};function p(O){Ne[O?"unshift":"push"](()=>{k=O,t(4,k)})}function _(O){Ne[O?"unshift":"push"](()=>{f=O,t(2,f)})}function N(O){Ne[O?"unshift":"push"](()=>{h=O,t(1,h)})}function y(O){Ne[O?"unshift":"push"](()=>{T=O,t(3,T)})}return[r,h,f,T,k,m,E,v,p,_,N,y]}class Pn extends Ge{constructor(e){super(),We(this,e,Dn,An,Ke,{})}}function Ot(l,e,t){const o=l.slice();return o[29]=e[t],o}function Nt(l,e,t){const o=l.slice();return o[29]=e[t],o[31]=t,o}function Tt(l,e,t){const o=l.slice();return o[29]=e[t],o[31]=t,o}function yt(l){let e,t;return e=new nn({props:{$$slots:{default:[Hn]},$$scope:{ctx:l}}}),{c(){Kt(e.$$.fragment)},l(o){Gt(e.$$.fragment,o)},m(o,n){Wt(e,o,n),t=!0},p(o,n){const r={};n[0]&255|n[1]&16&&(r.$$scope={dirty:n,ctx:o}),e.$set(r)},i(o){t||(Ze(e.$$.fragment,o),t=!0)},o(o){ot(e.$$.fragment,o),t=!1},d(o){Xt(e,o)}}}function Sn(l){let e=l[7].mandatory&&Array.isArray(l[7].mandatory)&&l[7].mandatory[0]==="0",t,o,n,r='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Jala para actualizar" refreshing-spinner="circles" refreshing-text="Actualizando..."></ion-refresher-content>',d,h,f=[],T=new Map,k,m,a=e&&Ct(l),E=Se(l[3]);const v=p=>p[29].id_event;for(let p=0;p<E.length;p+=1){let _=Ot(l,E,p),N=v(_);T.set(N,f[p]=Lt(N,_))}return{c(){a&&a.c(),t=C(),o=c("ion-content"),n=c("ion-refresher"),n.innerHTML=r,d=C(),h=c("ion-list");for(let p=0;p<f.length;p+=1)f[p].c();this.h()},l(p){a&&a.l(p),t=w(p),o=u(p,"ION-CONTENT",{});var _=g(o);n=u(_,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),X(n)!=="svelte-1jkndk3"&&(n.innerHTML=r),d=w(_),h=u(_,"ION-LIST",{});var N=g(h);for(let y=0;y<f.length;y+=1)f[y].l(N);N.forEach(s),_.forEach(s),this.h()},h(){b(n,"slot","fixed")},m(p,_){a&&a.m(p,_),z(p,t,_),z(p,o,_),i(o,n),l[22](n),i(o,d),i(o,h);for(let N=0;N<f.length;N+=1)f[N]&&f[N].m(h,null);k||(m=Z(n,"ionRefresh",l[8]),k=!0)},p(p,_){_[0]&128&&(e=p[7].mandatory&&Array.isArray(p[7].mandatory)&&p[7].mandatory[0]==="0"),e?a?a.p(p,_):(a=Ct(p),a.c(),a.m(t.parentNode,t)):a&&(a.d(1),a=null),_[0]&21e3&&(E=Se(p[3]),f=et(f,_,v,1,p,E,T,h,tt,Lt,null,Ot))},d(p){p&&(s(t),s(o)),a&&a.d(p),l[22](null);for(let _=0;_<f.length;_+=1)f[_].d();k=!1,m()}}}function Bn(l){let e,t;function o(d,h){return h[0]&32&&(e=null),e==null&&(e=!!d[5].every(qn)),e?Un:Mn}let n=o(l,[-1,-1]),r=n(l);return{c(){r.c(),t=ye()},l(d){r.l(d),t=ye()},m(d,h){r.m(d,h),z(d,t,h)},p(d,h){n===(n=o(d,h))&&r?r.p(d,h):(r.d(1),r=n(d),r&&(r.c(),r.m(t.parentNode,t)))},d(d){d&&s(t),r.d(d)}}}function Ct(l){let e=rt(l[0],"enroute")+"",t;return{c(){t=$(e)},l(o){t=ee(o,e)},m(o,n){z(o,t,n)},p(o,n){n[0]&1&&e!==(e=rt(o[0],"enroute")+"")&&ke(t,e)},d(o){o&&s(t)}}}function wt(l){let e;return{c(){e=c("span"),this.h()},l(t){e=u(t,"SPAN",{class:!0}),g(e).forEach(s),this.h()},h(){K(e,"class","notes svelte-ziybgw")},m(t,o){z(t,e,o)},d(t){t&&s(e)}}}function Lt(l,e){let t,o,n,r,d=parseInt(e[29].pos)+1+"",h,f,T,k,m,a,E=e[29].title+"",v,p,_=e[29].support_list&&e[29].support_list.length||e[12](e[29]),N,y,O,B,A,P=_&&wt();function M(){return e[23](e[29])}return{key:l,first:null,c(){t=c("ion-item"),o=c("ion-avatar"),n=c("div"),r=c("div"),h=$(d),T=C(),k=c("ion-label"),m=c("ion-text"),a=c("h3"),v=$(E),p=C(),P&&P.c(),N=C(),y=c("ion-icon"),O=C(),this.h()},l(S){t=u(S,"ION-ITEM",{});var I=g(t);o=u(I,"ION-AVATAR",{slot:!0});var D=g(o);n=u(D,"DIV",{class:!0,title:!0,style:!0});var H=g(n);r=u(H,"DIV",{class:!0});var U=g(r);h=ee(U,d),U.forEach(s),H.forEach(s),D.forEach(s),T=w(I),k=u(I,"ION-LABEL",{button:!0});var q=g(k);m=u(q,"ION-TEXT",{color:!0});var L=g(m);a=u(L,"H3",{});var F=g(a);v=ee(F,E),p=w(F),P&&P.l(F),F.forEach(s),L.forEach(s),q.forEach(s),N=w(I),y=u(I,"ION-ICON",{icon:!0,slot:!0,style:!0}),g(y).forEach(s),O=w(I),I.forEach(s),this.h()},h(){K(r,"class","order svelte-ziybgw"),K(n,"class","order-wrapper svelte-ziybgw"),K(n,"title",f=qe(e[29].status)),V(n,"background-color",Te(e[29])),V(n,"color",ze(Te(e[29]))),b(o,"slot","start"),b(m,"color","#2e2e2e"),b(k,"button",""),b(y,"icon",Fe),b(y,"slot","end"),V(y,"color",Te(e[29])),this.first=t},m(S,I){z(S,t,I),i(t,o),i(o,n),i(n,r),i(r,h),i(t,T),i(t,k),i(k,m),i(m,a),i(a,v),i(a,p),P&&P.m(a,null),i(t,N),i(t,y),i(t,O),B||(A=Z(k,"click",M),B=!0)},p(S,I){e=S,I[0]&8&&d!==(d=parseInt(e[29].pos)+1+"")&&ke(h,d),I[0]&8&&f!==(f=qe(e[29].status))&&K(n,"title",f),I[0]&8&&V(n,"background-color",Te(e[29])),I[0]&8&&V(n,"color",ze(Te(e[29]))),I[0]&8&&E!==(E=e[29].title+"")&&ke(v,E),I[0]&8&&(_=e[29].support_list&&e[29].support_list.length||e[12](e[29])),_?P||(P=wt(),P.c(),P.m(a,null)):P&&(P.d(1),P=null),I[0]&8&&V(y,"color",Te(e[29]))},d(S){S&&s(t),P&&P.d(),B=!1,A()}}}function Mn(l){let e=l[10](l[5],l[1],l[0])+"",t,o,n,r,d='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Pull to refresh" refreshing-spinner="circles" refreshing-text="Refreshing..."></ion-refresher-content>',h,f,T=[],k=new Map,m,a,E=Se(l[3]);const v=p=>p[29].id_event;for(let p=0;p<E.length;p+=1){let _=Nt(l,E,p),N=v(_);k.set(N,T[p]=Dt(N,_))}return{c(){t=$(e),o=C(),n=c("ion-content"),r=c("ion-refresher"),r.innerHTML=d,h=C(),f=c("ion-list");for(let p=0;p<T.length;p+=1)T[p].c();this.h()},l(p){t=ee(p,e),o=w(p),n=u(p,"ION-CONTENT",{});var _=g(n);r=u(_,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),X(r)!=="svelte-1poui8g"&&(r.innerHTML=d),h=w(_),f=u(_,"ION-LIST",{});var N=g(f);for(let y=0;y<T.length;y+=1)T[y].l(N);N.forEach(s),_.forEach(s),this.h()},h(){b(r,"slot","fixed")},m(p,_){z(p,t,_),z(p,o,_),z(p,n,_),i(n,r),l[20](r),i(n,h),i(n,f);for(let N=0;N<T.length;N+=1)T[N]&&T[N].m(f,null);m||(a=Z(r,"ionRefresh",l[8]),m=!0)},p(p,_){_[0]&35&&e!==(e=p[10](p[5],p[1],p[0])+"")&&ke(t,e),_[0]&37384&&(E=Se(p[3]),T=et(T,_,v,1,p,E,k,f,tt,Dt,null,Nt))},d(p){p&&(s(t),s(o),s(n)),l[20](null);for(let _=0;_<T.length;_+=1)T[_].d();m=!1,a()}}}function Un(l){let e,t,o='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Pull to refresh" refreshing-spinner="circles" refreshing-text="Refreshing..."></ion-refresher-content>',n,r,d=[],h=new Map,f,T,k=Se(l[3]);const m=a=>a[29].id_event;for(let a=0;a<k.length;a+=1){let E=Tt(l,k,a),v=m(E);h.set(v,d[a]=St(v,E))}return{c(){e=c("ion-content"),t=c("ion-refresher"),t.innerHTML=o,n=C(),r=c("ion-list");for(let a=0;a<d.length;a+=1)d[a].c();this.h()},l(a){e=u(a,"ION-CONTENT",{});var E=g(e);t=u(E,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),X(t)!=="svelte-1poui8g"&&(t.innerHTML=o),n=w(E),r=u(E,"ION-LIST",{});var v=g(r);for(let p=0;p<d.length;p+=1)d[p].l(v);v.forEach(s),E.forEach(s),this.h()},h(){b(t,"slot","fixed")},m(a,E){z(a,e,E),i(e,t),l[18](t),i(e,n),i(e,r);for(let v=0;v<d.length;v+=1)d[v]&&d[v].m(r,null);f||(T=Z(t,"ionRefresh",l[8]),f=!0)},p(a,E){E[0]&37384&&(k=Se(a[3]),d=et(d,E,m,1,a,k,h,r,tt,St,null,Tt))},d(a){a&&s(e),l[18](null);for(let E=0;E<d.length;E+=1)d[E].d();f=!1,T()}}}function At(l){let e;return{c(){e=c("span"),this.h()},l(t){e=u(t,"SPAN",{class:!0}),g(e).forEach(s),this.h()},h(){K(e,"class","notes svelte-ziybgw")},m(t,o){z(t,e,o)},d(t){t&&s(e)}}}function Dt(l,e){let t,o,n,r,d=parseInt(e[29].pos)+1+"",h,f,T,k,m,a,E=e[29].title+"",v,p,_=e[29].support_list&&e[29].support_list.length||e[12](e[29]),N,y,O="",B,A,P,M,S,I=_&&At();function D(){return e[21](e[29],e[31])}return{key:l,first:null,c(){t=c("ion-item"),o=c("ion-avatar"),n=c("div"),r=c("div"),h=$(d),T=C(),k=c("ion-label"),m=c("ion-text"),a=c("h3"),v=$(E),p=C(),I&&I.c(),N=C(),y=c("div"),y.innerHTML=O,B=C(),A=c("ion-icon"),P=C(),this.h()},l(H){t=u(H,"ION-ITEM",{});var U=g(t);o=u(U,"ION-AVATAR",{slot:!0});var q=g(o);n=u(q,"DIV",{class:!0,title:!0,style:!0});var L=g(n);r=u(L,"DIV",{class:!0});var F=g(r);h=ee(F,d),F.forEach(s),L.forEach(s),q.forEach(s),T=w(U),k=u(U,"ION-LABEL",{button:!0});var j=g(k);m=u(j,"ION-TEXT",{color:!0});var J=g(m);a=u(J,"H3",{});var W=g(a);v=ee(W,E),p=w(W),I&&I.l(W),W.forEach(s),J.forEach(s),N=w(j),y=u(j,"DIV",{class:!0,"data-svelte-h":!0}),X(y)!=="svelte-130ohbs"&&(y.innerHTML=O),j.forEach(s),B=w(U),A=u(U,"ION-ICON",{icon:!0,slot:!0}),g(A).forEach(s),P=w(U),U.forEach(s),this.h()},h(){K(r,"class","order svelte-ziybgw"),K(n,"class","order-wrapper svelte-ziybgw"),K(n,"title",f=qe(e[29].status)),V(n,"background-color",Te(e[29])),V(n,"color",ze(Te(e[29]))),b(o,"slot","start"),b(m,"color","#2e2e2e"),K(y,"class","sub svelte-ziybgw"),b(k,"button",""),b(A,"icon",Fe),b(A,"slot","end"),this.first=t},m(H,U){z(H,t,U),i(t,o),i(o,n),i(n,r),i(r,h),i(t,T),i(t,k),i(k,m),i(m,a),i(a,v),i(a,p),I&&I.m(a,null),i(k,N),i(k,y),i(t,B),i(t,A),i(t,P),M||(S=Z(k,"click",D),M=!0)},p(H,U){e=H,U[0]&8&&d!==(d=parseInt(e[29].pos)+1+"")&&ke(h,d),U[0]&8&&f!==(f=qe(e[29].status))&&K(n,"title",f),U[0]&8&&V(n,"background-color",Te(e[29])),U[0]&8&&V(n,"color",ze(Te(e[29]))),U[0]&8&&E!==(E=e[29].title+"")&&ke(v,E),U[0]&8&&(_=e[29].support_list&&e[29].support_list.length||e[12](e[29])),_?I||(I=At(),I.c(),I.m(a,null)):I&&(I.d(1),I=null)},d(H){H&&s(t),I&&I.d(),M=!1,S()}}}function Pt(l){let e;return{c(){e=c("span"),this.h()},l(t){e=u(t,"SPAN",{class:!0}),g(e).forEach(s),this.h()},h(){K(e,"class","notes svelte-ziybgw")},m(t,o){z(t,e,o)},d(t){t&&s(e)}}}function St(l,e){let t,o,n,r,d=parseInt(e[29].pos)+1+"",h,f,T,k,m,a,E=e[29].title+"",v,p,_=e[29].support_list&&e[29].support_list.length||e[12](e[29]),N,y,O="",B,A,P,M,S,I=_&&Pt();function D(){return e[19](e[29],e[31])}return{key:l,first:null,c(){t=c("ion-item"),o=c("ion-avatar"),n=c("div"),r=c("div"),h=$(d),T=C(),k=c("ion-label"),m=c("ion-text"),a=c("h3"),v=$(E),p=C(),I&&I.c(),N=C(),y=c("div"),y.innerHTML=O,B=C(),A=c("ion-icon"),P=C(),this.h()},l(H){t=u(H,"ION-ITEM",{});var U=g(t);o=u(U,"ION-AVATAR",{slot:!0});var q=g(o);n=u(q,"DIV",{class:!0,title:!0,style:!0});var L=g(n);r=u(L,"DIV",{class:!0});var F=g(r);h=ee(F,d),F.forEach(s),L.forEach(s),q.forEach(s),T=w(U),k=u(U,"ION-LABEL",{button:!0});var j=g(k);m=u(j,"ION-TEXT",{color:!0});var J=g(m);a=u(J,"H3",{});var W=g(a);v=ee(W,E),p=w(W),I&&I.l(W),W.forEach(s),J.forEach(s),N=w(j),y=u(j,"DIV",{class:!0,"data-svelte-h":!0}),X(y)!=="svelte-130ohbs"&&(y.innerHTML=O),j.forEach(s),B=w(U),A=u(U,"ION-ICON",{icon:!0,slot:!0}),g(A).forEach(s),P=w(U),U.forEach(s),this.h()},h(){K(r,"class","order svelte-ziybgw"),K(n,"class","order-wrapper svelte-ziybgw"),K(n,"title",f=qe(e[29].status)),V(n,"background-color",Te(e[29])),V(n,"color",ze(Te(e[29]))),b(o,"slot","start"),b(m,"color","#2e2e2e"),K(y,"class","sub svelte-ziybgw"),b(k,"button",""),b(A,"icon",Fe),b(A,"slot","end"),this.first=t},m(H,U){z(H,t,U),i(t,o),i(o,n),i(n,r),i(r,h),i(t,T),i(t,k),i(k,m),i(m,a),i(a,v),i(a,p),I&&I.m(a,null),i(k,N),i(k,y),i(t,B),i(t,A),i(t,P),M||(S=Z(k,"click",D),M=!0)},p(H,U){e=H,U[0]&8&&d!==(d=parseInt(e[29].pos)+1+"")&&ke(h,d),U[0]&8&&f!==(f=qe(e[29].status))&&K(n,"title",f),U[0]&8&&V(n,"background-color",Te(e[29])),U[0]&8&&V(n,"color",ze(Te(e[29]))),U[0]&8&&E!==(E=e[29].title+"")&&ke(v,E),U[0]&8&&(_=e[29].support_list&&e[29].support_list.length||e[12](e[29])),_?I||(I=Pt(),I.c(),I.m(a,null)):I&&(I.d(1),I=null)},d(H){H&&s(t),I&&I.d(),M=!1,S()}}}function Hn(l){let e,t,o,n,r=`<ion-icon icon="${$t}"></ion-icon>`,d,h,f,T=`<ion-icon icon="${en}"></ion-icon>`,k,m,a=l[2].name+"",E,v,p,_=l[4].name+"",N,y,O,B,A;function P(I,D){return I[5].length>0?Bn:Sn}let M=P(l),S=M(l);return{c(){e=c("ion-header"),t=c("ion-toolbar"),o=c("ion-buttons"),n=c("ion-button"),n.innerHTML=r,d=C(),h=c("ion-buttons"),f=c("ion-button"),f.innerHTML=T,k=C(),m=c("ion-button"),E=$(a),v=C(),p=c("ion-title"),N=$(_),y=C(),S.c(),O=ye(),this.h()},l(I){e=u(I,"ION-HEADER",{translucent:!0});var D=g(e);t=u(D,"ION-TOOLBAR",{});var H=g(t);o=u(H,"ION-BUTTONS",{slot:!0});var U=g(o);n=u(U,"ION-BUTTON",{title:!0,alt:!0,"data-svelte-h":!0}),X(n)!=="svelte-7ppz3r"&&(n.innerHTML=r),U.forEach(s),d=w(H),h=u(H,"ION-BUTTONS",{slot:!0});var q=g(h);f=u(q,"ION-BUTTON",{"data-svelte-h":!0}),X(f)!=="svelte-1mwna5t"&&(f.innerHTML=T),k=w(q),m=u(q,"ION-BUTTON",{});var L=g(m);E=ee(L,a),L.forEach(s),q.forEach(s),v=w(H),p=u(H,"ION-TITLE",{});var F=g(p);N=ee(F,_),F.forEach(s),H.forEach(s),D.forEach(s),y=w(I),S.l(I),O=ye(),this.h()},h(){b(n,"title","Atrás"),b(n,"alt","Atrás"),b(o,"slot","start"),b(h,"slot","end"),b(e,"translucent","")},m(I,D){z(I,e,D),i(e,t),i(t,o),i(o,n),i(t,d),i(t,h),i(h,f),i(h,k),i(h,m),i(m,E),i(t,v),i(t,p),i(p,N),z(I,y,D),S.m(I,D),z(I,O,D),B||(A=[Z(n,"click",l[13]),Z(f,"click",l[17])],B=!0)},p(I,D){D[0]&4&&a!==(a=I[2].name+"")&&ke(E,a),D[0]&16&&_!==(_=I[4].name+"")&&ke(N,_),M===(M=P(I))&&S?S.p(I,D):(S.d(1),S=M(I),S&&(S.c(),S.m(O.parentNode,O)))},d(I){I&&(s(e),s(y),s(O)),S.d(I),B=!1,Be(A)}}}function Rn(l){let e,t,o,n=l[2]&&yt(l);return{c(){e=C(),n&&n.c(),t=ye(),this.h()},l(r){jt("svelte-kn0kph",document.head).forEach(s),e=w(r),n&&n.l(r),t=ye(),this.h()},h(){document.title="Rutaflow - Detalles de ruta"},m(r,d){z(r,e,d),n&&n.m(r,d),z(r,t,d),o=!0},p(r,d){r[2]?n?(n.p(r,d),d[0]&4&&Ze(n,1)):(n=yt(r),n.c(),Ze(n,1),n.m(t.parentNode,t)):n&&(Jt(),ot(n,1,1,()=>{n=null}),Vt())},i(r){o||(Ze(n),o=!0)},o(r){ot(n),o=!1},d(r){r&&(s(e),s(t)),n&&n.d(r)}}}function Te(l){let e="#ffffff";return l.status==="pending"?e="#f2e300":l.status==="completed"&&(e="#44d900"),e}function qe(l){let e="";return l=="pending"?e="Pendiente":l=="completed"&&(e="Completado"),e}function ze(l){l.slice(0,1)==="#"&&(l=l.slice(1)),l.length===3&&(l=l.split("").map(function(r){return r+r}).join(""));const e=parseInt(l.substr(0,2),16),t=parseInt(l.substr(2,2),16),o=parseInt(l.substr(4,2),16);return(e*299+t*587+o*114)/1e3>=128?"#414040":"#fff"}function rt(l,e){let t=new FormData;return t.append("id_route",l),t.append("status",e),fetch("https://app.rutaflow.com/api/admin/route/change_status.php",{method:"POST",body:t}).then(o=>o.json()).then(o=>{}).catch(o=>{console.error("Error fetching data:",o)}),""}const qn=l=>l.img;function zn(l,e,t){let o,n;gt(l,tn,L=>t(16,o=L)),gt(l,xe,L=>t(7,n=L));var r=this&&this.__awaiter||function(L,F,j,J){function W(ue){return ue instanceof j?ue:new j(function(be){be(ue)})}return new(j||(j=Promise))(function(ue,be){function Ce(ae){try{ie(J.next(ae))}catch(ge){be(ge)}}function _e(ae){try{ie(J.throw(ae))}catch(ge){be(ge)}}function ie(ae){ae.done?ue(ae.value):W(ae.value).then(Ce,_e)}ie((J=J.apply(L,F||[])).next())})};let{routeId:d}=e,{driverId:h}=e,f=new Object,T=[],k={},m={},a;const E=()=>r(void 0,void 0,void 0,function*(){yield v(d),a.complete()});function v(L){const F=new FormData;F.append("id_route",L),fetch("https://app.rutaflow.com/api/admin/report/seguimiento_list.php",{method:"POST",body:F}).then(j=>j.json()).then(j=>{t(4,k=j.data.seguimiento_list[0]),t(3,T=j.data.event_list),t(5,m=j.data.checklist)}).catch(j=>{console.error("Error fetching data:",j)})}const p=L=>new Promise((F,j)=>{const J=new FormData;J.append("id_route",L.id_route),J.append("id_event",L.id_event),fetch("https://app.rutaflow.com/api/admin/evidence/evidence_by_event.php",{method:"POST",body:J}).then(W=>W.json()).then(W=>{F(W.data.event_evidence[0])}).catch(W=>{console.error("Error fetching data:",W),j(W)})}),_=(L,F)=>{p(L).then(j=>{j&&(L.img=j.img,L.driver_comments=j.driver_comments,L.comments=j.comments),Ve("modal-delivery-info",Ln,{delivery:L,isLast:F}).then(J=>{})})},N=(L,F,j)=>{var J=!1;return Ve("modal-checklist",Rt,{checklist:L,driverId:F,routeId:j,isLast:J}).then(W=>{}),rt(j,"checklist"),""},y=(L,F)=>(Ve("modal-expense",Pn,{routeName:L,routeId:F}).then(j=>{}),""),O=L=>{if(L.tracking_type=="subscription"){if(L.subscriber_info&&L.payment_type==="cash"&&new Date(L.subscriber_info.payment_next)<new Date)return!0}else if(L.tracking_type=="ecommerce"&&Number(L.payment_pending)>0)return!0;return!1},B=()=>{f.id_driver?Me(`/drivers/${f.id_driver}`):Me("/drivers/me")},A=(L,F)=>r(void 0,void 0,void 0,function*(){yield(yield Qe.create({header:L||"Error",message:F||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()});function P(L){return L===T.length-1}const M=()=>y(k.name,d);function S(L){Ne[L?"unshift":"push"](()=>{a=L,t(6,a)})}const I=(L,F)=>_(L,P(F));function D(L){Ne[L?"unshift":"push"](()=>{a=L,t(6,a)})}const H=(L,F)=>_(L,P(F));function U(L){Ne[L?"unshift":"push"](()=>{a=L,t(6,a)})}const q=L=>{const F=T.findIndex(be=>be.id_event===L.id_event),j=F===0,J=F>0?T[F-1]:null,W=j||J&&J.img!==null,ue=L.img!==null&&L.img!=="";W||j&&!ue?_(L):A("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")};return l.$$set=L=>{"routeId"in L&&t(0,d=L.routeId),"driverId"in L&&t(1,h=L.driverId)},l.$$.update=()=>{l.$$.dirty[0]&65541&&(t(0,{routeId:d,driverId:h}=o.params,d,(t(1,h),t(16,o),t(2,f),t(0,d))),t(2,f=JSON.parse(localStorage.getItem("userSession"))),f?f.id_user&&(f.type=="admin"||f.type=="super")?(Me(`/drivers/me/routes/${d}`),v(d)):f.id_user&&f.id_driver&&(v(d),Me(`/drivers/${f.id_driver}/routes/${d}`)):Me("/"))},[d,h,f,T,k,m,a,n,E,_,N,y,O,B,A,P,o,M,S,I,D,H,U,q]}class Jn extends Ge{constructor(e){super(),We(this,e,zn,Rn,Ke,{routeId:0,driverId:1},null,[-1,-1])}}export{Jn as component};

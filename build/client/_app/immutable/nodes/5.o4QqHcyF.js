import{Z as It,s as et,e as f,j as y,b as h,q as v,d as ne,h as u,m as w,v as b,i as V,w as r,x as fe,n as Ce,z as Re,_ as Pn,k as xe,B as c,o as ot,$ as Ot,t as ye,r as we,f as R,a0 as Pt,y as Ae,a1 as st,A as Be,F as yt,J as An,a2 as gt,a3 as Xe,a4 as wt,a5 as Nt,l as Dn,p as xn}from"../chunks/index.CdEBkEwf.js";import{S as tt,i as nt,b as En,d as In,m as On,t as ct,a as pt,e as yn,c as Bn,g as Un}from"../chunks/index.Dw8w8a4z.js";import{e as We,u as dt,d as ft,g as Ke,a as Ze,h as Ge,b as Hn,c as Rn,i as wn,f as zn,j as Nn,k as Vn,m as Fn,n as ut,o as Wn,q as Tt,r as Tn,s as Cn,t as Ct,v as Je,w as qn,x as jn,y as Lt,z as Mt,A as Gn,B as Kn,I as Xn,C as Jn,D as Yn,E as Qn,p as Zn}from"../chunks/index.CZhXU562.js";import"../chunks/index-6e05b96e.C_9q9BoX.js";import{m as $e,D as ht,a as Qe,W as $n,b as ei}from"../chunks/overlays-b874c3c3.BKCom4zt.js";import{q as ti,t as ni}from"../chunks/ion-modal.BYMRzj9z.js";import{g as at}from"../chunks/entry.bI2BqXYX.js";const ii=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global,oi=(l,e)=>{if(!customElements.get(l)){class t extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){new e({target:this.shadowRoot,props:this.componentProps||{}})}}customElements.define(l,t)}},li=l=>document.createElement(l).constructor!==HTMLElement,ri=(l,e)=>{li(l)||oi(l,e)},Ye=async(l,e,t={},n={})=>{ti(),ni(),ri(l,e);const i=await $e.create({component:l,componentProps:t,...n});return i.addEventListener("ionModalDidPresent",()=>{const o=i.querySelector(l);o&&(o.componentProps=t)}),await i.present(),i.onWillDismiss()};let lt=It({km_inicial:[],gas_inicial:[],km_final:[],gas_final:[]}),Ln=It({flag:[]});function si(l){let e,t,n,i,o="Cancelar",s,a,d="Captura de Km/Gas",k,g,_,m="Confirmar",p,E,O,N,D,P,U;return{c(){e=f("ion-header"),t=f("ion-toolbar"),n=f("ion-buttons"),i=f("ion-button"),i.textContent=o,s=y(),a=f("ion-title"),a.textContent=d,k=y(),g=f("ion-buttons"),_=f("ion-button"),_.textContent=m,p=y(),E=f("ion-content"),O=f("ion-item"),N=f("ion-input"),this.h()},l(x){e=h(x,"ION-HEADER",{translucent:!0});var z=v(e);t=h(z,"ION-TOOLBAR",{});var W=v(t);n=h(W,"ION-BUTTONS",{slot:!0});var C=v(n);i=h(C,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),ne(i)!=="svelte-17pq4f4"&&(i.textContent=o),C.forEach(u),s=w(W),a=h(W,"ION-TITLE",{"data-svelte-h":!0}),ne(a)!=="svelte-1yhkaq7"&&(a.textContent=d),k=w(W),g=h(W,"ION-BUTTONS",{slot:!0});var B=v(g);_=h(B,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),ne(_)!=="svelte-cm6j4s"&&(_.textContent=m),B.forEach(u),W.forEach(u),z.forEach(u),p=w(x),E=h(x,"ION-CONTENT",{fullscreen:!0});var S=v(E);O=h(S,"ION-ITEM",{});var I=v(O);N=h(I,"ION-INPUT",{class:!0,inputmode:!0,pattern:!0,type:!0,placeholder:!0,value:!0,required:!0});var T=v(N);T.forEach(u),I.forEach(u),S.forEach(u),this.h()},h(){b(i,"color","medium"),b(n,"slot","start"),b(_,"strong",""),b(g,"slot","end"),b(e,"translucent",""),b(N,"class","fin-km"),b(N,"inputmode","numeric"),b(N,"pattern","[0-9]*"),b(N,"type","number"),b(N,"placeholder",D="Ingresa "+l[0]+" actual"),b(N,"value",l[1]),b(N,"required",""),b(E,"fullscreen","")},m(x,z){V(x,e,z),r(e,t),r(t,n),r(n,i),r(t,s),r(t,a),r(t,k),r(t,g),r(g,_),V(x,p,z),V(x,E,z),r(E,O),r(O,N),P||(U=[fe(i,"click",l[2]),fe(_,"click",l[3]),fe(N,"input",l[4])],P=!0)},p(x,[z]){z&1&&D!==(D="Ingresa "+x[0]+" actual")&&b(N,"placeholder",D),z&2&&b(N,"value",x[1])},i:Ce,o:Ce,d(x){x&&(u(e),u(p),u(E)),P=!1,Re(U)}}}function ai(l,e,t){const n=Pn();let o=document.querySelector("ion-modal").componentProps.data_type,s="";Ln.subscribe(_=>{o=_.flag[0],o=="km_final"||o=="km_inicial"?t(0,s="kilometraje"):t(0,s="litros de gasolina")});let a=0;function d(){$e.dismiss()}function k(){n("modalResult",{data:"Your data",role:"confirm"}),o=="km_inicial"?lt.update(m=>({...m,km_inicial:[a]})):o=="gas_inicial"?lt.update(m=>({...m,gas_inicial:[a]})):o=="km_final"?lt.update(m=>({...m,km_final:[a]})):o=="gas_final"&&lt.update(m=>({...m,gas_final:[a]})),d()}return[s,a,d,k,_=>t(1,a=_.target.value)]}class ci extends tt{constructor(e){super(),nt(this,e,ai,si,et,{})}}const bt=It({items:[],checkedIndices:[],mandatory:[]});function At(l,e,t){const n=l.slice();return n[56]=e[t],n[57]=e,n[58]=t,n}function ui(l){let e,t,n,i,o,s="Kilometraje inicial",a,d,k=l[2]?l[2]+" km.":"Cargar km",g,_,m,p,E,O,N,D="Gasolina inicial (litros)",P,U,x=l[3]?l[3]+" litros":"Cargar gas",z,W,C,B;return W=Ot(l[22][0]),{c(){e=f("ion-item"),t=f("ion-label"),n=f("input"),i=y(),o=f("p"),o.textContent=s,a=y(),d=f("ion-button"),g=ye(k),_=y(),m=f("ion-item"),p=f("ion-label"),E=f("input"),O=y(),N=f("p"),N.textContent=D,P=y(),U=f("ion-button"),z=ye(x),this.h()},l(S){e=h(S,"ION-ITEM",{});var I=v(e);t=h(I,"ION-LABEL",{style:!0});var T=v(t);n=h(T,"INPUT",{id:!0,style:!0,type:!0}),i=w(T),o=h(T,"P",{style:!0,"data-svelte-h":!0}),ne(o)!=="svelte-88twxi"&&(o.textContent=s),T.forEach(u),a=w(I),d=h(I,"ION-BUTTON",{fill:!0,size:!0,class:!0,"aria-selected":!0});var M=v(d);g=we(M,k),M.forEach(u),I.forEach(u),_=w(S),m=h(S,"ION-ITEM",{});var A=v(m);p=h(A,"ION-LABEL",{style:!0});var $=v(p);E=h($,"INPUT",{id:!0,style:!0,type:!0}),O=w($),N=h($,"P",{style:!0,"data-svelte-h":!0}),ne(N)!=="svelte-1ux30eb"&&(N.textContent=D),$.forEach(u),P=w(A),U=h(A,"ION-BUTTON",{fill:!0,class:!0,size:!0,style:!0});var le=v(U);z=we(le,x),le.forEach(u),A.forEach(u),this.h()},h(){R(n,"id","chkbox-km-ini"),c(n,"pointer-events","auto"),R(n,"type","checkbox"),n.required=!0,c(o,"margin-left","10px"),c(t,"display","flex"),b(d,"fill","outline"),b(d,"size","small"),b(d,"class","loadKmInicial"),b(d,"aria-selected",""),R(E,"id","chkbox-gas-ini"),c(E,"pointer-events","auto"),R(E,"type","checkbox"),E.required=!0,c(N,"margin-left","10px"),c(p,"display","flex"),b(U,"fill","outline"),b(U,"class","loadGasInicial"),b(U,"size","small"),c(U,"height","16px "),W.p(n,E)},m(S,I){V(S,e,I),r(e,t),r(t,n),n.checked=~(l[6]||[]).indexOf(n.__value),l[29](n),r(t,i),r(t,o),r(e,a),r(e,d),r(d,g),V(S,_,I),V(S,m,I),r(m,p),r(p,E),l[31](E),E.checked=~(l[6]||[]).indexOf(E.__value),r(p,O),r(p,N),r(m,P),r(m,U),r(U,z),C||(B=[fe(n,"change",l[28]),fe(d,"click",l[30]),fe(E,"change",l[32]),fe(U,"click",l[33])],C=!0)},p(S,I){I[0]&65&&(n.checked=~(S[6]||[]).indexOf(n.__value)),I[0]&4&&k!==(k=S[2]?S[2]+" km.":"Cargar km")&&Ae(g,k),I[0]&65&&(E.checked=~(S[6]||[]).indexOf(E.__value)),I[0]&8&&x!==(x=S[3]?S[3]+" litros":"Cargar gas")&&Ae(z,x)},d(S){S&&(u(e),u(_),u(m)),l[29](null),l[31](null),W.r(),C=!1,Re(B)}}}function di(l){let e,t,n,i,o,s="Kilometraje final",a,d,k=l[4]?l[4]+" km.":"Cargar km",g,_,m,p,E,O,N,D="Gasolina final (litros)",P,U,x=l[5]?l[5]+" litros":"Cargar gas",z,W,C,B;return W=Ot(l[22][0]),{c(){e=f("ion-item"),t=f("ion-label"),n=f("input"),i=y(),o=f("p"),o.textContent=s,a=y(),d=f("ion-button"),g=ye(k),_=y(),m=f("ion-item"),p=f("ion-label"),E=f("input"),O=y(),N=f("p"),N.textContent=D,P=y(),U=f("ion-button"),z=ye(x),this.h()},l(S){e=h(S,"ION-ITEM",{});var I=v(e);t=h(I,"ION-LABEL",{style:!0});var T=v(t);n=h(T,"INPUT",{id:!0,style:!0,type:!0}),i=w(T),o=h(T,"P",{style:!0,"data-svelte-h":!0}),ne(o)!=="svelte-ccmu71"&&(o.textContent=s),T.forEach(u),a=w(I),d=h(I,"ION-BUTTON",{fill:!0,size:!0,class:!0,"aria-selected":!0});var M=v(d);g=we(M,k),M.forEach(u),I.forEach(u),_=w(S),m=h(S,"ION-ITEM",{});var A=v(m);p=h(A,"ION-LABEL",{style:!0});var $=v(p);E=h($,"INPUT",{id:!0,style:!0,type:!0}),O=w($),N=h($,"P",{style:!0,"data-svelte-h":!0}),ne(N)!=="svelte-wsoyd2"&&(N.textContent=D),$.forEach(u),P=w(A),U=h(A,"ION-BUTTON",{fill:!0,size:!0,class:!0});var le=v(U);z=we(le,x),le.forEach(u),A.forEach(u),this.h()},h(){R(n,"id","chkbox-km-fin"),c(n,"pointer-events","auto"),R(n,"type","checkbox"),n.required=!0,c(o,"margin-left","10px"),c(t,"display","flex"),b(d,"fill","outline"),b(d,"size","small"),b(d,"class","loadKmInicial"),b(d,"aria-selected",""),R(E,"id","chkbox-gas-fin"),c(E,"pointer-events","auto"),R(E,"type","checkbox"),E.required=!0,c(N,"margin-left","10px"),c(p,"display","flex"),b(U,"fill","outline"),b(U,"size","small"),b(U,"class","loadGasInicial"),W.p(n,E)},m(S,I){V(S,e,I),r(e,t),r(t,n),n.checked=~(l[6]||[]).indexOf(n.__value),l[23](n),r(t,i),r(t,o),r(e,a),r(e,d),r(d,g),V(S,_,I),V(S,m,I),r(m,p),r(p,E),E.checked=~(l[6]||[]).indexOf(E.__value),l[26](E),r(p,O),r(p,N),r(m,P),r(m,U),r(U,z),C||(B=[fe(n,"change",l[21]),fe(d,"click",l[24]),fe(E,"change",l[25]),fe(U,"click",l[27])],C=!0)},p(S,I){I[0]&65&&(n.checked=~(S[6]||[]).indexOf(n.__value)),I[0]&16&&k!==(k=S[4]?S[4]+" km.":"Cargar km")&&Ae(g,k),I[0]&65&&(E.checked=~(S[6]||[]).indexOf(E.__value)),I[0]&32&&x!==(x=S[5]?S[5]+" litros":"Cargar gas")&&Ae(z,x)},d(S){S&&(u(e),u(_),u(m)),l[23](null),l[26](null),W.r(),C=!1,Re(B)}}}function Dt(l){let e=[],t=new Map,n,i=We(l[0]);const o=s=>s[56].id_checklist_event;for(let s=0;s<i.length;s+=1){let a=At(l,i,s),d=o(a);t.set(d,e[s]=xt(d,a))}return{c(){for(let s=0;s<e.length;s+=1)e[s].c();n=xe()},l(s){for(let a=0;a<e.length;a+=1)e[a].l(s);n=xe()},m(s,a){for(let d=0;d<e.length;d+=1)e[d]&&e[d].m(s,a);V(s,n,a)},p(s,a){a[0]&827841&&(i=We(s[0]),e=dt(e,a,o,1,s,i,t,n.parentNode,ft,xt,n,At))},d(s){s&&u(n);for(let a=0;a<e.length;a+=1)e[a].d(s)}}}function fi(l){let e,t=(l[15][l[56].id_checklist_event]?l[15][l[56].id_checklist_event]:"Cargar evidencia")+"",n,i;return{c(){e=f("label"),n=ye(t),this.h()},l(o){e=h(o,"LABEL",{for:!0,class:!0});var s=v(e);n=we(s,t),s.forEach(u),this.h()},h(){R(e,"for",i="chklist-"+l[56].id_checklist_event),R(e,"class","button-label")},m(o,s){V(o,e,s),r(e,n)},p(o,s){s[0]&32769&&t!==(t=(o[15][o[56].id_checklist_event]?o[15][o[56].id_checklist_event]:"Cargar evidencia")+"")&&Ae(n,t),s[0]&1&&i!==(i="chklist-"+o[56].id_checklist_event)&&R(e,"for",i)},d(o){o&&u(e)}}}function hi(l){let e;return{c(){e=f("ion-spinner"),this.h()},l(t){e=h(t,"ION-SPINNER",{name:!0,class:!0}),v(e).forEach(u),this.h()},h(){b(e,"name","dots"),b(e,"class","button-spinner")},m(t,n){V(t,e,n)},p:Ce,d(t){t&&u(e)}}}function xt(l,e){let t,n,i,o,s,a=!1,d=e[56],k,g,_=e[56].item+"",m,p,E,O=e[56].mandatory=="1"?" * ":"",N,D,P,U,x,z,W,C,B,S,I;const T=()=>e[35](i,d),M=()=>e[35](null,d);function A(){return e[36](e[56])}function $(me,L){return me[13][me[56].id_checklist_event]?hi:fi}let le=$(e),de=le(e);function ie(...me){return e[38](e[56],...me)}return B=Ot(e[22][0]),{key:l,first:null,c(){t=f("ion-item"),n=f("ion-label"),i=f("input"),k=y(),g=f("p"),m=ye(_),p=y(),E=f("b"),N=ye(O),D=y(),P=f("ion-button"),U=f("div"),de.c(),x=y(),z=f("input"),C=y(),this.h()},l(me){t=h(me,"ION-ITEM",{});var L=v(t);n=h(L,"ION-LABEL",{style:!0});var oe=v(n);i=h(oe,"INPUT",{id:!0,style:!0,type:!0}),k=w(oe),g=h(oe,"P",{style:!0});var re=v(g);m=we(re,_),re.forEach(u),p=w(oe),E=h(oe,"B",{style:!0});var be=v(E);N=we(be,O),be.forEach(u),oe.forEach(u),D=w(L),P=h(L,"ION-BUTTON",{fill:!0,class:!0,size:!0});var se=v(P);U=h(se,"DIV",{class:!0});var X=v(U);de.l(X),x=w(X),z=h(X,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0,capture:!0}),X.forEach(u),se.forEach(u),C=w(L),L.forEach(u),this.h()},h(){R(i,"id",o=`chkbox-${e[56].id_checklist_event}`),c(i,"pointer-events","auto"),R(i,"type","checkbox"),i.__value=s=e[56].id_checklist_event,Pt(i,i.__value),i.required=!0,c(g,"margin-left","10px"),c(E,"margin-left","5px"),c(n,"display","flex"),c(z,"display","none"),R(z,"id",W="chklist-"+e[56].id_checklist_event),R(z,"name","fileToUpload"),R(z,"type","file"),R(z,"accept","image/*"),R(z,"capture","environment"),R(U,"class","button-content"),b(P,"fill","outline"),b(P,"class","loadEvidence"),b(P,"size","small"),B.p(i),this.first=t},m(me,L){V(me,t,L),r(t,n),r(n,i),i.checked=~(e[6]||[]).indexOf(i.__value),T(),r(n,k),r(n,g),r(g,m),r(n,p),r(n,E),r(E,N),r(t,D),r(t,P),r(P,U),de.m(U,null),r(U,x),r(U,z),e[37](z),r(t,C),S||(I=[fe(i,"change",e[34]),fe(i,"change",A),fe(z,"change",ie)],S=!0)},p(me,L){e=me,L[0]&1&&o!==(o=`chkbox-${e[56].id_checklist_event}`)&&R(i,"id",o),L[0]&1&&s!==(s=e[56].id_checklist_event)&&(i.__value=s,Pt(i,i.__value),a=!0),(a||L[0]&65)&&(i.checked=~(e[6]||[]).indexOf(i.__value)),d!==e[56]&&(M(),d=e[56],T()),L[0]&1&&_!==(_=e[56].item+"")&&Ae(m,_),L[0]&1&&O!==(O=e[56].mandatory=="1"?" * ":"")&&Ae(N,O),le===(le=$(e))&&de?de.p(e,L):(de.d(1),de=le(e),de&&(de.c(),de.m(U,x))),L[0]&1&&W!==(W="chklist-"+e[56].id_checklist_event)&&R(z,"id",W)},d(me){me&&u(t),M(),de.d(),e[37](null),B.r(),S=!1,Re(I)}}}function Bt(l){let e,t='<ion-spinner name="dots" style="color:white;"></ion-spinner>';return{c(){e=f("div"),e.innerHTML=t,this.h()},l(n){e=h(n,"DIV",{class:!0,style:!0,"data-svelte-h":!0}),ne(e)!=="svelte-1muo9sg"&&(e.innerHTML=t),this.h()},h(){R(e,"class","overlay"),c(e,"position","fixed"),c(e,"top","0"),c(e,"left","0"),c(e,"width","100vw"),c(e,"height","100vh"),c(e,"background","rgba(0, 0, 0, 0.5)"),c(e,"display","flex"),c(e,"align-items","center"),c(e,"justify-content","center"),c(e,"z-index","9999")},m(n,i){V(n,e,i)},d(n){n&&u(e)}}}function _i(l){let e,t,n,i,o="Cancelar",s,a,d="REQUERIMIENTOS DE RUTA",k,g,_,m,p,E,O,N="Confirmar",D,P,U,x;function z(I,T){return I[1]?di:ui}let W=z(l),C=W(l),B=l[0]&&Dt(l),S=l[14]&&Bt();return{c(){e=f("ion-header"),t=f("ion-toolbar"),n=f("ion-buttons"),i=f("ion-button"),i.textContent=o,s=y(),a=f("ion-title"),a.textContent=d,k=y(),g=f("ion-content"),_=f("ion-list"),C.c(),m=y(),B&&B.c(),p=y(),E=f("ion-footer"),O=f("ion-button"),O.textContent=N,D=y(),S&&S.c(),P=xe(),this.h()},l(I){e=h(I,"ION-HEADER",{translucent:!0});var T=v(e);t=h(T,"ION-TOOLBAR",{});var M=v(t);n=h(M,"ION-BUTTONS",{slot:!0});var A=v(n);i=h(A,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),ne(i)!=="svelte-18837zq"&&(i.textContent=o),A.forEach(u),s=w(M),a=h(M,"ION-TITLE",{"data-svelte-h":!0}),ne(a)!=="svelte-19bar5p"&&(a.textContent=d),M.forEach(u),T.forEach(u),k=w(I),g=h(I,"ION-CONTENT",{fullscreen:!0});var $=v(g);_=h($,"ION-LIST",{});var le=v(_);C.l(le),m=w(le),B&&B.l(le),le.forEach(u),$.forEach(u),p=w(I),E=h(I,"ION-FOOTER",{});var de=v(E);O=h(de,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),ne(O)!=="svelte-1vqzxem"&&(O.textContent=N),de.forEach(u),D=w(I),S&&S.l(I),P=xe(),this.h()},h(){b(i,"color","medium"),b(n,"slot","start"),b(e,"translucent",""),b(g,"fullscreen",""),b(O,"fill","outline"),b(O,"color","tertiary"),b(O,"strong",""),c(O,"width","99%"),c(O,"height","auto"),c(O,"margin-bottom","120px")},m(I,T){V(I,e,T),r(e,t),r(t,n),r(n,i),r(t,s),r(t,a),V(I,k,T),V(I,g,T),r(g,_),C.m(_,null),r(_,m),B&&B.m(_,null),V(I,p,T),V(I,E,T),r(E,O),V(I,D,T),S&&S.m(I,T),V(I,P,T),U||(x=[fe(i,"click",l[16]),fe(O,"click",l[17])],U=!0)},p(I,T){W===(W=z(I))&&C?C.p(I,T):(C.d(1),C=W(I),C&&(C.c(),C.m(_,m))),I[0]?B?B.p(I,T):(B=Dt(I),B.c(),B.m(_,null)):B&&(B.d(1),B=null),I[14]?S||(S=Bt(),S.c(),S.m(P.parentNode,P)):S&&(S.d(1),S=null)},i:Ce,o:Ce,d(I){I&&(u(e),u(k),u(g),u(p),u(E),u(D),u(P)),C.d(),B&&B.d(),S&&S.d(I),U=!1,Re(x)}}}function kt(l,e){if(typeof l=="object"&&l!==null||Array.isArray(l)){if(Array.isArray(l))return l.map(t=>kt(t,e)).flat();{const t=Object.keys(l);let n;return e=="id_checklist_event"?n=t.filter(o=>o.toLowerCase().includes("id_checklist_event")).map(o=>l[o]):e=="mandatory"?n=t.filter(o=>o.toLowerCase().includes("mandatory")).map(o=>l[o]):(console.error("Tipo de dato no reconocido."),n=!1),n}}else return console.error("Invalid input. Please provide a valid object or array."),[]}function pi(){return new Promise((l,e)=>{if(!navigator.geolocation)return e("Geoloc no soportada");navigator.geolocation.getCurrentPosition(t=>l({lat:+t.coords.latitude.toFixed(6),lng:+t.coords.longitude.toFixed(6)}),t=>e(t),{enableHighAccuracy:!0,maximumAge:0,timeout:8e3})})}function mi(l,e,t){let n=ht,i,o=[],s,a=!1,d,k,g,_,m=[],p=null,E={},O,N,D,P,U={},x=new Object,z=!1,W={},C={};ot(()=>{i=document.querySelector("ion-modal");const q=(i==null?void 0:i.componentProps)||{};if(t(0,o=q.checklist||[]),q.driverId,s=q.routeId,t(1,a=!!q.isLast),x=JSON.parse(localStorage.getItem("userSession")),a||bt.update(he=>(he.mandatory=kt(o,"mandatory"),he.items=kt(o,"id_checklist_event"),he)),i){i.breakpoints=[.25,.85,1],i.initialBreakpoint=.85;const he=H=>{var Y;const j=(Y=H.detail)==null?void 0:Y.breakpoint;j&&j>=.6&&i.setCurrentBreakpoint(.95)};i.addEventListener("ionBreakpointDidChange",he)}});function B(q){t(13,U[q]=!0,U)}const S=async()=>{await(await Qe.create({header:"Datos o checklist incompletos",message:"Carga la evidencia requerida y marca todas las casillas para confirmar",buttons:[{text:"Cerrar"}]})).present()},I=async(q,he)=>{await(await Qe.create({header:q||"Error",message:he||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()},T=async q=>{await(await Qe.create({header:"Datos inválidos",message:q=="km"?"Llena correctamente el campo de kilometraje inicial":"Llena correctamente el campo de gasolina inicial",buttons:[{text:"Cerrar"}]})).present()},M=()=>{$e.dismiss()},A=async()=>{if(t(14,z=!0),a){const q=me(g,"km"),he=me(_,"gas"),H={km_final:q,gas_final:he,id_route:s,id_user_over:x.id_user,token:x.token};q&&he?(M(),Ke(`${n}api/admin/checklist/add_evidence.php`,function(j){j.success?(t(14,z=!1),I("Datos capturados","El kilometraje y gasolina final fueron registrados correctamente, espere aprobación para finalizar ruta")):(t(14,z=!1),I("Error","Vuelva a intentar capturar los datos solicitados"))},H)):S()}else{const q=me(d,"km"),he=me(k,"gas");let H=null;try{H=await pi()}catch(j){console.warn("GPS no disponible:",j)}bt.update(j=>{const Y=j.mandatory,Ee=j.items.filter((te,pe)=>j.mandatory[pe]==="1").every(te=>j.checkedIndices.includes(te)),ce=Array.isArray(Y)&&Y.some(te=>te==="1")&&!Ee?"checklist-pending":"enroute";if(q&&he){let te=new FormData;te=se(te),te.append("km_inicial",q),te.append("gas_inicial",he),te.append("id_route",s),H&&(te.append("lat",H.lat),te.append("lng",H.lng));for(const pe in W)if(Object.prototype.hasOwnProperty.call(W,pe)){const{img:Ne,img_id:Pe}=W[pe];te.append(`selectedImages[${pe}][img]`,Ne),te.append(`selectedImages[${pe}][img_id]`,Pe)}fetch(`${n}api/admin/checklist/add_evidence.php`,{method:"POST",body:te}).then(pe=>pe.json()).then(()=>{ie(s,ce)}).catch(pe=>{console.error("Error fetching data:",pe)}).finally(()=>{t(14,z=!1),M()})}else(!q||!he)&&S();return j})}be()},$=async(q,he)=>{B(he);const j=q.target.files[0],Y=await le(j);if(Y){let Q=new FormData;Q.append("fileToUpload",Y),Q=se(Q);try{const Ee=await fetch(`${n}api/admin/manager/upload_img_driver.php`,{method:"POST",body:Q});if(Ee.ok){const F=await Ee.json();W={...W,[he]:{img:F.img,img_id:F.img_id}},t(15,C={...C,[he]:F.filename}),de(he),t(8,E[he].checked=!0,E),t(13,U[he]=!1,U)}else console.error("File upload failed:",Ee.statusText)}catch(Ee){console.error("Error durante la carga del archivo:",Ee)}}},le=async q=>new Promise(he=>{const H=new Image;H.src=URL.createObjectURL(q),H.onload=()=>{const j=document.createElement("canvas"),Y=j.getContext("2d"),Q=800,Ee=600;let F=H.width,ce=H.height;F>Q&&(ce*=Q/F,F=Q),ce>Ee&&(F*=Ee/ce,ce=Ee),j.width=F,j.height=ce,Y.drawImage(H,0,0,F,ce),j.toBlob(te=>{he(te),URL.revokeObjectURL(H.src),Y.clearRect(0,0,j.width,j.height)},"image/jpeg",.7)}}),de=q=>{bt.update(he=>(he.checkedIndices.indexOf(q)===-1?he.checkedIndices.push(q):console.error(`ID ${q} is already checked.`),he.items.forEach(j=>{j.id_checklist_event===q&&(j.checked=!0)}),he))};function ie(q,he){let H=new FormData;H.append("id_route",q),H.append("status",he),H=se(H),fetch(`${n}api/admin/route/change_status.php`,{method:"POST",body:H}).then(j=>j.json()).then(j=>{}).catch(j=>{console.error("Error fetching data:",j)})}function me(q,he){return/^\d+$/.test(q)?parseInt(q,10):(T(he),null)}function L(q,he){oe(he),i||(i=document.querySelector("ion-modal")),i&&(i.componentProps.data_type=he),Ye("modal-gas-km",ci,{r:he},{breakpoints:[.25,.85,1],initialBreakpoint:.85,backdropBreakpoint:.25,handle:!0,handleBehavior:"cycle",canDismiss:!0,showBackdrop:!0}).then(()=>{lt.subscribe(H=>re(H,he))})}function oe(q){Ln.update(he=>({...he,flag:[q]}))}function re(q,he){t(2,d=q.km_inicial?q.km_inicial:null),t(3,k=q.gas_inicial?q.gas_inicial:null),t(4,g=q.km_final?q.km_final:null),t(5,_=q.gas_final?q.gas_final:null),he=="km_inicial"&&O&&t(9,O.checked=!0,O),he=="gas_inicial"&&N&&t(10,N.checked=!0,N),he=="km_final"&&D&&t(11,D.checked=!0,D),he=="gas_final"&&P&&t(12,P.checked=!0,P)}function be(){lt.set({km_inicial:[],gas_inicial:[],km_final:[],gas_final:[]})}function se(q){return q.append("token",x.token),q.append("id_user_over",x.id_user),q}const X=[[]];function ge(){m=st(X[0],this.__value,this.checked),t(6,m)}function _e(q){Be[q?"unshift":"push"](()=>{D=q,t(11,D)})}const ae=q=>L(q,"km_final");function ee(){m=st(X[0],this.__value,this.checked),t(6,m)}function Ie(q){Be[q?"unshift":"push"](()=>{P=q,t(12,P)})}const ke=q=>L(q,"gas_final");function Oe(){m=st(X[0],this.__value,this.checked),t(6,m)}function Z(q){Be[q?"unshift":"push"](()=>{O=q,t(9,O)})}const J=q=>L(q,"km_inicial");function G(q){Be[q?"unshift":"push"](()=>{N=q,t(10,N)})}function ue(){m=st(X[0],this.__value,this.checked),t(6,m)}const K=q=>L(q,"gas_inicial");function ve(){m=st(X[0],this.__value,this.checked),t(6,m)}function Me(q,he){Be[q?"unshift":"push"](()=>{E[he.id_checklist_event]=q,t(8,E)})}const De=q=>de(q.id_checklist_event);function Se(q){Be[q?"unshift":"push"](()=>{p=q,t(7,p)})}return[o,a,d,k,g,_,m,p,E,O,N,D,P,U,z,C,M,A,$,de,L,ge,X,_e,ae,ee,Ie,ke,Oe,Z,J,G,ue,K,ve,Me,De,Se,(q,he)=>$(he,q.id_checklist_event)]}class Mn extends tt{constructor(e){super(),nt(this,e,mi,_i,et,{},null,[-1,-1])}}/*!
 * Signature Pad v5.0.10 | https://github.com/szimek/signature_pad
 * (c) 2025 Szymon Nowak | Released under the MIT license
 */class mt{constructor(e,t,n,i){if(isNaN(e)||isNaN(t))throw new Error(`Point is invalid: (${e}, ${t})`);this.x=+e,this.y=+t,this.pressure=n||0,this.time=i||Date.now()}distanceTo(e){return Math.sqrt(Math.pow(this.x-e.x,2)+Math.pow(this.y-e.y,2))}equals(e){return this.x===e.x&&this.y===e.y&&this.pressure===e.pressure&&this.time===e.time}velocityFrom(e){return this.time!==e.time?this.distanceTo(e)/(this.time-e.time):0}}class St{static fromPoints(e,t){const n=this.calculateControlPoints(e[0],e[1],e[2]).c2,i=this.calculateControlPoints(e[1],e[2],e[3]).c1;return new St(e[1],n,i,e[2],t.start,t.end)}static calculateControlPoints(e,t,n){const i=e.x-t.x,o=e.y-t.y,s=t.x-n.x,a=t.y-n.y,d={x:(e.x+t.x)/2,y:(e.y+t.y)/2},k={x:(t.x+n.x)/2,y:(t.y+n.y)/2},g=Math.sqrt(i*i+o*o),_=Math.sqrt(s*s+a*a),m=d.x-k.x,p=d.y-k.y,E=g+_==0?0:_/(g+_),O={x:k.x+m*E,y:k.y+p*E},N=t.x-O.x,D=t.y-O.y;return{c1:new mt(d.x+N,d.y+D),c2:new mt(k.x+N,k.y+D)}}constructor(e,t,n,i,o,s){this.startPoint=e,this.control2=t,this.control1=n,this.endPoint=i,this.startWidth=o,this.endWidth=s}length(){let t=0,n,i;for(let o=0;o<=10;o+=1){const s=o/10,a=this.point(s,this.startPoint.x,this.control1.x,this.control2.x,this.endPoint.x),d=this.point(s,this.startPoint.y,this.control1.y,this.control2.y,this.endPoint.y);if(o>0){const k=a-n,g=d-i;t+=Math.sqrt(k*k+g*g)}n=a,i=d}return t}point(e,t,n,i,o){return t*(1-e)*(1-e)*(1-e)+3*n*(1-e)*(1-e)*e+3*i*(1-e)*e*e+o*e*e*e}}class vi{constructor(){try{this._et=new EventTarget}catch{this._et=document}}addEventListener(e,t,n){this._et.addEventListener(e,t,n)}dispatchEvent(e){return this._et.dispatchEvent(e)}removeEventListener(e,t,n){this._et.removeEventListener(e,t,n)}}function gi(l,e=250){let t=0,n=null,i,o,s;const a=()=>{t=Date.now(),n=null,i=l.apply(o,s),n||(o=null,s=[])};return function(...k){const g=Date.now(),_=e-(g-t);return o=this,s=k,_<=0||_>e?(n&&(clearTimeout(n),n=null),t=g,i=l.apply(o,s),n||(o=null,s=[])):n||(n=window.setTimeout(a,_)),i}}class vt extends vi{constructor(e,t={}){var n,i,o;super(),this.canvas=e,this._drawingStroke=!1,this._isEmpty=!0,this._lastPoints=[],this._data=[],this._lastVelocity=0,this._lastWidth=0,this.velocityFilterWeight=t.velocityFilterWeight||.7,this.minWidth=t.minWidth||.5,this.maxWidth=t.maxWidth||2.5,this.throttle=(n=t.throttle)!==null&&n!==void 0?n:16,this.minDistance=(i=t.minDistance)!==null&&i!==void 0?i:5,this.dotSize=t.dotSize||0,this.penColor=t.penColor||"black",this.backgroundColor=t.backgroundColor||"rgba(0,0,0,0)",this.compositeOperation=t.compositeOperation||"source-over",this.canvasContextOptions=(o=t.canvasContextOptions)!==null&&o!==void 0?o:{},this._strokeMoveUpdate=this.throttle?gi(vt.prototype._strokeUpdate,this.throttle):vt.prototype._strokeUpdate,this._handleMouseDown=this._handleMouseDown.bind(this),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this._handleTouchStart=this._handleTouchStart.bind(this),this._handleTouchMove=this._handleTouchMove.bind(this),this._handleTouchEnd=this._handleTouchEnd.bind(this),this._handlePointerDown=this._handlePointerDown.bind(this),this._handlePointerMove=this._handlePointerMove.bind(this),this._handlePointerUp=this._handlePointerUp.bind(this),this._ctx=e.getContext("2d",this.canvasContextOptions),this.clear(),this.on()}clear(){const{_ctx:e,canvas:t}=this;e.fillStyle=this.backgroundColor,e.clearRect(0,0,t.width,t.height),e.fillRect(0,0,t.width,t.height),this._data=[],this._reset(this._getPointGroupOptions()),this._isEmpty=!0,this._strokePointerId=void 0}fromDataURL(e,t={}){return new Promise((n,i)=>{const o=new Image,s=t.ratio||window.devicePixelRatio||1,a=t.width||this.canvas.width/s,d=t.height||this.canvas.height/s,k=t.xOffset||0,g=t.yOffset||0;this._reset(this._getPointGroupOptions()),o.onload=()=>{this._ctx.drawImage(o,k,g,a,d),n()},o.onerror=_=>{i(_)},o.crossOrigin="anonymous",o.src=e,this._isEmpty=!1})}toDataURL(e="image/png",t){switch(e){case"image/svg+xml":return typeof t!="object"&&(t=void 0),`data:image/svg+xml;base64,${btoa(this.toSVG(t))}`;default:return typeof t!="number"&&(t=void 0),this.canvas.toDataURL(e,t)}}on(){this.canvas.style.touchAction="none",this.canvas.style.msTouchAction="none",this.canvas.style.userSelect="none";const e=/Macintosh/.test(navigator.userAgent)&&"ontouchstart"in document;window.PointerEvent&&!e?this._handlePointerEvents():(this._handleMouseEvents(),"ontouchstart"in window&&this._handleTouchEvents())}off(){this.canvas.style.touchAction="auto",this.canvas.style.msTouchAction="auto",this.canvas.style.userSelect="auto",this.canvas.removeEventListener("pointerdown",this._handlePointerDown),this.canvas.removeEventListener("mousedown",this._handleMouseDown),this.canvas.removeEventListener("touchstart",this._handleTouchStart),this._removeMoveUpEventListeners()}_getListenerFunctions(){var e;const t=window.document===this.canvas.ownerDocument?window:(e=this.canvas.ownerDocument.defaultView)!==null&&e!==void 0?e:this.canvas.ownerDocument;return{addEventListener:t.addEventListener.bind(t),removeEventListener:t.removeEventListener.bind(t)}}_removeMoveUpEventListeners(){const{removeEventListener:e}=this._getListenerFunctions();e("pointermove",this._handlePointerMove),e("pointerup",this._handlePointerUp),e("mousemove",this._handleMouseMove),e("mouseup",this._handleMouseUp),e("touchmove",this._handleTouchMove),e("touchend",this._handleTouchEnd)}isEmpty(){return this._isEmpty}fromData(e,{clear:t=!0}={}){t&&this.clear(),this._fromData(e,this._drawCurve.bind(this),this._drawDot.bind(this)),this._data=this._data.concat(e)}toData(){return this._data}_isLeftButtonPressed(e,t){return t?e.buttons===1:(e.buttons&1)===1}_pointerEventToSignatureEvent(e){return{event:e,type:e.type,x:e.clientX,y:e.clientY,pressure:"pressure"in e?e.pressure:0}}_touchEventToSignatureEvent(e){const t=e.changedTouches[0];return{event:e,type:e.type,x:t.clientX,y:t.clientY,pressure:t.force}}_handleMouseDown(e){!this._isLeftButtonPressed(e,!0)||this._drawingStroke||this._strokeBegin(this._pointerEventToSignatureEvent(e))}_handleMouseMove(e){if(!this._isLeftButtonPressed(e,!0)||!this._drawingStroke){this._strokeEnd(this._pointerEventToSignatureEvent(e),!1);return}this._strokeMoveUpdate(this._pointerEventToSignatureEvent(e))}_handleMouseUp(e){this._isLeftButtonPressed(e)||this._strokeEnd(this._pointerEventToSignatureEvent(e))}_handleTouchStart(e){e.targetTouches.length!==1||this._drawingStroke||(e.cancelable&&e.preventDefault(),this._strokeBegin(this._touchEventToSignatureEvent(e)))}_handleTouchMove(e){if(e.targetTouches.length===1){if(e.cancelable&&e.preventDefault(),!this._drawingStroke){this._strokeEnd(this._touchEventToSignatureEvent(e),!1);return}this._strokeMoveUpdate(this._touchEventToSignatureEvent(e))}}_handleTouchEnd(e){e.targetTouches.length===0&&(e.cancelable&&e.preventDefault(),this._strokeEnd(this._touchEventToSignatureEvent(e)))}_getPointerId(e){return e.persistentDeviceId||e.pointerId}_allowPointerId(e,t=!1){return typeof this._strokePointerId>"u"?t:this._getPointerId(e)===this._strokePointerId}_handlePointerDown(e){this._drawingStroke||!this._isLeftButtonPressed(e)||!this._allowPointerId(e,!0)||(this._strokePointerId=this._getPointerId(e),e.preventDefault(),this._strokeBegin(this._pointerEventToSignatureEvent(e)))}_handlePointerMove(e){if(this._allowPointerId(e)){if(!this._isLeftButtonPressed(e,!0)||!this._drawingStroke){this._strokeEnd(this._pointerEventToSignatureEvent(e),!1);return}e.preventDefault(),this._strokeMoveUpdate(this._pointerEventToSignatureEvent(e))}}_handlePointerUp(e){this._isLeftButtonPressed(e)||!this._allowPointerId(e)||(e.preventDefault(),this._strokeEnd(this._pointerEventToSignatureEvent(e)))}_getPointGroupOptions(e){return{penColor:e&&"penColor"in e?e.penColor:this.penColor,dotSize:e&&"dotSize"in e?e.dotSize:this.dotSize,minWidth:e&&"minWidth"in e?e.minWidth:this.minWidth,maxWidth:e&&"maxWidth"in e?e.maxWidth:this.maxWidth,velocityFilterWeight:e&&"velocityFilterWeight"in e?e.velocityFilterWeight:this.velocityFilterWeight,compositeOperation:e&&"compositeOperation"in e?e.compositeOperation:this.compositeOperation}}_strokeBegin(e){if(!this.dispatchEvent(new CustomEvent("beginStroke",{detail:e,cancelable:!0})))return;const{addEventListener:n}=this._getListenerFunctions();switch(e.event.type){case"mousedown":n("mousemove",this._handleMouseMove,{passive:!1}),n("mouseup",this._handleMouseUp,{passive:!1});break;case"touchstart":n("touchmove",this._handleTouchMove,{passive:!1}),n("touchend",this._handleTouchEnd,{passive:!1});break;case"pointerdown":n("pointermove",this._handlePointerMove,{passive:!1}),n("pointerup",this._handlePointerUp,{passive:!1});break}this._drawingStroke=!0;const i=this._getPointGroupOptions(),o=Object.assign(Object.assign({},i),{points:[]});this._data.push(o),this._reset(i),this._strokeUpdate(e)}_strokeUpdate(e){if(!this._drawingStroke)return;if(this._data.length===0){this._strokeBegin(e);return}this.dispatchEvent(new CustomEvent("beforeUpdateStroke",{detail:e}));const t=this._createPoint(e.x,e.y,e.pressure),n=this._data[this._data.length-1],i=n.points,o=i.length>0&&i[i.length-1],s=o?t.distanceTo(o)<=this.minDistance:!1,a=this._getPointGroupOptions(n);if(!o||!(o&&s)){const d=this._addPoint(t,a);o?d&&this._drawCurve(d,a):this._drawDot(t,a),i.push({time:t.time,x:t.x,y:t.y,pressure:t.pressure})}this.dispatchEvent(new CustomEvent("afterUpdateStroke",{detail:e}))}_strokeEnd(e,t=!0){this._removeMoveUpEventListeners(),this._drawingStroke&&(t&&this._strokeUpdate(e),this._drawingStroke=!1,this._strokePointerId=void 0,this.dispatchEvent(new CustomEvent("endStroke",{detail:e})))}_handlePointerEvents(){this._drawingStroke=!1,this.canvas.addEventListener("pointerdown",this._handlePointerDown,{passive:!1})}_handleMouseEvents(){this._drawingStroke=!1,this.canvas.addEventListener("mousedown",this._handleMouseDown,{passive:!1})}_handleTouchEvents(){this.canvas.addEventListener("touchstart",this._handleTouchStart,{passive:!1})}_reset(e){this._lastPoints=[],this._lastVelocity=0,this._lastWidth=(e.minWidth+e.maxWidth)/2,this._ctx.fillStyle=e.penColor,this._ctx.globalCompositeOperation=e.compositeOperation}_createPoint(e,t,n){const i=this.canvas.getBoundingClientRect();return new mt(e-i.left,t-i.top,n,new Date().getTime())}_addPoint(e,t){const{_lastPoints:n}=this;if(n.push(e),n.length>2){n.length===3&&n.unshift(n[0]);const i=this._calculateCurveWidths(n[1],n[2],t),o=St.fromPoints(n,i);return n.shift(),o}return null}_calculateCurveWidths(e,t,n){const i=n.velocityFilterWeight*t.velocityFrom(e)+(1-n.velocityFilterWeight)*this._lastVelocity,o=this._strokeWidth(i,n),s={end:o,start:this._lastWidth};return this._lastVelocity=i,this._lastWidth=o,s}_strokeWidth(e,t){return Math.max(t.maxWidth/(e+1),t.minWidth)}_drawCurveSegment(e,t,n){const i=this._ctx;i.moveTo(e,t),i.arc(e,t,n,0,2*Math.PI,!1),this._isEmpty=!1}_drawCurve(e,t){const n=this._ctx,i=e.endWidth-e.startWidth,o=Math.ceil(e.length())*2;n.beginPath(),n.fillStyle=t.penColor;for(let s=0;s<o;s+=1){const a=s/o,d=a*a,k=d*a,g=1-a,_=g*g,m=_*g;let p=m*e.startPoint.x;p+=3*_*a*e.control1.x,p+=3*g*d*e.control2.x,p+=k*e.endPoint.x;let E=m*e.startPoint.y;E+=3*_*a*e.control1.y,E+=3*g*d*e.control2.y,E+=k*e.endPoint.y;const O=Math.min(e.startWidth+k*i,t.maxWidth);this._drawCurveSegment(p,E,O)}n.closePath(),n.fill()}_drawDot(e,t){const n=this._ctx,i=t.dotSize>0?t.dotSize:(t.minWidth+t.maxWidth)/2;n.beginPath(),this._drawCurveSegment(e.x,e.y,i),n.closePath(),n.fillStyle=t.penColor,n.fill()}_fromData(e,t,n){for(const i of e){const{points:o}=i,s=this._getPointGroupOptions(i);if(o.length>1)for(let a=0;a<o.length;a+=1){const d=o[a],k=new mt(d.x,d.y,d.pressure,d.time);a===0&&this._reset(s);const g=this._addPoint(k,s);g&&t(g,s)}else this._reset(s),n(o[0],s)}}toSVG({includeBackgroundColor:e=!1}={}){const t=this._data,n=Math.max(window.devicePixelRatio||1,1),i=0,o=0,s=this.canvas.width/n,a=this.canvas.height/n,d=document.createElementNS("http://www.w3.org/2000/svg","svg");if(d.setAttribute("xmlns","http://www.w3.org/2000/svg"),d.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),d.setAttribute("viewBox",`${i} ${o} ${s} ${a}`),d.setAttribute("width",s.toString()),d.setAttribute("height",a.toString()),e&&this.backgroundColor){const k=document.createElement("rect");k.setAttribute("width","100%"),k.setAttribute("height","100%"),k.setAttribute("fill",this.backgroundColor),d.appendChild(k)}return this._fromData(t,(k,{penColor:g})=>{const _=document.createElement("path");if(!isNaN(k.control1.x)&&!isNaN(k.control1.y)&&!isNaN(k.control2.x)&&!isNaN(k.control2.y)){const m=`M ${k.startPoint.x.toFixed(3)},${k.startPoint.y.toFixed(3)} C ${k.control1.x.toFixed(3)},${k.control1.y.toFixed(3)} ${k.control2.x.toFixed(3)},${k.control2.y.toFixed(3)} ${k.endPoint.x.toFixed(3)},${k.endPoint.y.toFixed(3)}`;_.setAttribute("d",m),_.setAttribute("stroke-width",(k.endWidth*2.25).toFixed(3)),_.setAttribute("stroke",g),_.setAttribute("fill","none"),_.setAttribute("stroke-linecap","round"),d.appendChild(_)}},(k,{penColor:g,dotSize:_,minWidth:m,maxWidth:p})=>{const E=document.createElement("circle"),O=_>0?_:(m+p)/2;E.setAttribute("r",O.toString()),E.setAttribute("cx",k.x.toString()),E.setAttribute("cy",k.y.toString()),E.setAttribute("fill",g),d.appendChild(E)}),d.outerHTML}}function bi(l){let e,t;return{c(){e=f("div"),t=f("canvas"),this.h()},l(n){e=h(n,"DIV",{class:!0,style:!0});var i=v(e);t=h(i,"CANVAS",{class:!0,style:!0}),v(t).forEach(u),i.forEach(u),this.h()},h(){R(t,"class","signature-canvas"),c(t,"position","absolute"),c(t,"top","0"),c(t,"left","0"),c(t,"width","100%"),c(t,"height","100%"),c(t,"display","block"),R(e,"class","signature-container"),c(e,"position","relative"),c(e,"width","100%"),c(e,"height","150px"),c(e,"border","1px solid #ccc"),c(e,"border-radius","4px"),c(e,"touch-action","none"),c(e,"-ms-touch-action","none")},m(n,i){V(n,e,i),r(e,t),l[5](t),l[6](e)},p:Ce,i:Ce,o:Ce,d(n){n&&u(e),l[5](null),l[6](null)}}}function ki(l,e,t){let n,i,o,s;function a(){o&&o.clear()}async function d(p="image/png"){return!o||o.isEmpty()?(await(await Qe.create({header:"Firma vacía",message:"No existe firma por guardar",buttons:[{text:"Cerrar"}]})).present(),null):o.toDataURL(p)}function k(){g(),o&&o.clear()}function g(){const p=Math.max(window.devicePixelRatio||1,1),E=i.clientWidth,O=i.clientHeight;if(!E||!O)return;const N=32767,D=Math.min(p,N/E,N/O);t(0,n.width=Math.floor(E*D),n),t(0,n.height=Math.floor(O*D),n);const P=n.getContext("2d");try{P.scale(D,D)}catch(U){console.warn("Canvas scale failed:",U)}}ot(async()=>{await yt(),g(),o=new vt(n,{backgroundColor:"rgba(255, 255, 255, 0)",penColor:"black"}),s=new ResizeObserver(g),s.observe(i)}),An(()=>{s&&s.disconnect()});function _(p){Be[p?"unshift":"push"](()=>{n=p,t(0,n)})}function m(p){Be[p?"unshift":"push"](()=>{i=p,t(1,i)})}return[n,i,a,d,k,_,m]}class Ei extends tt{constructor(e){super(),nt(this,e,ki,bi,et,{clear:2,save:3,reset:4})}get clear(){return this.$$.ctx[2]}get save(){return this.$$.ctx[3]}get reset(){return this.$$.ctx[4]}}function Ii(l){let e,t,n,i,o="Cancelar",s,a,d="Firmar",k,g,_,m,p,E,O,N="Borrar",D,P,U="Guardar",x,z,W,C={};return m=new Ei({props:C}),l[4](m),{c(){e=f("ion-header"),t=f("ion-toolbar"),n=f("ion-buttons"),i=f("ion-button"),i.textContent=o,s=y(),a=f("ion-title"),a.textContent=d,k=y(),g=f("ion-content"),_=f("section"),En(m.$$.fragment),p=y(),E=f("div"),O=f("ion-button"),O.textContent=N,D=y(),P=f("ion-button"),P.textContent=U,this.h()},l(B){e=h(B,"ION-HEADER",{translucent:!0});var S=v(e);t=h(S,"ION-TOOLBAR",{});var I=v(t);n=h(I,"ION-BUTTONS",{slot:!0});var T=v(n);i=h(T,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),ne(i)!=="svelte-sam1rw"&&(i.textContent=o),T.forEach(u),s=w(I),a=h(I,"ION-TITLE",{"data-svelte-h":!0}),ne(a)!=="svelte-1ibb3l9"&&(a.textContent=d),I.forEach(u),S.forEach(u),k=w(B),g=h(B,"ION-CONTENT",{fullscreen:!0});var M=v(g);_=h(M,"SECTION",{style:!0});var A=v(_);In(m.$$.fragment,A),p=w(A),E=h(A,"DIV",{style:!0});var $=v(E);O=h($,"ION-BUTTON",{fill:!0,style:!0,"data-svelte-h":!0}),ne(O)!=="svelte-1rt6y6r"&&(O.textContent=N),D=w($),P=h($,"ION-BUTTON",{style:!0,"data-svelte-h":!0}),ne(P)!=="svelte-7uw5bf"&&(P.textContent=U),$.forEach(u),A.forEach(u),M.forEach(u),this.h()},h(){b(i,"color","medium"),b(n,"slot","start"),b(e,"translucent",""),b(O,"fill","outline"),c(O,"flex","1"),c(P,"flex","1"),c(E,"display","flex"),c(E,"gap","8px"),c(_,"display","flex"),c(_,"flex-direction","column"),c(_,"gap","12px"),c(_,"padding","16px"),b(g,"fullscreen","")},m(B,S){V(B,e,S),r(e,t),r(t,n),r(n,i),r(t,s),r(t,a),V(B,k,S),V(B,g,S),r(g,_),On(m,_,null),r(_,p),r(_,E),r(E,O),r(E,D),r(E,P),x=!0,z||(W=[fe(i,"click",l[1]),fe(O,"click",l[3]),fe(P,"click",l[2])],z=!0)},p(B,[S]){const I={};m.$set(I)},i(B){x||(ct(m.$$.fragment,B),x=!0)},o(B){pt(m.$$.fragment,B),x=!1},d(B){B&&(u(e),u(k),u(g)),l[4](null),yn(m),z=!1,Re(W)}}}function Oi(l,e,t){let n;function i(){$e.dismiss()}async function o(){const d=await n.save();d&&$e.dismiss({dataUrl:d})}function s(){n.clear()}function a(d){Be[d?"unshift":"push"](()=>{n=d,t(0,n)})}return[n,i,o,s,a]}class yi extends tt{constructor(e){super(),nt(this,e,Oi,Ii,et,{})}}function Ut(l,e,t){const n=l.slice();return n[60]=e[t],n[62]=t,n}function wi(l){let e,t,n,i,o;return{c(){e=f("ion-buttons"),t=f("ion-button"),n=ye("Confirmar"),this.h()},l(s){e=h(s,"ION-BUTTONS",{slot:!0});var a=v(e);t=h(a,"ION-BUTTON",{strong:!0,disabled:!0});var d=v(t);n=we(d,"Confirmar"),d.forEach(u),a.forEach(u),this.h()},h(){b(t,"strong",""),b(t,"disabled",l[21]()),b(e,"slot","end")},m(s,a){V(s,e,a),r(e,t),r(t,n),i||(o=fe(t,"click",l[24]),i=!0)},p:Ce,d(s){s&&u(e),i=!1,o()}}}function Ni(l){let e,t,n,i,o,s="Empresa",a,d,k=l[10].enterprise_name+"",g;return{c(){e=f("ion-item"),t=f("ion-icon"),n=y(),i=f("ion-label"),o=f("p"),o.textContent=s,a=y(),d=f("h2"),g=ye(k),this.h()},l(_){e=h(_,"ION-ITEM",{});var m=v(e);t=h(m,"ION-ICON",{icon:!0,slot:!0}),v(t).forEach(u),n=w(m),i=h(m,"ION-LABEL",{});var p=v(i);o=h(p,"P",{"data-svelte-h":!0}),ne(o)!=="svelte-6noid3"&&(o.textContent=s),a=w(p),d=h(p,"H2",{});var E=v(d);g=we(E,k),E.forEach(u),p.forEach(u),m.forEach(u),this.h()},h(){b(t,"icon",Cn),b(t,"slot","start")},m(_,m){V(_,e,m),r(e,t),r(e,n),r(e,i),r(i,o),r(i,a),r(i,d),r(d,g)},p:Ce,d(_){_&&u(e)}}}function Ti(l){let e,t,n,i,o,s="Negocio",a,d,k=l[10].client_name+"",g;return{c(){e=f("ion-item"),t=f("ion-icon"),n=y(),i=f("ion-label"),o=f("p"),o.textContent=s,a=y(),d=f("h2"),g=ye(k),this.h()},l(_){e=h(_,"ION-ITEM",{});var m=v(e);t=h(m,"ION-ICON",{icon:!0,slot:!0}),v(t).forEach(u),n=w(m),i=h(m,"ION-LABEL",{});var p=v(i);o=h(p,"P",{"data-svelte-h":!0}),ne(o)!=="svelte-57b1dg"&&(o.textContent=s),a=w(p),d=h(p,"H2",{});var E=v(d);g=we(E,k),E.forEach(u),p.forEach(u),m.forEach(u),this.h()},h(){b(t,"icon",Cn),b(t,"slot","start")},m(_,m){V(_,e,m),r(e,t),r(e,n),r(e,i),r(i,o),r(i,a),r(i,d),r(d,g)},p:Ce,d(_){_&&u(e)}}}function Ci(l){let e,t,n,i,o,s="Teléfono de Negocio",a,d,k=l[10].client_phone+"",g;return{c(){e=f("ion-item"),t=f("ion-icon"),n=y(),i=f("ion-label"),o=f("p"),o.textContent=s,a=y(),d=f("h2"),g=ye(k),this.h()},l(_){e=h(_,"ION-ITEM",{href:!0});var m=v(e);t=h(m,"ION-ICON",{icon:!0,slot:!0}),v(t).forEach(u),n=w(m),i=h(m,"ION-LABEL",{class:!0});var p=v(i);o=h(p,"P",{"data-svelte-h":!0}),ne(o)!=="svelte-1u5l7fz"&&(o.textContent=s),a=w(p),d=h(p,"H2",{});var E=v(d);g=we(E,k),E.forEach(u),p.forEach(u),m.forEach(u),this.h()},h(){b(t,"icon",Hn),b(t,"slot","start"),b(i,"class","ion-text-wrap"),b(e,"href","tel:"+l[10].client_phone)},m(_,m){V(_,e,m),r(e,t),r(e,n),r(e,i),r(i,o),r(i,a),r(i,d),r(d,g)},p:Ce,d(_){_&&u(e)}}}function Li(l){let e,t,n,i,o,s="Domicilio Alternativo",a,d,k=l[10].line2+"",g,_,m;return{c(){e=f("ion-item"),t=f("ion-icon"),n=y(),i=f("ion-label"),o=f("p"),o.textContent=s,a=y(),d=f("h2"),g=ye(k),_=y(),m=f("ion-icon"),this.h()},l(p){e=h(p,"ION-ITEM",{href:!0});var E=v(e);t=h(E,"ION-ICON",{icon:!0,slot:!0}),v(t).forEach(u),n=w(E),i=h(E,"ION-LABEL",{class:!0});var O=v(i);o=h(O,"P",{"data-svelte-h":!0}),ne(o)!=="svelte-1ub9uzw"&&(o.textContent=s),a=w(O),d=h(O,"H2",{});var N=v(d);g=we(N,k),N.forEach(u),O.forEach(u),_=w(E),m=h(E,"ION-ICON",{icon:!0,slot:!0}),v(m).forEach(u),E.forEach(u),this.h()},h(){b(t,"icon",Ct),b(t,"slot","start"),b(i,"class","ion-text-wrap"),b(m,"icon",Je),b(m,"slot","end"),b(e,"href","https://www.google.com/maps/searhc/?api=1&query="+l[10].line2)},m(p,E){V(p,e,E),r(e,t),r(e,n),r(e,i),r(i,o),r(i,a),r(i,d),r(d,g),r(e,_),r(e,m)},p:Ce,d(p){p&&u(e)}}}function Mi(l){let e,t,n,i,o,s="Domicilio",a,d,k=l[10].line1+"",g,_,m,p,E=l[10].line2&&l[10].line2.trim().length,O,N=E&&Si(l);return{c(){e=f("ion-item"),t=f("ion-icon"),n=y(),i=f("ion-label"),o=f("p"),o.textContent=s,a=y(),d=f("h2"),g=ye(k),_=y(),m=f("ion-icon"),p=y(),N&&N.c(),O=xe(),this.h()},l(D){e=h(D,"ION-ITEM",{href:!0});var P=v(e);t=h(P,"ION-ICON",{icon:!0,slot:!0}),v(t).forEach(u),n=w(P),i=h(P,"ION-LABEL",{class:!0});var U=v(i);o=h(U,"P",{"data-svelte-h":!0}),ne(o)!=="svelte-cbm7q1"&&(o.textContent=s),a=w(U),d=h(U,"H2",{});var x=v(d);g=we(x,k),x.forEach(u),U.forEach(u),_=w(P),m=h(P,"ION-ICON",{icon:!0,slot:!0}),v(m).forEach(u),P.forEach(u),p=w(D),N&&N.l(D),O=xe(),this.h()},h(){b(t,"icon",Ct),b(t,"slot","start"),b(i,"class","ion-text-wrap"),b(m,"icon",Je),b(m,"slot","end"),b(e,"href","https://www.google.com/maps/search/?api=1&query="+l[10].line1)},m(D,P){V(D,e,P),r(e,t),r(e,n),r(e,i),r(i,o),r(i,a),r(i,d),r(d,g),r(e,_),r(e,m),V(D,p,P),N&&N.m(D,P),V(D,O,P)},p(D,P){E&&N.p(D,P)},d(D){D&&(u(e),u(p),u(O)),N&&N.d(D)}}}function Si(l){let e,t,n,i,o,s="Domicilio Alternativo",a,d,k=l[10].line2+"",g,_,m;return{c(){e=f("ion-item"),t=f("ion-icon"),n=y(),i=f("ion-label"),o=f("p"),o.textContent=s,a=y(),d=f("h2"),g=ye(k),_=y(),m=f("ion-icon"),this.h()},l(p){e=h(p,"ION-ITEM",{href:!0});var E=v(e);t=h(E,"ION-ICON",{icon:!0,slot:!0}),v(t).forEach(u),n=w(E),i=h(E,"ION-LABEL",{class:!0});var O=v(i);o=h(O,"P",{"data-svelte-h":!0}),ne(o)!=="svelte-1ub9uzw"&&(o.textContent=s),a=w(O),d=h(O,"H2",{});var N=v(d);g=we(N,k),N.forEach(u),O.forEach(u),_=w(E),m=h(E,"ION-ICON",{icon:!0,slot:!0}),v(m).forEach(u),E.forEach(u),this.h()},h(){b(t,"icon",Ct),b(t,"slot","start"),b(i,"class","ion-text-wrap"),b(m,"icon",Je),b(m,"slot","end"),b(e,"href","https://www.google.com/maps/search/?api=1&query="+l[10].line2)},m(p,E){V(p,e,E),r(e,t),r(e,n),r(e,i),r(i,o),r(i,a),r(i,d),r(d,g),r(e,_),r(e,m)},p:Ce,d(p){p&&u(e)}}}function Pi(l){let e,t,n,i,o,s="Contacto del Cliente",a,d,k,g,_=l[15]&&l[15]==="1"&&Ai(l);return{c(){e=f("ion-item"),t=f("ion-icon"),n=y(),i=f("ion-label"),o=f("p"),o.textContent=s,a=y(),d=f("h2"),k=ye(l[17]),g=y(),_&&_.c(),this.h()},l(m){e=h(m,"ION-ITEM",{});var p=v(e);t=h(p,"ION-ICON",{icon:!0,slot:!0}),v(t).forEach(u),n=w(p),i=h(p,"ION-LABEL",{class:!0});var E=v(i);o=h(E,"P",{"data-svelte-h":!0}),ne(o)!=="svelte-1utsyb6"&&(o.textContent=s),a=w(E),d=h(E,"H2",{});var O=v(d);k=we(O,l[17]),O.forEach(u),E.forEach(u),g=w(p),_&&_.l(p),p.forEach(u),this.h()},h(){b(t,"icon",Rn),b(t,"slot","start"),b(i,"class","ion-text-wrap")},m(m,p){V(m,e,p),r(e,t),r(e,n),r(e,i),r(i,o),r(i,a),r(i,d),r(d,k),r(e,g),_&&_.m(e,null)},p(m,p){m[15]&&m[15]==="1"&&_.p(m,p)},d(m){m&&u(e),_&&_.d()}}}function Ai(l){let e,t=`<ion-icon icon="${qn}" slot="start"></ion-icon>
                        Notificar Cliente`,n,i;return{c(){e=f("ion-button"),e.innerHTML=t,this.h()},l(o){e=h(o,"ION-BUTTON",{fill:!0,style:!0,"data-svelte-h":!0}),ne(e)!=="svelte-149vhpt"&&(e.innerHTML=t),this.h()},h(){b(e,"fill","outline"),c(e,"margin-left","16px")},m(o,s){V(o,e,s),n||(i=fe(e,"click",l[25]),n=!0)},p:Ce,d(o){o&&u(e),n=!1,i()}}}function Di(l){let e,t,n,i,o,s="Notas de ubicación",a,d,k;return{c(){e=f("ion-item"),t=f("ion-icon"),n=y(),i=f("ion-label"),o=f("p"),o.textContent=s,a=y(),d=f("h2"),k=ye(l[18]),this.h()},l(g){e=h(g,"ION-ITEM",{});var _=v(e);t=h(_,"ION-ICON",{icon:!0,slot:!0}),v(t).forEach(u),n=w(_),i=h(_,"ION-LABEL",{class:!0});var m=v(i);o=h(m,"P",{"data-svelte-h":!0}),ne(o)!=="svelte-nhm2ft"&&(o.textContent=s),a=w(m),d=h(m,"H2",{});var p=v(d);k=we(p,l[18]),p.forEach(u),m.forEach(u),_.forEach(u),this.h()},h(){b(t,"icon",wn),b(t,"slot","start"),b(i,"class","ion-text-wrap")},m(g,_){V(g,e,_),r(e,t),r(e,n),r(e,i),r(i,o),r(i,a),r(i,d),r(d,k)},p:Ce,d(g){g&&u(e)}}}function xi(l){let e,t,n,i,o,s="Horarios",a,d,k=l[10].schedule+"",g;return{c(){e=f("ion-item"),t=f("ion-icon"),n=y(),i=f("ion-label"),o=f("p"),o.textContent=s,a=y(),d=f("h2"),g=ye(k),this.h()},l(_){e=h(_,"ION-ITEM",{});var m=v(e);t=h(m,"ION-ICON",{icon:!0,slot:!0}),v(t).forEach(u),n=w(m),i=h(m,"ION-LABEL",{});var p=v(i);o=h(p,"P",{"data-svelte-h":!0}),ne(o)!=="svelte-11q7hm5"&&(o.textContent=s),a=w(p),d=h(p,"H2",{});var E=v(d);g=we(E,k),E.forEach(u),p.forEach(u),m.forEach(u),this.h()},h(){b(t,"icon",zn),b(t,"slot","start")},m(_,m){V(_,e,m),r(e,t),r(e,n),r(e,i),r(i,o),r(i,a),r(i,d),r(d,g)},p:Ce,d(_){_&&u(e)}}}function Bi(l){let e,t,n,i,o,s="Notas del operador",a,d,k=l[10].driver_comments+"",g;return{c(){e=f("ion-item"),t=f("ion-icon"),n=y(),i=f("ion-label"),o=f("p"),o.textContent=s,a=y(),d=f("h2"),g=ye(k),this.h()},l(_){e=h(_,"ION-ITEM",{});var m=v(e);t=h(m,"ION-ICON",{icon:!0,slot:!0}),v(t).forEach(u),n=w(m),i=h(m,"ION-LABEL",{});var p=v(i);o=h(p,"P",{"data-svelte-h":!0}),ne(o)!=="svelte-1yk9qp4"&&(o.textContent=s),a=w(p),d=h(p,"H2",{});var E=v(d);g=we(E,k),E.forEach(u),p.forEach(u),m.forEach(u),this.h()},h(){b(t,"icon",Nn),b(t,"slot","start")},m(_,m){V(_,e,m),r(e,t),r(e,n),r(e,i),r(i,o),r(i,a),r(i,d),r(d,g)},p:Ce,d(_){_&&u(e)}}}function Ui(l){let e,t=l[10].logistic_comments!="<br>"&&Hi(l);return{c(){t&&t.c(),e=xe()},l(n){t&&t.l(n),e=xe()},m(n,i){t&&t.m(n,i),V(n,e,i)},p(n,i){n[10].logistic_comments!="<br>"&&t.p(n,i)},d(n){n&&u(e),t&&t.d(n)}}}function Hi(l){let e,t,n,i,o,s="Comentarios logísticos",a,d,k=l[10].logistic_comments+"",g;return{c(){e=f("ion-item"),t=f("ion-icon"),n=y(),i=f("ion-label"),o=f("p"),o.textContent=s,a=y(),d=f("h2"),g=ye(k),this.h()},l(_){e=h(_,"ION-ITEM",{});var m=v(e);t=h(m,"ION-ICON",{icon:!0,slot:!0}),v(t).forEach(u),n=w(m),i=h(m,"ION-LABEL",{class:!0});var p=v(i);o=h(p,"P",{"data-svelte-h":!0}),ne(o)!=="svelte-1iz85r6"&&(o.textContent=s),a=w(p),d=h(p,"H2",{});var E=v(d);g=we(E,k),E.forEach(u),p.forEach(u),m.forEach(u),this.h()},h(){b(t,"icon",wn),b(t,"slot","start"),b(i,"class","ion-text-wrap")},m(_,m){V(_,e,m),r(e,t),r(e,n),r(e,i),r(i,o),r(i,a),r(i,d),r(d,g)},p:Ce,d(_){_&&u(e)}}}function Ri(l){let e,t,n,i,o="<p>Etiqueta</p>",s,a,d=(l[10].tag?l[10].tag:"")+"",k;return{c(){e=f("ion-item"),t=f("ion-icon"),n=y(),i=f("ion-label"),i.innerHTML=o,s=y(),a=f("div"),k=ye(d),this.h()},l(g){e=h(g,"ION-ITEM",{});var _=v(e);t=h(_,"ION-ICON",{icon:!0,slot:!0}),v(t).forEach(u),n=w(_),i=h(_,"ION-LABEL",{class:!0,"data-svelte-h":!0}),ne(i)!=="svelte-50rr6d"&&(i.innerHTML=o),s=w(_),a=h(_,"DIV",{class:!0,style:!0});var m=v(a);k=we(m,d),m.forEach(u),_.forEach(u),this.h()},h(){b(t,"icon",Vn),b(t,"slot","start"),b(i,"class","ion-text-wrap"),R(a,"class","stop-tag"),c(a,"background-color",l[19]),c(a,"border","1px solid "+l[20]),c(a,"color",l[10].tag_color),c(a,"font-size","14px"),c(a,"text-align","center"),c(a,"align-content","center"),c(a,"border-radius","20px"),c(a,"white-space","normal"),c(a,"padding","4px 8px"),c(a,"width","auto",1),c(a,"display","inline-block")},m(g,_){V(g,e,_),r(e,t),r(e,n),r(e,i),r(e,s),r(e,a),r(a,k)},p:Ce,d(g){g&&u(e)}}}function zi(l){let e,t,n,i,o="<p>Estado de entrega</p>",s,a,d,k="Entregado",g,_,m="No Entregado",p,E,O="Entrega Parcial",N,D,P,U,x,z="<p>Notas</p>",W,C,B,S,I=!l[13]&&Vi(l);return{c(){e=f("ion-item"),t=f("ion-icon"),n=y(),i=f("ion-label"),i.innerHTML=o,s=y(),a=f("ion-select"),d=f("ion-select-option"),d.textContent=k,g=y(),_=f("ion-select-option"),_.textContent=m,p=y(),E=f("ion-select-option"),E.textContent=O,N=y(),D=f("ion-item"),P=f("ion-icon"),U=y(),x=f("ion-label"),x.innerHTML=z,W=y(),C=f("ion-textarea"),B=y(),I&&I.c(),S=xe(),this.h()},l(T){e=h(T,"ION-ITEM",{});var M=v(e);t=h(M,"ION-ICON",{icon:!0,slot:!0}),v(t).forEach(u),n=w(M),i=h(M,"ION-LABEL",{class:!0,"data-svelte-h":!0}),ne(i)!=="svelte-1ql9csq"&&(i.innerHTML=o),s=w(M),a=h(M,"ION-SELECT",{value:!0,disabled:!0});var A=v(a);d=h(A,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),ne(d)!=="svelte-1nhq8vd"&&(d.textContent=k),g=w(A),_=h(A,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),ne(_)!=="svelte-dhd4r3"&&(_.textContent=m),p=w(A),E=h(A,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),ne(E)!=="svelte-17taxwo"&&(E.textContent=O),A.forEach(u),M.forEach(u),N=w(T),D=h(T,"ION-ITEM",{});var $=v(D);P=h($,"ION-ICON",{icon:!0,slot:!0}),v(P).forEach(u),U=w($),x=h($,"ION-LABEL",{class:!0,"data-svelte-h":!0}),ne(x)!=="svelte-c9yniu"&&(x.innerHTML=z),W=w($),C=h($,"ION-TEXTAREA",{placeholder:!0,readonly:!0,disabled:!0}),v(C).forEach(u),$.forEach(u),B=w(T),I&&I.l(T),S=xe(),this.h()},h(){b(t,"icon",Fn),b(t,"slot","start"),b(i,"class","ion-text-wrap"),b(d,"value","delivered"),b(_,"value","notdelivered"),b(E,"value","partialdeliver"),b(a,"value",l[14]?l[14]:"delivered"),b(a,"disabled",l[13]),b(P,"icon",ut),b(P,"slot","start"),b(x,"class","ion-text-wrap"),b(C,"placeholder","Escribe aquí..."),b(C,"readonly",l[13]),b(C,"disabled",l[13])},m(T,M){V(T,e,M),r(e,t),r(e,n),r(e,i),r(e,s),r(e,a),r(a,d),r(a,g),r(a,_),r(a,p),r(a,E),l[33](a),V(T,N,M),V(T,D,M),r(D,P),r(D,U),r(D,x),r(D,W),r(D,C),l[34](C),V(T,B,M),I&&I.m(T,M),V(T,S,M)},p(T,M){T[13]||I.p(T,M)},d(T){T&&(u(e),u(N),u(D),u(B),u(S)),l[33](null),l[34](null),I&&I.d(T)}}}function Vi(l){let e,t,n=l[5]===!0&&Ht(l),i=(l[6]===!0||l[6]===!1&&l[5]===!1)&&Rt(l);return{c(){e=f("section"),n&&n.c(),t=y(),i&&i.c(),this.h()},l(o){e=h(o,"SECTION",{style:!0});var s=v(e);n&&n.l(s),t=w(s),i&&i.l(s),s.forEach(u),this.h()},h(){c(e,"display","flex"),c(e,"gap","8px"),c(e,"padding","16px 16px 6px")},m(o,s){V(o,e,s),n&&n.m(e,null),r(e,t),i&&i.m(e,null)},p(o,s){o[5]===!0?n?n.p(o,s):(n=Ht(o),n.c(),n.m(e,t)):n&&(n.d(1),n=null),o[6]===!0||o[6]===!1&&o[5]===!1?i?i.p(o,s):(i=Rt(o),i.c(),i.m(e,null)):i&&(i.d(1),i=null)},d(o){o&&u(e),n&&n.d(),i&&i.d()}}}function Ht(l){let e,t=`<ion-icon icon="${jn}" slot="start"></ion-icon>
                        Ingreso`,n,i;return{c(){e=f("ion-button"),e.innerHTML=t,this.h()},l(o){e=h(o,"ION-BUTTON",{id:!0,style:!0,"data-svelte-h":!0}),ne(e)!=="svelte-izs0s1"&&(e.innerHTML=t),this.h()},h(){b(e,"id","checkInBtn"),c(e,"flex","1")},m(o,s){V(o,e,s),n||(i=fe(e,"click",l[26]),n=!0)},p:Ce,d(o){o&&u(e),n=!1,i()}}}function Rt(l){let e,t,n,i,o,s;return{c(){e=f("ion-button"),t=f("ion-icon"),n=ye(`\r
                        Salida`),this.h()},l(a){e=h(a,"ION-BUTTON",{id:!0,style:!0,disabled:!0});var d=v(e);t=h(d,"ION-ICON",{icon:!0,slot:!0}),v(t).forEach(u),n=we(d,`\r
                        Salida`),d.forEach(u),this.h()},h(){b(t,"icon",Wn),b(t,"slot","start"),b(e,"id","checkOutBtn"),c(e,"flex","1"),b(e,"disabled",i=l[6]===!1)},m(a,d){V(a,e,d),r(e,t),r(e,n),o||(s=fe(e,"click",l[27]),o=!0)},p(a,d){d[0]&64&&i!==(i=a[6]===!1)&&b(e,"disabled",i)},d(a){a&&u(e),o=!1,s()}}}function Fi(l){let e,t,n,i,o,s,a,d,k,g=l[16]==="1"&&Wi(l);return{c(){e=f("section"),t=f("ion-button"),n=f("label"),i=f("ion-icon"),o=ye(`\r
        Evidencia\r
        `),s=f("input"),a=y(),g&&g.c(),this.h()},l(_){e=h(_,"SECTION",{style:!0});var m=v(e);t=h(m,"ION-BUTTON",{fill:!0,class:!0,style:!0,disabled:!0});var p=v(t);n=h(p,"LABEL",{for:!0,style:!0});var E=v(n);i=h(E,"ION-ICON",{icon:!0,slot:!0,style:!0}),v(i).forEach(u),o=we(E,`\r
        Evidencia\r
        `),s=h(E,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0,capture:!0}),E.forEach(u),p.forEach(u),a=w(m),g&&g.l(m),m.forEach(u),this.h()},h(){b(i,"icon",Tt),b(i,"slot","start"),c(i,"vertical-align","middle"),c(s,"display","none"),R(s,"id","eventEvidence"),R(s,"name","fileToUpload"),R(s,"type","file"),s.multiple=!0,R(s,"accept","image/*"),R(s,"capture","environment"),s.disabled=l[21](),R(n,"for","eventEvidence"),c(n,"width","100%"),c(n,"height","100%"),c(n,"pointer-events",l[21]()?"none":"auto"),b(t,"fill","outline"),b(t,"class","loadEvidence"),c(t,"flex","1"),c(t,"display","flex"),c(t,"align-items","center"),c(t,"gap","8px"),b(t,"disabled",l[21]()),c(e,"display","flex"),c(e,"gap","8px"),c(e,"padding","0px 16px")},m(_,m){V(_,e,m),r(e,t),r(t,n),r(n,i),r(n,o),r(n,s),r(e,a),g&&g.m(e,null),d||(k=[fe(s,"change",l[22]),fe(s,"click",l[23])],d=!0)},p(_,m){_[16]==="1"&&g.p(_,m)},d(_){_&&u(e),g&&g.d(),d=!1,Re(k)}}}function Wi(l){let e,t,n,i,o;return{c(){e=f("ion-button"),t=f("ion-icon"),n=ye(`\r
        Firmar`),this.h()},l(s){e=h(s,"ION-BUTTON",{fill:!0,style:!0,disabled:!0});var a=v(e);t=h(a,"ION-ICON",{icon:!0,slot:!0}),v(t).forEach(u),n=we(a,`\r
        Firmar`),a.forEach(u),this.h()},h(){b(t,"icon",ut),b(t,"slot","start"),b(e,"fill","outline"),c(e,"flex","1"),c(e,"display","flex"),c(e,"align-items","center"),c(e,"gap","8px"),b(e,"disabled",l[21]())},m(s,a){V(s,e,a),r(e,t),r(e,n),i||(o=fe(e,"click",l[31]),i=!0)},p:Ce,d(s){s&&u(e),i=!1,o()}}}function zt(l){let e,t,n=We(l[3]),i=[];for(let o=0;o<n.length;o+=1)i[o]=Vt(Ut(l,n,o));return{c(){e=f("section"),t=f("div");for(let o=0;o<i.length;o+=1)i[o].c();this.h()},l(o){e=h(o,"SECTION",{});var s=v(e);t=h(s,"DIV",{class:!0,style:!0});var a=v(t);for(let d=0;d<i.length;d+=1)i[d].l(a);a.forEach(u),s.forEach(u),this.h()},h(){R(t,"class","image-grid"),c(t,"display","grid"),c(t,"grid-template-columns","repeat(auto-fill, minmax(100px, 1fr))"),c(t,"gap","10px"),c(t,"padding","0px 10px")},m(o,s){V(o,e,s),r(e,t);for(let a=0;a<i.length;a+=1)i[a]&&i[a].m(t,null)},p(o,s){if(s[0]&1342186504){n=We(o[3]);let a;for(a=0;a<n.length;a+=1){const d=Ut(o,n,a);i[a]?i[a].p(d,s):(i[a]=Vt(d),i[a].c(),i[a].m(t,null))}for(;a<i.length;a+=1)i[a].d(1);i.length=n.length}},d(o){o&&u(e),gt(i,o)}}}function qi(l){let e,t=`<ion-icon icon="${Mt}"></ion-icon>`,n,i;function o(){return l[36](l[62])}return{c(){e=f("button"),e.innerHTML=t,this.h()},l(s){e=h(s,"BUTTON",{class:!0,style:!0,"data-svelte-h":!0}),ne(e)!=="svelte-mf38w5"&&(e.innerHTML=t),this.h()},h(){R(e,"class","remove-button"),c(e,"position","absolute"),c(e,"top","5px"),c(e,"right","5px"),c(e,"border","none"),c(e,"cursor","pointer"),c(e,"font-size","18px"),c(e,"background","white"),c(e,"border-radius","50%"),c(e,"padding","3px 4px 0px"),c(e,"box-shadow","2px 2px 6px rgba(0, 0, 0, 0.3)"),c(e,"color","#0000008f")},m(s,a){V(s,e,a),n||(i=fe(e,"click",o),n=!0)},p(s,a){l=s},d(s){s&&u(e),n=!1,i()}}}function Vt(l){let e,t,n,i,o,s,a;function d(){return l[35](l[60])}let k=l[10].status!=="completed"&&!l[13]&&qi(l);return{c(){e=f("div"),t=f("ion-img"),i=y(),k&&k.c(),o=y(),this.h()},l(g){e=h(g,"DIV",{class:!0,style:!0});var _=v(e);t=h(_,"ION-IMG",{src:!0,alt:!0,style:!0}),v(t).forEach(u),i=w(_),k&&k.l(_),o=w(_),_.forEach(u),this.h()},h(){Xe(t.src,n=l[60])||b(t,"src",n),b(t,"alt","Evidencia fotográfica"),c(t,"width","100%"),c(t,"height","100px"),c(t,"object-fit","cover"),c(t,"cursor","pointer"),c(t,"border","1px solid #ccc"),c(t,"border-radius","4px"),c(t,"margin-top","16px"),R(e,"class","image-container"),c(e,"position","relative")},m(g,_){V(g,e,_),r(e,t),r(e,i),k&&k.m(e,null),r(e,o),s||(a=fe(t,"click",d),s=!0)},p(g,_){l=g,_[0]&8&&!Xe(t.src,n=l[60])&&b(t,"src",n),l[10].status!=="completed"&&!l[13]&&k.p(l,_)},d(g){g&&u(e),k&&k.d(),s=!1,a()}}}function Ft(l){let e,t='<ion-spinner name="dots" style="color:white;"></ion-spinner>';return{c(){e=f("div"),e.innerHTML=t,this.h()},l(n){e=h(n,"DIV",{class:!0,style:!0,"data-svelte-h":!0}),ne(e)!=="svelte-1aosxw0"&&(e.innerHTML=t),this.h()},h(){R(e,"class","overlay"),c(e,"position","fixed"),c(e,"top","0"),c(e,"left","0"),c(e,"width","100vw"),c(e,"height","100vh"),c(e,"background","rgba(0, 0, 0, 0.5)"),c(e,"display","flex"),c(e,"align-items","center"),c(e,"justify-content","center"),c(e,"z-index","9999")},m(n,i){V(n,e,i)},d(n){n&&u(e)}}}function Wt(l){let e,t,n,i,o,s,a=`<ion-icon icon="${Lt}"></ion-icon>`,d,k;return{c(){e=f("div"),t=f("div"),n=f("ion-img"),o=y(),s=f("button"),s.innerHTML=a,this.h()},l(g){e=h(g,"DIV",{class:!0,style:!0});var _=v(e);t=h(_,"DIV",{class:!0,style:!0});var m=v(t);n=h(m,"ION-IMG",{src:!0,alt:!0,style:!0}),v(n).forEach(u),o=w(m),s=h(m,"BUTTON",{class:!0,style:!0,"data-svelte-h":!0}),ne(s)!=="svelte-183t4ti"&&(s.innerHTML=a),m.forEach(u),_.forEach(u),this.h()},h(){Xe(n.src,i=l[8])||b(n,"src",i),b(n,"alt","Evidencia fotográfica"),c(n,"width","100%"),c(n,"height","auto"),R(s,"class","close-button"),c(s,"position","absolute"),c(s,"top","5px"),c(s,"right","5px"),c(s,"background","white"),c(s,"color","#444444d1"),c(s,"border","none"),c(s,"cursor","pointer"),c(s,"padding","2px 2px 0px 6px"),c(s,"border-radius","50%"),c(s,"font-size","20px"),R(t,"class","modal-content"),c(t,"position","relative"),c(t,"background","white"),c(t,"padding","20px"),c(t,"border-radius","8px"),c(t,"max-width","90vw"),c(t,"max-height","90vh"),c(t,"overflow","auto"),R(e,"class","modal-overlay"),c(e,"position","fixed"),c(e,"top","0"),c(e,"left","0"),c(e,"width","100vw"),c(e,"height","100vh"),c(e,"background","rgba(0, 0, 0, 0.8)"),c(e,"display","flex"),c(e,"justify-content","center"),c(e,"align-items","center"),c(e,"z-index","1000")},m(g,_){V(g,e,_),r(e,t),r(t,n),r(t,o),r(t,s),d||(k=[fe(s,"click",l[29]),fe(t,"click",wt(l[32])),fe(e,"click",l[29])],d=!0)},p(g,_){_[0]&256&&!Xe(n.src,i=g[8])&&b(n,"src",i)},d(g){g&&u(e),d=!1,Re(k)}}}function ji(l){let e,t,n,i,o="Cerrar",s,a,d=l[10].title+"",k,g,_,m,p,E,O=l[10].client_phone&&l[10].client_phone.trim().length,N,D,P,U,x=l[10].schedule&&l[10].schedule.trim().length,z,W,C=l[10].logistic_comments&&l[10].logistic_comments.trim().length,B,S,I,T,M,A,$,le,de,ie=(!l[11]&&!l[12]||l[11]&&l[12])&&wi(l);function me(K,ve){return K[10].client_name!=null?Ti:Ni}let oe=me(l)(l),re=O&&Ci(l);function be(K,ve){if(K[10].line1&&K[10].line1.trim().length)return Mi;if(K[10].line2&&K[10].line2.trim().length)return Li}let se=be(l),X=se&&se(l),ge=l[17]&&Pi(l),_e=l[18]&&l[18]!=="<br>"&&Di(l),ae=x&&xi(l),ee=l[10].driver_comments&&Bi(l),Ie=C&&Ui(l),ke=l[10].tag&&l[10].tag_color&&Ri(l),Oe=!l[12]&&zi(l),Z=(l[11]&&l[12]||!l[11]&&!l[12])&&Fi(l),J=l[2]&&zt(l),G=l[4]&&Ft(),ue=l[7]&&Wt(l);return{c(){e=f("ion-header"),t=f("ion-toolbar"),n=f("ion-buttons"),i=f("ion-button"),i.textContent=o,s=y(),a=f("ion-title"),k=ye(d),g=y(),ie&&ie.c(),_=y(),m=f("ion-content"),p=f("ion-list"),oe.c(),E=y(),re&&re.c(),N=y(),X&&X.c(),D=y(),ge&&ge.c(),P=y(),_e&&_e.c(),U=y(),ae&&ae.c(),z=y(),ee&&ee.c(),W=y(),Ie&&Ie.c(),B=y(),ke&&ke.c(),S=y(),Oe&&Oe.c(),I=y(),Z&&Z.c(),T=y(),J&&J.c(),M=y(),G&&G.c(),A=y(),ue&&ue.c(),$=xe(),this.h()},l(K){e=h(K,"ION-HEADER",{translucent:!0});var ve=v(e);t=h(ve,"ION-TOOLBAR",{});var Me=v(t);n=h(Me,"ION-BUTTONS",{slot:!0});var De=v(n);i=h(De,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),ne(i)!=="svelte-2ks32x"&&(i.textContent=o),De.forEach(u),s=w(Me),a=h(Me,"ION-TITLE",{style:!0,title:!0});var Se=v(a);k=we(Se,d),Se.forEach(u),g=w(Me),ie&&ie.l(Me),Me.forEach(u),ve.forEach(u),_=w(K),m=h(K,"ION-CONTENT",{fullscreen:!0});var Le=v(m);p=h(Le,"ION-LIST",{});var q=v(p);oe.l(q),E=w(q),re&&re.l(q),N=w(q),X&&X.l(q),D=w(q),ge&&ge.l(q),P=w(q),_e&&_e.l(q),U=w(q),ae&&ae.l(q),z=w(q),ee&&ee.l(q),W=w(q),Ie&&Ie.l(q),B=w(q),ke&&ke.l(q),S=w(q),Oe&&Oe.l(q),I=w(q),Z&&Z.l(q),T=w(q),J&&J.l(q),q.forEach(u),Le.forEach(u),M=w(K),G&&G.l(K),A=w(K),ue&&ue.l(K),$=xe(),this.h()},h(){b(i,"color","medium"),b(n,"slot","start"),c(a,"text-align","center"),b(a,"title",l[10].title),b(e,"translucent",""),b(m,"fullscreen","")},m(K,ve){V(K,e,ve),r(e,t),r(t,n),r(n,i),r(t,s),r(t,a),r(a,k),r(t,g),ie&&ie.m(t,null),V(K,_,ve),V(K,m,ve),r(m,p),oe.m(p,null),r(p,E),re&&re.m(p,null),r(p,N),X&&X.m(p,null),r(p,D),ge&&ge.m(p,null),r(p,P),_e&&_e.m(p,null),r(p,U),ae&&ae.m(p,null),r(p,z),ee&&ee.m(p,null),r(p,W),Ie&&Ie.m(p,null),r(p,B),ke&&ke.m(p,null),r(p,S),Oe&&Oe.m(p,null),r(p,I),Z&&Z.m(p,null),r(p,T),J&&J.m(p,null),V(K,M,ve),G&&G.m(K,ve),V(K,A,ve),ue&&ue.m(K,ve),V(K,$,ve),le||(de=fe(i,"click",l[0]),le=!0)},p(K,ve){(!K[11]&&!K[12]||K[11]&&K[12])&&ie.p(K,ve),oe.p(K,ve),O&&re.p(K,ve),X&&X.p(K,ve),K[17]&&ge.p(K,ve),K[18]&&K[18]!=="<br>"&&_e.p(K,ve),x&&ae.p(K,ve),K[10].driver_comments&&ee.p(K,ve),C&&Ie.p(K,ve),K[10].tag&&K[10].tag_color&&ke.p(K,ve),K[12]||Oe.p(K,ve),(K[11]&&K[12]||!K[11]&&!K[12])&&Z.p(K,ve),K[2]?J?J.p(K,ve):(J=zt(K),J.c(),J.m(p,null)):J&&(J.d(1),J=null),K[4]?G||(G=Ft(),G.c(),G.m(A.parentNode,A)):G&&(G.d(1),G=null),K[7]?ue?ue.p(K,ve):(ue=Wt(K),ue.c(),ue.m($.parentNode,$)):ue&&(ue.d(1),ue=null)},i:Ce,o:Ce,d(K){K&&(u(e),u(_),u(m),u(M),u(A),u($)),ie&&ie.d(),oe.d(),re&&re.d(),X&&X.d(),ge&&ge.d(),_e&&_e.d(),ae&&ae.d(),ee&&ee.d(),Ie&&Ie.d(),ke&&ke.d(),Oe&&Oe.d(),Z&&Z.d(),J&&J.d(),G&&G.d(K),ue&&ue.d(K),le=!1,de()}}}function Gi(l){const[e,t]=l.split(","),n=e.match(/:(.*?);/)[1],i=atob(t),o=i.length,s=new Uint8Array(o);for(let a=0;a<o;a++)s[a]=i.charCodeAt(a);return new Blob([s],{type:n})}function Ki(l,e,t){let n=ht,i=document.querySelector("ion-modal"),o=i.componentProps.delivery,s=i.componentProps.isLast||!1,a=i.componentProps.flag||!1,d=!!i.componentProps.readOnly,k=o.driver_comments?o.driver_comments:"",g=o.deliver_status?o.deliver_status:"",_=o.img?o.img:"",m=o.img_id?o.img_id:"",p=_?Ze(_):new Array,E=m?Ze(m):new Array,O={latitude:null,longitude:null},N=o.stopsApproval,D=o.smsActive,P=o.signatureActive,U=!1,x=!0,z=!1,W=o.phone_notification,C=o.comments_ext,B=!1,S="",I=new Object,T="",M=o.tag_color?Ge(o.tag_color,.2):"",A=o.tag_color?Ge(o.tag_color,.3):"",$=!1;const le=()=>d||o.status=="completed";ot(()=>{I=JSON.parse(localStorage.getItem("userSession")),de()});function de(){o.date_service?o.date_service&&!o.date_completed&&!o.service_time?(t(5,x=!1),t(6,z=!0)):o.date_service&&o.date_completed&&o.service_time&&(t(5,x=!1),t(6,z=!1)):(t(5,x=!0),t(6,z=!1))}const ie=async(H,j)=>{await(await Qe.create({header:H||"Error",message:j||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()},me=async(H="",j="",Y="",Q=function(F={}){},Ee={})=>{await(await Qe.create({header:H||"Error",message:j||"Vuelva a intentar",buttons:[{text:"No",role:"cancel",handler:()=>{}},{text:"Sí",handler:()=>{t(4,U=!0),Ke(Y,function(ce={}){t(4,U=!1),Q(ce)},Ee)}}]})).present()};async function L(H,j){await(await Qe.create({header:"¿Cómo quieres notificar?",message:`Elige el medio para enviar mensaje a ${H.title} (${j})`,buttons:[{text:"SMS",handler:()=>ee("sms",H,j)},{text:"WhatsApp",handler:()=>ee("whatsapp",H,j)}]})).present()}const oe=async H=>{if(d){ie("Solo lectura","Completa los requisitos para editar.");return}if(p.length>=5){ie("Límite de evidencias","Solo se permite subir 5 fotos por parada");return}if(a&&s&&p.length>=1){ie("Límite de evidencias","Para el final de la ruta solo se permite subir 1 foto");return}const Y=H.target.files[0];if(Y)try{t(4,U=!0);const Q=await se(Y);Q&&Ke(`${n}api/admin/manager/upload_img_driver.php`,function(Ee){Ee.success?(t(2,_=_?`${_},${Ee.img}`:Ee.img),m=m?`${m},${Ee.img_id}`:Ee.img_id,t(3,p=Ze(_)),E=Ze(m)):ie("Carga fallida","Actualiza la página y vuelve a intentar. Si el problema persiste, contacta a soporte.")},{fileToUpload:Q})}catch(Q){console.error("Compression error:",Q)}finally{t(4,U=!1)}};function re(H){var Y;if(d){(Y=H==null?void 0:H.preventDefault)==null||Y.call(H),ie("Solo lectura","Completa los requisitos para editar.");return}var j=o.service_time;!j&&x&&!s&&!a&&(H.preventDefault(),ie("Registrar Ingreso","Antes de subir la evidencia registra el ingreso a la actual parada."))}function be(){if(d){ie("Solo lectura","Completa los requisitos para editar.");return}var H=a?o.date_completed:!1;if(!H&&!x&&z&&!s&&!a){var j=new Object;j.id_event=o.id_event,j.type="checkout",j.id_user_over=I.id_user,j.token=I.token,me("Registrar Salida","¿Completaste tu entrega?",n+"api/admin/route/record_check_date.php",function(Y){Y.minutes&&ie("Tiempo por parada","Completaste la parada en "+Y.minutes+" minutos.")},j)}}const se=async H=>new Promise(j=>{const Y=new Image;Y.src=URL.createObjectURL(H),Y.onload=()=>{const Q=document.createElement("canvas"),Ee=Q.getContext("2d"),F=800,ce=600;let te=Y.width,pe=Y.height;te>F&&(pe*=F/te,te=F),pe>ce&&(te*=ce/pe,pe=ce),Q.width=te,Q.height=pe,Ee.drawImage(Y,0,0,te,pe),Q.toBlob(Ne=>{j(Ne),URL.revokeObjectURL(Y.src),Ee.clearRect(0,0,Q.width,Q.height)},"image/jpeg",.7)}});async function X(){try{if(i!=null&&i.isConnected){await i.dismiss({data:Date.now()});return}const H=await $e.getTop();H&&await H.dismiss({data:Date.now()})}catch{console.warn("Close Modal Safe: modal ya cerrado o inexistente")}}const ge=async()=>{if(d){ie("Solo lectura","Completa los requisitos para confirmar.");return}if(!U){t(4,U=!0);try{if(t(2,_=p.join(",")),m=E.join(","),be(),await ae())if(T.value=="delivered"||T.value!=="delivered"&&(k.value||o.driver_comments)||a&&s){const j={id_route:o.id_route,...!a&&!s&&{id_event:o.id_event},...!a&&!s&&{comments:k.value},...!a&&!s&&{deliver_status:T.value},img:_,img_id:m,lat:O.latitude,lon:O.longitude,...N==="0"&&{approve:"0"},...s&&{isLast:!0},...a&&s&&{destiny:!0},id_user_over:I.id_user,token:I.token};j.img&&j.img_id||_?Ke(`${n}api/admin/evidence/send_evidence.php`,function(Y){if(Y.success==!0){X();const Q=j.id_route;s&&(_e("","",Q,s),N=="0"&&K(Q,"completed"))}else t(4,U=!1),ie("Carga fallida","Actualiza la página y vuelve a intentar cargar la información!")},j):ie("Información incompleta","Cargar evidencia fotográfica faltante para completar parada.")}else ie("Motivo de status de entrega","Favor de ingresar en notas el motivo por el que la entrega no fue entregada correctamente");else ie("Ubicación faltante","Asegúrate darle permisos a Rutaflow para acceder a tu ubicación")}catch(H){console.error("Error fetching data:",H)}finally{t(4,U=!1)}}},_e=(H,j,Y,Q)=>{i.componentProps.routeId=Y,i.componentProps.driverId=o.id_driver,Ye("modal-km-gas",Mn,{checklist:H,driverId:j,routeId:Y,isLast:Q}).then(Ee=>{})},ae=async()=>navigator.geolocation?new Promise((H,j)=>{navigator.geolocation.getCurrentPosition(Y=>{O.latitude=Y.coords.latitude,O.longitude=Y.coords.longitude,H(!0)},Y=>{console.error("Error getting location:",Y),H(!1)})}):(console.error("Geolocation is not supported by your browser"),!1);async function ee(H,j,Y){const Q={};if(H==="sms"){Q.id_user_over=I.id_user,Q.token=I.token,Q.client_phone=Y,Q.client_name=j.title,Q.delivery_phone=j.client_phone,Q.enterprise_name=j.enterprise_name,Ke(`${n}api/admin/message_central/send_sms.php`,Ie("SMS",j.title,Y),Q);return}try{var Ee=j.client_phone?`
Si deseas contactarnos, entra al siguiente link: https://wa.me/${j.client_phone}.`:".";Q.text=`*Rutaflow*

El repartidor va en camino a tu domicilio ${j.title}${Ee}

Enviado por _${j.enterprise_name}_`,Q.phone=Y;const ce=await(await fetch(`${$n}`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`${ei}`},body:JSON.stringify(Q)})).json();Ie("WHATSAPP",j.title,Y)(ce)}catch(F){console.error(F),ie("WHATSAPP no enviado","Ocurrió un error de red.")}}function Ie(H,j,Y){return Q=>{Q.success?ie(`${H} enviado`,`Se envió correctamente un ${H} a ${j} con número ${Y}.`):ie(`${H} no enviado`,`Hubo un error al enviar ${H} a ${j} (${Y}).`)}}function ke(H){H.stopPropagation(),L(o,W)}function Oe(){if(d){ie("Solo lectura","Completa los requisitos para editar.");return}t(5,x=!1),t(6,z=!0),J(o.id_event,"checkin")}function Z(){if(d){ie("Solo lectura","Completa los requisitos para editar.");return}t(6,z=!1),t(5,x=!1),J(o.id_event,"checkout")}async function J(H,j){if(!d&&j){let Y=new Object;Y.type=j,Y.id_event=H,Y.id_user_over=I.id_user,Y.token=I.token;try{Ke(`${n}api/admin/route/record_check_date.php`,function(Q){Q.minutes&&ie("Tiempo por parada","Completaste la parada en "+Q.minutes+" minutos.")},Y)}catch(Q){console.error("Error during file upload:",Q)}finally{}}}const G=H=>{t(8,S=H),t(7,B=!0)},ue=()=>{t(7,B=!1),t(8,S="")};function K(H,j){let Y=new Object;return Y.id_route=H,Y.status=j,Y.id_user_over=I.id_user,Y.token=I.token,Ke(`${n}api/admin/route/change_status.php`,function(){},Y),""}function ve(H=0){if(!d){var j=Tn(H,p,E,_);t(3,p=j.files),E=j.img_ids,t(2,_=j.selectedImages)}}async function Me(){var Y;if(d){ie("Solo lectura","Completa los requisitos para firmar.");return}const H=await Ye("modal-signature-plugin",yi,{},{breakpoints:[.25,.9],initialBreakpoint:.9,backdropBreakpoint:.25,handle:!0,handleBehavior:"cycle",canDismiss:!0,showBackdrop:!0}),j=((Y=H==null?void 0:H.data)==null?void 0:Y.dataUrl)??(H==null?void 0:H.dataUrl)??H;if(j)try{$=!0;const Q=Gi(j);Ke(`${n}api/admin/manager/upload_img_driver.php`,function(Ee){Ee.success?(t(2,_=_?`${_},${Ee.img}`:Ee.img),m=m?`${m},${Ee.img_id}`:Ee.img_id,t(3,p=Ze(_)),E=Ze(m)):ie("Carga fallida","Actualiza la página y vuelve a intentar. Si el problema persiste, contacta a soporte.")},{fileToUpload:Q})}catch(Q){console.error(Q)}finally{$=!1}}function De(H){Nt.call(this,l,H)}function Se(H){Be[H?"unshift":"push"](()=>{T=H,t(9,T)})}function Le(H){Be[H?"unshift":"push"](()=>{k=H,t(1,k)})}return[X,k,_,p,U,x,z,B,S,T,o,s,a,d,g,D,P,W,C,M,A,le,oe,re,ge,ke,Oe,Z,G,ue,ve,Me,De,Se,Le,H=>G(H),H=>ve(H)]}class qt extends tt{constructor(e){super(),nt(this,e,Ki,ji,et,{closeModal:0},null,[-1,-1,-1])}get closeModal(){return this.$$.ctx[0]}}function jt(l,e,t){const n=l.slice();return n[32]=e[t],n[34]=t,n}function Gt(l){let e,t,n=We(l[1]),i=[];for(let o=0;o<n.length;o+=1)i[o]=Kt(jt(l,n,o));return{c(){e=f("section"),t=f("div");for(let o=0;o<i.length;o+=1)i[o].c();this.h()},l(o){e=h(o,"SECTION",{});var s=v(e);t=h(s,"DIV",{class:!0,style:!0});var a=v(t);for(let d=0;d<i.length;d+=1)i[d].l(a);a.forEach(u),s.forEach(u),this.h()},h(){R(t,"class","image-grid"),c(t,"display","grid"),c(t,"grid-template-columns","repeat(auto-fill, minmax(100px, 1fr))"),c(t,"gap","10px"),c(t,"padding","0px 10px")},m(o,s){V(o,e,s),r(e,t);for(let a=0;a<i.length;a+=1)i[a]&&i[a].m(t,null)},p(o,s){if(s[0]&32770){n=We(o[1]);let a;for(a=0;a<n.length;a+=1){const d=jt(o,n,a);i[a]?i[a].p(d,s):(i[a]=Kt(d),i[a].c(),i[a].m(t,null))}for(;a<i.length;a+=1)i[a].d(1);i.length=n.length}},d(o){o&&u(e),gt(i,o)}}}function Kt(l){let e,t,n,i,o,s=`<ion-icon icon="${Mt}"></ion-icon>`,a,d,k;function g(){return l[22](l[32])}function _(){return l[23](l[34])}return{c(){e=f("div"),t=f("ion-img"),i=y(),o=f("button"),o.innerHTML=s,a=y(),this.h()},l(m){e=h(m,"DIV",{class:!0,style:!0});var p=v(e);t=h(p,"ION-IMG",{src:!0,alt:!0,style:!0}),v(t).forEach(u),i=w(p),o=h(p,"BUTTON",{class:!0,style:!0,"data-svelte-h":!0}),ne(o)!=="svelte-zguiov"&&(o.innerHTML=s),a=w(p),p.forEach(u),this.h()},h(){Xe(t.src,n=l[32])||b(t,"src",n),b(t,"alt","Evidencia fotográfica"),c(t,"width","100%"),c(t,"height","100px"),c(t,"object-fit","cover"),c(t,"cursor","pointer"),c(t,"border","1px solid #ccc"),c(t,"border-radius","4px"),c(t,"margin-top","16px"),R(o,"class","remove-button"),c(o,"position","absolute"),c(o,"top","5px"),c(o,"right","5px"),c(o,"border","none"),c(o,"cursor","pointer"),c(o,"font-size","18px"),c(o,"background","white"),c(o,"border-radius","50%"),c(o,"padding","3px 4px 0px"),c(o,"box-shadow","2px 2px 6px rgba(0, 0, 0, 0.3)"),c(o,"color","#0000008f"),R(e,"class","image-container"),c(e,"position","relative")},m(m,p){V(m,e,p),r(e,t),r(e,i),r(e,o),r(e,a),d||(k=[fe(t,"click",g),fe(o,"click",_)],d=!0)},p(m,p){l=m,p[0]&2&&!Xe(t.src,n=l[32])&&b(t,"src",n)},d(m){m&&u(e),d=!1,Re(k)}}}function Xt(l){let e,t='<ion-spinner name="dots" style="color:white;"></ion-spinner>';return{c(){e=f("div"),e.innerHTML=t,this.h()},l(n){e=h(n,"DIV",{class:!0,style:!0,"data-svelte-h":!0}),ne(e)!=="svelte-h8s7r2"&&(e.innerHTML=t),this.h()},h(){R(e,"class","overlay"),c(e,"position","fixed"),c(e,"top","0"),c(e,"left","0"),c(e,"width","100vw"),c(e,"height","100vh"),c(e,"background","rgba(0, 0, 0, 0.5)"),c(e,"display","flex"),c(e,"align-items","center"),c(e,"justify-content","center"),c(e,"z-index","9999")},m(n,i){V(n,e,i)},d(n){n&&u(e)}}}function Jt(l){let e,t,n,i,o,s,a=`<ion-icon icon="${Lt}"></ion-icon>`,d,k;return{c(){e=f("div"),t=f("div"),n=f("ion-img"),o=y(),s=f("button"),s.innerHTML=a,this.h()},l(g){e=h(g,"DIV",{class:!0,style:!0});var _=v(e);t=h(_,"DIV",{class:!0,style:!0});var m=v(t);n=h(m,"ION-IMG",{src:!0,alt:!0,style:!0}),v(n).forEach(u),o=w(m),s=h(m,"BUTTON",{class:!0,style:!0,"data-svelte-h":!0}),ne(s)!=="svelte-g0qr0o"&&(s.innerHTML=a),m.forEach(u),_.forEach(u),this.h()},h(){Xe(n.src,i=l[8])||b(n,"src",i),b(n,"alt","Evidencia fotográfica"),c(n,"width","100%"),c(n,"height","auto"),R(s,"class","close-button"),c(s,"position","absolute"),c(s,"top","5px"),c(s,"right","5px"),c(s,"background","white"),c(s,"color","#444444d1"),c(s,"border","none"),c(s,"cursor","pointer"),c(s,"padding","2px 2px 0px 6px"),c(s,"border-radius","50%"),c(s,"font-size","20px"),R(t,"class","modal-content"),c(t,"position","relative"),c(t,"background","white"),c(t,"padding","20px"),c(t,"border-radius","8px"),c(t,"max-width","90vw"),c(t,"max-height","90vh"),c(t,"overflow","auto"),R(e,"class","modal-overlay"),c(e,"position","fixed"),c(e,"top","0"),c(e,"left","0"),c(e,"width","100vw"),c(e,"height","100vh"),c(e,"background","rgba(0, 0, 0, 0.8)"),c(e,"display","flex"),c(e,"justify-content","center"),c(e,"align-items","center"),c(e,"z-index","1000")},m(g,_){V(g,e,_),r(e,t),r(t,n),r(t,o),r(t,s),d||(k=[fe(s,"click",l[16]),fe(t,"click",wt(l[17])),fe(e,"click",l[16])],d=!0)},p(g,_){_[0]&256&&!Xe(n.src,i=g[8])&&b(n,"src",i)},d(g){g&&u(e),d=!1,Re(k)}}}function Xi(l){let e,t,n,i,o="Cancelar",s,a,d="AGREGAR GASTO",k,g,_,m="Confirmar",p,E,O,N,D,P,U,x,z,W,C,B,S,I,T,M,A,$,le='Tipo de pago <ion-text color="danger">(Obligatorio)</ion-text>',de,ie,me="Efectivo",L,oe,re="Tarjeta",be,se,X="Transferencia",ge,_e,ae,ee,Ie,ke,Oe,Z,J,G,ue=`<ion-icon icon="${Tt}" slot="start"></ion-icon>
                        Subir Evidencia`,K,ve,Me,De,Se,Le,q,he,H=l[0]&&Gt(l),j=l[6]&&Xt(),Y=l[7]&&Jt(l);return{c(){e=f("ion-header"),t=f("ion-toolbar"),n=f("ion-buttons"),i=f("ion-button"),i.textContent=o,s=y(),a=f("ion-title"),a.textContent=d,k=y(),g=f("ion-buttons"),_=f("ion-button"),_.textContent=m,p=y(),E=f("ion-content"),O=f("ion-list"),N=f("ion-item"),D=f("ion-icon"),P=y(),U=f("ion-input"),x=y(),z=f("ion-item"),W=f("ion-icon"),C=y(),B=f("ion-input"),S=y(),I=f("ion-item"),T=f("ion-icon"),M=y(),A=f("ion-select"),$=f("div"),$.innerHTML=le,de=y(),ie=f("ion-select-option"),ie.textContent=me,L=y(),oe=f("ion-select-option"),oe.textContent=re,be=y(),se=f("ion-select-option"),se.textContent=X,ge=y(),_e=f("ion-item"),ae=f("ion-icon"),ee=y(),Ie=f("ion-textarea"),ke=y(),Oe=f("section"),Z=f("label"),J=f("ion-button"),G=f("label"),G.innerHTML=ue,K=y(),ve=f("input"),Me=y(),H&&H.c(),De=y(),j&&j.c(),Se=y(),Y&&Y.c(),Le=xe(),this.h()},l(Q){e=h(Q,"ION-HEADER",{translucent:!0});var Ee=v(e);t=h(Ee,"ION-TOOLBAR",{});var F=v(t);n=h(F,"ION-BUTTONS",{slot:!0});var ce=v(n);i=h(ce,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),ne(i)!=="svelte-1f8rjcf"&&(i.textContent=o),ce.forEach(u),s=w(F),a=h(F,"ION-TITLE",{title:!0,"data-svelte-h":!0}),ne(a)!=="svelte-efps2s"&&(a.textContent=d),k=w(F),g=h(F,"ION-BUTTONS",{slot:!0});var te=v(g);_=h(te,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),ne(_)!=="svelte-k5zoz0"&&(_.textContent=m),te.forEach(u),F.forEach(u),Ee.forEach(u),p=w(Q),E=h(Q,"ION-CONTENT",{fullscreen:!0});var pe=v(E);O=h(pe,"ION-LIST",{});var Ne=v(O);N=h(Ne,"ION-ITEM",{});var Pe=v(N);D=h(Pe,"ION-ICON",{icon:!0,slot:!0}),v(D).forEach(u),P=w(Pe),U=h(Pe,"ION-INPUT",{label:!0,type:!0,placeholder:!0,value:!0}),v(U).forEach(u),Pe.forEach(u),x=w(Ne),z=h(Ne,"ION-ITEM",{});var Te=v(z);W=h(Te,"ION-ICON",{icon:!0,slot:!0}),v(W).forEach(u),C=w(Te),B=h(Te,"ION-INPUT",{label:!0,type:!0,value:!0}),v(B).forEach(u),Te.forEach(u),S=w(Ne),I=h(Ne,"ION-ITEM",{});var ze=v(I);T=h(ze,"ION-ICON",{icon:!0,slot:!0}),v(T).forEach(u),M=w(ze),A=h(ze,"ION-SELECT",{placeholder:!0,value:!0});var Ve=v(A);$=h(Ve,"DIV",{slot:!0,"data-svelte-h":!0}),ne($)!=="svelte-wl764p"&&($.innerHTML=le),de=w(Ve),ie=h(Ve,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),ne(ie)!=="svelte-i9crym"&&(ie.textContent=me),L=w(Ve),oe=h(Ve,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),ne(oe)!=="svelte-fx0z11"&&(oe.textContent=re),be=w(Ve),se=h(Ve,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),ne(se)!=="svelte-1c24jf2"&&(se.textContent=X),Ve.forEach(u),ze.forEach(u),ge=w(Ne),_e=h(Ne,"ION-ITEM",{});var qe=v(_e);ae=h(qe,"ION-ICON",{icon:!0,slot:!0}),v(ae).forEach(u),ee=w(qe),Ie=h(qe,"ION-TEXTAREA",{label:!0,placeholder:!0}),v(Ie).forEach(u),qe.forEach(u),ke=w(Ne),Oe=h(Ne,"SECTION",{});var Fe=v(Oe);Z=h(Fe,"LABEL",{for:!0,style:!0});var je=v(Z);J=h(je,"ION-BUTTON",{fill:!0,size:!0,class:!0,expand:!0});var it=v(J);G=h(it,"LABEL",{for:!0,style:!0,"data-svelte-h":!0}),ne(G)!=="svelte-1m9yw22"&&(G.innerHTML=ue),K=w(it),ve=h(it,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0,capture:!0}),it.forEach(u),je.forEach(u),Fe.forEach(u),Me=w(Ne),H&&H.l(Ne),Ne.forEach(u),pe.forEach(u),De=w(Q),j&&j.l(Q),Se=w(Q),Y&&Y.l(Q),Le=xe(),this.h()},h(){b(i,"color","medium"),b(n,"slot","start"),b(a,"title",""),b(_,"strong",""),b(g,"slot","end"),b(e,"translucent",""),b(D,"icon",Nn),b(D,"slot","start"),b(U,"label","Concepto"),b(U,"type","text"),b(U,"placeholder","Escribe aquí..."),b(U,"value",l[9]?l[9]:""),b(W,"icon",ut),b(W,"slot","start"),b(B,"label","Monto $"),b(B,"type","number"),b(B,"value",l[10]?l[10]:""),b(T,"icon",Gn),b(T,"slot","start"),R($,"slot","label"),b(ie,"value","cash"),b(oe,"value","card"),b(se,"value","transfer"),b(A,"placeholder","Tipo de pago"),b(A,"value",l[11]?l[11]:""),b(ae,"icon",ut),b(ae,"slot","start"),b(Ie,"label","Comentarios"),b(Ie,"placeholder","Escribe aquí..."),R(G,"for","eventEvidence"),c(G,"width","100%"),c(G,"padding","8px"),c(ve,"display","none"),R(ve,"id","eventEvidence"),R(ve,"name","fileToUpload"),R(ve,"type","file"),R(ve,"accept","image/*"),R(ve,"capture","environment"),b(J,"fill","outline"),b(J,"size","small"),b(J,"class","loadEvidence"),b(J,"expand","block"),R(Z,"for","eventEvidence"),c(Z,"display","block"),c(Z,"width","100%"),b(E,"fullscreen","")},m(Q,Ee){V(Q,e,Ee),r(e,t),r(t,n),r(n,i),r(t,s),r(t,a),r(t,k),r(t,g),r(g,_),V(Q,p,Ee),V(Q,E,Ee),r(E,O),r(O,N),r(N,D),r(N,P),r(N,U),l[18](U),r(O,x),r(O,z),r(z,W),r(z,C),r(z,B),l[19](B),r(O,S),r(O,I),r(I,T),r(I,M),r(I,A),r(A,$),r(A,de),r(A,ie),r(A,L),r(A,oe),r(A,be),r(A,se),l[20](A),r(O,ge),r(O,_e),r(_e,ae),r(_e,ee),r(_e,Ie),l[21](Ie),r(O,ke),r(O,Oe),r(Oe,Z),r(Z,J),r(J,G),r(J,K),r(J,ve),r(O,Me),H&&H.m(O,null),V(Q,De,Ee),j&&j.m(Q,Ee),V(Q,Se,Ee),Y&&Y.m(Q,Ee),V(Q,Le,Ee),q||(he=[fe(i,"click",l[13]),fe(_,"click",l[14]),fe(ve,"change",l[12])],q=!0)},p(Q,Ee){Q[0]?H?H.p(Q,Ee):(H=Gt(Q),H.c(),H.m(O,null)):H&&(H.d(1),H=null),Q[6]?j||(j=Xt(),j.c(),j.m(Se.parentNode,Se)):j&&(j.d(1),j=null),Q[7]?Y?Y.p(Q,Ee):(Y=Jt(Q),Y.c(),Y.m(Le.parentNode,Le)):Y&&(Y.d(1),Y=null)},i:Ce,o:Ce,d(Q){Q&&(u(e),u(p),u(E),u(De),u(Se),u(Le)),l[18](null),l[19](null),l[20](null),l[21](null),H&&H.d(),j&&j.d(Q),Y&&Y.d(Q),q=!1,Re(he)}}}function Ji(l,e,t){let n=ht,i=document.querySelector("ion-modal"),o=i.componentProps.routeId,s=i.componentProps.ex_concept,a=i.componentProps.ex_amount,d=i.componentProps.ex_type,k=i.componentProps.id_expense,g="",_=new Array,m="",p="",E=0,O="",N="",D=!1,P=new Object,U=!1,x="";ot(()=>{P=JSON.parse(localStorage.getItem("userSession"))});const z=async(L,oe)=>{await(await Qe.create({header:L||"Error",message:oe||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()},W=async L=>{t(6,D=!0);const re=L.target.files[0],be=await C(re);if(be){var se=new Object;se.fileToUpload=be,se.id_user_over=P.id_user,se.token=P.token;try{Ke(`${n}api/admin/manager/upload_img_driver.php`,function(X){X.success?(t(0,g=X.img),t(1,_=Ze(g)),m=X.img_id):z("Error","No se pudo subir la imagen"),t(6,D=!1)},se)}catch(X){console.error("Error during file upload:",X)}finally{t(6,D=!1)}}},C=async L=>new Promise(oe=>{const re=new Image;re.src=URL.createObjectURL(L),re.onload=()=>{const be=document.createElement("canvas"),se=be.getContext("2d"),X=800,ge=600;let _e=re.width,ae=re.height;_e>X&&(ae*=X/_e,_e=X),ae>ge&&(_e*=ge/ae,ae=ge),be.width=_e,be.height=ae,se.drawImage(re,0,0,_e,ae),be.toBlob(ee=>{oe(ee),URL.revokeObjectURL(re.src),se.clearRect(0,0,be.width,be.height)},"image/jpeg",.7)}}),B=()=>{$e.dismiss()},S=()=>{var L=new Object;L.id_route=o,L.comments=O.value,L.type=p.value,L.img=g,L.img_id=m,L.amount=E.value,L.concept=N.value,L.status="done",L.id_expense=k||"null",L.id_user_over=P.id_user,L.token=P.token,!m||!g||!E.value||!N.value?z("Datos incompletos","Llena los datos requeridos para completar el registro"):Ke(`${n}api/admin/expenses/add_expense.php`,function(oe){B()},L)},I=L=>{t(8,x=L),t(7,U=!0)},T=()=>{t(7,U=!1),t(8,x="")};function M(L){Nt.call(this,l,L)}function A(L){Be[L?"unshift":"push"](()=>{N=L,t(5,N)})}function $(L){Be[L?"unshift":"push"](()=>{E=L,t(3,E)})}function le(L){Be[L?"unshift":"push"](()=>{p=L,t(2,p)})}function de(L){Be[L?"unshift":"push"](()=>{O=L,t(4,O)})}return[g,_,p,E,O,N,D,U,x,s,a,d,W,B,S,I,T,M,A,$,le,de,L=>I(L),L=>removeFile(L)]}class Et extends tt{constructor(e){super(),nt(this,e,Ji,Xi,et,{},null,[-1,-1])}}function Yt(l,e,t){const n=l.slice();return n[32]=e[t],n[34]=t,n}function Qt(l,e,t){const n=l.slice();return n[35]=e[t],n}function Zt(l){let e,t,n,i,o,s,a=l[35].label+"",d,k,g,_;function m(){return l[18](l[35])}return{c(){e=f("div"),t=f("ion-button"),n=f("ion-icon"),o=y(),s=f("div"),d=ye(a),k=y(),this.h()},l(p){e=h(p,"DIV",{class:!0});var E=v(e);t=h(E,"ION-BUTTON",{color:!0,fill:!0,size:!0});var O=v(t);n=h(O,"ION-ICON",{slot:!0,icon:!0}),v(n).forEach(u),O.forEach(u),o=w(E),s=h(E,"DIV",{class:!0,style:!0});var N=v(s);d=we(N,a),N.forEach(u),k=w(E),E.forEach(u),this.h()},h(){b(n,"slot","icon-only"),b(n,"icon",l[35].icon),b(t,"color",i=l[6]===l[35].id?"primary":"medium"),b(t,"fill","clear"),b(t,"size","small"),R(s,"class","motive-caption"),c(s,"font-size","11px"),c(s,"margin-top","2px"),c(s,"text-align","center"),c(s,"line-height","1.1"),R(e,"class","motive-button")},m(p,E){V(p,e,E),r(e,t),r(t,n),r(e,o),r(e,s),r(s,d),r(e,k),g||(_=fe(t,"click",m),g=!0)},p(p,E){l=p,E[0]&64&&i!==(i=l[6]===l[35].id?"primary":"medium")&&b(t,"color",i)},d(p){p&&u(e),g=!1,_()}}}function $t(l){let e;return{c(){e=f("div"),this.h()},l(t){e=h(t,"DIV",{id:!0,style:!0}),v(e).forEach(u),this.h()},h(){R(e,"id","motive-map"),c(e,"height","220px"),c(e,"margin","12px 16px"),c(e,"border-radius","8px")},m(t,n){V(t,e,n),l[19](e)},p:Ce,d(t){t&&u(e),l[19](null)}}}function en(l){let e,t,n=We(l[1]),i=[];for(let o=0;o<n.length;o+=1)i[o]=tn(Yt(l,n,o));return{c(){e=f("section"),t=f("div");for(let o=0;o<i.length;o+=1)i[o].c();this.h()},l(o){e=h(o,"SECTION",{});var s=v(e);t=h(s,"DIV",{class:!0,style:!0});var a=v(t);for(let d=0;d<i.length;d+=1)i[d].l(a);a.forEach(u),s.forEach(u),this.h()},h(){R(t,"class","image-grid"),c(t,"display","grid"),c(t,"grid-template-columns","repeat(auto-fill, minmax(100px, 1fr))"),c(t,"gap","10px"),c(t,"padding","0px 10px")},m(o,s){V(o,e,s),r(e,t);for(let a=0;a<i.length;a+=1)i[a]&&i[a].m(t,null)},p(o,s){if(s[0]&73730){n=We(o[1]);let a;for(a=0;a<n.length;a+=1){const d=Yt(o,n,a);i[a]?i[a].p(d,s):(i[a]=tn(d),i[a].c(),i[a].m(t,null))}for(;a<i.length;a+=1)i[a].d(1);i.length=n.length}},d(o){o&&u(e),gt(i,o)}}}function tn(l){let e,t,n,i,o,s=`<ion-icon icon="${Mt}"></ion-icon>`,a,d,k;function g(){return l[21](l[32])}function _(){return l[22](l[34])}return{c(){e=f("div"),t=f("ion-img"),i=y(),o=f("button"),o.innerHTML=s,a=y(),this.h()},l(m){e=h(m,"DIV",{class:!0,style:!0});var p=v(e);t=h(p,"ION-IMG",{src:!0,alt:!0,style:!0}),v(t).forEach(u),i=w(p),o=h(p,"BUTTON",{class:!0,style:!0,"data-svelte-h":!0}),ne(o)!=="svelte-ulzohx"&&(o.innerHTML=s),a=w(p),p.forEach(u),this.h()},h(){Xe(t.src,n=l[32])||b(t,"src",n),b(t,"alt","Evidencia fotográfica"),c(t,"width","100%"),c(t,"height","100px"),c(t,"object-fit","cover"),c(t,"cursor","pointer"),c(t,"border","1px solid #ccc"),c(t,"border-radius","4px"),c(t,"margin-top","16px"),R(o,"class","remove-button"),c(o,"position","absolute"),c(o,"top","5px"),c(o,"right","5px"),c(o,"border","none"),c(o,"cursor","pointer"),c(o,"font-size","18px"),c(o,"background","white"),c(o,"border-radius","50%"),c(o,"padding","3px 4px 0px"),c(o,"box-shadow","2px 2px 6px rgba(0, 0, 0, 0.3)"),c(o,"color","#0000008f"),R(e,"class","image-container"),c(e,"position","relative")},m(m,p){V(m,e,p),r(e,t),r(e,i),r(e,o),r(e,a),d||(k=[fe(t,"click",g),fe(o,"click",_)],d=!0)},p(m,p){l=m,p[0]&2&&!Xe(t.src,n=l[32])&&b(t,"src",n)},d(m){m&&u(e),d=!1,Re(k)}}}function nn(l){let e,t,n,i,o,s,a=`<ion-icon icon="${Lt}"></ion-icon>`,d,k;return{c(){e=f("div"),t=f("div"),n=f("ion-img"),o=y(),s=f("button"),s.innerHTML=a,this.h()},l(g){e=h(g,"DIV",{class:!0,style:!0});var _=v(e);t=h(_,"DIV",{class:!0,style:!0});var m=v(t);n=h(m,"ION-IMG",{src:!0,alt:!0,style:!0}),v(n).forEach(u),o=w(m),s=h(m,"BUTTON",{class:!0,style:!0,"data-svelte-h":!0}),ne(s)!=="svelte-1fdruw6"&&(s.innerHTML=a),m.forEach(u),_.forEach(u),this.h()},h(){Xe(n.src,i=l[5])||b(n,"src",i),b(n,"alt","Evidencia fotográfica"),c(n,"width","100%"),c(n,"height","auto"),R(s,"class","close-button"),c(s,"position","absolute"),c(s,"top","5px"),c(s,"right","5px"),c(s,"background","white"),c(s,"color","#444444d1"),c(s,"border","none"),c(s,"cursor","pointer"),c(s,"padding","2px 2px 0px 6px"),c(s,"border-radius","50%"),c(s,"font-size","20px"),R(t,"class","modal-content"),c(t,"position","relative"),c(t,"background","white"),c(t,"padding","20px"),c(t,"border-radius","8px"),c(t,"max-width","90vw"),c(t,"max-height","90vh"),c(t,"overflow","auto"),R(e,"class","modal-overlay"),c(e,"position","fixed"),c(e,"top","0"),c(e,"left","0"),c(e,"width","100vw"),c(e,"height","100vh"),c(e,"background","rgba(0, 0, 0, 0.8)"),c(e,"display","flex"),c(e,"justify-content","center"),c(e,"align-items","center"),c(e,"z-index","1000")},m(g,_){V(g,e,_),r(e,t),r(t,n),r(t,o),r(t,s),d||(k=[fe(s,"click",l[14]),fe(t,"click",wt(l[17])),fe(e,"click",l[14])],d=!0)},p(g,_){_[0]&32&&!Xe(n.src,i=g[5])&&b(n,"src",i)},d(g){g&&u(e),d=!1,Re(k)}}}function on(l){let e,t='<ion-spinner name="dots" style="color:white;"></ion-spinner>';return{c(){e=f("div"),e.innerHTML=t,this.h()},l(n){e=h(n,"DIV",{class:!0,style:!0,"data-svelte-h":!0}),ne(e)!=="svelte-1mz0rrk"&&(e.innerHTML=t),this.h()},h(){R(e,"class","overlay"),c(e,"position","fixed"),c(e,"top","0"),c(e,"left","0"),c(e,"width","100vw"),c(e,"height","100vh"),c(e,"background","rgba(0, 0, 0, 0.5)"),c(e,"display","flex"),c(e,"align-items","center"),c(e,"justify-content","center"),c(e,"z-index","9999")},m(n,i){V(n,e,i)},d(n){n&&u(e)}}}function Yi(l){let e,t,n,i,o="Cancelar",s,a,d="AGREGAR INCIDENCIA",k,g,_,m="Confirmar",p,E,O,N,D,P,U,x,z,W,C,B,S,I,T,M,A=`<ion-icon icon="${Tt}" slot="start"></ion-icon>
            Subir Evidencia`,$,le,de,ie,me,L,oe,re,be=We(l[9]),se=[];for(let ee=0;ee<be.length;ee+=1)se[ee]=Zt(Qt(l,be,ee));let X=l[7].lat&&$t(l),ge=l[0]&&en(l),_e=l[4]&&nn(l),ae=l[3]&&on();return{c(){e=f("ion-header"),t=f("ion-toolbar"),n=f("ion-buttons"),i=f("ion-button"),i.textContent=o,s=y(),a=f("ion-title"),a.textContent=d,k=y(),g=f("ion-buttons"),_=f("ion-button"),_.textContent=m,p=y(),E=f("ion-content"),O=f("ion-list"),N=f("ion-item"),D=f("div");for(let ee=0;ee<se.length;ee+=1)se[ee].c();P=y(),X&&X.c(),U=y(),x=f("ion-item"),z=f("ion-icon"),W=y(),C=f("ion-textarea"),B=y(),S=f("section"),I=f("label"),T=f("ion-button"),M=f("label"),M.innerHTML=A,$=y(),le=f("input"),de=y(),ge&&ge.c(),ie=y(),_e&&_e.c(),me=y(),ae&&ae.c(),L=xe(),this.h()},l(ee){e=h(ee,"ION-HEADER",{translucent:!0});var Ie=v(e);t=h(Ie,"ION-TOOLBAR",{});var ke=v(t);n=h(ke,"ION-BUTTONS",{slot:!0});var Oe=v(n);i=h(Oe,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),ne(i)!=="svelte-1f8rjcf"&&(i.textContent=o),Oe.forEach(u),s=w(ke),a=h(ke,"ION-TITLE",{title:!0,"data-svelte-h":!0}),ne(a)!=="svelte-zr4yw3"&&(a.textContent=d),k=w(ke),g=h(ke,"ION-BUTTONS",{slot:!0});var Z=v(g);_=h(Z,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),ne(_)!=="svelte-1afq5zm"&&(_.textContent=m),Z.forEach(u),ke.forEach(u),Ie.forEach(u),p=w(ee),E=h(ee,"ION-CONTENT",{fullscreen:!0});var J=v(E);O=h(J,"ION-LIST",{});var G=v(O);N=h(G,"ION-ITEM",{lines:!0,class:!0,style:!0});var ue=v(N);D=h(ue,"DIV",{class:!0,style:!0});var K=v(D);for(let Le=0;Le<se.length;Le+=1)se[Le].l(K);K.forEach(u),ue.forEach(u),P=w(G),X&&X.l(G),U=w(G),x=h(G,"ION-ITEM",{});var ve=v(x);z=h(ve,"ION-ICON",{icon:!0,slot:!0}),v(z).forEach(u),W=w(ve),C=h(ve,"ION-TEXTAREA",{label:!0,placeholder:!0}),v(C).forEach(u),ve.forEach(u),B=w(G),S=h(G,"SECTION",{});var Me=v(S);I=h(Me,"LABEL",{for:!0,style:!0});var De=v(I);T=h(De,"ION-BUTTON",{fill:!0,size:!0,class:!0,expand:!0});var Se=v(T);M=h(Se,"LABEL",{for:!0,style:!0,"data-svelte-h":!0}),ne(M)!=="svelte-1tbnglg"&&(M.innerHTML=A),$=w(Se),le=h(Se,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0,capture:!0}),Se.forEach(u),De.forEach(u),Me.forEach(u),de=w(G),ge&&ge.l(G),G.forEach(u),J.forEach(u),ie=w(ee),_e&&_e.l(ee),me=w(ee),ae&&ae.l(ee),L=xe(),this.h()},h(){b(i,"color","medium"),b(n,"slot","start"),b(a,"title",""),b(_,"strong",""),b(g,"slot","end"),b(e,"translucent",""),R(D,"class","motive-grid"),c(D,"display","flex"),c(D,"gap","8px"),c(D,"flex-wrap","wrap"),c(D,"justify-content","center"),c(D,"margin-top","6px"),b(N,"lines","none"),b(N,"class","motive-item"),c(N,"display","grid"),c(N,"justify-content","center"),c(N,"margin-bottom","15px"),b(z,"icon",ut),b(z,"slot","start"),b(C,"label","Comentarios"),b(C,"placeholder","Escribe aquí..."),R(M,"for","eventEvidence"),c(M,"width","100%"),c(M,"padding","8px"),c(le,"display","none"),R(le,"id","eventEvidence"),R(le,"name","fileToUpload"),R(le,"type","file"),R(le,"accept","image/*"),R(le,"capture","environment"),b(T,"fill","outline"),b(T,"size","small"),b(T,"class","loadEvidence"),b(T,"expand","block"),R(I,"for","eventEvidence"),c(I,"display","block"),c(I,"width","100%"),b(E,"fullscreen","")},m(ee,Ie){V(ee,e,Ie),r(e,t),r(t,n),r(n,i),r(t,s),r(t,a),r(t,k),r(t,g),r(g,_),V(ee,p,Ie),V(ee,E,Ie),r(E,O),r(O,N),r(N,D);for(let ke=0;ke<se.length;ke+=1)se[ke]&&se[ke].m(D,null);r(O,P),X&&X.m(O,null),r(O,U),r(O,x),r(x,z),r(x,W),r(x,C),l[20](C),r(O,B),r(O,S),r(S,I),r(I,T),r(T,M),r(T,$),r(T,le),r(O,de),ge&&ge.m(O,null),V(ee,ie,Ie),_e&&_e.m(ee,Ie),V(ee,me,Ie),ae&&ae.m(ee,Ie),V(ee,L,Ie),oe||(re=[fe(i,"click",l[11]),fe(_,"click",l[12]),fe(le,"change",l[10])],oe=!0)},p(ee,Ie){if(Ie[0]&33344){be=We(ee[9]);let ke;for(ke=0;ke<be.length;ke+=1){const Oe=Qt(ee,be,ke);se[ke]?se[ke].p(Oe,Ie):(se[ke]=Zt(Oe),se[ke].c(),se[ke].m(D,null))}for(;ke<se.length;ke+=1)se[ke].d(1);se.length=be.length}ee[7].lat?X?X.p(ee,Ie):(X=$t(ee),X.c(),X.m(O,U)):X&&(X.d(1),X=null),ee[0]?ge?ge.p(ee,Ie):(ge=en(ee),ge.c(),ge.m(O,null)):ge&&(ge.d(1),ge=null),ee[4]?_e?_e.p(ee,Ie):(_e=nn(ee),_e.c(),_e.m(me.parentNode,me)):_e&&(_e.d(1),_e=null),ee[3]?ae||(ae=on(),ae.c(),ae.m(L.parentNode,L)):ae&&(ae.d(1),ae=null)},i:Ce,o:Ce,d(ee){ee&&(u(e),u(p),u(E),u(ie),u(me),u(L)),gt(se,ee),X&&X.d(),l[20](null),ge&&ge.d(),_e&&_e.d(ee),ae&&ae.d(ee),oe=!1,Re(re)}}}function Qi(l,e,t){let n=ht,o=document.querySelector("ion-modal").componentProps.routeId,s="",a=s?Ze(s):new Array,d="",k=!1,g=new Object,_=!1,m="",p="",E={lat:null,lng:null},O,N,D;const P=[{id:"car_accident",icon:"/car-accident.svg",label:"Accidente"},{id:"hospital",icon:"/hospital.svg",label:"Hospital"},{id:"wc",icon:"/toilet.svg",label:"Baño"},{id:"restaurant",icon:"/restaurant.svg",label:"Restaurant"},{id:"parking",icon:"/parking.svg",label:"Parking"},{id:"traffic",icon:"/traffic.svg",label:"Tráfico"}];ot(()=>{g=JSON.parse(localStorage.getItem("userSession"))});const U=async(L,oe)=>{await(await Qe.create({header:L||"Error",message:oe||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()},x=async L=>{t(3,k=!0);try{if(a.length>=5){U("Límite de evidencias","Solo se permite subir 5 fotos por parada");return}const re=L.target.files[0],be=await z(re);if(!be){U("Error","No se pudo comprimir la imagen");return}const se={fileToUpload:be,id_user_over:g.id_user,token:g.token},X=await new Promise((ge,_e)=>{Ke(`${n}api/admin/manager/upload_img_driver.php`,ae=>ge(ae),se)});X.success?(t(0,s=s?`${s},${X.img}`:X.img),t(1,a=Ze(s))):U("Error","No se pudo subir la imagen")}catch(oe){console.error("Error during file upload:",oe),U("Error","Algo salió mal al subir la imagen.")}finally{t(3,k=!1)}},z=async L=>new Promise(oe=>{const re=new Image;re.src=URL.createObjectURL(L),re.onload=()=>{const be=document.createElement("canvas"),se=be.getContext("2d"),X=800,ge=600;let _e=re.width,ae=re.height;_e>X&&(ae*=X/_e,_e=X),ae>ge&&(_e*=ge/ae,ae=ge),be.width=_e,be.height=ae,se.drawImage(re,0,0,_e,ae),be.toBlob(ee=>{oe(ee),URL.revokeObjectURL(re.src),se.clearRect(0,0,be.width,be.height)},"image/jpeg",.7)}}),W=()=>{$e.dismiss()},C=()=>{t(3,k=!0);var L=new Object;t(0,s=a.join(",")),L.id_route=o,L.comments=d.value,L.lat=E.lat,L.lng=E.lng,L.type=p,L.img=s,L.id_user_over=g.id_user,L.token=g.token,L.id_driver=g.id_driver,!p||!s||!L.comments||!L.img?(t(3,k=!1),U("Datos incompletos","Llena los datos requeridos para completar el registro")):!L.lat||!L.lng?(t(3,k=!1),U("Ubicación no disponible","Por favor, asegúrate de que la ubicación está activada en tu dispositivo.")):Ke(`${n}api/admin/incidence/add_incidence.php`,function(oe){oe?(t(3,k=!1),U("Éxito","Incidencia registrada correctamente")):(t(3,k=!1),U("Error","No se pudo registrar la incidencia. Por favor, inténtalo de nuevo.")),W()},L)},B=L=>{t(5,m=L),t(4,_=!0)},S=()=>{t(4,_=!1),t(5,m="")};async function I(L){t(6,p=L),t(3,k=!0),navigator.geolocation&&navigator.geolocation.getCurrentPosition(async oe=>{t(7,E.lat=oe.coords.latitude,E),t(7,E.lng=oe.coords.longitude,E),await T()},()=>console.log("Geolocalización denegada"))}async function T(){if(await yt(),!O)return;const{Map:L}=await google.maps.importLibrary("maps"),{AdvancedMarkerElement:oe}=await google.maps.importLibrary("marker");N?N.setCenter(E):N=new L(O,{zoom:15,center:E,mapId:"4504f8b37365c3d0"});const re=P.find(X=>X.id===p);if(!re)return;D&&D.setMap(null);const be=document.createElement("div");be.style.cssText=`
      display:flex;align-items:center;justify-content:center;
      width:38px;height:38px;border-radius:50%;
      background:#ffffff;border:2px solid #d13434;
      box-shadow:0 0 4px rgba(0,0,0,.3);
  `;const se=document.createElement("ion-icon");se.setAttribute("icon",re.icon),se.style.cssText="font-size:24px;color:#d13434;",be.appendChild(se),D=new oe({map:N,position:E,title:re.label,content:be}),t(3,k=!1)}function M(L=0){var oe=Tn(L,a,[""],s);t(1,a=oe.files),t(0,s=oe.selectedImages)}function A(L){Nt.call(this,l,L)}const $=L=>I(L.id);function le(L){Be[L?"unshift":"push"](()=>{O=L,t(8,O)})}function de(L){Be[L?"unshift":"push"](()=>{d=L,t(2,d)})}return[s,a,d,k,_,m,p,E,O,P,x,W,C,B,S,I,M,A,$,le,de,L=>B(L),L=>M(L)]}class Zi extends tt{constructor(e){super(),nt(this,e,Qi,Yi,et,{},null,[-1,-1])}}function ln(l,e,t){const n=l.slice();return n[7]=e[t],n}function $i(l){let e,t="Cargar gasto",n,i;function o(...s){return l[4](l[7],...s)}return{c(){e=f("ion-button"),e.textContent=t,this.h()},l(s){e=h(s,"ION-BUTTON",{fill:!0,size:!0,"aria-selected":!0,"data-svelte-h":!0}),ne(e)!=="svelte-175aelj"&&(e.textContent=t),this.h()},h(){b(e,"fill","outline"),b(e,"size","small"),b(e,"aria-selected","")},m(s,a){V(s,e,a),n||(i=fe(e,"click",o),n=!0)},p(s,a){l=s},d(s){s&&u(e),n=!1,i()}}}function eo(l){let e,t="Gasto completado";return{c(){e=f("ion-button"),e.textContent=t,this.h()},l(n){e=h(n,"ION-BUTTON",{fill:!0,size:!0,"aria-selected":!0,"data-svelte-h":!0}),ne(e)!=="svelte-tlger7"&&(e.textContent=t),this.h()},h(){b(e,"fill","solid"),b(e,"size","small"),b(e,"aria-selected","")},m(n,i){V(n,e,i)},p:Ce,d(n){n&&u(e)}}}function rn(l,e){let t,n,i,o=e[7].concept+"",s,a,d;function k(m,p){return m[7].status=="done"?eo:$i}let _=k(e)(e);return{key:l,first:null,c(){t=f("ion-item"),n=f("ion-label"),i=f("p"),s=ye(o),a=y(),_.c(),d=y(),this.h()},l(m){t=h(m,"ION-ITEM",{});var p=v(t);n=h(p,"ION-LABEL",{style:!0});var E=v(n);i=h(E,"P",{style:!0});var O=v(i);s=we(O,o),O.forEach(u),E.forEach(u),a=w(p),_.l(p),d=w(p),p.forEach(u),this.h()},h(){c(i,"margin-left","10px"),c(n,"display","flex"),this.first=t},m(m,p){V(m,t,p),r(t,n),r(n,i),r(i,s),r(t,a),_.m(t,null),r(t,d)},p(m,p){e=m,_.p(e,p)},d(m){m&&u(t),_.d()}}}function to(l){let e,t,n,i,o=`<ion-icon style="font-size: 25px!important;" icon="${Kn}"></ion-icon>`,s,a,d="LISTA DE GASTOS",k,g,_,m=[],p=new Map,E,O,N,D="Cerrar",P,U,x=We(l[0]);const z=W=>W[7].id_expenses;for(let W=0;W<x.length;W+=1){let C=ln(l,x,W),B=z(C);p.set(B,m[W]=rn(B,C))}return{c(){e=f("ion-header"),t=f("ion-toolbar"),n=f("ion-buttons"),i=f("ion-button"),i.innerHTML=o,s=y(),a=f("ion-title"),a.textContent=d,k=y(),g=f("ion-content"),_=f("ion-list");for(let W=0;W<m.length;W+=1)m[W].c();E=y(),O=f("ion-footer"),N=f("ion-button"),N.textContent=D,this.h()},l(W){e=h(W,"ION-HEADER",{translucent:!0});var C=v(e);t=h(C,"ION-TOOLBAR",{});var B=v(t);n=h(B,"ION-BUTTONS",{slot:!0});var S=v(n);i=h(S,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),ne(i)!=="svelte-160xz3i"&&(i.innerHTML=o),S.forEach(u),s=w(B),a=h(B,"ION-TITLE",{"data-svelte-h":!0}),ne(a)!=="svelte-1phn90x"&&(a.textContent=d),B.forEach(u),C.forEach(u),k=w(W),g=h(W,"ION-CONTENT",{fullscreen:!0});var I=v(g);_=h(I,"ION-LIST",{});var T=v(_);for(let A=0;A<m.length;A+=1)m[A].l(T);T.forEach(u),I.forEach(u),E=w(W),O=h(W,"ION-FOOTER",{});var M=v(O);N=h(M,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),ne(N)!=="svelte-zv7v83"&&(N.textContent=D),M.forEach(u),this.h()},h(){b(i,"color","medium"),b(n,"slot","end"),b(e,"translucent",""),b(g,"fullscreen",""),b(N,"fill","outline"),b(N,"color","tertiary"),b(N,"strong",""),c(N,"width","99%"),c(N,"height","auto")},m(W,C){V(W,e,C),r(e,t),r(t,n),r(n,i),r(t,s),r(t,a),V(W,k,C),V(W,g,C),r(g,_);for(let B=0;B<m.length;B+=1)m[B]&&m[B].m(_,null);V(W,E,C),V(W,O,C),r(O,N),P||(U=[fe(i,"click",l[3]),fe(N,"click",l[1])],P=!0)},p(W,[C]){C&5&&(x=We(W[0]),m=dt(m,C,z,1,W,x,p,_,ft,rn,null,ln))},i:Ce,o:Ce,d(W){W&&(u(e),u(k),u(g),u(E),u(O));for(let C=0;C<m.length;C+=1)m[C].d();P=!1,Re(U)}}}function no(l){let e=document.querySelector("ion-modal");e.componentProps.routeId;let t=e.componentProps.expenses;ot(()=>{});const n=()=>{$e.dismiss()};function i(a,d,k,g,_){e.componentProps.ex_amount=k,e.componentProps.ex_concept=d,e.componentProps.ex_type=g,e.componentProps.id_expense=_,Ye("modal-expense",Et,{amount:k,concept:d,type:g,id_expense:_}).then(()=>{}),n()}return[t,n,i,a=>{Ye("modal-expense",Et,{routeId:a}).then(d=>{}),n()},(a,d)=>i(d,a.concept,a.amount,a.type,a.id_expenses)]}class io extends tt{constructor(e){super(),nt(this,e,no,to,et,{})}}const{document:sn}=ii;function an(l,e,t){const n=l.slice();return n[63]=e[t],n[65]=t,n}function cn(l,e,t){const n=l.slice();return n[63]=e[t],n[65]=t,n}function un(l,e,t){const n=l.slice();return n[63]=e[t],n[65]=t,n}function dn(l){let e,t;return e=new Xn({props:{$$slots:{default:[vo]},$$scope:{ctx:l}}}),{c(){En(e.$$.fragment)},l(n){In(e.$$.fragment,n)},m(n,i){On(e,n,i),t=!0},p(n,i){const o={};i[0]&6139|i[2]&64&&(o.$$scope={dirty:i,ctx:n}),e.$set(o)},i(n){t||(ct(e.$$.fragment,n),t=!0)},o(n){pt(e.$$.fragment,n),t=!1},d(n){yn(e,n)}}}function oo(l){let e,t='<div id="g_map" style="width: 100%; height: 100vh;"></div>';return{c(){e=f("ion-content"),e.innerHTML=t},l(n){e=h(n,"ION-CONTENT",{"data-svelte-h":!0}),ne(e)!=="svelte-h8v4nk"&&(e.innerHTML=t)},m(n,i){V(n,e,i)},p:Ce,d(n){n&&u(e)}}}function lo(l){let e,t=l[9]==="list"&&l[12]&&l[14](),n;function i(d,k){if(d[7].length>0)return so;if(!d[3])return ro}let o=i(l),s=o&&o(l),a=t&&bn(l);return{c(){s&&s.c(),e=y(),a&&a.c(),n=xe()},l(d){s&&s.l(d),e=w(d),a&&a.l(d),n=xe()},m(d,k){s&&s.m(d,k),V(d,e,k),a&&a.m(d,k),V(d,n,k)},p(d,k){o===(o=i(d))&&s?s.p(d,k):(s&&s.d(1),s=o&&o(d),s&&(s.c(),s.m(e.parentNode,e))),k[0]&4608&&(t=d[9]==="list"&&d[12]&&d[14]()),t?a?a.p(d,k):(a=bn(d),a.c(),a.m(n.parentNode,n)):a&&(a.d(1),a=null)},d(d){d&&(u(e),u(n)),s&&s.d(d),a&&a.d(d)}}}function ro(l){let e,t,n,i='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Jala para actualizar" refreshing-spinner="circles" refreshing-text="Actualizando..."></ion-refresher-content>',o,s,a,d,k,g,_="0",m,p,E,O,N,D=l[6].origin+"",P,U,x,z,W,C,B=[],S=new Map,I,T,M,A,$,le=l[5].length+1+"",de,ie,me,L,oe,re,be=l[6].destination+"",se,X,ge,_e="",ae,ee,Ie,ke,Oe=l[4]&&fn(),Z=We(l[5]);const J=G=>G[63].id_event;for(let G=0;G<Z.length;G+=1){let ue=an(l,Z,G),K=J(ue);S.set(K,B[G]=_n(K,ue))}return{c(){Oe&&Oe.c(),e=y(),t=f("ion-content"),n=f("ion-refresher"),n.innerHTML=i,o=y(),s=f("ion-list"),a=f("ion-item"),d=f("ion-avatar"),k=f("div"),g=f("div"),g.textContent=_,p=y(),E=f("ion-label"),O=f("ion-text"),N=f("h3"),P=ye(D),U=y(),x=f("div"),z=y(),W=f("ion-icon"),C=y();for(let G=0;G<B.length;G+=1)B[G].c();I=y(),T=f("ion-item"),M=f("ion-avatar"),A=f("div"),$=f("div"),de=ye(le),me=y(),L=f("ion-label"),oe=f("ion-text"),re=f("h3"),se=ye(be),X=y(),ge=f("div"),ge.innerHTML=_e,ae=y(),ee=f("ion-icon"),this.h()},l(G){Oe&&Oe.l(G),e=w(G),t=h(G,"ION-CONTENT",{});var ue=v(t);n=h(ue,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),ne(n)!=="svelte-1mlmyg"&&(n.innerHTML=i),o=w(ue),s=h(ue,"ION-LIST",{});var K=v(s);a=h(K,"ION-ITEM",{});var ve=v(a);d=h(ve,"ION-AVATAR",{slot:!0});var Me=v(d);k=h(Me,"DIV",{class:!0,title:!0,style:!0});var De=v(k);g=h(De,"DIV",{class:!0,"data-svelte-h":!0}),ne(g)!=="svelte-b78non"&&(g.textContent=_),De.forEach(u),Me.forEach(u),p=w(ve),E=h(ve,"ION-LABEL",{button:!0});var Se=v(E);O=h(Se,"ION-TEXT",{color:!0});var Le=v(O);N=h(Le,"H3",{});var q=v(N);P=we(q,D),q.forEach(u),Le.forEach(u),U=w(Se),x=h(Se,"DIV",{class:!0}),v(x).forEach(u),Se.forEach(u),z=w(ve),W=h(ve,"ION-ICON",{icon:!0,slot:!0}),v(W).forEach(u),ve.forEach(u),C=w(K);for(let ce=0;ce<B.length;ce+=1)B[ce].l(K);I=w(K),T=h(K,"ION-ITEM",{});var he=v(T);M=h(he,"ION-AVATAR",{slot:!0});var H=v(M);A=h(H,"DIV",{class:!0,title:!0,style:!0});var j=v(A);$=h(j,"DIV",{class:!0});var Y=v($);de=we(Y,le),Y.forEach(u),j.forEach(u),H.forEach(u),me=w(he),L=h(he,"ION-LABEL",{button:!0});var Q=v(L);oe=h(Q,"ION-TEXT",{color:!0});var Ee=v(oe);re=h(Ee,"H3",{});var F=v(re);se=we(F,be),F.forEach(u),Ee.forEach(u),X=w(Q),ge=h(Q,"DIV",{class:!0,"data-svelte-h":!0}),ne(ge)!=="svelte-1284run"&&(ge.innerHTML=_e),Q.forEach(u),ae=w(he),ee=h(he,"ION-ICON",{icon:!0,slot:!0}),v(ee).forEach(u),he.forEach(u),K.forEach(u),ue.forEach(u),this.h()},h(){b(n,"slot","fixed"),R(g,"class","order svelte-1ita8l7"),R(k,"class","order-wrapper svelte-1ita8l7"),R(k,"title",m="$"+l[6].origin),c(k,"background-color",l[6].color),c(k,"color",Ue(l[6].color)),b(d,"slot","start"),b(O,"color","#2e2e2e"),R(x,"class","sub svelte-1ita8l7"),b(E,"button",""),b(W,"icon",Je),b(W,"slot","end"),R($,"class","order svelte-1ita8l7"),R(A,"class","order-wrapper svelte-1ita8l7"),R(A,"title",ie="$"+l[6].destination),c(A,"background-color",l[6].color),c(A,"color",Ue(l[6].color)),b(M,"slot","start"),b(oe,"color","#2e2e2e"),R(ge,"class","sub svelte-1ita8l7"),b(L,"button",""),b(ee,"icon",Je),b(ee,"slot","end")},m(G,ue){Oe&&Oe.m(G,ue),V(G,e,ue),V(G,t,ue),r(t,n),l[36](n),r(t,o),r(t,s),r(s,a),r(a,d),r(d,k),r(k,g),r(a,p),r(a,E),r(E,O),r(O,N),r(N,P),r(E,U),r(E,x),r(a,z),r(a,W),r(s,C);for(let K=0;K<B.length;K+=1)B[K]&&B[K].m(s,null);r(s,I),r(s,T),r(T,M),r(M,A),r(A,$),r($,de),r(T,me),r(T,L),r(L,oe),r(oe,re),r(re,se),r(L,X),r(L,ge),r(T,ae),r(T,ee),Ie||(ke=[fe(n,"ionRefresh",l[13]),fe(E,"click",l[37]),fe(L,"click",l[39])],Ie=!0)},p(G,ue){G[4]?Oe||(Oe=fn(),Oe.c(),Oe.m(e.parentNode,e)):Oe&&(Oe.d(1),Oe=null),ue[0]&64&&m!==(m="$"+G[6].origin)&&R(k,"title",m),ue[0]&64&&c(k,"background-color",G[6].color),ue[0]&64&&c(k,"color",Ue(G[6].color)),ue[0]&64&&D!==(D=G[6].origin+"")&&Ae(P,D),ue[0]&10552352&&(Z=We(G[5]),B=dt(B,ue,J,1,G,Z,S,s,ft,_n,I,an)),ue[0]&32&&le!==(le=G[5].length+1+"")&&Ae(de,le),ue[0]&64&&ie!==(ie="$"+G[6].destination)&&R(A,"title",ie),ue[0]&64&&c(A,"background-color",G[6].color),ue[0]&64&&c(A,"color",Ue(G[6].color)),ue[0]&64&&be!==(be=G[6].destination+"")&&Ae(se,be)},d(G){G&&(u(e),u(t)),Oe&&Oe.d(G),l[36](null);for(let ue=0;ue<B.length;ue+=1)B[ue].d();Ie=!1,Re(ke)}}}function so(l){let e,t;function n(s,a){return a[0]&144&&(e=null),e==null&&(e=!!(s[7].filter(bo).every(ko)&&!s[4])),e?fo:uo}let i=n(l,[-1,-1,-1]),o=i(l);return{c(){o.c(),t=xe()},l(s){o.l(s),t=xe()},m(s,a){o.m(s,a),V(s,t,a)},p(s,a){i===(i=n(s,a))&&o?o.p(s,a):(o.d(1),o=i(s),o&&(o.c(),o.m(t.parentNode,t)))},d(s){s&&u(t),o.d(s)}}}function fn(l){return{c:Ce,l:Ce,m:Ce,d:Ce}}function hn(l){let e;return{c(){e=f("span"),this.h()},l(t){e=h(t,"SPAN",{class:!0}),v(e).forEach(u),this.h()},h(){R(e,"class","notes svelte-1ita8l7")},m(t,n){V(t,e,n)},d(t){t&&u(e)}}}function ao(l){let e;return{c(){e=f("ion-icon"),this.h()},l(t){e=h(t,"ION-ICON",{icon:!0,slot:!0,style:!0}),v(e).forEach(u),this.h()},h(){b(e,"icon",Je),b(e,"slot","end"),c(e,"color",He(l[63].status,l[63].date_service))},m(t,n){V(t,e,n)},p(t,n){n[0]&32&&c(e,"color",He(t[63].status,t[63].date_service))},d(t){t&&u(e)}}}function co(l){let e,t=(l[63].tag?l[63].tag:"")+"",n;return{c(){e=f("div"),n=ye(t),this.h()},l(i){e=h(i,"DIV",{class:!0,slot:!0,style:!0});var o=v(e);n=we(o,t),o.forEach(u),this.h()},h(){R(e,"class","stop-tag"),R(e,"slot","end"),c(e,"background-color",Ge(l[63].tag_color,.3)),c(e,"border","1px solid "+Ge(l[63].tag_color,.4)),c(e,"color",l[63].tag_color),c(e,"font-size","10px"),c(e,"text-align","center"),c(e,"align-content","center"),c(e,"border-radius","20px"),c(e,"white-space","normal"),c(e,"padding","3px 6px"),c(e,"width","auto",1),c(e,"display","inline-block"),c(e,"font-weight","500")},m(i,o){V(i,e,o),r(e,n)},p(i,o){o[0]&32&&t!==(t=(i[63].tag?i[63].tag:"")+"")&&Ae(n,t),o[0]&32&&c(e,"background-color",Ge(i[63].tag_color,.3)),o[0]&32&&c(e,"border","1px solid "+Ge(i[63].tag_color,.4)),o[0]&32&&c(e,"color",i[63].tag_color)},d(i){i&&u(e)}}}function _n(l,e){let t,n,i,o,s=parseInt(e[63].pos)+1+"",a,d,k,g,_,m,p=e[63].title+"",E,O,N=e[63].support_list&&e[63].support_list.length||e[21](e[63]),D,P,U,x=N&&hn();function z(){return e[38](e[63])}function W(S,I){return S[63].tag_color&&S[63].tag?co:ao}let C=W(e),B=C(e);return{key:l,first:null,c(){t=f("ion-item"),n=f("ion-avatar"),i=f("div"),o=f("div"),a=ye(s),k=y(),g=f("ion-label"),_=f("ion-text"),m=f("h3"),E=ye(p),O=y(),x&&x.c(),D=y(),B.c(),this.h()},l(S){t=h(S,"ION-ITEM",{});var I=v(t);n=h(I,"ION-AVATAR",{slot:!0});var T=v(n);i=h(T,"DIV",{class:!0,title:!0,style:!0});var M=v(i);o=h(M,"DIV",{class:!0});var A=v(o);a=we(A,s),A.forEach(u),M.forEach(u),T.forEach(u),k=w(I),g=h(I,"ION-LABEL",{button:!0});var $=v(g);_=h($,"ION-TEXT",{color:!0});var le=v(_);m=h(le,"H3",{});var de=v(m);E=we(de,p),O=w(de),x&&x.l(de),de.forEach(u),le.forEach(u),$.forEach(u),D=w(I),B.l(I),I.forEach(u),this.h()},h(){R(o,"class","order svelte-1ita8l7"),R(i,"class","order-wrapper svelte-1ita8l7"),R(i,"title",d=rt(e[63].status)),c(i,"background-color",He(e[63].status,e[63].date_service)),c(i,"color",Ue(He(e[63].status))),b(n,"slot","start"),b(_,"color","#2e2e2e"),b(g,"button",""),this.first=t},m(S,I){V(S,t,I),r(t,n),r(n,i),r(i,o),r(o,a),r(t,k),r(t,g),r(g,_),r(_,m),r(m,E),r(m,O),x&&x.m(m,null),r(t,D),B.m(t,null),P||(U=fe(g,"click",z),P=!0)},p(S,I){e=S,I[0]&32&&s!==(s=parseInt(e[63].pos)+1+"")&&Ae(a,s),I[0]&32&&d!==(d=rt(e[63].status))&&R(i,"title",d),I[0]&32&&c(i,"background-color",He(e[63].status,e[63].date_service)),I[0]&32&&c(i,"color",Ue(He(e[63].status))),I[0]&32&&p!==(p=e[63].title+"")&&Ae(E,p),I[0]&32&&(N=e[63].support_list&&e[63].support_list.length||e[21](e[63])),N?x||(x=hn(),x.c(),x.m(m,null)):x&&(x.d(1),x=null),C===(C=W(e))&&B?B.p(e,I):(B.d(1),B=C(e),B&&(B.c(),B.m(t,null)))},d(S){S&&u(t),x&&x.d(),B.d(),P=!1,U()}}}function uo(l){let e,t,n='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Pull to refresh" refreshing-spinner="circles" refreshing-text="Refreshing..."></ion-refresher-content>',i,o,s,a,d,k,g="0",_,m,p,E,O,N=l[6].origin+"",D,P,U,x,z,W,C=[],B=new Map,S,I,T,M,A,$=l[5].length+1+"",le,de,ie,me,L,oe,re=l[6].destination+"",be,se,X,ge="",_e,ae,ee,Ie,ke=We(l[5]);const Oe=Z=>Z[63].id_event;for(let Z=0;Z<ke.length;Z+=1){let J=cn(l,ke,Z),G=Oe(J);B.set(G,C[Z]=mn(G,J))}return{c(){e=f("ion-content"),t=f("ion-refresher"),t.innerHTML=n,i=y(),o=f("ion-list"),s=f("ion-item"),a=f("ion-avatar"),d=f("div"),k=f("div"),k.textContent=g,m=y(),p=f("ion-label"),E=f("ion-text"),O=f("h3"),D=ye(N),P=y(),U=f("div"),x=y(),z=f("ion-icon"),W=y();for(let Z=0;Z<C.length;Z+=1)C[Z].c();S=y(),I=f("ion-item"),T=f("ion-avatar"),M=f("div"),A=f("div"),le=ye($),ie=y(),me=f("ion-label"),L=f("ion-text"),oe=f("h3"),be=ye(re),se=y(),X=f("div"),X.innerHTML=ge,_e=y(),ae=f("ion-icon"),this.h()},l(Z){e=h(Z,"ION-CONTENT",{});var J=v(e);t=h(J,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),ne(t)!=="svelte-1l8nqqz"&&(t.innerHTML=n),i=w(J),o=h(J,"ION-LIST",{});var G=v(o);s=h(G,"ION-ITEM",{});var ue=v(s);a=h(ue,"ION-AVATAR",{slot:!0});var K=v(a);d=h(K,"DIV",{class:!0,title:!0,style:!0});var ve=v(d);k=h(ve,"DIV",{class:!0,"data-svelte-h":!0}),ne(k)!=="svelte-b78non"&&(k.textContent=g),ve.forEach(u),K.forEach(u),m=w(ue),p=h(ue,"ION-LABEL",{button:!0});var Me=v(p);E=h(Me,"ION-TEXT",{color:!0});var De=v(E);O=h(De,"H3",{});var Se=v(O);D=we(Se,N),Se.forEach(u),De.forEach(u),P=w(Me),U=h(Me,"DIV",{class:!0}),v(U).forEach(u),Me.forEach(u),x=w(ue),z=h(ue,"ION-ICON",{icon:!0,slot:!0}),v(z).forEach(u),ue.forEach(u),W=w(G);for(let Ee=0;Ee<C.length;Ee+=1)C[Ee].l(G);S=w(G),I=h(G,"ION-ITEM",{});var Le=v(I);T=h(Le,"ION-AVATAR",{slot:!0});var q=v(T);M=h(q,"DIV",{class:!0,title:!0,style:!0});var he=v(M);A=h(he,"DIV",{class:!0});var H=v(A);le=we(H,$),H.forEach(u),he.forEach(u),q.forEach(u),ie=w(Le),me=h(Le,"ION-LABEL",{button:!0});var j=v(me);L=h(j,"ION-TEXT",{color:!0});var Y=v(L);oe=h(Y,"H3",{});var Q=v(oe);be=we(Q,re),Q.forEach(u),Y.forEach(u),se=w(j),X=h(j,"DIV",{class:!0,"data-svelte-h":!0}),ne(X)!=="svelte-1uxrbi7"&&(X.innerHTML=ge),j.forEach(u),_e=w(Le),ae=h(Le,"ION-ICON",{icon:!0,slot:!0}),v(ae).forEach(u),Le.forEach(u),G.forEach(u),J.forEach(u),this.h()},h(){b(t,"slot","fixed"),R(k,"class","order svelte-1ita8l7"),R(d,"class","order-wrapper svelte-1ita8l7"),R(d,"title",_="$"+l[6].origin),c(d,"background-color",l[6].color),c(d,"color",Ue(l[6].color)),b(a,"slot","start"),b(E,"color","#2e2e2e"),R(U,"class","sub svelte-1ita8l7"),b(p,"button",""),b(z,"icon",Je),b(z,"slot","end"),R(A,"class","order svelte-1ita8l7"),R(M,"class","order-wrapper svelte-1ita8l7"),R(M,"title",de="$"+l[6].destination),c(M,"background-color",l[6].color),c(M,"color",Ue(l[6].color)),b(T,"slot","start"),b(L,"color","#2e2e2e"),R(X,"class","sub svelte-1ita8l7"),b(me,"button",""),b(ae,"icon",Je),b(ae,"slot","end")},m(Z,J){V(Z,e,J),r(e,t),l[32](t),r(e,i),r(e,o),r(o,s),r(s,a),r(a,d),r(d,k),r(s,m),r(s,p),r(p,E),r(E,O),r(O,D),r(p,P),r(p,U),r(s,x),r(s,z),r(o,W);for(let G=0;G<C.length;G+=1)C[G]&&C[G].m(o,null);r(o,S),r(o,I),r(I,T),r(T,M),r(M,A),r(A,le),r(I,ie),r(I,me),r(me,L),r(L,oe),r(oe,be),r(me,se),r(me,X),r(I,_e),r(I,ae),ee||(Ie=[fe(t,"ionRefresh",l[13]),fe(p,"click",l[33]),fe(me,"click",l[35])],ee=!0)},p(Z,J){J[0]&64&&_!==(_="$"+Z[6].origin)&&R(d,"title",_),J[0]&64&&c(d,"background-color",Z[6].color),J[0]&64&&c(d,"color",Ue(Z[6].color)),J[0]&64&&N!==(N=Z[6].origin+"")&&Ae(D,N),J[0]&10552352&&(ke=We(Z[5]),C=dt(C,J,Oe,1,Z,ke,B,o,ft,mn,S,cn)),J[0]&32&&$!==($=Z[5].length+1+"")&&Ae(le,$),J[0]&64&&de!==(de="$"+Z[6].destination)&&R(M,"title",de),J[0]&64&&c(M,"background-color",Z[6].color),J[0]&64&&c(M,"color",Ue(Z[6].color)),J[0]&64&&re!==(re=Z[6].destination+"")&&Ae(be,re)},d(Z){Z&&u(e),l[32](null);for(let J=0;J<C.length;J+=1)C[J].d();ee=!1,Re(Ie)}}}function fo(l){let e,t,n='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Jale para actualizar" refreshing-spinner="circles" refreshing-text="Actualizando..."></ion-refresher-content>',i,o,s,a,d,k,g="0",_,m,p,E,O,N=l[6].origin+"",D,P,U,x,z,W,C=[],B=new Map,S,I,T,M,A,$=l[5].length+1+"",le,de,ie,me,L,oe,re=l[6].destination+"",be,se,X,ge="",_e,ae,ee,Ie,ke=We(l[5]);const Oe=Z=>Z[63].id_event;for(let Z=0;Z<ke.length;Z+=1){let J=un(l,ke,Z),G=Oe(J);B.set(G,C[Z]=gn(G,J))}return{c(){e=f("ion-content"),t=f("ion-refresher"),t.innerHTML=n,i=y(),o=f("ion-list"),s=f("ion-item"),a=f("ion-avatar"),d=f("div"),k=f("div"),k.textContent=g,m=y(),p=f("ion-label"),E=f("ion-text"),O=f("h3"),D=ye(N),P=y(),U=f("div"),x=y(),z=f("ion-icon"),W=y();for(let Z=0;Z<C.length;Z+=1)C[Z].c();S=y(),I=f("ion-item"),T=f("ion-avatar"),M=f("div"),A=f("div"),le=ye($),ie=y(),me=f("ion-label"),L=f("ion-text"),oe=f("h3"),be=ye(re),se=y(),X=f("div"),X.innerHTML=ge,_e=y(),ae=f("ion-icon"),this.h()},l(Z){e=h(Z,"ION-CONTENT",{});var J=v(e);t=h(J,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),ne(t)!=="svelte-vjbhg4"&&(t.innerHTML=n),i=w(J),o=h(J,"ION-LIST",{});var G=v(o);s=h(G,"ION-ITEM",{});var ue=v(s);a=h(ue,"ION-AVATAR",{slot:!0});var K=v(a);d=h(K,"DIV",{class:!0,title:!0,style:!0});var ve=v(d);k=h(ve,"DIV",{class:!0,"data-svelte-h":!0}),ne(k)!=="svelte-b78non"&&(k.textContent=g),ve.forEach(u),K.forEach(u),m=w(ue),p=h(ue,"ION-LABEL",{button:!0});var Me=v(p);E=h(Me,"ION-TEXT",{color:!0});var De=v(E);O=h(De,"H3",{});var Se=v(O);D=we(Se,N),Se.forEach(u),De.forEach(u),P=w(Me),U=h(Me,"DIV",{class:!0}),v(U).forEach(u),Me.forEach(u),x=w(ue),z=h(ue,"ION-ICON",{icon:!0,slot:!0}),v(z).forEach(u),ue.forEach(u),W=w(G);for(let Ee=0;Ee<C.length;Ee+=1)C[Ee].l(G);S=w(G),I=h(G,"ION-ITEM",{});var Le=v(I);T=h(Le,"ION-AVATAR",{slot:!0});var q=v(T);M=h(q,"DIV",{class:!0,title:!0,style:!0});var he=v(M);A=h(he,"DIV",{class:!0});var H=v(A);le=we(H,$),H.forEach(u),he.forEach(u),q.forEach(u),ie=w(Le),me=h(Le,"ION-LABEL",{button:!0});var j=v(me);L=h(j,"ION-TEXT",{color:!0});var Y=v(L);oe=h(Y,"H3",{});var Q=v(oe);be=we(Q,re),Q.forEach(u),Y.forEach(u),se=w(j),X=h(j,"DIV",{class:!0,"data-svelte-h":!0}),ne(X)!=="svelte-1uxrbi7"&&(X.innerHTML=ge),j.forEach(u),_e=w(Le),ae=h(Le,"ION-ICON",{icon:!0,slot:!0}),v(ae).forEach(u),Le.forEach(u),G.forEach(u),J.forEach(u),this.h()},h(){b(t,"slot","fixed"),R(k,"class","order svelte-1ita8l7"),R(d,"class","order-wrapper svelte-1ita8l7"),R(d,"title",_="$"+l[6].origin),c(d,"background-color",l[6].color),c(d,"color",Ue(l[6].color)),b(a,"slot","start"),b(E,"color","#2e2e2e"),R(U,"class","sub svelte-1ita8l7"),b(p,"button",""),b(z,"icon",Je),b(z,"slot","end"),R(A,"class","order svelte-1ita8l7"),R(M,"class","order-wrapper svelte-1ita8l7"),R(M,"title",de="$"+l[6].destination),c(M,"background-color",l[6].color),c(M,"color",Ue(l[6].color)),b(T,"slot","start"),b(L,"color","#2e2e2e"),R(X,"class","sub svelte-1ita8l7"),b(me,"button",""),b(ae,"icon",Je),b(ae,"slot","end")},m(Z,J){V(Z,e,J),r(e,t),l[28](t),r(e,i),r(e,o),r(o,s),r(s,a),r(a,d),r(d,k),r(s,m),r(s,p),r(p,E),r(E,O),r(O,D),r(p,P),r(p,U),r(s,x),r(s,z),r(o,W);for(let G=0;G<C.length;G+=1)C[G]&&C[G].m(o,null);r(o,S),r(o,I),r(I,T),r(T,M),r(M,A),r(A,le),r(I,ie),r(I,me),r(me,L),r(L,oe),r(oe,be),r(me,se),r(me,X),r(I,_e),r(I,ae),ee||(Ie=[fe(t,"ionRefresh",l[13]),fe(p,"click",l[29]),fe(me,"click",l[31])],ee=!0)},p(Z,J){J[0]&64&&_!==(_="$"+Z[6].origin)&&R(d,"title",_),J[0]&64&&c(d,"background-color",Z[6].color),J[0]&64&&c(d,"color",Ue(Z[6].color)),J[0]&64&&N!==(N=Z[6].origin+"")&&Ae(D,N),J[0]&10552352&&(ke=We(Z[5]),C=dt(C,J,Oe,1,Z,ke,B,o,ft,gn,S,un)),J[0]&32&&$!==($=Z[5].length+1+"")&&Ae(le,$),J[0]&64&&de!==(de="$"+Z[6].destination)&&R(M,"title",de),J[0]&64&&c(M,"background-color",Z[6].color),J[0]&64&&c(M,"color",Ue(Z[6].color)),J[0]&64&&re!==(re=Z[6].destination+"")&&Ae(be,re)},d(Z){Z&&u(e),l[28](null);for(let J=0;J<C.length;J+=1)C[J].d();ee=!1,Re(Ie)}}}function pn(l){let e;return{c(){e=f("span"),this.h()},l(t){e=h(t,"SPAN",{class:!0}),v(e).forEach(u),this.h()},h(){R(e,"class","notes svelte-1ita8l7")},m(t,n){V(t,e,n)},d(t){t&&u(e)}}}function ho(l){let e;return{c(){e=f("ion-icon"),this.h()},l(t){e=h(t,"ION-ICON",{icon:!0,slot:!0,style:!0}),v(e).forEach(u),this.h()},h(){b(e,"icon",Je),b(e,"slot","end"),c(e,"color",He(l[63].status,l[63].date_service))},m(t,n){V(t,e,n)},p(t,n){n[0]&32&&c(e,"color",He(t[63].status,t[63].date_service))},d(t){t&&u(e)}}}function _o(l){let e,t=(l[63].tag?l[63].tag:"")+"",n;return{c(){e=f("div"),n=ye(t),this.h()},l(i){e=h(i,"DIV",{class:!0,slot:!0,style:!0});var o=v(e);n=we(o,t),o.forEach(u),this.h()},h(){R(e,"class","stop-tag"),R(e,"slot","end"),c(e,"background-color",Ge(l[63].tag_color,.3)),c(e,"border","1px solid "+Ge(l[63].tag_color,.4)),c(e,"color",l[63].tag_color),c(e,"font-size","10px"),c(e,"text-align","center"),c(e,"align-content","center"),c(e,"border-radius","20px"),c(e,"white-space","normal"),c(e,"padding","3px 6px"),c(e,"width","auto",1),c(e,"display","inline-block"),c(e,"font-weight","500")},m(i,o){V(i,e,o),r(e,n)},p(i,o){o[0]&32&&t!==(t=(i[63].tag?i[63].tag:"")+"")&&Ae(n,t),o[0]&32&&c(e,"background-color",Ge(i[63].tag_color,.3)),o[0]&32&&c(e,"border","1px solid "+Ge(i[63].tag_color,.4)),o[0]&32&&c(e,"color",i[63].tag_color)},d(i){i&&u(e)}}}function mn(l,e){let t,n,i,o,s=parseInt(e[63].pos)+1+"",a,d,k,g,_,m,p=e[63].title+"",E,O,N=e[63].support_list&&e[63].support_list.length||e[21](e[63]),D,P,U="",x,z,W,C=N&&pn();function B(){return e[34](e[63])}function S(M,A){return M[63].tag_color&&M[63].tag?_o:ho}let I=S(e),T=I(e);return{key:l,first:null,c(){t=f("ion-item"),n=f("ion-avatar"),i=f("div"),o=f("div"),a=ye(s),k=y(),g=f("ion-label"),_=f("ion-text"),m=f("h3"),E=ye(p),O=y(),C&&C.c(),D=y(),P=f("div"),P.innerHTML=U,x=y(),T.c(),this.h()},l(M){t=h(M,"ION-ITEM",{});var A=v(t);n=h(A,"ION-AVATAR",{slot:!0});var $=v(n);i=h($,"DIV",{class:!0,title:!0,style:!0});var le=v(i);o=h(le,"DIV",{class:!0});var de=v(o);a=we(de,s),de.forEach(u),le.forEach(u),$.forEach(u),k=w(A),g=h(A,"ION-LABEL",{button:!0});var ie=v(g);_=h(ie,"ION-TEXT",{color:!0});var me=v(_);m=h(me,"H3",{});var L=v(m);E=we(L,p),O=w(L),C&&C.l(L),L.forEach(u),me.forEach(u),D=w(ie),P=h(ie,"DIV",{class:!0,"data-svelte-h":!0}),ne(P)!=="svelte-4k5p1b"&&(P.innerHTML=U),ie.forEach(u),x=w(A),T.l(A),A.forEach(u),this.h()},h(){R(o,"class","order svelte-1ita8l7"),R(i,"class","order-wrapper svelte-1ita8l7"),R(i,"title",d=rt(e[63].status)),c(i,"background-color",He(e[63].status,e[63].date_service)),c(i,"color",Ue(He(e[63].status))),b(n,"slot","start"),b(_,"color","#2e2e2e"),R(P,"class","sub svelte-1ita8l7"),b(g,"button",""),this.first=t},m(M,A){V(M,t,A),r(t,n),r(n,i),r(i,o),r(o,a),r(t,k),r(t,g),r(g,_),r(_,m),r(m,E),r(m,O),C&&C.m(m,null),r(g,D),r(g,P),r(t,x),T.m(t,null),z||(W=fe(g,"click",B),z=!0)},p(M,A){e=M,A[0]&32&&s!==(s=parseInt(e[63].pos)+1+"")&&Ae(a,s),A[0]&32&&d!==(d=rt(e[63].status))&&R(i,"title",d),A[0]&32&&c(i,"background-color",He(e[63].status,e[63].date_service)),A[0]&32&&c(i,"color",Ue(He(e[63].status))),A[0]&32&&p!==(p=e[63].title+"")&&Ae(E,p),A[0]&32&&(N=e[63].support_list&&e[63].support_list.length||e[21](e[63])),N?C||(C=pn(),C.c(),C.m(m,null)):C&&(C.d(1),C=null),I===(I=S(e))&&T?T.p(e,A):(T.d(1),T=I(e),T&&(T.c(),T.m(t,null)))},d(M){M&&u(t),C&&C.d(),T.d(),z=!1,W()}}}function vn(l){let e;return{c(){e=f("span"),this.h()},l(t){e=h(t,"SPAN",{class:!0}),v(e).forEach(u),this.h()},h(){R(e,"class","notes svelte-1ita8l7")},m(t,n){V(t,e,n)},d(t){t&&u(e)}}}function po(l){let e;return{c(){e=f("ion-icon"),this.h()},l(t){e=h(t,"ION-ICON",{icon:!0,slot:!0,style:!0}),v(e).forEach(u),this.h()},h(){b(e,"icon",Je),b(e,"slot","end"),c(e,"color",He(l[63].status,l[63].date_service))},m(t,n){V(t,e,n)},p(t,n){n[0]&32&&c(e,"color",He(t[63].status,t[63].date_service))},d(t){t&&u(e)}}}function mo(l){let e,t=(l[63].tag?l[63].tag:"")+"",n;return{c(){e=f("div"),n=ye(t),this.h()},l(i){e=h(i,"DIV",{class:!0,slot:!0,style:!0});var o=v(e);n=we(o,t),o.forEach(u),this.h()},h(){R(e,"class","stop-tag"),R(e,"slot","end"),c(e,"background-color",Ge(l[63].tag_color,.3)),c(e,"border","1px solid "+Ge(l[63].tag_color,.4)),c(e,"color",l[63].tag_color),c(e,"font-size","10px"),c(e,"text-align","center"),c(e,"align-content","center"),c(e,"border-radius","20px"),c(e,"white-space","normal"),c(e,"padding","3px 6px"),c(e,"width","auto",1),c(e,"display","inline-block"),c(e,"font-weight","500")},m(i,o){V(i,e,o),r(e,n)},p(i,o){o[0]&32&&t!==(t=(i[63].tag?i[63].tag:"")+"")&&Ae(n,t),o[0]&32&&c(e,"background-color",Ge(i[63].tag_color,.3)),o[0]&32&&c(e,"border","1px solid "+Ge(i[63].tag_color,.4)),o[0]&32&&c(e,"color",i[63].tag_color)},d(i){i&&u(e)}}}function gn(l,e){let t,n,i,o,s=parseInt(e[63].pos)+1+"",a,d,k,g,_,m,p=e[63].title+"",E,O,N=e[63].support_list&&e[63].support_list.length||e[21](e[63]),D,P,U="",x,z,W,C=N&&vn();function B(){return e[30](e[63])}function S(M,A){return M[63].tag_color&&M[63].tag?mo:po}let I=S(e),T=I(e);return{key:l,first:null,c(){t=f("ion-item"),n=f("ion-avatar"),i=f("div"),o=f("div"),a=ye(s),k=y(),g=f("ion-label"),_=f("ion-text"),m=f("h3"),E=ye(p),O=y(),C&&C.c(),D=y(),P=f("div"),P.innerHTML=U,x=y(),T.c(),this.h()},l(M){t=h(M,"ION-ITEM",{});var A=v(t);n=h(A,"ION-AVATAR",{slot:!0});var $=v(n);i=h($,"DIV",{class:!0,title:!0,style:!0});var le=v(i);o=h(le,"DIV",{class:!0});var de=v(o);a=we(de,s),de.forEach(u),le.forEach(u),$.forEach(u),k=w(A),g=h(A,"ION-LABEL",{button:!0});var ie=v(g);_=h(ie,"ION-TEXT",{color:!0});var me=v(_);m=h(me,"H3",{});var L=v(m);E=we(L,p),O=w(L),C&&C.l(L),L.forEach(u),me.forEach(u),D=w(ie),P=h(ie,"DIV",{class:!0,"data-svelte-h":!0}),ne(P)!=="svelte-4k5p1b"&&(P.innerHTML=U),ie.forEach(u),x=w(A),T.l(A),A.forEach(u),this.h()},h(){R(o,"class","order svelte-1ita8l7"),R(i,"class","order-wrapper svelte-1ita8l7"),R(i,"title",d=rt(e[63].status)),c(i,"background-color",He(e[63].status,e[63].date_service)),c(i,"color",Ue(He(e[63].status))),b(n,"slot","start"),b(_,"color","#2e2e2e"),R(P,"class","sub svelte-1ita8l7"),b(g,"button",""),this.first=t},m(M,A){V(M,t,A),r(t,n),r(n,i),r(i,o),r(o,a),r(t,k),r(t,g),r(g,_),r(_,m),r(m,E),r(m,O),C&&C.m(m,null),r(g,D),r(g,P),r(t,x),T.m(t,null),z||(W=fe(g,"click",B),z=!0)},p(M,A){e=M,A[0]&32&&s!==(s=parseInt(e[63].pos)+1+"")&&Ae(a,s),A[0]&32&&d!==(d=rt(e[63].status))&&R(i,"title",d),A[0]&32&&c(i,"background-color",He(e[63].status,e[63].date_service)),A[0]&32&&c(i,"color",Ue(He(e[63].status))),A[0]&32&&p!==(p=e[63].title+"")&&Ae(E,p),A[0]&32&&(N=e[63].support_list&&e[63].support_list.length||e[21](e[63])),N?C||(C=vn(),C.c(),C.m(m,null)):C&&(C.d(1),C=null),I===(I=S(e))&&T?T.p(e,A):(T.d(1),T=I(e),T&&(T.c(),T.m(t,null)))},d(M){M&&u(t),C&&C.d(),T.d(),z=!1,W()}}}function bn(l){let e,t,n,i="Iniciar ruta",o,s;return{c(){e=f("ion-footer"),t=f("ion-toolbar"),n=f("ion-button"),n.textContent=i,this.h()},l(a){e=h(a,"ION-FOOTER",{});var d=v(e);t=h(d,"ION-TOOLBAR",{});var k=v(t);n=h(k,"ION-BUTTON",{expand:!0,size:!0,color:!0,style:!0,"data-svelte-h":!0}),ne(n)!=="svelte-xdhfrl"&&(n.textContent=i),k.forEach(u),d.forEach(u),this.h()},h(){b(n,"expand","block"),b(n,"size","large"),b(n,"color","primary"),c(n,"margin","8px")},m(a,d){V(a,e,d),r(e,t),r(t,n),o||(s=fe(n,"click",l[40]),o=!0)},p:Ce,d(a){a&&u(e),o=!1,s()}}}function vo(l){let e,t,n,i,o=`<ion-icon icon="${Jn}"></ion-icon>`,s,a,d,k=`<ion-icon icon="${Yn}"></ion-icon>`,g,_,m=`<ion-icon icon="${Qn}"></ion-icon>`,p,E,O=(l[6].name?l[6].name.toUpperCase():"")+"",N,D,P,U='<ion-segment-button value="list"><ion-label>Paradas</ion-label></ion-segment-button> <ion-segment-button value="map"><ion-label>Mapa</ion-label></ion-segment-button>',x,z,W,C;function B(T,M){if(T[9]==="list")return lo;if(T[9]==="map")return oo}let S=B(l),I=S&&S(l);return{c(){e=f("ion-header"),t=f("ion-toolbar"),n=f("ion-buttons"),i=f("ion-button"),i.innerHTML=o,s=y(),a=f("ion-buttons"),d=f("ion-button"),d.innerHTML=k,g=y(),_=f("ion-button"),_.innerHTML=m,p=y(),E=f("ion-title"),N=ye(O),D=y(),P=f("ion-segment"),P.innerHTML=U,x=y(),I&&I.c(),z=xe(),this.h()},l(T){e=h(T,"ION-HEADER",{translucent:!0});var M=v(e);t=h(M,"ION-TOOLBAR",{});var A=v(t);n=h(A,"ION-BUTTONS",{slot:!0});var $=v(n);i=h($,"ION-BUTTON",{title:!0,alt:!0,"data-svelte-h":!0}),ne(i)!=="svelte-1a21unf"&&(i.innerHTML=o),$.forEach(u),s=w(A),a=h(A,"ION-BUTTONS",{slot:!0});var le=v(a);d=h(le,"ION-BUTTON",{"data-svelte-h":!0}),ne(d)!=="svelte-dy3728"&&(d.innerHTML=k),g=w(le),_=h(le,"ION-BUTTON",{"data-svelte-h":!0}),ne(_)!=="svelte-1omw1hr"&&(_.innerHTML=m),le.forEach(u),p=w(A),E=h(A,"ION-TITLE",{});var de=v(E);N=we(de,O),de.forEach(u),A.forEach(u),D=w(M),P=h(M,"ION-SEGMENT",{value:!0,"data-svelte-h":!0}),ne(P)!=="svelte-1rseadq"&&(P.innerHTML=U),M.forEach(u),x=w(T),I&&I.l(T),z=xe(),this.h()},h(){b(i,"title","Atrás"),b(i,"alt","Atrás"),b(n,"slot","start"),b(a,"slot","end"),b(P,"value","list"),b(e,"translucent","")},m(T,M){V(T,e,M),r(e,t),r(t,n),r(n,i),r(t,s),r(t,a),r(a,d),r(a,g),r(a,_),r(t,p),r(t,E),r(E,N),r(e,D),r(e,P),V(T,x,M),I&&I.m(T,M),V(T,z,M),W||(C=[fe(i,"click",l[22]),fe(d,"click",l[25]),fe(_,"click",l[26]),fe(P,"ionChange",l[27])],W=!0)},p(T,M){M[0]&64&&O!==(O=(T[6].name?T[6].name.toUpperCase():"")+"")&&Ae(N,O),S===(S=B(T))&&I?I.p(T,M):(I&&I.d(1),I=S&&S(T),I&&(I.c(),I.m(z.parentNode,z)))},d(T){T&&(u(e),u(x),u(z)),I&&I.d(T),W=!1,Re(C)}}}function kn(l){let e,t='<ion-spinner name="dots" style="color:white;"></ion-spinner>';return{c(){e=f("div"),e.innerHTML=t,this.h()},l(n){e=h(n,"DIV",{class:!0,style:!0,"data-svelte-h":!0}),ne(e)!=="svelte-1aosxw0"&&(e.innerHTML=t),this.h()},h(){R(e,"class","overlay"),c(e,"position","fixed"),c(e,"top","0"),c(e,"left","0"),c(e,"width","100vw"),c(e,"height","100vh"),c(e,"background","rgba(0, 0, 0, 0.5)"),c(e,"display","flex"),c(e,"align-items","center"),c(e,"justify-content","center"),c(e,"z-index","9999")},m(n,i){V(n,e,i)},d(n){n&&u(e)}}}function go(l){let e,t,n,i,o=l[2]&&dn(l),s=l[11]&&kn();return{c(){e=y(),o&&o.c(),t=y(),s&&s.c(),n=xe(),this.h()},l(a){Dn("svelte-kn0kph",sn.head).forEach(u),e=w(a),o&&o.l(a),t=w(a),s&&s.l(a),n=xe(),this.h()},h(){sn.title="Rutaflow - Detalles de ruta"},m(a,d){V(a,e,d),o&&o.m(a,d),V(a,t,d),s&&s.m(a,d),V(a,n,d),i=!0},p(a,d){a[2]?o?(o.p(a,d),d[0]&4&&ct(o,1)):(o=dn(a),o.c(),ct(o,1),o.m(t.parentNode,t)):o&&(Un(),pt(o,1,1,()=>{o=null}),Bn()),a[11]?s||(s=kn(),s.c(),s.m(n.parentNode,n)):s&&(s.d(1),s=null)},i(a){i||(ct(o),i=!0)},o(a){pt(o),i=!1},d(a){a&&(u(e),u(t),u(n)),o&&o.d(a),s&&s.d(a)}}}function He(l,e=""){let t="#ffffff";return l==="pending"&&!e?t="#f2e300":l=="pending"&&e?t="#F6A833":l==="completed"&&(t="#44d900"),t}function rt(l){let e="";return l=="pending"?e="Pendiente":l=="completed"&&(e="Completado"),e}function Ue(l){if(!l)return"#414040";l.slice(0,1)==="#"&&(l=l.slice(1)),l.length===3&&(l=l.split("").map(function(o){return o+o}).join(""));const e=parseInt(l.substr(0,2),16),t=parseInt(l.substr(2,2),16),n=parseInt(l.substr(4,2),16);return(e*299+t*587+n*114)/1e3>=128?"#414040":"#fff"}function _t(l,e){for(let t=0;t<e.length;t++)if(e[t].alias===l)return e[t].val;return""}const bo=l=>l.mandatory==="1",ko=l=>l.img;function Eo(l,e,t){let n;xn(l,Zn,F=>t(24,n=F));var i=this&&this.__awaiter||function(F,ce,te,pe){function Ne(Pe){return Pe instanceof te?Pe:new te(function(Te){Te(Pe)})}return new(te||(te=Promise))(function(Pe,Te){function ze(Fe){try{qe(pe.next(Fe))}catch(je){Te(je)}}function Ve(Fe){try{qe(pe.throw(Fe))}catch(je){Te(je)}}function qe(Fe){Fe.done?Pe(Fe.value):Ne(Fe.value).then(ze,Ve)}qe((pe=pe.apply(F,ce||[])).next())})};let{routeId:o}=e,{driverId:s}=e,a=ht,d=new Object,k=!0,g=!1,_=[],m=[],p={},E=[],O=[],N,D=!1,P="list",U,x="",z="",W="",C="0",B=new Object,S="",I=!1,T=!1,M=!1;const A={car_accident:"/car-accident.svg",restaurant:"/restaurant.svg",parking:"/parking.svg",hospital:"/hospital.svg",wc:"/toilet.svg",traffic:"/traffic.svg"},$=()=>i(void 0,void 0,void 0,function*(){yield re(o),N.complete()});ot(()=>i(void 0,void 0,void 0,function*(){Z(),yield re(o)}));function le(){const F=(E||[]).filter(ce=>ce.mandatory==="1");return F.length?!F.every(ce=>!!ce.img):!1}function de(){const F=g||(p==null?void 0:p.km_inicial)==="0"||(p==null?void 0:p.gas_inicial)==="0",ce=le();return F||ce}function ie(){return!de()}function me(){return i(this,void 0,void 0,function*(){return M||!de()?!0:new Promise(F=>i(this,void 0,void 0,function*(){yield(yield Qe.create({header:"Checklist",message:"Favor de completar checklist para iniciar viaje ✅",buttons:[{text:"Previsualizar",role:"cancel",handler:()=>{M=!0,t(12,T=!0),F(!0)}},{text:"Completar",handler:()=>{M=!0,ge(E,s,o),F(!1)}}]})).present()}))})}function L(F){return i(this,void 0,void 0,function*(){if((yield me())&&(t(9,P=F),P==="map")){yield yt(),U=document.getElementById("g_map");const te=new google.maps.Map(U,{zoom:8,center:{lat:20.6745683,lng:-103.3986104},mapId:"4504f8b37365c3d0"}),pe=new google.maps.LatLngBounds,{AdvancedMarkerElement:Ne,PinElement:Pe}=yield google.maps.importLibrary("marker");navigator.geolocation?navigator.geolocation.getCurrentPosition(function(Te){const ze=new google.maps.LatLng(Te.coords.latitude,Te.coords.longitude);new google.maps.Marker({position:ze,map:te,icon:{path:google.maps.SymbolPath.CIRCLE,fillColor:"#0062ff",fillOpacity:1,scale:6,strokeColor:"#ffffff",strokeWeight:2}}),new google.maps.Circle({strokeColor:"#00BFFF",strokeOpacity:.5,strokeWeight:1,fillColor:"#00BFFF",fillOpacity:.2,map:te,center:ze,radius:Te.coords.accuracy}),pe.extend(ze)},function(Te){console.error("Error retrieving location:",Te)}):console.error("Geolocation not supported by this browser."),p.lat1===p.lat2&&p.lon1===p.lon2?oe(pe,te,{lat:p.lat2,lon:p.lon2,color:p.color,title:p.destination},{type:"icon",iconClass:"icon-home",title:"Origen/Destino",glyph:`0,${String(_.length+1)}`}):(oe(pe,te,{lat:p.lat1,lon:p.lon1,color:p.color,title:p.origin},{type:"icon",iconClass:"icon-home",title:"Origen",glyph:"0"}),oe(pe,te,{lat:p.lat2,lon:p.lon2,color:p.color,title:p.destination},{type:"icon",iconClass:"icon-flag",title:"Destino",glyph:String(_.length+1)})),_.forEach(Te=>{const ze=parseFloat(Te.lat),Ve=parseFloat(Te.lon),qe=new google.maps.LatLng(ze,Ve),Fe=new google.maps.Marker({position:{lat:ze,lng:Ve},map:te,title:Te.title}),je=new Pe({background:He(Te.status,Te.date_service),borderColor:"#000",glyphColor:"#000",glyph:(parseInt(Te.pos)+1).toString()});new Ne({map:te,position:qe,content:je.element,title:"Parada "+(parseInt(Te.pos)+1).toString()+": "+Te.title}).addListener("click",function(){se(Te,!1)}),pe.extend(Fe.getPosition())}),m.forEach(Te=>{const ze=+Te.lat,Ve=+Te.lng;if(isNaN(ze)||isNaN(Ve))return;const qe=A[Te.type]||"alert-sharp",Fe=document.createElement("div");Fe.style.cssText="display:flex;align-items:center;justify-content:center;transform:scale(.85);";const je=document.createElement("ion-icon");qe.startsWith("/")?je.setAttribute("src",qe):je.setAttribute("icon",qe),je.style.cssText="font-size:20px;color:#d13434;",Fe.appendChild(je);const it=new Pe({background:"#fff",borderColor:"#000",glyph:Fe}),Sn=new Ne({map:te,position:{lat:ze,lng:Ve},content:it.element,title:Te.motive||Te.type});pe.extend(Sn.position)}),te.fitBounds(pe)}})}function oe(F,ce,te,pe){return i(this,void 0,void 0,function*(){let Ne;const Pe=parseFloat(te.lat),Te=parseFloat(te.lon),ze=new google.maps.LatLng(Pe,Te),{AdvancedMarkerElement:Ve,PinElement:qe}=yield google.maps.importLibrary("marker");pe.type=="icon"?(Ne=document.createElement("i"),Ne.className=`${pe.iconClass} icon`,Ne.style.fontSize="14px",Ne.style.color=Ue(te.color),Ne.style.fontWeight="600"):pe.type=="text";const Fe=new google.maps.Marker({position:{lat:Pe,lng:Te},map:ce,title:`${pe.title}. ${te.title}`}),je=new qe({background:te.color,borderColor:"#000",glyphColor:Ue(te.color),glyph:pe.glyph});return new Ve({map:ce,position:ze,content:je.element,title:pe.title+": "+te.title}).addListener("click",function(){X(p,pe.title=="Destino"||pe.title=="Origen/Destino")}),Fe})}function re(F){return i(this,void 0,void 0,function*(){let ce=new FormData;ce.append("id_route",F),ce=Oe(ce),ce.append("id_enterprise",d.id_enterprise);try{const pe=yield(yield fetch(`${a}api/admin/report/seguimiento_list.php`,{method:"POST",body:ce})).json();t(6,p=pe.data.seguimiento_list[0]),t(5,_=pe.data.event_list),t(7,E=pe.data.checklist),O=pe.data.expenses,m=pe.data.incidence_list,p&&t(4,g=p.km_inicial=="0"&&p.gas_inicial=="0"),!M&&de()&&(yield me()),t(3,k=!1)}catch(te){t(3,k=!1),console.error("Error fetching data:",te)}})}const be=F=>new Promise((ce,te)=>{let pe=new FormData;pe.append("id_route",F.id_route),pe.append("id_event",F.id_event),pe=Oe(pe),fetch(`${a}api/admin/evidence/evidence_by_event.php`,{method:"POST",body:pe}).then(Ne=>Ne.json()).then(Ne=>{ce(Ne.data.event_evidence[0])}).catch(Ne=>{console.error("Error fetching data:",Ne),te(Ne)})});function se(F,ce,te){const pe=typeof te=="boolean"?te:!ie();return S||(S=i(this,void 0,void 0,function*(){let Ne=null;try{Ne=yield be(F)}catch{}const Pe=Object.assign(Object.assign(Object.assign({},F),{stopsApproval:x,smsActive:z,signatureActive:W}),Ne||{});try{yield Ye("modal-delivery-info",qt,{delivery:Pe,isLast:ce,readOnly:pe})}finally{S=null,re(o)}}),S)}const X=(F,ce)=>{let te={};ce?te={title:F.destination,line1:F.dest_address}:te={title:F.origin,line1:F.origin_address},te.enterprise_name=F.enterprise_name,te.client_name=F.client_name,te.client_phone=F.tel,te.id_route=F.id_route,te.stopsApproval=x,te.smsActive=z,Ye("modal-delivery-info",qt,{delivery:te,isLast:ce,flag:!0,readOnly:!ie()})},ge=(F,ce,te)=>(t(11,I=!0),D||(D=!0,Ye("modal-checklist",Mn,{checklist:F,driverId:ce,routeId:te,isLast:!1},{breakpoints:[.25,.5,.9],initialBreakpoint:.75,backdropBreakpoint:.25,handle:!0,handleBehavior:"cycle",canDismiss:!0,showBackdrop:!0}).then(()=>{t(11,I=!1),D=!1,re(te)})),""),_e=F=>i(void 0,void 0,void 0,function*(){return t(11,I=!0),yield re(F),O.length>0?Ye("modal-expense-detail",io,{routeId:F,expenses:O}).then(()=>{t(11,I=!1)}):Ye("modal-expense",Et,{routeId:F}).then(()=>{t(11,I=!1)}),""}),ae=F=>i(void 0,void 0,void 0,function*(){return t(11,I=!0),yield re(F),Ye("modal-incidence",Zi,{routeId:F}).then(()=>{t(11,I=!1)}),""}),ee=F=>{if(F.tracking_type=="subscription"){if(F.subscriber_info&&F.payment_type==="cash"&&new Date(F.subscriber_info.payment_next)<new Date)return!0}else if(F.tracking_type=="ecommerce"&&Number(F.payment_pending)>0)return!0;return!1},Ie=()=>{d.type=="super"||d.type=="admin"?at("/drivers/me"):d.id_driver&&at(`/drivers/${d.id_driver}`)},ke=(F,ce)=>i(void 0,void 0,void 0,function*(){yield(yield Qe.create({header:F||"Error",message:ce||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()});function Oe(F){return F.append("token",d.token),F.append("id_user_over",d.id_user),F}const Z=()=>i(void 0,void 0,void 0,function*(){if(d.id_enterprise){let F=new FormData;F.append("id_enterprise",d.id_enterprise),F=Oe(F);try{const ce=yield fetch(`${a}api/admin/enterprise/enterprise_settings.php`,{method:"POST",body:F});ce.ok?(B=(yield ce.json()).nodos,x=_t("stops_wait_approval",B),z=_t("sms_active",B),t(10,C=_t("stops_order_restriction",B)),W=_t("signature_active",B)):console.error("File upload failed:",ce.statusText)}catch(ce){console.error("Error during file upload:",ce)}}}),J=()=>ae(o),G=()=>_e(o),ue=F=>L(F.detail.value);function K(F){Be[F?"unshift":"push"](()=>{N=F,t(8,N)})}const ve=()=>{X(p,!1)},Me=F=>{const ce=_.findIndex(Te=>Te.id_event===F.id_event),te=ce===0,pe=ce>0?_[ce-1]:null,Ne=te||pe&&pe.img!==null,Pe=F.img!==null&&F.img!=="";Ne||te&&!Pe||C=="1"?se(F,!1):ke("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")},De=()=>{X(p,!0)};function Se(F){Be[F?"unshift":"push"](()=>{N=F,t(8,N)})}const Le=()=>{X(p,!1)},q=F=>{const ce=_.findIndex(Te=>Te.id_event===F.id_event),te=ce===0,pe=ce>0?_[ce-1]:null,Ne=te||pe&&pe.img!==null,Pe=F.img!==null&&F.img!=="";Ne||te&&!Pe||C=="1"?se(F,!1):ke("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")},he=()=>{X(p,!0)};function H(F){Be[F?"unshift":"push"](()=>{N=F,t(8,N)})}const j=()=>{X(p,!1)},Y=F=>{const ce=_.findIndex(Te=>Te.id_event===F.id_event),te=ce===0,pe=ce>0?_[ce-1]:null,Ne=te||pe&&pe.img!==null,Pe=F.img!==null&&F.img!=="";Ne||te&&!Pe||C=="1"?se(F,!1):ke("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")},Q=()=>{X(p,!0)},Ee=()=>ge(E,s,o);return l.$$set=F=>{"routeId"in F&&t(0,o=F.routeId),"driverId"in F&&t(1,s=F.driverId)},l.$$.update=()=>{l.$$.dirty[0]&16777221&&(t(0,{routeId:o,driverId:s}=n.params,o,(t(1,s),t(24,n),t(2,d),t(0,o))),t(2,d=JSON.parse(localStorage.getItem("userSession"))),d?d.id_user&&(d.type=="admin"||d.type=="super")?(re(o),at(`/drivers/me/routes/${o}`)):d.id_user&&d.id_driver&&(re(o),at(`/drivers/${d.id_driver}/routes/${o}`)):at("/"))},[o,s,d,k,g,_,p,E,N,P,C,I,T,$,de,L,se,X,ge,_e,ae,ee,Ie,ke,n,J,G,ue,K,ve,Me,De,Se,Le,q,he,H,j,Y,Q,Ee]}class Lo extends tt{constructor(e){super(),nt(this,e,Eo,go,et,{routeId:0,driverId:1},null,[-1,-1,-1])}}export{Lo as component};

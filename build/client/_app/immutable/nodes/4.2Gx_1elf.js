import{s as ve,j as R,k as B,l as be,h as c,m as C,i as I,p as ke,o as ge,e as m,t as U,b as v,q as E,r as V,d as $,v as F,w as f,x as ee,y as Q,z as Ee,A as Ie,n as ie,f as P,B as G,C as _e}from"../chunks/index.BYLndrM5.js";import{S as ye,i as Ne,t as x,a as oe,c as Ae,b as Oe,d as Te,m as De,e as Se,g as we}from"../chunks/index.BNHbygFo.js";import{l as Le,p as Re,e as te,u as de,d as he}from"../chunks/index.CbKYbuMa.js";import"../chunks/index-48209844.IIRtDZyg.js";import{I as Ce,a as Be,D as He}from"../chunks/IonPage.WzIZPeBc.js";import{g as W}from"../chunks/entry.Cx3P4KtL.js";function re(t,e,o){const l=t.slice();return l[19]=e[o],l}function se(t,e,o){const l=t.slice();return l[19]=e[o],l}function ae(t){let e,o;return e=new Ce({props:{$$slots:{default:[Je]},$$scope:{ctx:t}}}),{c(){Oe(e.$$.fragment)},l(l){Te(e.$$.fragment,l)},m(l,n){De(e,l,n),o=!0},p(l,n){const a={};n&16777279&&(a.$$scope={dirty:n,ctx:l}),e.$set(a)},i(l){o||(x(e.$$.fragment,l),o=!0)},o(l){oe(e.$$.fragment,l),o=!1},d(l){Se(e,l)}}}function Me(t){let e=[],o=new Map,l,n=te(t[2].filter(t[13]));const a=i=>i[19].id_route;for(let i=0;i<n.length;i+=1){let r=re(t,n,i),s=a(r);o.set(s,e[i]=ue(s,r))}return{c(){for(let i=0;i<e.length;i+=1)e[i].c();l=B()},l(i){for(let r=0;r<e.length;r+=1)e[r].l(i);l=B()},m(i,r){for(let s=0;s<e.length;s+=1)e[s]&&e[s].m(i,r);I(i,l,r)},p(i,r){r&901&&(n=te(i[2].filter(i[13])),e=de(e,r,a,1,i,n,o,l.parentNode,he,ue,l,re))},d(i){i&&c(l);for(let r=0;r<e.length;r+=1)e[r].d(i)}}}function Pe(t){let e=[],o=new Map,l,n=te(t[2]);const a=i=>i[19].id_route;for(let i=0;i<n.length;i+=1){let r=se(t,n,i),s=a(r);o.set(s,e[i]=ce(s,r))}return{c(){for(let i=0;i<e.length;i+=1)e[i].c();l=B()},l(i){for(let r=0;r<e.length;r+=1)e[r].l(i);l=B()},m(i,r){for(let s=0;s<e.length;s+=1)e[s]&&e[s].m(i,r);I(i,l,r)},p(i,r){r&900&&(n=te(i[2]),e=de(e,r,a,1,i,n,o,l.parentNode,he,ce,l,se))},d(i){i&&c(l);for(let r=0;r<e.length;r+=1)e[r].d(i)}}}function Ue(t){let e=t[8]("false")+"",o;return{c(){o=U(e)},l(l){o=V(l,e)},m(l,n){I(l,o,n)},p:ie,d(l){l&&c(o)}}}function Ve(t){let e=t[8]("true")+"",o,l,n;function a(s,u){return s[19].status!="completed"&&s[19].status!="cancelled"?ze:qe}let i=a(t),r=i(t);return{c(){o=U(e),l=R(),r.c(),n=B()},l(s){o=V(s,e),l=C(s),r.l(s),n=B()},m(s,u){I(s,o,u),I(s,l,u),r.m(s,u),I(s,n,u)},p(s,u){i===(i=a(s))&&r?r.p(s,u):(r.d(1),r=i(s),r&&(r.c(),r.m(n.parentNode,n)))},d(s){s&&(c(o),c(l),c(n)),r.d(s)}}}function qe(t){let e=t[8]("false")+"",o;return{c(){o=U(e)},l(l){o=V(l,e)},m(l,n){I(l,o,n)},p:ie,d(l){l&&c(o)}}}function ze(t){let e,o,l,n,a=t[9](t[19].name.charAt(0))+"",i,r,s,u,A,O=t[19].name+"",b,M,y,T,k=t[19].date_start+"",S,q,g,d,w,H;return{c(){e=m("ion-item"),o=m("ion-avatar"),l=m("div"),n=m("div"),i=U(a),s=R(),u=m("ion-label"),A=m("h2"),b=U(O),M=R(),y=m("h3"),T=U("Inicio: "),S=U(k),q=R(),g=m("div"),d=R(),this.h()},l(N){e=v(N,"ION-ITEM",{button:!0});var p=E(e);o=v(p,"ION-AVATAR",{slot:!0});var L=E(o);l=v(L,"DIV",{class:!0,style:!0,title:!0});var h=E(l);n=v(h,"DIV",{class:!0,style:!0});var _=E(n);i=V(_,a),_.forEach(c),h.forEach(c),L.forEach(c),s=C(p),u=v(p,"ION-LABEL",{});var D=E(u);A=v(D,"H2",{});var z=E(A);b=V(z,O),z.forEach(c),M=C(D),y=v(D,"H3",{class:!0});var j=E(y);T=V(j,"Inicio: "),S=V(j,k),j.forEach(c),D.forEach(c),q=C(p),g=v(p,"DIV",{slot:!0}),E(g).forEach(c),d=C(p),p.forEach(c),this.h()},h(){P(n,"class","route-symbol svelte-1xh3ip"),P(n,"style",""),P(l,"class","route-color svelte-1xh3ip"),G(l,"background-color",Y(t[19].status)),G(l,"color",ne(Y(t[19].status))),P(l,"title",r=le(t[19].status)),F(o,"slot","start"),P(y,"class","text-muted svelte-1xh3ip"),P(g,"slot","end"),F(e,"button","")},m(N,p){I(N,e,p),f(e,o),f(o,l),f(l,n),f(n,i),f(e,s),f(e,u),f(u,A),f(A,b),f(u,M),f(u,y),f(y,T),f(y,S),f(e,q),f(e,g),f(e,d),w||(H=ee(e,"click",function(){_e(t[7](t[19].id_route,t[19].status))&&t[7](t[19].id_route,t[19].status).apply(this,arguments)}),w=!0)},p(N,p){t=N,p&5&&a!==(a=t[9](t[19].name.charAt(0))+"")&&Q(i,a),p&5&&G(l,"background-color",Y(t[19].status)),p&5&&G(l,"color",ne(Y(t[19].status))),p&5&&r!==(r=le(t[19].status))&&P(l,"title",r),p&5&&O!==(O=t[19].name+"")&&Q(b,O),p&5&&k!==(k=t[19].date_start+"")&&Q(S,k)},d(N){N&&c(e),w=!1,H()}}}function ue(t,e){let o,l,n;function a(s,u){return u&5&&(l=null),l==null&&(l=!!pe(s[19].date_start)),l?Ve:Ue}let i=a(e,-1),r=i(e);return{key:t,first:null,c(){o=B(),r.c(),n=B(),this.h()},l(s){o=B(),r.l(s),n=B(),this.h()},h(){this.first=o},m(s,u){I(s,o,u),r.m(s,u),I(s,n,u)},p(s,u){e=s,i===(i=a(e,u))&&r?r.p(e,u):(r.d(1),r=i(e),r&&(r.c(),r.m(n.parentNode,n)))},d(s){s&&(c(o),c(n)),r.d(s)}}}function Fe(t){let e=t[8]("false")+"",o;return{c(){o=U(e)},l(l){o=V(l,e)},m(l,n){I(l,o,n)},p:ie,d(l){l&&c(o)}}}function je(t){let e=t[8]("true")+"",o,l,n,a,i,r,s=t[9](t[19].name.charAt(0))+"",u,A,O,b,M,y=(t[19].name?t[19].name.toUpperCase():"")+"",T,k,S,q,g=t[19].date_start+"",d,w,H,N,p,L;return{c(){o=U(e),l=R(),n=m("ion-item"),a=m("ion-avatar"),i=m("div"),r=m("div"),u=U(s),O=R(),b=m("ion-label"),M=m("h2"),T=U(y),k=R(),S=m("h3"),q=U("Inicio: "),d=U(g),w=R(),H=m("div"),N=R(),this.h()},l(h){o=V(h,e),l=C(h),n=v(h,"ION-ITEM",{button:!0});var _=E(n);a=v(_,"ION-AVATAR",{slot:!0});var D=E(a);i=v(D,"DIV",{class:!0,style:!0,title:!0});var z=E(i);r=v(z,"DIV",{class:!0,style:!0});var j=E(r);u=V(j,s),j.forEach(c),z.forEach(c),D.forEach(c),O=C(_),b=v(_,"ION-LABEL",{});var K=E(b);M=v(K,"H2",{});var X=E(M);T=V(X,y),X.forEach(c),k=C(K),S=v(K,"H3",{class:!0});var J=E(S);q=V(J,"Inicio: "),d=V(J,g),J.forEach(c),K.forEach(c),w=C(_),H=v(_,"DIV",{slot:!0}),E(H).forEach(c),N=C(_),_.forEach(c),this.h()},h(){P(r,"class","route-symbol svelte-1xh3ip"),P(r,"style",""),P(i,"class","route-color svelte-1xh3ip"),G(i,"background-color",Y(t[19].status)),G(i,"color",ne(Y(t[19].status))),P(i,"title",A=le(t[19].status)),F(a,"slot","start"),P(S,"class","text-muted svelte-1xh3ip"),P(H,"slot","end"),F(n,"button","")},m(h,_){I(h,o,_),I(h,l,_),I(h,n,_),f(n,a),f(a,i),f(i,r),f(r,u),f(n,O),f(n,b),f(b,M),f(M,T),f(b,k),f(b,S),f(S,q),f(S,d),f(n,w),f(n,H),f(n,N),p||(L=ee(n,"click",function(){_e(t[7](t[19].id_route,t[19].status))&&t[7](t[19].id_route,t[19].status).apply(this,arguments)}),p=!0)},p(h,_){t=h,_&4&&s!==(s=t[9](t[19].name.charAt(0))+"")&&Q(u,s),_&4&&G(i,"background-color",Y(t[19].status)),_&4&&G(i,"color",ne(Y(t[19].status))),_&4&&A!==(A=le(t[19].status))&&P(i,"title",A),_&4&&y!==(y=(t[19].name?t[19].name.toUpperCase():"")+"")&&Q(T,y),_&4&&g!==(g=t[19].date_start+"")&&Q(d,g)},d(h){h&&(c(o),c(l),c(n)),p=!1,L()}}}function ce(t,e){let o,l,n;function a(s,u){return u&4&&(l=null),l==null&&(l=!!pe(s[19].date_start)),l?je:Fe}let i=a(e,-1),r=i(e);return{key:t,first:null,c(){o=B(),r.c(),n=B(),this.h()},l(s){o=B(),r.l(s),n=B(),this.h()},h(){this.first=o},m(s,u){I(s,o,u),r.m(s,u),I(s,n,u)},p(s,u){e=s,i===(i=a(e,u))&&r?r.p(e,u):(r.d(1),r=i(e),r&&(r.c(),r.m(n.parentNode,n)))},d(s){s&&(c(o),c(n)),r.d(s)}}}function fe(t){let e,o='<ion-row class="h-full items-center"><ion-col class="text-center"><h2 class="text-3xl text-muted mb-4 svelte-1xh3ip">No hay rutas pendientes para hoy</h2> <p class="text-muted svelte-1xh3ip">Espere indicaciones de su supervisor</p></ion-col></ion-row>';return{c(){e=m("ion-grid"),e.innerHTML=o,this.h()},l(l){e=v(l,"ION-GRID",{class:!0,"data-svelte-h":!0}),$(e)!=="svelte-3d9uou"&&(e.innerHTML=o),this.h()},h(){F(e,"class","ion-text-center h-full")},m(l,n){I(l,e,n)},d(l){l&&c(e)}}}function Je(t){let e,o,l,n,a=t[1].name+"",i,r,s,u="RUTAS DEL DÍA",A,O,b,M=`<ion-icon icon="${Le}"></ion-icon>`,y,T,k,S='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Jale para actualizar" refreshing-spinner="circles" refreshing-text="Actualizando..."></ion-refresher-content>',q,g,d,w,H;function N(_,D){return _[0]=="me"&&_[4]?Pe:Me}let p=N(t),L=p(t),h=!t[3]&&fe();return{c(){e=m("ion-header"),o=m("ion-toolbar"),l=m("ion-buttons"),n=m("ion-button"),i=U(a),r=R(),s=m("ion-title"),s.textContent=u,A=R(),O=m("ion-buttons"),b=m("ion-button"),b.innerHTML=M,y=R(),T=m("ion-content"),k=m("ion-refresher"),k.innerHTML=S,q=R(),g=m("ion-list"),L.c(),d=R(),h&&h.c(),this.h()},l(_){e=v(_,"ION-HEADER",{translucent:!0});var D=E(e);o=v(D,"ION-TOOLBAR",{});var z=E(o);l=v(z,"ION-BUTTONS",{slot:!0});var j=E(l);n=v(j,"ION-BUTTON",{});var K=E(n);i=V(K,a),K.forEach(c),j.forEach(c),r=C(z),s=v(z,"ION-TITLE",{"data-svelte-h":!0}),$(s)!=="svelte-1oi1i0m"&&(s.textContent=u),A=C(z),O=v(z,"ION-BUTTONS",{slot:!0});var X=E(O);b=v(X,"ION-BUTTON",{title:!0,alt:!0,"data-svelte-h":!0}),$(b)!=="svelte-1itonhq"&&(b.innerHTML=M),X.forEach(c),z.forEach(c),D.forEach(c),y=C(_),T=v(_,"ION-CONTENT",{});var J=E(T);k=v(J,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),$(k)!=="svelte-1wkherr"&&(k.innerHTML=S),q=C(J),g=v(J,"ION-LIST",{});var Z=E(g);L.l(Z),d=C(Z),h&&h.l(Z),Z.forEach(c),J.forEach(c),this.h()},h(){F(l,"slot","secondary"),F(b,"title","Salir"),F(b,"alt","Salir"),F(O,"slot","primary"),F(e,"translucent",""),F(k,"slot","fixed")},m(_,D){I(_,e,D),f(e,o),f(o,l),f(l,n),f(n,i),f(o,r),f(o,s),f(o,A),f(o,O),f(O,b),I(_,y,D),I(_,T,D),f(T,k),t[12](k),f(T,q),f(T,g),L.m(g,null),f(g,d),h&&h.m(g,null),w||(H=[ee(b,"click",t[10]),ee(k,"ionRefresh",t[6])],w=!0)},p(_,D){D&2&&a!==(a=_[1].name+"")&&Q(i,a),p===(p=N(_))&&L?L.p(_,D):(L.d(1),L=p(_),L&&(L.c(),L.m(g,d))),_[3]?h&&(h.d(1),h=null):h||(h=fe(),h.c(),h.m(g,null))},d(_){_&&(c(e),c(y),c(T)),t[12](null),L.d(),h&&h.d(),w=!1,Ee(H)}}}function Ge(t){let e,o,l,n=t[1]&&ae(t);return{c(){e=R(),n&&n.c(),o=B(),this.h()},l(a){be("svelte-qavk4j",document.head).forEach(c),e=C(a),n&&n.l(a),o=B(),this.h()},h(){document.title="Rutas - Rutaflow"},m(a,i){I(a,e,i),n&&n.m(a,i),I(a,o,i),l=!0},p(a,[i]){a[1]?n?(n.p(a,i),i&2&&x(n,1)):(n=ae(a),n.c(),x(n,1),n.m(o.parentNode,o)):n&&(we(),oe(n,1,1,()=>{n=null}),Ae())},i(a){l||(x(n),l=!0)},o(a){oe(n),l=!1},d(a){a&&(c(e),c(o)),n&&n.d(a)}}}function pe(t){var e=me();const o=t.split(" ")[0];return e===o}function Y(t){let e="#ffffff";return t==="pending"?e="#FAD733":t==="completed"?e="#27C24C":t=="enroute"?e="#3BBAC2":t=="paused"?e="#949DB9":t=="cancelled"?e="#F05050":t=="checklist"?e="#F6A833":t=="checklist-pending"&&(e="#E98C00"),e}function le(t){let e="";return t==="pending"?e="Pendiente":t==="completed"?e="Completado":t=="enroute"?e="En ruta":t=="paused"?e="Pausado":t=="cancelled"?e="Cancelado":t=="checklist"?e="En checklist":t=="checklist-pending"&&(e="Pendiente de aprobar checklist"),e}function ne(t){t.slice(0,1)==="#"&&(t=t.slice(1)),t.length===3&&(t=t.split("").map(function(a){return a+a}).join(""));const e=parseInt(t.substr(0,2),16),o=parseInt(t.substr(2,2),16),l=parseInt(t.substr(4,2),16);return(e*299+o*587+l*114)/1e3>=128?"#414040":"#fff"}function me(){var t=new Date,e=t.getDate(),o=t.getMonth()+1,l=t.getFullYear();return e<10&&(e="0"+e),o<10&&(o="0"+o),t=l+"-"+o+"-"+e,t}function Ye(t,e,o){let l;ke(t,Re,d=>o(11,l=d));let{driverId:n}=e,a=He,i=[],r=!1,s=!1,u=new Object,A;const O=async()=>{await b(),A.complete()};ge(async()=>{O()});function b(d){var w=me();const H=new FormData;H.append("actual_date",w),fetch(`${a}api/admin/report/seguimiento_list.php`,{method:"POST",body:H}).then(N=>N.json()).then(N=>{const p=N;o(2,i=p.data.seguimiento_list),p.data.event_list}).catch(N=>{console.error("Error fetching data:",N)})}function M(d,w){w=="checklist-pending"?k("Checklist Pendiente de Autorizar","La lista de requerimientos de ruta está en revisión, podrás inciar la ruta una vez autorizado el checklist."):W(`/drivers/${n}/routes/${d}`)}function y(d){return d=="true"?o(3,r=!0):o(3,r=!1),""}const T=d=>d.charAt(0).toUpperCase()+d.slice(1),k=async(d,w)=>{await(await Be.create({header:d||"Error",message:w||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()},S=()=>{W("/"),o(4,s=!1),localStorage.removeItem("userSession")};function q(d){Ie[d?"unshift":"push"](()=>{A=d,o(5,A)})}const g=d=>d.id_driver===n;return t.$$set=d=>{"driverId"in d&&o(0,n=d.driverId)},t.$$.update=()=>{if(t.$$.dirty&2051){o(0,{driverId:n}=l.params,n);const d=localStorage.getItem("userSession");o(1,u=JSON.parse(d)),u?n=="me"&&u.id_user?u.type=="admin"||u.type=="superadmin"?(W("/drivers/me"),b(),o(4,s=!0)):(k("Usuario no autorizado","Este usuario no tiene acceso a la app de Rutaflow, entrar en contacto con soporte"),W("/")):u&&n&&(W(`/drivers/${u.id_driver}`),b()):(k("Sesión cerrada","Será redireccionado para volver a ingresar"),W("/"))}},[n,u,i,r,s,A,O,M,y,T,S,l,q,g]}class xe extends ye{constructor(e){super(),Ne(this,e,Ye,Ge,ve,{driverId:0})}}export{xe as component};

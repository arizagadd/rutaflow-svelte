import{s as ke,b as ge,r as Ie,d as Ee,n as de,i as he}from"../chunks/index.CP94t5tW.js";import{S as ye,i as Ne,s as R,h as w,j as Oe,f as u,k as L,d as I,t as X,a as le,l as Te,m as we,n as Se,o as Ae,p as De,e as h,q as B,c as p,r as b,u as C,g as Z,v as z,w as c,x as $,y as Y,z as Re,b as P,A as J}from"../chunks/index.BB8175xn.js";import{l as Le,p as He,e as x,u as pe,d as me}from"../chunks/index.DDw-d3HU.js";import"../chunks/index-48209844.IIRtDZyg.js";import{I as Me,a as Ve}from"../chunks/IonPage.bGG8reFV.js";import{g as K}from"../chunks/entry.BHCvmyTg.js";import"../chunks/authStore.Dl96eK1q.js";function ie(t,e,i){const l=t.slice();return l[19]=e[i],l}function re(t,e,i){const l=t.slice();return l[19]=e[i],l}function se(t){let e,i;return e=new Me({props:{$$slots:{default:[ze]},$$scope:{ctx:t}}}),{c(){we(e.$$.fragment)},l(l){Se(e.$$.fragment,l)},m(l,n){Ae(e,l,n),i=!0},p(l,n){const s={};n&16777279&&(s.$$scope={dirty:n,ctx:l}),e.$set(s)},i(l){i||(X(e.$$.fragment,l),i=!0)},o(l){le(e.$$.fragment,l),i=!1},d(l){De(e,l)}}}function Pe(t){let e=[],i=new Map,l,n=x(t[2].filter(t[13]));const s=o=>o[19].id_route;for(let o=0;o<n.length;o+=1){let r=ie(t,n,o),a=s(r);i.set(a,e[o]=ue(a,r))}return{c(){for(let o=0;o<e.length;o+=1)e[o].c();l=w()},l(o){for(let r=0;r<e.length;r+=1)e[r].l(o);l=w()},m(o,r){for(let a=0;a<e.length;a+=1)e[a]&&e[a].m(o,r);I(o,l,r)},p(o,r){r&901&&(n=x(o[2].filter(o[13])),e=pe(e,r,s,1,o,n,i,l.parentNode,me,ue,l,ie))},d(o){o&&u(l);for(let r=0;r<e.length;r+=1)e[r].d(o)}}}function qe(t){let e=[],i=new Map,l,n=x(t[2]);const s=o=>o[19].id_route;for(let o=0;o<n.length;o+=1){let r=re(t,n,o),a=s(r);i.set(a,e[o]=ce(a,r))}return{c(){for(let o=0;o<e.length;o+=1)e[o].c();l=w()},l(o){for(let r=0;r<e.length;r+=1)e[r].l(o);l=w()},m(o,r){for(let a=0;a<e.length;a+=1)e[a]&&e[a].m(o,r);I(o,l,r)},p(o,r){r&900&&(n=x(o[2]),e=pe(e,r,s,1,o,n,i,l.parentNode,me,ce,l,re))},d(o){o&&u(l);for(let r=0;r<e.length;r+=1)e[r].d(o)}}}function Be(t){let e=t[8]("false")+"",i;return{c(){i=B(e)},l(l){i=C(l,e)},m(l,n){I(l,i,n)},p:de,d(l){l&&u(i)}}}function Ce(t){let e=t[8]("true")+"",i,l,n,s=t[19].status!="completed"&&ae(t);return{c(){i=B(e),l=R(),s&&s.c(),n=w()},l(o){i=C(o,e),l=L(o),s&&s.l(o),n=w()},m(o,r){I(o,i,r),I(o,l,r),s&&s.m(o,r),I(o,n,r)},p(o,r){o[19].status!="completed"?s?s.p(o,r):(s=ae(o),s.c(),s.m(n.parentNode,n)):s&&(s.d(1),s=null)},d(o){o&&(u(i),u(l),u(n)),s&&s.d(o)}}}function ae(t){let e,i,l,n,s=t[9](t[19].name.charAt(0))+"",o,r,a,_,S,k=t[19].name+"",E,U,g,T,v=t[19].date_start+"",M,q,f,D,H,V;return{c(){e=h("ion-item"),i=h("ion-avatar"),l=h("div"),n=h("div"),o=B(s),a=R(),_=h("ion-label"),S=h("h2"),E=B(k),U=R(),g=h("h3"),T=B("Inicio: "),M=B(v),q=R(),f=h("div"),D=R(),this.h()},l(y){e=p(y,"ION-ITEM",{button:!0});var d=b(e);i=p(d,"ION-AVATAR",{slot:!0});var A=b(i);l=p(A,"DIV",{class:!0,style:!0,title:!0});var N=b(l);n=p(N,"DIV",{class:!0,style:!0});var m=b(n);o=C(m,s),m.forEach(u),N.forEach(u),A.forEach(u),a=L(d),_=p(d,"ION-LABEL",{});var O=b(_);S=p(O,"H2",{});var j=b(S);E=C(j,k),j.forEach(u),U=L(O),g=p(O,"H3",{class:!0});var F=b(g);T=C(F,"Inicio: "),M=C(F,v),F.forEach(u),O.forEach(u),q=L(d),f=p(d,"DIV",{slot:!0}),b(f).forEach(u),D=L(d),d.forEach(u),this.h()},h(){P(n,"class","route-symbol svelte-1xh3ip"),P(n,"style",""),P(l,"class","route-color svelte-1xh3ip"),J(l,"background-color",G(t[19].status)),J(l,"color",te(G(t[19].status))),P(l,"title",r=ee(t[19].status)),z(i,"slot","start"),P(g,"class","text-muted svelte-1xh3ip"),P(f,"slot","end"),z(e,"button","")},m(y,d){I(y,e,d),c(e,i),c(i,l),c(l,n),c(n,o),c(e,a),c(e,_),c(_,S),c(S,E),c(_,U),c(_,g),c(g,T),c(g,M),c(e,q),c(e,f),c(e,D),H||(V=$(e,"click",function(){he(t[7](t[19].id_route))&&t[7](t[19].id_route).apply(this,arguments)}),H=!0)},p(y,d){t=y,d&5&&s!==(s=t[9](t[19].name.charAt(0))+"")&&Y(o,s),d&5&&J(l,"background-color",G(t[19].status)),d&5&&J(l,"color",te(G(t[19].status))),d&5&&r!==(r=ee(t[19].status))&&P(l,"title",r),d&5&&k!==(k=t[19].name+"")&&Y(E,k),d&5&&v!==(v=t[19].date_start+"")&&Y(M,v)},d(y){y&&u(e),H=!1,V()}}}function ue(t,e){let i,l,n;function s(a,_){return _&5&&(l=null),l==null&&(l=!!ve(a[19].date_start)),l?Ce:Be}let o=s(e,-1),r=o(e);return{key:t,first:null,c(){i=w(),r.c(),n=w(),this.h()},l(a){i=w(),r.l(a),n=w(),this.h()},h(){this.first=i},m(a,_){I(a,i,_),r.m(a,_),I(a,n,_)},p(a,_){e=a,o===(o=s(e,_))&&r?r.p(e,_):(r.d(1),r=o(e),r&&(r.c(),r.m(n.parentNode,n)))},d(a){a&&(u(i),u(n)),r.d(a)}}}function Ue(t){let e=t[8]("false")+"",i;return{c(){i=B(e)},l(l){i=C(l,e)},m(l,n){I(l,i,n)},p:de,d(l){l&&u(i)}}}function je(t){let e=t[8]("true")+"",i,l,n,s=t[19].status!="completed"&&fe(t);return{c(){i=B(e),l=R(),s&&s.c(),n=w()},l(o){i=C(o,e),l=L(o),s&&s.l(o),n=w()},m(o,r){I(o,i,r),I(o,l,r),s&&s.m(o,r),I(o,n,r)},p(o,r){o[19].status!="completed"?s?s.p(o,r):(s=fe(o),s.c(),s.m(n.parentNode,n)):s&&(s.d(1),s=null)},d(o){o&&(u(i),u(l),u(n)),s&&s.d(o)}}}function fe(t){let e,i,l,n,s=t[9](t[19].name.charAt(0))+"",o,r,a,_,S,k=t[19].name+"",E,U,g,T,v=t[19].date_start+"",M,q,f,D,H,V;return{c(){e=h("ion-item"),i=h("ion-avatar"),l=h("div"),n=h("div"),o=B(s),a=R(),_=h("ion-label"),S=h("h2"),E=B(k),U=R(),g=h("h3"),T=B("Inicio: "),M=B(v),q=R(),f=h("div"),D=R(),this.h()},l(y){e=p(y,"ION-ITEM",{button:!0});var d=b(e);i=p(d,"ION-AVATAR",{slot:!0});var A=b(i);l=p(A,"DIV",{class:!0,style:!0,title:!0});var N=b(l);n=p(N,"DIV",{class:!0,style:!0});var m=b(n);o=C(m,s),m.forEach(u),N.forEach(u),A.forEach(u),a=L(d),_=p(d,"ION-LABEL",{});var O=b(_);S=p(O,"H2",{});var j=b(S);E=C(j,k),j.forEach(u),U=L(O),g=p(O,"H3",{class:!0});var F=b(g);T=C(F,"Inicio: "),M=C(F,v),F.forEach(u),O.forEach(u),q=L(d),f=p(d,"DIV",{slot:!0}),b(f).forEach(u),D=L(d),d.forEach(u),this.h()},h(){P(n,"class","route-symbol svelte-1xh3ip"),P(n,"style",""),P(l,"class","route-color svelte-1xh3ip"),J(l,"background-color",G(t[19].status)),J(l,"color",te(G(t[19].status))),P(l,"title",r=ee(t[19].status)),z(i,"slot","start"),P(g,"class","text-muted svelte-1xh3ip"),P(f,"slot","end"),z(e,"button","")},m(y,d){I(y,e,d),c(e,i),c(i,l),c(l,n),c(n,o),c(e,a),c(e,_),c(_,S),c(S,E),c(_,U),c(_,g),c(g,T),c(g,M),c(e,q),c(e,f),c(e,D),H||(V=$(e,"click",function(){he(t[7](t[19].id_route))&&t[7](t[19].id_route).apply(this,arguments)}),H=!0)},p(y,d){t=y,d&4&&s!==(s=t[9](t[19].name.charAt(0))+"")&&Y(o,s),d&4&&J(l,"background-color",G(t[19].status)),d&4&&J(l,"color",te(G(t[19].status))),d&4&&r!==(r=ee(t[19].status))&&P(l,"title",r),d&4&&k!==(k=t[19].name+"")&&Y(E,k),d&4&&v!==(v=t[19].date_start+"")&&Y(M,v)},d(y){y&&u(e),H=!1,V()}}}function ce(t,e){let i,l,n;function s(a,_){return _&4&&(l=null),l==null&&(l=!!ve(a[19].date_start)),l?je:Ue}let o=s(e,-1),r=o(e);return{key:t,first:null,c(){i=w(),r.c(),n=w(),this.h()},l(a){i=w(),r.l(a),n=w(),this.h()},h(){this.first=i},m(a,_){I(a,i,_),r.m(a,_),I(a,n,_)},p(a,_){e=a,o===(o=s(e,_))&&r?r.p(e,_):(r.d(1),r=o(e),r&&(r.c(),r.m(n.parentNode,n)))},d(a){a&&(u(i),u(n)),r.d(a)}}}function _e(t){let e,i='<ion-row class="h-full items-center"><ion-col class="text-center"><h2 class="text-3xl text-muted mb-4 svelte-1xh3ip">No hay rutas pendientes para hoy</h2> <p class="text-muted svelte-1xh3ip">Espere indicaciones de su supervisor</p></ion-col></ion-row>';return{c(){e=h("ion-grid"),e.innerHTML=i,this.h()},l(l){e=p(l,"ION-GRID",{class:!0,"data-svelte-h":!0}),Z(e)!=="svelte-3d9uou"&&(e.innerHTML=i),this.h()},h(){z(e,"class","ion-text-center h-full")},m(l,n){I(l,e,n)},d(l){l&&u(e)}}}function ze(t){let e,i,l,n,s=t[1].name+"",o,r,a,_="Rutas del día",S,k,E,U=`<ion-icon icon="${Le}"></ion-icon>`,g,T,v,M='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Jale para actualizar" refreshing-spinner="circles" refreshing-text="Actualizando..."></ion-refresher-content>',q,f,D,H,V;function y(m,O){return m[0]=="me"&&m[4]?qe:Pe}let d=y(t),A=d(t),N=!t[3]&&_e();return{c(){e=h("ion-header"),i=h("ion-toolbar"),l=h("ion-buttons"),n=h("ion-button"),o=B(s),r=R(),a=h("ion-title"),a.textContent=_,S=R(),k=h("ion-buttons"),E=h("ion-button"),E.innerHTML=U,g=R(),T=h("ion-content"),v=h("ion-refresher"),v.innerHTML=M,q=R(),f=h("ion-list"),A.c(),D=R(),N&&N.c(),this.h()},l(m){e=p(m,"ION-HEADER",{translucent:!0});var O=b(e);i=p(O,"ION-TOOLBAR",{});var j=b(i);l=p(j,"ION-BUTTONS",{slot:!0});var F=b(l);n=p(F,"ION-BUTTON",{});var oe=b(n);o=C(oe,s),oe.forEach(u),F.forEach(u),r=L(j),a=p(j,"ION-TITLE",{"data-svelte-h":!0}),Z(a)!=="svelte-82wrsm"&&(a.textContent=_),S=L(j),k=p(j,"ION-BUTTONS",{slot:!0});var ne=b(k);E=p(ne,"ION-BUTTON",{title:!0,alt:!0,"data-svelte-h":!0}),Z(E)!=="svelte-1itonhq"&&(E.innerHTML=U),ne.forEach(u),j.forEach(u),O.forEach(u),g=L(m),T=p(m,"ION-CONTENT",{});var Q=b(T);v=p(Q,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),Z(v)!=="svelte-1wkherr"&&(v.innerHTML=M),q=L(Q),f=p(Q,"ION-LIST",{});var W=b(f);A.l(W),D=L(W),N&&N.l(W),W.forEach(u),Q.forEach(u),this.h()},h(){z(l,"slot","secondary"),z(E,"title","Salir"),z(E,"alt","Salir"),z(k,"slot","primary"),z(e,"translucent",""),z(v,"slot","fixed")},m(m,O){I(m,e,O),c(e,i),c(i,l),c(l,n),c(n,o),c(i,r),c(i,a),c(i,S),c(i,k),c(k,E),I(m,g,O),I(m,T,O),c(T,v),t[12](v),c(T,q),c(T,f),A.m(f,null),c(f,D),N&&N.m(f,null),H||(V=[$(E,"click",t[10]),$(v,"ionRefresh",t[6])],H=!0)},p(m,O){O&2&&s!==(s=m[1].name+"")&&Y(o,s),d===(d=y(m))&&A?A.p(m,O):(A.d(1),A=d(m),A&&(A.c(),A.m(f,D))),m[3]?N&&(N.d(1),N=null):N||(N=_e(),N.c(),N.m(f,null))},d(m){m&&(u(e),u(g),u(T)),t[12](null),A.d(),N&&N.d(),H=!1,Ie(V)}}}function Fe(t){let e,i,l,n=t[1]&&se(t);return{c(){e=R(),n&&n.c(),i=w(),this.h()},l(s){Oe("svelte-qavk4j",document.head).forEach(u),e=L(s),n&&n.l(s),i=w(),this.h()},h(){document.title="Rutas - Rutaflow"},m(s,o){I(s,e,o),n&&n.m(s,o),I(s,i,o),l=!0},p(s,[o]){s[1]?n?(n.p(s,o),o&2&&X(n,1)):(n=se(s),n.c(),X(n,1),n.m(i.parentNode,i)):n&&(Re(),le(n,1,1,()=>{n=null}),Te())},i(s){l||(X(n),l=!0)},o(s){le(n),l=!1},d(s){s&&(u(e),u(i)),n&&n.d(s)}}}function ve(t){var e=be();const i=t.split(" ")[0];return e===i}function G(t){let e="#ffffff";return t==="pending"?e="#dbb814b2":t==="completed"?e="#77d039":t=="enroute"?e="#5c7de8":t=="paused"?e="#949db9":t=="cancelled"?e="#ea0909b2":t=="checklist"&&(e="#11cab9b2"),e}function ee(t){let e="";return t==="pending"?e="Pendiente":t==="completed"?e="Completado":t=="enroute"?e="En ruta":t=="paused"?e="Pausado":t=="cancelled"?e="Cancelado":t=="checklist"&&(e="En checklist"),e}function te(t){t.slice(0,1)==="#"&&(t=t.slice(1)),t.length===3&&(t=t.split("").map(function(s){return s+s}).join(""));const e=parseInt(t.substr(0,2),16),i=parseInt(t.substr(2,2),16),l=parseInt(t.substr(4,2),16);return(e*299+i*587+l*114)/1e3>=128?"#414040":"#fff"}function be(){var t=new Date,e=t.getDate(),i=t.getMonth()+1,l=t.getFullYear();return e<10&&(e="0"+e),i<10&&(i="0"+i),t=l+"-"+i+"-"+e,t}function Je(t,e,i){let l;ge(t,He,f=>i(11,l=f));let{driverId:n}=e,s=[],o=!1,r=!1,a=new Object,_;const S=async()=>{await k(),_.complete()};function k(f){var D=be();const H=new FormData;H.append("actual_date",D),fetch("https://rutaflow-app-development.up.railway.app/api/admin/report/seguimiento_list.php",{method:"POST",body:H}).then(V=>V.json()).then(V=>{const y=V;i(2,s=y.data.seguimiento_list),y.data.event_list}).catch(V=>{console.error("Error fetching data:",V)})}function E(f){K(`/drivers/${n}/routes/${f}`)}function U(f){return f=="true"?i(3,o=!0):i(3,o=!1),""}const g=f=>f.charAt(0).toUpperCase()+f.slice(1),T=async(f,D)=>{await(await Ve.create({header:f||"Error",message:D||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()},v=()=>{K("/"),i(4,r=!1),localStorage.removeItem("userSession")};function M(f){Ee[f?"unshift":"push"](()=>{_=f,i(5,_)})}const q=f=>f.id_driver===n;return t.$$set=f=>{"driverId"in f&&i(0,n=f.driverId)},t.$$.update=()=>{if(t.$$.dirty&2051){i(0,{driverId:n}=l.params,n);const f=localStorage.getItem("userSession");i(1,a=JSON.parse(f)),a?n=="me"&&a.id_user?a.type=="admin"||a.type=="superadmin"?(K("/drivers/me"),k(),i(4,r=!0)):(T("Usuario no autorizado","Este usuario no tiene acceso a la app de Rutaflow, entrar en contacto con soporte"),K("/")):a&&n&&(K(`/drivers/${a.id_driver}`),k()):(T("Sesión cerrada","Será redireccionado para volver a ingresar"),K("/"))}},[n,a,s,o,r,_,S,E,U,g,v,l,M,q]}class $e extends ye{constructor(e){super(),Ne(this,e,Je,Fe,ke,{driverId:0})}}export{$e as component};

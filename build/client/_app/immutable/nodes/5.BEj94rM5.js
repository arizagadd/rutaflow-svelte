import{Z as xe,s as Ke,e as u,j as B,b as f,q as b,d as W,h as s,m as D,v as N,i as U,w as o,x as Z,n as me,z as Pe,_ as Lt,o as At,k as ue,$ as et,t as Q,r as $,f as q,B as F,a0 as Bt,y as ae,a1 as Re,A as He,a2 as ft,l as Dt,p as Pt}from"../chunks/index.BYLndrM5.js";import{S as Ge,i as We,t as ze,a as Qe,c as St,b as Mt,d as Rt,m as Ht,e as Ut,g as qt}from"../chunks/index.BNHbygFo.js";import{e as Te,u as Xe,d as Je,a as Ft,c as zt,b as Vt,i as Tt,f as jt,g as Kt,s as tt,h as Se,j as Gt,p as Wt}from"../chunks/index.3i3Awa8p.js";import{g as ye}from"../chunks/entry.L2aZ2szG.js";import"../chunks/index-48209844.IIRtDZyg.js";import{m as nt,a as Ve,I as Xt}from"../chunks/IonPage.KvUD72q2.js";import{q as Jt,t as Yt}from"../chunks/ion-modal.CsJaVgKZ.js";const Zt=(i,e)=>{if(!customElements.get(i)){class t extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const n={};for(const r of this.attributes)n[r.name]=r.value;new e({target:this.shadowRoot,props:n})}}customElements.define(i,t)}},Qt=function(i){return document.createElement(i).constructor!==HTMLElement},$t=(i,e)=>{Qt(i)||Zt(i,e)},je=async(i,e,t)=>{Jt(),Yt(),$t(i,e);const l=await nt.create({component:i,componentProps:t});return l.present(),await l.onWillDismiss()};let Ae=xe({km_inicial:[],gas_inicial:[],km_final:[],gas_final:[]}),yt=xe({flag:[]});function xt(i){let e,t,l,n,r="Cancelar",_,d,p="Captura de Km/Gas",I,k,m,c="Confirmar",v,g,a,h,O,w,H;return{c(){e=u("ion-header"),t=u("ion-toolbar"),l=u("ion-buttons"),n=u("ion-button"),n.textContent=r,_=B(),d=u("ion-title"),d.textContent=p,I=B(),k=u("ion-buttons"),m=u("ion-button"),m.textContent=c,v=B(),g=u("ion-content"),a=u("ion-item"),h=u("ion-input"),this.h()},l(A){e=f(A,"ION-HEADER",{translucent:!0});var L=b(e);t=f(L,"ION-TOOLBAR",{});var y=b(t);l=f(y,"ION-BUTTONS",{slot:!0});var P=b(l);n=f(P,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),W(n)!=="svelte-17pq4f4"&&(n.textContent=r),P.forEach(s),_=D(y),d=f(y,"ION-TITLE",{"data-svelte-h":!0}),W(d)!=="svelte-1yhkaq7"&&(d.textContent=p),I=D(y),k=f(y,"ION-BUTTONS",{slot:!0});var S=b(k);m=f(S,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),W(m)!=="svelte-cm6j4s"&&(m.textContent=c),S.forEach(s),y.forEach(s),L.forEach(s),v=D(A),g=f(A,"ION-CONTENT",{fullscreen:!0});var C=b(g);a=f(C,"ION-ITEM",{});var z=b(a);h=f(z,"ION-INPUT",{class:!0,type:!0,placeholder:!0,value:!0,required:!0});var E=b(h);E.forEach(s),z.forEach(s),C.forEach(s),this.h()},h(){N(n,"color","medium"),N(l,"slot","start"),N(m,"strong",""),N(k,"slot","end"),N(e,"translucent",""),N(h,"class","fin-km"),N(h,"type","number"),N(h,"placeholder",O="Ingresa "+i[0]+" actual"),N(h,"value",i[1]),N(h,"required",""),N(g,"fullscreen","")},m(A,L){U(A,e,L),o(e,t),o(t,l),o(l,n),o(t,_),o(t,d),o(t,I),o(t,k),o(k,m),U(A,v,L),U(A,g,L),o(g,a),o(a,h),w||(H=[Z(n,"click",i[2]),Z(m,"click",i[3]),Z(h,"input",i[4])],w=!0)},p(A,[L]){L&1&&O!==(O="Ingresa "+A[0]+" actual")&&N(h,"placeholder",O),L&2&&N(h,"value",A[1])},i:me,o:me,d(A){A&&(s(e),s(v),s(g)),w=!1,Pe(H)}}}function en(i,e,t){const l=Lt();let n=document.querySelector("ion-modal"),r=n.componentProps.data_type;n.componentProps.isLast;let _;yt.subscribe(m=>{r=m.flag[0],r=="km_final"||r=="km_inicial"?t(0,_="kilometraje"):t(0,_="litros de gasolina")});let d=0;function p(){nt.dismiss()}function I(){l("modalResult",{data:"Your data",role:"confirm"}),r=="km_inicial"?Ae.update(c=>({...c,km_inicial:[d]})):r=="gas_inicial"?Ae.update(c=>({...c,gas_inicial:[d]})):r=="km_final"?Ae.update(c=>({...c,km_final:[d]})):r=="gas_final"&&Ae.update(c=>({...c,gas_final:[d]})),p()}return[_,d,p,I,m=>t(1,d=m.target.value)]}class tn extends Ge{constructor(e){super(),We(this,e,en,xt,Ke,{})}}const Ze=xe({items:[],checkedIndices:[]});function _t(i,e,t){const l=i.slice();return l[39]=e[t],l}function nn(i){let e,t,l,n,r,_="Kilometraje inicial",d,p,I,k=i[0]?i[0]+" km.":"Cargar km",m,c,v,g,a,h,O,w="Gasolina inicial (litros)",H,A,L,y=i[1]?i[1]+" litros":"Cargar gas",P,S,C,z;return S=et(i[15][0]),{c(){e=u("ion-item"),t=u("ion-label"),l=u("input"),n=B(),r=u("p"),r.textContent=_,d=B(),p=u("ion-button"),I=u("label"),m=Q(k),c=B(),v=u("ion-item"),g=u("ion-label"),a=u("input"),h=B(),O=u("p"),O.textContent=w,H=B(),A=u("ion-button"),L=u("label"),P=Q(y),this.h()},l(E){e=f(E,"ION-ITEM",{});var T=b(e);t=f(T,"ION-LABEL",{style:!0});var M=b(t);l=f(M,"INPUT",{id:!0,style:!0,type:!0}),n=D(M),r=f(M,"P",{style:!0,"data-svelte-h":!0}),W(r)!=="svelte-88twxi"&&(r.textContent=_),M.forEach(s),d=D(T),p=f(T,"ION-BUTTON",{fill:!0,class:!0,"aria-selected":!0});var j=b(p);I=f(j,"LABEL",{for:!0,style:!0});var K=b(I);m=$(K,k),K.forEach(s),j.forEach(s),T.forEach(s),c=D(E),v=f(E,"ION-ITEM",{});var G=b(v);g=f(G,"ION-LABEL",{style:!0});var X=b(g);a=f(X,"INPUT",{id:!0,style:!0,type:!0}),h=D(X),O=f(X,"P",{style:!0,"data-svelte-h":!0}),W(O)!=="svelte-1ux30eb"&&(O.textContent=w),X.forEach(s),H=D(G),A=f(G,"ION-BUTTON",{fill:!0,class:!0});var ee=b(A);L=f(ee,"LABEL",{for:!0,style:!0});var fe=b(L);P=$(fe,y),fe.forEach(s),ee.forEach(s),G.forEach(s),this.h()},h(){q(l,"id","chkbox-km-ini"),F(l,"pointer-events","auto"),q(l,"type","checkbox"),l.required=!0,F(r,"margin-left","10px"),F(t,"display","flex"),q(I,"for","chklist-km-ini"),F(I,"padding","8px 10px"),N(p,"fill","outline"),N(p,"class","loadKmInicial"),N(p,"aria-selected",""),q(a,"id","chkbox-gas-ini"),F(a,"pointer-events","auto"),q(a,"type","checkbox"),a.required=!0,F(O,"margin-left","10px"),F(g,"display","flex"),q(L,"for","chklist-gas-ini"),F(L,"padding","8px 10px"),N(A,"fill","outline"),N(A,"class","loadGasInicial"),S.p(l,a)},m(E,T){U(E,e,T),o(e,t),o(t,l),l.checked=~(i[4]||[]).indexOf(l.__value),o(t,n),o(t,r),o(e,d),o(e,p),o(p,I),o(I,m),U(E,c,T),U(E,v,T),o(v,g),o(g,a),a.checked=~(i[4]||[]).indexOf(a.__value),o(g,h),o(g,O),o(v,H),o(v,A),o(A,L),o(L,P),C||(z=[Z(l,"change",i[19]),Z(p,"click",i[20]),Z(a,"change",i[21]),Z(A,"click",i[22])],C=!0)},p(E,T){T[0]&16&&(l.checked=~(E[4]||[]).indexOf(l.__value)),T[0]&1&&k!==(k=E[0]?E[0]+" km.":"Cargar km")&&ae(m,k),T[0]&16&&(a.checked=~(E[4]||[]).indexOf(a.__value)),T[0]&2&&y!==(y=E[1]?E[1]+" litros":"Cargar gas")&&ae(P,y)},d(E){E&&(s(e),s(c),s(v)),S.r(),C=!1,Pe(z)}}}function ln(i){let e,t,l,n,r,_="Kilometraje final",d,p,I,k=i[2]?i[2]+" km.":"Cargar km",m,c,v,g,a,h,O,w="Gasolina final (litros)",H,A,L,y=i[3]?i[3]+" litros":"Cargar gas",P,S,C,z;return S=et(i[15][0]),{c(){e=u("ion-item"),t=u("ion-label"),l=u("input"),n=B(),r=u("p"),r.textContent=_,d=B(),p=u("ion-button"),I=u("label"),m=Q(k),c=B(),v=u("ion-item"),g=u("ion-label"),a=u("input"),h=B(),O=u("p"),O.textContent=w,H=B(),A=u("ion-button"),L=u("label"),P=Q(y),this.h()},l(E){e=f(E,"ION-ITEM",{});var T=b(e);t=f(T,"ION-LABEL",{style:!0});var M=b(t);l=f(M,"INPUT",{id:!0,style:!0,type:!0}),n=D(M),r=f(M,"P",{style:!0,"data-svelte-h":!0}),W(r)!=="svelte-ccmu71"&&(r.textContent=_),M.forEach(s),d=D(T),p=f(T,"ION-BUTTON",{fill:!0,class:!0,"aria-selected":!0});var j=b(p);I=f(j,"LABEL",{for:!0,style:!0});var K=b(I);m=$(K,k),K.forEach(s),j.forEach(s),T.forEach(s),c=D(E),v=f(E,"ION-ITEM",{});var G=b(v);g=f(G,"ION-LABEL",{style:!0});var X=b(g);a=f(X,"INPUT",{id:!0,style:!0,type:!0}),h=D(X),O=f(X,"P",{style:!0,"data-svelte-h":!0}),W(O)!=="svelte-wsoyd2"&&(O.textContent=w),X.forEach(s),H=D(G),A=f(G,"ION-BUTTON",{fill:!0,class:!0});var ee=b(A);L=f(ee,"LABEL",{for:!0,style:!0});var fe=b(L);P=$(fe,y),fe.forEach(s),ee.forEach(s),G.forEach(s),this.h()},h(){q(l,"id","chkbox-km-fin"),F(l,"pointer-events","auto"),q(l,"type","checkbox"),l.required=!0,F(r,"margin-left","10px"),F(t,"display","flex"),q(I,"for","chkbox-km-fin"),F(I,"padding","8px 10px"),N(p,"fill","outline"),N(p,"class","loadKmInicial"),N(p,"aria-selected",""),q(a,"id","chkbox-gas-fin"),F(a,"pointer-events","auto"),q(a,"type","checkbox"),a.required=!0,F(O,"margin-left","10px"),F(g,"display","flex"),q(L,"for","chklist-gas-fin"),F(L,"padding","8px 10px"),N(A,"fill","outline"),N(A,"class","loadGasInicial"),S.p(l,a)},m(E,T){U(E,e,T),o(e,t),o(t,l),l.checked=~(i[4]||[]).indexOf(l.__value),o(t,n),o(t,r),o(e,d),o(e,p),o(p,I),o(I,m),U(E,c,T),U(E,v,T),o(v,g),o(g,a),a.checked=~(i[4]||[]).indexOf(a.__value),o(g,h),o(g,O),o(v,H),o(v,A),o(A,L),o(L,P),C||(z=[Z(l,"change",i[14]),Z(p,"click",i[16]),Z(a,"change",i[17]),Z(A,"click",i[18])],C=!0)},p(E,T){T[0]&16&&(l.checked=~(E[4]||[]).indexOf(l.__value)),T[0]&4&&k!==(k=E[2]?E[2]+" km.":"Cargar km")&&ae(m,k),T[0]&16&&(a.checked=~(E[4]||[]).indexOf(a.__value)),T[0]&8&&y!==(y=E[3]?E[3]+" litros":"Cargar gas")&&ae(P,y)},d(E){E&&(s(e),s(c),s(v)),S.r(),C=!1,Pe(z)}}}function on(i){let e=[],t=new Map,l,n=Te(i[7]);const r=_=>_[39].id_checklist_event;for(let _=0;_<n.length;_+=1){let d=_t(i,n,_),p=r(d);t.set(p,e[_]=dt(p,d))}return{c(){for(let _=0;_<e.length;_+=1)e[_].c();l=ue()},l(_){for(let d=0;d<e.length;d+=1)e[d].l(_);l=ue()},m(_,d){for(let p=0;p<e.length;p+=1)e[p]&&e[p].m(_,d);U(_,l,d)},p(_,d){d[0]&6384&&(n=Te(_[7]),e=Xe(e,d,r,1,_,n,t,l.parentNode,Je,dt,l,_t))},d(_){_&&s(l);for(let d=0;d<e.length;d+=1)e[d].d(_)}}}function dt(i,e){let t,l,n,r,_,d=e[39].item+"",p,I,k,m,c=(e[6][e[39].id_checklist_event]?e[6][e[39].id_checklist_event]:"Cargar evidencia")+"",v,g,a,h,O,w,H;function A(){return e[24](e[39])}function L(...y){return e[26](e[39],...y)}return O=et(e[15][0]),{key:i,first:null,c(){t=u("ion-item"),l=u("ion-label"),n=u("input"),r=B(),_=u("p"),p=Q(d),I=B(),k=u("ion-button"),m=u("label"),v=Q(c),g=B(),a=u("input"),h=B(),this.h()},l(y){t=f(y,"ION-ITEM",{});var P=b(t);l=f(P,"ION-LABEL",{style:!0});var S=b(l);n=f(S,"INPUT",{id:!0,style:!0,type:!0}),r=D(S),_=f(S,"P",{style:!0});var C=b(_);p=$(C,d),C.forEach(s),S.forEach(s),I=D(P),k=f(P,"ION-BUTTON",{fill:!0,class:!0});var z=b(k);m=f(z,"LABEL",{for:!0,style:!0});var E=b(m);v=$(E,c),E.forEach(s),g=D(z),a=f(z,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0}),z.forEach(s),h=D(P),P.forEach(s),this.h()},h(){q(n,"id",`chkbox-${e[39].id_checklist_event}`),F(n,"pointer-events","auto"),q(n,"type","checkbox"),n.__value=e[39].id_checklist_event,Bt(n,n.__value),n.required=!0,F(_,"margin-left","10px"),F(l,"display","flex"),q(m,"for","chklist-"+e[39].id_checklist_event),F(m,"padding","8px 10px"),F(a,"display","none"),q(a,"id","chklist-"+e[39].id_checklist_event),q(a,"name","fileToUpload"),q(a,"type","file"),q(a,"accept","image/*"),N(k,"fill","outline"),N(k,"class","loadEvidence svelte-1kg2bry"),O.p(n),this.first=t},m(y,P){U(y,t,P),o(t,l),o(l,n),n.checked=~(e[4]||[]).indexOf(n.__value),o(l,r),o(l,_),o(_,p),o(t,I),o(t,k),o(k,m),o(m,v),o(k,g),o(k,a),e[25](a),o(t,h),w||(H=[Z(n,"change",e[23]),Z(n,"change",A),Z(a,"change",L)],w=!0)},p(y,P){e=y,P[0]&16&&(n.checked=~(e[4]||[]).indexOf(n.__value)),P[0]&64&&c!==(c=(e[6][e[39].id_checklist_event]?e[6][e[39].id_checklist_event]:"Cargar evidencia")+"")&&ae(v,c)},d(y){y&&s(t),e[25](null),O.r(),w=!1,Pe(H)}}}function rn(i){let e,t,l,n,r="Cancelar",_,d,p="Requerimientos de ruta",I,k,m,c="Confirmar",v,g,a,h,O,w;function H(P,S){return P[8]?ln:nn}let L=H(i)(i),y=i[7]&&on(i);return{c(){e=u("ion-header"),t=u("ion-toolbar"),l=u("ion-buttons"),n=u("ion-button"),n.textContent=r,_=B(),d=u("ion-title"),d.textContent=p,I=B(),k=u("ion-buttons"),m=u("ion-button"),m.textContent=c,v=B(),g=u("ion-content"),a=u("ion-list"),L.c(),h=B(),y&&y.c(),this.h()},l(P){e=f(P,"ION-HEADER",{translucent:!0});var S=b(e);t=f(S,"ION-TOOLBAR",{});var C=b(t);l=f(C,"ION-BUTTONS",{slot:!0});var z=b(l);n=f(z,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),W(n)!=="svelte-1dnmkxs"&&(n.textContent=r),z.forEach(s),_=D(C),d=f(C,"ION-TITLE",{"data-svelte-h":!0}),W(d)!=="svelte-ucox25"&&(d.textContent=p),I=D(C),k=f(C,"ION-BUTTONS",{slot:!0});var E=b(k);m=f(E,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),W(m)!=="svelte-1ida0il"&&(m.textContent=c),E.forEach(s),C.forEach(s),S.forEach(s),v=D(P),g=f(P,"ION-CONTENT",{fullscreen:!0});var T=b(g);a=f(T,"ION-LIST",{});var M=b(a);L.l(M),h=D(M),y&&y.l(M),M.forEach(s),T.forEach(s),this.h()},h(){N(n,"color","medium"),N(l,"slot","start"),N(m,"strong",""),N(k,"slot","end"),N(e,"translucent",""),N(g,"fullscreen","")},m(P,S){U(P,e,S),o(e,t),o(t,l),o(l,n),o(t,_),o(t,d),o(t,I),o(t,k),o(k,m),U(P,v,S),U(P,g,S),o(g,a),L.m(a,null),o(a,h),y&&y.m(a,null),O||(w=[Z(n,"click",i[9]),Z(m,"click",i[10])],O=!0)},p(P,S){L.p(P,S),P[7]&&y.p(P,S)},i:me,o:me,d(P){P&&(s(e),s(v),s(g)),L.d(),y&&y.d(),O=!1,Pe(w)}}}function Ct(i){return typeof i=="object"&&i!==null||Array.isArray(i)?Array.isArray(i)?i.map(e=>Ct(e)).flat():Object.keys(i).filter(n=>n.toLowerCase().includes("id_checklist_event")).map(n=>i[n]):(console.error("Invalid input. Please provide a valid object or array."),[])}function an(i,e){let t=new FormData;t.append("id_route",i),t.append("status",e),fetch("https://rutaflow-app-development.up.railway.app/api/admin/route/change_status.php",{method:"POST",body:t}).then(l=>l.json()).then(l=>{}).catch(l=>{console.error("Error fetching data:",l)})}function sn(i,e,t){let l=document.querySelector("ion-modal");const n=l.componentProps.checklist,r=l.componentProps.driverId,_=l.componentProps.routeId,d=l.componentProps.isLast;let p,I,k,m,c=[],v=null,g={},a={};At(()=>{d?console.log("Último checklist"):Ze.update(R=>(R.items=Ct(n),R))});const h=async()=>{await(await Ve.create({header:"Datos o checklist incompletos",message:"Carga la evidencia requerida y marca todas las casillas para confirmar",buttons:[{text:"Cerrar"}]})).present()},O=async()=>{await(await Ve.create({header:"Datos capturados",message:"El kilometraje y gasolina final fueron registrados correctamente, espere aprobación para finalizar ruta",buttons:[{text:"Cerrar"}]})).present()},w=async R=>{await(await Ve.create({header:"Datos inválidos",message:R=="km"?"Llena correctamente el campo de kilometraje inicial":"Llena correctamente el campo de gasolina inicial",buttons:[{text:"Cerrar"}]})).present()},H=()=>{nt.dismiss(),r?ye(`/drivers/${r}`):ye("/drivers/me")},A=()=>{if(d){var R=S(k,"km"),V=S(m,"gas");const J=new FormData;J.append("km_final",R),J.append("gas_final",V),J.append("id_route",_),R&&V?(H(),fetch("https://rutaflow-app-development.up.railway.app/api/admin/checklist/add_evidence.php",{method:"POST",body:J}).then(ie=>ie.json()).then(ie=>{O()}).catch(ie=>{console.error("Error fetching data:",ie)})):h()}else{var ne=S(p,"km"),de=S(I,"gas");Ze.update(J=>{if(J.items.every(Y=>J.checkedIndices.includes(Y))&&ne&&de){H();const Y=new FormData;for(const le in g)if(g.hasOwnProperty(le)){const{img:pe,img_id:ve}=g[le];Y.append(`selectedImages[${le}][img]`,pe),Y.append(`selectedImages[${le}][img_id]`,ve)}Y.append("km_inicial",ne),Y.append("gas_inicial",de),Y.append("id_route",_),fetch("https://rutaflow-app-development.up.railway.app/api/admin/checklist/add_evidence.php",{method:"POST",body:Y}).then(le=>le.json()).then(le=>{an(_,"enroute")}).catch(le=>{console.error("Error fetching data:",le)})}else h();return J})}T()},L=async(R,V)=>{const de=R.target.files[0],J=await y(de);if(J){const ie=new FormData;ie.append("fileToUpload",J);try{const he=await fetch("https://rutaflow-app-development.up.railway.app/api/admin/manager/upload_img_driver.php",{method:"POST",body:ie});if(he.ok){const Y=await he.json();g={...g,[V]:{img:Y.img,img_id:Y.img_id}},t(6,a={...a,[V]:Y.filename})}else console.error("File upload failed:",he.statusText)}catch(he){console.error("Error during file upload:",he)}}},y=async R=>new Promise(V=>{const ne=new FileReader;ne.onload=de=>{const J=new Image;J.src=de.target.result,J.onload=()=>{const ie=document.createElement("canvas"),he=ie.getContext("2d"),Y=800,le=600;let pe=J.width,ve=J.height;pe>Y&&(ve*=Y/pe,pe=Y),ve>le&&(pe*=le/ve,ve=le),ie.width=pe,ie.height=ve,he.drawImage(J,0,0,pe,ve),ie.toBlob(Ye=>{V(Ye)},"image/jpeg",.7)}},ne.readAsDataURL(R)}),P=R=>{Ze.update(V=>(V.checkedIndices.indexOf(R)===-1?V.checkedIndices.push(R):console.error(`ID ${R} is already checked.`),V.items.forEach(de=>{de.id_checklist_event===R&&(de.checked=!0)}),V))};function S(R,V){return/^\d+$/.test(R)?parseInt(R,10):(w(V),null)}function C(R,V){z(V),l.componentProps.data_type=V,je("modal-gas-km",tn,{r:V}).then(()=>{Ae.subscribe(ne=>{E(ne)})})}function z(R){yt.update(V=>({...V,flag:[R]}))}function E(R){t(0,p=R.km_inicial?R.km_inicial:null),t(1,I=R.gas_inicial?R.gas_inicial:null),t(2,k=R.km_final?R.km_final:null),t(3,m=R.gas_final?R.gas_final:null)}function T(){Ae.set({km_inicial:[],gas_inicial:[],km_final:[],gas_final:[]})}const M=[[]];function j(){c=Re(M[0],this.__value,this.checked),t(4,c)}const K=R=>C(R,"km_final");function G(){c=Re(M[0],this.__value,this.checked),t(4,c)}const X=R=>C(R,"gas_final");function ee(){c=Re(M[0],this.__value,this.checked),t(4,c)}const fe=R=>C(R,"km_inicial");function _e(){c=Re(M[0],this.__value,this.checked),t(4,c)}const oe=R=>C(R,"gas_inicial");function ge(){c=Re(M[0],this.__value,this.checked),t(4,c)}const ke=R=>P(R.id_checklist_event);function Me(R){He[R?"unshift":"push"](()=>{v=R,t(5,v)})}return[p,I,k,m,c,v,a,n,d,H,A,L,P,C,j,M,K,G,X,ee,fe,_e,oe,ge,ke,Me,(R,V)=>L(V,R.id_checklist_event)]}class wt extends Ge{constructor(e){super(),We(this,e,sn,rn,Ke,{},null,[-1,-1])}}function cn(i){let e,t,l,n,r,_="Domicilio 2",d,p,I=i[2].line2+"",k,m,c;return{c(){e=u("ion-item"),t=u("ion-icon"),l=B(),n=u("ion-label"),r=u("p"),r.textContent=_,d=B(),p=u("h2"),k=Q(I),m=B(),c=u("ion-icon"),this.h()},l(v){e=f(v,"ION-ITEM",{href:!0});var g=b(e);t=f(g,"ION-ICON",{icon:!0,slot:!0}),b(t).forEach(s),l=D(g),n=f(g,"ION-LABEL",{class:!0});var a=b(n);r=f(a,"P",{"data-svelte-h":!0}),W(r)!=="svelte-1qy148r"&&(r.textContent=_),d=D(a),p=f(a,"H2",{});var h=b(p);k=$(h,I),h.forEach(s),a.forEach(s),m=D(g),c=f(g,"ION-ICON",{icon:!0,slot:!0}),b(c).forEach(s),g.forEach(s),this.h()},h(){N(t,"icon",tt),N(t,"slot","start"),N(n,"class","ion-text-wrap"),N(c,"icon",Se),N(c,"slot","end"),N(e,"href","https://www.google.com/maps/searhc/?api=1&query="+i[2].line2)},m(v,g){U(v,e,g),o(e,t),o(e,l),o(e,n),o(n,r),o(n,d),o(n,p),o(p,k),o(e,m),o(e,c)},p:me,d(v){v&&s(e)}}}function un(i){let e,t,l,n,r,_="Domicilio 1",d,p,I=i[2].line1+"",k,m,c,v,g=i[2].line2&&i[2].line2.trim().length,a,h=g&&fn(i);return{c(){e=u("ion-item"),t=u("ion-icon"),l=B(),n=u("ion-label"),r=u("p"),r.textContent=_,d=B(),p=u("h2"),k=Q(I),m=B(),c=u("ion-icon"),v=B(),h&&h.c(),a=ue(),this.h()},l(O){e=f(O,"ION-ITEM",{href:!0});var w=b(e);t=f(w,"ION-ICON",{icon:!0,slot:!0}),b(t).forEach(s),l=D(w),n=f(w,"ION-LABEL",{class:!0});var H=b(n);r=f(H,"P",{"data-svelte-h":!0}),W(r)!=="svelte-1ehcrdm"&&(r.textContent=_),d=D(H),p=f(H,"H2",{});var A=b(p);k=$(A,I),A.forEach(s),H.forEach(s),m=D(w),c=f(w,"ION-ICON",{icon:!0,slot:!0}),b(c).forEach(s),w.forEach(s),v=D(O),h&&h.l(O),a=ue(),this.h()},h(){N(t,"icon",tt),N(t,"slot","start"),N(n,"class","ion-text-wrap"),N(c,"icon",Se),N(c,"slot","end"),N(e,"href","https://www.google.com/maps/search/?api=1&query="+i[2].line1)},m(O,w){U(O,e,w),o(e,t),o(e,l),o(e,n),o(n,r),o(n,d),o(n,p),o(p,k),o(e,m),o(e,c),U(O,v,w),h&&h.m(O,w),U(O,a,w)},p(O,w){g&&h.p(O,w)},d(O){O&&(s(e),s(v),s(a)),h&&h.d(O)}}}function fn(i){let e,t,l,n,r,_="Domicilio 2",d,p,I=i[2].line2+"",k,m,c;return{c(){e=u("ion-item"),t=u("ion-icon"),l=B(),n=u("ion-label"),r=u("p"),r.textContent=_,d=B(),p=u("h2"),k=Q(I),m=B(),c=u("ion-icon"),this.h()},l(v){e=f(v,"ION-ITEM",{href:!0});var g=b(e);t=f(g,"ION-ICON",{icon:!0,slot:!0}),b(t).forEach(s),l=D(g),n=f(g,"ION-LABEL",{class:!0});var a=b(n);r=f(a,"P",{"data-svelte-h":!0}),W(r)!=="svelte-1qy148r"&&(r.textContent=_),d=D(a),p=f(a,"H2",{});var h=b(p);k=$(h,I),h.forEach(s),a.forEach(s),m=D(g),c=f(g,"ION-ICON",{icon:!0,slot:!0}),b(c).forEach(s),g.forEach(s),this.h()},h(){N(t,"icon",tt),N(t,"slot","start"),N(n,"class","ion-text-wrap"),N(c,"icon",Se),N(c,"slot","end"),N(e,"href","https://www.google.com/maps/search/?api=1&query="+i[2].line2)},m(v,g){U(v,e,g),o(e,t),o(e,l),o(e,n),o(n,r),o(n,d),o(n,p),o(p,k),o(e,m),o(e,c)},p:me,d(v){v&&s(e)}}}function _n(i){let e,t=i[2].comments!="<br>"&&dn(i);return{c(){t&&t.c(),e=ue()},l(l){t&&t.l(l),e=ue()},m(l,n){t&&t.m(l,n),U(l,e,n)},p(l,n){l[2].comments!="<br>"&&t.p(l,n)},d(l){l&&s(e),t&&t.d(l)}}}function dn(i){let e,t,l,n,r,_="Notas de ubicación",d,p,I=i[2].comments+"",k;return{c(){e=u("ion-item"),t=u("ion-icon"),l=B(),n=u("ion-label"),r=u("p"),r.textContent=_,d=B(),p=u("h2"),k=Q(I),this.h()},l(m){e=f(m,"ION-ITEM",{});var c=b(e);t=f(c,"ION-ICON",{icon:!0,slot:!0}),b(t).forEach(s),l=D(c),n=f(c,"ION-LABEL",{class:!0});var v=b(n);r=f(v,"P",{"data-svelte-h":!0}),W(r)!=="svelte-nhm2ft"&&(r.textContent=_),d=D(v),p=f(v,"H2",{});var g=b(p);k=$(g,I),g.forEach(s),v.forEach(s),c.forEach(s),this.h()},h(){N(t,"icon",Tt),N(t,"slot","start"),N(n,"class","ion-text-wrap")},m(m,c){U(m,e,c),o(e,t),o(e,l),o(e,n),o(n,r),o(n,d),o(n,p),o(p,k)},p:me,d(m){m&&s(e)}}}function hn(i){let e,t,l,n,r,_="Horarios",d,p,I=i[2].schedule+"",k;return{c(){e=u("ion-item"),t=u("ion-icon"),l=B(),n=u("ion-label"),r=u("p"),r.textContent=_,d=B(),p=u("h2"),k=Q(I),this.h()},l(m){e=f(m,"ION-ITEM",{});var c=b(e);t=f(c,"ION-ICON",{icon:!0,slot:!0}),b(t).forEach(s),l=D(c),n=f(c,"ION-LABEL",{});var v=b(n);r=f(v,"P",{"data-svelte-h":!0}),W(r)!=="svelte-11q7hm5"&&(r.textContent=_),d=D(v),p=f(v,"H2",{});var g=b(p);k=$(g,I),g.forEach(s),v.forEach(s),c.forEach(s),this.h()},h(){N(t,"icon",jt),N(t,"slot","start")},m(m,c){U(m,e,c),o(e,t),o(e,l),o(e,n),o(n,r),o(n,d),o(n,p),o(p,k)},p:me,d(m){m&&s(e)}}}function pn(i){let e,t,l,n,r,_="Notas del operador",d,p,I=i[2].driver_comments+"",k;return{c(){e=u("ion-item"),t=u("ion-icon"),l=B(),n=u("ion-label"),r=u("p"),r.textContent=_,d=B(),p=u("h2"),k=Q(I),this.h()},l(m){e=f(m,"ION-ITEM",{});var c=b(e);t=f(c,"ION-ICON",{icon:!0,slot:!0}),b(t).forEach(s),l=D(c),n=f(c,"ION-LABEL",{});var v=b(n);r=f(v,"P",{"data-svelte-h":!0}),W(r)!=="svelte-1yk9qp4"&&(r.textContent=_),d=D(v),p=f(v,"H2",{});var g=b(p);k=$(g,I),g.forEach(s),v.forEach(s),c.forEach(s),this.h()},h(){N(t,"icon",Kt),N(t,"slot","start")},m(m,c){U(m,e,c),o(e,t),o(e,l),o(e,n),o(n,r),o(n,d),o(n,p),o(p,k)},p:me,d(m){m&&s(e)}}}function mn(i){let e,t=i[2].logistic_comments!="<br>"&&vn(i);return{c(){t&&t.c(),e=ue()},l(l){t&&t.l(l),e=ue()},m(l,n){t&&t.m(l,n),U(l,e,n)},p(l,n){l[2].logistic_comments!="<br>"&&t.p(l,n)},d(l){l&&s(e),t&&t.d(l)}}}function vn(i){let e,t,l,n,r,_="Comentarios logísticos",d,p,I=i[2].logistic_comments+"",k;return{c(){e=u("ion-item"),t=u("ion-icon"),l=B(),n=u("ion-label"),r=u("p"),r.textContent=_,d=B(),p=u("h2"),k=Q(I),this.h()},l(m){e=f(m,"ION-ITEM",{});var c=b(e);t=f(c,"ION-ICON",{icon:!0,slot:!0}),b(t).forEach(s),l=D(c),n=f(c,"ION-LABEL",{class:!0});var v=b(n);r=f(v,"P",{"data-svelte-h":!0}),W(r)!=="svelte-1iz85r6"&&(r.textContent=_),d=D(v),p=f(v,"H2",{});var g=b(p);k=$(g,I),g.forEach(s),v.forEach(s),c.forEach(s),this.h()},h(){N(t,"icon",Tt),N(t,"slot","start"),N(n,"class","ion-text-wrap")},m(m,c){U(m,e,c),o(e,t),o(e,l),o(e,n),o(n,r),o(n,d),o(n,p),o(p,k)},p:me,d(m){m&&s(e)}}}function ht(i){let e,t,l;return{c(){e=u("section"),t=u("ion-img"),this.h()},l(n){e=f(n,"SECTION",{});var r=b(e);t=f(r,"ION-IMG",{src:!0,alt:!0,style:!0}),b(t).forEach(s),r.forEach(s),this.h()},h(){ft(t.src,l=i[1])||N(t,"src",l),N(t,"alt","Evidencia fotográfica"),F(t,"max-width","100%"),F(t,"margin-top","16px")},m(n,r){U(n,e,r),o(e,t)},p(n,r){r&2&&!ft(t.src,l=n[1])&&N(t,"src",l)},d(n){n&&s(e)}}}function bn(i){let e,t,l,n,r="Cancelar",_,d,p=i[2].title+"",I,k,m,c,v="Confirmar",g,a,h,O,w,H,A,L,y="Cliente",P,S,C=i[2].client_name+"",z,E,T,M=i[2].comments&&i[2].comments.trim().length,j,K=i[2].schedule&&i[2].schedule.trim().length,G,X,ee=i[2].logistic_comments&&i[2].logistic_comments.trim().length,fe,_e,oe,ge,ke,Me,Ce,R,V,ne,de,J,ie="Subir Evidencia",he,Y,le,pe,ve;function Ye(x,se){if(x[2].line1&&x[2].line1.trim().length)return un;if(x[2].line2&&x[2].line2.trim().length)return cn}let lt=Ye(i),be=lt&&lt(i),Ee=M&&_n(i),Ie=K&&hn(i),Oe=i[2].driver_comments&&pn(i),Ne=ee&&mn(i),re=i[1]&&ht(i);return{c(){e=u("ion-header"),t=u("ion-toolbar"),l=u("ion-buttons"),n=u("ion-button"),n.textContent=r,_=B(),d=u("ion-title"),I=Q(p),k=B(),m=u("ion-buttons"),c=u("ion-button"),c.textContent=v,g=B(),a=u("ion-content"),h=u("ion-list"),O=u("ion-item"),w=u("ion-icon"),H=B(),A=u("ion-label"),L=u("p"),L.textContent=y,P=B(),S=u("h2"),z=Q(C),E=B(),be&&be.c(),T=B(),Ee&&Ee.c(),j=B(),Ie&&Ie.c(),G=B(),Oe&&Oe.c(),X=B(),Ne&&Ne.c(),fe=B(),_e=u("ion-item"),oe=u("ion-icon"),ge=B(),ke=u("ion-textarea"),Me=B(),Ce=u("section"),R=u("label"),V=u("ion-button"),ne=u("ion-icon"),de=B(),J=u("label"),J.textContent=ie,he=B(),Y=u("input"),le=B(),re&&re.c(),this.h()},l(x){e=f(x,"ION-HEADER",{translucent:!0});var se=b(e);t=f(se,"ION-TOOLBAR",{});var we=b(t);l=f(we,"ION-BUTTONS",{slot:!0});var ot=b(l);n=f(ot,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),W(n)!=="svelte-1f8rjcf"&&(n.textContent=r),ot.forEach(s),_=D(we),d=f(we,"ION-TITLE",{title:!0});var it=b(d);I=$(it,p),it.forEach(s),k=D(we),m=f(we,"ION-BUTTONS",{slot:!0});var rt=b(m);c=f(rt,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),W(c)!=="svelte-1ida0il"&&(c.textContent=v),rt.forEach(s),we.forEach(s),se.forEach(s),g=D(x),a=f(x,"ION-CONTENT",{fullscreen:!0});var at=b(a);h=f(at,"ION-LIST",{});var te=b(h);O=f(te,"ION-ITEM",{});var Ue=b(O);w=f(Ue,"ION-ICON",{icon:!0,slot:!0}),b(w).forEach(s),H=D(Ue),A=f(Ue,"ION-LABEL",{});var qe=b(A);L=f(qe,"P",{"data-svelte-h":!0}),W(L)!=="svelte-jrq7ei"&&(L.textContent=y),P=D(qe),S=f(qe,"H2",{});var st=b(S);z=$(st,C),st.forEach(s),qe.forEach(s),Ue.forEach(s),E=D(te),be&&be.l(te),T=D(te),Ee&&Ee.l(te),j=D(te),Ie&&Ie.l(te),G=D(te),Oe&&Oe.l(te),X=D(te),Ne&&Ne.l(te),fe=D(te),_e=f(te,"ION-ITEM",{});var Fe=b(_e);oe=f(Fe,"ION-ICON",{icon:!0,slot:!0}),b(oe).forEach(s),ge=D(Fe),ke=f(Fe,"ION-TEXTAREA",{label:!0,placeholder:!0}),b(ke).forEach(s),Fe.forEach(s),Me=D(te),Ce=f(te,"SECTION",{});var ct=b(Ce);R=f(ct,"LABEL",{for:!0,style:!0});var ut=b(R);V=f(ut,"ION-BUTTON",{fill:!0,class:!0,expand:!0});var Le=b(V);ne=f(Le,"ION-ICON",{icon:!0,slot:!0}),b(ne).forEach(s),de=D(Le),J=f(Le,"LABEL",{for:!0,style:!0,"data-svelte-h":!0}),W(J)!=="svelte-1as0od8"&&(J.textContent=ie),he=D(Le),Y=f(Le,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0}),Le.forEach(s),ut.forEach(s),ct.forEach(s),le=D(te),re&&re.l(te),te.forEach(s),at.forEach(s),this.h()},h(){N(n,"color","medium"),N(l,"slot","start"),N(d,"title",i[2].title),N(c,"strong",""),N(m,"slot","end"),N(e,"translucent",""),N(w,"icon",Ft),N(w,"slot","start"),N(oe,"icon",zt),N(oe,"slot","start"),N(ke,"label","Notas"),N(ke,"placeholder","Escribe aquí..."),N(ne,"icon",Vt),N(ne,"slot","start"),q(J,"for","eventEvidence"),F(J,"padding","8px 10px"),F(Y,"display","none"),q(Y,"id","eventEvidence"),q(Y,"name","fileToUpload"),q(Y,"type","file"),q(Y,"accept","image/*"),N(V,"fill","outline"),N(V,"class","loadEvidence"),N(V,"expand","block"),q(R,"for","eventEvidence"),F(R,"display","block"),F(R,"width","100%"),N(a,"fullscreen","")},m(x,se){U(x,e,se),o(e,t),o(t,l),o(l,n),o(t,_),o(t,d),o(d,I),o(t,k),o(t,m),o(m,c),U(x,g,se),U(x,a,se),o(a,h),o(h,O),o(O,w),o(O,H),o(O,A),o(A,L),o(A,P),o(A,S),o(S,z),o(h,E),be&&be.m(h,null),o(h,T),Ee&&Ee.m(h,null),o(h,j),Ie&&Ie.m(h,null),o(h,G),Oe&&Oe.m(h,null),o(h,X),Ne&&Ne.m(h,null),o(h,fe),o(h,_e),o(_e,oe),o(_e,ge),o(_e,ke),i[6](ke),o(h,Me),o(h,Ce),o(Ce,R),o(R,V),o(V,ne),o(V,de),o(V,J),o(V,he),o(V,Y),o(h,le),re&&re.m(h,null),pe||(ve=[Z(n,"click",i[4]),Z(c,"click",i[5]),Z(Y,"change",i[3])],pe=!0)},p(x,[se]){be&&be.p(x,se),M&&Ee.p(x,se),K&&Ie.p(x,se),x[2].driver_comments&&Oe.p(x,se),ee&&Ne.p(x,se),x[1]?re?re.p(x,se):(re=ht(x),re.c(),re.m(h,null)):re&&(re.d(1),re=null)},i:me,o:me,d(x){x&&(s(e),s(g),s(a)),be&&be.d(),Ee&&Ee.d(),Ie&&Ie.d(),Oe&&Oe.d(),Ne&&Ne.d(),i[6](null),re&&re.d(),pe=!1,Pe(ve)}}}function gn(i,e,t){let l=document.querySelector("ion-modal"),n=l.componentProps.delivery,r=l.componentProps.isLast,_=n.driver_comments?n.driver_comments:"",d=n.img?n.img:"",p="";const I=async a=>{const O=a.target.files[0],w=await k(O);if(w){const H=new FormData;H.append("fileToUpload",w);try{const A=await fetch("https://rutaflow-app-development.up.railway.app/api/admin/manager/upload_img_driver.php",{method:"POST",body:H});if(A.ok){const L=await A.json();t(1,d=L.img),p=L.img_id}else console.error("File upload failed:",A.statusText)}catch(A){console.error("Error during file upload:",A)}}},k=async a=>new Promise(h=>{const O=new FileReader;O.onload=w=>{const H=new Image;H.src=w.target.result,H.onload=()=>{const A=document.createElement("canvas"),L=A.getContext("2d"),y=800,P=600;let S=H.width,C=H.height;S>y&&(C*=y/S,S=y),C>P&&(S*=P/C,C=P),A.width=S,A.height=C,L.drawImage(H,0,0,S,C),A.toBlob(z=>{h(z)},"image/jpeg",.7)}},O.readAsDataURL(a)}),m=()=>{l.dismiss({data:Date.now()})},c=()=>{var a=new Object;a.id_route=n.id_route,a.id_event=n.id_event,a.comments=_.value,a.img=d,a.img_id=p;const h=new FormData;for(const O in a)h.append(O,a[O]);fetch("https://rutaflow-app-development.up.railway.app/api/admin/evidence/send_evidence.php",{method:"POST",body:h}).then(O=>O.json()).then(O=>{m();var w=a.id_route;r&&v("","",w,r)}).catch(O=>{console.error("Error fetching data:",O)})},v=(a,h,O,w)=>{l.componentProps.routeId=O,l.componentProps.driverId=n.id_driver,je("modal-km-gas",wt,{checklist:a,driverId:h,routeId:O,isLast:w}).then(H=>{})};function g(a){He[a?"unshift":"push"](()=>{_=a,t(0,_)})}return[_,d,n,I,m,c,g]}class kn extends Ge{constructor(e){super(),We(this,e,gn,bn,Ke,{})}}function pt(i,e,t){const l=i.slice();return l[26]=e[t],l}function mt(i,e,t){const l=i.slice();return l[26]=e[t],l[28]=t,l}function vt(i,e,t){const l=i.slice();return l[26]=e[t],l[28]=t,l}function bt(i){let e,t;return e=new Xt({props:{$$slots:{default:[Tn]},$$scope:{ctx:i}}}),{c(){Mt(e.$$.fragment)},l(l){Rt(e.$$.fragment,l)},m(l,n){Ht(e,l,n),t=!0},p(l,n){const r={};n[0]&127|n[1]&2&&(r.$$scope={dirty:n,ctx:l}),e.$set(r)},i(l){t||(ze(e.$$.fragment,l),t=!0)},o(l){Qe(e.$$.fragment,l),t=!1},d(l){Ut(e,l)}}}function En(i){let e=$e(i[0],"enroute")+"",t,l,n,r,_='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Jala para actualizar" refreshing-spinner="circles" refreshing-text="Actualizando..."></ion-refresher-content>',d,p,I=[],k=new Map,m,c,v=Te(i[3]);const g=a=>a[26].id_event;for(let a=0;a<v.length;a+=1){let h=pt(i,v,a),O=g(h);k.set(O,I[a]=kt(O,h))}return{c(){t=Q(e),l=B(),n=u("ion-content"),r=u("ion-refresher"),r.innerHTML=_,d=B(),p=u("ion-list");for(let a=0;a<I.length;a+=1)I[a].c();this.h()},l(a){t=$(a,e),l=D(a),n=f(a,"ION-CONTENT",{});var h=b(n);r=f(h,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),W(r)!=="svelte-1jkndk3"&&(r.innerHTML=_),d=D(h),p=f(h,"ION-LIST",{});var O=b(p);for(let w=0;w<I.length;w+=1)I[w].l(O);O.forEach(s),h.forEach(s),this.h()},h(){N(r,"slot","fixed")},m(a,h){U(a,t,h),U(a,l,h),U(a,n,h),o(n,r),i[19](r),o(n,d),o(n,p);for(let O=0;O<I.length;O+=1)I[O]&&I[O].m(p,null);m||(c=Z(r,"ionRefresh",i[7]),m=!0)},p(a,h){h[0]&1&&e!==(e=$e(a[0],"enroute")+"")&&ae(t,e),h[0]&5384&&(v=Te(a[3]),I=Xe(I,h,g,1,a,v,k,p,Je,kt,null,pt))},d(a){a&&(s(t),s(l),s(n)),i[19](null);for(let h=0;h<I.length;h+=1)I[h].d();m=!1,c()}}}function In(i){let e,t;function l(_,d){return d[0]&32&&(e=null),e==null&&(e=!!_[5].every(Cn)),e?Nn:On}let n=l(i,[-1,-1]),r=n(i);return{c(){r.c(),t=ue()},l(_){r.l(_),t=ue()},m(_,d){r.m(_,d),U(_,t,d)},p(_,d){n===(n=l(_,d))&&r?r.p(_,d):(r.d(1),r=n(_),r&&(r.c(),r.m(t.parentNode,t)))},d(_){_&&s(t),r.d(_)}}}function gt(i){let e;return{c(){e=u("span"),this.h()},l(t){e=f(t,"SPAN",{class:!0}),b(e).forEach(s),this.h()},h(){q(e,"class","notes svelte-ziybgw")},m(t,l){U(t,e,l)},d(t){t&&s(e)}}}function kt(i,e){let t,l,n,r,_=parseInt(e[26].pos)+1+"",d,p,I,k,m,c,v=e[26].title+"",g,a,h=e[26].support_list&&e[26].support_list.length||e[10](e[26]),O,w,H,A,L,y=h&&gt();function P(){return e[20](e[26])}return{key:i,first:null,c(){t=u("ion-item"),l=u("ion-avatar"),n=u("div"),r=u("div"),d=Q(_),I=B(),k=u("ion-label"),m=u("ion-text"),c=u("h3"),g=Q(v),a=B(),y&&y.c(),O=B(),w=u("ion-icon"),H=B(),this.h()},l(S){t=f(S,"ION-ITEM",{});var C=b(t);l=f(C,"ION-AVATAR",{slot:!0});var z=b(l);n=f(z,"DIV",{class:!0,title:!0,style:!0});var E=b(n);r=f(E,"DIV",{class:!0});var T=b(r);d=$(T,_),T.forEach(s),E.forEach(s),z.forEach(s),I=D(C),k=f(C,"ION-LABEL",{button:!0});var M=b(k);m=f(M,"ION-TEXT",{color:!0});var j=b(m);c=f(j,"H3",{});var K=b(c);g=$(K,v),a=D(K),y&&y.l(K),K.forEach(s),j.forEach(s),M.forEach(s),O=D(C),w=f(C,"ION-ICON",{icon:!0,slot:!0,style:!0}),b(w).forEach(s),H=D(C),C.forEach(s),this.h()},h(){q(r,"class","order svelte-ziybgw"),q(n,"class","order-wrapper svelte-ziybgw"),q(n,"title",p=Be(e[26].status)),F(n,"background-color",ce(e[26])),F(n,"color",De(ce(e[26]))),N(l,"slot","start"),N(m,"color","#2e2e2e"),N(k,"button",""),N(w,"icon",Se),N(w,"slot","end"),F(w,"color",ce(e[26])),this.first=t},m(S,C){U(S,t,C),o(t,l),o(l,n),o(n,r),o(r,d),o(t,I),o(t,k),o(k,m),o(m,c),o(c,g),o(c,a),y&&y.m(c,null),o(t,O),o(t,w),o(t,H),A||(L=Z(k,"click",P),A=!0)},p(S,C){e=S,C[0]&8&&_!==(_=parseInt(e[26].pos)+1+"")&&ae(d,_),C[0]&8&&p!==(p=Be(e[26].status))&&q(n,"title",p),C[0]&8&&F(n,"background-color",ce(e[26])),C[0]&8&&F(n,"color",De(ce(e[26]))),C[0]&8&&v!==(v=e[26].title+"")&&ae(g,v),C[0]&8&&(h=e[26].support_list&&e[26].support_list.length||e[10](e[26])),h?y||(y=gt(),y.c(),y.m(c,null)):y&&(y.d(1),y=null),C[0]&8&&F(w,"color",ce(e[26]))},d(S){S&&s(t),y&&y.d(),A=!1,L()}}}function On(i){let e=i[9](i[5],i[1],i[0])+"",t,l,n,r,_='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Pull to refresh" refreshing-spinner="circles" refreshing-text="Refreshing..."></ion-refresher-content>',d,p,I=[],k=new Map,m,c,v=Te(i[3]);const g=a=>a[26].id_event;for(let a=0;a<v.length;a+=1){let h=mt(i,v,a),O=g(h);k.set(O,I[a]=It(O,h))}return{c(){t=Q(e),l=B(),n=u("ion-content"),r=u("ion-refresher"),r.innerHTML=_,d=B(),p=u("ion-list");for(let a=0;a<I.length;a+=1)I[a].c();this.h()},l(a){t=$(a,e),l=D(a),n=f(a,"ION-CONTENT",{});var h=b(n);r=f(h,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),W(r)!=="svelte-1poui8g"&&(r.innerHTML=_),d=D(h),p=f(h,"ION-LIST",{});var O=b(p);for(let w=0;w<I.length;w+=1)I[w].l(O);O.forEach(s),h.forEach(s),this.h()},h(){N(r,"slot","fixed")},m(a,h){U(a,t,h),U(a,l,h),U(a,n,h),o(n,r),i[17](r),o(n,d),o(n,p);for(let O=0;O<I.length;O+=1)I[O]&&I[O].m(p,null);m||(c=Z(r,"ionRefresh",i[7]),m=!0)},p(a,h){h[0]&35&&e!==(e=a[9](a[5],a[1],a[0])+"")&&ae(t,e),h[0]&9480&&(v=Te(a[3]),I=Xe(I,h,g,1,a,v,k,p,Je,It,null,mt))},d(a){a&&(s(t),s(l),s(n)),i[17](null);for(let h=0;h<I.length;h+=1)I[h].d();m=!1,c()}}}function Nn(i){let e,t,l='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Pull to refresh" refreshing-spinner="circles" refreshing-text="Refreshing..."></ion-refresher-content>',n,r,_=[],d=new Map,p,I,k=Te(i[3]);const m=c=>c[26].id_event;for(let c=0;c<k.length;c+=1){let v=vt(i,k,c),g=m(v);d.set(g,_[c]=Nt(g,v))}return{c(){e=u("ion-content"),t=u("ion-refresher"),t.innerHTML=l,n=B(),r=u("ion-list");for(let c=0;c<_.length;c+=1)_[c].c();this.h()},l(c){e=f(c,"ION-CONTENT",{});var v=b(e);t=f(v,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),W(t)!=="svelte-1poui8g"&&(t.innerHTML=l),n=D(v),r=f(v,"ION-LIST",{});var g=b(r);for(let a=0;a<_.length;a+=1)_[a].l(g);g.forEach(s),v.forEach(s),this.h()},h(){N(t,"slot","fixed")},m(c,v){U(c,e,v),o(e,t),i[15](t),o(e,n),o(e,r);for(let g=0;g<_.length;g+=1)_[g]&&_[g].m(r,null);p||(I=Z(t,"ionRefresh",i[7]),p=!0)},p(c,v){v[0]&9480&&(k=Te(c[3]),_=Xe(_,v,m,1,c,k,d,r,Je,Nt,null,vt))},d(c){c&&s(e),i[15](null);for(let v=0;v<_.length;v+=1)_[v].d();p=!1,I()}}}function Et(i){let e;return{c(){e=u("span"),this.h()},l(t){e=f(t,"SPAN",{class:!0}),b(e).forEach(s),this.h()},h(){q(e,"class","notes svelte-ziybgw")},m(t,l){U(t,e,l)},d(t){t&&s(e)}}}function It(i,e){let t,l,n,r,_=parseInt(e[26].pos)+1+"",d,p,I,k,m,c,v=e[26].title+"",g,a,h=e[26].support_list&&e[26].support_list.length||e[10](e[26]),O,w,H="",A,L,y,P,S,C=h&&Et();function z(){return e[18](e[26],e[28])}return{key:i,first:null,c(){t=u("ion-item"),l=u("ion-avatar"),n=u("div"),r=u("div"),d=Q(_),I=B(),k=u("ion-label"),m=u("ion-text"),c=u("h3"),g=Q(v),a=B(),C&&C.c(),O=B(),w=u("div"),w.innerHTML=H,A=B(),L=u("ion-icon"),y=B(),this.h()},l(E){t=f(E,"ION-ITEM",{});var T=b(t);l=f(T,"ION-AVATAR",{slot:!0});var M=b(l);n=f(M,"DIV",{class:!0,title:!0,style:!0});var j=b(n);r=f(j,"DIV",{class:!0});var K=b(r);d=$(K,_),K.forEach(s),j.forEach(s),M.forEach(s),I=D(T),k=f(T,"ION-LABEL",{button:!0});var G=b(k);m=f(G,"ION-TEXT",{color:!0});var X=b(m);c=f(X,"H3",{});var ee=b(c);g=$(ee,v),a=D(ee),C&&C.l(ee),ee.forEach(s),X.forEach(s),O=D(G),w=f(G,"DIV",{class:!0,"data-svelte-h":!0}),W(w)!=="svelte-130ohbs"&&(w.innerHTML=H),G.forEach(s),A=D(T),L=f(T,"ION-ICON",{icon:!0,slot:!0}),b(L).forEach(s),y=D(T),T.forEach(s),this.h()},h(){q(r,"class","order svelte-ziybgw"),q(n,"class","order-wrapper svelte-ziybgw"),q(n,"title",p=Be(e[26].status)),F(n,"background-color",ce(e[26])),F(n,"color",De(ce(e[26]))),N(l,"slot","start"),N(m,"color","#2e2e2e"),q(w,"class","sub svelte-ziybgw"),N(k,"button",""),N(L,"icon",Se),N(L,"slot","end"),this.first=t},m(E,T){U(E,t,T),o(t,l),o(l,n),o(n,r),o(r,d),o(t,I),o(t,k),o(k,m),o(m,c),o(c,g),o(c,a),C&&C.m(c,null),o(k,O),o(k,w),o(t,A),o(t,L),o(t,y),P||(S=Z(k,"click",z),P=!0)},p(E,T){e=E,T[0]&8&&_!==(_=parseInt(e[26].pos)+1+"")&&ae(d,_),T[0]&8&&p!==(p=Be(e[26].status))&&q(n,"title",p),T[0]&8&&F(n,"background-color",ce(e[26])),T[0]&8&&F(n,"color",De(ce(e[26]))),T[0]&8&&v!==(v=e[26].title+"")&&ae(g,v),T[0]&8&&(h=e[26].support_list&&e[26].support_list.length||e[10](e[26])),h?C||(C=Et(),C.c(),C.m(c,null)):C&&(C.d(1),C=null)},d(E){E&&s(t),C&&C.d(),P=!1,S()}}}function Ot(i){let e;return{c(){e=u("span"),this.h()},l(t){e=f(t,"SPAN",{class:!0}),b(e).forEach(s),this.h()},h(){q(e,"class","notes svelte-ziybgw")},m(t,l){U(t,e,l)},d(t){t&&s(e)}}}function Nt(i,e){let t,l,n,r,_=parseInt(e[26].pos)+1+"",d,p,I,k,m,c,v=e[26].title+"",g,a,h=e[26].support_list&&e[26].support_list.length||e[10](e[26]),O,w,H="",A,L,y,P,S,C=h&&Ot();function z(){return e[16](e[26],e[28])}return{key:i,first:null,c(){t=u("ion-item"),l=u("ion-avatar"),n=u("div"),r=u("div"),d=Q(_),I=B(),k=u("ion-label"),m=u("ion-text"),c=u("h3"),g=Q(v),a=B(),C&&C.c(),O=B(),w=u("div"),w.innerHTML=H,A=B(),L=u("ion-icon"),y=B(),this.h()},l(E){t=f(E,"ION-ITEM",{});var T=b(t);l=f(T,"ION-AVATAR",{slot:!0});var M=b(l);n=f(M,"DIV",{class:!0,title:!0,style:!0});var j=b(n);r=f(j,"DIV",{class:!0});var K=b(r);d=$(K,_),K.forEach(s),j.forEach(s),M.forEach(s),I=D(T),k=f(T,"ION-LABEL",{button:!0});var G=b(k);m=f(G,"ION-TEXT",{color:!0});var X=b(m);c=f(X,"H3",{});var ee=b(c);g=$(ee,v),a=D(ee),C&&C.l(ee),ee.forEach(s),X.forEach(s),O=D(G),w=f(G,"DIV",{class:!0,"data-svelte-h":!0}),W(w)!=="svelte-130ohbs"&&(w.innerHTML=H),G.forEach(s),A=D(T),L=f(T,"ION-ICON",{icon:!0,slot:!0}),b(L).forEach(s),y=D(T),T.forEach(s),this.h()},h(){q(r,"class","order svelte-ziybgw"),q(n,"class","order-wrapper svelte-ziybgw"),q(n,"title",p=Be(e[26].status)),F(n,"background-color",ce(e[26])),F(n,"color",De(ce(e[26]))),N(l,"slot","start"),N(m,"color","#2e2e2e"),q(w,"class","sub svelte-ziybgw"),N(k,"button",""),N(L,"icon",Se),N(L,"slot","end"),this.first=t},m(E,T){U(E,t,T),o(t,l),o(l,n),o(n,r),o(r,d),o(t,I),o(t,k),o(k,m),o(m,c),o(c,g),o(c,a),C&&C.m(c,null),o(k,O),o(k,w),o(t,A),o(t,L),o(t,y),P||(S=Z(k,"click",z),P=!0)},p(E,T){e=E,T[0]&8&&_!==(_=parseInt(e[26].pos)+1+"")&&ae(d,_),T[0]&8&&p!==(p=Be(e[26].status))&&q(n,"title",p),T[0]&8&&F(n,"background-color",ce(e[26])),T[0]&8&&F(n,"color",De(ce(e[26]))),T[0]&8&&v!==(v=e[26].title+"")&&ae(g,v),T[0]&8&&(h=e[26].support_list&&e[26].support_list.length||e[10](e[26])),h?C||(C=Ot(),C.c(),C.m(c,null)):C&&(C.d(1),C=null)},d(E){E&&s(t),C&&C.d(),P=!1,S()}}}function Tn(i){let e,t,l,n,r=`<ion-icon icon="${Gt}"></ion-icon>`,_,d,p,I=i[2].name+"",k,m,c,v=i[4].name+"",g,a,h,O,w;function H(y,P){return y[5].length>0?In:En}let A=H(i),L=A(i);return{c(){e=u("ion-header"),t=u("ion-toolbar"),l=u("ion-buttons"),n=u("ion-button"),n.innerHTML=r,_=B(),d=u("ion-buttons"),p=u("ion-button"),k=Q(I),m=B(),c=u("ion-title"),g=Q(v),a=B(),L.c(),h=ue(),this.h()},l(y){e=f(y,"ION-HEADER",{translucent:!0});var P=b(e);t=f(P,"ION-TOOLBAR",{});var S=b(t);l=f(S,"ION-BUTTONS",{slot:!0});var C=b(l);n=f(C,"ION-BUTTON",{title:!0,alt:!0,"data-svelte-h":!0}),W(n)!=="svelte-7ppz3r"&&(n.innerHTML=r),C.forEach(s),_=D(S),d=f(S,"ION-BUTTONS",{slot:!0});var z=b(d);p=f(z,"ION-BUTTON",{});var E=b(p);k=$(E,I),E.forEach(s),z.forEach(s),m=D(S),c=f(S,"ION-TITLE",{});var T=b(c);g=$(T,v),T.forEach(s),S.forEach(s),P.forEach(s),a=D(y),L.l(y),h=ue(),this.h()},h(){N(n,"title","Atrás"),N(n,"alt","Atrás"),N(l,"slot","start"),N(d,"slot","secondary"),N(e,"translucent","")},m(y,P){U(y,e,P),o(e,t),o(t,l),o(l,n),o(t,_),o(t,d),o(d,p),o(p,k),o(t,m),o(t,c),o(c,g),U(y,a,P),L.m(y,P),U(y,h,P),O||(w=Z(n,"click",i[11]),O=!0)},p(y,P){P[0]&4&&I!==(I=y[2].name+"")&&ae(k,I),P[0]&16&&v!==(v=y[4].name+"")&&ae(g,v),A===(A=H(y))&&L?L.p(y,P):(L.d(1),L=A(y),L&&(L.c(),L.m(h.parentNode,h)))},d(y){y&&(s(e),s(a),s(h)),L.d(y),O=!1,w()}}}function yn(i){let e,t,l,n=i[2]&&bt(i);return{c(){e=B(),n&&n.c(),t=ue(),this.h()},l(r){Dt("svelte-kn0kph",document.head).forEach(s),e=D(r),n&&n.l(r),t=ue(),this.h()},h(){document.title="Rutaflow - Detalles de ruta"},m(r,_){U(r,e,_),n&&n.m(r,_),U(r,t,_),l=!0},p(r,_){r[2]?n?(n.p(r,_),_[0]&4&&ze(n,1)):(n=bt(r),n.c(),ze(n,1),n.m(t.parentNode,t)):n&&(qt(),Qe(n,1,1,()=>{n=null}),St())},i(r){l||(ze(n),l=!0)},o(r){Qe(n),l=!1},d(r){r&&(s(e),s(t)),n&&n.d(r)}}}function ce(i){let e="#ffffff";return i.status==="pending"?e="#f2e300":i.status==="completed"&&(e="#44d900"),e}function Be(i){let e="";return i=="pending"?e="Pendiente":i=="completed"&&(e="Completado"),e}function De(i){i.slice(0,1)==="#"&&(i=i.slice(1)),i.length===3&&(i=i.split("").map(function(r){return r+r}).join(""));const e=parseInt(i.substr(0,2),16),t=parseInt(i.substr(2,2),16),l=parseInt(i.substr(4,2),16);return(e*299+t*587+l*114)/1e3>=128?"#414040":"#fff"}function $e(i,e){let t=new FormData;return t.append("id_route",i),t.append("status",e),fetch("https://rutaflow-app-development.up.railway.app/api/admin/route/change_status.php",{method:"POST",body:t}).then(l=>l.json()).then(l=>{}).catch(l=>{console.error("Error fetching data:",l)}),""}const Cn=i=>i.img;function wn(i,e,t){let l;Pt(i,Wt,E=>t(14,l=E));var n=this&&this.__awaiter||function(E,T,M,j){function K(G){return G instanceof M?G:new M(function(X){X(G)})}return new(M||(M=Promise))(function(G,X){function ee(oe){try{_e(j.next(oe))}catch(ge){X(ge)}}function fe(oe){try{_e(j.throw(oe))}catch(ge){X(ge)}}function _e(oe){oe.done?G(oe.value):K(oe.value).then(ee,fe)}_e((j=j.apply(E,T||[])).next())})};let{routeId:r}=e,{driverId:_}=e,d=new Object,p=[],I={},k={},m;const c=()=>n(void 0,void 0,void 0,function*(){yield v(r),m.complete()});function v(E){const T=new FormData;T.append("id_route",E),fetch("https://rutaflow-app-development.up.railway.app/api/admin/report/seguimiento_list.php",{method:"POST",body:T}).then(M=>M.json()).then(M=>{t(4,I=M.data.seguimiento_list[0]),t(3,p=M.data.event_list),t(5,k=M.data.checklist)}).catch(M=>{console.error("Error fetching data:",M)})}const g=E=>new Promise((T,M)=>{const j=new FormData;j.append("id_route",E.id_route),j.append("id_event",E.id_event),fetch("https://rutaflow-app-development.up.railway.app/api/admin/evidence/evidence_by_event.php",{method:"POST",body:j}).then(K=>K.json()).then(K=>{T(K.data.event_evidence[0])}).catch(K=>{console.error("Error fetching data:",K),M(K)})}),a=(E,T)=>{g(E).then(M=>{E.client_name=I.client_name,M&&(E.img=M.img,E.driver_comments=M.driver_comments,E.comments=M.comments),je("modal-delivery-info",kn,{delivery:E,isLast:T}).then(j=>{})})},h=(E,T,M)=>{var j=!1;return je("modal-checklist",wt,{checklist:E,driverId:T,routeId:M,isLast:j}).then(K=>{}),$e(M,"checklist"),""},O=E=>{if(E.tracking_type=="subscription"){if(E.subscriber_info&&E.payment_type==="cash"&&new Date(E.subscriber_info.payment_next)<new Date)return!0}else if(E.tracking_type=="ecommerce"&&Number(E.payment_pending)>0)return!0;return!1},w=()=>{d.id_driver?ye(`/drivers/${d.id_driver}`):ye("/drivers/me")},H=(E,T)=>n(void 0,void 0,void 0,function*(){yield(yield Ve.create({header:E||"Error",message:T||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()});function A(E){return E===p.length-1}function L(E){He[E?"unshift":"push"](()=>{m=E,t(6,m)})}const y=(E,T)=>a(E,A(T));function P(E){He[E?"unshift":"push"](()=>{m=E,t(6,m)})}const S=(E,T)=>a(E,A(T));function C(E){He[E?"unshift":"push"](()=>{m=E,t(6,m)})}const z=E=>{const T=p.findIndex(G=>G.id_event===E.id_event),M=T===0,j=T>0?p[T-1]:null;M||j&&j.img;const K=E.img!==null&&E.img!=="";K||M&&!K?a(E):H("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")};return i.$$set=E=>{"routeId"in E&&t(0,r=E.routeId),"driverId"in E&&t(1,_=E.driverId)},i.$$.update=()=>{i.$$.dirty[0]&16389&&(t(0,{routeId:r,driverId:_}=l.params,r,(t(1,_),t(14,l),t(2,d),t(0,r))),t(2,d=JSON.parse(localStorage.getItem("userSession"))),d?d.id_user&&(d.type=="admin"||d.type=="superadmin")?(ye(`/drivers/me/routes/${r}`),v(r)):d.id_user&&d.id_driver&&(v(r),ye(`/drivers/${d.id_driver}/routes/${r}`)):ye("/"))},[r,_,d,p,I,k,m,c,a,h,O,w,H,A,l,L,y,P,S,C,z]}class Rn extends Ge{constructor(e){super(),We(this,e,wn,yn,Ke,{routeId:0,driverId:1},null,[-1,-1])}}export{Rn as component};

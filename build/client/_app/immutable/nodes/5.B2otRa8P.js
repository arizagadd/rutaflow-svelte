import{Z as ht,s as Je,e as s,j as y,b as c,q as m,d as ne,h as a,m as w,v as g,i as W,w as o,x as se,n as ze,z as Pe,_ as en,B as b,o as xe,k as Me,$ as pt,t as _e,r as he,f as G,a0 as tn,a1 as Ze,A as Se,y as we,a2 as nn,a3 as Xe,a4 as on,a5 as ln,l as rn,p as an,F as sn}from"../chunks/index.CdEBkEwf.js";import{S as Ye,i as Qe,t as rt,a as ut,c as cn,b as un,d as fn,m as dn,e as _n,g as hn}from"../chunks/index.c2pjNB5R.js";import{e as Re,u as $e,d as et,a as pn,c as mn,i as Jt,b as vn,f as Yt,g as gn,h as bn,j as ft,k as En,m as Qt,n as Zt,s as mt,o as Ve,q as In,r as kn,t as On,v as Nn,w as Tn,x as Cn,y as yn,z as wn,p as Ln}from"../chunks/index.S9nXQbqE.js";import"../chunks/index-48209844.IIRtDZyg.js";import{m as tt,D as at,a as qe,I as zn}from"../chunks/IonPage.ChDy1LXu.js";import{q as An,t as Mn}from"../chunks/ion-modal.CsJaVgKZ.js";import{g as je}from"../chunks/entry.B-LPgbXi.js";const Sn=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global,Dn=(l,e)=>{if(!customElements.get(l)){class t extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const n={};for(const r of this.attributes)n[r.name]=r.value;new e({target:this.shadowRoot,props:n})}}customElements.define(l,t)}},Pn=function(l){return document.createElement(l).constructor!==HTMLElement},Hn=(l,e)=>{Pn(l)||Dn(l,e)},Ue=async(l,e,t)=>{An(),Mn(),Hn(l,e);const i=await tt.create({component:l,componentProps:t});return i.present(),await i.onWillDismiss()};let Ke=ht({km_inicial:[],gas_inicial:[],km_final:[],gas_final:[]}),xt=ht({flag:[]});function Bn(l){let e,t,i,n,r="Cancelar",d,u,_="Captura de Km/Gas",k,E,h,f="Confirmar",v,I,T,L,V,A,F;return{c(){e=s("ion-header"),t=s("ion-toolbar"),i=s("ion-buttons"),n=s("ion-button"),n.textContent=r,d=y(),u=s("ion-title"),u.textContent=_,k=y(),E=s("ion-buttons"),h=s("ion-button"),h.textContent=f,v=y(),I=s("ion-content"),T=s("ion-item"),L=s("ion-input"),this.h()},l(q){e=c(q,"ION-HEADER",{translucent:!0});var R=m(e);t=c(R,"ION-TOOLBAR",{});var S=m(t);i=c(S,"ION-BUTTONS",{slot:!0});var P=m(i);n=c(P,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),ne(n)!=="svelte-17pq4f4"&&(n.textContent=r),P.forEach(a),d=w(S),u=c(S,"ION-TITLE",{"data-svelte-h":!0}),ne(u)!=="svelte-1yhkaq7"&&(u.textContent=_),k=w(S),E=c(S,"ION-BUTTONS",{slot:!0});var B=m(E);h=c(B,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),ne(h)!=="svelte-cm6j4s"&&(h.textContent=f),B.forEach(a),S.forEach(a),R.forEach(a),v=w(q),I=c(q,"ION-CONTENT",{fullscreen:!0});var D=m(I);T=c(D,"ION-ITEM",{});var O=m(T);L=c(O,"ION-INPUT",{class:!0,inputmode:!0,pattern:!0,type:!0,placeholder:!0,value:!0,required:!0});var K=m(L);K.forEach(a),O.forEach(a),D.forEach(a),this.h()},h(){g(n,"color","medium"),g(i,"slot","start"),g(h,"strong",""),g(E,"slot","end"),g(e,"translucent",""),g(L,"class","fin-km"),g(L,"inputmode","numeric"),g(L,"pattern","[0-9]*"),g(L,"type","number"),g(L,"placeholder",V="Ingresa "+l[0]+" actual"),g(L,"value",l[1]),g(L,"required",""),g(I,"fullscreen","")},m(q,R){W(q,e,R),o(e,t),o(t,i),o(i,n),o(t,d),o(t,u),o(t,k),o(t,E),o(E,h),W(q,v,R),W(q,I,R),o(I,T),o(T,L),A||(F=[se(n,"click",l[2]),se(h,"click",l[3]),se(L,"input",l[4])],A=!0)},p(q,[R]){R&1&&V!==(V="Ingresa "+q[0]+" actual")&&g(L,"placeholder",V),R&2&&g(L,"value",q[1])},i:ze,o:ze,d(q){q&&(a(e),a(v),a(I)),A=!1,Pe(F)}}}function Rn(l,e,t){const i=en();let r=document.querySelector("ion-modal").componentProps.data_type,d;xt.subscribe(h=>{r=h.flag[0],r=="km_final"||r=="km_inicial"?t(0,d="kilometraje"):t(0,d="litros de gasolina")});let u=0;function _(){tt.dismiss()}function k(){i("modalResult",{data:"Your data",role:"confirm"}),r=="km_inicial"?Ke.update(f=>({...f,km_inicial:[u]})):r=="gas_inicial"?Ke.update(f=>({...f,gas_inicial:[u]})):r=="km_final"?Ke.update(f=>({...f,km_final:[u]})):r=="gas_final"&&Ke.update(f=>({...f,gas_final:[u]})),_()}return[d,u,_,k,h=>t(1,u=h.target.value)]}class Un extends Ye{constructor(e){super(),Qe(this,e,Rn,Bn,Je,{})}}const st=ht({items:[],checkedIndices:[],mandatory:[]});function bt(l,e,t){const i=l.slice();return i[55]=e[t],i[56]=e,i[57]=t,i}function Vn(l){let e,t,i,n,r,d="Kilometraje inicial",u,_,k=l[0]?l[0]+" km.":"Cargar km",E,h,f,v,I,T,L,V="Gasolina inicial (litros)",A,F,q=l[1]?l[1]+" litros":"Cargar gas",R,S,P,B;return S=pt(l[21][0]),{c(){e=s("ion-item"),t=s("ion-label"),i=s("input"),n=y(),r=s("p"),r.textContent=d,u=y(),_=s("ion-button"),E=_e(k),h=y(),f=s("ion-item"),v=s("ion-label"),I=s("input"),T=y(),L=s("p"),L.textContent=V,A=y(),F=s("ion-button"),R=_e(q),this.h()},l(D){e=c(D,"ION-ITEM",{});var O=m(e);t=c(O,"ION-LABEL",{style:!0});var K=m(t);i=c(K,"INPUT",{id:!0,style:!0,type:!0}),n=w(K),r=c(K,"P",{style:!0,"data-svelte-h":!0}),ne(r)!=="svelte-88twxi"&&(r.textContent=d),K.forEach(a),u=w(O),_=c(O,"ION-BUTTON",{fill:!0,size:!0,class:!0,"aria-selected":!0});var H=m(_);E=he(H,k),H.forEach(a),O.forEach(a),h=w(D),f=c(D,"ION-ITEM",{});var M=m(f);v=c(M,"ION-LABEL",{style:!0});var U=m(v);I=c(U,"INPUT",{id:!0,style:!0,type:!0}),T=w(U),L=c(U,"P",{style:!0,"data-svelte-h":!0}),ne(L)!=="svelte-1ux30eb"&&(L.textContent=V),U.forEach(a),A=w(M),F=c(M,"ION-BUTTON",{fill:!0,class:!0,size:!0,style:!0});var x=m(F);R=he(x,q),x.forEach(a),M.forEach(a),this.h()},h(){G(i,"id","chkbox-km-ini"),b(i,"pointer-events","auto"),G(i,"type","checkbox"),i.required=!0,b(r,"margin-left","10px"),b(t,"display","flex"),g(_,"fill","outline"),g(_,"size","small"),g(_,"class","loadKmInicial"),g(_,"aria-selected",""),G(I,"id","chkbox-gas-ini"),b(I,"pointer-events","auto"),G(I,"type","checkbox"),I.required=!0,b(L,"margin-left","10px"),b(v,"display","flex"),g(F,"fill","outline"),g(F,"class","loadGasInicial"),g(F,"size","small"),b(F,"height","16px "),S.p(i,I)},m(D,O){W(D,e,O),o(e,t),o(t,i),i.checked=~(l[4]||[]).indexOf(i.__value),l[28](i),o(t,n),o(t,r),o(e,u),o(e,_),o(_,E),W(D,h,O),W(D,f,O),o(f,v),o(v,I),l[30](I),I.checked=~(l[4]||[]).indexOf(I.__value),o(v,T),o(v,L),o(f,A),o(f,F),o(F,R),P||(B=[se(i,"change",l[27]),se(_,"click",l[29]),se(I,"change",l[31]),se(F,"click",l[32])],P=!0)},p(D,O){O[0]&16&&(i.checked=~(D[4]||[]).indexOf(i.__value)),O[0]&1&&k!==(k=D[0]?D[0]+" km.":"Cargar km")&&we(E,k),O[0]&16&&(I.checked=~(D[4]||[]).indexOf(I.__value)),O[0]&2&&q!==(q=D[1]?D[1]+" litros":"Cargar gas")&&we(R,q)},d(D){D&&(a(e),a(h),a(f)),l[28](null),l[30](null),S.r(),P=!1,Pe(B)}}}function Fn(l){let e,t,i,n,r,d="Kilometraje final",u,_,k=l[2]?l[2]+" km.":"Cargar km",E,h,f,v,I,T,L,V="Gasolina final (litros)",A,F,q=l[3]?l[3]+" litros":"Cargar gas",R,S,P,B;return S=pt(l[21][0]),{c(){e=s("ion-item"),t=s("ion-label"),i=s("input"),n=y(),r=s("p"),r.textContent=d,u=y(),_=s("ion-button"),E=_e(k),h=y(),f=s("ion-item"),v=s("ion-label"),I=s("input"),T=y(),L=s("p"),L.textContent=V,A=y(),F=s("ion-button"),R=_e(q),this.h()},l(D){e=c(D,"ION-ITEM",{});var O=m(e);t=c(O,"ION-LABEL",{style:!0});var K=m(t);i=c(K,"INPUT",{id:!0,style:!0,type:!0}),n=w(K),r=c(K,"P",{style:!0,"data-svelte-h":!0}),ne(r)!=="svelte-ccmu71"&&(r.textContent=d),K.forEach(a),u=w(O),_=c(O,"ION-BUTTON",{fill:!0,size:!0,class:!0,"aria-selected":!0});var H=m(_);E=he(H,k),H.forEach(a),O.forEach(a),h=w(D),f=c(D,"ION-ITEM",{});var M=m(f);v=c(M,"ION-LABEL",{style:!0});var U=m(v);I=c(U,"INPUT",{id:!0,style:!0,type:!0}),T=w(U),L=c(U,"P",{style:!0,"data-svelte-h":!0}),ne(L)!=="svelte-wsoyd2"&&(L.textContent=V),U.forEach(a),A=w(M),F=c(M,"ION-BUTTON",{fill:!0,size:!0,class:!0});var x=m(F);R=he(x,q),x.forEach(a),M.forEach(a),this.h()},h(){G(i,"id","chkbox-km-fin"),b(i,"pointer-events","auto"),G(i,"type","checkbox"),i.required=!0,b(r,"margin-left","10px"),b(t,"display","flex"),g(_,"fill","outline"),g(_,"size","small"),g(_,"class","loadKmInicial"),g(_,"aria-selected",""),G(I,"id","chkbox-gas-fin"),b(I,"pointer-events","auto"),G(I,"type","checkbox"),I.required=!0,b(L,"margin-left","10px"),b(v,"display","flex"),g(F,"fill","outline"),g(F,"size","small"),g(F,"class","loadGasInicial"),S.p(i,I)},m(D,O){W(D,e,O),o(e,t),o(t,i),i.checked=~(l[4]||[]).indexOf(i.__value),l[22](i),o(t,n),o(t,r),o(e,u),o(e,_),o(_,E),W(D,h,O),W(D,f,O),o(f,v),o(v,I),I.checked=~(l[4]||[]).indexOf(I.__value),l[25](I),o(v,T),o(v,L),o(f,A),o(f,F),o(F,R),P||(B=[se(i,"change",l[20]),se(_,"click",l[23]),se(I,"change",l[24]),se(F,"click",l[26])],P=!0)},p(D,O){O[0]&16&&(i.checked=~(D[4]||[]).indexOf(i.__value)),O[0]&4&&k!==(k=D[2]?D[2]+" km.":"Cargar km")&&we(E,k),O[0]&16&&(I.checked=~(D[4]||[]).indexOf(I.__value)),O[0]&8&&q!==(q=D[3]?D[3]+" litros":"Cargar gas")&&we(R,q)},d(D){D&&(a(e),a(h),a(f)),l[22](null),l[25](null),S.r(),P=!1,Pe(B)}}}function jn(l){let e=[],t=new Map,i,n=Re(l[13]);const r=d=>d[55].id_checklist_event;for(let d=0;d<n.length;d+=1){let u=bt(l,n,d),_=r(u);t.set(_,e[d]=Et(_,u))}return{c(){for(let d=0;d<e.length;d+=1)e[d].c();i=Me()},l(d){for(let u=0;u<e.length;u+=1)e[u].l(d);i=Me()},m(d,u){for(let _=0;_<e.length;_+=1)e[_]&&e[_].m(d,u);W(d,i,u)},p(d,u){u[0]&407664&&(n=Re(d[13]),e=$e(e,u,r,1,d,n,t,i.parentNode,et,Et,i,bt))},d(d){d&&a(i);for(let u=0;u<e.length;u+=1)e[u].d(d)}}}function qn(l){let e,t=(l[12][l[55].id_checklist_event]?l[12][l[55].id_checklist_event]:"Cargar evidencia")+"",i;return{c(){e=s("label"),i=_e(t),this.h()},l(n){e=c(n,"LABEL",{for:!0,class:!0});var r=m(e);i=he(r,t),r.forEach(a),this.h()},h(){G(e,"for","chklist-"+l[55].id_checklist_event),G(e,"class","button-label svelte-1ruehls")},m(n,r){W(n,e,r),o(e,i)},p(n,r){r[0]&4096&&t!==(t=(n[12][n[55].id_checklist_event]?n[12][n[55].id_checklist_event]:"Cargar evidencia")+"")&&we(i,t)},d(n){n&&a(e)}}}function Gn(l){let e;return{c(){e=s("ion-spinner"),this.h()},l(t){e=c(t,"ION-SPINNER",{name:!0,class:!0}),m(e).forEach(a),this.h()},h(){g(e,"name","dots"),g(e,"class","button-spinner svelte-1ruehls")},m(t,i){W(t,e,i)},p:ze,d(t){t&&a(e)}}}function Et(l,e){let t,i,n,r=e[55],d,u,_=e[55].item+"",k,E,h,f=e[55].mandatory=="1"?" * ":"",v,I,T,L,V,A,F,q,R,S;const P=()=>e[34](n,r),B=()=>e[34](null,r);function D(){return e[35](e[55])}function O(U,x){return U[11][U[55].id_checklist_event]?Gn:qn}let K=O(e),H=K(e);function M(...U){return e[37](e[55],...U)}return q=pt(e[21][0]),{key:l,first:null,c(){t=s("ion-item"),i=s("ion-label"),n=s("input"),d=y(),u=s("p"),k=_e(_),E=y(),h=s("b"),v=_e(f),I=y(),T=s("ion-button"),L=s("div"),H.c(),V=y(),A=s("input"),F=y(),this.h()},l(U){t=c(U,"ION-ITEM",{});var x=m(t);i=c(x,"ION-LABEL",{style:!0});var oe=m(i);n=c(oe,"INPUT",{id:!0,style:!0,type:!0}),d=w(oe),u=c(oe,"P",{style:!0});var ee=m(u);k=he(ee,_),E=w(ee),ee.forEach(a),h=c(oe,"B",{style:!0});var fe=m(h);v=he(fe,f),fe.forEach(a),oe.forEach(a),I=w(x),T=c(x,"ION-BUTTON",{fill:!0,class:!0,size:!0});var ae=m(T);L=c(ae,"DIV",{class:!0});var le=m(L);H.l(le),V=w(le),A=c(le,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0,capture:!0}),le.forEach(a),ae.forEach(a),F=w(x),x.forEach(a),this.h()},h(){G(n,"id",`chkbox-${e[55].id_checklist_event}`),b(n,"pointer-events","auto"),G(n,"type","checkbox"),n.__value=e[55].id_checklist_event,tn(n,n.__value),n.required=!0,b(u,"margin-left","10px"),b(h,"margin-left","5px"),b(i,"display","flex"),b(A,"display","none"),G(A,"id","chklist-"+e[55].id_checklist_event),G(A,"name","fileToUpload"),G(A,"type","file"),G(A,"accept","image/*"),G(A,"capture","environment"),G(L,"class","button-content svelte-1ruehls"),g(T,"fill","outline"),g(T,"class","loadEvidence svelte-1ruehls"),g(T,"size","small"),q.p(n),this.first=t},m(U,x){W(U,t,x),o(t,i),o(i,n),n.checked=~(e[4]||[]).indexOf(n.__value),P(),o(i,d),o(i,u),o(u,k),o(u,E),o(i,h),o(h,v),o(t,I),o(t,T),o(T,L),H.m(L,null),o(L,V),o(L,A),e[36](A),o(t,F),R||(S=[se(n,"change",e[33]),se(n,"change",D),se(A,"change",M)],R=!0)},p(U,x){e=U,x[0]&16&&(n.checked=~(e[4]||[]).indexOf(n.__value)),r!==e[55]&&(B(),r=e[55],P()),K===(K=O(e))&&H?H.p(e,x):(H.d(1),H=K(e),H&&(H.c(),H.m(L,V)))},d(U){U&&a(t),B(),H.d(),e[36](null),q.r(),R=!1,Pe(S)}}}function Kn(l){let e,t,i,n,r="Cancelar",d,u,_="REQUERIMIENTOS DE RUTA",k,E,h,f,v,I,T,L="Confirmar",V,A;function F(P,B){return P[14]?Fn:Vn}let R=F(l)(l),S=l[13]&&jn(l);return{c(){e=s("ion-header"),t=s("ion-toolbar"),i=s("ion-buttons"),n=s("ion-button"),n.textContent=r,d=y(),u=s("ion-title"),u.textContent=_,k=y(),E=s("ion-content"),h=s("ion-list"),R.c(),f=y(),S&&S.c(),v=y(),I=s("ion-footer"),T=s("ion-button"),T.textContent=L,this.h()},l(P){e=c(P,"ION-HEADER",{translucent:!0});var B=m(e);t=c(B,"ION-TOOLBAR",{});var D=m(t);i=c(D,"ION-BUTTONS",{slot:!0});var O=m(i);n=c(O,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),ne(n)!=="svelte-1dnmkxs"&&(n.textContent=r),O.forEach(a),d=w(D),u=c(D,"ION-TITLE",{"data-svelte-h":!0}),ne(u)!=="svelte-19bar5p"&&(u.textContent=_),D.forEach(a),B.forEach(a),k=w(P),E=c(P,"ION-CONTENT",{fullscreen:!0});var K=m(E);h=c(K,"ION-LIST",{});var H=m(h);R.l(H),f=w(H),S&&S.l(H),H.forEach(a),K.forEach(a),v=w(P),I=c(P,"ION-FOOTER",{});var M=m(I);T=c(M,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),ne(T)!=="svelte-g82qqw"&&(T.textContent=L),M.forEach(a),this.h()},h(){g(n,"color","medium"),g(i,"slot","start"),g(e,"translucent",""),g(E,"fullscreen",""),g(T,"fill","outline"),g(T,"color","tertiary"),g(T,"strong",""),b(T,"width","99%"),b(T,"height","auto")},m(P,B){W(P,e,B),o(e,t),o(t,i),o(i,n),o(t,d),o(t,u),W(P,k,B),W(P,E,B),o(E,h),R.m(h,null),o(h,f),S&&S.m(h,null),W(P,v,B),W(P,I,B),o(I,T),V||(A=[se(n,"click",l[15]),se(T,"click",l[16])],V=!0)},p(P,B){R.p(P,B),P[13]&&S.p(P,B)},i:ze,o:ze,d(P){P&&(a(e),a(k),a(E),a(v),a(I)),R.d(),S&&S.d(),V=!1,Pe(A)}}}function dt(l,e){if(typeof l=="object"&&l!==null||Array.isArray(l)){if(Array.isArray(l))return l.map(t=>dt(t,e)).flat();{const t=Object.keys(l);let i;return e=="id_checklist_event"?i=t.filter(r=>r.toLowerCase().includes("id_checklist_event")).map(r=>l[r]):e=="mandatory"?i=t.filter(r=>r.toLowerCase().includes("mandatory")).map(r=>l[r]):(console.error("Tipo de dato no reconocido."),i=!1),i}}else return console.error("Invalid input. Please provide a valid object or array."),[]}function Xn(l,e,t){let i=at,n=document.querySelector("ion-modal");const r=n.componentProps.checklist,d=n.componentProps.driverId,u=n.componentProps.routeId,_=n.componentProps.isLast;let k,E,h,f,v=[],I=null,T={},L,V,A,F,q={},R=new Object,S={},P={};xe(()=>{R=JSON.parse(localStorage.getItem("userSession")),_?console.log("Último checklist"):st.update(N=>(N.mandatory=dt(r,"mandatory"),N.items=dt(r,"id_checklist_event"),N))});function B(N){t(11,q[N]=!0,q)}const D=async()=>{await(await qe.create({header:"Datos o checklist incompletos",message:"Carga la evidencia requerida y marca todas las casillas para confirmar",buttons:[{text:"Cerrar"}]})).present()},O=async()=>{await(await qe.create({header:"Datos capturados",message:"El kilometraje y gasolina final fueron registrados correctamente, espere aprobación para finalizar ruta",buttons:[{text:"Cerrar"}]})).present()},K=async N=>{await(await qe.create({header:"Datos inválidos",message:N=="km"?"Llena correctamente el campo de kilometraje inicial":"Llena correctamente el campo de gasolina inicial",buttons:[{text:"Cerrar"}]})).present()},H=()=>{tt.dismiss(),d?je(`/drivers/${d}`):je("/drivers/me")},M=()=>{if(_){var N=fe(h,"km"),J=fe(f,"gas");let re=new FormData;re.append("km_final",N),re.append("gas_final",J),re.append("id_route",u),re=Ee(re),N&&J?(H(),fetch(`${i}api/admin/checklist/add_evidence.php`,{method:"POST",body:re}).then(pe=>pe.json()).then(pe=>{O()}).catch(pe=>{console.error("Error fetching data:",pe)})):D()}else{var ie=fe(k,"km"),$=fe(E,"gas");st.update(re=>{re.items;const pe=re.mandatory;if(re.items.filter((Te,ke)=>re.mandatory[ke]==="1").every(Te=>re.checkedIndices.includes(Te))&&ie&&$){H();let Te=new FormData;Te=Ee(Te),Te.append("km_inicial",ie),Te.append("gas_inicial",$),Te.append("id_route",u);for(const ke in S)if(S.hasOwnProperty(ke)){const{img:Be,img_id:Ge}=S[ke];Te.append(`selectedImages[${ke}][img]`,Be),Te.append(`selectedImages[${ke}][img_id]`,Ge)}fetch(`${i}api/admin/checklist/add_evidence.php`,{method:"POST",body:Te}).then(ke=>ke.json()).then(ke=>{pe&&pe.some(Be=>Be==="1")?ee(u,"checklist-pending"):ee(u,"enroute")}).catch(ke=>{console.error("Error fetching data:",ke)})}else if(!pe&&ie&&$){let Te=new FormData;Te.append("km_inicial",ie),Te.append("gas_inicial",$),Te=Ee(Te),fetch(`${i}api/admin/checklist/add_evidence.php`,{method:"POST",body:Te}).then(ke=>ke.json()).then(ke=>{ee(u,"enroute")}).catch(ke=>{console.error("Error fetching data:",ke)})}else D();return re})}Oe()},U=async(N,J)=>{B(J);const $=N.target.files[0],re=await x($);if(re){let pe=new FormData;pe.append("fileToUpload",re),pe=Ee(pe);try{const Le=await fetch(`${i}api/admin/manager/upload_img_driver.php`,{method:"POST",body:pe});if(Le.ok){const ye=await Le.json();S={...S,[J]:{img:ye.img,img_id:ye.img_id}},t(12,P={...P,[J]:ye.filename}),oe(J),t(6,T[J].checked=!0,T),t(11,q[J]=!1,q)}else console.error("File upload failed:",Le.statusText)}catch(Le){console.error("Error during file upload:",Le)}}},x=async N=>new Promise(J=>{const ie=new Image;ie.src=URL.createObjectURL(N),ie.onload=()=>{const $=document.createElement("canvas"),re=$.getContext("2d"),pe=800,Le=600;let ye=ie.width,Te=ie.height;ye>pe&&(Te*=pe/ye,ye=pe),Te>Le&&(ye*=Le/Te,Te=Le),$.width=ye,$.height=Te,re.drawImage(ie,0,0,ye,Te),$.toBlob(ke=>{J(ke),URL.revokeObjectURL(ie.src),re.clearRect(0,0,$.width,$.height)},"image/jpeg",.7)}}),oe=N=>{st.update(J=>(J.checkedIndices.indexOf(N)===-1?J.checkedIndices.push(N):console.error(`ID ${N} is already checked.`),J.items.forEach($=>{$.id_checklist_event===N&&($.checked=!0)}),J))};function ee(N,J){let ie=new FormData;ie.append("id_route",N),ie.append("status",J),ie=Ee(ie),fetch(`${i}api/admin/route/change_status.php`,{method:"POST",body:ie}).then($=>$.json()).then($=>{}).catch($=>{console.error("Error fetching data:",$)})}function fe(N,J){return/^\d+$/.test(N)?parseInt(N,10):(K(J),null)}function ae(N,J){le(J),n.componentProps.data_type=J,Ue("modal-gas-km",Un,{r:J}).then(()=>{Ke.subscribe(ie=>{be(ie,J)})})}function le(N){xt.update(J=>({...J,flag:[N]}))}function be(N,J){t(0,k=N.km_inicial?N.km_inicial:null),t(1,E=N.gas_inicial?N.gas_inicial:null),t(2,h=N.km_final?N.km_final:null),t(3,f=N.gas_final?N.gas_final:null),J=="km_inicial"&&L&&t(7,L.checked=!0,L),J=="gas_inicial"&&V&&t(8,V.checked=!0,V),J=="km_final"&&A&&t(9,A.checked=!0,A),J=="gas_final"&&F&&t(10,F.checked=!0,F)}function Oe(){Ke.set({km_inicial:[],gas_inicial:[],km_final:[],gas_final:[]})}function Ee(N){return N.append("token",R.token),N.append("id_user_over",R.id_user),N}const me=[[]];function de(){v=Ze(me[0],this.__value,this.checked),t(4,v)}function ue(N){Se[N?"unshift":"push"](()=>{A=N,t(9,A)})}const Ne=N=>ae(N,"km_final");function ve(){v=Ze(me[0],this.__value,this.checked),t(4,v)}function Ie(N){Se[N?"unshift":"push"](()=>{F=N,t(10,F)})}const Ce=N=>ae(N,"gas_final");function ge(){v=Ze(me[0],this.__value,this.checked),t(4,v)}function ce(N){Se[N?"unshift":"push"](()=>{L=N,t(7,L)})}const Z=N=>ae(N,"km_inicial");function te(N){Se[N?"unshift":"push"](()=>{V=N,t(8,V)})}function Q(){v=Ze(me[0],this.__value,this.checked),t(4,v)}const p=N=>ae(N,"gas_inicial");function z(){v=Ze(me[0],this.__value,this.checked),t(4,v)}function C(N,J){Se[N?"unshift":"push"](()=>{T[J.id_checklist_event]=N,t(6,T)})}const j=N=>oe(N.id_checklist_event);function X(N){Se[N?"unshift":"push"](()=>{I=N,t(5,I)})}return[k,E,h,f,v,I,T,L,V,A,F,q,P,r,_,H,M,U,oe,ae,de,me,ue,Ne,ve,Ie,Ce,ge,ce,Z,te,Q,p,z,C,j,X,(N,J)=>U(J,N.id_checklist_event)]}class $t extends Ye{constructor(e){super(),Qe(this,e,Xn,Kn,Je,{},null,[-1,-1])}}function De(l,e){l=l.replace(/^#/,""),l.length===3&&(l=l.split("").map(r=>r+r).join(""));let t=parseInt(l.substring(0,2),16),i=parseInt(l.substring(2,4),16),n=parseInt(l.substring(4,6),16);return`rgba(${t}, ${i}, ${n}, ${e})`}function It(l,e,t){const i=l.slice();return i[51]=e[t],i[53]=t,i}function Wn(l){let e,t,i="Confirmar",n,r;return{c(){e=s("ion-buttons"),t=s("ion-button"),t.textContent=i,this.h()},l(d){e=c(d,"ION-BUTTONS",{slot:!0});var u=m(e);t=c(u,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),ne(t)!=="svelte-1ida0il"&&(t.textContent=i),u.forEach(a),this.h()},h(){g(t,"strong",""),g(e,"slot","end")},m(d,u){W(d,e,u),o(e,t),n||(r=se(t,"click",l[22]),n=!0)},p:ze,d(d){d&&a(e),n=!1,r()}}}function Jn(l){let e,t,i,n,r,d="Empresa",u,_,k=l[11].enterprise_name+"",E;return{c(){e=s("ion-item"),t=s("ion-icon"),i=y(),n=s("ion-label"),r=s("p"),r.textContent=d,u=y(),_=s("h2"),E=_e(k),this.h()},l(h){e=c(h,"ION-ITEM",{});var f=m(e);t=c(f,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),i=w(f),n=c(f,"ION-LABEL",{});var v=m(n);r=c(v,"P",{"data-svelte-h":!0}),ne(r)!=="svelte-6noid3"&&(r.textContent=d),u=w(v),_=c(v,"H2",{});var I=m(_);E=he(I,k),I.forEach(a),v.forEach(a),f.forEach(a),this.h()},h(){g(t,"icon",Zt),g(t,"slot","start")},m(h,f){W(h,e,f),o(e,t),o(e,i),o(e,n),o(n,r),o(n,u),o(n,_),o(_,E)},p:ze,d(h){h&&a(e)}}}function Yn(l){let e,t,i,n,r,d="Negocio",u,_,k=l[11].client_name+"",E;return{c(){e=s("ion-item"),t=s("ion-icon"),i=y(),n=s("ion-label"),r=s("p"),r.textContent=d,u=y(),_=s("h2"),E=_e(k),this.h()},l(h){e=c(h,"ION-ITEM",{});var f=m(e);t=c(f,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),i=w(f),n=c(f,"ION-LABEL",{});var v=m(n);r=c(v,"P",{"data-svelte-h":!0}),ne(r)!=="svelte-57b1dg"&&(r.textContent=d),u=w(v),_=c(v,"H2",{});var I=m(_);E=he(I,k),I.forEach(a),v.forEach(a),f.forEach(a),this.h()},h(){g(t,"icon",Zt),g(t,"slot","start")},m(h,f){W(h,e,f),o(e,t),o(e,i),o(e,n),o(n,r),o(n,u),o(n,_),o(_,E)},p:ze,d(h){h&&a(e)}}}function Qn(l){let e,t,i,n,r,d="Teléfono de Negocio",u,_,k=l[11].client_phone+"",E;return{c(){e=s("ion-item"),t=s("ion-icon"),i=y(),n=s("ion-label"),r=s("p"),r.textContent=d,u=y(),_=s("h2"),E=_e(k),this.h()},l(h){e=c(h,"ION-ITEM",{href:!0});var f=m(e);t=c(f,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),i=w(f),n=c(f,"ION-LABEL",{class:!0});var v=m(n);r=c(v,"P",{"data-svelte-h":!0}),ne(r)!=="svelte-1u5l7fz"&&(r.textContent=d),u=w(v),_=c(v,"H2",{});var I=m(_);E=he(I,k),I.forEach(a),v.forEach(a),f.forEach(a),this.h()},h(){g(t,"icon",pn),g(t,"slot","start"),g(n,"class","ion-text-wrap"),g(e,"href","tel:"+l[11].client_phone)},m(h,f){W(h,e,f),o(e,t),o(e,i),o(e,n),o(n,r),o(n,u),o(n,_),o(_,E)},p:ze,d(h){h&&a(e)}}}function Zn(l){let e,t,i,n,r,d="Domicilio Alternativo",u,_,k=l[11].line2+"",E,h,f;return{c(){e=s("ion-item"),t=s("ion-icon"),i=y(),n=s("ion-label"),r=s("p"),r.textContent=d,u=y(),_=s("h2"),E=_e(k),h=y(),f=s("ion-icon"),this.h()},l(v){e=c(v,"ION-ITEM",{href:!0});var I=m(e);t=c(I,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),i=w(I),n=c(I,"ION-LABEL",{class:!0});var T=m(n);r=c(T,"P",{"data-svelte-h":!0}),ne(r)!=="svelte-1ub9uzw"&&(r.textContent=d),u=w(T),_=c(T,"H2",{});var L=m(_);E=he(L,k),L.forEach(a),T.forEach(a),h=w(I),f=c(I,"ION-ICON",{icon:!0,slot:!0}),m(f).forEach(a),I.forEach(a),this.h()},h(){g(t,"icon",mt),g(t,"slot","start"),g(n,"class","ion-text-wrap"),g(f,"icon",Ve),g(f,"slot","end"),g(e,"href","https://www.google.com/maps/searhc/?api=1&query="+l[11].line2)},m(v,I){W(v,e,I),o(e,t),o(e,i),o(e,n),o(n,r),o(n,u),o(n,_),o(_,E),o(e,h),o(e,f)},p:ze,d(v){v&&a(e)}}}function xn(l){let e,t,i,n,r,d="Domicilio",u,_,k=l[11].line1+"",E,h,f,v,I=l[11].line2&&l[11].line2.trim().length,T,L=I&&$n(l);return{c(){e=s("ion-item"),t=s("ion-icon"),i=y(),n=s("ion-label"),r=s("p"),r.textContent=d,u=y(),_=s("h2"),E=_e(k),h=y(),f=s("ion-icon"),v=y(),L&&L.c(),T=Me(),this.h()},l(V){e=c(V,"ION-ITEM",{href:!0});var A=m(e);t=c(A,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),i=w(A),n=c(A,"ION-LABEL",{class:!0});var F=m(n);r=c(F,"P",{"data-svelte-h":!0}),ne(r)!=="svelte-cbm7q1"&&(r.textContent=d),u=w(F),_=c(F,"H2",{});var q=m(_);E=he(q,k),q.forEach(a),F.forEach(a),h=w(A),f=c(A,"ION-ICON",{icon:!0,slot:!0}),m(f).forEach(a),A.forEach(a),v=w(V),L&&L.l(V),T=Me(),this.h()},h(){g(t,"icon",mt),g(t,"slot","start"),g(n,"class","ion-text-wrap"),g(f,"icon",Ve),g(f,"slot","end"),g(e,"href","https://www.google.com/maps/search/?api=1&query="+l[11].line1)},m(V,A){W(V,e,A),o(e,t),o(e,i),o(e,n),o(n,r),o(n,u),o(n,_),o(_,E),o(e,h),o(e,f),W(V,v,A),L&&L.m(V,A),W(V,T,A)},p(V,A){I&&L.p(V,A)},d(V){V&&(a(e),a(v),a(T)),L&&L.d(V)}}}function $n(l){let e,t,i,n,r,d="Domicilio Alternativo",u,_,k=l[11].line2+"",E,h,f;return{c(){e=s("ion-item"),t=s("ion-icon"),i=y(),n=s("ion-label"),r=s("p"),r.textContent=d,u=y(),_=s("h2"),E=_e(k),h=y(),f=s("ion-icon"),this.h()},l(v){e=c(v,"ION-ITEM",{href:!0});var I=m(e);t=c(I,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),i=w(I),n=c(I,"ION-LABEL",{class:!0});var T=m(n);r=c(T,"P",{"data-svelte-h":!0}),ne(r)!=="svelte-1ub9uzw"&&(r.textContent=d),u=w(T),_=c(T,"H2",{});var L=m(_);E=he(L,k),L.forEach(a),T.forEach(a),h=w(I),f=c(I,"ION-ICON",{icon:!0,slot:!0}),m(f).forEach(a),I.forEach(a),this.h()},h(){g(t,"icon",mt),g(t,"slot","start"),g(n,"class","ion-text-wrap"),g(f,"icon",Ve),g(f,"slot","end"),g(e,"href","https://www.google.com/maps/search/?api=1&query="+l[11].line2)},m(v,I){W(v,e,I),o(e,t),o(e,i),o(e,n),o(n,r),o(n,u),o(n,_),o(_,E),o(e,h),o(e,f)},p:ze,d(v){v&&a(e)}}}function kt(l){let e,t,i,n,r,d="Contacto del Cliente",u,_,k,E,h=l[15]&&l[15]==="1"&&eo(l);return{c(){e=s("ion-item"),t=s("ion-icon"),i=y(),n=s("ion-label"),r=s("p"),r.textContent=d,u=y(),_=s("h2"),k=_e(l[6]),E=y(),h&&h.c(),this.h()},l(f){e=c(f,"ION-ITEM",{});var v=m(e);t=c(v,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),i=w(v),n=c(v,"ION-LABEL",{class:!0});var I=m(n);r=c(I,"P",{"data-svelte-h":!0}),ne(r)!=="svelte-1utsyb6"&&(r.textContent=d),u=w(I),_=c(I,"H2",{});var T=m(_);k=he(T,l[6]),T.forEach(a),I.forEach(a),E=w(v),h&&h.l(v),v.forEach(a),this.h()},h(){g(t,"icon",mn),g(t,"slot","start"),g(n,"class","ion-text-wrap")},m(f,v){W(f,e,v),o(e,t),o(e,i),o(e,n),o(n,r),o(n,u),o(n,_),o(_,k),o(e,E),h&&h.m(e,null)},p(f,v){v[0]&64&&we(k,f[6]),f[15]&&f[15]==="1"&&h.p(f,v)},d(f){f&&a(e),h&&h.d()}}}function eo(l){let e,t=`<ion-icon icon="${In}" slot="start"></ion-icon>
                        Notificar Cliente`,i,n;return{c(){e=s("ion-button"),e.innerHTML=t,this.h()},l(r){e=c(r,"ION-BUTTON",{fill:!0,style:!0,"data-svelte-h":!0}),ne(e)!=="svelte-w3qtwm"&&(e.innerHTML=t),this.h()},h(){g(e,"fill","outline"),b(e,"margin-left","16px")},m(r,d){W(r,e,d),i||(n=se(e,"click",l[23]),i=!0)},p:ze,d(r){r&&a(e),i=!1,n()}}}function Ot(l){let e,t,i,n,r,d="Notas de ubicación",u,_,k;return{c(){e=s("ion-item"),t=s("ion-icon"),i=y(),n=s("ion-label"),r=s("p"),r.textContent=d,u=y(),_=s("h2"),k=_e(l[7]),this.h()},l(E){e=c(E,"ION-ITEM",{});var h=m(e);t=c(h,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),i=w(h),n=c(h,"ION-LABEL",{class:!0});var f=m(n);r=c(f,"P",{"data-svelte-h":!0}),ne(r)!=="svelte-nhm2ft"&&(r.textContent=d),u=w(f),_=c(f,"H2",{});var v=m(_);k=he(v,l[7]),v.forEach(a),f.forEach(a),h.forEach(a),this.h()},h(){g(t,"icon",Jt),g(t,"slot","start"),g(n,"class","ion-text-wrap")},m(E,h){W(E,e,h),o(e,t),o(e,i),o(e,n),o(n,r),o(n,u),o(n,_),o(_,k)},p(E,h){h[0]&128&&we(k,E[7])},d(E){E&&a(e)}}}function to(l){let e,t,i,n,r,d="Horarios",u,_,k=l[11].schedule+"",E;return{c(){e=s("ion-item"),t=s("ion-icon"),i=y(),n=s("ion-label"),r=s("p"),r.textContent=d,u=y(),_=s("h2"),E=_e(k),this.h()},l(h){e=c(h,"ION-ITEM",{});var f=m(e);t=c(f,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),i=w(f),n=c(f,"ION-LABEL",{});var v=m(n);r=c(v,"P",{"data-svelte-h":!0}),ne(r)!=="svelte-11q7hm5"&&(r.textContent=d),u=w(v),_=c(v,"H2",{});var I=m(_);E=he(I,k),I.forEach(a),v.forEach(a),f.forEach(a),this.h()},h(){g(t,"icon",vn),g(t,"slot","start")},m(h,f){W(h,e,f),o(e,t),o(e,i),o(e,n),o(n,r),o(n,u),o(n,_),o(_,E)},p:ze,d(h){h&&a(e)}}}function no(l){let e,t,i,n,r,d="Notas del operador",u,_,k=l[11].driver_comments+"",E;return{c(){e=s("ion-item"),t=s("ion-icon"),i=y(),n=s("ion-label"),r=s("p"),r.textContent=d,u=y(),_=s("h2"),E=_e(k),this.h()},l(h){e=c(h,"ION-ITEM",{});var f=m(e);t=c(f,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),i=w(f),n=c(f,"ION-LABEL",{});var v=m(n);r=c(v,"P",{"data-svelte-h":!0}),ne(r)!=="svelte-1yk9qp4"&&(r.textContent=d),u=w(v),_=c(v,"H2",{});var I=m(_);E=he(I,k),I.forEach(a),v.forEach(a),f.forEach(a),this.h()},h(){g(t,"icon",Yt),g(t,"slot","start")},m(h,f){W(h,e,f),o(e,t),o(e,i),o(e,n),o(n,r),o(n,u),o(n,_),o(_,E)},p:ze,d(h){h&&a(e)}}}function oo(l){let e,t=l[11].logistic_comments!="<br>"&&lo(l);return{c(){t&&t.c(),e=Me()},l(i){t&&t.l(i),e=Me()},m(i,n){t&&t.m(i,n),W(i,e,n)},p(i,n){i[11].logistic_comments!="<br>"&&t.p(i,n)},d(i){i&&a(e),t&&t.d(i)}}}function lo(l){let e,t,i,n,r,d="Comentarios logísticos",u,_,k=l[11].logistic_comments+"",E;return{c(){e=s("ion-item"),t=s("ion-icon"),i=y(),n=s("ion-label"),r=s("p"),r.textContent=d,u=y(),_=s("h2"),E=_e(k),this.h()},l(h){e=c(h,"ION-ITEM",{});var f=m(e);t=c(f,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),i=w(f),n=c(f,"ION-LABEL",{class:!0});var v=m(n);r=c(v,"P",{"data-svelte-h":!0}),ne(r)!=="svelte-1iz85r6"&&(r.textContent=d),u=w(v),_=c(v,"H2",{});var I=m(_);E=he(I,k),I.forEach(a),v.forEach(a),f.forEach(a),this.h()},h(){g(t,"icon",Jt),g(t,"slot","start"),g(n,"class","ion-text-wrap")},m(h,f){W(h,e,f),o(e,t),o(e,i),o(e,n),o(n,r),o(n,u),o(n,_),o(_,E)},p:ze,d(h){h&&a(e)}}}function io(l){let e,t,i,n,r="<p>Etiqueta</p>",d,u,_=(l[11].tag?l[11].tag:"")+"",k;return{c(){e=s("ion-item"),t=s("ion-icon"),i=y(),n=s("ion-label"),n.innerHTML=r,d=y(),u=s("div"),k=_e(_),this.h()},l(E){e=c(E,"ION-ITEM",{});var h=m(e);t=c(h,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),i=w(h),n=c(h,"ION-LABEL",{class:!0,"data-svelte-h":!0}),ne(n)!=="svelte-50rr6d"&&(n.innerHTML=r),d=w(h),u=c(h,"DIV",{class:!0,style:!0});var f=m(u);k=he(f,_),f.forEach(a),h.forEach(a),this.h()},h(){g(t,"icon",gn),g(t,"slot","start"),g(n,"class","ion-text-wrap"),G(u,"class","stop-tag"),b(u,"background-color",l[16]),b(u,"border","1px solid "+l[17]),b(u,"color",l[11].tag_color),b(u,"font-size","14px"),b(u,"text-align","center"),b(u,"align-content","center"),b(u,"border-radius","20px"),b(u,"white-space","normal"),b(u,"padding","4px 8px"),b(u,"width","auto",1),b(u,"display","inline-block")},m(E,h){W(E,e,h),o(e,t),o(e,i),o(e,n),o(e,d),o(e,u),o(u,k)},p:ze,d(E){E&&a(e)}}}function ro(l){let e,t,i,n,r,d="Estado de entrega",u,_,k="Entregado",E,h,f="No Entregado",v,I,T="Entrega Parcial",L,V,A,F,q,R,S,P,B=l[4]===!0&&Nt(l),D=(l[5]===!0||l[5]===!1&&l[4]===!1)&&Tt(l);return{c(){e=s("ion-item"),t=s("ion-icon"),i=y(),n=s("ion-select"),r=s("div"),r.textContent=d,u=y(),_=s("ion-select-option"),_.textContent=k,E=y(),h=s("ion-select-option"),h.textContent=f,v=y(),I=s("ion-select-option"),I.textContent=T,L=y(),V=s("ion-item"),A=s("ion-icon"),F=y(),q=s("ion-textarea"),R=y(),S=s("section"),B&&B.c(),P=y(),D&&D.c(),this.h()},l(O){e=c(O,"ION-ITEM",{});var K=m(e);t=c(K,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),i=w(K),n=c(K,"ION-SELECT",{value:!0});var H=m(n);r=c(H,"DIV",{slot:!0,"data-svelte-h":!0}),ne(r)!=="svelte-1635zca"&&(r.textContent=d),u=w(H),_=c(H,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),ne(_)!=="svelte-s33eln"&&(_.textContent=k),E=w(H),h=c(H,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),ne(h)!=="svelte-1a859l3"&&(h.textContent=f),v=w(H),I=c(H,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),ne(I)!=="svelte-1c4dcm8"&&(I.textContent=T),H.forEach(a),K.forEach(a),L=w(O),V=c(O,"ION-ITEM",{});var M=m(V);A=c(M,"ION-ICON",{icon:!0,slot:!0}),m(A).forEach(a),F=w(M),q=c(M,"ION-TEXTAREA",{label:!0,placeholder:!0}),m(q).forEach(a),M.forEach(a),R=w(O),S=c(O,"SECTION",{style:!0});var U=m(S);B&&B.l(U),P=w(U),D&&D.l(U),U.forEach(a),this.h()},h(){g(t,"icon",bn),g(t,"slot","start"),G(r,"slot","label"),g(_,"value","delivered"),g(h,"value","notdelivered"),g(I,"value","partialdeliver"),g(n,"value",l[14]?l[14]:"delivered"),g(A,"icon",ft),g(A,"slot","start"),g(q,"label","Notas"),g(q,"placeholder","Escribe aquí..."),b(S,"display","flex"),b(S,"gap","8px"),b(S,"padding","16px 16px 6px")},m(O,K){W(O,e,K),o(e,t),o(e,i),o(e,n),o(n,r),o(n,u),o(n,_),o(n,E),o(n,h),o(n,v),o(n,I),l[29](n),W(O,L,K),W(O,V,K),o(V,A),o(V,F),o(V,q),l[30](q),W(O,R,K),W(O,S,K),B&&B.m(S,null),o(S,P),D&&D.m(S,null)},p(O,K){O[4]===!0?B?B.p(O,K):(B=Nt(O),B.c(),B.m(S,P)):B&&(B.d(1),B=null),O[5]===!0||O[5]===!1&&O[4]===!1?D?D.p(O,K):(D=Tt(O),D.c(),D.m(S,null)):D&&(D.d(1),D=null)},d(O){O&&(a(e),a(L),a(V),a(R),a(S)),l[29](null),l[30](null),B&&B.d(),D&&D.d()}}}function Nt(l){let e,t=`<ion-icon icon="${kn}" slot="start"></ion-icon>
                        Ingreso`,i,n;return{c(){e=s("ion-button"),e.innerHTML=t,this.h()},l(r){e=c(r,"ION-BUTTON",{id:!0,style:!0,"data-svelte-h":!0}),ne(e)!=="svelte-3onvnr"&&(e.innerHTML=t),this.h()},h(){g(e,"id","checkInBtn"),b(e,"flex","1")},m(r,d){W(r,e,d),i||(n=se(e,"click",l[24]),i=!0)},p:ze,d(r){r&&a(e),i=!1,n()}}}function Tt(l){let e,t,i,n,r,d;return{c(){e=s("ion-button"),t=s("ion-icon"),i=_e(`
                        Salida`),this.h()},l(u){e=c(u,"ION-BUTTON",{id:!0,style:!0,disabled:!0});var _=m(e);t=c(_,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),i=he(_,`
                        Salida`),_.forEach(a),this.h()},h(){g(t,"icon",En),g(t,"slot","start"),g(e,"id","checkOutBtn"),b(e,"flex","1"),g(e,"disabled",n=l[5]===!1)},m(u,_){W(u,e,_),o(e,t),o(e,i),r||(d=se(e,"click",l[25]),r=!0)},p(u,_){_[0]&32&&n!==(n=u[5]===!1)&&g(e,"disabled",n)},d(u){u&&a(e),r=!1,d()}}}function ao(l){let e,t,i,n,r,d,u,_;return{c(){e=s("section"),t=s("ion-button"),i=s("label"),n=s("ion-icon"),r=_e(`
                                Subir Evidencia
                            `),d=s("input"),this.h()},l(k){e=c(k,"SECTION",{style:!0});var E=m(e);t=c(E,"ION-BUTTON",{fill:!0,class:!0,style:!0});var h=m(t);i=c(h,"LABEL",{for:!0,style:!0});var f=m(i);n=c(f,"ION-ICON",{icon:!0,slot:!0,style:!0}),m(n).forEach(a),r=he(f,`
                                Subir Evidencia
                            `),d=c(f,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0,capture:!0}),f.forEach(a),h.forEach(a),E.forEach(a),this.h()},h(){g(n,"icon",Qt),g(n,"slot","start"),b(n,"vertical-align","middle"),b(d,"display","none"),G(d,"id","eventEvidence"),G(d,"name","fileToUpload"),G(d,"type","file"),d.multiple=!0,G(d,"accept","image/*"),G(d,"capture","environment"),G(i,"for","eventEvidence"),b(i,"width","100%"),b(i,"height","100%"),g(t,"fill","outline"),g(t,"class","loadEvidence"),b(t,"flex","1"),b(t,"display","flex"),b(t,"align-items","center"),b(t,"gap","8px"),b(e,"display","flex"),b(e,"gap","8px"),b(e,"padding","0px 16px")},m(k,E){W(k,e,E),o(e,t),o(t,i),o(i,n),o(i,r),o(i,d),u||(_=[se(d,"change",l[18]),se(d,"click",l[19])],u=!0)},p:ze,d(k){k&&a(e),u=!1,Pe(_)}}}function Ct(l){let e,t,i=Re(l[2]),n=[];for(let r=0;r<i.length;r+=1)n[r]=yt(It(l,i,r));return{c(){e=s("section"),t=s("div");for(let r=0;r<n.length;r+=1)n[r].c();this.h()},l(r){e=c(r,"SECTION",{});var d=m(e);t=c(d,"DIV",{class:!0,style:!0});var u=m(t);for(let _=0;_<n.length;_+=1)n[_].l(u);u.forEach(a),d.forEach(a),this.h()},h(){G(t,"class","image-grid"),b(t,"display","grid"),b(t,"grid-template-columns","repeat(auto-fill, minmax(100px, 1fr))"),b(t,"gap","10px"),b(t,"padding","0px 10px")},m(r,d){W(r,e,d),o(e,t);for(let u=0;u<n.length;u+=1)n[u]&&n[u].m(t,null)},p(r,d){if(d[0]&69206020){i=Re(r[2]);let u;for(u=0;u<i.length;u+=1){const _=It(r,i,u);n[u]?n[u].p(_,d):(n[u]=yt(_),n[u].c(),n[u].m(t,null))}for(;u<n.length;u+=1)n[u].d(1);n.length=i.length}},d(r){r&&a(e),nn(n,r)}}}function yt(l){let e,t,i,n,r,d=`<ion-icon icon="${On}"></ion-icon>`,u,_,k;function E(){return l[31](l[51])}function h(){return l[32](l[53])}return{c(){e=s("div"),t=s("ion-img"),n=y(),r=s("button"),r.innerHTML=d,u=y(),this.h()},l(f){e=c(f,"DIV",{class:!0,style:!0});var v=m(e);t=c(v,"ION-IMG",{src:!0,alt:!0,style:!0}),m(t).forEach(a),n=w(v),r=c(v,"BUTTON",{class:!0,style:!0,"data-svelte-h":!0}),ne(r)!=="svelte-zguiov"&&(r.innerHTML=d),u=w(v),v.forEach(a),this.h()},h(){Xe(t.src,i=l[51])||g(t,"src",i),g(t,"alt","Evidencia fotográfica"),b(t,"width","100%"),b(t,"height","100px"),b(t,"object-fit","cover"),b(t,"cursor","pointer"),b(t,"border","1px solid #ccc"),b(t,"border-radius","4px"),b(t,"margin-top","16px"),G(r,"class","remove-button"),b(r,"position","absolute"),b(r,"top","5px"),b(r,"right","5px"),b(r,"border","none"),b(r,"cursor","pointer"),b(r,"font-size","18px"),b(r,"background","white"),b(r,"border-radius","50%"),b(r,"padding","3px 4px 0px"),b(r,"box-shadow","2px 2px 6px rgba(0, 0, 0, 0.3)"),b(r,"color","#0000008f"),G(e,"class","image-container"),b(e,"position","relative")},m(f,v){W(f,e,v),o(e,t),o(e,n),o(e,r),o(e,u),_||(k=[se(t,"click",E),se(r,"click",h)],_=!0)},p(f,v){l=f,v[0]&4&&!Xe(t.src,i=l[51])&&g(t,"src",i)},d(f){f&&a(e),_=!1,Pe(k)}}}function wt(l){let e,t='<ion-spinner name="dots" style="color:white;"></ion-spinner>';return{c(){e=s("div"),e.innerHTML=t,this.h()},l(i){e=c(i,"DIV",{class:!0,style:!0,"data-svelte-h":!0}),ne(e)!=="svelte-h8s7r2"&&(e.innerHTML=t),this.h()},h(){G(e,"class","overlay"),b(e,"position","fixed"),b(e,"top","0"),b(e,"left","0"),b(e,"width","100vw"),b(e,"height","100vh"),b(e,"background","rgba(0, 0, 0, 0.5)"),b(e,"display","flex"),b(e,"align-items","center"),b(e,"justify-content","center"),b(e,"z-index","9999")},m(i,n){W(i,e,n)},d(i){i&&a(e)}}}function Lt(l){let e,t,i,n,r,d,u=`<ion-icon icon="${Nn}"></ion-icon>`,_,k;return{c(){e=s("div"),t=s("div"),i=s("ion-img"),r=y(),d=s("button"),d.innerHTML=u,this.h()},l(E){e=c(E,"DIV",{class:!0,style:!0});var h=m(e);t=c(h,"DIV",{class:!0,style:!0});var f=m(t);i=c(f,"ION-IMG",{src:!0,alt:!0,style:!0}),m(i).forEach(a),r=w(f),d=c(f,"BUTTON",{class:!0,style:!0,"data-svelte-h":!0}),ne(d)!=="svelte-g0qr0o"&&(d.innerHTML=u),f.forEach(a),h.forEach(a),this.h()},h(){Xe(i.src,n=l[9])||g(i,"src",n),g(i,"alt","Evidencia fotográfica"),b(i,"width","100%"),b(i,"height","auto"),G(d,"class","close-button"),b(d,"position","absolute"),b(d,"top","5px"),b(d,"right","5px"),b(d,"background","white"),b(d,"color","#444444d1"),b(d,"border","none"),b(d,"cursor","pointer"),b(d,"padding","2px 2px 0px 6px"),b(d,"border-radius","50%"),b(d,"font-size","20px"),G(t,"class","modal-content"),b(t,"position","relative"),b(t,"background","white"),b(t,"padding","20px"),b(t,"border-radius","8px"),b(t,"max-width","90vw"),b(t,"max-height","90vh"),b(t,"overflow","auto"),G(e,"class","modal-overlay"),b(e,"position","fixed"),b(e,"top","0"),b(e,"left","0"),b(e,"width","100vw"),b(e,"height","100vh"),b(e,"background","rgba(0, 0, 0, 0.8)"),b(e,"display","flex"),b(e,"justify-content","center"),b(e,"align-items","center"),b(e,"z-index","1000")},m(E,h){W(E,e,h),o(e,t),o(t,i),o(t,r),o(t,d),_||(k=[se(d,"click",l[27]),se(t,"click",on(l[28])),se(e,"click",l[27])],_=!0)},p(E,h){h[0]&512&&!Xe(i.src,n=E[9])&&g(i,"src",n)},d(E){E&&a(e),_=!1,Pe(k)}}}function so(l){let e,t,i,n,r="Cerrar",d,u,_=l[11].title+"",k,E,h,f,v,I,T=l[11].client_phone&&l[11].client_phone.trim().length,L,V,A,F,q=l[11].schedule&&l[11].schedule.trim().length,R,S,P=l[11].logistic_comments&&l[11].logistic_comments.trim().length,B,D,O,K,H,M,U,x,oe,ee=(!l[12]&&!l[13]||l[12]&&l[13])&&Wn(l);function fe(p,z){return p[11].client_name!=null?Yn:Jn}let le=fe(l)(l),be=T&&Qn(l);function Oe(p,z){if(p[11].line1&&p[11].line1.trim().length)return xn;if(p[11].line2&&p[11].line2.trim().length)return Zn}let Ee=Oe(l),me=Ee&&Ee(l),de=l[6]&&kt(l),ue=l[7]&&l[7]!=="<br>"&&Ot(l),Ne=q&&to(l),ve=l[11].driver_comments&&no(l),Ie=P&&oo(l),Ce=l[11].tag&&l[11].tag_color&&io(l),ge=!l[13]&&ro(l),ce=(l[12]&&l[13]||!l[12]&&!l[13])&&ao(l),Z=l[1]&&Ct(l),te=l[3]&&wt(),Q=l[8]&&Lt(l);return{c(){e=s("ion-header"),t=s("ion-toolbar"),i=s("ion-buttons"),n=s("ion-button"),n.textContent=r,d=y(),u=s("ion-title"),k=_e(_),E=y(),ee&&ee.c(),h=y(),f=s("ion-content"),v=s("ion-list"),le.c(),I=y(),be&&be.c(),L=y(),me&&me.c(),V=y(),de&&de.c(),A=y(),ue&&ue.c(),F=y(),Ne&&Ne.c(),R=y(),ve&&ve.c(),S=y(),Ie&&Ie.c(),B=y(),Ce&&Ce.c(),D=y(),ge&&ge.c(),O=y(),ce&&ce.c(),K=y(),Z&&Z.c(),H=y(),te&&te.c(),M=y(),Q&&Q.c(),U=Me(),this.h()},l(p){e=c(p,"ION-HEADER",{translucent:!0});var z=m(e);t=c(z,"ION-TOOLBAR",{});var C=m(t);i=c(C,"ION-BUTTONS",{slot:!0});var j=m(i);n=c(j,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),ne(n)!=="svelte-2ks32x"&&(n.textContent=r),j.forEach(a),d=w(C),u=c(C,"ION-TITLE",{style:!0,title:!0});var X=m(u);k=he(X,_),X.forEach(a),E=w(C),ee&&ee.l(C),C.forEach(a),z.forEach(a),h=w(p),f=c(p,"ION-CONTENT",{fullscreen:!0});var Y=m(f);v=c(Y,"ION-LIST",{});var N=m(v);le.l(N),I=w(N),be&&be.l(N),L=w(N),me&&me.l(N),V=w(N),de&&de.l(N),A=w(N),ue&&ue.l(N),F=w(N),Ne&&Ne.l(N),R=w(N),ve&&ve.l(N),S=w(N),Ie&&Ie.l(N),B=w(N),Ce&&Ce.l(N),D=w(N),ge&&ge.l(N),O=w(N),ce&&ce.l(N),K=w(N),Z&&Z.l(N),N.forEach(a),Y.forEach(a),H=w(p),te&&te.l(p),M=w(p),Q&&Q.l(p),U=Me(),this.h()},h(){g(n,"color","medium"),g(i,"slot","start"),b(u,"text-align","center"),g(u,"title",l[11].title),g(e,"translucent",""),g(f,"fullscreen","")},m(p,z){W(p,e,z),o(e,t),o(t,i),o(i,n),o(t,d),o(t,u),o(u,k),o(t,E),ee&&ee.m(t,null),W(p,h,z),W(p,f,z),o(f,v),le.m(v,null),o(v,I),be&&be.m(v,null),o(v,L),me&&me.m(v,null),o(v,V),de&&de.m(v,null),o(v,A),ue&&ue.m(v,null),o(v,F),Ne&&Ne.m(v,null),o(v,R),ve&&ve.m(v,null),o(v,S),Ie&&Ie.m(v,null),o(v,B),Ce&&Ce.m(v,null),o(v,D),ge&&ge.m(v,null),o(v,O),ce&&ce.m(v,null),o(v,K),Z&&Z.m(v,null),W(p,H,z),te&&te.m(p,z),W(p,M,z),Q&&Q.m(p,z),W(p,U,z),x||(oe=se(n,"click",l[20]),x=!0)},p(p,z){(!p[12]&&!p[13]||p[12]&&p[13])&&ee.p(p,z),le.p(p,z),T&&be.p(p,z),me&&me.p(p,z),p[6]?de?de.p(p,z):(de=kt(p),de.c(),de.m(v,A)):de&&(de.d(1),de=null),p[7]&&p[7]!=="<br>"?ue?ue.p(p,z):(ue=Ot(p),ue.c(),ue.m(v,F)):ue&&(ue.d(1),ue=null),q&&Ne.p(p,z),p[11].driver_comments&&ve.p(p,z),P&&Ie.p(p,z),p[11].tag&&p[11].tag_color&&Ce.p(p,z),p[13]||ge.p(p,z),(p[12]&&p[13]||!p[12]&&!p[13])&&ce.p(p,z),p[1]?Z?Z.p(p,z):(Z=Ct(p),Z.c(),Z.m(v,null)):Z&&(Z.d(1),Z=null),p[3]?te||(te=wt(),te.c(),te.m(M.parentNode,M)):te&&(te.d(1),te=null),p[8]?Q?Q.p(p,z):(Q=Lt(p),Q.c(),Q.m(U.parentNode,U)):Q&&(Q.d(1),Q=null)},i:ze,o:ze,d(p){p&&(a(e),a(h),a(f),a(H),a(M),a(U)),ee&&ee.d(),le.d(),be&&be.d(),me&&me.d(),de&&de.d(),ue&&ue.d(),Ne&&Ne.d(),ve&&ve.d(),Ie&&Ie.d(),Ce&&Ce.d(),ge&&ge.d(),ce&&ce.d(),Z&&Z.d(),te&&te.d(p),Q&&Q.d(p),x=!1,oe()}}}const zt=/Teléfono:\s*(\d{10,})/;function it(l=""){return l.split(",").map(t=>t.trim())}function co(l,e,t){let i=at,n=document.querySelector("ion-modal"),r=n.componentProps.delivery,d=n.componentProps.isLast||!1,u=n.componentProps.flag||!1,_=r.driver_comments?r.driver_comments:"",k=r.deliver_status?r.deliver_status:"",E=r.img?r.img:"",h=r.img_id?r.img_id:"",f=E?it(E):new Array,v=h?it(h):new Array,I={latitude:null,longitude:null},T=r.stopsApproval,L=r.smsActive,V=!1,A=!0,F=!1,q="",R=r.comments_ext,S=!1,P="",B=new Object,D="",O=De(r.tag_color,.2),K=De(r.tag_color,.3);xe(()=>{B=JSON.parse(localStorage.getItem("userSession")),M()});async function H(C="",j,X={}){let Y=new FormData;t(3,V=!0);for(const[N,J]of Object.entries(X))Y.append(N,J);Y=ge(Y);try{const N=await fetch(C,{method:"POST",body:Y});if(N.ok){const J=await N.json();j(J)}else console.error("Request failed:",N.statusText)}catch(N){console.error("Error during file upload:",N)}finally{t(3,V=!1)}}function M(){r.date_service?r.date_service&&!r.date_completed&&!r.service_time?(t(4,A=!1),t(5,F=!0)):r.date_service&&r.date_completed&&r.service_time&&(t(4,A=!1),t(5,F=!1)):(t(4,A=!0),t(5,F=!1))}if(r.comments_ext){const C=r.comments_ext.match(zt);C&&(q=C[1],R=r.comments_ext.replace(zt,"").trim())}const U=async(C,j)=>{await(await qe.create({header:C||"Error",message:j||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()},x=async(C="",j="",X="",Y,N={})=>{await(await qe.create({header:C||"Error",message:j||"Vuelva a intentar",buttons:[{text:"No",role:"cancel",handler:()=>{}},{text:"Sí",handler:()=>{H(X,Y,N)}}]})).present()},oe=async C=>{if(f.length>=5){U("Límite de evidencias","Solo se permite subir 5 fotos por parada");return}if(u&&d&&f.length>=1){U("Límite de evidencias","Para el final de la ruta solo se permite subir 1 foto");return}const X=C.target.files[0];if(X)try{t(3,V=!0);const Y=await ae(X);if(Y){const N=new FormData;N.append("fileToUpload",Y),fetch(`${i}api/admin/manager/upload_img_driver.php`,{method:"POST",body:N}).then(J=>J.json()).then(J=>{t(1,E=E?`${E},${J.img}`:J.img),h=h?`${h},${J.img_id}`:J.img_id,t(2,f=it(E)),v=it(h)}).catch(J=>console.error("Upload error:",J))}}catch(Y){console.error("Compression error:",Y)}finally{t(3,V=!1)}};function ee(C){var j=r.service_time;!j&&A&&!d&&!u&&(C.preventDefault(),U("Registrar Ingreso","Antes de subir la evidencia registra el ingreso a la actual parada."))}function fe(){var C=u?r.date_completed:!1;if(!C&&!A&&F&&!d&&!u){var j=new Object;j.id_event=r.id_event,j.type="checkout",x("Registrar Salida","¿Completaste tu entrega?",i+"api/admin/route/record_check_date.php",function(X){X.minutes&&U("Tiempo por parada","Completaste la parada en "+X.minutes+" minutos.")},j)}}const ae=async C=>new Promise(j=>{const X=new Image;X.src=URL.createObjectURL(C),X.onload=()=>{const Y=document.createElement("canvas"),N=Y.getContext("2d"),J=800,ie=600;let $=X.width,re=X.height;$>J&&(re*=J/$,$=J),re>ie&&($*=ie/re,re=ie),Y.width=$,Y.height=re,N.drawImage(X,0,0,$,re),Y.toBlob(pe=>{j(pe),URL.revokeObjectURL(X.src),N.clearRect(0,0,Y.width,Y.height)},"image/jpeg",.7)}}),le=()=>{n.dismiss({data:Date.now()})};function be(C){t(2,f=f.filter((j,X)=>X!==C))}const Oe=async()=>{try{if(t(3,V=!0),t(1,E=f.join(",")),h=v.join(","),fe(),await me())if(D.value=="delivered"||D.value!=="delivered"&&(_.value||r.driver_comments)||u&&d){const j={id_route:r.id_route,...!u&&!d&&{id_event:r.id_event},...!u&&!d&&{comments:_.value},...!u&&!d&&{deliver_status:D.value},img:E,img_id:h,lat:I.latitude,lon:I.longitude,...T==="0"&&{approve:"0"},...d&&{isLast:!0},...u&&d&&{destiny:!0}};j.img&&j.img_id||E?H(`${i}api/admin/evidence/send_evidence.php`,function(X){if(X.success==!0){const Y=j.id_route;le(),d&&(Ee("","",Y,d),T=="0"&&ce(Y,"completed"))}else U("Carga fallida","Actualiza la página y vuelve a intentar cargar la información!")},j):U("Información incompleta","Cargar evidencia fotográfica faltante para completar parada.")}else U("Motivo de status de entrega","Favor de ingresar en notas el motivo por el que la entrega no fue entregada correctamente");else U("Ubicación faltante","Asegúrate darle permisos a Rutaflow para acceder a tu ubicación")}catch(C){console.error("Error fetching data:",C)}finally{t(3,V=!1)}},Ee=(C,j,X,Y)=>{n.componentProps.routeId=X,n.componentProps.driverId=r.id_driver,Ue("modal-km-gas",$t,{checklist:C,driverId:j,routeId:X,isLast:Y}).then(N=>{})},me=async()=>navigator.geolocation?new Promise((C,j)=>{navigator.geolocation.getCurrentPosition(X=>{I.latitude=X.coords.latitude,I.longitude=X.coords.longitude,C(!0)},X=>{console.error("Error getting location:",X),C(!1)})}):(console.error("Geolocation is not supported by your browser"),!1);async function de(C){C.stopPropagation();let j=new FormData;j.append("client_phone",q),j.append("client_name",r.title),j.append("delivery_phone",r.client_phone),j.append("enterprise_name",r.enterprise_name),j=ge(j);try{const X=await fetch(`${i}api/admin/message_central/send_sms.php`,{method:"POST",body:j});if(X.ok){const Y=await X.json();U("SMS enviado","Se envío correctamente un SMS a "+r.title+" con número de teléfono: "+q)}else U("SMS no enviado","Hubo un error al enviar SMS a "+r.title+" con número de teléfono: "+phoneNumber0+". Por favor contacte a soporte.")}catch(X){console.error("Error during file upload:",X)}}function ue(){t(4,A=!1),t(5,F=!0),ve(r.id_event,"checkin")}function Ne(){t(5,F=!1),t(4,A=!1),ve(r.id_event,"checkout")}async function ve(C,j){if(j){let X=new FormData;X.append("type",j),X.append("id_event",C),X=ge(X);try{const Y=await fetch(`${i}api/admin/route/record_check_date.php`,{method:"POST",body:X});if(Y.ok){const N=await Y.json();N.minutes&&U("Tiempo por parada","Completaste la parada en "+N.minutes+" minutos.")}else console.error("File upload failed:",Y.statusText)}catch(Y){console.error("Error during file upload:",Y)}finally{}}}const Ie=C=>{t(9,P=C),t(8,S=!0)},Ce=()=>{t(8,S=!1),t(9,P="")};function ge(C){return C.append("token",B.token),C.append("id_user_over",B.id_user),C}function ce(C,j){let X=new FormData;return X.append("id_route",C),X.append("status",j),X=ge(X),fetch(`${i}api/admin/route/change_status.php`,{method:"POST",body:X}).then(Y=>Y.json()).then(Y=>{}).catch(Y=>{console.error("Error fetching data:",Y)}),""}function Z(C){ln.call(this,l,C)}function te(C){Se[C?"unshift":"push"](()=>{D=C,t(10,D)})}function Q(C){Se[C?"unshift":"push"](()=>{_=C,t(0,_)})}return[_,E,f,V,A,F,q,R,S,P,D,r,d,u,k,L,O,K,oe,ee,le,be,Oe,de,ue,Ne,Ie,Ce,Z,te,Q,C=>Ie(C),C=>be(C)]}class At extends Ye{constructor(e){super(),Qe(this,e,co,so,Je,{},null,[-1,-1])}}function Mt(l){let e,t,i;return{c(){e=s("section"),t=s("ion-img"),this.h()},l(n){e=c(n,"SECTION",{});var r=m(e);t=c(r,"ION-IMG",{src:!0,alt:!0,style:!0}),m(t).forEach(a),r.forEach(a),this.h()},h(){Xe(t.src,i=l[0])||g(t,"src",i),g(t,"alt","Evidencia fotográfica"),b(t,"max-width","100%"),b(t,"margin-top","16px")},m(n,r){W(n,e,r),o(e,t)},p(n,r){r&1&&!Xe(t.src,i=n[0])&&g(t,"src",i)},d(n){n&&a(e)}}}function St(l){let e,t='<ion-spinner name="dots" style="color:white;"></ion-spinner>';return{c(){e=s("div"),e.innerHTML=t,this.h()},l(i){e=c(i,"DIV",{class:!0,style:!0,"data-svelte-h":!0}),ne(e)!=="svelte-h8s7r2"&&(e.innerHTML=t),this.h()},h(){G(e,"class","overlay"),b(e,"position","fixed"),b(e,"top","0"),b(e,"left","0"),b(e,"width","100vw"),b(e,"height","100vh"),b(e,"background","rgba(0, 0, 0, 0.5)"),b(e,"display","flex"),b(e,"align-items","center"),b(e,"justify-content","center"),b(e,"z-index","9999")},m(i,n){W(i,e,n)},d(i){i&&a(e)}}}function uo(l){let e,t,i,n,r="Cancelar",d,u,_="AGREGAR GASTO",k,E,h,f="Confirmar",v,I,T,L,V,A,F,q,R,S,P,B,D,O,K,H,M,U,x='Tipo de pago <ion-text color="danger">(Obligatorio)</ion-text>',oe,ee,fe="Efectivo",ae,le,be="Tarjeta",Oe,Ee,me="Transferencia",de,ue,Ne,ve,Ie,Ce,ge,ce,Z,te,Q=`<ion-icon icon="${Qt}" slot="start"></ion-icon>
                        Subir Evidencia`,p,z,C,j,X,Y,N,J=l[0]&&Mt(l),ie=l[5]&&St();return{c(){e=s("ion-header"),t=s("ion-toolbar"),i=s("ion-buttons"),n=s("ion-button"),n.textContent=r,d=y(),u=s("ion-title"),u.textContent=_,k=y(),E=s("ion-buttons"),h=s("ion-button"),h.textContent=f,v=y(),I=s("ion-content"),T=s("ion-list"),L=s("ion-item"),V=s("ion-icon"),A=y(),F=s("ion-input"),q=y(),R=s("ion-item"),S=s("ion-icon"),P=y(),B=s("ion-input"),D=y(),O=s("ion-item"),K=s("ion-icon"),H=y(),M=s("ion-select"),U=s("div"),U.innerHTML=x,oe=y(),ee=s("ion-select-option"),ee.textContent=fe,ae=y(),le=s("ion-select-option"),le.textContent=be,Oe=y(),Ee=s("ion-select-option"),Ee.textContent=me,de=y(),ue=s("ion-item"),Ne=s("ion-icon"),ve=y(),Ie=s("ion-textarea"),Ce=y(),ge=s("section"),ce=s("label"),Z=s("ion-button"),te=s("label"),te.innerHTML=Q,p=y(),z=s("input"),C=y(),J&&J.c(),j=y(),ie&&ie.c(),X=Me(),this.h()},l($){e=c($,"ION-HEADER",{translucent:!0});var re=m(e);t=c(re,"ION-TOOLBAR",{});var pe=m(t);i=c(pe,"ION-BUTTONS",{slot:!0});var Le=m(i);n=c(Le,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),ne(n)!=="svelte-1f8rjcf"&&(n.textContent=r),Le.forEach(a),d=w(pe),u=c(pe,"ION-TITLE",{title:!0,"data-svelte-h":!0}),ne(u)!=="svelte-efps2s"&&(u.textContent=_),k=w(pe),E=c(pe,"ION-BUTTONS",{slot:!0});var ye=m(E);h=c(ye,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),ne(h)!=="svelte-k5zoz0"&&(h.textContent=f),ye.forEach(a),pe.forEach(a),re.forEach(a),v=w($),I=c($,"ION-CONTENT",{fullscreen:!0});var Te=m(I);T=c(Te,"ION-LIST",{});var ke=m(T);L=c(ke,"ION-ITEM",{});var Be=m(L);V=c(Be,"ION-ICON",{icon:!0,slot:!0}),m(V).forEach(a),A=w(Be),F=c(Be,"ION-INPUT",{label:!0,type:!0,placeholder:!0,value:!0}),m(F).forEach(a),Be.forEach(a),q=w(ke),R=c(ke,"ION-ITEM",{});var Ge=m(R);S=c(Ge,"ION-ICON",{icon:!0,slot:!0}),m(S).forEach(a),P=w(Ge),B=c(Ge,"ION-INPUT",{label:!0,type:!0,value:!0}),m(B).forEach(a),Ge.forEach(a),D=w(ke),O=c(ke,"ION-ITEM",{});var nt=m(O);K=c(nt,"ION-ICON",{icon:!0,slot:!0}),m(K).forEach(a),H=w(nt),M=c(nt,"ION-SELECT",{placeholder:!0,value:!0});var Fe=m(M);U=c(Fe,"DIV",{slot:!0,"data-svelte-h":!0}),ne(U)!=="svelte-wl764p"&&(U.innerHTML=x),oe=w(Fe),ee=c(Fe,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),ne(ee)!=="svelte-i9crym"&&(ee.textContent=fe),ae=w(Fe),le=c(Fe,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),ne(le)!=="svelte-fx0z11"&&(le.textContent=be),Oe=w(Fe),Ee=c(Fe,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),ne(Ee)!=="svelte-1c24jf2"&&(Ee.textContent=me),Fe.forEach(a),nt.forEach(a),de=w(ke),ue=c(ke,"ION-ITEM",{});var ot=m(ue);Ne=c(ot,"ION-ICON",{icon:!0,slot:!0}),m(Ne).forEach(a),ve=w(ot),Ie=c(ot,"ION-TEXTAREA",{label:!0,placeholder:!0}),m(Ie).forEach(a),ot.forEach(a),Ce=w(ke),ge=c(ke,"SECTION",{});var vt=m(ge);ce=c(vt,"LABEL",{for:!0,style:!0});var gt=m(ce);Z=c(gt,"ION-BUTTON",{fill:!0,size:!0,class:!0,expand:!0});var lt=m(Z);te=c(lt,"LABEL",{for:!0,style:!0,"data-svelte-h":!0}),ne(te)!=="svelte-1m9yw22"&&(te.innerHTML=Q),p=w(lt),z=c(lt,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0,capture:!0}),lt.forEach(a),gt.forEach(a),vt.forEach(a),C=w(ke),J&&J.l(ke),ke.forEach(a),Te.forEach(a),j=w($),ie&&ie.l($),X=Me(),this.h()},h(){g(n,"color","medium"),g(i,"slot","start"),g(u,"title",""),g(h,"strong",""),g(E,"slot","end"),g(e,"translucent",""),g(V,"icon",Yt),g(V,"slot","start"),g(F,"label","Concepto"),g(F,"type","text"),g(F,"placeholder","Escribe aquí..."),g(F,"value",l[6]?l[6]:""),g(S,"icon",ft),g(S,"slot","start"),g(B,"label","Cantidad"),g(B,"type","number"),g(B,"value",l[7]?l[7]:""),g(K,"icon",Tn),g(K,"slot","start"),G(U,"slot","label"),g(ee,"value","cash"),g(le,"value","card"),g(Ee,"value","transfer"),g(M,"placeholder","Tipo de pago"),g(M,"value",l[8]?l[8]:""),g(Ne,"icon",ft),g(Ne,"slot","start"),g(Ie,"label","Comentarios"),g(Ie,"placeholder","Escribe aquí..."),G(te,"for","eventEvidence"),b(te,"width","100%"),b(te,"padding","8px"),b(z,"display","none"),G(z,"id","eventEvidence"),G(z,"name","fileToUpload"),G(z,"type","file"),G(z,"accept","image/*"),G(z,"capture","environment"),g(Z,"fill","outline"),g(Z,"size","small"),g(Z,"class","loadEvidence"),g(Z,"expand","block"),G(ce,"for","eventEvidence"),b(ce,"display","block"),b(ce,"width","100%"),g(I,"fullscreen","")},m($,re){W($,e,re),o(e,t),o(t,i),o(i,n),o(t,d),o(t,u),o(t,k),o(t,E),o(E,h),W($,v,re),W($,I,re),o(I,T),o(T,L),o(L,V),o(L,A),o(L,F),l[12](F),o(T,q),o(T,R),o(R,S),o(R,P),o(R,B),l[13](B),o(T,D),o(T,O),o(O,K),o(O,H),o(O,M),o(M,U),o(M,oe),o(M,ee),o(M,ae),o(M,le),o(M,Oe),o(M,Ee),l[14](M),o(T,de),o(T,ue),o(ue,Ne),o(ue,ve),o(ue,Ie),l[15](Ie),o(T,Ce),o(T,ge),o(ge,ce),o(ce,Z),o(Z,te),o(Z,p),o(Z,z),o(T,C),J&&J.m(T,null),W($,j,re),ie&&ie.m($,re),W($,X,re),Y||(N=[se(n,"click",l[10]),se(h,"click",l[11]),se(z,"change",l[9])],Y=!0)},p($,[re]){$[0]?J?J.p($,re):(J=Mt($),J.c(),J.m(T,null)):J&&(J.d(1),J=null),$[5]?ie||(ie=St(),ie.c(),ie.m(X.parentNode,X)):ie&&(ie.d(1),ie=null)},i:ze,o:ze,d($){$&&(a(e),a(v),a(I),a(j),a(X)),l[12](null),l[13](null),l[14](null),l[15](null),J&&J.d(),ie&&ie.d($),Y=!1,Pe(N)}}}function fo(l,e,t){let i=at,n=document.querySelector("ion-modal"),r=n.componentProps.routeId,d=n.componentProps.ex_concept,u=n.componentProps.ex_amount,_=n.componentProps.ex_type,k=n.componentProps.id_expense,E="",h="",f="",v=0,I="",T="",L=!1,V=new Object;xe(()=>{V=JSON.parse(localStorage.getItem("userSession"))});const A=async(H,M)=>{await(await qe.create({header:H||"Error",message:M||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()},F=async H=>{t(5,L=!0);const U=H.target.files[0],x=await q(U);if(x){let oe=new FormData;oe.append("fileToUpload",x),oe=P(oe);try{const ee=await fetch(`${i}api/admin/manager/upload_img_driver.php`,{method:"POST",body:oe});if(ee.ok){const fe=await ee.json();t(0,E=fe.img),h=fe.img_id}else console.error("File upload failed:",ee.statusText)}catch(ee){console.error("Error during file upload:",ee)}finally{t(5,L=!1)}}},q=async H=>new Promise(M=>{const U=new Image;U.src=URL.createObjectURL(H),U.onload=()=>{const x=document.createElement("canvas"),oe=x.getContext("2d"),ee=800,fe=600;let ae=U.width,le=U.height;ae>ee&&(le*=ee/ae,ae=ee),le>fe&&(ae*=fe/le,le=fe),x.width=ae,x.height=le,oe.drawImage(U,0,0,ae,le),x.toBlob(be=>{M(be),URL.revokeObjectURL(U.src),oe.clearRect(0,0,x.width,x.height)},"image/jpeg",.7)}}),R=()=>{tt.dismiss()},S=()=>{var H=new Object;H.id_route=r,H.comments=I.value,H.type=f.value,H.img=E,H.img_id=h,H.amount=v.value,H.concept=T.value,H.status="done",H.id_expense=k||"null";let M=new FormData;for(const U in H)M.append(U,H[U]);M=P(M),!h||!E||!I.value||!v.value||!T.value?A("Datos incompletos","Llena los datos requeridos para completar el registro"):fetch(`${i}api/admin/expenses/add_expense.php`,{method:"POST",body:M}).then(U=>U.json()).then(U=>{R()}).catch(U=>{console.error("Error fetching data:",U)})};function P(H){return H.append("token",V.token),H.append("id_user_over",V.id_user),H}function B(H){Se[H?"unshift":"push"](()=>{T=H,t(4,T)})}function D(H){Se[H?"unshift":"push"](()=>{v=H,t(2,v)})}function O(H){Se[H?"unshift":"push"](()=>{f=H,t(1,f)})}function K(H){Se[H?"unshift":"push"](()=>{I=H,t(3,I)})}return[E,f,v,I,T,L,d,u,_,F,R,S,B,D,O,K]}class _t extends Ye{constructor(e){super(),Qe(this,e,fo,uo,Je,{})}}function Dt(l,e,t){const i=l.slice();return i[7]=e[t],i}function _o(l){let e,t="Cargar gasto",i,n;function r(...d){return l[4](l[7],...d)}return{c(){e=s("ion-button"),e.textContent=t,this.h()},l(d){e=c(d,"ION-BUTTON",{fill:!0,size:!0,"aria-selected":!0,"data-svelte-h":!0}),ne(e)!=="svelte-175aelj"&&(e.textContent=t),this.h()},h(){g(e,"fill","outline"),g(e,"size","small"),g(e,"aria-selected","")},m(d,u){W(d,e,u),i||(n=se(e,"click",r),i=!0)},p(d,u){l=d},d(d){d&&a(e),i=!1,n()}}}function ho(l){let e,t="Gasto completado";return{c(){e=s("ion-button"),e.textContent=t,this.h()},l(i){e=c(i,"ION-BUTTON",{fill:!0,size:!0,"aria-selected":!0,"data-svelte-h":!0}),ne(e)!=="svelte-tlger7"&&(e.textContent=t),this.h()},h(){g(e,"fill","solid"),g(e,"size","small"),g(e,"aria-selected","")},m(i,n){W(i,e,n)},p:ze,d(i){i&&a(e)}}}function Pt(l,e){let t,i,n,r=e[7].concept+"",d,u,_;function k(f,v){return f[7].status=="done"?ho:_o}let h=k(e)(e);return{key:l,first:null,c(){t=s("ion-item"),i=s("ion-label"),n=s("p"),d=_e(r),u=y(),h.c(),_=y(),this.h()},l(f){t=c(f,"ION-ITEM",{});var v=m(t);i=c(v,"ION-LABEL",{style:!0});var I=m(i);n=c(I,"P",{style:!0});var T=m(n);d=he(T,r),T.forEach(a),I.forEach(a),u=w(v),h.l(v),_=w(v),v.forEach(a),this.h()},h(){b(n,"margin-left","10px"),b(i,"display","flex"),this.first=t},m(f,v){W(f,t,v),o(t,i),o(i,n),o(n,d),o(t,u),h.m(t,null),o(t,_)},p(f,v){e=f,h.p(e,v)},d(f){f&&a(t),h.d()}}}function po(l){let e,t,i,n,r=`<ion-icon style="font-size: 25px!important;" icon="${Cn}"></ion-icon>`,d,u,_="LISTA DE GASTOS",k,E,h,f=[],v=new Map,I,T,L,V="Cerrar",A,F,q=Re(l[0]);const R=S=>S[7].id_expenses;for(let S=0;S<q.length;S+=1){let P=Dt(l,q,S),B=R(P);v.set(B,f[S]=Pt(B,P))}return{c(){e=s("ion-header"),t=s("ion-toolbar"),i=s("ion-buttons"),n=s("ion-button"),n.innerHTML=r,d=y(),u=s("ion-title"),u.textContent=_,k=y(),E=s("ion-content"),h=s("ion-list");for(let S=0;S<f.length;S+=1)f[S].c();I=y(),T=s("ion-footer"),L=s("ion-button"),L.textContent=V,this.h()},l(S){e=c(S,"ION-HEADER",{translucent:!0});var P=m(e);t=c(P,"ION-TOOLBAR",{});var B=m(t);i=c(B,"ION-BUTTONS",{slot:!0});var D=m(i);n=c(D,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),ne(n)!=="svelte-160xz3i"&&(n.innerHTML=r),D.forEach(a),d=w(B),u=c(B,"ION-TITLE",{"data-svelte-h":!0}),ne(u)!=="svelte-1phn90x"&&(u.textContent=_),B.forEach(a),P.forEach(a),k=w(S),E=c(S,"ION-CONTENT",{fullscreen:!0});var O=m(E);h=c(O,"ION-LIST",{});var K=m(h);for(let M=0;M<f.length;M+=1)f[M].l(K);K.forEach(a),O.forEach(a),I=w(S),T=c(S,"ION-FOOTER",{});var H=m(T);L=c(H,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),ne(L)!=="svelte-zv7v83"&&(L.textContent=V),H.forEach(a),this.h()},h(){g(n,"color","medium"),g(i,"slot","end"),g(e,"translucent",""),g(E,"fullscreen",""),g(L,"fill","outline"),g(L,"color","tertiary"),g(L,"strong",""),b(L,"width","99%"),b(L,"height","auto")},m(S,P){W(S,e,P),o(e,t),o(t,i),o(i,n),o(t,d),o(t,u),W(S,k,P),W(S,E,P),o(E,h);for(let B=0;B<f.length;B+=1)f[B]&&f[B].m(h,null);W(S,I,P),W(S,T,P),o(T,L),A||(F=[se(n,"click",l[3]),se(L,"click",l[1])],A=!0)},p(S,[P]){P&5&&(q=Re(S[0]),f=$e(f,P,R,1,S,q,v,h,et,Pt,null,Dt))},i:ze,o:ze,d(S){S&&(a(e),a(k),a(E),a(I),a(T));for(let P=0;P<f.length;P+=1)f[P].d();A=!1,Pe(F)}}}function mo(l){let e=document.querySelector("ion-modal");e.componentProps.routeId;let t=e.componentProps.expenses;xe(()=>{});const i=()=>{tt.dismiss()};function n(u,_,k,E,h){e.componentProps.ex_amount=k,e.componentProps.ex_concept=_,e.componentProps.ex_type=E,e.componentProps.id_expense=h,Ue("modal-expense",_t,{amount:k,concept:_,type:E,id_expense:h}).then(()=>{}),i()}return[t,i,n,u=>{Ue("modal-expense",_t,{routeId:u}).then(_=>{}),i()},(u,_)=>n(_,u.concept,u.amount,u.type,u.id_expenses)]}class vo extends Ye{constructor(e){super(),Qe(this,e,mo,po,Je,{})}}const{document:Ht}=Sn;function Bt(l,e,t){const i=l.slice();return i[49]=e[t],i[51]=t,i}function Rt(l,e,t){const i=l.slice();return i[49]=e[t],i[51]=t,i}function Ut(l,e,t){const i=l.slice();return i[49]=e[t],i[51]=t,i}function Vt(l){let e,t;return e=new zn({props:{$$slots:{default:[No]},$$scope:{ctx:l}}}),{c(){un(e.$$.fragment)},l(i){fn(e.$$.fragment,i)},m(i,n){dn(e,i,n),t=!0},p(i,n){const r={};n[0]&2043|n[1]&8388608&&(r.$$scope={dirty:n,ctx:i}),e.$set(r)},i(i){t||(rt(e.$$.fragment,i),t=!0)},o(i){ut(e.$$.fragment,i),t=!1},d(i){_n(e,i)}}}function go(l){let e,t='<div id="g_map" style="width: 100%; height: 100vh;"></div>';return{c(){e=s("ion-content"),e.innerHTML=t},l(i){e=c(i,"ION-CONTENT",{"data-svelte-h":!0}),ne(e)!=="svelte-1ydw6i9"&&(e.innerHTML=t)},m(i,n){W(i,e,n)},p:ze,d(i){i&&a(e)}}}function bo(l){let e;function t(r,d){if(r[7].length>0)return Io;if(!r[3])return Eo}let i=t(l),n=i&&i(l);return{c(){n&&n.c(),e=Me()},l(r){n&&n.l(r),e=Me()},m(r,d){n&&n.m(r,d),W(r,e,d)},p(r,d){i===(i=t(r))&&n?n.p(r,d):(n&&n.d(1),n=i&&i(r),n&&(n.c(),n.m(e.parentNode,e)))},d(r){r&&a(e),n&&n.d(r)}}}function Eo(l){let e,t,i,n='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Jala para actualizar" refreshing-spinner="circles" refreshing-text="Actualizando..."></ion-refresher-content>',r,d,u,_,k,E,h="0",f,v,I,T,L,V=l[6].origin+"",A,F,q,R="",S,P,B,D=[],O=new Map,K,H,M,U,x,oe=l[5].length+1+"",ee,fe,ae,le,be,Oe,Ee=l[6].destination+"",me,de,ue,Ne="",ve,Ie,Ce,ge,ce=l[4]&&Ft(l),Z=Re(l[5]);const te=Q=>Q[49].id_event;for(let Q=0;Q<Z.length;Q+=1){let p=Bt(l,Z,Q),z=te(p);O.set(z,D[Q]=qt(z,p))}return{c(){ce&&ce.c(),e=y(),t=s("ion-content"),i=s("ion-refresher"),i.innerHTML=n,r=y(),d=s("ion-list"),u=s("ion-item"),_=s("ion-avatar"),k=s("div"),E=s("div"),E.textContent=h,v=y(),I=s("ion-label"),T=s("ion-text"),L=s("h3"),A=_e(V),F=y(),q=s("div"),q.innerHTML=R,S=y(),P=s("ion-icon"),B=y();for(let Q=0;Q<D.length;Q+=1)D[Q].c();K=y(),H=s("ion-item"),M=s("ion-avatar"),U=s("div"),x=s("div"),ee=_e(oe),ae=y(),le=s("ion-label"),be=s("ion-text"),Oe=s("h3"),me=_e(Ee),de=y(),ue=s("div"),ue.innerHTML=Ne,ve=y(),Ie=s("ion-icon"),this.h()},l(Q){ce&&ce.l(Q),e=w(Q),t=c(Q,"ION-CONTENT",{});var p=m(t);i=c(p,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),ne(i)!=="svelte-1srnbs3"&&(i.innerHTML=n),r=w(p),d=c(p,"ION-LIST",{});var z=m(d);u=c(z,"ION-ITEM",{});var C=m(u);_=c(C,"ION-AVATAR",{slot:!0});var j=m(_);k=c(j,"DIV",{class:!0,title:!0,style:!0});var X=m(k);E=c(X,"DIV",{class:!0,"data-svelte-h":!0}),ne(E)!=="svelte-3lvlrb"&&(E.textContent=h),X.forEach(a),j.forEach(a),v=w(C),I=c(C,"ION-LABEL",{button:!0});var Y=m(I);T=c(Y,"ION-TEXT",{color:!0});var N=m(T);L=c(N,"H3",{});var J=m(L);A=he(J,V),J.forEach(a),N.forEach(a),F=w(Y),q=c(Y,"DIV",{class:!0,"data-svelte-h":!0}),ne(q)!=="svelte-gz9kb"&&(q.innerHTML=R),Y.forEach(a),S=w(C),P=c(C,"ION-ICON",{icon:!0,slot:!0}),m(P).forEach(a),C.forEach(a),B=w(z);for(let ke=0;ke<D.length;ke+=1)D[ke].l(z);K=w(z),H=c(z,"ION-ITEM",{});var ie=m(H);M=c(ie,"ION-AVATAR",{slot:!0});var $=m(M);U=c($,"DIV",{class:!0,title:!0,style:!0});var re=m(U);x=c(re,"DIV",{class:!0});var pe=m(x);ee=he(pe,oe),pe.forEach(a),re.forEach(a),$.forEach(a),ae=w(ie),le=c(ie,"ION-LABEL",{button:!0});var Le=m(le);be=c(Le,"ION-TEXT",{color:!0});var ye=m(be);Oe=c(ye,"H3",{});var Te=m(Oe);me=he(Te,Ee),Te.forEach(a),ye.forEach(a),de=w(Le),ue=c(Le,"DIV",{class:!0,"data-svelte-h":!0}),ne(ue)!=="svelte-130ohbs"&&(ue.innerHTML=Ne),Le.forEach(a),ve=w(ie),Ie=c(ie,"ION-ICON",{icon:!0,slot:!0}),m(Ie).forEach(a),ie.forEach(a),z.forEach(a),p.forEach(a),this.h()},h(){g(i,"slot","fixed"),G(E,"class","order svelte-egzizz"),G(k,"class","order-wrapper svelte-egzizz"),G(k,"title",f="$"+l[6].origin),b(k,"background-color",l[6].color),b(k,"color",Ae(l[6].color)),g(_,"slot","start"),g(T,"color","#2e2e2e"),G(q,"class","sub svelte-egzizz"),g(I,"button",""),g(P,"icon",Ve),g(P,"slot","end"),G(x,"class","order svelte-egzizz"),G(U,"class","order-wrapper svelte-egzizz"),G(U,"title",fe="$"+l[6].destination),b(U,"background-color",l[6].color),b(U,"color",Ae(l[6].color)),g(M,"slot","start"),g(be,"color","#2e2e2e"),G(ue,"class","sub svelte-egzizz"),g(le,"button",""),g(Ie,"icon",Ve),g(Ie,"slot","end")},m(Q,p){ce&&ce.m(Q,p),W(Q,e,p),W(Q,t,p),o(t,i),l[31](i),o(t,r),o(t,d),o(d,u),o(u,_),o(_,k),o(k,E),o(u,v),o(u,I),o(I,T),o(T,L),o(L,A),o(I,F),o(I,q),o(u,S),o(u,P),o(d,B);for(let z=0;z<D.length;z+=1)D[z]&&D[z].m(d,null);o(d,K),o(d,H),o(H,M),o(M,U),o(U,x),o(x,ee),o(H,ae),o(H,le),o(le,be),o(be,Oe),o(Oe,me),o(le,de),o(le,ue),o(H,ve),o(H,Ie),Ce||(ge=[se(i,"ionRefresh",l[11]),se(I,"click",l[32]),se(le,"click",l[34])],Ce=!0)},p(Q,p){Q[4]?ce?ce.p(Q,p):(ce=Ft(Q),ce.c(),ce.m(e.parentNode,e)):ce&&(ce.d(1),ce=null),p[0]&64&&f!==(f="$"+Q[6].origin)&&G(k,"title",f),p[0]&64&&b(k,"background-color",Q[6].color),p[0]&64&&b(k,"color",Ae(Q[6].color)),p[0]&64&&V!==(V=Q[6].origin+"")&&we(A,V),p[0]&664608&&(Z=Re(Q[5]),D=$e(D,p,te,1,Q,Z,O,d,et,qt,K,Bt)),p[0]&32&&oe!==(oe=Q[5].length+1+"")&&we(ee,oe),p[0]&64&&fe!==(fe="$"+Q[6].destination)&&G(U,"title",fe),p[0]&64&&b(U,"background-color",Q[6].color),p[0]&64&&b(U,"color",Ae(Q[6].color)),p[0]&64&&Ee!==(Ee=Q[6].destination+"")&&we(me,Ee)},d(Q){Q&&(a(e),a(t)),ce&&ce.d(Q),l[31](null);for(let p=0;p<D.length;p+=1)D[p].d();Ce=!1,Pe(ge)}}}function Io(l){let e,t;function i(d,u){return u[0]&144&&(e=null),e==null&&(e=!!(d[7].filter(Co).every(yo)&&!d[4])),e?Oo:ko}let n=i(l,[-1,-1]),r=n(l);return{c(){r.c(),t=Me()},l(d){r.l(d),t=Me()},m(d,u){r.m(d,u),W(d,t,u)},p(d,u){n===(n=i(d,u))&&r?r.p(d,u):(r.d(1),r=n(d),r&&(r.c(),r.m(t.parentNode,t)))},d(d){d&&a(t),r.d(d)}}}function Ft(l){let e=l[15]("",l[1],l[0])+"",t;return{c(){t=_e(e)},l(i){t=he(i,e)},m(i,n){W(i,t,n)},p(i,n){n[0]&3&&e!==(e=i[15]("",i[1],i[0])+"")&&we(t,e)},d(i){i&&a(t)}}}function jt(l){let e;return{c(){e=s("span"),this.h()},l(t){e=c(t,"SPAN",{class:!0}),m(e).forEach(a),this.h()},h(){G(e,"class","notes svelte-egzizz")},m(t,i){W(t,e,i)},d(t){t&&a(e)}}}function qt(l,e){let t,i,n,r,d=parseInt(e[49].pos)+1+"",u,_,k,E,h,f,v=e[49].title+"",I,T,L=e[49].support_list&&e[49].support_list.length||e[17](e[49]),V,A,F=(e[49].tag?e[49].tag:"")+"",q,R,S,P=L&&jt();function B(){return e[33](e[49])}return{key:l,first:null,c(){t=s("ion-item"),i=s("ion-avatar"),n=s("div"),r=s("div"),u=_e(d),k=y(),E=s("ion-label"),h=s("ion-text"),f=s("h3"),I=_e(v),T=y(),P&&P.c(),V=y(),A=s("div"),q=_e(F),this.h()},l(D){t=c(D,"ION-ITEM",{});var O=m(t);i=c(O,"ION-AVATAR",{slot:!0});var K=m(i);n=c(K,"DIV",{class:!0,title:!0,style:!0});var H=m(n);r=c(H,"DIV",{class:!0});var M=m(r);u=he(M,d),M.forEach(a),H.forEach(a),K.forEach(a),k=w(O),E=c(O,"ION-LABEL",{button:!0});var U=m(E);h=c(U,"ION-TEXT",{color:!0});var x=m(h);f=c(x,"H3",{});var oe=m(f);I=he(oe,v),T=w(oe),P&&P.l(oe),oe.forEach(a),x.forEach(a),U.forEach(a),V=w(O),A=c(O,"DIV",{class:!0,slot:!0,style:!0});var ee=m(A);q=he(ee,F),ee.forEach(a),O.forEach(a),this.h()},h(){G(r,"class","order svelte-egzizz"),G(n,"class","order-wrapper svelte-egzizz"),G(n,"title",_=We(e[49].status)),b(n,"background-color",He(e[49].status,e[49].date_service)),b(n,"color",Ae(He(e[49].status))),g(i,"slot","start"),g(h,"color","#2e2e2e"),g(E,"button",""),G(A,"class","stop-tag"),G(A,"slot","end"),b(A,"background-color",De(e[49].tag_color,.3)),b(A,"border","1px solid "+De(e[49].tag_color,.4)),b(A,"color",e[49].tag_color),b(A,"font-size","10px"),b(A,"text-align","center"),b(A,"align-content","center"),b(A,"border-radius","20px"),b(A,"white-space","normal"),b(A,"padding","3px 6px"),b(A,"width","auto",1),b(A,"display","inline-block"),b(A,"font-weight","500"),this.first=t},m(D,O){W(D,t,O),o(t,i),o(i,n),o(n,r),o(r,u),o(t,k),o(t,E),o(E,h),o(h,f),o(f,I),o(f,T),P&&P.m(f,null),o(t,V),o(t,A),o(A,q),R||(S=se(E,"click",B),R=!0)},p(D,O){e=D,O[0]&32&&d!==(d=parseInt(e[49].pos)+1+"")&&we(u,d),O[0]&32&&_!==(_=We(e[49].status))&&G(n,"title",_),O[0]&32&&b(n,"background-color",He(e[49].status,e[49].date_service)),O[0]&32&&b(n,"color",Ae(He(e[49].status))),O[0]&32&&v!==(v=e[49].title+"")&&we(I,v),O[0]&32&&(L=e[49].support_list&&e[49].support_list.length||e[17](e[49])),L?P||(P=jt(),P.c(),P.m(f,null)):P&&(P.d(1),P=null),O[0]&32&&F!==(F=(e[49].tag?e[49].tag:"")+"")&&we(q,F),O[0]&32&&b(A,"background-color",De(e[49].tag_color,.3)),O[0]&32&&b(A,"border","1px solid "+De(e[49].tag_color,.4)),O[0]&32&&b(A,"color",e[49].tag_color)},d(D){D&&a(t),P&&P.d(),R=!1,S()}}}function ko(l){let e=l[15](l[7],l[1],l[0])+"",t,i,n,r,d='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Pull to refresh" refreshing-spinner="circles" refreshing-text="Refreshing..."></ion-refresher-content>',u,_,k,E,h,f,v="0",I,T,L,V,A,F=l[6].origin+"",q,R,S,P="",B,D,O,K=[],H=new Map,M,U,x,oe,ee,fe=l[5].length+1+"",ae,le,be,Oe,Ee,me,de=l[6].destination+"",ue,Ne,ve,Ie="",Ce,ge,ce,Z,te=Re(l[5]);const Q=p=>p[49].id_event;for(let p=0;p<te.length;p+=1){let z=Rt(l,te,p),C=Q(z);H.set(C,K[p]=Kt(C,z))}return{c(){t=_e(e),i=y(),n=s("ion-content"),r=s("ion-refresher"),r.innerHTML=d,u=y(),_=s("ion-list"),k=s("ion-item"),E=s("ion-avatar"),h=s("div"),f=s("div"),f.textContent=v,T=y(),L=s("ion-label"),V=s("ion-text"),A=s("h3"),q=_e(F),R=y(),S=s("div"),S.innerHTML=P,B=y(),D=s("ion-icon"),O=y();for(let p=0;p<K.length;p+=1)K[p].c();M=y(),U=s("ion-item"),x=s("ion-avatar"),oe=s("div"),ee=s("div"),ae=_e(fe),be=y(),Oe=s("ion-label"),Ee=s("ion-text"),me=s("h3"),ue=_e(de),Ne=y(),ve=s("div"),ve.innerHTML=Ie,Ce=y(),ge=s("ion-icon"),this.h()},l(p){t=he(p,e),i=w(p),n=c(p,"ION-CONTENT",{});var z=m(n);r=c(z,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),ne(r)!=="svelte-dvt1s"&&(r.innerHTML=d),u=w(z),_=c(z,"ION-LIST",{});var C=m(_);k=c(C,"ION-ITEM",{});var j=m(k);E=c(j,"ION-AVATAR",{slot:!0});var X=m(E);h=c(X,"DIV",{class:!0,title:!0,style:!0});var Y=m(h);f=c(Y,"DIV",{class:!0,"data-svelte-h":!0}),ne(f)!=="svelte-3lvlrb"&&(f.textContent=v),Y.forEach(a),X.forEach(a),T=w(j),L=c(j,"ION-LABEL",{button:!0});var N=m(L);V=c(N,"ION-TEXT",{color:!0});var J=m(V);A=c(J,"H3",{});var ie=m(A);q=he(ie,F),ie.forEach(a),J.forEach(a),R=w(N),S=c(N,"DIV",{class:!0,"data-svelte-h":!0}),ne(S)!=="svelte-gz9kb"&&(S.innerHTML=P),N.forEach(a),B=w(j),D=c(j,"ION-ICON",{icon:!0,slot:!0}),m(D).forEach(a),j.forEach(a),O=w(C);for(let Be=0;Be<K.length;Be+=1)K[Be].l(C);M=w(C),U=c(C,"ION-ITEM",{});var $=m(U);x=c($,"ION-AVATAR",{slot:!0});var re=m(x);oe=c(re,"DIV",{class:!0,title:!0,style:!0});var pe=m(oe);ee=c(pe,"DIV",{class:!0});var Le=m(ee);ae=he(Le,fe),Le.forEach(a),pe.forEach(a),re.forEach(a),be=w($),Oe=c($,"ION-LABEL",{button:!0});var ye=m(Oe);Ee=c(ye,"ION-TEXT",{color:!0});var Te=m(Ee);me=c(Te,"H3",{});var ke=m(me);ue=he(ke,de),ke.forEach(a),Te.forEach(a),Ne=w(ye),ve=c(ye,"DIV",{class:!0,"data-svelte-h":!0}),ne(ve)!=="svelte-130ohbs"&&(ve.innerHTML=Ie),ye.forEach(a),Ce=w($),ge=c($,"ION-ICON",{icon:!0,slot:!0}),m(ge).forEach(a),$.forEach(a),C.forEach(a),z.forEach(a),this.h()},h(){g(r,"slot","fixed"),G(f,"class","order svelte-egzizz"),G(h,"class","order-wrapper svelte-egzizz"),G(h,"title",I="$"+l[6].origin),b(h,"background-color",l[6].color),b(h,"color",Ae(l[6].color)),g(E,"slot","start"),g(V,"color","#2e2e2e"),G(S,"class","sub svelte-egzizz"),g(L,"button",""),g(D,"icon",Ve),g(D,"slot","end"),G(ee,"class","order svelte-egzizz"),G(oe,"class","order-wrapper svelte-egzizz"),G(oe,"title",le="$"+l[6].destination),b(oe,"background-color",l[6].color),b(oe,"color",Ae(l[6].color)),g(x,"slot","start"),g(Ee,"color","#2e2e2e"),G(ve,"class","sub svelte-egzizz"),g(Oe,"button",""),g(ge,"icon",Ve),g(ge,"slot","end")},m(p,z){W(p,t,z),W(p,i,z),W(p,n,z),o(n,r),l[27](r),o(n,u),o(n,_),o(_,k),o(k,E),o(E,h),o(h,f),o(k,T),o(k,L),o(L,V),o(V,A),o(A,q),o(L,R),o(L,S),o(k,B),o(k,D),o(_,O);for(let C=0;C<K.length;C+=1)K[C]&&K[C].m(_,null);o(_,M),o(_,U),o(U,x),o(x,oe),o(oe,ee),o(ee,ae),o(U,be),o(U,Oe),o(Oe,Ee),o(Ee,me),o(me,ue),o(Oe,Ne),o(Oe,ve),o(U,Ce),o(U,ge),ce||(Z=[se(r,"ionRefresh",l[11]),se(L,"click",l[28]),se(Oe,"click",l[30])],ce=!0)},p(p,z){z[0]&131&&e!==(e=p[15](p[7],p[1],p[0])+"")&&we(t,e),z[0]&64&&I!==(I="$"+p[6].origin)&&G(h,"title",I),z[0]&64&&b(h,"background-color",p[6].color),z[0]&64&&b(h,"color",Ae(p[6].color)),z[0]&64&&F!==(F=p[6].origin+"")&&we(q,F),z[0]&664608&&(te=Re(p[5]),K=$e(K,z,Q,1,p,te,H,_,et,Kt,M,Rt)),z[0]&32&&fe!==(fe=p[5].length+1+"")&&we(ae,fe),z[0]&64&&le!==(le="$"+p[6].destination)&&G(oe,"title",le),z[0]&64&&b(oe,"background-color",p[6].color),z[0]&64&&b(oe,"color",Ae(p[6].color)),z[0]&64&&de!==(de=p[6].destination+"")&&we(ue,de)},d(p){p&&(a(t),a(i),a(n)),l[27](null);for(let z=0;z<K.length;z+=1)K[z].d();ce=!1,Pe(Z)}}}function Oo(l){let e,t,i='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Jale para actualizar" refreshing-spinner="circles" refreshing-text="Actualizando..."></ion-refresher-content>',n,r,d,u,_,k,E="0",h,f,v,I,T,L=l[6].origin+"",V,A,F,q="",R,S,P,B=[],D=new Map,O,K,H,M,U,x=l[5].length+1+"",oe,ee,fe,ae,le,be,Oe=l[6].destination+"",Ee,me,de,ue="",Ne,ve,Ie,Ce,ge=Re(l[5]);const ce=Z=>Z[49].id_event;for(let Z=0;Z<ge.length;Z+=1){let te=Ut(l,ge,Z),Q=ce(te);D.set(Q,B[Z]=Wt(Q,te))}return{c(){e=s("ion-content"),t=s("ion-refresher"),t.innerHTML=i,n=y(),r=s("ion-list"),d=s("ion-item"),u=s("ion-avatar"),_=s("div"),k=s("div"),k.textContent=E,f=y(),v=s("ion-label"),I=s("ion-text"),T=s("h3"),V=_e(L),A=y(),F=s("div"),F.innerHTML=q,R=y(),S=s("ion-icon"),P=y();for(let Z=0;Z<B.length;Z+=1)B[Z].c();O=y(),K=s("ion-item"),H=s("ion-avatar"),M=s("div"),U=s("div"),oe=_e(x),fe=y(),ae=s("ion-label"),le=s("ion-text"),be=s("h3"),Ee=_e(Oe),me=y(),de=s("div"),de.innerHTML=ue,Ne=y(),ve=s("ion-icon"),this.h()},l(Z){e=c(Z,"ION-CONTENT",{});var te=m(e);t=c(te,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),ne(t)!=="svelte-15ukrgn"&&(t.innerHTML=i),n=w(te),r=c(te,"ION-LIST",{});var Q=m(r);d=c(Q,"ION-ITEM",{});var p=m(d);u=c(p,"ION-AVATAR",{slot:!0});var z=m(u);_=c(z,"DIV",{class:!0,title:!0,style:!0});var C=m(_);k=c(C,"DIV",{class:!0,"data-svelte-h":!0}),ne(k)!=="svelte-3lvlrb"&&(k.textContent=E),C.forEach(a),z.forEach(a),f=w(p),v=c(p,"ION-LABEL",{button:!0});var j=m(v);I=c(j,"ION-TEXT",{color:!0});var X=m(I);T=c(X,"H3",{});var Y=m(T);V=he(Y,L),Y.forEach(a),X.forEach(a),A=w(j),F=c(j,"DIV",{class:!0,"data-svelte-h":!0}),ne(F)!=="svelte-gz9kb"&&(F.innerHTML=q),j.forEach(a),R=w(p),S=c(p,"ION-ICON",{icon:!0,slot:!0}),m(S).forEach(a),p.forEach(a),P=w(Q);for(let ye=0;ye<B.length;ye+=1)B[ye].l(Q);O=w(Q),K=c(Q,"ION-ITEM",{});var N=m(K);H=c(N,"ION-AVATAR",{slot:!0});var J=m(H);M=c(J,"DIV",{class:!0,title:!0,style:!0});var ie=m(M);U=c(ie,"DIV",{class:!0});var $=m(U);oe=he($,x),$.forEach(a),ie.forEach(a),J.forEach(a),fe=w(N),ae=c(N,"ION-LABEL",{button:!0});var re=m(ae);le=c(re,"ION-TEXT",{color:!0});var pe=m(le);be=c(pe,"H3",{});var Le=m(be);Ee=he(Le,Oe),Le.forEach(a),pe.forEach(a),me=w(re),de=c(re,"DIV",{class:!0,"data-svelte-h":!0}),ne(de)!=="svelte-130ohbs"&&(de.innerHTML=ue),re.forEach(a),Ne=w(N),ve=c(N,"ION-ICON",{icon:!0,slot:!0}),m(ve).forEach(a),N.forEach(a),Q.forEach(a),te.forEach(a),this.h()},h(){g(t,"slot","fixed"),G(k,"class","order svelte-egzizz"),G(_,"class","order-wrapper svelte-egzizz"),G(_,"title",h="$"+l[6].origin),b(_,"background-color",l[6].color),b(_,"color",Ae(l[6].color)),g(u,"slot","start"),g(I,"color","#2e2e2e"),G(F,"class","sub svelte-egzizz"),g(v,"button",""),g(S,"icon",Ve),g(S,"slot","end"),G(U,"class","order svelte-egzizz"),G(M,"class","order-wrapper svelte-egzizz"),G(M,"title",ee="$"+l[6].destination),b(M,"background-color",l[6].color),b(M,"color",Ae(l[6].color)),g(H,"slot","start"),g(le,"color","#2e2e2e"),G(de,"class","sub svelte-egzizz"),g(ae,"button",""),g(ve,"icon",Ve),g(ve,"slot","end")},m(Z,te){W(Z,e,te),o(e,t),l[23](t),o(e,n),o(e,r),o(r,d),o(d,u),o(u,_),o(_,k),o(d,f),o(d,v),o(v,I),o(I,T),o(T,V),o(v,A),o(v,F),o(d,R),o(d,S),o(r,P);for(let Q=0;Q<B.length;Q+=1)B[Q]&&B[Q].m(r,null);o(r,O),o(r,K),o(K,H),o(H,M),o(M,U),o(U,oe),o(K,fe),o(K,ae),o(ae,le),o(le,be),o(be,Ee),o(ae,me),o(ae,de),o(K,Ne),o(K,ve),Ie||(Ce=[se(t,"ionRefresh",l[11]),se(v,"click",l[24]),se(ae,"click",l[26])],Ie=!0)},p(Z,te){te[0]&64&&h!==(h="$"+Z[6].origin)&&G(_,"title",h),te[0]&64&&b(_,"background-color",Z[6].color),te[0]&64&&b(_,"color",Ae(Z[6].color)),te[0]&64&&L!==(L=Z[6].origin+"")&&we(V,L),te[0]&664608&&(ge=Re(Z[5]),B=$e(B,te,ce,1,Z,ge,D,r,et,Wt,O,Ut)),te[0]&32&&x!==(x=Z[5].length+1+"")&&we(oe,x),te[0]&64&&ee!==(ee="$"+Z[6].destination)&&G(M,"title",ee),te[0]&64&&b(M,"background-color",Z[6].color),te[0]&64&&b(M,"color",Ae(Z[6].color)),te[0]&64&&Oe!==(Oe=Z[6].destination+"")&&we(Ee,Oe)},d(Z){Z&&a(e),l[23](null);for(let te=0;te<B.length;te+=1)B[te].d();Ie=!1,Pe(Ce)}}}function Gt(l){let e;return{c(){e=s("span"),this.h()},l(t){e=c(t,"SPAN",{class:!0}),m(e).forEach(a),this.h()},h(){G(e,"class","notes svelte-egzizz")},m(t,i){W(t,e,i)},d(t){t&&a(e)}}}function Kt(l,e){let t,i,n,r,d=parseInt(e[49].pos)+1+"",u,_,k,E,h,f,v=e[49].title+"",I,T,L=e[49].support_list&&e[49].support_list.length||e[17](e[49]),V,A,F="",q,R,S=(e[49].tag?e[49].tag:"")+"",P,B,D,O=L&&Gt();function K(){return e[29](e[49])}return{key:l,first:null,c(){t=s("ion-item"),i=s("ion-avatar"),n=s("div"),r=s("div"),u=_e(d),k=y(),E=s("ion-label"),h=s("ion-text"),f=s("h3"),I=_e(v),T=y(),O&&O.c(),V=y(),A=s("div"),A.innerHTML=F,q=y(),R=s("div"),P=_e(S),this.h()},l(H){t=c(H,"ION-ITEM",{});var M=m(t);i=c(M,"ION-AVATAR",{slot:!0});var U=m(i);n=c(U,"DIV",{class:!0,title:!0,style:!0});var x=m(n);r=c(x,"DIV",{class:!0});var oe=m(r);u=he(oe,d),oe.forEach(a),x.forEach(a),U.forEach(a),k=w(M),E=c(M,"ION-LABEL",{button:!0});var ee=m(E);h=c(ee,"ION-TEXT",{color:!0});var fe=m(h);f=c(fe,"H3",{});var ae=m(f);I=he(ae,v),T=w(ae),O&&O.l(ae),ae.forEach(a),fe.forEach(a),V=w(ee),A=c(ee,"DIV",{class:!0,"data-svelte-h":!0}),ne(A)!=="svelte-qaecoo"&&(A.innerHTML=F),ee.forEach(a),q=w(M),R=c(M,"DIV",{class:!0,slot:!0,style:!0});var le=m(R);P=he(le,S),le.forEach(a),M.forEach(a),this.h()},h(){G(r,"class","order svelte-egzizz"),G(n,"class","order-wrapper svelte-egzizz"),G(n,"title",_=We(e[49].status)),b(n,"background-color",He(e[49].status,e[49].date_service)),b(n,"color",Ae(He(e[49].status))),g(i,"slot","start"),g(h,"color","#2e2e2e"),G(A,"class","sub svelte-egzizz"),g(E,"button",""),G(R,"class","stop-tag"),G(R,"slot","end"),b(R,"background-color",De(e[49].tag_color,.3)),b(R,"border","1px solid "+De(e[49].tag_color,.4)),b(R,"color",e[49].tag_color),b(R,"font-size","10px"),b(R,"text-align","center"),b(R,"align-content","center"),b(R,"border-radius","20px"),b(R,"white-space","normal"),b(R,"padding","3px 6px"),b(R,"width","auto",1),b(R,"display","inline-block"),b(R,"font-weight","500"),this.first=t},m(H,M){W(H,t,M),o(t,i),o(i,n),o(n,r),o(r,u),o(t,k),o(t,E),o(E,h),o(h,f),o(f,I),o(f,T),O&&O.m(f,null),o(E,V),o(E,A),o(t,q),o(t,R),o(R,P),B||(D=se(E,"click",K),B=!0)},p(H,M){e=H,M[0]&32&&d!==(d=parseInt(e[49].pos)+1+"")&&we(u,d),M[0]&32&&_!==(_=We(e[49].status))&&G(n,"title",_),M[0]&32&&b(n,"background-color",He(e[49].status,e[49].date_service)),M[0]&32&&b(n,"color",Ae(He(e[49].status))),M[0]&32&&v!==(v=e[49].title+"")&&we(I,v),M[0]&32&&(L=e[49].support_list&&e[49].support_list.length||e[17](e[49])),L?O||(O=Gt(),O.c(),O.m(f,null)):O&&(O.d(1),O=null),M[0]&32&&S!==(S=(e[49].tag?e[49].tag:"")+"")&&we(P,S),M[0]&32&&b(R,"background-color",De(e[49].tag_color,.3)),M[0]&32&&b(R,"border","1px solid "+De(e[49].tag_color,.4)),M[0]&32&&b(R,"color",e[49].tag_color)},d(H){H&&a(t),O&&O.d(),B=!1,D()}}}function Xt(l){let e;return{c(){e=s("span"),this.h()},l(t){e=c(t,"SPAN",{class:!0}),m(e).forEach(a),this.h()},h(){G(e,"class","notes svelte-egzizz")},m(t,i){W(t,e,i)},d(t){t&&a(e)}}}function Wt(l,e){let t,i,n,r,d=parseInt(e[49].pos)+1+"",u,_,k,E,h,f,v=e[49].title+"",I,T,L=e[49].support_list&&e[49].support_list.length||e[17](e[49]),V,A,F="",q,R,S=(e[49].tag?e[49].tag:"")+"",P,B,D,O=L&&Xt();function K(){return e[25](e[49])}return{key:l,first:null,c(){t=s("ion-item"),i=s("ion-avatar"),n=s("div"),r=s("div"),u=_e(d),k=y(),E=s("ion-label"),h=s("ion-text"),f=s("h3"),I=_e(v),T=y(),O&&O.c(),V=y(),A=s("div"),A.innerHTML=F,q=y(),R=s("div"),P=_e(S),this.h()},l(H){t=c(H,"ION-ITEM",{});var M=m(t);i=c(M,"ION-AVATAR",{slot:!0});var U=m(i);n=c(U,"DIV",{class:!0,title:!0,style:!0});var x=m(n);r=c(x,"DIV",{class:!0});var oe=m(r);u=he(oe,d),oe.forEach(a),x.forEach(a),U.forEach(a),k=w(M),E=c(M,"ION-LABEL",{button:!0});var ee=m(E);h=c(ee,"ION-TEXT",{color:!0});var fe=m(h);f=c(fe,"H3",{});var ae=m(f);I=he(ae,v),T=w(ae),O&&O.l(ae),ae.forEach(a),fe.forEach(a),V=w(ee),A=c(ee,"DIV",{class:!0,"data-svelte-h":!0}),ne(A)!=="svelte-qaecoo"&&(A.innerHTML=F),ee.forEach(a),q=w(M),R=c(M,"DIV",{class:!0,slot:!0,style:!0});var le=m(R);P=he(le,S),le.forEach(a),M.forEach(a),this.h()},h(){G(r,"class","order svelte-egzizz"),G(n,"class","order-wrapper svelte-egzizz"),G(n,"title",_=We(e[49].status)),b(n,"background-color",He(e[49].status,e[49].date_service)),b(n,"color",Ae(He(e[49].status))),g(i,"slot","start"),g(h,"color","#2e2e2e"),G(A,"class","sub svelte-egzizz"),g(E,"button",""),G(R,"class","stop-tag"),G(R,"slot","end"),b(R,"background-color",De(e[49].tag_color,.3)),b(R,"border","1px solid "+De(e[49].tag_color,.4)),b(R,"color",e[49].tag_color),b(R,"font-size","10px"),b(R,"text-align","center"),b(R,"align-content","center"),b(R,"border-radius","20px"),b(R,"white-space","normal"),b(R,"padding","3px 6px"),b(R,"width","auto",1),b(R,"display","inline-block"),b(R,"font-weight","500"),this.first=t},m(H,M){W(H,t,M),o(t,i),o(i,n),o(n,r),o(r,u),o(t,k),o(t,E),o(E,h),o(h,f),o(f,I),o(f,T),O&&O.m(f,null),o(E,V),o(E,A),o(t,q),o(t,R),o(R,P),B||(D=se(E,"click",K),B=!0)},p(H,M){e=H,M[0]&32&&d!==(d=parseInt(e[49].pos)+1+"")&&we(u,d),M[0]&32&&_!==(_=We(e[49].status))&&G(n,"title",_),M[0]&32&&b(n,"background-color",He(e[49].status,e[49].date_service)),M[0]&32&&b(n,"color",Ae(He(e[49].status))),M[0]&32&&v!==(v=e[49].title+"")&&we(I,v),M[0]&32&&(L=e[49].support_list&&e[49].support_list.length||e[17](e[49])),L?O||(O=Xt(),O.c(),O.m(f,null)):O&&(O.d(1),O=null),M[0]&32&&S!==(S=(e[49].tag?e[49].tag:"")+"")&&we(P,S),M[0]&32&&b(R,"background-color",De(e[49].tag_color,.3)),M[0]&32&&b(R,"border","1px solid "+De(e[49].tag_color,.4)),M[0]&32&&b(R,"color",e[49].tag_color)},d(H){H&&a(t),O&&O.d(),B=!1,D()}}}function No(l){let e,t,i,n,r=`<ion-icon icon="${yn}"></ion-icon>`,d,u,_,k=`<ion-icon icon="${wn}"></ion-icon>`,E,h,f=(l[6].name?l[6].name.toUpperCase():"")+"",v,I,T,L='<ion-segment-button value="list"><ion-label>Paradas</ion-label></ion-segment-button> <ion-segment-button value="map"><ion-label>Mapa</ion-label></ion-segment-button>',V,A,F,q;function R(B,D){if(B[9]==="list")return bo;if(B[9]==="map")return go}let S=R(l),P=S&&S(l);return{c(){e=s("ion-header"),t=s("ion-toolbar"),i=s("ion-buttons"),n=s("ion-button"),n.innerHTML=r,d=y(),u=s("ion-buttons"),_=s("ion-button"),_.innerHTML=k,E=y(),h=s("ion-title"),v=_e(f),I=y(),T=s("ion-segment"),T.innerHTML=L,V=y(),P&&P.c(),A=Me(),this.h()},l(B){e=c(B,"ION-HEADER",{translucent:!0});var D=m(e);t=c(D,"ION-TOOLBAR",{});var O=m(t);i=c(O,"ION-BUTTONS",{slot:!0});var K=m(i);n=c(K,"ION-BUTTON",{title:!0,alt:!0,"data-svelte-h":!0}),ne(n)!=="svelte-7ppz3r"&&(n.innerHTML=r),K.forEach(a),d=w(O),u=c(O,"ION-BUTTONS",{slot:!0});var H=m(u);_=c(H,"ION-BUTTON",{"data-svelte-h":!0}),ne(_)!=="svelte-nf50hj"&&(_.innerHTML=k),H.forEach(a),E=w(O),h=c(O,"ION-TITLE",{});var M=m(h);v=he(M,f),M.forEach(a),O.forEach(a),I=w(D),T=c(D,"ION-SEGMENT",{value:!0,"data-svelte-h":!0}),ne(T)!=="svelte-lue4c9"&&(T.innerHTML=L),D.forEach(a),V=w(B),P&&P.l(B),A=Me(),this.h()},h(){g(n,"title","Atrás"),g(n,"alt","Atrás"),g(i,"slot","start"),g(u,"slot","end"),g(T,"value","list"),g(e,"translucent","")},m(B,D){W(B,e,D),o(e,t),o(t,i),o(i,n),o(t,d),o(t,u),o(u,_),o(t,E),o(t,h),o(h,v),o(e,I),o(e,T),W(B,V,D),P&&P.m(B,D),W(B,A,D),F||(q=[se(n,"click",l[18]),se(_,"click",l[21]),se(T,"ionChange",l[22])],F=!0)},p(B,D){D[0]&64&&f!==(f=(B[6].name?B[6].name.toUpperCase():"")+"")&&we(v,f),S===(S=R(B))&&P?P.p(B,D):(P&&P.d(1),P=S&&S(B),P&&(P.c(),P.m(A.parentNode,A)))},d(B){B&&(a(e),a(V),a(A)),P&&P.d(B),F=!1,Pe(q)}}}function To(l){let e,t,i,n=l[2]&&Vt(l);return{c(){e=y(),n&&n.c(),t=Me(),this.h()},l(r){rn("svelte-kn0kph",Ht.head).forEach(a),e=w(r),n&&n.l(r),t=Me(),this.h()},h(){Ht.title="Rutaflow - Detalles de ruta"},m(r,d){W(r,e,d),n&&n.m(r,d),W(r,t,d),i=!0},p(r,d){r[2]?n?(n.p(r,d),d[0]&4&&rt(n,1)):(n=Vt(r),n.c(),rt(n,1),n.m(t.parentNode,t)):n&&(hn(),ut(n,1,1,()=>{n=null}),cn())},i(r){i||(rt(n),i=!0)},o(r){ut(n),i=!1},d(r){r&&(a(e),a(t)),n&&n.d(r)}}}function He(l,e=""){let t="#ffffff";return l==="pending"&&!e?t="#f2e300":l=="pending"&&e?t="#F6A833":l==="completed"&&(t="#44d900"),t}function We(l){let e="";return l=="pending"?e="Pendiente":l=="completed"&&(e="Completado"),e}function Ae(l){l.slice(0,1)==="#"&&(l=l.slice(1)),l.length===3&&(l=l.split("").map(function(r){return r+r}).join(""));const e=parseInt(l.substr(0,2),16),t=parseInt(l.substr(2,2),16),i=parseInt(l.substr(4,2),16);return(e*299+t*587+i*114)/1e3>=128?"#414040":"#fff"}function ct(l,e){for(let t=0;t<e.length;t++)if(e[t].alias===l)return e[t].val;return""}const Co=l=>l.mandatory==="1",yo=l=>l.img;function wo(l,e,t){let i;an(l,Ln,p=>t(20,i=p));var n=this&&this.__awaiter||function(p,z,C,j){function X(Y){return Y instanceof C?Y:new C(function(N){N(Y)})}return new(C||(C=Promise))(function(Y,N){function J(re){try{$(j.next(re))}catch(pe){N(pe)}}function ie(re){try{$(j.throw(re))}catch(pe){N(pe)}}function $(re){re.done?Y(re.value):X(re.value).then(J,ie)}$((j=j.apply(p,z||[])).next())})};let{routeId:r}=e,{driverId:d}=e,u=at,_=new Object,k=!0,E=!1,h=[],f={},v=[],I=[],T,L=!1,V="list",A,F="",q="",R="0",S=new Object;const P=()=>n(void 0,void 0,void 0,function*(){yield O(r),T.complete()});xe(()=>n(void 0,void 0,void 0,function*(){be(),yield O(r)}));function B(p){return n(this,void 0,void 0,function*(){if(t(9,V=p),V==="map"){yield sn(),A=document.getElementById("g_map");const z=new google.maps.Map(A,{zoom:8,center:{lat:20.6745683,lng:-103.3986104},mapId:"4504f8b37365c3d0"}),C=new google.maps.LatLngBounds,{AdvancedMarkerElement:j,PinElement:X}=yield google.maps.importLibrary("marker");navigator.geolocation?navigator.geolocation.getCurrentPosition(function(Y){const N=new google.maps.LatLng(Y.coords.latitude,Y.coords.longitude);new google.maps.Marker({position:N,map:z,icon:{path:google.maps.SymbolPath.CIRCLE,fillColor:"#0062ff",fillOpacity:1,scale:6,strokeColor:"#ffffff",strokeWeight:2}}),new google.maps.Circle({strokeColor:"#00BFFF",strokeOpacity:.5,strokeWeight:1,fillColor:"#00BFFF",fillOpacity:.2,map:z,center:N,radius:Y.coords.accuracy}),C.extend(N)},function(Y){console.error("Error retrieving location:",Y)}):console.error("Geolocation not supported by this browser."),f.lat1===f.lat2&&f.lon1===f.lon2?D(C,z,{lat:f.lat2,lon:f.lon2,color:f.color,title:f.destination},{type:"icon",iconClass:"icon-home",title:"Origen/Destino",glyph:`0,${String(h.length+1)}`}):(D(C,z,{lat:f.lat1,lon:f.lon1,color:f.color,title:f.origin},{type:"icon",iconClass:"icon-home",title:"Origen",glyph:"0"}),D(C,z,{lat:f.lat2,lon:f.lon2,color:f.color,title:f.destination},{type:"icon",iconClass:"icon-flag",title:"Destino",glyph:String(h.length+1)})),h.forEach((Y,N)=>{const J=parseFloat(Y.lat),ie=parseFloat(Y.lon),$=new google.maps.LatLng(J,ie),re=new google.maps.Marker({position:{lat:J,lng:ie},map:z,title:Y.title}),pe=new X({background:He(Y.status,Y.date_service),borderColor:"#000",glyphColor:"#000",glyph:(parseInt(Y.pos)+1).toString()});new j({map:z,position:$,content:pe.element,title:"Parada "+(parseInt(Y.pos)+1).toString()+": "+Y.title}).addListener("click",function(ye){H(Y,!1)}),C.extend(re.getPosition())}),z.fitBounds(C)}})}function D(p,z,C,j){return n(this,void 0,void 0,function*(){let X;const Y=parseFloat(C.lat),N=parseFloat(C.lon),J=new google.maps.LatLng(Y,N),{AdvancedMarkerElement:ie,PinElement:$}=yield google.maps.importLibrary("marker");j.type=="icon"?(X=document.createElement("i"),X.className=`${j.iconClass} icon`,X.style.fontSize="14px",X.style.color=Ae(C.color),X.style.fontWeight="600"):j.type=="text";const re=new google.maps.Marker({position:{lat:Y,lng:N},map:z,title:`${j.title}. ${C.title}`}),pe=new $({background:C.color,borderColor:"#000",glyphColor:Ae(C.color),glyph:j.glyph});return new ie({map:z,position:J,content:pe.element,title:j.title+": "+C.title}).addListener("click",function(ye){M(f,j.title=="Destino"||j.title=="Origen/Destino")}),re})}function O(p){return n(this,void 0,void 0,function*(){let z=new FormData;z.append("id_route",p),z=le(z),z.append("id_enterprise",_.id_enterprise);try{const j=yield(yield fetch(`${u}api/admin/report/seguimiento_list.php`,{method:"POST",body:z})).json();t(6,f=j.data.seguimiento_list[0]),t(5,h=j.data.event_list),t(7,v=j.data.checklist),I=j.data.expenses,f&&t(4,E=f.km_inicial=="0"&&f.gas_inicial=="0"),t(3,k=!1)}catch(C){t(3,k=!1),console.error("Error fetching data:",C)}})}const K=p=>new Promise((z,C)=>{let j=new FormData;j.append("id_route",p.id_route),j.append("id_event",p.id_event),j=le(j),fetch(`${u}api/admin/evidence/evidence_by_event.php`,{method:"POST",body:j}).then(X=>X.json()).then(X=>{z(X.data.event_evidence[0])}).catch(X=>{console.error("Error fetching data:",X),C(X)})}),H=(p,z)=>{K(p).then(C=>{p.stopsApproval=F,p.smsActive=q,C&&(p.img=C.img,p.driver_comments=C.driver_comments,p.comments=C.comments),Ue("modal-delivery-info",At,{delivery:p,isLast:z}).then(j=>{}).finally(()=>{O(r)})})},M=(p,z)=>{var C=new Object;z?C={title:p.destination,line1:p.dest_address}:C={title:p.origin,line1:p.origin_address},C.client_name=p.client_name,C.client_phone=p.tel,C.id_route=p.id_route,C.stopsApproval=F,C.smsActive=q;var j=!0;Ue("modal-delivery-info",At,{delivery:C,isLast:z,flag:j})},U=(p,z,C)=>{var j=!1;return L||(L=!0,Ue("modal-checklist",$t,{checklist:p,driverId:z,routeId:C,isLast:j}).then(X=>{L=!1}),ee(C,"checklist")),""},x=p=>n(void 0,void 0,void 0,function*(){return yield O(p),I.length>0?Ue("modal-expense-detail",vo,{routeId:p,expenses:I}).then(z=>{}):Ue("modal-expense",_t,{routeId:p}).then(z=>{}),""}),oe=p=>{if(p.tracking_type=="subscription"){if(p.subscriber_info&&p.payment_type==="cash"&&new Date(p.subscriber_info.payment_next)<new Date)return!0}else if(p.tracking_type=="ecommerce"&&Number(p.payment_pending)>0)return!0;return!1};function ee(p,z){let C=new FormData;return C.append("id_route",p),C.append("status",z),C=le(C),fetch(`${u}api/admin/route/change_status.php`,{method:"POST",body:C}).then(j=>j.json()).then(j=>{}).catch(j=>{console.error("Error fetching data:",j)}),""}const fe=()=>{_.type=="super"||_.type=="admin"?je("/drivers/me"):_.id_driver&&je(`/drivers/${_.id_driver}`)},ae=(p,z)=>n(void 0,void 0,void 0,function*(){yield(yield qe.create({header:p||"Error",message:z||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()});function le(p){return p.append("token",_.token),p.append("id_user_over",_.id_user),p}const be=()=>n(void 0,void 0,void 0,function*(){if(_.id_enterprise){let p=new FormData;p.append("id_enterprise",_.id_enterprise),p=le(p);try{const z=yield fetch(`${u}api/admin/enterprise/enterprise_settings.php`,{method:"POST",body:p});z.ok?(S=(yield z.json()).nodos,F=ct("stops_wait_approval",S),q=ct("sms_active",S),t(10,R=ct("stops_order_restriction",S))):console.error("File upload failed:",z.statusText)}catch(z){console.error("Error during file upload:",z)}}}),Oe=()=>x(r),Ee=p=>B(p.detail.value);function me(p){Se[p?"unshift":"push"](()=>{T=p,t(8,T)})}const de=()=>{M(f,!1)},ue=p=>{const z=h.findIndex(N=>N.id_event===p.id_event),C=z===0,j=z>0?h[z-1]:null,X=C||j&&j.img!==null,Y=p.img!==null&&p.img!=="";X||C&&!Y||R=="1"?H(p,!1):ae("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")},Ne=()=>{M(f,!0)};function ve(p){Se[p?"unshift":"push"](()=>{T=p,t(8,T)})}const Ie=()=>{M(f,!1)},Ce=p=>{const z=h.findIndex(N=>N.id_event===p.id_event),C=z===0,j=z>0?h[z-1]:null,X=C||j&&j.img!==null,Y=p.img!==null&&p.img!=="";X||C&&!Y||R=="1"?H(p,!1):ae("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")},ge=()=>{M(f,!0)};function ce(p){Se[p?"unshift":"push"](()=>{T=p,t(8,T)})}const Z=()=>{M(f,!1)},te=p=>{const z=h.findIndex(N=>N.id_event===p.id_event),C=z===0,j=z>0?h[z-1]:null,X=C||j&&j.img!==null,Y=p.img!==null&&p.img!=="";X||C&&!Y||R=="1"?H(p,!1):ae("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")},Q=()=>{M(f,!0)};return l.$$set=p=>{"routeId"in p&&t(0,r=p.routeId),"driverId"in p&&t(1,d=p.driverId)},l.$$.update=()=>{l.$$.dirty[0]&1048581&&(t(0,{routeId:r,driverId:d}=i.params,r,(t(1,d),t(20,i),t(2,_),t(0,r))),t(2,_=JSON.parse(localStorage.getItem("userSession"))),_?_.id_user&&(_.type=="admin"||_.type=="super")?(O(r),je(`/drivers/me/routes/${r}`)):_.id_user&&_.id_driver&&(O(r),je(`/drivers/${_.id_driver}/routes/${r}`)):je("/"))},[r,d,_,k,E,h,f,v,T,V,R,P,B,H,M,U,x,oe,fe,ae,i,Oe,Ee,me,de,ue,Ne,ve,Ie,Ce,ge,ce,Z,te,Q]}class Ho extends Ye{constructor(e){super(),Qe(this,e,wo,To,Je,{routeId:0,driverId:1},null,[-1,-1])}}export{Ho as component};

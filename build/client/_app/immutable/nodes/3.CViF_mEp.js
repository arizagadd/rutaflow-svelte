import{s as oe,e as p,b as f,q as I,h as _,v as h,i as ae,x as R,n as X,z as ue,o as ce,A as Y,j as L,d as Z,m as A,f as de,w as c,G as x}from"../chunks/index.CdEBkEwf.js";import{S as re,i as ie,b as k,d as H,m as P,t as j,a as B,e as U,f as ee}from"../chunks/index.c2pjNB5R.js";import"../chunks/index-48209844.IIRtDZyg.js";import{I as me,D as pe,a as te}from"../chunks/IonPage.v1T0_FOl.js";import{a as fe}from"../chunks/authStore.Dl96eK1q.js";import{g as C}from"../chunks/entry.HFVLD9c0.js";function _e(r){let e,o,i;return{c(){e=p("ion-input"),this.h()},l(t){e=f(t,"ION-INPUT",{type:!0,name:!0,placeholder:!0,value:!0}),I(e).forEach(_),this.h()},h(){h(e,"type",r[2]),h(e,"name",r[1]),h(e,"placeholder",r[3]),h(e,"value",r[0])},m(t,n){ae(t,e,n),o||(i=[R(e,"ionBlur",r[5]),R(e,"ionChange",r[4])],o=!0)},p(t,[n]){n&4&&h(e,"type",t[2]),n&2&&h(e,"name",t[1]),n&8&&h(e,"placeholder",t[3]),n&1&&h(e,"value",t[0])},i:X,o:X,d(t){t&&_(e),o=!1,ue(i)}}}function he(r,e,o){let{name:i=""}=e,{type:t="text"}=e,{placeholder:n=""}=e,{value:l}=e;function g(a){o(0,l=a.target.value)}function v(){}return r.$$set=a=>{"name"in a&&o(1,i=a.name),"type"in a&&o(2,t=a.type),"placeholder"in a&&o(3,n=a.placeholder),"value"in a&&o(0,l=a.value)},[l,i,t,n,g,v]}class ne extends re{constructor(e){super(),ie(this,e,he,_e,oe,{name:1,type:2,placeholder:3,value:0})}}function ge(r){let e,o,i='<ion-col></ion-col> <ion-col class="w-80 text-center svelte-19nd3yu"><img src="/rutaflow.png" alt="Rutaflow" class="svelte-19nd3yu"/></ion-col> <ion-col></ion-col>',t,n,l,g,v,a,y,d,O,m,u,w,D,M,N,W='<ion-col class="signup-col"><ion-button class="submit-btn svelte-19nd3yu" color="#2c83d3" expand="block" type="submit">Ingresar</ion-button></ion-col>',T,q,F;function se(s){r[3](s)}let J={type:"text",placeholder:"Correo o Usuario",name:"email",required:!0};r[0].email!==void 0&&(J.value=r[0].email),d=new ne({props:J}),Y.push(()=>ee(d,"value",se));function le(s){r[4](s)}let z={type:"password",placeholder:"Contraseña",name:"password",required:!0};return r[0].password!==void 0&&(z.value=r[0].password),w=new ne({props:z}),Y.push(()=>ee(w,"value",le)),{c(){e=p("ion-content"),o=p("ion-row"),o.innerHTML=i,t=L(),n=p("div"),l=p("form"),g=p("ion-row"),v=p("ion-col"),a=p("ion-list"),y=p("ion-item"),k(d.$$.fragment),m=L(),u=p("ion-item"),k(w.$$.fragment),M=L(),N=p("ion-row"),N.innerHTML=W,this.h()},l(s){e=f(s,"ION-CONTENT",{class:!0,padding:!0});var b=I(e);o=f(b,"ION-ROW",{class:!0,"data-svelte-h":!0}),Z(o)!=="svelte-1mi73el"&&(o.innerHTML=i),t=A(b),n=f(b,"DIV",{class:!0});var E=I(n);l=f(E,"FORM",{});var S=I(l);g=f(S,"ION-ROW",{});var G=I(g);v=f(G,"ION-COL",{});var V=I(v);a=f(V,"ION-LIST",{});var $=I(a);y=f($,"ION-ITEM",{});var K=I(y);H(d.$$.fragment,K),K.forEach(_),m=A($),u=f($,"ION-ITEM",{});var Q=I(u);H(w.$$.fragment,Q),Q.forEach(_),$.forEach(_),V.forEach(_),G.forEach(_),M=A(S),N=f(S,"ION-ROW",{"data-svelte-h":!0}),Z(N)!=="svelte-19dro8s"&&(N.innerHTML=W),S.forEach(_),E.forEach(_),b.forEach(_),this.h()},h(){h(o,"class","logo-row svelte-19nd3yu"),de(n,"class","login-box svelte-19nd3yu"),h(e,"class","login-content"),h(e,"padding","")},m(s,b){ae(s,e,b),c(e,o),c(e,t),c(e,n),c(n,l),c(l,g),c(g,v),c(v,a),c(a,y),P(d,y,null),c(a,m),c(a,u),P(w,u,null),c(l,M),c(l,N),T=!0,q||(F=R(l,"submit",r[1]),q=!0)},p(s,b){const E={};!O&&b&1&&(O=!0,E.value=s[0].email,x(()=>O=!1)),d.$set(E);const S={};!D&&b&1&&(D=!0,S.value=s[0].password,x(()=>D=!1)),w.$set(S)},i(s){T||(j(d.$$.fragment,s),j(w.$$.fragment,s),T=!0)},o(s){B(d.$$.fragment,s),B(w.$$.fragment,s),T=!1},d(s){s&&_(e),U(d),U(w),q=!1,F()}}}function ve(r){let e,o;return e=new me({props:{$$slots:{default:[ge]},$$scope:{ctx:r}}}),{c(){k(e.$$.fragment)},l(i){H(e.$$.fragment,i)},m(i,t){P(e,i,t),o=!0},p(i,[t]){const n={};t&65&&(n.$$scope={dirty:t,ctx:i}),e.$set(n)},i(i){o||(j(e.$$.fragment,i),o=!0)},o(i){B(e.$$.fragment,i),o=!1},d(i){U(e,i)}}}function we(r,e,o){let i=pe,t={},n=new Object;ce(()=>{localStorage.clear(),console.log("Cleared all sessions from localStorage")});const l=a=>{a.preventDefault(),console.log("submit",t);const y=async()=>{await(await te.create({header:"Datos inválidos",message:"El correo o la contraseña son incorrectos, vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()},d=async()=>{await(await te.create({header:"Sin perfil de operador",message:"Su cuenta no cuenta con un perfil de operador creado",buttons:[{text:"Cerrar"}]})).present()},O=new FormData;return O.append("email",t.email),O.append("pass",t.password),fetch(`${i}api/admin/user/user_login.php`,{method:"POST",body:O}).then(m=>m.json()).then(m=>{if(m.nodos.length){const u=m.nodos[0];localStorage.setItem("userSession",JSON.stringify(u)),fe.set({resolved:!0,id:u.id_driver?u.id_driver:"me",user:{userData:u}}),console.log(u),u.id_driver?C(`/drivers/${u.id_driver}`):(C("/drivers/me"),d())}else y()}).catch(m=>{y()})};function g(a){r.$$.not_equal(t.email,a)&&(t.email=a,o(0,t))}function v(a){r.$$.not_equal(t.password,a)&&(t.password=a,o(0,t))}return r.$$.update=()=>{r.$$.dirty&4&&(o(2,n=JSON.parse(localStorage.getItem("userSession"))),n?n.id_user&&(n.type=="admin"||n.type=="super")?C("/drivers/me"):n.id_user&&n.id_driver&&C(`/drivers/${n.id_driver}`):C("/"))},[t,l,n,g,v]}class Ee extends re{constructor(e){super(),ie(this,e,we,ve,oe,{})}}export{Ee as component};

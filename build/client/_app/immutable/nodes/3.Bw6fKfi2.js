import{s as oe,e as f,b as m,q as I,h as _,v as h,i as ae,x as R,n as X,z as ue,o as ce,A as Y,j as L,d as Z,m as A,f as de,w as c,G as x}from"../chunks/index.CdEBkEwf.js";import{S as re,i as ie,b as k,d as H,m as P,t as j,a as B,e as W,f as ee}from"../chunks/index.c2pjNB5R.js";import"../chunks/index-48209844.IIRtDZyg.js";import{I as pe,D as fe,a as te}from"../chunks/IonPage.BZjjYPdk.js";import{a as me}from"../chunks/authStore.Dl96eK1q.js";import{g as T}from"../chunks/entry.C-XgvcNx.js";function _e(r){let e,o,i;return{c(){e=f("ion-input"),this.h()},l(t){e=m(t,"ION-INPUT",{type:!0,name:!0,placeholder:!0,value:!0}),I(e).forEach(_),this.h()},h(){h(e,"type",r[2]),h(e,"name",r[1]),h(e,"placeholder",r[3]),h(e,"value",r[0])},m(t,n){ae(t,e,n),o||(i=[R(e,"ionBlur",r[5]),R(e,"ionChange",r[4])],o=!0)},p(t,[n]){n&4&&h(e,"type",t[2]),n&2&&h(e,"name",t[1]),n&8&&h(e,"placeholder",t[3]),n&1&&h(e,"value",t[0])},i:X,o:X,d(t){t&&_(e),o=!1,ue(i)}}}function he(r,e,o){let{name:i=""}=e,{type:t="text"}=e,{placeholder:n=""}=e,{value:l}=e;function v(a){o(0,l=a.target.value)}function g(){}return r.$$set=a=>{"name"in a&&o(1,i=a.name),"type"in a&&o(2,t=a.type),"placeholder"in a&&o(3,n=a.placeholder),"value"in a&&o(0,l=a.value)},[l,i,t,n,v,g]}class ne extends re{constructor(e){super(),ie(this,e,he,_e,oe,{name:1,type:2,placeholder:3,value:0})}}function ve(r){let e,o,i='<ion-col></ion-col> <ion-col class="w-80 text-center svelte-19nd3yu"><img src="/rutaflow.png" alt="Rutaflow" class="svelte-19nd3yu"/></ion-col> <ion-col></ion-col>',t,n,l,v,g,a,y,d,O,p,u,w,D,M,N,F='<ion-col class="signup-col"><ion-button class="submit-btn svelte-19nd3yu" color="#2c83d3" expand="block" type="submit">Ingresar</ion-button></ion-col>',C,q,J;function se(s){r[3](s)}let U={type:"text",placeholder:"Correo o Teléfono",name:"email",required:!0};r[0].email!==void 0&&(U.value=r[0].email),d=new ne({props:U}),Y.push(()=>ee(d,"value",se));function le(s){r[4](s)}let z={type:"password",placeholder:"Contraseña",name:"password",required:!0};return r[0].password!==void 0&&(z.value=r[0].password),w=new ne({props:z}),Y.push(()=>ee(w,"value",le)),{c(){e=f("ion-content"),o=f("ion-row"),o.innerHTML=i,t=L(),n=f("div"),l=f("form"),v=f("ion-row"),g=f("ion-col"),a=f("ion-list"),y=f("ion-item"),k(d.$$.fragment),p=L(),u=f("ion-item"),k(w.$$.fragment),M=L(),N=f("ion-row"),N.innerHTML=F,this.h()},l(s){e=m(s,"ION-CONTENT",{class:!0,padding:!0});var b=I(e);o=m(b,"ION-ROW",{class:!0,"data-svelte-h":!0}),Z(o)!=="svelte-1mi73el"&&(o.innerHTML=i),t=A(b),n=m(b,"DIV",{class:!0});var E=I(n);l=m(E,"FORM",{});var S=I(l);v=m(S,"ION-ROW",{});var G=I(v);g=m(G,"ION-COL",{});var V=I(g);a=m(V,"ION-LIST",{});var $=I(a);y=m($,"ION-ITEM",{});var K=I(y);H(d.$$.fragment,K),K.forEach(_),p=A($),u=m($,"ION-ITEM",{});var Q=I(u);H(w.$$.fragment,Q),Q.forEach(_),$.forEach(_),V.forEach(_),G.forEach(_),M=A(S),N=m(S,"ION-ROW",{"data-svelte-h":!0}),Z(N)!=="svelte-19dro8s"&&(N.innerHTML=F),S.forEach(_),E.forEach(_),b.forEach(_),this.h()},h(){h(o,"class","logo-row svelte-19nd3yu"),de(n,"class","login-box svelte-19nd3yu"),h(e,"class","login-content"),h(e,"padding","")},m(s,b){ae(s,e,b),c(e,o),c(e,t),c(e,n),c(n,l),c(l,v),c(v,g),c(g,a),c(a,y),P(d,y,null),c(a,p),c(a,u),P(w,u,null),c(l,M),c(l,N),C=!0,q||(J=R(l,"submit",r[1]),q=!0)},p(s,b){const E={};!O&&b&1&&(O=!0,E.value=s[0].email,x(()=>O=!1)),d.$set(E);const S={};!D&&b&1&&(D=!0,S.value=s[0].password,x(()=>D=!1)),w.$set(S)},i(s){C||(j(d.$$.fragment,s),j(w.$$.fragment,s),C=!0)},o(s){B(d.$$.fragment,s),B(w.$$.fragment,s),C=!1},d(s){s&&_(e),W(d),W(w),q=!1,J()}}}function ge(r){let e,o;return e=new pe({props:{$$slots:{default:[ve]},$$scope:{ctx:r}}}),{c(){k(e.$$.fragment)},l(i){H(e.$$.fragment,i)},m(i,t){P(e,i,t),o=!0},p(i,[t]){const n={};t&65&&(n.$$scope={dirty:t,ctx:i}),e.$set(n)},i(i){o||(j(e.$$.fragment,i),o=!0)},o(i){B(e.$$.fragment,i),o=!1},d(i){W(e,i)}}}function we(r,e,o){let i=fe,t={},n=new Object;ce(()=>{localStorage.clear()});const l=a=>{a.preventDefault();const y=async()=>{await(await te.create({header:"Datos inválidos",message:"El correo/teléfono o la contraseña son incorrectos, vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()},d=async()=>{await(await te.create({header:"Sin perfil de operador",message:"Su cuenta no cuenta con un perfil de operador creado",buttons:[{text:"Cerrar"}]})).present()},O=new FormData;return O.append("email",t.email),O.append("pass",t.password),fetch(`${i}api/admin/user/user_login.php`,{method:"POST",body:O}).then(p=>p.json()).then(p=>{if(p.nodos.length){const u=p.nodos[0];localStorage.setItem("userSession",JSON.stringify(u)),me.set({resolved:!0,id:u.id_driver?u.id_driver:"me",user:{userData:u}}),u.id_driver?T(`/drivers/${u.id_driver}`):(T("/drivers/me"),d())}else y()}).catch(p=>{y()})};function v(a){r.$$.not_equal(t.email,a)&&(t.email=a,o(0,t))}function g(a){r.$$.not_equal(t.password,a)&&(t.password=a,o(0,t))}return r.$$.update=()=>{r.$$.dirty&4&&(o(2,n=JSON.parse(localStorage.getItem("userSession"))),n?n.id_user&&(n.type=="admin"||n.type=="super")?T("/drivers/me"):n.id_user&&n.id_driver&&T(`/drivers/${n.id_driver}`):T("/"))},[t,l,n,v,g]}class Ee extends re{constructor(e){super(),ie(this,e,we,ge,oe,{})}}export{Ee as component};

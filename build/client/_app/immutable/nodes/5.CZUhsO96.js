import{s as je,n as se,r as Ve,b as bt,l as ot,d as Te,w as Nt,o as wt}from"../chunks/index.CP94t5tW.js";import{S as Xe,i as We,e as u,s as A,q as W,c as f,r as E,g as J,f as s,k as D,u as G,v as N,b as U,A as V,d as R,w as i,x as Z,h as oe,F as Tt,G as Ct,y as ie,H as yt,j as Lt,t as Ae,a as Fe,l as At,m as Dt,n as St,o as Ht,p as Mt,z as Bt}from"../chunks/index.BB8175xn.js";import{a as Pt,c as Rt,b as qt,p as gt,i as Et,f as Ut,g as Ft,s as Ge,h as Ne,e as pe,u as De,d as Se,j as zt}from"../chunks/index.DDw-d3HU.js";import{g as Ie}from"../chunks/entry.BHCvmyTg.js";import{a as It,m as jt,I as Vt}from"../chunks/IonPage.bGG8reFV.js";import"../chunks/index-48209844.IIRtDZyg.js";import{q as Xt,t as Wt}from"../chunks/ion-modal.CsJaVgKZ.js";function Gt(r){let e,t,o,n,l,d="Domicilio 2",m,b,k=r[2].line2+"",g,p,a;return{c(){e=u("ion-item"),t=u("ion-icon"),o=A(),n=u("ion-label"),l=u("p"),l.textContent=d,m=A(),b=u("h2"),g=W(k),p=A(),a=u("ion-icon"),this.h()},l(h){e=f(h,"ION-ITEM",{href:!0});var I=E(e);t=f(I,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(s),o=D(I),n=f(I,"ION-LABEL",{class:!0});var c=E(n);l=f(c,"P",{"data-svelte-h":!0}),J(l)!=="svelte-1qy148r"&&(l.textContent=d),m=D(c),b=f(c,"H2",{});var _=E(b);g=G(_,k),_.forEach(s),c.forEach(s),p=D(I),a=f(I,"ION-ICON",{icon:!0,slot:!0}),E(a).forEach(s),I.forEach(s),this.h()},h(){N(t,"icon",Ge),N(t,"slot","start"),N(n,"class","ion-text-wrap"),N(a,"icon",Ne),N(a,"slot","end"),N(e,"href","https://www.google.com/maps/searhc/?api=1&query="+r[2].line2)},m(h,I){R(h,e,I),i(e,t),i(e,o),i(e,n),i(n,l),i(n,m),i(n,b),i(b,g),i(e,p),i(e,a)},p:se,d(h){h&&s(e)}}}function Jt(r){let e,t,o,n,l,d="Domicilio 1",m,b,k=r[2].line1+"",g,p,a,h,I=r[2].line2&&r[2].line2.trim().length,c,_=I&&Kt(r);return{c(){e=u("ion-item"),t=u("ion-icon"),o=A(),n=u("ion-label"),l=u("p"),l.textContent=d,m=A(),b=u("h2"),g=W(k),p=A(),a=u("ion-icon"),h=A(),_&&_.c(),c=oe(),this.h()},l(T){e=f(T,"ION-ITEM",{href:!0});var y=E(e);t=f(y,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(s),o=D(y),n=f(y,"ION-LABEL",{class:!0});var q=E(n);l=f(q,"P",{"data-svelte-h":!0}),J(l)!=="svelte-1ehcrdm"&&(l.textContent=d),m=D(q),b=f(q,"H2",{});var P=E(b);g=G(P,k),P.forEach(s),q.forEach(s),p=D(y),a=f(y,"ION-ICON",{icon:!0,slot:!0}),E(a).forEach(s),y.forEach(s),h=D(T),_&&_.l(T),c=oe(),this.h()},h(){N(t,"icon",Ge),N(t,"slot","start"),N(n,"class","ion-text-wrap"),N(a,"icon",Ne),N(a,"slot","end"),N(e,"href","https://www.google.com/maps/search/?api=1&query="+r[2].line1)},m(T,y){R(T,e,y),i(e,t),i(e,o),i(e,n),i(n,l),i(n,m),i(n,b),i(b,g),i(e,p),i(e,a),R(T,h,y),_&&_.m(T,y),R(T,c,y)},p(T,y){I&&_.p(T,y)},d(T){T&&(s(e),s(h),s(c)),_&&_.d(T)}}}function Kt(r){let e,t,o,n,l,d="Domicilio 2",m,b,k=r[2].line2+"",g,p,a;return{c(){e=u("ion-item"),t=u("ion-icon"),o=A(),n=u("ion-label"),l=u("p"),l.textContent=d,m=A(),b=u("h2"),g=W(k),p=A(),a=u("ion-icon"),this.h()},l(h){e=f(h,"ION-ITEM",{href:!0});var I=E(e);t=f(I,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(s),o=D(I),n=f(I,"ION-LABEL",{class:!0});var c=E(n);l=f(c,"P",{"data-svelte-h":!0}),J(l)!=="svelte-1qy148r"&&(l.textContent=d),m=D(c),b=f(c,"H2",{});var _=E(b);g=G(_,k),_.forEach(s),c.forEach(s),p=D(I),a=f(I,"ION-ICON",{icon:!0,slot:!0}),E(a).forEach(s),I.forEach(s),this.h()},h(){N(t,"icon",Ge),N(t,"slot","start"),N(n,"class","ion-text-wrap"),N(a,"icon",Ne),N(a,"slot","end"),N(e,"href","https://www.google.com/maps/search/?api=1&query="+r[2].line2)},m(h,I){R(h,e,I),i(e,t),i(e,o),i(e,n),i(n,l),i(n,m),i(n,b),i(b,g),i(e,p),i(e,a)},p:se,d(h){h&&s(e)}}}function Qt(r){let e,t=r[2].comments!="<br>"&&Yt(r);return{c(){t&&t.c(),e=oe()},l(o){t&&t.l(o),e=oe()},m(o,n){t&&t.m(o,n),R(o,e,n)},p(o,n){o[2].comments!="<br>"&&t.p(o,n)},d(o){o&&s(e),t&&t.d(o)}}}function Yt(r){let e,t,o,n,l,d="Notas de ubicación",m,b,k=r[2].comments+"",g;return{c(){e=u("ion-item"),t=u("ion-icon"),o=A(),n=u("ion-label"),l=u("p"),l.textContent=d,m=A(),b=u("h2"),g=W(k),this.h()},l(p){e=f(p,"ION-ITEM",{});var a=E(e);t=f(a,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(s),o=D(a),n=f(a,"ION-LABEL",{class:!0});var h=E(n);l=f(h,"P",{"data-svelte-h":!0}),J(l)!=="svelte-nhm2ft"&&(l.textContent=d),m=D(h),b=f(h,"H2",{});var I=E(b);g=G(I,k),I.forEach(s),h.forEach(s),a.forEach(s),this.h()},h(){N(t,"icon",Et),N(t,"slot","start"),N(n,"class","ion-text-wrap")},m(p,a){R(p,e,a),i(e,t),i(e,o),i(e,n),i(n,l),i(n,m),i(n,b),i(b,g)},p:se,d(p){p&&s(e)}}}function Zt(r){let e,t,o,n,l,d="Horarios",m,b,k=r[2].schedule+"",g;return{c(){e=u("ion-item"),t=u("ion-icon"),o=A(),n=u("ion-label"),l=u("p"),l.textContent=d,m=A(),b=u("h2"),g=W(k),this.h()},l(p){e=f(p,"ION-ITEM",{});var a=E(e);t=f(a,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(s),o=D(a),n=f(a,"ION-LABEL",{});var h=E(n);l=f(h,"P",{"data-svelte-h":!0}),J(l)!=="svelte-11q7hm5"&&(l.textContent=d),m=D(h),b=f(h,"H2",{});var I=E(b);g=G(I,k),I.forEach(s),h.forEach(s),a.forEach(s),this.h()},h(){N(t,"icon",Ut),N(t,"slot","start")},m(p,a){R(p,e,a),i(e,t),i(e,o),i(e,n),i(n,l),i(n,m),i(n,b),i(b,g)},p:se,d(p){p&&s(e)}}}function $t(r){let e,t,o,n,l,d="Notas del operador",m,b,k=r[2].driver_comments+"",g;return{c(){e=u("ion-item"),t=u("ion-icon"),o=A(),n=u("ion-label"),l=u("p"),l.textContent=d,m=A(),b=u("h2"),g=W(k),this.h()},l(p){e=f(p,"ION-ITEM",{});var a=E(e);t=f(a,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(s),o=D(a),n=f(a,"ION-LABEL",{});var h=E(n);l=f(h,"P",{"data-svelte-h":!0}),J(l)!=="svelte-1yk9qp4"&&(l.textContent=d),m=D(h),b=f(h,"H2",{});var I=E(b);g=G(I,k),I.forEach(s),h.forEach(s),a.forEach(s),this.h()},h(){N(t,"icon",Ft),N(t,"slot","start")},m(p,a){R(p,e,a),i(e,t),i(e,o),i(e,n),i(n,l),i(n,m),i(n,b),i(b,g)},p:se,d(p){p&&s(e)}}}function xt(r){let e,t=r[2].logistic_comments!="<br>"&&en(r);return{c(){t&&t.c(),e=oe()},l(o){t&&t.l(o),e=oe()},m(o,n){t&&t.m(o,n),R(o,e,n)},p(o,n){o[2].logistic_comments!="<br>"&&t.p(o,n)},d(o){o&&s(e),t&&t.d(o)}}}function en(r){let e,t,o,n,l,d="Comentarios logísticos",m,b,k=r[2].logistic_comments+"",g;return{c(){e=u("ion-item"),t=u("ion-icon"),o=A(),n=u("ion-label"),l=u("p"),l.textContent=d,m=A(),b=u("h2"),g=W(k),this.h()},l(p){e=f(p,"ION-ITEM",{});var a=E(e);t=f(a,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(s),o=D(a),n=f(a,"ION-LABEL",{class:!0});var h=E(n);l=f(h,"P",{"data-svelte-h":!0}),J(l)!=="svelte-1iz85r6"&&(l.textContent=d),m=D(h),b=f(h,"H2",{});var I=E(b);g=G(I,k),I.forEach(s),h.forEach(s),a.forEach(s),this.h()},h(){N(t,"icon",Et),N(t,"slot","start"),N(n,"class","ion-text-wrap")},m(p,a){R(p,e,a),i(e,t),i(e,o),i(e,n),i(n,l),i(n,m),i(n,b),i(b,g)},p:se,d(p){p&&s(e)}}}function it(r){let e,t,o;return{c(){e=u("section"),t=u("ion-img"),this.h()},l(n){e=f(n,"SECTION",{});var l=E(e);t=f(l,"ION-IMG",{src:!0,alt:!0,style:!0}),E(t).forEach(s),l.forEach(s),this.h()},h(){ot(t.src,o=r[1])||N(t,"src",o),N(t,"alt","Evidencia fotográfica"),V(t,"max-width","100%"),V(t,"margin-top","16px")},m(n,l){R(n,e,l),i(e,t)},p(n,l){l&2&&!ot(t.src,o=n[1])&&N(t,"src",o)},d(n){n&&s(e)}}}function tn(r){let e,t,o,n,l="Cancelar",d,m,b=r[2].title+"",k,g,p,a,h="Confirmar",I,c,_,T,y,q,P,M,v="Cliente",L,H,C=r[2].client_name+"",O,S,w,B=r[2].comments&&r[2].comments.trim().length,F,z=r[2].schedule&&r[2].schedule.trim().length,j,te,$=r[2].logistic_comments&&r[2].logistic_comments.trim().length,me,Y,le,He,ve,Me,we,he,ne,be,Be,de,Je="Subir Evidencia",Pe,ae,Re,qe,Ke;function Ot(X,x){if(X[2].line1&&X[2].line1.trim().length)return Jt;if(X[2].line2&&X[2].line2.trim().length)return Gt}let Qe=Ot(r),re=Qe&&Qe(r),ce=B&&Qt(r),ue=z&&Zt(r),fe=r[2].driver_comments&&$t(r),_e=$&&xt(r),Q=r[1]&&it(r);return{c(){e=u("ion-header"),t=u("ion-toolbar"),o=u("ion-buttons"),n=u("ion-button"),n.textContent=l,d=A(),m=u("ion-title"),k=W(b),g=A(),p=u("ion-buttons"),a=u("ion-button"),a.textContent=h,I=A(),c=u("ion-content"),_=u("ion-list"),T=u("ion-item"),y=u("ion-icon"),q=A(),P=u("ion-label"),M=u("p"),M.textContent=v,L=A(),H=u("h2"),O=W(C),S=A(),re&&re.c(),w=A(),ce&&ce.c(),F=A(),ue&&ue.c(),j=A(),fe&&fe.c(),te=A(),_e&&_e.c(),me=A(),Y=u("ion-item"),le=u("ion-icon"),He=A(),ve=u("ion-textarea"),Me=A(),we=u("section"),he=u("label"),ne=u("ion-button"),be=u("ion-icon"),Be=A(),de=u("label"),de.textContent=Je,Pe=A(),ae=u("input"),Re=A(),Q&&Q.c(),this.h()},l(X){e=f(X,"ION-HEADER",{translucent:!0});var x=E(e);t=f(x,"ION-TOOLBAR",{});var ge=E(t);o=f(ge,"ION-BUTTONS",{slot:!0});var Ye=E(o);n=f(Ye,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),J(n)!=="svelte-1dnmkxs"&&(n.textContent=l),Ye.forEach(s),d=D(ge),m=f(ge,"ION-TITLE",{title:!0});var Ze=E(m);k=G(Ze,b),Ze.forEach(s),g=D(ge),p=f(ge,"ION-BUTTONS",{slot:!0});var $e=E(p);a=f($e,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),J(a)!=="svelte-1ida0il"&&(a.textContent=h),$e.forEach(s),ge.forEach(s),x.forEach(s),I=D(X),c=f(X,"ION-CONTENT",{fullscreen:!0});var xe=E(c);_=f(xe,"ION-LIST",{});var K=E(_);T=f(K,"ION-ITEM",{});var Ce=E(T);y=f(Ce,"ION-ICON",{icon:!0,slot:!0}),E(y).forEach(s),q=D(Ce),P=f(Ce,"ION-LABEL",{});var ye=E(P);M=f(ye,"P",{"data-svelte-h":!0}),J(M)!=="svelte-jrq7ei"&&(M.textContent=v),L=D(ye),H=f(ye,"H2",{});var et=E(H);O=G(et,C),et.forEach(s),ye.forEach(s),Ce.forEach(s),S=D(K),re&&re.l(K),w=D(K),ce&&ce.l(K),F=D(K),ue&&ue.l(K),j=D(K),fe&&fe.l(K),te=D(K),_e&&_e.l(K),me=D(K),Y=f(K,"ION-ITEM",{});var Le=E(Y);le=f(Le,"ION-ICON",{icon:!0,slot:!0}),E(le).forEach(s),He=D(Le),ve=f(Le,"ION-TEXTAREA",{label:!0,placeholder:!0}),E(ve).forEach(s),Le.forEach(s),Me=D(K),we=f(K,"SECTION",{});var tt=E(we);he=f(tt,"LABEL",{for:!0,style:!0});var nt=E(he);ne=f(nt,"ION-BUTTON",{fill:!0,class:!0,expand:!0});var Ee=E(ne);be=f(Ee,"ION-ICON",{icon:!0,slot:!0}),E(be).forEach(s),Be=D(Ee),de=f(Ee,"LABEL",{for:!0,style:!0,"data-svelte-h":!0}),J(de)!=="svelte-1as0od8"&&(de.textContent=Je),Pe=D(Ee),ae=f(Ee,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0}),Ee.forEach(s),nt.forEach(s),tt.forEach(s),Re=D(K),Q&&Q.l(K),K.forEach(s),xe.forEach(s),this.h()},h(){N(n,"color","medium"),N(o,"slot","start"),N(m,"title",r[2].title),N(a,"strong",""),N(p,"slot","end"),N(e,"translucent",""),N(y,"icon",Pt),N(y,"slot","start"),N(le,"icon",Rt),N(le,"slot","start"),N(ve,"label","Notas"),N(ve,"placeholder","Escribe aquí..."),N(be,"icon",qt),N(be,"slot","start"),U(de,"for","eventEvidence"),V(de,"padding","8px 10px"),V(ae,"display","none"),U(ae,"id","eventEvidence"),U(ae,"name","fileToUpload"),U(ae,"type","file"),U(ae,"accept","image/*"),N(ne,"fill","outline"),N(ne,"class","loadEvidence"),N(ne,"expand","block"),U(he,"for","eventEvidence"),V(he,"display","block"),V(he,"width","100%"),N(c,"fullscreen","")},m(X,x){R(X,e,x),i(e,t),i(t,o),i(o,n),i(t,d),i(t,m),i(m,k),i(t,g),i(t,p),i(p,a),R(X,I,x),R(X,c,x),i(c,_),i(_,T),i(T,y),i(T,q),i(T,P),i(P,M),i(P,L),i(P,H),i(H,O),i(_,S),re&&re.m(_,null),i(_,w),ce&&ce.m(_,null),i(_,F),ue&&ue.m(_,null),i(_,j),fe&&fe.m(_,null),i(_,te),_e&&_e.m(_,null),i(_,me),i(_,Y),i(Y,le),i(Y,He),i(Y,ve),r[7](ve),i(_,Me),i(_,we),i(we,he),i(he,ne),i(ne,be),i(ne,Be),i(ne,de),i(ne,Pe),i(ne,ae),i(_,Re),Q&&Q.m(_,null),qe||(Ke=[Z(n,"click",r[4]),Z(a,"click",r[5]),Z(ae,"change",r[3])],qe=!0)},p(X,[x]){re&&re.p(X,x),B&&ce.p(X,x),z&&ue.p(X,x),X[2].driver_comments&&fe.p(X,x),$&&_e.p(X,x),X[1]?Q?Q.p(X,x):(Q=it(X),Q.c(),Q.m(_,null)):Q&&(Q.d(1),Q=null)},i:se,o:se,d(X){X&&(s(e),s(I),s(c)),re&&re.d(),ce&&ce.d(),ue&&ue.d(),fe&&fe.d(),_e&&_e.d(),r[7](null),Q&&Q.d(),qe=!1,Ve(Ke)}}}function nn(r,e,t){let o;bt(r,gt,h=>t(6,o=h));let n=document.querySelector("ion-modal"),l=n.componentProps.delivery,d=l.driver_comments?l.driver_comments:"",m=l.img?l.img:"",b="";const k=async h=>{const c=h.target.files[0];if(c){const _=new FormData;_.append("fileToUpload",c);try{const T=await fetch("https://rutaflow-app-development.up.railway.app/api/admin/manager/upload_img_driver.php",{method:"POST",body:_});if(T.ok){const y=await T.json();t(1,m=y.img),b=y.img_id,console.log(y)}else console.error("File upload failed:",T.statusText)}catch(T){console.error("Error during file upload:",T)}}},g=()=>{n.dismiss({data:Date.now()})},p=()=>{var h=new Object;h.id_route=l.id_route,h.id_event=l.id_event,h.comments=d.value,h.img=m,h.img_id=b;const I=new FormData;for(const c in h)I.append(c,h[c]);fetch("https://rutaflow-app-development.up.railway.app/api/admin/evidence/send_evidence.php",{method:"POST",body:I}).then(c=>c.json()).then(c=>{g()}).catch(c=>{console.error("Error fetching data:",c)})};function a(h){Te[h?"unshift":"push"](()=>{d=h,t(0,d)})}return r.$$.update=()=>{r.$$.dirty&64&&o.params},[d,m,l,k,g,p,o,a]}class on extends Xe{constructor(e){super(),We(this,e,nn,tn,je,{})}}const Ue=Nt({items:[],checkedIndices:[]});function lt(r,e,t){const o=r.slice();return o[19]=e[t],o}function rt(r,e){let t,o,n,l,d,m=e[19].item+"",b,k,g,p,a=(e[2][e[19].id_checklist_event]?e[2][e[19].id_checklist_event]:"Cargar evidencia")+"",h,I,c,_,T,y,q;function P(){return e[10](e[19])}function M(...v){return e[12](e[19],...v)}return T=Tt(e[9][0]),{key:r,first:null,c(){t=u("ion-item"),o=u("ion-label"),n=u("input"),l=A(),d=u("p"),b=W(m),k=A(),g=u("ion-button"),p=u("label"),h=W(a),I=A(),c=u("input"),_=A(),this.h()},l(v){t=f(v,"ION-ITEM",{});var L=E(t);o=f(L,"ION-LABEL",{style:!0});var H=E(o);n=f(H,"INPUT",{id:!0,style:!0,type:!0}),l=D(H),d=f(H,"P",{style:!0});var C=E(d);b=G(C,m),C.forEach(s),H.forEach(s),k=D(L),g=f(L,"ION-BUTTON",{fill:!0,class:!0});var O=E(g);p=f(O,"LABEL",{for:!0,style:!0});var S=E(p);h=G(S,a),S.forEach(s),I=D(O),c=f(O,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0}),O.forEach(s),_=D(L),L.forEach(s),this.h()},h(){U(n,"id",`chkbox-${e[19].id_checklist_event}`),V(n,"pointer-events","auto"),U(n,"type","checkbox"),n.__value=e[19].id_checklist_event,Ct(n,n.__value),n.required=!0,V(d,"margin-left","10px"),V(o,"display","flex"),U(p,"for","chklist-"+e[19].id_checklist_event),V(p,"padding","8px 10px"),V(c,"display","none"),U(c,"id","chklist-"+e[19].id_checklist_event),U(c,"name","fileToUpload"),U(c,"type","file"),U(c,"accept","image/*"),N(g,"fill","outline"),N(g,"class","loadEvidence svelte-4jkdim"),T.p(n),this.first=t},m(v,L){R(v,t,L),i(t,o),i(o,n),n.checked=~(e[0]||[]).indexOf(n.__value),i(o,l),i(o,d),i(d,b),i(t,k),i(t,g),i(g,p),i(p,h),i(g,I),i(g,c),e[11](c),i(t,_),y||(q=[Z(n,"change",e[8]),Z(n,"change",P),Z(c,"change",M)],y=!0)},p(v,L){e=v,L&1&&(n.checked=~(e[0]||[]).indexOf(n.__value)),L&4&&a!==(a=(e[2][e[19].id_checklist_event]?e[2][e[19].id_checklist_event]:"Cargar evidencia")+"")&&ie(h,a)},d(v){v&&s(t),e[11](null),T.r(),y=!1,Ve(q)}}}function ln(r){let e,t,o,n,l="Cancelar",d,m,b="Requerimientos de ruta",k,g,p,a="Confirmar",h,I,c,_=[],T=new Map,y,q,P=pe(r[3]);const M=v=>v[19].id_checklist_event;for(let v=0;v<P.length;v+=1){let L=lt(r,P,v),H=M(L);T.set(H,_[v]=rt(H,L))}return{c(){e=u("ion-header"),t=u("ion-toolbar"),o=u("ion-buttons"),n=u("ion-button"),n.textContent=l,d=A(),m=u("ion-title"),m.textContent=b,k=A(),g=u("ion-buttons"),p=u("ion-button"),p.textContent=a,h=A(),I=u("ion-content"),c=u("ion-list");for(let v=0;v<_.length;v+=1)_[v].c();this.h()},l(v){e=f(v,"ION-HEADER",{translucent:!0});var L=E(e);t=f(L,"ION-TOOLBAR",{});var H=E(t);o=f(H,"ION-BUTTONS",{slot:!0});var C=E(o);n=f(C,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),J(n)!=="svelte-1dnmkxs"&&(n.textContent=l),C.forEach(s),d=D(H),m=f(H,"ION-TITLE",{"data-svelte-h":!0}),J(m)!=="svelte-ucox25"&&(m.textContent=b),k=D(H),g=f(H,"ION-BUTTONS",{slot:!0});var O=E(g);p=f(O,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),J(p)!=="svelte-1ida0il"&&(p.textContent=a),O.forEach(s),H.forEach(s),L.forEach(s),h=D(v),I=f(v,"ION-CONTENT",{fullscreen:!0});var S=E(I);c=f(S,"ION-LIST",{});var w=E(c);for(let B=0;B<_.length;B+=1)_[B].l(w);w.forEach(s),S.forEach(s),this.h()},h(){N(n,"color","medium"),N(o,"slot","start"),N(p,"strong",""),N(g,"slot","end"),N(e,"translucent",""),N(I,"fullscreen","")},m(v,L){R(v,e,L),i(e,t),i(t,o),i(o,n),i(t,d),i(t,m),i(t,k),i(t,g),i(g,p),R(v,h,L),R(v,I,L),i(I,c);for(let H=0;H<_.length;H+=1)_[H]&&_[H].m(c,null);y||(q=[Z(n,"click",r[4]),Z(p,"click",r[5])],y=!0)},p(v,[L]){L&207&&(P=pe(v[3]),_=De(_,L,M,1,v,P,T,c,Se,rt,null,lt))},i:se,o:se,d(v){v&&(s(e),s(h),s(I));for(let L=0;L<_.length;L+=1)_[L].d();y=!1,Ve(q)}}}function kt(r){return typeof r=="object"&&r!==null||Array.isArray(r)?Array.isArray(r)?r.map(e=>kt(e)).flat():Object.keys(r).filter(n=>n.toLowerCase().includes("id_checklist_event")).map(n=>r[n]):(console.error("Invalid input. Please provide a valid object or array."),[])}function rn(r,e){let t=new FormData;t.append("id_route",r),t.append("status",e),fetch("https://rutaflow-app-development.up.railway.app/api/admin/route/change_status.php",{method:"POST",body:t}).then(o=>o.json()).then(o=>{}).catch(o=>{console.error("Error fetching data:",o)})}function sn(r,e,t){let o=document.querySelector("ion-modal");const n=o.componentProps.checklist,l=o.componentProps.driverId,d=o.componentProps.routeId;let m=[],b=null,k={},g={};wt(()=>{Ue.update(v=>(v.items=kt(n),v))});const p=async()=>{await(await It.create({header:"Datos o checklist incompletos",message:"Carga la evidencia requerida y marca todas las casillas para confirmar",buttons:[{text:"Cerrar"}]})).present()},a=()=>{o.dismiss({data:Date.now()}),Ie(`/drivers/${l}`)},h=()=>{Ue.update(v=>{if(v.items.every(C=>v.checkedIndices.includes(C))){a();const C=new FormData;for(const O in k)if(k.hasOwnProperty(O)){const{img:S,img_id:w}=k[O];C.append(`selectedImages[${O}][img]`,S),C.append(`selectedImages[${O}][img_id]`,w)}fetch("https://rutaflow-app-development.up.railway.app/api/admin/checklist/add_evidence.php",{method:"POST",body:C}).then(O=>O.json()).then(O=>{rn(d,"enroute")}).catch(O=>{console.error("Error fetching data:",O)})}else p();return v})},I=async(v,L)=>{const C=v.target.files[0],O=await c(C);if(O){const S=new FormData;S.append("fileToUpload",O);try{const w=await fetch("https://rutaflow-app-development.up.railway.app/api/admin/manager/upload_img_driver.php",{method:"POST",body:S});if(w.ok){const B=await w.json();k={...k,[L]:{img:B.img,img_id:B.img_id}},t(2,g={...g,[L]:B.filename}),console.log(k)}else console.error("File upload failed:",w.statusText)}catch(w){console.error("Error during file upload:",w)}}},c=async v=>new Promise(L=>{const H=new FileReader;H.onload=C=>{const O=new Image;O.src=C.target.result,O.onload=()=>{const S=document.createElement("canvas"),w=S.getContext("2d"),B=800,F=600;let z=O.width,j=O.height;z>B&&(j*=B/z,z=B),j>F&&(z*=F/j,j=F),S.width=z,S.height=j,w.drawImage(O,0,0,z,j),S.toBlob(te=>{L(te)},"image/jpeg",.7)}},H.readAsDataURL(v)}),_=v=>{Ue.update(L=>(L.checkedIndices.indexOf(v)===-1?L.checkedIndices.push(v):console.error(`ID ${v} is already checked.`),L.items.forEach(C=>{C.id_checklist_event===v&&(C.checked=!0)}),L))},T=[[]];function y(){m=yt(T[0],this.__value,this.checked),t(0,m)}const q=v=>_(v.id_checklist_event);function P(v){Te[v?"unshift":"push"](()=>{b=v,t(1,b)})}return[m,b,g,n,a,h,I,_,y,T,q,P,(v,L)=>I(L,v.id_checklist_event)]}class an extends Xe{constructor(e){super(),We(this,e,sn,ln,je,{})}}const cn=(r,e)=>{if(!customElements.get(r)){class t extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const n={};for(const l of this.attributes)n[l.name]=l.value;new e({target:this.shadowRoot,props:n})}}customElements.define(r,t)}},un=function(r){return document.createElement(r).constructor!==HTMLElement},fn=(r,e)=>{un(r)||cn(r,e)},st=async(r,e,t)=>{Xt(),Wt(),fn(r,e);const o=await jt.create({component:r,componentProps:t});return o.present(),await o.onWillDismiss()};function at(r,e,t){const o=r.slice();return o[25]=e[t],o}function ct(r,e,t){const o=r.slice();return o[25]=e[t],o}function ut(r,e,t){const o=r.slice();return o[25]=e[t],o}function ft(r){let e,t;return e=new Vt({props:{$$slots:{default:[mn]},$$scope:{ctx:r}}}),{c(){Dt(e.$$.fragment)},l(o){St(e.$$.fragment,o)},m(o,n){Ht(e,o,n),t=!0},p(o,n){const l={};n[0]&127|n[1]&2&&(l.$$scope={dirty:n,ctx:o}),e.$set(l)},i(o){t||(Ae(e.$$.fragment,o),t=!0)},o(o){Fe(e.$$.fragment,o),t=!1},d(o){Mt(e,o)}}}function _n(r){let e=ze(r[0],"enroute")+"",t,o,n,l,d='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Jala para actualizar" refreshing-spinner="circles" refreshing-text="Actualizando..."></ion-refresher-content>',m,b,k=[],g=new Map,p,a,h=pe(r[3]);const I=c=>c[25].id_event;for(let c=0;c<h.length;c+=1){let _=at(r,h,c),T=I(_);g.set(T,k[c]=ht(T,_))}return{c(){t=W(e),o=A(),n=u("ion-content"),l=u("ion-refresher"),l.innerHTML=d,m=A(),b=u("ion-list");for(let c=0;c<k.length;c+=1)k[c].c();this.h()},l(c){t=G(c,e),o=D(c),n=f(c,"ION-CONTENT",{});var _=E(n);l=f(_,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),J(l)!=="svelte-1jkndk3"&&(l.innerHTML=d),m=D(_),b=f(_,"ION-LIST",{});var T=E(b);for(let y=0;y<k.length;y+=1)k[y].l(T);T.forEach(s),_.forEach(s),this.h()},h(){N(l,"slot","fixed")},m(c,_){R(c,t,_),R(c,o,_),R(c,n,_),i(n,l),r[18](l),i(n,m),i(n,b);for(let T=0;T<k.length;T+=1)k[T]&&k[T].m(b,null);p||(a=Z(l,"ionRefresh",r[7]),p=!0)},p(c,_){_[0]&1&&e!==(e=ze(c[0],"enroute")+"")&&ie(t,e),_[0]&5384&&(h=pe(c[3]),k=De(k,_,I,1,c,h,g,b,Se,ht,null,at))},d(c){c&&(s(t),s(o),s(n)),r[18](null);for(let _=0;_<k.length;_+=1)k[_].d();p=!1,a()}}}function hn(r){let e,t;function o(d,m){return m[0]&32&&(e=null),e==null&&(e=!!d[5].every(bn)),e?pn:dn}let n=o(r,[-1,-1]),l=n(r);return{c(){l.c(),t=oe()},l(d){l.l(d),t=oe()},m(d,m){l.m(d,m),R(d,t,m)},p(d,m){n===(n=o(d,m))&&l?l.p(d,m):(l.d(1),l=n(d),l&&(l.c(),l.m(t.parentNode,t)))},d(d){d&&s(t),l.d(d)}}}function _t(r){let e;return{c(){e=u("span"),this.h()},l(t){e=f(t,"SPAN",{class:!0}),E(e).forEach(s),this.h()},h(){U(e,"class","notes svelte-ziybgw")},m(t,o){R(t,e,o)},d(t){t&&s(e)}}}function ht(r,e){let t,o,n,l,d=parseInt(e[25].pos)+1+"",m,b,k,g,p,a,h=e[25].title+"",I,c,_=e[25].support_list&&e[25].support_list.length||e[10](e[25]),T,y,q,P,M,v=_&&_t();function L(){return e[19](e[25])}return{key:r,first:null,c(){t=u("ion-item"),o=u("ion-avatar"),n=u("div"),l=u("div"),m=W(d),k=A(),g=u("ion-label"),p=u("ion-text"),a=u("h3"),I=W(h),c=A(),v&&v.c(),T=A(),y=u("ion-icon"),q=A(),this.h()},l(H){t=f(H,"ION-ITEM",{});var C=E(t);o=f(C,"ION-AVATAR",{slot:!0});var O=E(o);n=f(O,"DIV",{class:!0,title:!0,style:!0});var S=E(n);l=f(S,"DIV",{class:!0});var w=E(l);m=G(w,d),w.forEach(s),S.forEach(s),O.forEach(s),k=D(C),g=f(C,"ION-LABEL",{button:!0});var B=E(g);p=f(B,"ION-TEXT",{color:!0});var F=E(p);a=f(F,"H3",{});var z=E(a);I=G(z,h),c=D(z),v&&v.l(z),z.forEach(s),F.forEach(s),B.forEach(s),T=D(C),y=f(C,"ION-ICON",{icon:!0,slot:!0,style:!0}),E(y).forEach(s),q=D(C),C.forEach(s),this.h()},h(){U(l,"class","order svelte-ziybgw"),U(n,"class","order-wrapper svelte-ziybgw"),U(n,"title",b=ke(e[25].status)),V(n,"background-color",ee(e[25])),V(n,"color",Oe(ee(e[25]))),N(o,"slot","start"),N(p,"color","#2e2e2e"),N(g,"button",""),N(y,"icon",Ne),N(y,"slot","end"),V(y,"color",ee(e[25])),this.first=t},m(H,C){R(H,t,C),i(t,o),i(o,n),i(n,l),i(l,m),i(t,k),i(t,g),i(g,p),i(p,a),i(a,I),i(a,c),v&&v.m(a,null),i(t,T),i(t,y),i(t,q),P||(M=Z(g,"click",L),P=!0)},p(H,C){e=H,C[0]&8&&d!==(d=parseInt(e[25].pos)+1+"")&&ie(m,d),C[0]&8&&b!==(b=ke(e[25].status))&&U(n,"title",b),C[0]&8&&V(n,"background-color",ee(e[25])),C[0]&8&&V(n,"color",Oe(ee(e[25]))),C[0]&8&&h!==(h=e[25].title+"")&&ie(I,h),C[0]&8&&(_=e[25].support_list&&e[25].support_list.length||e[10](e[25])),_?v||(v=_t(),v.c(),v.m(a,null)):v&&(v.d(1),v=null),C[0]&8&&V(y,"color",ee(e[25]))},d(H){H&&s(t),v&&v.d(),P=!1,M()}}}function dn(r){let e=r[9](r[5],r[1],r[0])+"",t,o,n,l,d='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Pull to refresh" refreshing-spinner="circles" refreshing-text="Refreshing..."></ion-refresher-content>',m,b,k=[],g=new Map,p,a,h=pe(r[3]);const I=c=>c[25].id_event;for(let c=0;c<h.length;c+=1){let _=ct(r,h,c),T=I(_);g.set(T,k[c]=pt(T,_))}return{c(){t=W(e),o=A(),n=u("ion-content"),l=u("ion-refresher"),l.innerHTML=d,m=A(),b=u("ion-list");for(let c=0;c<k.length;c+=1)k[c].c();this.h()},l(c){t=G(c,e),o=D(c),n=f(c,"ION-CONTENT",{});var _=E(n);l=f(_,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),J(l)!=="svelte-1poui8g"&&(l.innerHTML=d),m=D(_),b=f(_,"ION-LIST",{});var T=E(b);for(let y=0;y<k.length;y+=1)k[y].l(T);T.forEach(s),_.forEach(s),this.h()},h(){N(l,"slot","fixed")},m(c,_){R(c,t,_),R(c,o,_),R(c,n,_),i(n,l),r[16](l),i(n,m),i(n,b);for(let T=0;T<k.length;T+=1)k[T]&&k[T].m(b,null);p||(a=Z(l,"ionRefresh",r[7]),p=!0)},p(c,_){_[0]&35&&e!==(e=c[9](c[5],c[1],c[0])+"")&&ie(t,e),_[0]&1288&&(h=pe(c[3]),k=De(k,_,I,1,c,h,g,b,Se,pt,null,ct))},d(c){c&&(s(t),s(o),s(n)),r[16](null);for(let _=0;_<k.length;_+=1)k[_].d();p=!1,a()}}}function pn(r){let e,t,o='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Pull to refresh" refreshing-spinner="circles" refreshing-text="Refreshing..."></ion-refresher-content>',n,l,d=[],m=new Map,b,k,g=pe(r[3]);const p=a=>a[25].id_event;for(let a=0;a<g.length;a+=1){let h=ut(r,g,a),I=p(h);m.set(I,d[a]=vt(I,h))}return{c(){e=u("ion-content"),t=u("ion-refresher"),t.innerHTML=o,n=A(),l=u("ion-list");for(let a=0;a<d.length;a+=1)d[a].c();this.h()},l(a){e=f(a,"ION-CONTENT",{});var h=E(e);t=f(h,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),J(t)!=="svelte-1poui8g"&&(t.innerHTML=o),n=D(h),l=f(h,"ION-LIST",{});var I=E(l);for(let c=0;c<d.length;c+=1)d[c].l(I);I.forEach(s),h.forEach(s),this.h()},h(){N(t,"slot","fixed")},m(a,h){R(a,e,h),i(e,t),r[14](t),i(e,n),i(e,l);for(let I=0;I<d.length;I+=1)d[I]&&d[I].m(l,null);b||(k=Z(t,"ionRefresh",r[7]),b=!0)},p(a,h){h[0]&1288&&(g=pe(a[3]),d=De(d,h,p,1,a,g,m,l,Se,vt,null,ut))},d(a){a&&s(e),r[14](null);for(let h=0;h<d.length;h+=1)d[h].d();b=!1,k()}}}function dt(r){let e;return{c(){e=u("span"),this.h()},l(t){e=f(t,"SPAN",{class:!0}),E(e).forEach(s),this.h()},h(){U(e,"class","notes svelte-ziybgw")},m(t,o){R(t,e,o)},d(t){t&&s(e)}}}function pt(r,e){let t,o,n,l,d=parseInt(e[25].pos)+1+"",m,b,k,g,p,a,h=e[25].title+"",I,c,_=e[25].support_list&&e[25].support_list.length||e[10](e[25]),T,y,q="",P,M,v,L,H,C=_&&dt();function O(){return e[17](e[25])}return{key:r,first:null,c(){t=u("ion-item"),o=u("ion-avatar"),n=u("div"),l=u("div"),m=W(d),k=A(),g=u("ion-label"),p=u("ion-text"),a=u("h3"),I=W(h),c=A(),C&&C.c(),T=A(),y=u("div"),y.innerHTML=q,P=A(),M=u("ion-icon"),v=A(),this.h()},l(S){t=f(S,"ION-ITEM",{});var w=E(t);o=f(w,"ION-AVATAR",{slot:!0});var B=E(o);n=f(B,"DIV",{class:!0,title:!0,style:!0});var F=E(n);l=f(F,"DIV",{class:!0});var z=E(l);m=G(z,d),z.forEach(s),F.forEach(s),B.forEach(s),k=D(w),g=f(w,"ION-LABEL",{button:!0});var j=E(g);p=f(j,"ION-TEXT",{color:!0});var te=E(p);a=f(te,"H3",{});var $=E(a);I=G($,h),c=D($),C&&C.l($),$.forEach(s),te.forEach(s),T=D(j),y=f(j,"DIV",{class:!0,"data-svelte-h":!0}),J(y)!=="svelte-130ohbs"&&(y.innerHTML=q),j.forEach(s),P=D(w),M=f(w,"ION-ICON",{icon:!0,slot:!0}),E(M).forEach(s),v=D(w),w.forEach(s),this.h()},h(){U(l,"class","order svelte-ziybgw"),U(n,"class","order-wrapper svelte-ziybgw"),U(n,"title",b=ke(e[25].status)),V(n,"background-color",ee(e[25])),V(n,"color",Oe(ee(e[25]))),N(o,"slot","start"),N(p,"color","#2e2e2e"),U(y,"class","sub svelte-ziybgw"),N(g,"button",""),N(M,"icon",Ne),N(M,"slot","end"),this.first=t},m(S,w){R(S,t,w),i(t,o),i(o,n),i(n,l),i(l,m),i(t,k),i(t,g),i(g,p),i(p,a),i(a,I),i(a,c),C&&C.m(a,null),i(g,T),i(g,y),i(t,P),i(t,M),i(t,v),L||(H=Z(g,"click",O),L=!0)},p(S,w){e=S,w[0]&8&&d!==(d=parseInt(e[25].pos)+1+"")&&ie(m,d),w[0]&8&&b!==(b=ke(e[25].status))&&U(n,"title",b),w[0]&8&&V(n,"background-color",ee(e[25])),w[0]&8&&V(n,"color",Oe(ee(e[25]))),w[0]&8&&h!==(h=e[25].title+"")&&ie(I,h),w[0]&8&&(_=e[25].support_list&&e[25].support_list.length||e[10](e[25])),_?C||(C=dt(),C.c(),C.m(a,null)):C&&(C.d(1),C=null)},d(S){S&&s(t),C&&C.d(),L=!1,H()}}}function mt(r){let e;return{c(){e=u("span"),this.h()},l(t){e=f(t,"SPAN",{class:!0}),E(e).forEach(s),this.h()},h(){U(e,"class","notes svelte-ziybgw")},m(t,o){R(t,e,o)},d(t){t&&s(e)}}}function vt(r,e){let t,o,n,l,d=parseInt(e[25].pos)+1+"",m,b,k,g,p,a,h=e[25].title+"",I,c,_=e[25].support_list&&e[25].support_list.length||e[10](e[25]),T,y,q="",P,M,v,L,H,C=_&&mt();function O(){return e[15](e[25])}return{key:r,first:null,c(){t=u("ion-item"),o=u("ion-avatar"),n=u("div"),l=u("div"),m=W(d),k=A(),g=u("ion-label"),p=u("ion-text"),a=u("h3"),I=W(h),c=A(),C&&C.c(),T=A(),y=u("div"),y.innerHTML=q,P=A(),M=u("ion-icon"),v=A(),this.h()},l(S){t=f(S,"ION-ITEM",{});var w=E(t);o=f(w,"ION-AVATAR",{slot:!0});var B=E(o);n=f(B,"DIV",{class:!0,title:!0,style:!0});var F=E(n);l=f(F,"DIV",{class:!0});var z=E(l);m=G(z,d),z.forEach(s),F.forEach(s),B.forEach(s),k=D(w),g=f(w,"ION-LABEL",{button:!0});var j=E(g);p=f(j,"ION-TEXT",{color:!0});var te=E(p);a=f(te,"H3",{});var $=E(a);I=G($,h),c=D($),C&&C.l($),$.forEach(s),te.forEach(s),T=D(j),y=f(j,"DIV",{class:!0,"data-svelte-h":!0}),J(y)!=="svelte-130ohbs"&&(y.innerHTML=q),j.forEach(s),P=D(w),M=f(w,"ION-ICON",{icon:!0,slot:!0}),E(M).forEach(s),v=D(w),w.forEach(s),this.h()},h(){U(l,"class","order svelte-ziybgw"),U(n,"class","order-wrapper svelte-ziybgw"),U(n,"title",b=ke(e[25].status)),V(n,"background-color",ee(e[25])),V(n,"color",Oe(ee(e[25]))),N(o,"slot","start"),N(p,"color","#2e2e2e"),U(y,"class","sub svelte-ziybgw"),N(g,"button",""),N(M,"icon",Ne),N(M,"slot","end"),this.first=t},m(S,w){R(S,t,w),i(t,o),i(o,n),i(n,l),i(l,m),i(t,k),i(t,g),i(g,p),i(p,a),i(a,I),i(a,c),C&&C.m(a,null),i(g,T),i(g,y),i(t,P),i(t,M),i(t,v),L||(H=Z(g,"click",O),L=!0)},p(S,w){e=S,w[0]&8&&d!==(d=parseInt(e[25].pos)+1+"")&&ie(m,d),w[0]&8&&b!==(b=ke(e[25].status))&&U(n,"title",b),w[0]&8&&V(n,"background-color",ee(e[25])),w[0]&8&&V(n,"color",Oe(ee(e[25]))),w[0]&8&&h!==(h=e[25].title+"")&&ie(I,h),w[0]&8&&(_=e[25].support_list&&e[25].support_list.length||e[10](e[25])),_?C||(C=mt(),C.c(),C.m(a,null)):C&&(C.d(1),C=null)},d(S){S&&s(t),C&&C.d(),L=!1,H()}}}function mn(r){let e,t,o,n,l=`<ion-icon icon="${zt}"></ion-icon>`,d,m,b,k=r[2].name+"",g,p,a,h=r[4].name+"",I,c,_,T,y;function q(v,L){return v[5].length>0?hn:_n}let P=q(r),M=P(r);return{c(){e=u("ion-header"),t=u("ion-toolbar"),o=u("ion-buttons"),n=u("ion-button"),n.innerHTML=l,d=A(),m=u("ion-buttons"),b=u("ion-button"),g=W(k),p=A(),a=u("ion-title"),I=W(h),c=A(),M.c(),_=oe(),this.h()},l(v){e=f(v,"ION-HEADER",{translucent:!0});var L=E(e);t=f(L,"ION-TOOLBAR",{});var H=E(t);o=f(H,"ION-BUTTONS",{slot:!0});var C=E(o);n=f(C,"ION-BUTTON",{title:!0,alt:!0,"data-svelte-h":!0}),J(n)!=="svelte-7ppz3r"&&(n.innerHTML=l),C.forEach(s),d=D(H),m=f(H,"ION-BUTTONS",{slot:!0});var O=E(m);b=f(O,"ION-BUTTON",{});var S=E(b);g=G(S,k),S.forEach(s),O.forEach(s),p=D(H),a=f(H,"ION-TITLE",{});var w=E(a);I=G(w,h),w.forEach(s),H.forEach(s),L.forEach(s),c=D(v),M.l(v),_=oe(),this.h()},h(){N(n,"title","Atrás"),N(n,"alt","Atrás"),N(o,"slot","start"),N(m,"slot","secondary"),N(e,"translucent","")},m(v,L){R(v,e,L),i(e,t),i(t,o),i(o,n),i(t,d),i(t,m),i(m,b),i(b,g),i(t,p),i(t,a),i(a,I),R(v,c,L),M.m(v,L),R(v,_,L),T||(y=Z(n,"click",r[11]),T=!0)},p(v,L){L[0]&4&&k!==(k=v[2].name+"")&&ie(g,k),L[0]&16&&h!==(h=v[4].name+"")&&ie(I,h),P===(P=q(v))&&M?M.p(v,L):(M.d(1),M=P(v),M&&(M.c(),M.m(_.parentNode,_)))},d(v){v&&(s(e),s(c),s(_)),M.d(v),T=!1,y()}}}function vn(r){let e,t,o,n=r[2]&&ft(r);return{c(){e=A(),n&&n.c(),t=oe(),this.h()},l(l){Lt("svelte-kn0kph",document.head).forEach(s),e=D(l),n&&n.l(l),t=oe(),this.h()},h(){document.title="Rutaflow - Detalles de ruta"},m(l,d){R(l,e,d),n&&n.m(l,d),R(l,t,d),o=!0},p(l,d){l[2]?n?(n.p(l,d),d[0]&4&&Ae(n,1)):(n=ft(l),n.c(),Ae(n,1),n.m(t.parentNode,t)):n&&(Bt(),Fe(n,1,1,()=>{n=null}),At())},i(l){o||(Ae(n),o=!0)},o(l){Fe(n),o=!1},d(l){l&&(s(e),s(t)),n&&n.d(l)}}}function ee(r){let e="#ffffff";return r.status==="pending"?e="#f2e300":r.status==="completed"&&(e="#44d900"),e}function ke(r){let e="";return r=="pending"?e="Pendiente":r=="completed"&&(e="Completado"),e}function Oe(r){r.slice(0,1)==="#"&&(r=r.slice(1)),r.length===3&&(r=r.split("").map(function(l){return l+l}).join(""));const e=parseInt(r.substr(0,2),16),t=parseInt(r.substr(2,2),16),o=parseInt(r.substr(4,2),16);return(e*299+t*587+o*114)/1e3>=128?"#414040":"#fff"}function ze(r,e){let t=new FormData;return t.append("id_route",r),t.append("status",e),fetch("https://rutaflow-app-development.up.railway.app/api/admin/route/change_status.php",{method:"POST",body:t}).then(o=>o.json()).then(o=>{}).catch(o=>{console.error("Error fetching data:",o)}),""}const bn=r=>r.img;function gn(r,e,t){let o;bt(r,gt,O=>t(13,o=O));var n=this&&this.__awaiter||function(O,S,w,B){function F(z){return z instanceof w?z:new w(function(j){j(z)})}return new(w||(w=Promise))(function(z,j){function te(Y){try{me(B.next(Y))}catch(le){j(le)}}function $(Y){try{me(B.throw(Y))}catch(le){j(le)}}function me(Y){Y.done?z(Y.value):F(Y.value).then(te,$)}me((B=B.apply(O,S||[])).next())})};let{routeId:l}=e,{driverId:d}=e,m=new Object,b=[],k={},g={},p;const a=()=>n(void 0,void 0,void 0,function*(){yield h(l),p.complete()});function h(O){const S=new FormData;S.append("id_route",O),fetch("https://rutaflow-app-development.up.railway.app/api/admin/report/seguimiento_list.php",{method:"POST",body:S}).then(w=>w.json()).then(w=>{t(4,k=w.data.seguimiento_list[0]),t(3,b=w.data.event_list),t(5,g=w.data.checklist)}).catch(w=>{console.error("Error fetching data:",w)})}const I=O=>new Promise((S,w)=>{const B=new FormData;B.append("id_route",O.id_route),B.append("id_event",O.id_event),fetch("https://rutaflow-app-development.up.railway.app/api/admin/evidence/evidence_by_event.php",{method:"POST",body:B}).then(F=>F.json()).then(F=>{S(F.data.event_evidence[0])}).catch(F=>{console.error("Error fetching data:",F),w(F)})}),c=(O,S,w)=>{I(O).then(B=>{O.client_name=k.client_name,B&&(O.img=B.img,O.driver_comments=B.driver_comments,O.comments=B.comments),st("modal-delivery-info",on,{delivery:O}).then(F=>{})})},_=(O,S,w)=>(st("modal-checklist",an,{checklist:O,driverId:S,routeId:w}).then(B=>{}),ze(w,"checklist"),""),T=O=>{if(O.tracking_type=="subscription"){if(O.subscriber_info&&O.payment_type==="cash"&&new Date(O.subscriber_info.payment_next)<new Date)return!0}else if(O.tracking_type=="ecommerce"&&Number(O.payment_pending)>0)return!0;return!1},y=()=>{m.id_driver?Ie(`/drivers/${m.id_driver}`):Ie("/drivers/me")},q=(O,S)=>n(void 0,void 0,void 0,function*(){yield(yield It.create({header:O||"Error",message:S||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()});function P(O){Te[O?"unshift":"push"](()=>{p=O,t(6,p)})}const M=O=>c(O);function v(O){Te[O?"unshift":"push"](()=>{p=O,t(6,p)})}const L=O=>c(O);function H(O){Te[O?"unshift":"push"](()=>{p=O,t(6,p)})}const C=O=>{const S=b.findIndex(z=>z.id_event===O.id_event),w=S===0,B=S>0?b[S-1]:null;w||B&&B.img;const F=O.img!==null&&O.img!=="";F||w&&!F?c(O):q("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")};return r.$$set=O=>{"routeId"in O&&t(0,l=O.routeId),"driverId"in O&&t(1,d=O.driverId)},r.$$.update=()=>{r.$$.dirty[0]&8197&&(t(0,{routeId:l,driverId:d}=o.params,l,(t(1,d),t(13,o),t(2,m),t(0,l))),t(2,m=JSON.parse(localStorage.getItem("userSession"))),m?m.id_user&&(m.type=="admin"||m.type=="superadmin")?(Ie(`/drivers/me/routes/${l}`),h(l)):m.id_user&&m.id_driver&&(h(l),Ie(`/drivers/${m.id_driver}/routes/${l}`)):Ie("/"))},[l,d,m,b,k,g,p,a,c,_,T,y,q,o,P,M,v,L,H,C]}class Cn extends Xe{constructor(e){super(),We(this,e,gn,vn,je,{routeId:0,driverId:1},null,[-1,-1])}}export{Cn as component};

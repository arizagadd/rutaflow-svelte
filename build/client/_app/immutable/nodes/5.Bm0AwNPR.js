import{Z as Et,s as xe,e as s,j as N,b as c,q as E,d as J,h as a,m as T,v as g,i as H,w as r,x as se,n as Ce,z as Ge,_ as an,B as F,o as it,k as Ue,$ as It,t as he,r as pe,f as Y,a0 as sn,a1 as ot,A as He,y as Be,a2 as dt,l as cn,p as un,F as fn}from"../chunks/index.BzUyNcuj.js";import{S as $e,i as et,t as _t,a as mt,c as _n,b as dn,d as hn,m as pn,e as mn,g as vn}from"../chunks/index.D9GPdhpm.js";import{e as je,u as lt,d as rt,a as gn,c as vt,b as nn,f as bn,g as En,i as on,h as In,j as ln,k as kn,m as On,s as kt,n as tt,o as Nn,q as Tn,r as Cn,t as yn,v as wn,w as Ln,p as Sn}from"../chunks/index.DbycqIkx.js";import"../chunks/index-6e05b96e.C_9q9BoX.js";import{m as at,D as ht,a as Qe,I as Mn}from"../chunks/IonPage.OxEC_xzH.js";import{q as Pn,t as An}from"../chunks/ion-modal.BYMRzj9z.js";import{g as Ke}from"../chunks/entry.BJuz583F.js";const Bn=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global,Dn=(l,e)=>{if(!customElements.get(l)){class t extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const n={};for(const i of this.attributes)n[i.name]=i.value;new e({target:this.shadowRoot,props:n})}}customElements.define(l,t)}},zn=function(l){return document.createElement(l).constructor!==HTMLElement},Hn=(l,e)=>{zn(l)||Dn(l,e)},We=async(l,e,t)=>{Pn(),An(),Hn(l,e);const o=await at.create({component:l,componentProps:t});return o.present(),await o.onWillDismiss()};let Je=Et({km_inicial:[],gas_inicial:[],km_final:[],gas_final:[]}),rn=Et({flag:[]});function Rn(l){let e,t,o,n,i="Cancelar",d,_,h="Captura de Km/Gas",O,I,f,u="Confirmar",b,p,m,v,w,y,R;return{c(){e=s("ion-header"),t=s("ion-toolbar"),o=s("ion-buttons"),n=s("ion-button"),n.textContent=i,d=N(),_=s("ion-title"),_.textContent=h,O=N(),I=s("ion-buttons"),f=s("ion-button"),f.textContent=u,b=N(),p=s("ion-content"),m=s("ion-item"),v=s("ion-input"),this.h()},l(B){e=c(B,"ION-HEADER",{translucent:!0});var D=E(e);t=c(D,"ION-TOOLBAR",{});var C=E(t);o=c(C,"ION-BUTTONS",{slot:!0});var L=E(o);n=c(L,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),J(n)!=="svelte-17pq4f4"&&(n.textContent=i),L.forEach(a),d=T(C),_=c(C,"ION-TITLE",{"data-svelte-h":!0}),J(_)!=="svelte-1yhkaq7"&&(_.textContent=h),O=T(C),I=c(C,"ION-BUTTONS",{slot:!0});var P=E(I);f=c(P,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),J(f)!=="svelte-cm6j4s"&&(f.textContent=u),P.forEach(a),C.forEach(a),D.forEach(a),b=T(B),p=c(B,"ION-CONTENT",{fullscreen:!0});var k=E(p);m=c(k,"ION-ITEM",{});var S=E(m);v=c(S,"ION-INPUT",{class:!0,inputmode:!0,pattern:!0,type:!0,placeholder:!0,value:!0,required:!0});var U=E(v);U.forEach(a),S.forEach(a),k.forEach(a),this.h()},h(){g(n,"color","medium"),g(o,"slot","start"),g(f,"strong",""),g(I,"slot","end"),g(e,"translucent",""),g(v,"class","fin-km"),g(v,"inputmode","numeric"),g(v,"pattern","[0-9]*"),g(v,"type","number"),g(v,"placeholder",w="Ingresa "+l[0]+" actual"),g(v,"value",l[1]),g(v,"required",""),g(p,"fullscreen","")},m(B,D){H(B,e,D),r(e,t),r(t,o),r(o,n),r(t,d),r(t,_),r(t,O),r(t,I),r(I,f),H(B,b,D),H(B,p,D),r(p,m),r(m,v),y||(R=[se(n,"click",l[2]),se(f,"click",l[3]),se(v,"input",l[4])],y=!0)},p(B,[D]){D&1&&w!==(w="Ingresa "+B[0]+" actual")&&g(v,"placeholder",w),D&2&&g(v,"value",B[1])},i:Ce,o:Ce,d(B){B&&(a(e),a(b),a(p)),y=!1,Ge(R)}}}function Un(l,e,t){const o=an();let n=document.querySelector("ion-modal"),i=n.componentProps.data_type;n.componentProps.isLast;let d;rn.subscribe(f=>{i=f.flag[0],i=="km_final"||i=="km_inicial"?t(0,d="kilometraje"):t(0,d="litros de gasolina")});let _=0;function h(){at.dismiss()}function O(){o("modalResult",{data:"Your data",role:"confirm"}),i=="km_inicial"?Je.update(u=>({...u,km_inicial:[_]})):i=="gas_inicial"?Je.update(u=>({...u,gas_inicial:[_]})):i=="km_final"?Je.update(u=>({...u,km_final:[_]})):i=="gas_final"&&Je.update(u=>({...u,gas_final:[_]})),h()}return[d,_,h,O,f=>t(1,_=f.target.value)]}class Fn extends $e{constructor(e){super(),et(this,e,Un,Rn,xe,{})}}const pt=Et({items:[],checkedIndices:[],mandatory:[]});function wt(l,e,t){const o=l.slice();return o[53]=e[t],o[54]=e,o[55]=t,o}function qn(l){let e,t,o,n,i,d="Kilometraje inicial",_,h,O=l[0]?l[0]+" km.":"Cargar km",I,f,u,b,p,m,v,w="Gasolina inicial (litros)",y,R,B=l[1]?l[1]+" litros":"Cargar gas",D,C,L,P;return C=It(l[21][0]),{c(){e=s("ion-item"),t=s("ion-label"),o=s("input"),n=N(),i=s("p"),i.textContent=d,_=N(),h=s("ion-button"),I=he(O),f=N(),u=s("ion-item"),b=s("ion-label"),p=s("input"),m=N(),v=s("p"),v.textContent=w,y=N(),R=s("ion-button"),D=he(B),this.h()},l(k){e=c(k,"ION-ITEM",{});var S=E(e);t=c(S,"ION-LABEL",{style:!0});var U=E(t);o=c(U,"INPUT",{id:!0,style:!0,type:!0}),n=T(U),i=c(U,"P",{style:!0,"data-svelte-h":!0}),J(i)!=="svelte-88twxi"&&(i.textContent=d),U.forEach(a),_=T(S),h=c(S,"ION-BUTTON",{fill:!0,size:!0,class:!0,"aria-selected":!0});var M=E(h);I=pe(M,O),M.forEach(a),S.forEach(a),f=T(k),u=c(k,"ION-ITEM",{});var V=E(u);b=c(V,"ION-LABEL",{style:!0});var q=E(b);p=c(q,"INPUT",{id:!0,style:!0,type:!0}),m=T(q),v=c(q,"P",{style:!0,"data-svelte-h":!0}),J(v)!=="svelte-1ux30eb"&&(v.textContent=w),q.forEach(a),y=T(V),R=c(V,"ION-BUTTON",{fill:!0,class:!0,size:!0,style:!0});var j=E(R);D=pe(j,B),j.forEach(a),V.forEach(a),this.h()},h(){Y(o,"id","chkbox-km-ini"),F(o,"pointer-events","auto"),Y(o,"type","checkbox"),o.required=!0,F(i,"margin-left","10px"),F(t,"display","flex"),g(h,"fill","outline"),g(h,"size","small"),g(h,"class","loadKmInicial"),g(h,"aria-selected",""),Y(p,"id","chkbox-gas-ini"),F(p,"pointer-events","auto"),Y(p,"type","checkbox"),p.required=!0,F(v,"margin-left","10px"),F(b,"display","flex"),g(R,"fill","outline"),g(R,"class","loadGasInicial"),g(R,"size","small"),F(R,"height","16px "),C.p(o,p)},m(k,S){H(k,e,S),r(e,t),r(t,o),o.checked=~(l[4]||[]).indexOf(o.__value),l[28](o),r(t,n),r(t,i),r(e,_),r(e,h),r(h,I),H(k,f,S),H(k,u,S),r(u,b),r(b,p),l[30](p),p.checked=~(l[4]||[]).indexOf(p.__value),r(b,m),r(b,v),r(u,y),r(u,R),r(R,D),L||(P=[se(o,"change",l[27]),se(h,"click",l[29]),se(p,"change",l[31]),se(R,"click",l[32])],L=!0)},p(k,S){S[0]&16&&(o.checked=~(k[4]||[]).indexOf(o.__value)),S[0]&1&&O!==(O=k[0]?k[0]+" km.":"Cargar km")&&Be(I,O),S[0]&16&&(p.checked=~(k[4]||[]).indexOf(p.__value)),S[0]&2&&B!==(B=k[1]?k[1]+" litros":"Cargar gas")&&Be(D,B)},d(k){k&&(a(e),a(f),a(u)),l[28](null),l[30](null),C.r(),L=!1,Ge(P)}}}function jn(l){let e,t,o,n,i,d="Kilometraje final",_,h,O=l[2]?l[2]+" km.":"Cargar km",I,f,u,b,p,m,v,w="Gasolina final (litros)",y,R,B=l[3]?l[3]+" litros":"Cargar gas",D,C,L,P;return C=It(l[21][0]),{c(){e=s("ion-item"),t=s("ion-label"),o=s("input"),n=N(),i=s("p"),i.textContent=d,_=N(),h=s("ion-button"),I=he(O),f=N(),u=s("ion-item"),b=s("ion-label"),p=s("input"),m=N(),v=s("p"),v.textContent=w,y=N(),R=s("ion-button"),D=he(B),this.h()},l(k){e=c(k,"ION-ITEM",{});var S=E(e);t=c(S,"ION-LABEL",{style:!0});var U=E(t);o=c(U,"INPUT",{id:!0,style:!0,type:!0}),n=T(U),i=c(U,"P",{style:!0,"data-svelte-h":!0}),J(i)!=="svelte-ccmu71"&&(i.textContent=d),U.forEach(a),_=T(S),h=c(S,"ION-BUTTON",{fill:!0,size:!0,class:!0,"aria-selected":!0});var M=E(h);I=pe(M,O),M.forEach(a),S.forEach(a),f=T(k),u=c(k,"ION-ITEM",{});var V=E(u);b=c(V,"ION-LABEL",{style:!0});var q=E(b);p=c(q,"INPUT",{id:!0,style:!0,type:!0}),m=T(q),v=c(q,"P",{style:!0,"data-svelte-h":!0}),J(v)!=="svelte-wsoyd2"&&(v.textContent=w),q.forEach(a),y=T(V),R=c(V,"ION-BUTTON",{fill:!0,size:!0,class:!0});var j=E(R);D=pe(j,B),j.forEach(a),V.forEach(a),this.h()},h(){Y(o,"id","chkbox-km-fin"),F(o,"pointer-events","auto"),Y(o,"type","checkbox"),o.required=!0,F(i,"margin-left","10px"),F(t,"display","flex"),g(h,"fill","outline"),g(h,"size","small"),g(h,"class","loadKmInicial"),g(h,"aria-selected",""),Y(p,"id","chkbox-gas-fin"),F(p,"pointer-events","auto"),Y(p,"type","checkbox"),p.required=!0,F(v,"margin-left","10px"),F(b,"display","flex"),g(R,"fill","outline"),g(R,"size","small"),g(R,"class","loadGasInicial"),C.p(o,p)},m(k,S){H(k,e,S),r(e,t),r(t,o),o.checked=~(l[4]||[]).indexOf(o.__value),l[22](o),r(t,n),r(t,i),r(e,_),r(e,h),r(h,I),H(k,f,S),H(k,u,S),r(u,b),r(b,p),p.checked=~(l[4]||[]).indexOf(p.__value),l[25](p),r(b,m),r(b,v),r(u,y),r(u,R),r(R,D),L||(P=[se(o,"change",l[20]),se(h,"click",l[23]),se(p,"change",l[24]),se(R,"click",l[26])],L=!0)},p(k,S){S[0]&16&&(o.checked=~(k[4]||[]).indexOf(o.__value)),S[0]&4&&O!==(O=k[2]?k[2]+" km.":"Cargar km")&&Be(I,O),S[0]&16&&(p.checked=~(k[4]||[]).indexOf(p.__value)),S[0]&8&&B!==(B=k[3]?k[3]+" litros":"Cargar gas")&&Be(D,B)},d(k){k&&(a(e),a(f),a(u)),l[22](null),l[25](null),C.r(),L=!1,Ge(P)}}}function Vn(l){let e=[],t=new Map,o,n=je(l[13]);const i=d=>d[53].id_checklist_event;for(let d=0;d<n.length;d+=1){let _=wt(l,n,d),h=i(_);t.set(h,e[d]=Lt(h,_))}return{c(){for(let d=0;d<e.length;d+=1)e[d].c();o=Ue()},l(d){for(let _=0;_<e.length;_+=1)e[_].l(d);o=Ue()},m(d,_){for(let h=0;h<e.length;h+=1)e[h]&&e[h].m(d,_);H(d,o,_)},p(d,_){_[0]&407664&&(n=je(d[13]),e=lt(e,_,i,1,d,n,t,o.parentNode,rt,Lt,o,wt))},d(d){d&&a(o);for(let _=0;_<e.length;_+=1)e[_].d(d)}}}function Gn(l){let e,t=(l[12][l[53].id_checklist_event]?l[12][l[53].id_checklist_event]:"Cargar evidencia")+"",o;return{c(){e=s("label"),o=he(t),this.h()},l(n){e=c(n,"LABEL",{for:!0,class:!0});var i=E(e);o=pe(i,t),i.forEach(a),this.h()},h(){Y(e,"for","chklist-"+l[53].id_checklist_event),Y(e,"class","button-label svelte-1ruehls")},m(n,i){H(n,e,i),r(e,o)},p(n,i){i[0]&4096&&t!==(t=(n[12][n[53].id_checklist_event]?n[12][n[53].id_checklist_event]:"Cargar evidencia")+"")&&Be(o,t)},d(n){n&&a(e)}}}function Kn(l){let e;return{c(){e=s("ion-spinner"),this.h()},l(t){e=c(t,"ION-SPINNER",{name:!0,class:!0}),E(e).forEach(a),this.h()},h(){g(e,"name","dots"),g(e,"class","button-spinner svelte-1ruehls")},m(t,o){H(t,e,o)},p:Ce,d(t){t&&a(e)}}}function Lt(l,e){let t,o,n,i=e[53],d,_,h=e[53].item+"",O,I,f,u=e[53].mandatory=="1"?" * ":"",b,p,m,v,w,y,R,B,D,C;const L=()=>e[34](n,i),P=()=>e[34](null,i);function k(){return e[35](e[53])}function S(q,j){return q[11][q[53].id_checklist_event]?Kn:Gn}let U=S(e),M=U(e);function V(...q){return e[37](e[53],...q)}return B=It(e[21][0]),{key:l,first:null,c(){t=s("ion-item"),o=s("ion-label"),n=s("input"),d=N(),_=s("p"),O=he(h),I=N(),f=s("b"),b=he(u),p=N(),m=s("ion-button"),v=s("div"),M.c(),w=N(),y=s("input"),R=N(),this.h()},l(q){t=c(q,"ION-ITEM",{});var j=E(t);o=c(j,"ION-LABEL",{style:!0});var te=E(o);n=c(te,"INPUT",{id:!0,style:!0,type:!0}),d=T(te),_=c(te,"P",{style:!0});var me=E(_);O=pe(me,h),I=T(me),me.forEach(a),f=c(te,"B",{style:!0});var ce=E(f);b=pe(ce,u),ce.forEach(a),te.forEach(a),p=T(j),m=c(j,"ION-BUTTON",{fill:!0,class:!0,size:!0});var W=E(m);v=c(W,"DIV",{class:!0});var x=E(v);M.l(x),w=T(x),y=c(x,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0}),x.forEach(a),W.forEach(a),R=T(j),j.forEach(a),this.h()},h(){Y(n,"id",`chkbox-${e[53].id_checklist_event}`),F(n,"pointer-events","auto"),Y(n,"type","checkbox"),n.__value=e[53].id_checklist_event,sn(n,n.__value),n.required=!0,F(_,"margin-left","10px"),F(f,"margin-left","5px"),F(o,"display","flex"),F(y,"display","none"),Y(y,"id","chklist-"+e[53].id_checklist_event),Y(y,"name","fileToUpload"),Y(y,"type","file"),Y(y,"accept","image/*"),Y(v,"class","button-content svelte-1ruehls"),g(m,"fill","outline"),g(m,"class","loadEvidence svelte-1ruehls"),g(m,"size","small"),B.p(n),this.first=t},m(q,j){H(q,t,j),r(t,o),r(o,n),n.checked=~(e[4]||[]).indexOf(n.__value),L(),r(o,d),r(o,_),r(_,O),r(_,I),r(o,f),r(f,b),r(t,p),r(t,m),r(m,v),M.m(v,null),r(v,w),r(v,y),e[36](y),r(t,R),D||(C=[se(n,"change",e[33]),se(n,"change",k),se(y,"change",V)],D=!0)},p(q,j){e=q,j[0]&16&&(n.checked=~(e[4]||[]).indexOf(n.__value)),i!==e[53]&&(P(),i=e[53],L()),U===(U=S(e))&&M?M.p(e,j):(M.d(1),M=U(e),M&&(M.c(),M.m(v,w)))},d(q){q&&a(t),P(),M.d(),e[36](null),B.r(),D=!1,Ge(C)}}}function Wn(l){let e,t,o,n,i="Cancelar",d,_,h="REQUERIMIENTOS DE RUTA",O,I,f,u,b,p,m,v="Confirmar",w,y;function R(L,P){return L[14]?jn:qn}let D=R(l)(l),C=l[13]&&Vn(l);return{c(){e=s("ion-header"),t=s("ion-toolbar"),o=s("ion-buttons"),n=s("ion-button"),n.textContent=i,d=N(),_=s("ion-title"),_.textContent=h,O=N(),I=s("ion-content"),f=s("ion-list"),D.c(),u=N(),C&&C.c(),b=N(),p=s("ion-footer"),m=s("ion-button"),m.textContent=v,this.h()},l(L){e=c(L,"ION-HEADER",{translucent:!0});var P=E(e);t=c(P,"ION-TOOLBAR",{});var k=E(t);o=c(k,"ION-BUTTONS",{slot:!0});var S=E(o);n=c(S,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),J(n)!=="svelte-1dnmkxs"&&(n.textContent=i),S.forEach(a),d=T(k),_=c(k,"ION-TITLE",{"data-svelte-h":!0}),J(_)!=="svelte-19bar5p"&&(_.textContent=h),k.forEach(a),P.forEach(a),O=T(L),I=c(L,"ION-CONTENT",{fullscreen:!0});var U=E(I);f=c(U,"ION-LIST",{});var M=E(f);D.l(M),u=T(M),C&&C.l(M),M.forEach(a),U.forEach(a),b=T(L),p=c(L,"ION-FOOTER",{});var V=E(p);m=c(V,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),J(m)!=="svelte-g82qqw"&&(m.textContent=v),V.forEach(a),this.h()},h(){g(n,"color","medium"),g(o,"slot","start"),g(e,"translucent",""),g(I,"fullscreen",""),g(m,"fill","outline"),g(m,"color","tertiary"),g(m,"strong",""),F(m,"width","99%"),F(m,"height","auto")},m(L,P){H(L,e,P),r(e,t),r(t,o),r(o,n),r(t,d),r(t,_),H(L,O,P),H(L,I,P),r(I,f),D.m(f,null),r(f,u),C&&C.m(f,null),H(L,b,P),H(L,p,P),r(p,m),w||(y=[se(n,"click",l[15]),se(m,"click",l[16])],w=!0)},p(L,P){D.p(L,P),L[13]&&C.p(L,P)},i:Ce,o:Ce,d(L){L&&(a(e),a(O),a(I),a(b),a(p)),D.d(),C&&C.d(),w=!1,Ge(y)}}}function gt(l,e){if(typeof l=="object"&&l!==null||Array.isArray(l)){if(Array.isArray(l))return l.map(t=>gt(t,e)).flat();{const t=Object.keys(l);let o;return e=="id_checklist_event"?o=t.filter(i=>i.toLowerCase().includes("id_checklist_event")).map(i=>l[i]):e=="mandatory"?o=t.filter(i=>i.toLowerCase().includes("mandatory")).map(i=>l[i]):(console.error("Tipo de dato no reconocido."),o=!1),o}}else return console.error("Invalid input. Please provide a valid object or array."),[]}function Xn(l,e,t){let o=ht,n=document.querySelector("ion-modal");const i=n.componentProps.checklist,d=n.componentProps.driverId,_=n.componentProps.routeId,h=n.componentProps.isLast;let O,I,f,u,b=[],p=null,m={},v,w,y,R,B={},D={},C={};it(()=>{h?console.log("Último checklist"):pt.update(z=>(z.mandatory=gt(i,"mandatory"),z.items=gt(i,"id_checklist_event"),z))});function L(z){t(11,B[z]=!0,B)}const P=async()=>{await(await Qe.create({header:"Datos o checklist incompletos",message:"Carga la evidencia requerida y marca todas las casillas para confirmar",buttons:[{text:"Cerrar"}]})).present()},k=async()=>{await(await Qe.create({header:"Datos capturados",message:"El kilometraje y gasolina final fueron registrados correctamente, espere aprobación para finalizar ruta",buttons:[{text:"Cerrar"}]})).present()},S=async z=>{await(await Qe.create({header:"Datos inválidos",message:z=="km"?"Llena correctamente el campo de kilometraje inicial":"Llena correctamente el campo de gasolina inicial",buttons:[{text:"Cerrar"}]})).present()},U=()=>{at.dismiss(),d?Ke(`/drivers/${d}`):Ke("/drivers/me")},M=()=>{if(h){var z=me(f,"km"),Z=me(u,"gas");const ie=new FormData;ie.append("km_final",z),ie.append("gas_final",Z),ie.append("id_route",_),z&&Z?(U(),fetch(`${o}api/admin/checklist/add_evidence.php`,{method:"POST",body:ie}).then(ae=>ae.json()).then(ae=>{k()}).catch(ae=>{console.error("Error fetching data:",ae)})):P()}else{var Te=me(O,"km"),oe=me(I,"gas");pt.update(ie=>{ie.items;const ae=ie.mandatory;if(ie.items.filter((ue,ee)=>ie.mandatory[ee]==="1").every(ue=>ie.checkedIndices.includes(ue))&&Te&&oe){U();const ue=new FormData;for(const ee in D)if(D.hasOwnProperty(ee)){const{img:we,img_id:Oe}=D[ee];ue.append(`selectedImages[${ee}][img]`,we),ue.append(`selectedImages[${ee}][img_id]`,Oe)}ue.append("km_inicial",Te),ue.append("gas_inicial",oe),ue.append("id_route",_),fetch(`${o}api/admin/checklist/add_evidence.php`,{method:"POST",body:ue}).then(ee=>ee.json()).then(ee=>{ae&&ae.some(we=>we==="1")?te(_,"checklist-pending"):te(_,"enroute")}).catch(ee=>{console.error("Error fetching data:",ee)})}else if(!ae&&Te&&oe){var be=new FormData;be.append("km_inicial",Te),be.append("gas_inicial",oe),fetch(`${o}api/admin/checklist/add_evidence.php`,{method:"POST",body:be}).then(ue=>ue.json()).then(ue=>{te(_,"enroute")}).catch(ue=>{console.error("Error fetching data:",ue)})}else P();return ie})}ne()},V=async(z,Z)=>{L(Z);const oe=z.target.files[0],ie=await q(oe);if(ie){const ae=new FormData;ae.append("fileToUpload",ie);try{const fe=await fetch(`${o}api/admin/manager/upload_img_driver.php`,{method:"POST",body:ae});if(fe.ok){const _e=await fe.json();D={...D,[Z]:{img:_e.img,img_id:_e.img_id}},t(12,C={...C,[Z]:_e.filename}),j(Z),t(6,m[Z].checked=!0,m),t(11,B[Z]=!1,B)}else console.error("File upload failed:",fe.statusText)}catch(fe){console.error("Error during file upload:",fe)}}},q=async z=>new Promise(Z=>{const Te=new FileReader;Te.onload=oe=>{const ie=new Image;ie.src=oe.target.result,ie.onload=()=>{const ae=document.createElement("canvas"),fe=ae.getContext("2d"),_e=800,be=600;let ue=ie.width,ee=ie.height;ue>_e&&(ee*=_e/ue,ue=_e),ee>be&&(ue*=be/ee,ee=be),ae.width=ue,ae.height=ee,fe.drawImage(ie,0,0,ue,ee),ae.toBlob(we=>{Z(we)},"image/jpeg",.7)}},Te.readAsDataURL(z)}),j=z=>{pt.update(Z=>(Z.checkedIndices.indexOf(z)===-1?Z.checkedIndices.push(z):console.error(`ID ${z} is already checked.`),Z.items.forEach(oe=>{oe.id_checklist_event===z&&(oe.checked=!0)}),Z))};function te(z,Z){let Te=new FormData;Te.append("id_route",z),Te.append("status",Z),fetch(`${o}api/admin/route/change_status.php`,{method:"POST",body:Te}).then(oe=>oe.json()).then(oe=>{}).catch(oe=>{console.error("Error fetching data:",oe)})}function me(z,Z){return/^\d+$/.test(z)?parseInt(z,10):(S(Z),null)}function ce(z,Z){W(Z),n.componentProps.data_type=Z,We("modal-gas-km",Fn,{r:Z}).then(()=>{Je.subscribe(Te=>{x(Te,Z)})})}function W(z){rn.update(Z=>({...Z,flag:[z]}))}function x(z,Z){t(0,O=z.km_inicial?z.km_inicial:null),t(1,I=z.gas_inicial?z.gas_inicial:null),t(2,f=z.km_final?z.km_final:null),t(3,u=z.gas_final?z.gas_final:null),Z=="km_inicial"&&v&&t(7,v.checked=!0,v),Z=="gas_inicial"&&w&&t(8,w.checked=!0,w),Z=="km_final"&&y&&t(9,y.checked=!0,y),Z=="gas_final"&&R&&t(10,R.checked=!0,R)}function ne(){Je.set({km_inicial:[],gas_inicial:[],km_final:[],gas_final:[]})}const le=[[]];function A(){b=ot(le[0],this.__value,this.checked),t(4,b)}function G(z){He[z?"unshift":"push"](()=>{y=z,t(9,y)})}const X=z=>ce(z,"km_final");function $(){b=ot(le[0],this.__value,this.checked),t(4,b)}function de(z){He[z?"unshift":"push"](()=>{R=z,t(10,R)})}const K=z=>ce(z,"gas_final");function re(){b=ot(le[0],this.__value,this.checked),t(4,b)}function Ne(z){He[z?"unshift":"push"](()=>{v=z,t(7,v)})}const Me=z=>ce(z,"km_inicial");function Ie(z){He[z?"unshift":"push"](()=>{w=z,t(8,w)})}function ve(){b=ot(le[0],this.__value,this.checked),t(4,b)}const De=z=>ce(z,"gas_inicial");function ze(){b=ot(le[0],this.__value,this.checked),t(4,b)}function qe(z,Z){He[z?"unshift":"push"](()=>{m[Z.id_checklist_event]=z,t(6,m)})}const Fe=z=>j(z.id_checklist_event);function Pe(z){He[z?"unshift":"push"](()=>{p=z,t(5,p)})}return[O,I,f,u,b,p,m,v,w,y,R,B,C,i,h,U,M,V,j,ce,A,le,G,X,$,de,K,re,Ne,Me,Ie,ve,De,ze,qe,Fe,Pe,(z,Z)=>V(Z,z.id_checklist_event)]}class Jn extends $e{constructor(e){super(),et(this,e,Xn,Wn,xe,{},null,[-1,-1])}}function Qn(l){let e,t,o,n,i,d="Teléfono de Negocio",_,h,O=l[10].client_phone+"",I;return{c(){e=s("ion-item"),t=s("ion-icon"),o=N(),n=s("ion-label"),i=s("p"),i.textContent=d,_=N(),h=s("h2"),I=he(O),this.h()},l(f){e=c(f,"ION-ITEM",{href:!0});var u=E(e);t=c(u,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(a),o=T(u),n=c(u,"ION-LABEL",{class:!0});var b=E(n);i=c(b,"P",{"data-svelte-h":!0}),J(i)!=="svelte-1u5l7fz"&&(i.textContent=d),_=T(b),h=c(b,"H2",{});var p=E(h);I=pe(p,O),p.forEach(a),b.forEach(a),u.forEach(a),this.h()},h(){g(t,"icon",bn),g(t,"slot","start"),g(n,"class","ion-text-wrap"),g(e,"href","tel:"+l[10].client_phone)},m(f,u){H(f,e,u),r(e,t),r(e,o),r(e,n),r(n,i),r(n,_),r(n,h),r(h,I)},p:Ce,d(f){f&&a(e)}}}function Yn(l){let e,t,o,n,i,d="Domicilio Alternativo",_,h,O=l[10].line2+"",I,f,u;return{c(){e=s("ion-item"),t=s("ion-icon"),o=N(),n=s("ion-label"),i=s("p"),i.textContent=d,_=N(),h=s("h2"),I=he(O),f=N(),u=s("ion-icon"),this.h()},l(b){e=c(b,"ION-ITEM",{href:!0});var p=E(e);t=c(p,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(a),o=T(p),n=c(p,"ION-LABEL",{class:!0});var m=E(n);i=c(m,"P",{"data-svelte-h":!0}),J(i)!=="svelte-1ub9uzw"&&(i.textContent=d),_=T(m),h=c(m,"H2",{});var v=E(h);I=pe(v,O),v.forEach(a),m.forEach(a),f=T(p),u=c(p,"ION-ICON",{icon:!0,slot:!0}),E(u).forEach(a),p.forEach(a),this.h()},h(){g(t,"icon",kt),g(t,"slot","start"),g(n,"class","ion-text-wrap"),g(u,"icon",tt),g(u,"slot","end"),g(e,"href","https://www.google.com/maps/searhc/?api=1&query="+l[10].line2)},m(b,p){H(b,e,p),r(e,t),r(e,o),r(e,n),r(n,i),r(n,_),r(n,h),r(h,I),r(e,f),r(e,u)},p:Ce,d(b){b&&a(e)}}}function Zn(l){let e,t,o,n,i,d="Domicilio",_,h,O=l[10].line1+"",I,f,u,b,p=l[10].line2&&l[10].line2.trim().length,m,v=p&&xn(l);return{c(){e=s("ion-item"),t=s("ion-icon"),o=N(),n=s("ion-label"),i=s("p"),i.textContent=d,_=N(),h=s("h2"),I=he(O),f=N(),u=s("ion-icon"),b=N(),v&&v.c(),m=Ue(),this.h()},l(w){e=c(w,"ION-ITEM",{href:!0});var y=E(e);t=c(y,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(a),o=T(y),n=c(y,"ION-LABEL",{class:!0});var R=E(n);i=c(R,"P",{"data-svelte-h":!0}),J(i)!=="svelte-cbm7q1"&&(i.textContent=d),_=T(R),h=c(R,"H2",{});var B=E(h);I=pe(B,O),B.forEach(a),R.forEach(a),f=T(y),u=c(y,"ION-ICON",{icon:!0,slot:!0}),E(u).forEach(a),y.forEach(a),b=T(w),v&&v.l(w),m=Ue(),this.h()},h(){g(t,"icon",kt),g(t,"slot","start"),g(n,"class","ion-text-wrap"),g(u,"icon",tt),g(u,"slot","end"),g(e,"href","https://www.google.com/maps/search/?api=1&query="+l[10].line1)},m(w,y){H(w,e,y),r(e,t),r(e,o),r(e,n),r(n,i),r(n,_),r(n,h),r(h,I),r(e,f),r(e,u),H(w,b,y),v&&v.m(w,y),H(w,m,y)},p(w,y){p&&v.p(w,y)},d(w){w&&(a(e),a(b),a(m)),v&&v.d(w)}}}function xn(l){let e,t,o,n,i,d="Domicilio Alternativo",_,h,O=l[10].line2+"",I,f,u;return{c(){e=s("ion-item"),t=s("ion-icon"),o=N(),n=s("ion-label"),i=s("p"),i.textContent=d,_=N(),h=s("h2"),I=he(O),f=N(),u=s("ion-icon"),this.h()},l(b){e=c(b,"ION-ITEM",{href:!0});var p=E(e);t=c(p,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(a),o=T(p),n=c(p,"ION-LABEL",{class:!0});var m=E(n);i=c(m,"P",{"data-svelte-h":!0}),J(i)!=="svelte-1ub9uzw"&&(i.textContent=d),_=T(m),h=c(m,"H2",{});var v=E(h);I=pe(v,O),v.forEach(a),m.forEach(a),f=T(p),u=c(p,"ION-ICON",{icon:!0,slot:!0}),E(u).forEach(a),p.forEach(a),this.h()},h(){g(t,"icon",kt),g(t,"slot","start"),g(n,"class","ion-text-wrap"),g(u,"icon",tt),g(u,"slot","end"),g(e,"href","https://www.google.com/maps/search/?api=1&query="+l[10].line2)},m(b,p){H(b,e,p),r(e,t),r(e,o),r(e,n),r(n,i),r(n,_),r(n,h),r(h,I),r(e,f),r(e,u)},p:Ce,d(b){b&&a(e)}}}function St(l){let e,t,o,n,i,d="Contacto del Cliente",_,h,O,I,f=l[2]&&l[2]==="1"&&Mt(l);return{c(){e=s("ion-item"),t=s("ion-icon"),o=N(),n=s("ion-label"),i=s("p"),i.textContent=d,_=N(),h=s("h2"),O=he(l[6]),I=N(),f&&f.c(),this.h()},l(u){e=c(u,"ION-ITEM",{});var b=E(e);t=c(b,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(a),o=T(b),n=c(b,"ION-LABEL",{class:!0});var p=E(n);i=c(p,"P",{"data-svelte-h":!0}),J(i)!=="svelte-1utsyb6"&&(i.textContent=d),_=T(p),h=c(p,"H2",{});var m=E(h);O=pe(m,l[6]),m.forEach(a),p.forEach(a),I=T(b),f&&f.l(b),b.forEach(a),this.h()},h(){g(t,"icon",En),g(t,"slot","start"),g(n,"class","ion-text-wrap")},m(u,b){H(u,e,b),r(e,t),r(e,o),r(e,n),r(n,i),r(n,_),r(n,h),r(h,O),r(e,I),f&&f.m(e,null)},p(u,b){b[0]&64&&Be(O,u[6]),u[2]&&u[2]==="1"?f?f.p(u,b):(f=Mt(u),f.c(),f.m(e,null)):f&&(f.d(1),f=null)},d(u){u&&a(e),f&&f.d()}}}function Mt(l){let e,t=`<ion-icon icon="${Nn}" slot="start"></ion-icon>
                        Notificar Cliente`,o,n;return{c(){e=s("ion-button"),e.innerHTML=t,this.h()},l(i){e=c(i,"ION-BUTTON",{fill:!0,style:!0,"data-svelte-h":!0}),J(e)!=="svelte-w3qtwm"&&(e.innerHTML=t),this.h()},h(){g(e,"fill","outline"),F(e,"margin-left","16px")},m(i,d){H(i,e,d),o||(n=se(e,"click",l[14]),o=!0)},p:Ce,d(i){i&&a(e),o=!1,n()}}}function Pt(l){let e,t,o,n,i,d="Notas de ubicación",_,h,O;return{c(){e=s("ion-item"),t=s("ion-icon"),o=N(),n=s("ion-label"),i=s("p"),i.textContent=d,_=N(),h=s("h2"),O=he(l[7]),this.h()},l(I){e=c(I,"ION-ITEM",{});var f=E(e);t=c(f,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(a),o=T(f),n=c(f,"ION-LABEL",{class:!0});var u=E(n);i=c(u,"P",{"data-svelte-h":!0}),J(i)!=="svelte-nhm2ft"&&(i.textContent=d),_=T(u),h=c(u,"H2",{});var b=E(h);O=pe(b,l[7]),b.forEach(a),u.forEach(a),f.forEach(a),this.h()},h(){g(t,"icon",on),g(t,"slot","start"),g(n,"class","ion-text-wrap")},m(I,f){H(I,e,f),r(e,t),r(e,o),r(e,n),r(n,i),r(n,_),r(n,h),r(h,O)},p(I,f){f[0]&128&&Be(O,I[7])},d(I){I&&a(e)}}}function $n(l){let e,t,o,n,i,d="Horarios",_,h,O=l[10].schedule+"",I;return{c(){e=s("ion-item"),t=s("ion-icon"),o=N(),n=s("ion-label"),i=s("p"),i.textContent=d,_=N(),h=s("h2"),I=he(O),this.h()},l(f){e=c(f,"ION-ITEM",{});var u=E(e);t=c(u,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(a),o=T(u),n=c(u,"ION-LABEL",{});var b=E(n);i=c(b,"P",{"data-svelte-h":!0}),J(i)!=="svelte-11q7hm5"&&(i.textContent=d),_=T(b),h=c(b,"H2",{});var p=E(h);I=pe(p,O),p.forEach(a),b.forEach(a),u.forEach(a),this.h()},h(){g(t,"icon",In),g(t,"slot","start")},m(f,u){H(f,e,u),r(e,t),r(e,o),r(e,n),r(n,i),r(n,_),r(n,h),r(h,I)},p:Ce,d(f){f&&a(e)}}}function eo(l){let e,t,o,n,i,d="Notas del operador",_,h,O=l[10].driver_comments+"",I;return{c(){e=s("ion-item"),t=s("ion-icon"),o=N(),n=s("ion-label"),i=s("p"),i.textContent=d,_=N(),h=s("h2"),I=he(O),this.h()},l(f){e=c(f,"ION-ITEM",{});var u=E(e);t=c(u,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(a),o=T(u),n=c(u,"ION-LABEL",{});var b=E(n);i=c(b,"P",{"data-svelte-h":!0}),J(i)!=="svelte-1yk9qp4"&&(i.textContent=d),_=T(b),h=c(b,"H2",{});var p=E(h);I=pe(p,O),p.forEach(a),b.forEach(a),u.forEach(a),this.h()},h(){g(t,"icon",ln),g(t,"slot","start")},m(f,u){H(f,e,u),r(e,t),r(e,o),r(e,n),r(n,i),r(n,_),r(n,h),r(h,I)},p:Ce,d(f){f&&a(e)}}}function to(l){let e,t=l[10].logistic_comments!="<br>"&&no(l);return{c(){t&&t.c(),e=Ue()},l(o){t&&t.l(o),e=Ue()},m(o,n){t&&t.m(o,n),H(o,e,n)},p(o,n){o[10].logistic_comments!="<br>"&&t.p(o,n)},d(o){o&&a(e),t&&t.d(o)}}}function no(l){let e,t,o,n,i,d="Comentarios logísticos",_,h,O=l[10].logistic_comments+"",I;return{c(){e=s("ion-item"),t=s("ion-icon"),o=N(),n=s("ion-label"),i=s("p"),i.textContent=d,_=N(),h=s("h2"),I=he(O),this.h()},l(f){e=c(f,"ION-ITEM",{});var u=E(e);t=c(u,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(a),o=T(u),n=c(u,"ION-LABEL",{class:!0});var b=E(n);i=c(b,"P",{"data-svelte-h":!0}),J(i)!=="svelte-1iz85r6"&&(i.textContent=d),_=T(b),h=c(b,"H2",{});var p=E(h);I=pe(p,O),p.forEach(a),b.forEach(a),u.forEach(a),this.h()},h(){g(t,"icon",on),g(t,"slot","start"),g(n,"class","ion-text-wrap")},m(f,u){H(f,e,u),r(e,t),r(e,o),r(e,n),r(n,i),r(n,_),r(n,h),r(h,I)},p:Ce,d(f){f&&a(e)}}}function At(l){let e,t,o,n;return{c(){e=s("ion-item"),t=s("ion-icon"),o=N(),n=s("ion-textarea"),this.h()},l(i){e=c(i,"ION-ITEM",{});var d=E(e);t=c(d,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(a),o=T(d),n=c(d,"ION-TEXTAREA",{placeholder:!0}),E(n).forEach(a),d.forEach(a),this.h()},h(){g(t,"icon",kn),g(t,"slot","start"),g(n,"placeholder","Escribe el motivo...")},m(i,d){H(i,e,d),r(e,t),r(e,o),r(e,n),l[17](n)},p:Ce,d(i){i&&a(e),l[17](null)}}}function Bt(l){let e,t=`<ion-icon icon="${Tn}" slot="start"></ion-icon>
                    Ingreso`,o,n;return{c(){e=s("ion-button"),e.innerHTML=t,this.h()},l(i){e=c(i,"ION-BUTTON",{id:!0,style:!0,"data-svelte-h":!0}),J(e)!=="svelte-151bg1z"&&(e.innerHTML=t),this.h()},h(){g(e,"id","checkInBtn"),F(e,"flex","1")},m(i,d){H(i,e,d),o||(n=se(e,"click",l[15]),o=!0)},p:Ce,d(i){i&&a(e),o=!1,n()}}}function Dt(l){let e,t,o,n,i,d;return{c(){e=s("ion-button"),t=s("ion-icon"),o=he(`
                    Salida`),this.h()},l(_){e=c(_,"ION-BUTTON",{id:!0,style:!0,disabled:!0});var h=E(e);t=c(h,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(a),o=pe(h,`
                    Salida`),h.forEach(a),this.h()},h(){g(t,"icon",On),g(t,"slot","start"),g(e,"id","checkOutBtn"),F(e,"flex","1"),g(e,"disabled",n=l[5]===!1)},m(_,h){H(_,e,h),r(e,t),r(e,o),i||(d=se(e,"click",l[16]),i=!0)},p(_,h){h[0]&32&&n!==(n=_[5]===!1)&&g(e,"disabled",n)},d(_){_&&a(e),i=!1,d()}}}function zt(l){let e,t='<ion-spinner name="dots"></ion-spinner>';return{c(){e=s("section"),e.innerHTML=t,this.h()},l(o){e=c(o,"SECTION",{style:!0,"data-svelte-h":!0}),J(e)!=="svelte-1sj3e0"&&(e.innerHTML=t),this.h()},h(){F(e,"text-align","center")},m(o,n){H(o,e,n)},d(o){o&&a(e)}}}function Ht(l){let e,t,o;return{c(){e=s("section"),t=s("ion-img"),this.h()},l(n){e=c(n,"SECTION",{});var i=E(e);t=c(i,"ION-IMG",{src:!0,alt:!0,style:!0}),E(t).forEach(a),i.forEach(a),this.h()},h(){dt(t.src,o=l[1])||g(t,"src",o),g(t,"alt","Evidencia fotográfica"),F(t,"max-width","100%"),F(t,"margin-top","16px")},m(n,i){H(n,e,i),r(e,t)},p(n,i){i[0]&2&&!dt(t.src,o=n[1])&&g(t,"src",o)},d(n){n&&a(e)}}}function oo(l){let e,t,o,n,i="Cancelar",d,_,h=l[10].title+"",O,I,f,u,b="Confirmar",p,m,v,w,y,R,B,D,C="Negocio",L,P,k=l[10].client_name+"",S,U,M=l[10].client_phone&&l[10].client_phone.trim().length,V,q,j,te,me=l[10].schedule&&l[10].schedule.trim().length,ce,W,x=l[10].logistic_comments&&l[10].logistic_comments.trim().length,ne,le,A,G,X,$,de,K,re,Ne,Me,Ie,ve,De,ze,qe="Subir Evidencia",Fe,Pe,Ae,z,Z,Te,oe=M&&Qn(l);function ie(Q,ke){if(Q[10].line1&&Q[10].line1.trim().length)return Zn;if(Q[10].line2&&Q[10].line2.trim().length)return Yn}let ae=ie(l),fe=ae&&ae(l),_e=l[6]&&St(l),be=l[7]&&l[7]!=="<br>"&&Pt(l),ue=me&&$n(l),ee=l[10].driver_comments&&eo(l),we=x&&to(l),Oe=l[8]&&At(l),ye=l[4]===!0&&Bt(l),Ee=(l[5]===!0||l[5]===!1&&l[4]===!1)&&Dt(l),Le=l[3]&&zt(),Se=l[1]&&Ht(l);return{c(){e=s("ion-header"),t=s("ion-toolbar"),o=s("ion-buttons"),n=s("ion-button"),n.textContent=i,d=N(),_=s("ion-title"),O=he(h),I=N(),f=s("ion-buttons"),u=s("ion-button"),u.textContent=b,p=N(),m=s("ion-content"),v=s("ion-list"),w=s("ion-item"),y=s("ion-icon"),R=N(),B=s("ion-label"),D=s("p"),D.textContent=C,L=N(),P=s("h2"),S=he(k),U=N(),oe&&oe.c(),V=N(),fe&&fe.c(),q=N(),_e&&_e.c(),j=N(),be&&be.c(),te=N(),ue&&ue.c(),ce=N(),ee&&ee.c(),W=N(),we&&we.c(),ne=N(),Oe&&Oe.c(),le=N(),A=s("ion-item"),G=s("ion-icon"),X=N(),$=s("ion-textarea"),de=N(),K=s("section"),ye&&ye.c(),re=N(),Ee&&Ee.c(),Ne=N(),Me=s("section"),Ie=s("ion-button"),ve=s("ion-icon"),De=N(),ze=s("label"),ze.textContent=qe,Fe=N(),Pe=s("input"),Ae=N(),Le&&Le.c(),z=N(),Se&&Se.c(),this.h()},l(Q){e=c(Q,"ION-HEADER",{translucent:!0});var ke=E(e);t=c(ke,"ION-TOOLBAR",{});var Ve=E(t);o=c(Ve,"ION-BUTTONS",{slot:!0});var nt=E(o);n=c(nt,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),J(n)!=="svelte-1f8rjcf"&&(n.textContent=i),nt.forEach(a),d=T(Ve),_=c(Ve,"ION-TITLE",{style:!0,title:!0});var Ot=E(_);O=pe(Ot,h),Ot.forEach(a),I=T(Ve),f=c(Ve,"ION-BUTTONS",{slot:!0});var Nt=E(f);u=c(Nt,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),J(u)!=="svelte-1ida0il"&&(u.textContent=b),Nt.forEach(a),Ve.forEach(a),ke.forEach(a),p=T(Q),m=c(Q,"ION-CONTENT",{fullscreen:!0});var Tt=E(m);v=c(Tt,"ION-LIST",{});var ge=E(v);w=c(ge,"ION-ITEM",{});var st=E(w);y=c(st,"ION-ICON",{icon:!0,slot:!0}),E(y).forEach(a),R=T(st),B=c(st,"ION-LABEL",{});var ct=E(B);D=c(ct,"P",{"data-svelte-h":!0}),J(D)!=="svelte-57b1dg"&&(D.textContent=C),L=T(ct),P=c(ct,"H2",{});var Ct=E(P);S=pe(Ct,k),Ct.forEach(a),ct.forEach(a),st.forEach(a),U=T(ge),oe&&oe.l(ge),V=T(ge),fe&&fe.l(ge),q=T(ge),_e&&_e.l(ge),j=T(ge),be&&be.l(ge),te=T(ge),ue&&ue.l(ge),ce=T(ge),ee&&ee.l(ge),W=T(ge),we&&we.l(ge),ne=T(ge),Oe&&Oe.l(ge),le=T(ge),A=c(ge,"ION-ITEM",{});var ut=E(A);G=c(ut,"ION-ICON",{icon:!0,slot:!0}),E(G).forEach(a),X=T(ut),$=c(ut,"ION-TEXTAREA",{label:!0,placeholder:!0}),E($).forEach(a),ut.forEach(a),de=T(ge),K=c(ge,"SECTION",{style:!0});var ft=E(K);ye&&ye.l(ft),re=T(ft),Ee&&Ee.l(ft),ft.forEach(a),Ne=T(ge),Me=c(ge,"SECTION",{style:!0});var yt=E(Me);Ie=c(yt,"ION-BUTTON",{fill:!0,class:!0,style:!0});var Xe=E(Ie);ve=c(Xe,"ION-ICON",{icon:!0,slot:!0}),E(ve).forEach(a),De=T(Xe),ze=c(Xe,"LABEL",{for:!0,"data-svelte-h":!0}),J(ze)!=="svelte-7lscau"&&(ze.textContent=qe),Fe=T(Xe),Pe=c(Xe,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0}),Xe.forEach(a),yt.forEach(a),Ae=T(ge),Le&&Le.l(ge),z=T(ge),Se&&Se.l(ge),ge.forEach(a),Tt.forEach(a),this.h()},h(){g(n,"color","medium"),g(o,"slot","start"),F(_,"text-align","center"),g(_,"title",l[10].title),g(u,"strong",""),g(f,"slot","end"),g(e,"translucent",""),g(y,"icon",gn),g(y,"slot","start"),g(G,"icon",vt),g(G,"slot","start"),g($,"label","Notas"),g($,"placeholder","Escribe aquí..."),F(K,"display","flex"),F(K,"gap","8px"),F(K,"padding","16px 16px 6px"),g(ve,"icon",nn),g(ve,"slot","start"),Y(ze,"for","eventEvidence"),F(Pe,"display","none"),Y(Pe,"id","eventEvidence"),Y(Pe,"name","fileToUpload"),Y(Pe,"type","file"),Y(Pe,"accept","image/*"),g(Ie,"fill","outline"),g(Ie,"class","loadEvidence"),F(Ie,"flex","1"),F(Me,"display","flex"),F(Me,"gap","8px"),F(Me,"padding","0px 16px"),g(m,"fullscreen","")},m(Q,ke){H(Q,e,ke),r(e,t),r(t,o),r(o,n),r(t,d),r(t,_),r(_,O),r(t,I),r(t,f),r(f,u),H(Q,p,ke),H(Q,m,ke),r(m,v),r(v,w),r(w,y),r(w,R),r(w,B),r(B,D),r(B,L),r(B,P),r(P,S),r(v,U),oe&&oe.m(v,null),r(v,V),fe&&fe.m(v,null),r(v,q),_e&&_e.m(v,null),r(v,j),be&&be.m(v,null),r(v,te),ue&&ue.m(v,null),r(v,ce),ee&&ee.m(v,null),r(v,W),we&&we.m(v,null),r(v,ne),Oe&&Oe.m(v,null),r(v,le),r(v,A),r(A,G),r(A,X),r(A,$),l[18]($),r(v,de),r(v,K),ye&&ye.m(K,null),r(K,re),Ee&&Ee.m(K,null),r(v,Ne),r(v,Me),r(Me,Ie),r(Ie,ve),r(Ie,De),r(Ie,ze),r(Ie,Fe),r(Ie,Pe),r(v,Ae),Le&&Le.m(v,null),r(v,z),Se&&Se.m(v,null),Z||(Te=[se(n,"click",l[12]),se(u,"click",l[13]),se(Pe,"change",l[11])],Z=!0)},p(Q,ke){M&&oe.p(Q,ke),fe&&fe.p(Q,ke),Q[6]?_e?_e.p(Q,ke):(_e=St(Q),_e.c(),_e.m(v,j)):_e&&(_e.d(1),_e=null),Q[7]&&Q[7]!=="<br>"?be?be.p(Q,ke):(be=Pt(Q),be.c(),be.m(v,te)):be&&(be.d(1),be=null),me&&ue.p(Q,ke),Q[10].driver_comments&&ee.p(Q,ke),x&&we.p(Q,ke),Q[8]?Oe?Oe.p(Q,ke):(Oe=At(Q),Oe.c(),Oe.m(v,le)):Oe&&(Oe.d(1),Oe=null),Q[4]===!0?ye?ye.p(Q,ke):(ye=Bt(Q),ye.c(),ye.m(K,re)):ye&&(ye.d(1),ye=null),Q[5]===!0||Q[5]===!1&&Q[4]===!1?Ee?Ee.p(Q,ke):(Ee=Dt(Q),Ee.c(),Ee.m(K,null)):Ee&&(Ee.d(1),Ee=null),Q[3]?Le||(Le=zt(),Le.c(),Le.m(v,z)):Le&&(Le.d(1),Le=null),Q[1]?Se?Se.p(Q,ke):(Se=Ht(Q),Se.c(),Se.m(v,null)):Se&&(Se.d(1),Se=null)},i:Ce,o:Ce,d(Q){Q&&(a(e),a(p),a(m)),oe&&oe.d(),fe&&fe.d(),_e&&_e.d(),be&&be.d(),ue&&ue.d(),ee&&ee.d(),we&&we.d(),Oe&&Oe.d(),l[18](null),ye&&ye.d(),Ee&&Ee.d(),Le&&Le.d(),Se&&Se.d(),Z=!1,Ge(Te)}}}const Rt=/Teléfono:\s*(\d{10,})/;function Ut(l,e){for(let t=0;t<e.length;t++)if(e[t].alias===l)return e[t].val;return""}function io(l,e,t){let o=ht,n=document.querySelector("ion-modal"),i=n.componentProps.delivery,d=n.componentProps.isLast,_=i.driver_comments?i.driver_comments:"",h=i.img?i.img:"",O="",I={latitude:null,longitude:null},f=new Object,u="",b="",p=!1,m=!0,v=!1,w="",y=i.comments_ext,R=!1,B="";it(()=>{V(),D()});function D(){i.date_service?i.date_service&&!i.date_completed&&!i.service_time?(t(4,m=!1),t(5,v=!0)):i.date_service&&i.date_completed&&i.service_time&&(t(4,m=!1),t(5,v=!1)):(t(4,m=!0),t(5,v=!1))}if(i.comments_ext){const W=i.comments_ext.match(Rt);W&&(w=W[1],y=i.comments_ext.replace(Rt,"").trim())}const C=async(W,x)=>{await(await Qe.create({header:W||"Error",message:x||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()},L=async W=>{t(3,p=!0);const ne=W.target.files[0],le=await P(ne);if(le){const A=new FormData;A.append("fileToUpload",le);try{const G=await fetch(`${o}api/admin/manager/upload_img_driver.php`,{method:"POST",body:A});if(G.ok){const X=await G.json();t(1,h=X.img),O=X.img_id}else console.error("File upload failed:",G.statusText)}catch(G){console.error("Error during file upload:",G)}finally{t(3,p=!1)}}},P=async W=>new Promise(x=>{const ne=new FileReader;ne.onload=le=>{const A=new Image;A.src=le.target.result,A.onload=()=>{const G=document.createElement("canvas"),X=G.getContext("2d"),$=800,de=600;let K=A.width,re=A.height;K>$&&(re*=$/K,K=$),re>de&&(K*=de/re,re=de),G.width=K,G.height=re,X.drawImage(A,0,0,K,re),G.toBlob(Ne=>{x(Ne)},"image/jpeg",.7)}},ne.readAsDataURL(W)}),k=()=>{n.dismiss({data:Date.now()})},S=async()=>{try{if(await U()){const x={id_route:i.id_route,id_event:i.id_event,comments:_.value,img:h,img_id:O,lat:I.latitude,lon:I.longitude,...u==="0"&&{approve:"0"},...d&&{isLast:!0}},ne=new FormData;for(const le in x)ne.append(le,x[le]);if(x.img&&x.img_id){const le=await fetch(`${o}api/admin/evidence/send_evidence.php`,{method:"POST",body:ne});k()}else i.img?k():C("Información incompleta","Cargar evidencia fotográfica faltante para completar parada.")}}catch(W){console.error("Error fetching data:",W)}},U=async()=>navigator.geolocation?new Promise((W,x)=>{navigator.geolocation.getCurrentPosition(ne=>{I.latitude=ne.coords.latitude,I.longitude=ne.coords.longitude,W(!0)},ne=>{console.error("Error getting location:",ne),W(!1)})}):(console.error("Geolocation is not supported by your browser"),!1);async function M(W){W.stopPropagation();const x=new FormData;x.append("client_phone",w),x.append("client_name",i.title),x.append("delivery_phone",i.client_phone),x.append("enterprise_name",i.enterprise_name);try{const ne=await fetch(`${o}api/admin/message_central/send_sms.php`,{method:"POST",body:x});if(ne.ok){const le=await ne.json();C("SMS enviado","Se envío correctamente un SMS a "+i.title+" con número de teléfono: "+w)}else C("SMS no enviado","Hubo un error al enviar SMS a "+i.title+" con número de teléfono: "+phoneNumber0+". Por favor contacte a soporte.")}catch(ne){console.error("Error during file upload:",ne)}}const V=async W=>{if(i.id_enterprise){const x=new FormData;x.append("id_enterprise",i.id_enterprise);try{const ne=await fetch(`${o}api/admin/enterprise/enterprise_settings.php`,{method:"POST",body:x});ne.ok?(f=(await ne.json()).nodos,u=Ut("stops_wait_approval",f),t(2,b=Ut("sms_active",f))):console.error("File upload failed:",ne.statusText)}catch(ne){console.error("Error during file upload:",ne)}}};function q(){t(4,m=!1),t(5,v=!0),te(i.id_event,"checkin")}function j(){t(5,v=!1),t(4,m=!1),te(i.id_event,"checkout")}async function te(W,x){if(x){const ne=new FormData;ne.append("type",x),ne.append("id_event",W);try{const le=await fetch(`${o}api/admin/route/record_check_date.php`,{method:"POST",body:ne});if(le.ok){const A=await le.json();A.minutes&&C("Tiempo por parada","Completaste la parada en "+A.minutes+" minutos.")}else console.error("File upload failed:",le.statusText)}catch(le){console.error("Error during file upload:",le)}finally{}}}function me(W){He[W?"unshift":"push"](()=>{B=W,t(9,B)})}function ce(W){He[W?"unshift":"push"](()=>{_=W,t(0,_)})}return[_,h,b,p,m,v,w,y,R,B,i,L,k,S,M,q,j,me,ce]}class lo extends $e{constructor(e){super(),et(this,e,io,oo,xe,{},null,[-1,-1])}}function Ft(l){let e;return{c(){e=s("ion-spinner"),this.h()},l(t){e=c(t,"ION-SPINNER",{name:!0}),E(e).forEach(a),this.h()},h(){g(e,"name","dots")},m(t,o){H(t,e,o)},d(t){t&&a(e)}}}function qt(l){let e,t,o;return{c(){e=s("section"),t=s("ion-img"),this.h()},l(n){e=c(n,"SECTION",{});var i=E(e);t=c(i,"ION-IMG",{src:!0,alt:!0,style:!0}),E(t).forEach(a),i.forEach(a),this.h()},h(){dt(t.src,o=l[0])||g(t,"src",o),g(t,"alt","Evidencia fotográfica"),F(t,"max-width","100%"),F(t,"margin-top","16px")},m(n,i){H(n,e,i),r(e,t)},p(n,i){i&1&&!dt(t.src,o=n[0])&&g(t,"src",o)},d(n){n&&a(e)}}}function ro(l){let e,t,o,n,i="Cancelar",d,_,h="AGREGAR GASTO",O,I,f,u,b,p,m,v,w,y,R,B,D,C,L,P,k,S,U='Tipo de pago <ion-text color="danger">(Obligatorio)</ion-text>',M,V,q="Efectivo",j,te,me="Tarjeta",ce,W,x="Transferencia",ne,le,A,G,X,$,de,K,re,Ne,Me=`<ion-icon icon="${nn}" slot="start"></ion-icon>
                        Subir Evidencia`,Ie,ve,De,ze,qe,Fe,Pe,Ae,z="Confirmar",Z,Te,oe=l[5]&&Ft(),ie=l[0]&&qt(l);return{c(){e=s("ion-header"),t=s("ion-toolbar"),o=s("ion-buttons"),n=s("ion-button"),n.textContent=i,d=N(),_=s("ion-title"),_.textContent=h,O=N(),I=s("ion-content"),f=s("ion-list"),u=s("ion-item"),b=s("ion-icon"),p=N(),m=s("ion-input"),v=N(),w=s("ion-item"),y=s("ion-icon"),R=N(),B=s("ion-input"),D=N(),C=s("ion-item"),L=s("ion-icon"),P=N(),k=s("ion-select"),S=s("div"),S.innerHTML=U,M=N(),V=s("ion-select-option"),V.textContent=q,j=N(),te=s("ion-select-option"),te.textContent=me,ce=N(),W=s("ion-select-option"),W.textContent=x,ne=N(),le=s("ion-item"),A=s("ion-icon"),G=N(),X=s("ion-textarea"),$=N(),de=s("section"),K=s("label"),re=s("ion-button"),Ne=s("label"),Ne.innerHTML=Me,Ie=N(),ve=s("input"),De=N(),oe&&oe.c(),ze=N(),ie&&ie.c(),qe=N(),Fe=s("ion-footer"),Pe=s("ion-toolbar"),Ae=s("ion-button"),Ae.textContent=z,this.h()},l(ae){e=c(ae,"ION-HEADER",{translucent:!0});var fe=E(e);t=c(fe,"ION-TOOLBAR",{});var _e=E(t);o=c(_e,"ION-BUTTONS",{slot:!0});var be=E(o);n=c(be,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),J(n)!=="svelte-1f8rjcf"&&(n.textContent=i),be.forEach(a),d=T(_e),_=c(_e,"ION-TITLE",{title:!0,"data-svelte-h":!0}),J(_)!=="svelte-efps2s"&&(_.textContent=h),_e.forEach(a),fe.forEach(a),O=T(ae),I=c(ae,"ION-CONTENT",{fullscreen:!0});var ue=E(I);f=c(ue,"ION-LIST",{});var ee=E(f);u=c(ee,"ION-ITEM",{});var we=E(u);b=c(we,"ION-ICON",{icon:!0,slot:!0}),E(b).forEach(a),p=T(we),m=c(we,"ION-INPUT",{label:!0,type:!0,placeholder:!0,value:!0}),E(m).forEach(a),we.forEach(a),v=T(ee),w=c(ee,"ION-ITEM",{});var Oe=E(w);y=c(Oe,"ION-ICON",{icon:!0,slot:!0}),E(y).forEach(a),R=T(Oe),B=c(Oe,"ION-INPUT",{label:!0,type:!0,value:!0}),E(B).forEach(a),Oe.forEach(a),D=T(ee),C=c(ee,"ION-ITEM",{});var ye=E(C);L=c(ye,"ION-ICON",{icon:!0,slot:!0}),E(L).forEach(a),P=T(ye),k=c(ye,"ION-SELECT",{placeholder:!0,value:!0});var Ee=E(k);S=c(Ee,"DIV",{slot:!0,"data-svelte-h":!0}),J(S)!=="svelte-wl764p"&&(S.innerHTML=U),M=T(Ee),V=c(Ee,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),J(V)!=="svelte-i9crym"&&(V.textContent=q),j=T(Ee),te=c(Ee,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),J(te)!=="svelte-fx0z11"&&(te.textContent=me),ce=T(Ee),W=c(Ee,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),J(W)!=="svelte-1c24jf2"&&(W.textContent=x),Ee.forEach(a),ye.forEach(a),ne=T(ee),le=c(ee,"ION-ITEM",{});var Le=E(le);A=c(Le,"ION-ICON",{icon:!0,slot:!0}),E(A).forEach(a),G=T(Le),X=c(Le,"ION-TEXTAREA",{label:!0,placeholder:!0}),E(X).forEach(a),Le.forEach(a),$=T(ee),de=c(ee,"SECTION",{});var Se=E(de);K=c(Se,"LABEL",{for:!0,style:!0});var Q=E(K);re=c(Q,"ION-BUTTON",{fill:!0,size:!0,class:!0,expand:!0});var ke=E(re);Ne=c(ke,"LABEL",{for:!0,style:!0,"data-svelte-h":!0}),J(Ne)!=="svelte-1m9yw22"&&(Ne.innerHTML=Me),Ie=T(ke),ve=c(ke,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0}),ke.forEach(a),Q.forEach(a),Se.forEach(a),De=T(ee),oe&&oe.l(ee),ze=T(ee),ie&&ie.l(ee),ee.forEach(a),ue.forEach(a),qe=T(ae),Fe=c(ae,"ION-FOOTER",{});var Ve=E(Fe);Pe=c(Ve,"ION-TOOLBAR",{});var nt=E(Pe);Ae=c(nt,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),J(Ae)!=="svelte-1c7dl3f"&&(Ae.textContent=z),nt.forEach(a),Ve.forEach(a),this.h()},h(){g(n,"color","medium"),g(o,"slot","start"),g(_,"title",""),g(e,"translucent",""),g(b,"icon",ln),g(b,"slot","start"),g(m,"label","Concepto"),g(m,"type","text"),g(m,"placeholder","Escribe aquí..."),g(m,"value",l[6]?l[6]:""),g(y,"icon",vt),g(y,"slot","start"),g(B,"label","Cantidad"),g(B,"type","number"),g(B,"value",l[7]?l[7]:""),g(L,"icon",Cn),g(L,"slot","start"),Y(S,"slot","label"),g(V,"value","cash"),g(te,"value","card"),g(W,"value","transfer"),g(k,"placeholder","Tipo de pago"),g(k,"value",l[8]?l[8]:""),g(A,"icon",vt),g(A,"slot","start"),g(X,"label","Comentarios"),g(X,"placeholder","Escribe aquí..."),Y(Ne,"for","eventEvidence"),F(Ne,"width","100%"),F(Ne,"padding","8px"),F(ve,"display","none"),Y(ve,"id","eventEvidence"),Y(ve,"name","fileToUpload"),Y(ve,"type","file"),Y(ve,"accept","image/*"),g(re,"fill","outline"),g(re,"size","small"),g(re,"class","loadEvidence"),g(re,"expand","block"),Y(K,"for","eventEvidence"),F(K,"display","block"),F(K,"width","100%"),g(I,"fullscreen",""),g(Ae,"fill","outline"),g(Ae,"color","tertiary"),g(Ae,"strong",""),F(Ae,"width","99%"),F(Ae,"height","auto")},m(ae,fe){H(ae,e,fe),r(e,t),r(t,o),r(o,n),r(t,d),r(t,_),H(ae,O,fe),H(ae,I,fe),r(I,f),r(f,u),r(u,b),r(u,p),r(u,m),l[12](m),r(f,v),r(f,w),r(w,y),r(w,R),r(w,B),l[13](B),r(f,D),r(f,C),r(C,L),r(C,P),r(C,k),r(k,S),r(k,M),r(k,V),r(k,j),r(k,te),r(k,ce),r(k,W),l[14](k),r(f,ne),r(f,le),r(le,A),r(le,G),r(le,X),l[15](X),r(f,$),r(f,de),r(de,K),r(K,re),r(re,Ne),r(re,Ie),r(re,ve),r(f,De),oe&&oe.m(f,null),r(f,ze),ie&&ie.m(f,null),H(ae,qe,fe),H(ae,Fe,fe),r(Fe,Pe),r(Pe,Ae),Z||(Te=[se(n,"click",l[10]),se(ve,"change",l[9]),se(Ae,"click",l[11])],Z=!0)},p(ae,[fe]){ae[5]?oe||(oe=Ft(),oe.c(),oe.m(f,ze)):oe&&(oe.d(1),oe=null),ae[0]?ie?ie.p(ae,fe):(ie=qt(ae),ie.c(),ie.m(f,null)):ie&&(ie.d(1),ie=null)},i:Ce,o:Ce,d(ae){ae&&(a(e),a(O),a(I),a(qe),a(Fe)),l[12](null),l[13](null),l[14](null),l[15](null),oe&&oe.d(),ie&&ie.d(),Z=!1,Ge(Te)}}}function ao(l,e,t){let o=ht,n=document.querySelector("ion-modal"),i=n.componentProps.routeId,d=n.componentProps.ex_concept,_=n.componentProps.ex_amount,h=n.componentProps.ex_type,O=n.componentProps.id_expense,I="",f="",u="",b=0,p="",m="",v=!1;it(()=>{});const w=async(S,U)=>{await(await Qe.create({header:S,message:U,buttons:[{text:"Cerrar"}]})).present()},y=async S=>{t(5,v=!0);const M=S.target.files[0],V=await R(M);if(V){const q=new FormData;q.append("fileToUpload",V);try{const j=await fetch(`${o}api/admin/manager/upload_img_driver.php`,{method:"POST",body:q});if(j.ok){const te=await j.json();t(0,I=te.img),f=te.img_id}else console.error("File upload failed:",j.statusText)}catch(j){console.error("Error during file upload:",j)}finally{t(5,v=!1)}}},R=async S=>new Promise(U=>{const M=new FileReader;M.onload=V=>{const q=new Image;q.src=V.target.result,q.onload=()=>{const j=document.createElement("canvas"),te=j.getContext("2d"),me=800,ce=600;let W=q.width,x=q.height;W>me&&(x*=me/W,W=me),x>ce&&(W*=ce/x,x=ce),j.width=W,j.height=x,te.drawImage(q,0,0,W,x),j.toBlob(ne=>{U(ne)},"image/jpeg",.7)}},M.readAsDataURL(S)}),B=()=>{at.dismiss()},D=()=>{var S=new Object;S.id_route=i,S.comments=p.value,S.type=u.value,S.img=I,S.img_id=f,S.amount=b.value,S.concept=m.value,S.status="done",S.id_expense=O||"null";const U=new FormData;for(const M in S)U.append(M,S[M]);!f||!I||!p.value||!b.value||!m.value?w("Datos incompletos","Llena los datos requeridos para completar el registro"):fetch(`${o}api/admin/expenses/add_expense.php`,{method:"POST",body:U}).then(M=>M.json()).then(M=>{B()}).catch(M=>{console.error("Error fetching data:",M)})};function C(S){He[S?"unshift":"push"](()=>{m=S,t(4,m)})}function L(S){He[S?"unshift":"push"](()=>{b=S,t(2,b)})}function P(S){He[S?"unshift":"push"](()=>{u=S,t(1,u)})}function k(S){He[S?"unshift":"push"](()=>{p=S,t(3,p)})}return[I,u,b,p,m,v,d,_,h,y,B,D,C,L,P,k]}class bt extends $e{constructor(e){super(),et(this,e,ao,ro,xe,{})}}function jt(l,e,t){const o=l.slice();return o[7]=e[t],o}function so(l){let e,t="Cargar gasto",o,n;function i(...d){return l[4](l[7],...d)}return{c(){e=s("ion-button"),e.textContent=t,this.h()},l(d){e=c(d,"ION-BUTTON",{fill:!0,size:!0,"aria-selected":!0,"data-svelte-h":!0}),J(e)!=="svelte-175aelj"&&(e.textContent=t),this.h()},h(){g(e,"fill","outline"),g(e,"size","small"),g(e,"aria-selected","")},m(d,_){H(d,e,_),o||(n=se(e,"click",i),o=!0)},p(d,_){l=d},d(d){d&&a(e),o=!1,n()}}}function co(l){let e,t="Gasto completado";return{c(){e=s("ion-button"),e.textContent=t,this.h()},l(o){e=c(o,"ION-BUTTON",{fill:!0,size:!0,"aria-selected":!0,"data-svelte-h":!0}),J(e)!=="svelte-tlger7"&&(e.textContent=t),this.h()},h(){g(e,"fill","solid"),g(e,"size","small"),g(e,"aria-selected","")},m(o,n){H(o,e,n)},p:Ce,d(o){o&&a(e)}}}function Vt(l,e){let t,o,n,i=e[7].concept+"",d,_,h;function O(u,b){return u[7].status=="done"?co:so}let f=O(e)(e);return{key:l,first:null,c(){t=s("ion-item"),o=s("ion-label"),n=s("p"),d=he(i),_=N(),f.c(),h=N(),this.h()},l(u){t=c(u,"ION-ITEM",{});var b=E(t);o=c(b,"ION-LABEL",{style:!0});var p=E(o);n=c(p,"P",{style:!0});var m=E(n);d=pe(m,i),m.forEach(a),p.forEach(a),_=T(b),f.l(b),h=T(b),b.forEach(a),this.h()},h(){F(n,"margin-left","10px"),F(o,"display","flex"),this.first=t},m(u,b){H(u,t,b),r(t,o),r(o,n),r(n,d),r(t,_),f.m(t,null),r(t,h)},p(u,b){e=u,f.p(e,b)},d(u){u&&a(t),f.d()}}}function uo(l){let e,t,o,n,i=`<ion-icon style="font-size: 25px!important;" icon="${yn}"></ion-icon>`,d,_,h="LISTA DE GASTOS",O,I,f,u=[],b=new Map,p,m,v,w="Cerrar",y,R,B=je(l[0]);const D=C=>C[7].id_expenses;for(let C=0;C<B.length;C+=1){let L=jt(l,B,C),P=D(L);b.set(P,u[C]=Vt(P,L))}return{c(){e=s("ion-header"),t=s("ion-toolbar"),o=s("ion-buttons"),n=s("ion-button"),n.innerHTML=i,d=N(),_=s("ion-title"),_.textContent=h,O=N(),I=s("ion-content"),f=s("ion-list");for(let C=0;C<u.length;C+=1)u[C].c();p=N(),m=s("ion-footer"),v=s("ion-button"),v.textContent=w,this.h()},l(C){e=c(C,"ION-HEADER",{translucent:!0});var L=E(e);t=c(L,"ION-TOOLBAR",{});var P=E(t);o=c(P,"ION-BUTTONS",{slot:!0});var k=E(o);n=c(k,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),J(n)!=="svelte-160xz3i"&&(n.innerHTML=i),k.forEach(a),d=T(P),_=c(P,"ION-TITLE",{"data-svelte-h":!0}),J(_)!=="svelte-1phn90x"&&(_.textContent=h),P.forEach(a),L.forEach(a),O=T(C),I=c(C,"ION-CONTENT",{fullscreen:!0});var S=E(I);f=c(S,"ION-LIST",{});var U=E(f);for(let V=0;V<u.length;V+=1)u[V].l(U);U.forEach(a),S.forEach(a),p=T(C),m=c(C,"ION-FOOTER",{});var M=E(m);v=c(M,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),J(v)!=="svelte-zv7v83"&&(v.textContent=w),M.forEach(a),this.h()},h(){g(n,"color","medium"),g(o,"slot","end"),g(e,"translucent",""),g(I,"fullscreen",""),g(v,"fill","outline"),g(v,"color","tertiary"),g(v,"strong",""),F(v,"width","99%"),F(v,"height","auto")},m(C,L){H(C,e,L),r(e,t),r(t,o),r(o,n),r(t,d),r(t,_),H(C,O,L),H(C,I,L),r(I,f);for(let P=0;P<u.length;P+=1)u[P]&&u[P].m(f,null);H(C,p,L),H(C,m,L),r(m,v),y||(R=[se(n,"click",l[3]),se(v,"click",l[1])],y=!0)},p(C,[L]){L&5&&(B=je(C[0]),u=lt(u,L,D,1,C,B,b,f,rt,Vt,null,jt))},i:Ce,o:Ce,d(C){C&&(a(e),a(O),a(I),a(p),a(m));for(let L=0;L<u.length;L+=1)u[L].d();y=!1,Ge(R)}}}function fo(l){let e=document.querySelector("ion-modal");e.componentProps.routeId;let t=e.componentProps.expenses;it(()=>{});const o=()=>{at.dismiss()};function n(_,h,O,I,f){e.componentProps.ex_amount=O,e.componentProps.ex_concept=h,e.componentProps.ex_type=I,e.componentProps.id_expense=f,We("modal-expense",bt,{amount:O,concept:h,type:I,id_expense:f}).then(()=>{}),o()}return[t,o,n,_=>{We("modal-expense",bt,{routeId:_}).then(h=>{}),o()},(_,h)=>n(h,_.concept,_.amount,_.type,_.id_expenses)]}class _o extends $e{constructor(e){super(),et(this,e,fo,uo,xe,{})}}const{document:Gt}=Bn;function Kt(l,e,t){const o=l.slice();return o[36]=e[t],o}function Wt(l,e,t){const o=l.slice();return o[36]=e[t],o[38]=t,o}function Xt(l,e,t){const o=l.slice();return o[36]=e[t],o[38]=t,o}function Jt(l){let e,t;return e=new Mn({props:{$$slots:{default:[Eo]},$$scope:{ctx:l}}}),{c(){dn(e.$$.fragment)},l(o){hn(e.$$.fragment,o)},m(o,n){pn(e,o,n),t=!0},p(o,n){const i={};n[0]&1019|n[1]&2048&&(i.$$scope={dirty:n,ctx:o}),e.$set(i)},i(o){t||(_t(e.$$.fragment,o),t=!0)},o(o){mt(e.$$.fragment,o),t=!1},d(o){mn(e,o)}}}function ho(l){let e,t='<div id="g_map" style="width: 100%; height: 100vh;"></div>';return{c(){e=s("ion-content"),e.innerHTML=t},l(o){e=c(o,"ION-CONTENT",{"data-svelte-h":!0}),J(e)!=="svelte-1ydw6i9"&&(e.innerHTML=t)},m(o,n){H(o,e,n)},p:Ce,d(o){o&&a(e)}}}function po(l){let e;function t(i,d){if(i[7].length>0)return vo;if(!i[3])return mo}let o=t(l),n=o&&o(l);return{c(){n&&n.c(),e=Ue()},l(i){n&&n.l(i),e=Ue()},m(i,d){n&&n.m(i,d),H(i,e,d)},p(i,d){o===(o=t(i))&&n?n.p(i,d):(n&&n.d(1),n=o&&o(i),n&&(n.c(),n.m(e.parentNode,e)))},d(i){i&&a(e),n&&n.d(i)}}}function mo(l){let e,t,o,n='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Jala para actualizar" refreshing-spinner="circles" refreshing-text="Actualizando..."></ion-refresher-content>',i,d,_=[],h=new Map,O,I,f=l[4]&&Qt(l),u=je(l[5]);const b=p=>p[36].id_event;for(let p=0;p<u.length;p+=1){let m=Kt(l,u,p),v=b(m);h.set(v,_[p]=Zt(v,m))}return{c(){f&&f.c(),e=N(),t=s("ion-content"),o=s("ion-refresher"),o.innerHTML=n,i=N(),d=s("ion-list");for(let p=0;p<_.length;p+=1)_[p].c();this.h()},l(p){f&&f.l(p),e=T(p),t=c(p,"ION-CONTENT",{});var m=E(t);o=c(m,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),J(o)!=="svelte-1srnbs3"&&(o.innerHTML=n),i=T(m),d=c(m,"ION-LIST",{});var v=E(d);for(let w=0;w<_.length;w+=1)_[w].l(v);v.forEach(a),m.forEach(a),this.h()},h(){g(o,"slot","fixed")},m(p,m){f&&f.m(p,m),H(p,e,m),H(p,t,m),r(t,o),l[26](o),r(t,i),r(t,d);for(let v=0;v<_.length;v+=1)_[v]&&_[v].m(d,null);O||(I=se(o,"ionRefresh",l[10]),O=!0)},p(p,m){p[4]?f?f.p(p,m):(f=Qt(p),f.c(),f.m(e.parentNode,e)):f&&(f.d(1),f=null),m[0]&167968&&(u=je(p[5]),_=lt(_,m,b,1,p,u,h,d,rt,Zt,null,Kt))},d(p){p&&(a(e),a(t)),f&&f.d(p),l[26](null);for(let m=0;m<_.length;m+=1)_[m].d();O=!1,I()}}}function vo(l){let e,t;function o(d,_){return _[0]&144&&(e=null),e==null&&(e=!!(d[7].filter(ko).every(Oo)&&!d[4])),e?bo:go}let n=o(l,[-1,-1]),i=n(l);return{c(){i.c(),t=Ue()},l(d){i.l(d),t=Ue()},m(d,_){i.m(d,_),H(d,t,_)},p(d,_){n===(n=o(d,_))&&i?i.p(d,_):(i.d(1),i=n(d),i&&(i.c(),i.m(t.parentNode,t)))},d(d){d&&a(t),i.d(d)}}}function Qt(l){let e=l[13]("",l[1],l[0])+"",t;return{c(){t=he(e)},l(o){t=pe(o,e)},m(o,n){H(o,t,n)},p(o,n){n[0]&3&&e!==(e=o[13]("",o[1],o[0])+"")&&Be(t,e)},d(o){o&&a(t)}}}function Yt(l){let e;return{c(){e=s("span"),this.h()},l(t){e=c(t,"SPAN",{class:!0}),E(e).forEach(a),this.h()},h(){Y(e,"class","notes svelte-egzizz")},m(t,o){H(t,e,o)},d(t){t&&a(e)}}}function Zt(l,e){let t,o,n,i,d=parseInt(e[36].pos)+1+"",_,h,O,I,f,u,b=e[36].title+"",p,m,v=e[36].support_list&&e[36].support_list.length||e[15](e[36]),w,y,R,B,D,C=v&&Yt();function L(){return e[27](e[36])}return{key:l,first:null,c(){t=s("ion-item"),o=s("ion-avatar"),n=s("div"),i=s("div"),_=he(d),O=N(),I=s("ion-label"),f=s("ion-text"),u=s("h3"),p=he(b),m=N(),C&&C.c(),w=N(),y=s("ion-icon"),R=N(),this.h()},l(P){t=c(P,"ION-ITEM",{});var k=E(t);o=c(k,"ION-AVATAR",{slot:!0});var S=E(o);n=c(S,"DIV",{class:!0,title:!0,style:!0});var U=E(n);i=c(U,"DIV",{class:!0});var M=E(i);_=pe(M,d),M.forEach(a),U.forEach(a),S.forEach(a),O=T(k),I=c(k,"ION-LABEL",{button:!0});var V=E(I);f=c(V,"ION-TEXT",{color:!0});var q=E(f);u=c(q,"H3",{});var j=E(u);p=pe(j,b),m=T(j),C&&C.l(j),j.forEach(a),q.forEach(a),V.forEach(a),w=T(k),y=c(k,"ION-ICON",{icon:!0,slot:!0,style:!0}),E(y).forEach(a),R=T(k),k.forEach(a),this.h()},h(){Y(i,"class","order svelte-egzizz"),Y(n,"class","order-wrapper svelte-egzizz"),Y(n,"title",h=Ye(e[36].status)),F(n,"background-color",Re(e[36].status,e[36].date_service)),F(n,"color",Ze(Re(e[36].status))),g(o,"slot","start"),g(f,"color","#2e2e2e"),g(I,"button",""),g(y,"icon",tt),g(y,"slot","end"),F(y,"color",Re(e[36].status,e[36].date_service)),this.first=t},m(P,k){H(P,t,k),r(t,o),r(o,n),r(n,i),r(i,_),r(t,O),r(t,I),r(I,f),r(f,u),r(u,p),r(u,m),C&&C.m(u,null),r(t,w),r(t,y),r(t,R),B||(D=se(I,"click",L),B=!0)},p(P,k){e=P,k[0]&32&&d!==(d=parseInt(e[36].pos)+1+"")&&Be(_,d),k[0]&32&&h!==(h=Ye(e[36].status))&&Y(n,"title",h),k[0]&32&&F(n,"background-color",Re(e[36].status,e[36].date_service)),k[0]&32&&F(n,"color",Ze(Re(e[36].status))),k[0]&32&&b!==(b=e[36].title+"")&&Be(p,b),k[0]&32&&(v=e[36].support_list&&e[36].support_list.length||e[15](e[36])),v?C||(C=Yt(),C.c(),C.m(u,null)):C&&(C.d(1),C=null),k[0]&32&&F(y,"color",Re(e[36].status,e[36].date_service))},d(P){P&&a(t),C&&C.d(),B=!1,D()}}}function go(l){let e=l[13](l[7],l[1],l[0])+"",t,o,n,i,d='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Pull to refresh" refreshing-spinner="circles" refreshing-text="Refreshing..."></ion-refresher-content>',_,h,O=[],I=new Map,f,u,b=je(l[5]);const p=m=>m[36].id_event;for(let m=0;m<b.length;m+=1){let v=Wt(l,b,m),w=p(v);I.set(w,O[m]=$t(w,v))}return{c(){t=he(e),o=N(),n=s("ion-content"),i=s("ion-refresher"),i.innerHTML=d,_=N(),h=s("ion-list");for(let m=0;m<O.length;m+=1)O[m].c();this.h()},l(m){t=pe(m,e),o=T(m),n=c(m,"ION-CONTENT",{});var v=E(n);i=c(v,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),J(i)!=="svelte-dvt1s"&&(i.innerHTML=d),_=T(v),h=c(v,"ION-LIST",{});var w=E(h);for(let y=0;y<O.length;y+=1)O[y].l(w);w.forEach(a),v.forEach(a),this.h()},h(){g(i,"slot","fixed")},m(m,v){H(m,t,v),H(m,o,v),H(m,n,v),r(n,i),l[24](i),r(n,_),r(n,h);for(let w=0;w<O.length;w+=1)O[w]&&O[w].m(h,null);f||(u=se(i,"ionRefresh",l[10]),f=!0)},p(m,v){v[0]&131&&e!==(e=m[13](m[7],m[1],m[0])+"")&&Be(t,e),v[0]&299040&&(b=je(m[5]),O=lt(O,v,p,1,m,b,I,h,rt,$t,null,Wt))},d(m){m&&(a(t),a(o),a(n)),l[24](null);for(let v=0;v<O.length;v+=1)O[v].d();f=!1,u()}}}function bo(l){let e,t,o='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Jale para actualizar" refreshing-spinner="circles" refreshing-text="Actualizando..."></ion-refresher-content>',n,i,d=[],_=new Map,h,O,I=je(l[5]);const f=u=>u[36].id_event;for(let u=0;u<I.length;u+=1){let b=Xt(l,I,u),p=f(b);_.set(p,d[u]=tn(p,b))}return{c(){e=s("ion-content"),t=s("ion-refresher"),t.innerHTML=o,n=N(),i=s("ion-list");for(let u=0;u<d.length;u+=1)d[u].c();this.h()},l(u){e=c(u,"ION-CONTENT",{});var b=E(e);t=c(b,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),J(t)!=="svelte-15ukrgn"&&(t.innerHTML=o),n=T(b),i=c(b,"ION-LIST",{});var p=E(i);for(let m=0;m<d.length;m+=1)d[m].l(p);p.forEach(a),b.forEach(a),this.h()},h(){g(t,"slot","fixed")},m(u,b){H(u,e,b),r(e,t),l[22](t),r(e,n),r(e,i);for(let p=0;p<d.length;p+=1)d[p]&&d[p].m(i,null);h||(O=se(t,"ionRefresh",l[10]),h=!0)},p(u,b){b[0]&299040&&(I=je(u[5]),d=lt(d,b,f,1,u,I,_,i,rt,tn,null,Xt))},d(u){u&&a(e),l[22](null);for(let b=0;b<d.length;b+=1)d[b].d();h=!1,O()}}}function xt(l){let e;return{c(){e=s("span"),this.h()},l(t){e=c(t,"SPAN",{class:!0}),E(e).forEach(a),this.h()},h(){Y(e,"class","notes svelte-egzizz")},m(t,o){H(t,e,o)},d(t){t&&a(e)}}}function $t(l,e){let t,o,n,i,d=parseInt(e[36].pos)+1+"",_,h,O,I,f,u,b=e[36].title+"",p,m,v=e[36].support_list&&e[36].support_list.length||e[15](e[36]),w,y,R="",B,D,C,L,P,k=v&&xt();function S(){return e[25](e[36],e[38])}return{key:l,first:null,c(){t=s("ion-item"),o=s("ion-avatar"),n=s("div"),i=s("div"),_=he(d),O=N(),I=s("ion-label"),f=s("ion-text"),u=s("h3"),p=he(b),m=N(),k&&k.c(),w=N(),y=s("div"),y.innerHTML=R,B=N(),D=s("ion-icon"),C=N(),this.h()},l(U){t=c(U,"ION-ITEM",{});var M=E(t);o=c(M,"ION-AVATAR",{slot:!0});var V=E(o);n=c(V,"DIV",{class:!0,title:!0,style:!0});var q=E(n);i=c(q,"DIV",{class:!0});var j=E(i);_=pe(j,d),j.forEach(a),q.forEach(a),V.forEach(a),O=T(M),I=c(M,"ION-LABEL",{button:!0});var te=E(I);f=c(te,"ION-TEXT",{color:!0});var me=E(f);u=c(me,"H3",{});var ce=E(u);p=pe(ce,b),m=T(ce),k&&k.l(ce),ce.forEach(a),me.forEach(a),w=T(te),y=c(te,"DIV",{class:!0,"data-svelte-h":!0}),J(y)!=="svelte-qaecoo"&&(y.innerHTML=R),te.forEach(a),B=T(M),D=c(M,"ION-ICON",{icon:!0,slot:!0}),E(D).forEach(a),C=T(M),M.forEach(a),this.h()},h(){Y(i,"class","order svelte-egzizz"),Y(n,"class","order-wrapper svelte-egzizz"),Y(n,"title",h=Ye(e[36].status)),F(n,"background-color",Re(e[36].status,e[36].date_service)),F(n,"color",Ze(Re(e[36].status))),g(o,"slot","start"),g(f,"color","#2e2e2e"),Y(y,"class","sub svelte-egzizz"),g(I,"button",""),g(D,"icon",tt),g(D,"slot","end"),this.first=t},m(U,M){H(U,t,M),r(t,o),r(o,n),r(n,i),r(i,_),r(t,O),r(t,I),r(I,f),r(f,u),r(u,p),r(u,m),k&&k.m(u,null),r(I,w),r(I,y),r(t,B),r(t,D),r(t,C),L||(P=se(I,"click",S),L=!0)},p(U,M){e=U,M[0]&32&&d!==(d=parseInt(e[36].pos)+1+"")&&Be(_,d),M[0]&32&&h!==(h=Ye(e[36].status))&&Y(n,"title",h),M[0]&32&&F(n,"background-color",Re(e[36].status,e[36].date_service)),M[0]&32&&F(n,"color",Ze(Re(e[36].status))),M[0]&32&&b!==(b=e[36].title+"")&&Be(p,b),M[0]&32&&(v=e[36].support_list&&e[36].support_list.length||e[15](e[36])),v?k||(k=xt(),k.c(),k.m(u,null)):k&&(k.d(1),k=null)},d(U){U&&a(t),k&&k.d(),L=!1,P()}}}function en(l){let e;return{c(){e=s("span"),this.h()},l(t){e=c(t,"SPAN",{class:!0}),E(e).forEach(a),this.h()},h(){Y(e,"class","notes svelte-egzizz")},m(t,o){H(t,e,o)},d(t){t&&a(e)}}}function tn(l,e){let t,o,n,i,d=parseInt(e[36].pos)+1+"",_,h,O,I,f,u,b=e[36].title+"",p,m,v=e[36].support_list&&e[36].support_list.length||e[15](e[36]),w,y,R="",B,D,C,L,P,k=v&&en();function S(){return e[23](e[36],e[38])}return{key:l,first:null,c(){t=s("ion-item"),o=s("ion-avatar"),n=s("div"),i=s("div"),_=he(d),O=N(),I=s("ion-label"),f=s("ion-text"),u=s("h3"),p=he(b),m=N(),k&&k.c(),w=N(),y=s("div"),y.innerHTML=R,B=N(),D=s("ion-icon"),C=N(),this.h()},l(U){t=c(U,"ION-ITEM",{});var M=E(t);o=c(M,"ION-AVATAR",{slot:!0});var V=E(o);n=c(V,"DIV",{class:!0,title:!0,style:!0});var q=E(n);i=c(q,"DIV",{class:!0});var j=E(i);_=pe(j,d),j.forEach(a),q.forEach(a),V.forEach(a),O=T(M),I=c(M,"ION-LABEL",{button:!0});var te=E(I);f=c(te,"ION-TEXT",{color:!0});var me=E(f);u=c(me,"H3",{});var ce=E(u);p=pe(ce,b),m=T(ce),k&&k.l(ce),ce.forEach(a),me.forEach(a),w=T(te),y=c(te,"DIV",{class:!0,"data-svelte-h":!0}),J(y)!=="svelte-qaecoo"&&(y.innerHTML=R),te.forEach(a),B=T(M),D=c(M,"ION-ICON",{icon:!0,slot:!0}),E(D).forEach(a),C=T(M),M.forEach(a),this.h()},h(){Y(i,"class","order svelte-egzizz"),Y(n,"class","order-wrapper svelte-egzizz"),Y(n,"title",h=Ye(e[36].status)),F(n,"background-color",Re(e[36].status,e[36].date_service)),F(n,"color",Ze(Re(e[36].status))),g(o,"slot","start"),g(f,"color","#2e2e2e"),Y(y,"class","sub svelte-egzizz"),g(I,"button",""),g(D,"icon",tt),g(D,"slot","end"),this.first=t},m(U,M){H(U,t,M),r(t,o),r(o,n),r(n,i),r(i,_),r(t,O),r(t,I),r(I,f),r(f,u),r(u,p),r(u,m),k&&k.m(u,null),r(I,w),r(I,y),r(t,B),r(t,D),r(t,C),L||(P=se(I,"click",S),L=!0)},p(U,M){e=U,M[0]&32&&d!==(d=parseInt(e[36].pos)+1+"")&&Be(_,d),M[0]&32&&h!==(h=Ye(e[36].status))&&Y(n,"title",h),M[0]&32&&F(n,"background-color",Re(e[36].status,e[36].date_service)),M[0]&32&&F(n,"color",Ze(Re(e[36].status))),M[0]&32&&b!==(b=e[36].title+"")&&Be(p,b),M[0]&32&&(v=e[36].support_list&&e[36].support_list.length||e[15](e[36])),v?k||(k=en(),k.c(),k.m(u,null)):k&&(k.d(1),k=null)},d(U){U&&a(t),k&&k.d(),L=!1,P()}}}function Eo(l){let e,t,o,n,i=`<ion-icon icon="${wn}"></ion-icon>`,d,_,h,O=`<ion-icon icon="${Ln}"></ion-icon>`,I,f,u=(l[6].name?l[6].name.toUpperCase():"")+"",b,p,m,v='<ion-segment-button value="list"><ion-label>Paradas</ion-label></ion-segment-button> <ion-segment-button value="map"><ion-label>Mapa</ion-label></ion-segment-button>',w,y,R,B;function D(P,k){if(P[9]==="list")return po;if(P[9]==="map")return ho}let C=D(l),L=C&&C(l);return{c(){e=s("ion-header"),t=s("ion-toolbar"),o=s("ion-buttons"),n=s("ion-button"),n.innerHTML=i,d=N(),_=s("ion-buttons"),h=s("ion-button"),h.innerHTML=O,I=N(),f=s("ion-title"),b=he(u),p=N(),m=s("ion-segment"),m.innerHTML=v,w=N(),L&&L.c(),y=Ue(),this.h()},l(P){e=c(P,"ION-HEADER",{translucent:!0});var k=E(e);t=c(k,"ION-TOOLBAR",{});var S=E(t);o=c(S,"ION-BUTTONS",{slot:!0});var U=E(o);n=c(U,"ION-BUTTON",{title:!0,alt:!0,"data-svelte-h":!0}),J(n)!=="svelte-7ppz3r"&&(n.innerHTML=i),U.forEach(a),d=T(S),_=c(S,"ION-BUTTONS",{slot:!0});var M=E(_);h=c(M,"ION-BUTTON",{"data-svelte-h":!0}),J(h)!=="svelte-nf50hj"&&(h.innerHTML=O),M.forEach(a),I=T(S),f=c(S,"ION-TITLE",{});var V=E(f);b=pe(V,u),V.forEach(a),S.forEach(a),p=T(k),m=c(k,"ION-SEGMENT",{value:!0,"data-svelte-h":!0}),J(m)!=="svelte-lue4c9"&&(m.innerHTML=v),k.forEach(a),w=T(P),L&&L.l(P),y=Ue(),this.h()},h(){g(n,"title","Atrás"),g(n,"alt","Atrás"),g(o,"slot","start"),g(_,"slot","end"),g(m,"value","list"),g(e,"translucent","")},m(P,k){H(P,e,k),r(e,t),r(t,o),r(o,n),r(t,d),r(t,_),r(_,h),r(t,I),r(t,f),r(f,b),r(e,p),r(e,m),H(P,w,k),L&&L.m(P,k),H(P,y,k),R||(B=[se(n,"click",l[16]),se(h,"click",l[20]),se(m,"ionChange",l[21])],R=!0)},p(P,k){k[0]&64&&u!==(u=(P[6].name?P[6].name.toUpperCase():"")+"")&&Be(b,u),C===(C=D(P))&&L?L.p(P,k):(L&&L.d(1),L=C&&C(P),L&&(L.c(),L.m(y.parentNode,y)))},d(P){P&&(a(e),a(w),a(y)),L&&L.d(P),R=!1,Ge(B)}}}function Io(l){let e,t,o,n=l[2]&&Jt(l);return{c(){e=N(),n&&n.c(),t=Ue(),this.h()},l(i){cn("svelte-kn0kph",Gt.head).forEach(a),e=T(i),n&&n.l(i),t=Ue(),this.h()},h(){Gt.title="Rutaflow - Detalles de ruta"},m(i,d){H(i,e,d),n&&n.m(i,d),H(i,t,d),o=!0},p(i,d){i[2]?n?(n.p(i,d),d[0]&4&&_t(n,1)):(n=Jt(i),n.c(),_t(n,1),n.m(t.parentNode,t)):n&&(vn(),mt(n,1,1,()=>{n=null}),_n())},i(i){o||(_t(n),o=!0)},o(i){mt(n),o=!1},d(i){i&&(a(e),a(t)),n&&n.d(i)}}}function Re(l,e=""){let t="#ffffff";return l==="pending"&&!e?t="#f2e300":l=="pending"&&e?t="#F6A833":l==="completed"&&(t="#44d900"),t}function Ye(l){let e="";return l=="pending"?e="Pendiente":l=="completed"&&(e="Completado"),e}function Ze(l){l.slice(0,1)==="#"&&(l=l.slice(1)),l.length===3&&(l=l.split("").map(function(i){return i+i}).join(""));const e=parseInt(l.substr(0,2),16),t=parseInt(l.substr(2,2),16),o=parseInt(l.substr(4,2),16);return(e*299+t*587+o*114)/1e3>=128?"#414040":"#fff"}const ko=l=>l.mandatory==="1",Oo=l=>l.img;function No(l,e,t){let o;un(l,Sn,A=>t(19,o=A));var n=this&&this.__awaiter||function(A,G,X,$){function de(K){return K instanceof X?K:new X(function(re){re(K)})}return new(X||(X=Promise))(function(K,re){function Ne(ve){try{Ie($.next(ve))}catch(De){re(De)}}function Me(ve){try{Ie($.throw(ve))}catch(De){re(De)}}function Ie(ve){ve.done?K(ve.value):de(ve.value).then(Ne,Me)}Ie(($=$.apply(A,G||[])).next())})};let{routeId:i}=e,{driverId:d}=e,_=ht,h=new Object,O=!0,I=!1,f=[],u={},b=[],p=[],m,v=!1,w="list",y;const R=()=>n(void 0,void 0,void 0,function*(){yield D(i),m.complete()});it(()=>n(void 0,void 0,void 0,function*(){yield D(i)}));function B(A){return n(this,void 0,void 0,function*(){if(t(9,w=A),w==="map"){yield fn(),y=document.getElementById("g_map");const G=new google.maps.Map(y,{zoom:8,center:{lat:20.6745683,lng:-103.3986104},mapId:"4504f8b37365c3d0"}),X=new google.maps.LatLngBounds,{AdvancedMarkerElement:$,PinElement:de}=yield google.maps.importLibrary("marker");navigator.geolocation?navigator.geolocation.getCurrentPosition(function(K){const re=new google.maps.LatLng(K.coords.latitude,K.coords.longitude);new google.maps.Marker({position:re,map:G,icon:{path:google.maps.SymbolPath.CIRCLE,fillColor:"#0062ff",fillOpacity:1,scale:6,strokeColor:"#ffffff",strokeWeight:2}}),new google.maps.Circle({strokeColor:"#00BFFF",strokeOpacity:.5,strokeWeight:1,fillColor:"#00BFFF",fillOpacity:.2,map:G,center:re,radius:K.coords.accuracy}),X.extend(re)},function(K){console.error("Error retrieving location:",K)}):console.error("Geolocation not supported by this browser."),f.forEach((K,re)=>{const Ne=parseFloat(K.lat),Me=parseFloat(K.lon),Ie=new google.maps.LatLng(Ne,Me),ve=new google.maps.Marker({position:{lat:Ne,lng:Me},map:G,title:K.title}),De=new de({background:Re(K.status,K.date_service),borderColor:"#000",glyphColor:"#000",glyph:(parseInt(K.pos)+1).toString()});new $({map:G,position:Ie,content:De.element,title:"Parada "+(parseInt(K.pos)+1).toString()+": "+K.title}).addListener("click",function(qe){L(K,q(re))}),X.extend(ve.getPosition())}),G.fitBounds(X)}})}function D(A){return n(this,void 0,void 0,function*(){const G=new FormData;G.append("id_route",A);try{const $=yield(yield fetch(`${_}api/admin/report/seguimiento_list.php`,{method:"POST",body:G})).json();t(6,u=$.data.seguimiento_list[0]),t(5,f=$.data.event_list),t(7,b=$.data.checklist),p=$.data.expenses,u&&t(4,I=u.km_inicial=="0"&&u.gas_inicial=="0"),t(3,O=!1)}catch(X){t(3,O=!1),console.error("Error fetching data:",X)}})}const C=A=>new Promise((G,X)=>{const $=new FormData;$.append("id_route",A.id_route),$.append("id_event",A.id_event),fetch(`${_}api/admin/evidence/evidence_by_event.php`,{method:"POST",body:$}).then(de=>de.json()).then(de=>{G(de.data.event_evidence[0])}).catch(de=>{console.error("Error fetching data:",de),X(de)})}),L=(A,G)=>{C(A).then(X=>{X&&(A.img=X.img,A.driver_comments=X.driver_comments,A.comments=X.comments),We("modal-delivery-info",lo,{delivery:A,isLast:G}).then($=>{}).finally(()=>{D(i)})})},P=(A,G,X)=>{var $=!1;return v||(v=!0,We("modal-checklist",Jn,{checklist:A,driverId:G,routeId:X,isLast:$}).then(de=>{v=!1}),U(X,"checklist")),""},k=A=>n(void 0,void 0,void 0,function*(){return yield D(A),p.length>0?We("modal-expense-detail",_o,{routeId:A,expenses:p}).then(G=>{}):We("modal-expense",bt,{routeId:A}).then(G=>{}),""}),S=A=>{if(A.tracking_type=="subscription"){if(A.subscriber_info&&A.payment_type==="cash"&&new Date(A.subscriber_info.payment_next)<new Date)return!0}else if(A.tracking_type=="ecommerce"&&Number(A.payment_pending)>0)return!0;return!1};function U(A,G){let X=new FormData;return X.append("id_route",A),X.append("status",G),fetch(`${_}api/admin/route/change_status.php`,{method:"POST",body:X}).then($=>$.json()).then($=>{}).catch($=>{console.error("Error fetching data:",$)}),""}const M=()=>{h.type=="super"||h.type=="admin"?Ke("/drivers/me"):h.id_driver&&Ke(`/drivers/${h.id_driver}`)},V=(A,G)=>n(void 0,void 0,void 0,function*(){yield(yield Qe.create({header:A||"Error",message:G||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()});function q(A){return A===f.length-1}const j=()=>k(i),te=A=>B(A.detail.value);function me(A){He[A?"unshift":"push"](()=>{m=A,t(8,m)})}const ce=(A,G)=>L(A,q(G));function W(A){He[A?"unshift":"push"](()=>{m=A,t(8,m)})}const x=(A,G)=>L(A,q(G));function ne(A){He[A?"unshift":"push"](()=>{m=A,t(8,m)})}const le=A=>{const G=f.findIndex(re=>re.id_event===A.id_event),X=G===0,$=G>0?f[G-1]:null,de=X||$&&$.img!==null,K=A.img!==null&&A.img!=="";de||X&&!K?L(A):V("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")};return l.$$set=A=>{"routeId"in A&&t(0,i=A.routeId),"driverId"in A&&t(1,d=A.driverId)},l.$$.update=()=>{l.$$.dirty[0]&524293&&(t(0,{routeId:i,driverId:d}=o.params,i,(t(1,d),t(19,o),t(2,h),t(0,i))),t(2,h=JSON.parse(localStorage.getItem("userSession"))),h?h.id_user&&(h.type=="admin"||h.type=="super")?(D(i),Ke(`/drivers/me/routes/${i}`)):h.id_user&&h.id_driver&&(D(i),Ke(`/drivers/${h.id_driver}/routes/${i}`)):Ke("/"))},[i,d,h,O,I,f,u,b,m,w,R,B,L,P,k,S,M,V,q,o,j,te,me,ce,W,x,ne,le]}class Po extends $e{constructor(e){super(),et(this,e,No,Io,xe,{routeId:0,driverId:1},null,[-1,-1])}}export{Po as component};

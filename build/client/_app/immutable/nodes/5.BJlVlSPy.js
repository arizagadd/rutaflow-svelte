import{Z as dt,s as We,e as s,j as y,b as c,q as m,d as oe,h as a,m as w,v,i as J,w as o,x as ue,n as ze,z as He,_ as tn,B as k,o as Ze,k as Se,$ as _t,t as ge,r as be,f as Y,a0 as nn,a1 as Qe,A as De,y as Le,a2 as on,a3 as Ke,a4 as ln,a5 as rn,l as an,p as sn,F as cn}from"../chunks/index.CdEBkEwf.js";import{S as Je,i as Ye,t as it,a as st,c as un,b as fn,d as dn,m as _n,e as hn,g as pn}from"../chunks/index.c2pjNB5R.js";import{e as Be,u as xe,d as $e,a as mn,b as vn,c as gn,i as Qt,f as bn,g as Zt,h as En,j as In,k as ct,m as kn,n as xt,s as ht,o as Re,q as On,r as Nn,t as Tn,v as Cn,w as yn,x as wn,y as Ln,z as zn,p as An}from"../chunks/index.CBqUrrD_.js";import"../chunks/index-48209844.IIRtDZyg.js";import{m as et,D as rt,a as je,I as Mn}from"../chunks/IonPage.BswG1G42.js";import{q as Sn,t as Dn}from"../chunks/ion-modal.CsJaVgKZ.js";import{g as qe}from"../chunks/entry.DiwnjIYQ.js";const Pn=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global,Hn=(r,e)=>{if(!customElements.get(r)){class t extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const n={};for(const i of this.attributes)n[i.name]=i.value;new e({target:this.shadowRoot,props:n})}}customElements.define(r,t)}},Bn=function(r){return document.createElement(r).constructor!==HTMLElement},Rn=(r,e)=>{Bn(r)||Hn(r,e)},Ue=async(r,e,t)=>{Sn(),Dn(),Rn(r,e);const l=await et.create({component:r,componentProps:t});return l.present(),await l.onWillDismiss()};let Ge=dt({km_inicial:[],gas_inicial:[],km_final:[],gas_final:[]}),$t=dt({flag:[]});function Un(r){let e,t,l,n,i="Cancelar",f,d,_="Captura de Km/Gas",O,g,h,u="Confirmar",p,b,C,z,V,M,G;return{c(){e=s("ion-header"),t=s("ion-toolbar"),l=s("ion-buttons"),n=s("ion-button"),n.textContent=i,f=y(),d=s("ion-title"),d.textContent=_,O=y(),g=s("ion-buttons"),h=s("ion-button"),h.textContent=u,p=y(),b=s("ion-content"),C=s("ion-item"),z=s("ion-input"),this.h()},l(q){e=c(q,"ION-HEADER",{translucent:!0});var j=m(e);t=c(j,"ION-TOOLBAR",{});var P=m(t);l=c(P,"ION-BUTTONS",{slot:!0});var H=m(l);n=c(H,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),oe(n)!=="svelte-17pq4f4"&&(n.textContent=i),H.forEach(a),f=w(P),d=c(P,"ION-TITLE",{"data-svelte-h":!0}),oe(d)!=="svelte-1yhkaq7"&&(d.textContent=_),O=w(P),g=c(P,"ION-BUTTONS",{slot:!0});var E=m(g);h=c(E,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),oe(h)!=="svelte-cm6j4s"&&(h.textContent=u),E.forEach(a),P.forEach(a),j.forEach(a),p=w(q),b=c(q,"ION-CONTENT",{fullscreen:!0});var L=m(b);C=c(L,"ION-ITEM",{});var U=m(C);z=c(U,"ION-INPUT",{class:!0,inputmode:!0,pattern:!0,type:!0,placeholder:!0,value:!0,required:!0});var B=m(z);B.forEach(a),U.forEach(a),L.forEach(a),this.h()},h(){v(n,"color","medium"),v(l,"slot","start"),v(h,"strong",""),v(g,"slot","end"),v(e,"translucent",""),v(z,"class","fin-km"),v(z,"inputmode","numeric"),v(z,"pattern","[0-9]*"),v(z,"type","number"),v(z,"placeholder",V="Ingresa "+r[0]+" actual"),v(z,"value",r[1]),v(z,"required",""),v(b,"fullscreen","")},m(q,j){J(q,e,j),o(e,t),o(t,l),o(l,n),o(t,f),o(t,d),o(t,O),o(t,g),o(g,h),J(q,p,j),J(q,b,j),o(b,C),o(C,z),M||(G=[ue(n,"click",r[2]),ue(h,"click",r[3]),ue(z,"input",r[4])],M=!0)},p(q,[j]){j&1&&V!==(V="Ingresa "+q[0]+" actual")&&v(z,"placeholder",V),j&2&&v(z,"value",q[1])},i:ze,o:ze,d(q){q&&(a(e),a(p),a(b)),M=!1,He(G)}}}function Vn(r,e,t){const l=tn();let n=document.querySelector("ion-modal"),i=n.componentProps.data_type;n.componentProps.isLast;let f;$t.subscribe(h=>{i=h.flag[0],i=="km_final"||i=="km_inicial"?t(0,f="kilometraje"):t(0,f="litros de gasolina")});let d=0;function _(){et.dismiss()}function O(){l("modalResult",{data:"Your data",role:"confirm"}),i=="km_inicial"?Ge.update(u=>({...u,km_inicial:[d]})):i=="gas_inicial"?Ge.update(u=>({...u,gas_inicial:[d]})):i=="km_final"?Ge.update(u=>({...u,km_final:[d]})):i=="gas_final"&&Ge.update(u=>({...u,gas_final:[d]})),_()}return[f,d,_,O,h=>t(1,d=h.target.value)]}class Fn extends Je{constructor(e){super(),Ye(this,e,Vn,Un,We,{})}}const at=dt({items:[],checkedIndices:[],mandatory:[]});function bt(r,e,t){const l=r.slice();return l[55]=e[t],l[56]=e,l[57]=t,l}function qn(r){let e,t,l,n,i,f="Kilometraje inicial",d,_,O=r[0]?r[0]+" km.":"Cargar km",g,h,u,p,b,C,z,V="Gasolina inicial (litros)",M,G,q=r[1]?r[1]+" litros":"Cargar gas",j,P,H,E;return P=_t(r[21][0]),{c(){e=s("ion-item"),t=s("ion-label"),l=s("input"),n=y(),i=s("p"),i.textContent=f,d=y(),_=s("ion-button"),g=ge(O),h=y(),u=s("ion-item"),p=s("ion-label"),b=s("input"),C=y(),z=s("p"),z.textContent=V,M=y(),G=s("ion-button"),j=ge(q),this.h()},l(L){e=c(L,"ION-ITEM",{});var U=m(e);t=c(U,"ION-LABEL",{style:!0});var B=m(t);l=c(B,"INPUT",{id:!0,style:!0,type:!0}),n=w(B),i=c(B,"P",{style:!0,"data-svelte-h":!0}),oe(i)!=="svelte-88twxi"&&(i.textContent=f),B.forEach(a),d=w(U),_=c(U,"ION-BUTTON",{fill:!0,size:!0,class:!0,"aria-selected":!0});var R=m(_);g=be(R,O),R.forEach(a),U.forEach(a),h=w(L),u=c(L,"ION-ITEM",{});var W=m(u);p=c(W,"ION-LABEL",{style:!0});var F=m(p);b=c(F,"INPUT",{id:!0,style:!0,type:!0}),C=w(F),z=c(F,"P",{style:!0,"data-svelte-h":!0}),oe(z)!=="svelte-1ux30eb"&&(z.textContent=V),F.forEach(a),M=w(W),G=c(W,"ION-BUTTON",{fill:!0,class:!0,size:!0,style:!0});var te=m(G);j=be(te,q),te.forEach(a),W.forEach(a),this.h()},h(){Y(l,"id","chkbox-km-ini"),k(l,"pointer-events","auto"),Y(l,"type","checkbox"),l.required=!0,k(i,"margin-left","10px"),k(t,"display","flex"),v(_,"fill","outline"),v(_,"size","small"),v(_,"class","loadKmInicial"),v(_,"aria-selected",""),Y(b,"id","chkbox-gas-ini"),k(b,"pointer-events","auto"),Y(b,"type","checkbox"),b.required=!0,k(z,"margin-left","10px"),k(p,"display","flex"),v(G,"fill","outline"),v(G,"class","loadGasInicial"),v(G,"size","small"),k(G,"height","16px "),P.p(l,b)},m(L,U){J(L,e,U),o(e,t),o(t,l),l.checked=~(r[4]||[]).indexOf(l.__value),r[28](l),o(t,n),o(t,i),o(e,d),o(e,_),o(_,g),J(L,h,U),J(L,u,U),o(u,p),o(p,b),r[30](b),b.checked=~(r[4]||[]).indexOf(b.__value),o(p,C),o(p,z),o(u,M),o(u,G),o(G,j),H||(E=[ue(l,"change",r[27]),ue(_,"click",r[29]),ue(b,"change",r[31]),ue(G,"click",r[32])],H=!0)},p(L,U){U[0]&16&&(l.checked=~(L[4]||[]).indexOf(l.__value)),U[0]&1&&O!==(O=L[0]?L[0]+" km.":"Cargar km")&&Le(g,O),U[0]&16&&(b.checked=~(L[4]||[]).indexOf(b.__value)),U[0]&2&&q!==(q=L[1]?L[1]+" litros":"Cargar gas")&&Le(j,q)},d(L){L&&(a(e),a(h),a(u)),r[28](null),r[30](null),P.r(),H=!1,He(E)}}}function jn(r){let e,t,l,n,i,f="Kilometraje final",d,_,O=r[2]?r[2]+" km.":"Cargar km",g,h,u,p,b,C,z,V="Gasolina final (litros)",M,G,q=r[3]?r[3]+" litros":"Cargar gas",j,P,H,E;return P=_t(r[21][0]),{c(){e=s("ion-item"),t=s("ion-label"),l=s("input"),n=y(),i=s("p"),i.textContent=f,d=y(),_=s("ion-button"),g=ge(O),h=y(),u=s("ion-item"),p=s("ion-label"),b=s("input"),C=y(),z=s("p"),z.textContent=V,M=y(),G=s("ion-button"),j=ge(q),this.h()},l(L){e=c(L,"ION-ITEM",{});var U=m(e);t=c(U,"ION-LABEL",{style:!0});var B=m(t);l=c(B,"INPUT",{id:!0,style:!0,type:!0}),n=w(B),i=c(B,"P",{style:!0,"data-svelte-h":!0}),oe(i)!=="svelte-ccmu71"&&(i.textContent=f),B.forEach(a),d=w(U),_=c(U,"ION-BUTTON",{fill:!0,size:!0,class:!0,"aria-selected":!0});var R=m(_);g=be(R,O),R.forEach(a),U.forEach(a),h=w(L),u=c(L,"ION-ITEM",{});var W=m(u);p=c(W,"ION-LABEL",{style:!0});var F=m(p);b=c(F,"INPUT",{id:!0,style:!0,type:!0}),C=w(F),z=c(F,"P",{style:!0,"data-svelte-h":!0}),oe(z)!=="svelte-wsoyd2"&&(z.textContent=V),F.forEach(a),M=w(W),G=c(W,"ION-BUTTON",{fill:!0,size:!0,class:!0});var te=m(G);j=be(te,q),te.forEach(a),W.forEach(a),this.h()},h(){Y(l,"id","chkbox-km-fin"),k(l,"pointer-events","auto"),Y(l,"type","checkbox"),l.required=!0,k(i,"margin-left","10px"),k(t,"display","flex"),v(_,"fill","outline"),v(_,"size","small"),v(_,"class","loadKmInicial"),v(_,"aria-selected",""),Y(b,"id","chkbox-gas-fin"),k(b,"pointer-events","auto"),Y(b,"type","checkbox"),b.required=!0,k(z,"margin-left","10px"),k(p,"display","flex"),v(G,"fill","outline"),v(G,"size","small"),v(G,"class","loadGasInicial"),P.p(l,b)},m(L,U){J(L,e,U),o(e,t),o(t,l),l.checked=~(r[4]||[]).indexOf(l.__value),r[22](l),o(t,n),o(t,i),o(e,d),o(e,_),o(_,g),J(L,h,U),J(L,u,U),o(u,p),o(p,b),b.checked=~(r[4]||[]).indexOf(b.__value),r[25](b),o(p,C),o(p,z),o(u,M),o(u,G),o(G,j),H||(E=[ue(l,"change",r[20]),ue(_,"click",r[23]),ue(b,"change",r[24]),ue(G,"click",r[26])],H=!0)},p(L,U){U[0]&16&&(l.checked=~(L[4]||[]).indexOf(l.__value)),U[0]&4&&O!==(O=L[2]?L[2]+" km.":"Cargar km")&&Le(g,O),U[0]&16&&(b.checked=~(L[4]||[]).indexOf(b.__value)),U[0]&8&&q!==(q=L[3]?L[3]+" litros":"Cargar gas")&&Le(j,q)},d(L){L&&(a(e),a(h),a(u)),r[22](null),r[25](null),P.r(),H=!1,He(E)}}}function Gn(r){let e=[],t=new Map,l,n=Be(r[13]);const i=f=>f[55].id_checklist_event;for(let f=0;f<n.length;f+=1){let d=bt(r,n,f),_=i(d);t.set(_,e[f]=Et(_,d))}return{c(){for(let f=0;f<e.length;f+=1)e[f].c();l=Se()},l(f){for(let d=0;d<e.length;d+=1)e[d].l(f);l=Se()},m(f,d){for(let _=0;_<e.length;_+=1)e[_]&&e[_].m(f,d);J(f,l,d)},p(f,d){d[0]&407664&&(n=Be(f[13]),e=xe(e,d,i,1,f,n,t,l.parentNode,$e,Et,l,bt))},d(f){f&&a(l);for(let d=0;d<e.length;d+=1)e[d].d(f)}}}function Kn(r){let e,t=(r[12][r[55].id_checklist_event]?r[12][r[55].id_checklist_event]:"Cargar evidencia")+"",l;return{c(){e=s("label"),l=ge(t),this.h()},l(n){e=c(n,"LABEL",{for:!0,class:!0});var i=m(e);l=be(i,t),i.forEach(a),this.h()},h(){Y(e,"for","chklist-"+r[55].id_checklist_event),Y(e,"class","button-label svelte-1ruehls")},m(n,i){J(n,e,i),o(e,l)},p(n,i){i[0]&4096&&t!==(t=(n[12][n[55].id_checklist_event]?n[12][n[55].id_checklist_event]:"Cargar evidencia")+"")&&Le(l,t)},d(n){n&&a(e)}}}function Xn(r){let e;return{c(){e=s("ion-spinner"),this.h()},l(t){e=c(t,"ION-SPINNER",{name:!0,class:!0}),m(e).forEach(a),this.h()},h(){v(e,"name","dots"),v(e,"class","button-spinner svelte-1ruehls")},m(t,l){J(t,e,l)},p:ze,d(t){t&&a(e)}}}function Et(r,e){let t,l,n,i=e[55],f,d,_=e[55].item+"",O,g,h,u=e[55].mandatory=="1"?" * ":"",p,b,C,z,V,M,G,q,j,P;const H=()=>e[34](n,i),E=()=>e[34](null,i);function L(){return e[35](e[55])}function U(F,te){return F[11][F[55].id_checklist_event]?Xn:Kn}let B=U(e),R=B(e);function W(...F){return e[37](e[55],...F)}return q=_t(e[21][0]),{key:r,first:null,c(){t=s("ion-item"),l=s("ion-label"),n=s("input"),f=y(),d=s("p"),O=ge(_),g=y(),h=s("b"),p=ge(u),b=y(),C=s("ion-button"),z=s("div"),R.c(),V=y(),M=s("input"),G=y(),this.h()},l(F){t=c(F,"ION-ITEM",{});var te=m(t);l=c(te,"ION-LABEL",{style:!0});var ne=m(l);n=c(ne,"INPUT",{id:!0,style:!0,type:!0}),f=w(ne),d=c(ne,"P",{style:!0});var le=m(d);O=be(le,_),g=w(le),le.forEach(a),h=c(ne,"B",{style:!0});var me=m(h);p=be(me,u),me.forEach(a),ne.forEach(a),b=w(te),C=c(te,"ION-BUTTON",{fill:!0,class:!0,size:!0});var ae=m(C);z=c(ae,"DIV",{class:!0});var _e=m(z);R.l(_e),V=w(_e),M=c(_e,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0,capture:!0}),_e.forEach(a),ae.forEach(a),G=w(te),te.forEach(a),this.h()},h(){Y(n,"id",`chkbox-${e[55].id_checklist_event}`),k(n,"pointer-events","auto"),Y(n,"type","checkbox"),n.__value=e[55].id_checklist_event,nn(n,n.__value),n.required=!0,k(d,"margin-left","10px"),k(h,"margin-left","5px"),k(l,"display","flex"),k(M,"display","none"),Y(M,"id","chklist-"+e[55].id_checklist_event),Y(M,"name","fileToUpload"),Y(M,"type","file"),Y(M,"accept","image/*"),Y(M,"capture","environment"),Y(z,"class","button-content svelte-1ruehls"),v(C,"fill","outline"),v(C,"class","loadEvidence svelte-1ruehls"),v(C,"size","small"),q.p(n),this.first=t},m(F,te){J(F,t,te),o(t,l),o(l,n),n.checked=~(e[4]||[]).indexOf(n.__value),H(),o(l,f),o(l,d),o(d,O),o(d,g),o(l,h),o(h,p),o(t,b),o(t,C),o(C,z),R.m(z,null),o(z,V),o(z,M),e[36](M),o(t,G),j||(P=[ue(n,"change",e[33]),ue(n,"change",L),ue(M,"change",W)],j=!0)},p(F,te){e=F,te[0]&16&&(n.checked=~(e[4]||[]).indexOf(n.__value)),i!==e[55]&&(E(),i=e[55],H()),B===(B=U(e))&&R?R.p(e,te):(R.d(1),R=B(e),R&&(R.c(),R.m(z,V)))},d(F){F&&a(t),E(),R.d(),e[36](null),q.r(),j=!1,He(P)}}}function Wn(r){let e,t,l,n,i="Cancelar",f,d,_="REQUERIMIENTOS DE RUTA",O,g,h,u,p,b,C,z="Confirmar",V,M;function G(H,E){return H[14]?jn:qn}let j=G(r)(r),P=r[13]&&Gn(r);return{c(){e=s("ion-header"),t=s("ion-toolbar"),l=s("ion-buttons"),n=s("ion-button"),n.textContent=i,f=y(),d=s("ion-title"),d.textContent=_,O=y(),g=s("ion-content"),h=s("ion-list"),j.c(),u=y(),P&&P.c(),p=y(),b=s("ion-footer"),C=s("ion-button"),C.textContent=z,this.h()},l(H){e=c(H,"ION-HEADER",{translucent:!0});var E=m(e);t=c(E,"ION-TOOLBAR",{});var L=m(t);l=c(L,"ION-BUTTONS",{slot:!0});var U=m(l);n=c(U,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),oe(n)!=="svelte-1dnmkxs"&&(n.textContent=i),U.forEach(a),f=w(L),d=c(L,"ION-TITLE",{"data-svelte-h":!0}),oe(d)!=="svelte-19bar5p"&&(d.textContent=_),L.forEach(a),E.forEach(a),O=w(H),g=c(H,"ION-CONTENT",{fullscreen:!0});var B=m(g);h=c(B,"ION-LIST",{});var R=m(h);j.l(R),u=w(R),P&&P.l(R),R.forEach(a),B.forEach(a),p=w(H),b=c(H,"ION-FOOTER",{});var W=m(b);C=c(W,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),oe(C)!=="svelte-g82qqw"&&(C.textContent=z),W.forEach(a),this.h()},h(){v(n,"color","medium"),v(l,"slot","start"),v(e,"translucent",""),v(g,"fullscreen",""),v(C,"fill","outline"),v(C,"color","tertiary"),v(C,"strong",""),k(C,"width","99%"),k(C,"height","auto")},m(H,E){J(H,e,E),o(e,t),o(t,l),o(l,n),o(t,f),o(t,d),J(H,O,E),J(H,g,E),o(g,h),j.m(h,null),o(h,u),P&&P.m(h,null),J(H,p,E),J(H,b,E),o(b,C),V||(M=[ue(n,"click",r[15]),ue(C,"click",r[16])],V=!0)},p(H,E){j.p(H,E),H[13]&&P.p(H,E)},i:ze,o:ze,d(H){H&&(a(e),a(O),a(g),a(p),a(b)),j.d(),P&&P.d(),V=!1,He(M)}}}function ut(r,e){if(typeof r=="object"&&r!==null||Array.isArray(r)){if(Array.isArray(r))return r.map(t=>ut(t,e)).flat();{const t=Object.keys(r);let l;return e=="id_checklist_event"?l=t.filter(i=>i.toLowerCase().includes("id_checklist_event")).map(i=>r[i]):e=="mandatory"?l=t.filter(i=>i.toLowerCase().includes("mandatory")).map(i=>r[i]):(console.error("Tipo de dato no reconocido."),l=!1),l}}else return console.error("Invalid input. Please provide a valid object or array."),[]}function Jn(r,e,t){let l=rt,n=document.querySelector("ion-modal");const i=n.componentProps.checklist,f=n.componentProps.driverId,d=n.componentProps.routeId,_=n.componentProps.isLast;let O,g,h,u,p=[],b=null,C={},z,V,M,G,q={},j=new Object,P={},H={};Ze(()=>{j=JSON.parse(localStorage.getItem("userSession")),_?console.log("Último checklist"):at.update(A=>(A.mandatory=ut(i,"mandatory"),A.items=ut(i,"id_checklist_event"),A))});function E(A){t(11,q[A]=!0,q)}const L=async()=>{await(await je.create({header:"Datos o checklist incompletos",message:"Carga la evidencia requerida y marca todas las casillas para confirmar",buttons:[{text:"Cerrar"}]})).present()},U=async()=>{await(await je.create({header:"Datos capturados",message:"El kilometraje y gasolina final fueron registrados correctamente, espere aprobación para finalizar ruta",buttons:[{text:"Cerrar"}]})).present()},B=async A=>{await(await je.create({header:"Datos inválidos",message:A=="km"?"Llena correctamente el campo de kilometraje inicial":"Llena correctamente el campo de gasolina inicial",buttons:[{text:"Cerrar"}]})).present()},R=()=>{et.dismiss(),f?qe(`/drivers/${f}`):qe("/drivers/me")},W=()=>{if(_){var A=me(h,"km"),S=me(u,"gas");let x=new FormData;x.append("km_final",A),x.append("gas_final",S),x.append("id_route",d),x=pe(x),A&&S?(R(),fetch(`${l}api/admin/checklist/add_evidence.php`,{method:"POST",body:x}).then(re=>re.json()).then(re=>{U()}).catch(re=>{console.error("Error fetching data:",re)})):L()}else{var Q=me(O,"km"),ee=me(g,"gas");at.update(x=>{x.items;const re=x.mandatory;if(x.items.filter((Ne,fe)=>x.mandatory[fe]==="1").every(Ne=>x.checkedIndices.includes(Ne))&&Q&&ee){R();let Ne=new FormData;Ne=pe(Ne),Ne.append("km_inicial",Q),Ne.append("gas_inicial",ee),Ne.append("id_route",d);for(const fe in P)if(P.hasOwnProperty(fe)){const{img:Ae,img_id:Ve}=P[fe];Ne.append(`selectedImages[${fe}][img]`,Ae),Ne.append(`selectedImages[${fe}][img_id]`,Ve)}fetch(`${l}api/admin/checklist/add_evidence.php`,{method:"POST",body:Ne}).then(fe=>fe.json()).then(fe=>{re&&re.some(Ae=>Ae==="1")?le(d,"checklist-pending"):le(d,"enroute")}).catch(fe=>{console.error("Error fetching data:",fe)})}else if(!re&&Q&&ee){let Ne=new FormData;Ne.append("km_inicial",Q),Ne.append("gas_inicial",ee),Ne=pe(Ne),fetch(`${l}api/admin/checklist/add_evidence.php`,{method:"POST",body:Ne}).then(fe=>fe.json()).then(fe=>{le(d,"enroute")}).catch(fe=>{console.error("Error fetching data:",fe)})}else L();return x})}de()},F=async(A,S)=>{E(S);const ee=A.target.files[0],x=await te(ee);if(x){let re=new FormData;re.append("fileToUpload",x),re=pe(re);try{const ke=await fetch(`${l}api/admin/manager/upload_img_driver.php`,{method:"POST",body:re});if(ke.ok){const ce=await ke.json();P={...P,[S]:{img:ce.img,img_id:ce.img_id}},t(12,H={...H,[S]:ce.filename}),ne(S),t(6,C[S].checked=!0,C),t(11,q[S]=!1,q)}else console.error("File upload failed:",ke.statusText)}catch(ke){console.error("Error during file upload:",ke)}}},te=async A=>new Promise(S=>{const Q=new FileReader;Q.onload=ee=>{const x=new Image;x.src=ee.target.result,x.onload=()=>{const re=document.createElement("canvas"),ke=re.getContext("2d"),ce=800,Ne=600;let fe=x.width,Ae=x.height;fe>ce&&(Ae*=ce/fe,fe=ce),Ae>Ne&&(fe*=Ne/Ae,Ae=Ne),re.width=fe,re.height=Ae,ke.drawImage(x,0,0,fe,Ae),re.toBlob(Ve=>{S(Ve)},"image/jpeg",.7)}},Q.readAsDataURL(A)}),ne=A=>{at.update(S=>(S.checkedIndices.indexOf(A)===-1?S.checkedIndices.push(A):console.error(`ID ${A} is already checked.`),S.items.forEach(ee=>{ee.id_checklist_event===A&&(ee.checked=!0)}),S))};function le(A,S){let Q=new FormData;Q.append("id_route",A),Q.append("status",S),Q=pe(Q),fetch(`${l}api/admin/route/change_status.php`,{method:"POST",body:Q}).then(ee=>ee.json()).then(ee=>{}).catch(ee=>{console.error("Error fetching data:",ee)})}function me(A,S){return/^\d+$/.test(A)?parseInt(A,10):(B(S),null)}function ae(A,S){_e(S),n.componentProps.data_type=S,Ue("modal-gas-km",Fn,{r:S}).then(()=>{Ge.subscribe(Q=>{ve(Q,S)})})}function _e(A){$t.update(S=>({...S,flag:[A]}))}function ve(A,S){t(0,O=A.km_inicial?A.km_inicial:null),t(1,g=A.gas_inicial?A.gas_inicial:null),t(2,h=A.km_final?A.km_final:null),t(3,u=A.gas_final?A.gas_final:null),S=="km_inicial"&&z&&t(7,z.checked=!0,z),S=="gas_inicial"&&V&&t(8,V.checked=!0,V),S=="km_final"&&M&&t(9,M.checked=!0,M),S=="gas_final"&&G&&t(10,G.checked=!0,G)}function de(){Ge.set({km_inicial:[],gas_inicial:[],km_final:[],gas_final:[]})}function pe(A){return A.append("token",j.token),A.append("id_user_over",j.id_user),A}const Ee=[[]];function Oe(){p=Qe(Ee[0],this.__value,this.checked),t(4,p)}function we(A){De[A?"unshift":"push"](()=>{M=A,t(9,M)})}const Ce=A=>ae(A,"km_final");function he(){p=Qe(Ee[0],this.__value,this.checked),t(4,p)}function Te(A){De[A?"unshift":"push"](()=>{G=A,t(10,G)})}const ye=A=>ae(A,"gas_final");function Ie(){p=Qe(Ee[0],this.__value,this.checked),t(4,p)}function se(A){De[A?"unshift":"push"](()=>{z=A,t(7,z)})}const $=A=>ae(A,"km_inicial");function ie(A){De[A?"unshift":"push"](()=>{V=A,t(8,V)})}function I(){p=Qe(Ee[0],this.__value,this.checked),t(4,p)}const T=A=>ae(A,"gas_inicial");function D(){p=Qe(Ee[0],this.__value,this.checked),t(4,p)}function N(A,S){De[A?"unshift":"push"](()=>{C[S.id_checklist_event]=A,t(6,C)})}const X=A=>ne(A.id_checklist_event);function K(A){De[A?"unshift":"push"](()=>{b=A,t(5,b)})}return[O,g,h,u,p,b,C,z,V,M,G,q,H,i,_,R,W,F,ne,ae,Oe,Ee,we,Ce,he,Te,ye,Ie,se,$,ie,I,T,D,N,X,K,(A,S)=>F(S,A.id_checklist_event)]}class en extends Je{constructor(e){super(),Ye(this,e,Jn,Wn,We,{},null,[-1,-1])}}function It(r,e,t){const l=r.slice();return l[53]=e[t],l[55]=t,l}function Yn(r){let e,t,l="Confirmar",n,i;return{c(){e=s("ion-buttons"),t=s("ion-button"),t.textContent=l,this.h()},l(f){e=c(f,"ION-BUTTONS",{slot:!0});var d=m(e);t=c(d,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),oe(t)!=="svelte-1ida0il"&&(t.textContent=l),d.forEach(a),this.h()},h(){v(t,"strong",""),v(e,"slot","end")},m(f,d){J(f,e,d),o(e,t),n||(i=ue(t,"click",r[22]),n=!0)},p:ze,d(f){f&&a(e),n=!1,i()}}}function Qn(r){let e,t,l,n,i,f="Teléfono de Negocio",d,_,O=r[13].client_phone+"",g;return{c(){e=s("ion-item"),t=s("ion-icon"),l=y(),n=s("ion-label"),i=s("p"),i.textContent=f,d=y(),_=s("h2"),g=ge(O),this.h()},l(h){e=c(h,"ION-ITEM",{href:!0});var u=m(e);t=c(u,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=w(u),n=c(u,"ION-LABEL",{class:!0});var p=m(n);i=c(p,"P",{"data-svelte-h":!0}),oe(i)!=="svelte-1u5l7fz"&&(i.textContent=f),d=w(p),_=c(p,"H2",{});var b=m(_);g=be(b,O),b.forEach(a),p.forEach(a),u.forEach(a),this.h()},h(){v(t,"icon",vn),v(t,"slot","start"),v(n,"class","ion-text-wrap"),v(e,"href","tel:"+r[13].client_phone)},m(h,u){J(h,e,u),o(e,t),o(e,l),o(e,n),o(n,i),o(n,d),o(n,_),o(_,g)},p:ze,d(h){h&&a(e)}}}function Zn(r){let e,t,l,n,i,f="Domicilio Alternativo",d,_,O=r[13].line2+"",g,h,u;return{c(){e=s("ion-item"),t=s("ion-icon"),l=y(),n=s("ion-label"),i=s("p"),i.textContent=f,d=y(),_=s("h2"),g=ge(O),h=y(),u=s("ion-icon"),this.h()},l(p){e=c(p,"ION-ITEM",{href:!0});var b=m(e);t=c(b,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=w(b),n=c(b,"ION-LABEL",{class:!0});var C=m(n);i=c(C,"P",{"data-svelte-h":!0}),oe(i)!=="svelte-1ub9uzw"&&(i.textContent=f),d=w(C),_=c(C,"H2",{});var z=m(_);g=be(z,O),z.forEach(a),C.forEach(a),h=w(b),u=c(b,"ION-ICON",{icon:!0,slot:!0}),m(u).forEach(a),b.forEach(a),this.h()},h(){v(t,"icon",ht),v(t,"slot","start"),v(n,"class","ion-text-wrap"),v(u,"icon",Re),v(u,"slot","end"),v(e,"href","https://www.google.com/maps/searhc/?api=1&query="+r[13].line2)},m(p,b){J(p,e,b),o(e,t),o(e,l),o(e,n),o(n,i),o(n,d),o(n,_),o(_,g),o(e,h),o(e,u)},p:ze,d(p){p&&a(e)}}}function xn(r){let e,t,l,n,i,f="Domicilio",d,_,O=r[13].line1+"",g,h,u,p,b=r[13].line2&&r[13].line2.trim().length,C,z=b&&$n(r);return{c(){e=s("ion-item"),t=s("ion-icon"),l=y(),n=s("ion-label"),i=s("p"),i.textContent=f,d=y(),_=s("h2"),g=ge(O),h=y(),u=s("ion-icon"),p=y(),z&&z.c(),C=Se(),this.h()},l(V){e=c(V,"ION-ITEM",{href:!0});var M=m(e);t=c(M,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=w(M),n=c(M,"ION-LABEL",{class:!0});var G=m(n);i=c(G,"P",{"data-svelte-h":!0}),oe(i)!=="svelte-cbm7q1"&&(i.textContent=f),d=w(G),_=c(G,"H2",{});var q=m(_);g=be(q,O),q.forEach(a),G.forEach(a),h=w(M),u=c(M,"ION-ICON",{icon:!0,slot:!0}),m(u).forEach(a),M.forEach(a),p=w(V),z&&z.l(V),C=Se(),this.h()},h(){v(t,"icon",ht),v(t,"slot","start"),v(n,"class","ion-text-wrap"),v(u,"icon",Re),v(u,"slot","end"),v(e,"href","https://www.google.com/maps/search/?api=1&query="+r[13].line1)},m(V,M){J(V,e,M),o(e,t),o(e,l),o(e,n),o(n,i),o(n,d),o(n,_),o(_,g),o(e,h),o(e,u),J(V,p,M),z&&z.m(V,M),J(V,C,M)},p(V,M){b&&z.p(V,M)},d(V){V&&(a(e),a(p),a(C)),z&&z.d(V)}}}function $n(r){let e,t,l,n,i,f="Domicilio Alternativo",d,_,O=r[13].line2+"",g,h,u;return{c(){e=s("ion-item"),t=s("ion-icon"),l=y(),n=s("ion-label"),i=s("p"),i.textContent=f,d=y(),_=s("h2"),g=ge(O),h=y(),u=s("ion-icon"),this.h()},l(p){e=c(p,"ION-ITEM",{href:!0});var b=m(e);t=c(b,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=w(b),n=c(b,"ION-LABEL",{class:!0});var C=m(n);i=c(C,"P",{"data-svelte-h":!0}),oe(i)!=="svelte-1ub9uzw"&&(i.textContent=f),d=w(C),_=c(C,"H2",{});var z=m(_);g=be(z,O),z.forEach(a),C.forEach(a),h=w(b),u=c(b,"ION-ICON",{icon:!0,slot:!0}),m(u).forEach(a),b.forEach(a),this.h()},h(){v(t,"icon",ht),v(t,"slot","start"),v(n,"class","ion-text-wrap"),v(u,"icon",Re),v(u,"slot","end"),v(e,"href","https://www.google.com/maps/search/?api=1&query="+r[13].line2)},m(p,b){J(p,e,b),o(e,t),o(e,l),o(e,n),o(n,i),o(n,d),o(n,_),o(_,g),o(e,h),o(e,u)},p:ze,d(p){p&&a(e)}}}function kt(r){let e,t,l,n,i,f="Contacto del Cliente",d,_,O,g,h=r[17]&&r[17]==="1"&&eo(r);return{c(){e=s("ion-item"),t=s("ion-icon"),l=y(),n=s("ion-label"),i=s("p"),i.textContent=f,d=y(),_=s("h2"),O=ge(r[6]),g=y(),h&&h.c(),this.h()},l(u){e=c(u,"ION-ITEM",{});var p=m(e);t=c(p,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=w(p),n=c(p,"ION-LABEL",{class:!0});var b=m(n);i=c(b,"P",{"data-svelte-h":!0}),oe(i)!=="svelte-1utsyb6"&&(i.textContent=f),d=w(b),_=c(b,"H2",{});var C=m(_);O=be(C,r[6]),C.forEach(a),b.forEach(a),g=w(p),h&&h.l(p),p.forEach(a),this.h()},h(){v(t,"icon",gn),v(t,"slot","start"),v(n,"class","ion-text-wrap")},m(u,p){J(u,e,p),o(e,t),o(e,l),o(e,n),o(n,i),o(n,d),o(n,_),o(_,O),o(e,g),h&&h.m(e,null)},p(u,p){p[0]&64&&Le(O,u[6]),u[17]&&u[17]==="1"&&h.p(u,p)},d(u){u&&a(e),h&&h.d()}}}function eo(r){let e,t=`<ion-icon icon="${On}" slot="start"></ion-icon>
                        Notificar Cliente`,l,n;return{c(){e=s("ion-button"),e.innerHTML=t,this.h()},l(i){e=c(i,"ION-BUTTON",{fill:!0,style:!0,"data-svelte-h":!0}),oe(e)!=="svelte-w3qtwm"&&(e.innerHTML=t),this.h()},h(){v(e,"fill","outline"),k(e,"margin-left","16px")},m(i,f){J(i,e,f),l||(n=ue(e,"click",r[23]),l=!0)},p:ze,d(i){i&&a(e),l=!1,n()}}}function Ot(r){let e,t,l,n,i,f="Notas de ubicación",d,_,O;return{c(){e=s("ion-item"),t=s("ion-icon"),l=y(),n=s("ion-label"),i=s("p"),i.textContent=f,d=y(),_=s("h2"),O=ge(r[7]),this.h()},l(g){e=c(g,"ION-ITEM",{});var h=m(e);t=c(h,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=w(h),n=c(h,"ION-LABEL",{class:!0});var u=m(n);i=c(u,"P",{"data-svelte-h":!0}),oe(i)!=="svelte-nhm2ft"&&(i.textContent=f),d=w(u),_=c(u,"H2",{});var p=m(_);O=be(p,r[7]),p.forEach(a),u.forEach(a),h.forEach(a),this.h()},h(){v(t,"icon",Qt),v(t,"slot","start"),v(n,"class","ion-text-wrap")},m(g,h){J(g,e,h),o(e,t),o(e,l),o(e,n),o(n,i),o(n,d),o(n,_),o(_,O)},p(g,h){h[0]&128&&Le(O,g[7])},d(g){g&&a(e)}}}function to(r){let e,t,l,n,i,f="Horarios",d,_,O=r[13].schedule+"",g;return{c(){e=s("ion-item"),t=s("ion-icon"),l=y(),n=s("ion-label"),i=s("p"),i.textContent=f,d=y(),_=s("h2"),g=ge(O),this.h()},l(h){e=c(h,"ION-ITEM",{});var u=m(e);t=c(u,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=w(u),n=c(u,"ION-LABEL",{});var p=m(n);i=c(p,"P",{"data-svelte-h":!0}),oe(i)!=="svelte-11q7hm5"&&(i.textContent=f),d=w(p),_=c(p,"H2",{});var b=m(_);g=be(b,O),b.forEach(a),p.forEach(a),u.forEach(a),this.h()},h(){v(t,"icon",bn),v(t,"slot","start")},m(h,u){J(h,e,u),o(e,t),o(e,l),o(e,n),o(n,i),o(n,d),o(n,_),o(_,g)},p:ze,d(h){h&&a(e)}}}function no(r){let e,t,l,n,i,f="Notas del operador",d,_,O=r[13].driver_comments+"",g;return{c(){e=s("ion-item"),t=s("ion-icon"),l=y(),n=s("ion-label"),i=s("p"),i.textContent=f,d=y(),_=s("h2"),g=ge(O),this.h()},l(h){e=c(h,"ION-ITEM",{});var u=m(e);t=c(u,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=w(u),n=c(u,"ION-LABEL",{});var p=m(n);i=c(p,"P",{"data-svelte-h":!0}),oe(i)!=="svelte-1yk9qp4"&&(i.textContent=f),d=w(p),_=c(p,"H2",{});var b=m(_);g=be(b,O),b.forEach(a),p.forEach(a),u.forEach(a),this.h()},h(){v(t,"icon",Zt),v(t,"slot","start")},m(h,u){J(h,e,u),o(e,t),o(e,l),o(e,n),o(n,i),o(n,d),o(n,_),o(_,g)},p:ze,d(h){h&&a(e)}}}function oo(r){let e,t=r[13].logistic_comments!="<br>"&&lo(r);return{c(){t&&t.c(),e=Se()},l(l){t&&t.l(l),e=Se()},m(l,n){t&&t.m(l,n),J(l,e,n)},p(l,n){l[13].logistic_comments!="<br>"&&t.p(l,n)},d(l){l&&a(e),t&&t.d(l)}}}function lo(r){let e,t,l,n,i,f="Comentarios logísticos",d,_,O=r[13].logistic_comments+"",g;return{c(){e=s("ion-item"),t=s("ion-icon"),l=y(),n=s("ion-label"),i=s("p"),i.textContent=f,d=y(),_=s("h2"),g=ge(O),this.h()},l(h){e=c(h,"ION-ITEM",{});var u=m(e);t=c(u,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=w(u),n=c(u,"ION-LABEL",{class:!0});var p=m(n);i=c(p,"P",{"data-svelte-h":!0}),oe(i)!=="svelte-1iz85r6"&&(i.textContent=f),d=w(p),_=c(p,"H2",{});var b=m(_);g=be(b,O),b.forEach(a),p.forEach(a),u.forEach(a),this.h()},h(){v(t,"icon",Qt),v(t,"slot","start"),v(n,"class","ion-text-wrap")},m(h,u){J(h,e,u),o(e,t),o(e,l),o(e,n),o(n,i),o(n,d),o(n,_),o(_,g)},p:ze,d(h){h&&a(e)}}}function Nt(r){let e,t,l,n;return{c(){e=s("ion-item"),t=s("ion-icon"),l=y(),n=s("ion-textarea"),this.h()},l(i){e=c(i,"ION-ITEM",{});var f=m(e);t=c(f,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=w(f),n=c(f,"ION-TEXTAREA",{placeholder:!0}),m(n).forEach(a),f.forEach(a),this.h()},h(){v(t,"icon",En),v(t,"slot","start"),v(n,"placeholder","Escribe el motivo...")},m(i,f){J(i,e,f),o(e,t),o(e,l),o(e,n),r[29](n)},p:ze,d(i){i&&a(e),r[29](null)}}}function io(r){let e,t,l,n,i,f="Estado de entrega",d,_,O="Entregado",g,h,u="No Entregado",p,b,C="Entrega Parcial",z,V,M,G,q,j,P,H,E=r[4]===!0&&Tt(r),L=(r[5]===!0||r[5]===!1&&r[4]===!1)&&Ct(r);return{c(){e=s("ion-item"),t=s("ion-icon"),l=y(),n=s("ion-select"),i=s("div"),i.textContent=f,d=y(),_=s("ion-select-option"),_.textContent=O,g=y(),h=s("ion-select-option"),h.textContent=u,p=y(),b=s("ion-select-option"),b.textContent=C,z=y(),V=s("ion-item"),M=s("ion-icon"),G=y(),q=s("ion-textarea"),j=y(),P=s("section"),E&&E.c(),H=y(),L&&L.c(),this.h()},l(U){e=c(U,"ION-ITEM",{});var B=m(e);t=c(B,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=w(B),n=c(B,"ION-SELECT",{value:!0});var R=m(n);i=c(R,"DIV",{slot:!0,"data-svelte-h":!0}),oe(i)!=="svelte-1635zca"&&(i.textContent=f),d=w(R),_=c(R,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),oe(_)!=="svelte-s33eln"&&(_.textContent=O),g=w(R),h=c(R,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),oe(h)!=="svelte-1a859l3"&&(h.textContent=u),p=w(R),b=c(R,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),oe(b)!=="svelte-1c4dcm8"&&(b.textContent=C),R.forEach(a),B.forEach(a),z=w(U),V=c(U,"ION-ITEM",{});var W=m(V);M=c(W,"ION-ICON",{icon:!0,slot:!0}),m(M).forEach(a),G=w(W),q=c(W,"ION-TEXTAREA",{label:!0,placeholder:!0}),m(q).forEach(a),W.forEach(a),j=w(U),P=c(U,"SECTION",{style:!0});var F=m(P);E&&E.l(F),H=w(F),L&&L.l(F),F.forEach(a),this.h()},h(){v(t,"icon",In),v(t,"slot","start"),Y(i,"slot","label"),v(_,"value","delivered"),v(h,"value","notdelivered"),v(b,"value","partialdeliver"),v(n,"value",r[16]?r[16]:"delivered"),v(M,"icon",ct),v(M,"slot","start"),v(q,"label","Notas"),v(q,"placeholder","Escribe aquí..."),k(P,"display","flex"),k(P,"gap","8px"),k(P,"padding","16px 16px 6px")},m(U,B){J(U,e,B),o(e,t),o(e,l),o(e,n),o(n,i),o(n,d),o(n,_),o(n,g),o(n,h),o(n,p),o(n,b),r[30](n),J(U,z,B),J(U,V,B),o(V,M),o(V,G),o(V,q),r[31](q),J(U,j,B),J(U,P,B),E&&E.m(P,null),o(P,H),L&&L.m(P,null)},p(U,B){U[4]===!0?E?E.p(U,B):(E=Tt(U),E.c(),E.m(P,H)):E&&(E.d(1),E=null),U[5]===!0||U[5]===!1&&U[4]===!1?L?L.p(U,B):(L=Ct(U),L.c(),L.m(P,null)):L&&(L.d(1),L=null)},d(U){U&&(a(e),a(z),a(V),a(j),a(P)),r[30](null),r[31](null),E&&E.d(),L&&L.d()}}}function Tt(r){let e,t=`<ion-icon icon="${Nn}" slot="start"></ion-icon>
                        Ingreso`,l,n;return{c(){e=s("ion-button"),e.innerHTML=t,this.h()},l(i){e=c(i,"ION-BUTTON",{id:!0,style:!0,"data-svelte-h":!0}),oe(e)!=="svelte-3onvnr"&&(e.innerHTML=t),this.h()},h(){v(e,"id","checkInBtn"),k(e,"flex","1")},m(i,f){J(i,e,f),l||(n=ue(e,"click",r[24]),l=!0)},p:ze,d(i){i&&a(e),l=!1,n()}}}function Ct(r){let e,t,l,n,i,f;return{c(){e=s("ion-button"),t=s("ion-icon"),l=ge(`
                        Salida`),this.h()},l(d){e=c(d,"ION-BUTTON",{id:!0,style:!0,disabled:!0});var _=m(e);t=c(_,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),l=be(_,`
                        Salida`),_.forEach(a),this.h()},h(){v(t,"icon",kn),v(t,"slot","start"),v(e,"id","checkOutBtn"),k(e,"flex","1"),v(e,"disabled",n=r[5]===!1)},m(d,_){J(d,e,_),o(e,t),o(e,l),i||(f=ue(e,"click",r[25]),i=!0)},p(d,_){_[0]&32&&n!==(n=d[5]===!1)&&v(e,"disabled",n)},d(d){d&&a(e),i=!1,f()}}}function ro(r){let e,t,l,n,i,f="Subir Evidencia",d,_,O,g;return{c(){e=s("section"),t=s("ion-button"),l=s("ion-icon"),n=y(),i=s("label"),i.textContent=f,d=y(),_=s("input"),this.h()},l(h){e=c(h,"SECTION",{style:!0});var u=m(e);t=c(u,"ION-BUTTON",{fill:!0,class:!0,style:!0});var p=m(t);l=c(p,"ION-ICON",{icon:!0,slot:!0}),m(l).forEach(a),n=w(p),i=c(p,"LABEL",{for:!0,"data-svelte-h":!0}),oe(i)!=="svelte-1wg51s6"&&(i.textContent=f),d=w(p),_=c(p,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0,capture:!0}),p.forEach(a),u.forEach(a),this.h()},h(){v(l,"icon",xt),v(l,"slot","start"),Y(i,"for","eventEvidence"),k(_,"display","none"),Y(_,"id","eventEvidence"),Y(_,"name","fileToUpload"),Y(_,"type","file"),_.multiple=!0,Y(_,"accept","image/*"),Y(_,"capture","environment"),v(t,"fill","outline"),v(t,"class","loadEvidence"),k(t,"flex","1"),k(e,"display","flex"),k(e,"gap","8px"),k(e,"padding","0px 16px")},m(h,u){J(h,e,u),o(e,t),o(t,l),o(t,n),o(t,i),o(t,d),o(t,_),O||(g=[ue(_,"change",r[18]),ue(_,"click",r[19])],O=!0)},p:ze,d(h){h&&a(e),O=!1,He(g)}}}function yt(r){let e,t,l=Be(r[2]),n=[];for(let i=0;i<l.length;i+=1)n[i]=wt(It(r,l,i));return{c(){e=s("section"),t=s("div");for(let i=0;i<n.length;i+=1)n[i].c();this.h()},l(i){e=c(i,"SECTION",{});var f=m(e);t=c(f,"DIV",{class:!0,style:!0});var d=m(t);for(let _=0;_<n.length;_+=1)n[_].l(d);d.forEach(a),f.forEach(a),this.h()},h(){Y(t,"class","image-grid"),k(t,"display","grid"),k(t,"grid-template-columns","repeat(auto-fill, minmax(100px, 1fr))"),k(t,"gap","10px"),k(t,"padding","0px 10px")},m(i,f){J(i,e,f),o(e,t);for(let d=0;d<n.length;d+=1)n[d]&&n[d].m(t,null)},p(i,f){if(f[0]&69206020){l=Be(i[2]);let d;for(d=0;d<l.length;d+=1){const _=It(i,l,d);n[d]?n[d].p(_,f):(n[d]=wt(_),n[d].c(),n[d].m(t,null))}for(;d<n.length;d+=1)n[d].d(1);n.length=l.length}},d(i){i&&a(e),on(n,i)}}}function wt(r){let e,t,l,n,i,f=`<ion-icon icon="${Tn}"></ion-icon>`,d,_,O;function g(){return r[32](r[53])}function h(){return r[33](r[55])}return{c(){e=s("div"),t=s("ion-img"),n=y(),i=s("button"),i.innerHTML=f,d=y(),this.h()},l(u){e=c(u,"DIV",{class:!0,style:!0});var p=m(e);t=c(p,"ION-IMG",{src:!0,alt:!0,style:!0}),m(t).forEach(a),n=w(p),i=c(p,"BUTTON",{class:!0,style:!0,"data-svelte-h":!0}),oe(i)!=="svelte-zguiov"&&(i.innerHTML=f),d=w(p),p.forEach(a),this.h()},h(){Ke(t.src,l=r[53])||v(t,"src",l),v(t,"alt","Evidencia fotográfica"),k(t,"width","100%"),k(t,"height","100px"),k(t,"object-fit","cover"),k(t,"cursor","pointer"),k(t,"border","1px solid #ccc"),k(t,"border-radius","4px"),k(t,"margin-top","16px"),Y(i,"class","remove-button"),k(i,"position","absolute"),k(i,"top","5px"),k(i,"right","5px"),k(i,"border","none"),k(i,"cursor","pointer"),k(i,"font-size","18px"),k(i,"background","white"),k(i,"border-radius","50%"),k(i,"padding","3px 4px 0px"),k(i,"box-shadow","2px 2px 6px rgba(0, 0, 0, 0.3)"),k(i,"color","#0000008f"),Y(e,"class","image-container"),k(e,"position","relative")},m(u,p){J(u,e,p),o(e,t),o(e,n),o(e,i),o(e,d),_||(O=[ue(t,"click",g),ue(i,"click",h)],_=!0)},p(u,p){r=u,p[0]&4&&!Ke(t.src,l=r[53])&&v(t,"src",l)},d(u){u&&a(e),_=!1,He(O)}}}function Lt(r){let e,t='<ion-spinner name="dots" style="color:white;"></ion-spinner>';return{c(){e=s("div"),e.innerHTML=t,this.h()},l(l){e=c(l,"DIV",{class:!0,style:!0,"data-svelte-h":!0}),oe(e)!=="svelte-h8s7r2"&&(e.innerHTML=t),this.h()},h(){Y(e,"class","overlay"),k(e,"position","fixed"),k(e,"top","0"),k(e,"left","0"),k(e,"width","100vw"),k(e,"height","100vh"),k(e,"background","rgba(0, 0, 0, 0.5)"),k(e,"display","flex"),k(e,"align-items","center"),k(e,"justify-content","center"),k(e,"z-index","9999")},m(l,n){J(l,e,n)},d(l){l&&a(e)}}}function zt(r){let e,t,l,n,i,f,d=`<ion-icon icon="${Cn}"></ion-icon>`,_,O;return{c(){e=s("div"),t=s("div"),l=s("ion-img"),i=y(),f=s("button"),f.innerHTML=d,this.h()},l(g){e=c(g,"DIV",{class:!0,style:!0});var h=m(e);t=c(h,"DIV",{class:!0,style:!0});var u=m(t);l=c(u,"ION-IMG",{src:!0,alt:!0,style:!0}),m(l).forEach(a),i=w(u),f=c(u,"BUTTON",{class:!0,style:!0,"data-svelte-h":!0}),oe(f)!=="svelte-g0qr0o"&&(f.innerHTML=d),u.forEach(a),h.forEach(a),this.h()},h(){Ke(l.src,n=r[11])||v(l,"src",n),v(l,"alt","Evidencia fotográfica"),k(l,"width","100%"),k(l,"height","auto"),Y(f,"class","close-button"),k(f,"position","absolute"),k(f,"top","5px"),k(f,"right","5px"),k(f,"background","white"),k(f,"color","#444444d1"),k(f,"border","none"),k(f,"cursor","pointer"),k(f,"padding","2px 2px 0px 6px"),k(f,"border-radius","50%"),k(f,"font-size","20px"),Y(t,"class","modal-content"),k(t,"position","relative"),k(t,"background","white"),k(t,"padding","20px"),k(t,"border-radius","8px"),k(t,"max-width","90vw"),k(t,"max-height","90vh"),k(t,"overflow","auto"),Y(e,"class","modal-overlay"),k(e,"position","fixed"),k(e,"top","0"),k(e,"left","0"),k(e,"width","100vw"),k(e,"height","100vh"),k(e,"background","rgba(0, 0, 0, 0.8)"),k(e,"display","flex"),k(e,"justify-content","center"),k(e,"align-items","center"),k(e,"z-index","1000")},m(g,h){J(g,e,h),o(e,t),o(t,l),o(t,i),o(t,f),_||(O=[ue(f,"click",r[27]),ue(t,"click",ln(r[28])),ue(e,"click",r[27])],_=!0)},p(g,h){h[0]&2048&&!Ke(l.src,n=g[11])&&v(l,"src",n)},d(g){g&&a(e),_=!1,He(O)}}}function ao(r){let e,t,l,n,i="Cerrar",f,d,_=r[13].title+"",O,g,h,u,p,b,C,z,V,M,G="Negocio",q,j,P=r[13].client_name+"",H,E,L=r[13].client_phone&&r[13].client_phone.trim().length,U,B,R,W,F=r[13].schedule&&r[13].schedule.trim().length,te,ne,le=r[13].logistic_comments&&r[13].logistic_comments.trim().length,me,ae,_e,ve,de,pe,Ee,Oe,we,Ce=(!r[14]&&!r[15]||r[14]&&r[15])&&Yn(r),he=L&&Qn(r);function Te(S,Q){if(S[13].line1&&S[13].line1.trim().length)return xn;if(S[13].line2&&S[13].line2.trim().length)return Zn}let ye=Te(r),Ie=ye&&ye(r),se=r[6]&&kt(r),$=r[7]&&r[7]!=="<br>"&&Ot(r),ie=F&&to(r),I=r[13].driver_comments&&no(r),T=le&&oo(r),D=r[8]&&Nt(r),N=!r[15]&&io(r),X=(r[14]&&r[15]||!r[14]&&!r[15])&&ro(r),K=r[1]&&yt(r),Z=r[3]&&Lt(),A=r[10]&&zt(r);return{c(){e=s("ion-header"),t=s("ion-toolbar"),l=s("ion-buttons"),n=s("ion-button"),n.textContent=i,f=y(),d=s("ion-title"),O=ge(_),g=y(),Ce&&Ce.c(),h=y(),u=s("ion-content"),p=s("ion-list"),b=s("ion-item"),C=s("ion-icon"),z=y(),V=s("ion-label"),M=s("p"),M.textContent=G,q=y(),j=s("h2"),H=ge(P),E=y(),he&&he.c(),U=y(),Ie&&Ie.c(),B=y(),se&&se.c(),R=y(),$&&$.c(),W=y(),ie&&ie.c(),te=y(),I&&I.c(),ne=y(),T&&T.c(),me=y(),D&&D.c(),ae=y(),N&&N.c(),_e=y(),X&&X.c(),ve=y(),K&&K.c(),de=y(),Z&&Z.c(),pe=y(),A&&A.c(),Ee=Se(),this.h()},l(S){e=c(S,"ION-HEADER",{translucent:!0});var Q=m(e);t=c(Q,"ION-TOOLBAR",{});var ee=m(t);l=c(ee,"ION-BUTTONS",{slot:!0});var x=m(l);n=c(x,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),oe(n)!=="svelte-2ks32x"&&(n.textContent=i),x.forEach(a),f=w(ee),d=c(ee,"ION-TITLE",{style:!0,title:!0});var re=m(d);O=be(re,_),re.forEach(a),g=w(ee),Ce&&Ce.l(ee),ee.forEach(a),Q.forEach(a),h=w(S),u=c(S,"ION-CONTENT",{fullscreen:!0});var ke=m(u);p=c(ke,"ION-LIST",{});var ce=m(p);b=c(ce,"ION-ITEM",{});var Ne=m(b);C=c(Ne,"ION-ICON",{icon:!0,slot:!0}),m(C).forEach(a),z=w(Ne),V=c(Ne,"ION-LABEL",{});var fe=m(V);M=c(fe,"P",{"data-svelte-h":!0}),oe(M)!=="svelte-57b1dg"&&(M.textContent=G),q=w(fe),j=c(fe,"H2",{});var Ae=m(j);H=be(Ae,P),Ae.forEach(a),fe.forEach(a),Ne.forEach(a),E=w(ce),he&&he.l(ce),U=w(ce),Ie&&Ie.l(ce),B=w(ce),se&&se.l(ce),R=w(ce),$&&$.l(ce),W=w(ce),ie&&ie.l(ce),te=w(ce),I&&I.l(ce),ne=w(ce),T&&T.l(ce),me=w(ce),D&&D.l(ce),ae=w(ce),N&&N.l(ce),_e=w(ce),X&&X.l(ce),ve=w(ce),K&&K.l(ce),ce.forEach(a),ke.forEach(a),de=w(S),Z&&Z.l(S),pe=w(S),A&&A.l(S),Ee=Se(),this.h()},h(){v(n,"color","medium"),v(l,"slot","start"),k(d,"text-align","center"),v(d,"title",r[13].title),v(e,"translucent",""),v(C,"icon",mn),v(C,"slot","start"),v(u,"fullscreen","")},m(S,Q){J(S,e,Q),o(e,t),o(t,l),o(l,n),o(t,f),o(t,d),o(d,O),o(t,g),Ce&&Ce.m(t,null),J(S,h,Q),J(S,u,Q),o(u,p),o(p,b),o(b,C),o(b,z),o(b,V),o(V,M),o(V,q),o(V,j),o(j,H),o(p,E),he&&he.m(p,null),o(p,U),Ie&&Ie.m(p,null),o(p,B),se&&se.m(p,null),o(p,R),$&&$.m(p,null),o(p,W),ie&&ie.m(p,null),o(p,te),I&&I.m(p,null),o(p,ne),T&&T.m(p,null),o(p,me),D&&D.m(p,null),o(p,ae),N&&N.m(p,null),o(p,_e),X&&X.m(p,null),o(p,ve),K&&K.m(p,null),J(S,de,Q),Z&&Z.m(S,Q),J(S,pe,Q),A&&A.m(S,Q),J(S,Ee,Q),Oe||(we=ue(n,"click",r[20]),Oe=!0)},p(S,Q){(!S[14]&&!S[15]||S[14]&&S[15])&&Ce.p(S,Q),L&&he.p(S,Q),Ie&&Ie.p(S,Q),S[6]?se?se.p(S,Q):(se=kt(S),se.c(),se.m(p,R)):se&&(se.d(1),se=null),S[7]&&S[7]!=="<br>"?$?$.p(S,Q):($=Ot(S),$.c(),$.m(p,W)):$&&($.d(1),$=null),F&&ie.p(S,Q),S[13].driver_comments&&I.p(S,Q),le&&T.p(S,Q),S[8]?D?D.p(S,Q):(D=Nt(S),D.c(),D.m(p,ae)):D&&(D.d(1),D=null),S[15]||N.p(S,Q),(S[14]&&S[15]||!S[14]&&!S[15])&&X.p(S,Q),S[1]?K?K.p(S,Q):(K=yt(S),K.c(),K.m(p,null)):K&&(K.d(1),K=null),S[3]?Z||(Z=Lt(),Z.c(),Z.m(pe.parentNode,pe)):Z&&(Z.d(1),Z=null),S[10]?A?A.p(S,Q):(A=zt(S),A.c(),A.m(Ee.parentNode,Ee)):A&&(A.d(1),A=null)},i:ze,o:ze,d(S){S&&(a(e),a(h),a(u),a(de),a(pe),a(Ee)),Ce&&Ce.d(),he&&he.d(),Ie&&Ie.d(),se&&se.d(),$&&$.d(),ie&&ie.d(),I&&I.d(),T&&T.d(),D&&D.d(),N&&N.d(),X&&X.d(),K&&K.d(),Z&&Z.d(S),A&&A.d(S),Oe=!1,we()}}}const At=/Teléfono:\s*(\d{10,})/;function lt(r=""){return r.split(",").map(t=>t.trim())}function so(r,e,t){let l=rt,n=document.querySelector("ion-modal"),i=n.componentProps.delivery,f=n.componentProps.isLast||!1,d=n.componentProps.flag||!1,_=i.driver_comments?i.driver_comments:"",O=i.deliver_status?i.deliver_status:"",g=i.img?i.img:"",h=i.img_id?i.img_id:"",u=g?lt(g):new Array,p=h?lt(h):new Array,b={latitude:null,longitude:null},C=i.stopsApproval,z=i.smsActive,V=!1,M=!0,G=!1,q="",j=i.comments_ext,P=!1,H="",E=!1,L="",U=new Object,B="";Ze(()=>{U=JSON.parse(localStorage.getItem("userSession")),W()});async function R(N="",X,K={}){let Z=new FormData;t(3,V=!0);for(const[A,S]of Object.entries(K))Z.append(A,S);Z=Ie(Z);try{const A=await fetch(N,{method:"POST",body:Z});if(A.ok){const S=await A.json();X(S)}else console.error("Request failed:",A.statusText)}catch(A){console.error("Error during file upload:",A)}finally{t(3,V=!1)}}function W(){i.date_service?i.date_service&&!i.date_completed&&!i.service_time?(t(4,M=!1),t(5,G=!0)):i.date_service&&i.date_completed&&i.service_time&&(t(4,M=!1),t(5,G=!1)):(t(4,M=!0),t(5,G=!1))}if(i.comments_ext){const N=i.comments_ext.match(At);N&&(q=N[1],j=i.comments_ext.replace(At,"").trim())}const F=async(N,X)=>{await(await je.create({header:N||"Error",message:X||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()},te=async(N="",X="",K="",Z,A={})=>{await(await je.create({header:N||"Error",message:X||"Vuelva a intentar",buttons:[{text:"No",role:"cancel",handler:()=>{}},{text:"Sí",handler:()=>{R(K,Z,A)}}]})).present()},ne=async N=>{if(u.length==5)F("Límite de evidencias","Solo se permite subir 5 fotos por parada");else if(d&&f&&u.length==1)F("Límite de evidencias","Para el final de la ruta solo se permite subir 1 foto");else{const Z=N.target.files[0],A=await ae(Z);if(A){t(1,g=u.join(",")),h=p.join(",");var X=new Object;X.fileToUpload=A,R(`${l}api/admin/manager/upload_img_driver.php`,function(S){t(1,g=g?`${g},${S.img}`:S.img),h=h?`${h},${S.img_id}`:S.img_id,t(2,u=lt(g)),p=lt(h)},X)}}};function le(N){var X=i.service_time;!X&&M&&!f&&!d&&(N.preventDefault(),F("Registrar Ingreso","Antes de subir la evidencia registra el ingreso a la actual parada."))}function me(){var N=d?i.date_completed:!1;if(!N&&!M&&G&&!f&&!d){var X=new Object;X.id_event=i.id_event,X.type="checkout",te("Registrar Salida","¿Completaste tu entrega?",l+"api/admin/route/record_check_date.php",function(K){K.minutes&&F("Tiempo por parada","Completaste la parada en "+K.minutes+" minutos.")},X)}}const ae=async N=>new Promise(X=>{const K=new FileReader;K.onload=Z=>{const A=new Image;A.src=Z.target.result,A.onload=()=>{const S=document.createElement("canvas"),Q=S.getContext("2d"),ee=800,x=600;let re=A.width,ke=A.height;re>ee&&(ke*=ee/re,re=ee),ke>x&&(re*=x/ke,ke=x),S.width=re,S.height=ke,Q.drawImage(A,0,0,re,ke),S.toBlob(ce=>{X(ce)},"image/jpeg",.7)}},K.readAsDataURL(N)}),_e=()=>{n.dismiss({data:Date.now()})};function ve(N){t(2,u=u.filter((X,K)=>K!==N))}const de=async()=>{try{if(t(3,V=!0),t(1,g=u.join(",")),h=p.join(","),me(),await Ee())if(B.value=="delivered"||B.value!=="delivered"&&(_.value||i.driver_comments)||d&&f){const X={id_route:i.id_route,...!d&&!f&&{id_event:i.id_event},...!d&&!f&&{comments:_.value},...!d&&!f&&{deliver_status:B.value},img:g,img_id:h,lat:b.latitude,lon:b.longitude,...C==="0"&&{approve:"0"},...f&&{isLast:!0},...d&&f&&{destiny:!0}};X.img&&X.img_id||g?R(`${l}api/admin/evidence/send_evidence.php`,function(K){if(K.success==!0){const Z=X.id_route;_e(),f&&pe("","",Z,f),t(3,V=!1)}else F("Carga fallida","Actualiza la página y vuelve a intentar cargar la información!")},X):F("Información incompleta","Cargar evidencia fotográfica faltante para completar parada.")}else F("Motivo de status de entrega","Favor de ingresar en notas el motivo por el que la entrega no fue entregada correctamente");else F("Ubicación faltante","Asegúrate darle permisos a Rutaflow para acceder a tu ubicación")}catch(N){console.error("Error fetching data:",N)}},pe=(N,X,K,Z)=>{n.componentProps.routeId=K,n.componentProps.driverId=i.id_driver,Ue("modal-km-gas",en,{checklist:N,driverId:X,routeId:K,isLast:Z}).then(A=>{})},Ee=async()=>navigator.geolocation?new Promise((N,X)=>{navigator.geolocation.getCurrentPosition(K=>{b.latitude=K.coords.latitude,b.longitude=K.coords.longitude,N(!0)},K=>{console.error("Error getting location:",K),N(!1)})}):(console.error("Geolocation is not supported by your browser"),!1);async function Oe(N){N.stopPropagation();let X=new FormData;X.append("client_phone",q),X.append("client_name",i.title),X.append("delivery_phone",i.client_phone),X.append("enterprise_name",i.enterprise_name),X=Ie(X);try{const K=await fetch(`${l}api/admin/message_central/send_sms.php`,{method:"POST",body:X});if(K.ok){const Z=await K.json();F("SMS enviado","Se envío correctamente un SMS a "+i.title+" con número de teléfono: "+q)}else F("SMS no enviado","Hubo un error al enviar SMS a "+i.title+" con número de teléfono: "+phoneNumber0+". Por favor contacte a soporte.")}catch(K){console.error("Error during file upload:",K)}}function we(){t(4,M=!1),t(5,G=!0),he(i.id_event,"checkin")}function Ce(){t(5,G=!1),t(4,M=!1),he(i.id_event,"checkout")}async function he(N,X){if(X){let K=new FormData;K.append("type",X),K.append("id_event",N),K=Ie(K);try{const Z=await fetch(`${l}api/admin/route/record_check_date.php`,{method:"POST",body:K});if(Z.ok){const A=await Z.json();A.minutes&&F("Tiempo por parada","Completaste la parada en "+A.minutes+" minutos.")}else console.error("File upload failed:",Z.statusText)}catch(Z){console.error("Error during file upload:",Z)}finally{}}}const Te=N=>{t(11,L=N),t(10,E=!0)},ye=()=>{t(10,E=!1),t(11,L=null)};function Ie(N){return N.append("token",U.token),N.append("id_user_over",U.id_user),N}function se(N){rn.call(this,r,N)}function $(N){De[N?"unshift":"push"](()=>{H=N,t(9,H)})}function ie(N){De[N?"unshift":"push"](()=>{B=N,t(12,B)})}function I(N){De[N?"unshift":"push"](()=>{_=N,t(0,_)})}return[_,g,u,V,M,G,q,j,P,H,E,L,B,i,f,d,O,z,ne,le,_e,ve,de,Oe,we,Ce,Te,ye,se,$,ie,I,N=>Te(N),N=>ve(N)]}class Mt extends Je{constructor(e){super(),Ye(this,e,so,ao,We,{},null,[-1,-1])}}function St(r){let e,t,l;return{c(){e=s("section"),t=s("ion-img"),this.h()},l(n){e=c(n,"SECTION",{});var i=m(e);t=c(i,"ION-IMG",{src:!0,alt:!0,style:!0}),m(t).forEach(a),i.forEach(a),this.h()},h(){Ke(t.src,l=r[0])||v(t,"src",l),v(t,"alt","Evidencia fotográfica"),k(t,"max-width","100%"),k(t,"margin-top","16px")},m(n,i){J(n,e,i),o(e,t)},p(n,i){i&1&&!Ke(t.src,l=n[0])&&v(t,"src",l)},d(n){n&&a(e)}}}function Dt(r){let e,t='<ion-spinner name="dots" style="color:white;"></ion-spinner>';return{c(){e=s("div"),e.innerHTML=t,this.h()},l(l){e=c(l,"DIV",{class:!0,style:!0,"data-svelte-h":!0}),oe(e)!=="svelte-h8s7r2"&&(e.innerHTML=t),this.h()},h(){Y(e,"class","overlay"),k(e,"position","fixed"),k(e,"top","0"),k(e,"left","0"),k(e,"width","100vw"),k(e,"height","100vh"),k(e,"background","rgba(0, 0, 0, 0.5)"),k(e,"display","flex"),k(e,"align-items","center"),k(e,"justify-content","center"),k(e,"z-index","9999")},m(l,n){J(l,e,n)},d(l){l&&a(e)}}}function co(r){let e,t,l,n,i="Cancelar",f,d,_="AGREGAR GASTO",O,g,h,u,p,b,C,z,V,M,G,q,j,P,H,E,L,U,B='Tipo de pago <ion-text color="danger">(Obligatorio)</ion-text>',R,W,F="Efectivo",te,ne,le="Tarjeta",me,ae,_e="Transferencia",ve,de,pe,Ee,Oe,we,Ce,he,Te,ye,Ie=`<ion-icon icon="${xt}" slot="start"></ion-icon>
                        Subir Evidencia`,se,$,ie,I,T,D,N,X="Confirmar",K,Z,A,S,Q=r[0]&&St(r),ee=r[5]&&Dt();return{c(){e=s("ion-header"),t=s("ion-toolbar"),l=s("ion-buttons"),n=s("ion-button"),n.textContent=i,f=y(),d=s("ion-title"),d.textContent=_,O=y(),g=s("ion-content"),h=s("ion-list"),u=s("ion-item"),p=s("ion-icon"),b=y(),C=s("ion-input"),z=y(),V=s("ion-item"),M=s("ion-icon"),G=y(),q=s("ion-input"),j=y(),P=s("ion-item"),H=s("ion-icon"),E=y(),L=s("ion-select"),U=s("div"),U.innerHTML=B,R=y(),W=s("ion-select-option"),W.textContent=F,te=y(),ne=s("ion-select-option"),ne.textContent=le,me=y(),ae=s("ion-select-option"),ae.textContent=_e,ve=y(),de=s("ion-item"),pe=s("ion-icon"),Ee=y(),Oe=s("ion-textarea"),we=y(),Ce=s("section"),he=s("label"),Te=s("ion-button"),ye=s("label"),ye.innerHTML=Ie,se=y(),$=s("input"),ie=y(),Q&&Q.c(),I=y(),T=s("ion-footer"),D=s("ion-toolbar"),N=s("ion-button"),N.textContent=X,K=y(),ee&&ee.c(),Z=Se(),this.h()},l(x){e=c(x,"ION-HEADER",{translucent:!0});var re=m(e);t=c(re,"ION-TOOLBAR",{});var ke=m(t);l=c(ke,"ION-BUTTONS",{slot:!0});var ce=m(l);n=c(ce,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),oe(n)!=="svelte-1f8rjcf"&&(n.textContent=i),ce.forEach(a),f=w(ke),d=c(ke,"ION-TITLE",{title:!0,"data-svelte-h":!0}),oe(d)!=="svelte-efps2s"&&(d.textContent=_),ke.forEach(a),re.forEach(a),O=w(x),g=c(x,"ION-CONTENT",{fullscreen:!0});var Ne=m(g);h=c(Ne,"ION-LIST",{});var fe=m(h);u=c(fe,"ION-ITEM",{});var Ae=m(u);p=c(Ae,"ION-ICON",{icon:!0,slot:!0}),m(p).forEach(a),b=w(Ae),C=c(Ae,"ION-INPUT",{label:!0,type:!0,placeholder:!0,value:!0}),m(C).forEach(a),Ae.forEach(a),z=w(fe),V=c(fe,"ION-ITEM",{});var Ve=m(V);M=c(Ve,"ION-ICON",{icon:!0,slot:!0}),m(M).forEach(a),G=w(Ve),q=c(Ve,"ION-INPUT",{label:!0,type:!0,value:!0}),m(q).forEach(a),Ve.forEach(a),j=w(fe),P=c(fe,"ION-ITEM",{});var tt=m(P);H=c(tt,"ION-ICON",{icon:!0,slot:!0}),m(H).forEach(a),E=w(tt),L=c(tt,"ION-SELECT",{placeholder:!0,value:!0});var Fe=m(L);U=c(Fe,"DIV",{slot:!0,"data-svelte-h":!0}),oe(U)!=="svelte-wl764p"&&(U.innerHTML=B),R=w(Fe),W=c(Fe,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),oe(W)!=="svelte-i9crym"&&(W.textContent=F),te=w(Fe),ne=c(Fe,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),oe(ne)!=="svelte-fx0z11"&&(ne.textContent=le),me=w(Fe),ae=c(Fe,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),oe(ae)!=="svelte-1c24jf2"&&(ae.textContent=_e),Fe.forEach(a),tt.forEach(a),ve=w(fe),de=c(fe,"ION-ITEM",{});var nt=m(de);pe=c(nt,"ION-ICON",{icon:!0,slot:!0}),m(pe).forEach(a),Ee=w(nt),Oe=c(nt,"ION-TEXTAREA",{label:!0,placeholder:!0}),m(Oe).forEach(a),nt.forEach(a),we=w(fe),Ce=c(fe,"SECTION",{});var pt=m(Ce);he=c(pt,"LABEL",{for:!0,style:!0});var mt=m(he);Te=c(mt,"ION-BUTTON",{fill:!0,size:!0,class:!0,expand:!0});var ot=m(Te);ye=c(ot,"LABEL",{for:!0,style:!0,"data-svelte-h":!0}),oe(ye)!=="svelte-1m9yw22"&&(ye.innerHTML=Ie),se=w(ot),$=c(ot,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0,capture:!0}),ot.forEach(a),mt.forEach(a),pt.forEach(a),ie=w(fe),Q&&Q.l(fe),fe.forEach(a),Ne.forEach(a),I=w(x),T=c(x,"ION-FOOTER",{});var vt=m(T);D=c(vt,"ION-TOOLBAR",{});var gt=m(D);N=c(gt,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),oe(N)!=="svelte-1c7dl3f"&&(N.textContent=X),gt.forEach(a),vt.forEach(a),K=w(x),ee&&ee.l(x),Z=Se(),this.h()},h(){v(n,"color","medium"),v(l,"slot","start"),v(d,"title",""),v(e,"translucent",""),v(p,"icon",Zt),v(p,"slot","start"),v(C,"label","Concepto"),v(C,"type","text"),v(C,"placeholder","Escribe aquí..."),v(C,"value",r[6]?r[6]:""),v(M,"icon",ct),v(M,"slot","start"),v(q,"label","Cantidad"),v(q,"type","number"),v(q,"value",r[7]?r[7]:""),v(H,"icon",yn),v(H,"slot","start"),Y(U,"slot","label"),v(W,"value","cash"),v(ne,"value","card"),v(ae,"value","transfer"),v(L,"placeholder","Tipo de pago"),v(L,"value",r[8]?r[8]:""),v(pe,"icon",ct),v(pe,"slot","start"),v(Oe,"label","Comentarios"),v(Oe,"placeholder","Escribe aquí..."),Y(ye,"for","eventEvidence"),k(ye,"width","100%"),k(ye,"padding","8px"),k($,"display","none"),Y($,"id","eventEvidence"),Y($,"name","fileToUpload"),Y($,"type","file"),Y($,"accept","image/*"),Y($,"capture","environment"),v(Te,"fill","outline"),v(Te,"size","small"),v(Te,"class","loadEvidence"),v(Te,"expand","block"),Y(he,"for","eventEvidence"),k(he,"display","block"),k(he,"width","100%"),v(g,"fullscreen",""),v(N,"fill","outline"),v(N,"color","tertiary"),v(N,"strong",""),k(N,"width","99%"),k(N,"height","auto")},m(x,re){J(x,e,re),o(e,t),o(t,l),o(l,n),o(t,f),o(t,d),J(x,O,re),J(x,g,re),o(g,h),o(h,u),o(u,p),o(u,b),o(u,C),r[12](C),o(h,z),o(h,V),o(V,M),o(V,G),o(V,q),r[13](q),o(h,j),o(h,P),o(P,H),o(P,E),o(P,L),o(L,U),o(L,R),o(L,W),o(L,te),o(L,ne),o(L,me),o(L,ae),r[14](L),o(h,ve),o(h,de),o(de,pe),o(de,Ee),o(de,Oe),r[15](Oe),o(h,we),o(h,Ce),o(Ce,he),o(he,Te),o(Te,ye),o(Te,se),o(Te,$),o(h,ie),Q&&Q.m(h,null),J(x,I,re),J(x,T,re),o(T,D),o(D,N),J(x,K,re),ee&&ee.m(x,re),J(x,Z,re),A||(S=[ue(n,"click",r[10]),ue($,"change",r[9]),ue(N,"click",r[11])],A=!0)},p(x,[re]){x[0]?Q?Q.p(x,re):(Q=St(x),Q.c(),Q.m(h,null)):Q&&(Q.d(1),Q=null),x[5]?ee||(ee=Dt(),ee.c(),ee.m(Z.parentNode,Z)):ee&&(ee.d(1),ee=null)},i:ze,o:ze,d(x){x&&(a(e),a(O),a(g),a(I),a(T),a(K),a(Z)),r[12](null),r[13](null),r[14](null),r[15](null),Q&&Q.d(),ee&&ee.d(x),A=!1,He(S)}}}function uo(r,e,t){let l=rt,n=document.querySelector("ion-modal"),i=n.componentProps.routeId,f=n.componentProps.ex_concept,d=n.componentProps.ex_amount,_=n.componentProps.ex_type,O=n.componentProps.id_expense,g="",h="",u="",p=0,b="",C="",z=!1,V=new Object;Ze(()=>{V=JSON.parse(localStorage.getItem("userSession"))});const M=async(R,W)=>{await(await je.create({header:R||"Error",message:W||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()},G=async R=>{t(5,z=!0);const F=R.target.files[0],te=await q(F);if(te){let ne=new FormData;ne.append("fileToUpload",te),ne=H(ne);try{const le=await fetch(`${l}api/admin/manager/upload_img_driver.php`,{method:"POST",body:ne});if(le.ok){const me=await le.json();t(0,g=me.img),h=me.img_id}else console.error("File upload failed:",le.statusText)}catch(le){console.error("Error during file upload:",le)}finally{t(5,z=!1)}}},q=async R=>new Promise(W=>{const F=new FileReader;F.onload=te=>{const ne=new Image;ne.src=te.target.result,ne.onload=()=>{const le=document.createElement("canvas"),me=le.getContext("2d"),ae=800,_e=600;let ve=ne.width,de=ne.height;ve>ae&&(de*=ae/ve,ve=ae),de>_e&&(ve*=_e/de,de=_e),le.width=ve,le.height=de,me.drawImage(ne,0,0,ve,de),le.toBlob(pe=>{W(pe)},"image/jpeg",.7)}},F.readAsDataURL(R)}),j=()=>{et.dismiss()},P=()=>{var R=new Object;R.id_route=i,R.comments=b.value,R.type=u.value,R.img=g,R.img_id=h,R.amount=p.value,R.concept=C.value,R.status="done",R.id_expense=O||"null";let W=new FormData;for(const F in R)W.append(F,R[F]);W=H(W),!h||!g||!b.value||!p.value||!C.value?M("Datos incompletos","Llena los datos requeridos para completar el registro"):fetch(`${l}api/admin/expenses/add_expense.php`,{method:"POST",body:W}).then(F=>F.json()).then(F=>{j()}).catch(F=>{console.error("Error fetching data:",F)})};function H(R){return R.append("token",V.token),R.append("id_user_over",V.id_user),R}function E(R){De[R?"unshift":"push"](()=>{C=R,t(4,C)})}function L(R){De[R?"unshift":"push"](()=>{p=R,t(2,p)})}function U(R){De[R?"unshift":"push"](()=>{u=R,t(1,u)})}function B(R){De[R?"unshift":"push"](()=>{b=R,t(3,b)})}return[g,u,p,b,C,z,f,d,_,G,j,P,E,L,U,B]}class ft extends Je{constructor(e){super(),Ye(this,e,uo,co,We,{})}}function Pt(r,e,t){const l=r.slice();return l[7]=e[t],l}function fo(r){let e,t="Cargar gasto",l,n;function i(...f){return r[4](r[7],...f)}return{c(){e=s("ion-button"),e.textContent=t,this.h()},l(f){e=c(f,"ION-BUTTON",{fill:!0,size:!0,"aria-selected":!0,"data-svelte-h":!0}),oe(e)!=="svelte-175aelj"&&(e.textContent=t),this.h()},h(){v(e,"fill","outline"),v(e,"size","small"),v(e,"aria-selected","")},m(f,d){J(f,e,d),l||(n=ue(e,"click",i),l=!0)},p(f,d){r=f},d(f){f&&a(e),l=!1,n()}}}function _o(r){let e,t="Gasto completado";return{c(){e=s("ion-button"),e.textContent=t,this.h()},l(l){e=c(l,"ION-BUTTON",{fill:!0,size:!0,"aria-selected":!0,"data-svelte-h":!0}),oe(e)!=="svelte-tlger7"&&(e.textContent=t),this.h()},h(){v(e,"fill","solid"),v(e,"size","small"),v(e,"aria-selected","")},m(l,n){J(l,e,n)},p:ze,d(l){l&&a(e)}}}function Ht(r,e){let t,l,n,i=e[7].concept+"",f,d,_;function O(u,p){return u[7].status=="done"?_o:fo}let h=O(e)(e);return{key:r,first:null,c(){t=s("ion-item"),l=s("ion-label"),n=s("p"),f=ge(i),d=y(),h.c(),_=y(),this.h()},l(u){t=c(u,"ION-ITEM",{});var p=m(t);l=c(p,"ION-LABEL",{style:!0});var b=m(l);n=c(b,"P",{style:!0});var C=m(n);f=be(C,i),C.forEach(a),b.forEach(a),d=w(p),h.l(p),_=w(p),p.forEach(a),this.h()},h(){k(n,"margin-left","10px"),k(l,"display","flex"),this.first=t},m(u,p){J(u,t,p),o(t,l),o(l,n),o(n,f),o(t,d),h.m(t,null),o(t,_)},p(u,p){e=u,h.p(e,p)},d(u){u&&a(t),h.d()}}}function ho(r){let e,t,l,n,i=`<ion-icon style="font-size: 25px!important;" icon="${wn}"></ion-icon>`,f,d,_="LISTA DE GASTOS",O,g,h,u=[],p=new Map,b,C,z,V="Cerrar",M,G,q=Be(r[0]);const j=P=>P[7].id_expenses;for(let P=0;P<q.length;P+=1){let H=Pt(r,q,P),E=j(H);p.set(E,u[P]=Ht(E,H))}return{c(){e=s("ion-header"),t=s("ion-toolbar"),l=s("ion-buttons"),n=s("ion-button"),n.innerHTML=i,f=y(),d=s("ion-title"),d.textContent=_,O=y(),g=s("ion-content"),h=s("ion-list");for(let P=0;P<u.length;P+=1)u[P].c();b=y(),C=s("ion-footer"),z=s("ion-button"),z.textContent=V,this.h()},l(P){e=c(P,"ION-HEADER",{translucent:!0});var H=m(e);t=c(H,"ION-TOOLBAR",{});var E=m(t);l=c(E,"ION-BUTTONS",{slot:!0});var L=m(l);n=c(L,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),oe(n)!=="svelte-160xz3i"&&(n.innerHTML=i),L.forEach(a),f=w(E),d=c(E,"ION-TITLE",{"data-svelte-h":!0}),oe(d)!=="svelte-1phn90x"&&(d.textContent=_),E.forEach(a),H.forEach(a),O=w(P),g=c(P,"ION-CONTENT",{fullscreen:!0});var U=m(g);h=c(U,"ION-LIST",{});var B=m(h);for(let W=0;W<u.length;W+=1)u[W].l(B);B.forEach(a),U.forEach(a),b=w(P),C=c(P,"ION-FOOTER",{});var R=m(C);z=c(R,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),oe(z)!=="svelte-zv7v83"&&(z.textContent=V),R.forEach(a),this.h()},h(){v(n,"color","medium"),v(l,"slot","end"),v(e,"translucent",""),v(g,"fullscreen",""),v(z,"fill","outline"),v(z,"color","tertiary"),v(z,"strong",""),k(z,"width","99%"),k(z,"height","auto")},m(P,H){J(P,e,H),o(e,t),o(t,l),o(l,n),o(t,f),o(t,d),J(P,O,H),J(P,g,H),o(g,h);for(let E=0;E<u.length;E+=1)u[E]&&u[E].m(h,null);J(P,b,H),J(P,C,H),o(C,z),M||(G=[ue(n,"click",r[3]),ue(z,"click",r[1])],M=!0)},p(P,[H]){H&5&&(q=Be(P[0]),u=xe(u,H,j,1,P,q,p,h,$e,Ht,null,Pt))},i:ze,o:ze,d(P){P&&(a(e),a(O),a(g),a(b),a(C));for(let H=0;H<u.length;H+=1)u[H].d();M=!1,He(G)}}}function po(r){let e=document.querySelector("ion-modal");e.componentProps.routeId;let t=e.componentProps.expenses;Ze(()=>{});const l=()=>{et.dismiss()};function n(d,_,O,g,h){e.componentProps.ex_amount=O,e.componentProps.ex_concept=_,e.componentProps.ex_type=g,e.componentProps.id_expense=h,Ue("modal-expense",ft,{amount:O,concept:_,type:g,id_expense:h}).then(()=>{}),l()}return[t,l,n,d=>{Ue("modal-expense",ft,{routeId:d}).then(_=>{}),l()},(d,_)=>n(_,d.concept,d.amount,d.type,d.id_expenses)]}class mo extends Je{constructor(e){super(),Ye(this,e,po,ho,We,{})}}const{document:Bt}=Pn;function Rt(r,e,t){const l=r.slice();return l[48]=e[t],l[50]=t,l}function Ut(r,e,t){const l=r.slice();return l[48]=e[t],l[50]=t,l}function Vt(r,e,t){const l=r.slice();return l[48]=e[t],l[50]=t,l}function Ft(r){let e,t;return e=new Mn({props:{$$slots:{default:[Oo]},$$scope:{ctx:r}}}),{c(){fn(e.$$.fragment)},l(l){dn(e.$$.fragment,l)},m(l,n){_n(e,l,n),t=!0},p(l,n){const i={};n[0]&1019|n[1]&4194304&&(i.$$scope={dirty:n,ctx:l}),e.$set(i)},i(l){t||(it(e.$$.fragment,l),t=!0)},o(l){st(e.$$.fragment,l),t=!1},d(l){hn(e,l)}}}function vo(r){let e,t='<div id="g_map" style="width: 100%; height: 100vh;"></div>';return{c(){e=s("ion-content"),e.innerHTML=t},l(l){e=c(l,"ION-CONTENT",{"data-svelte-h":!0}),oe(e)!=="svelte-1ydw6i9"&&(e.innerHTML=t)},m(l,n){J(l,e,n)},p:ze,d(l){l&&a(e)}}}function go(r){let e;function t(i,f){if(i[7].length>0)return Eo;if(!i[3])return bo}let l=t(r),n=l&&l(r);return{c(){n&&n.c(),e=Se()},l(i){n&&n.l(i),e=Se()},m(i,f){n&&n.m(i,f),J(i,e,f)},p(i,f){l===(l=t(i))&&n?n.p(i,f):(n&&n.d(1),n=l&&l(i),n&&(n.c(),n.m(e.parentNode,e)))},d(i){i&&a(e),n&&n.d(i)}}}function bo(r){let e,t,l,n='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Jala para actualizar" refreshing-spinner="circles" refreshing-text="Actualizando..."></ion-refresher-content>',i,f,d,_,O,g,h="0",u,p,b,C,z,V=r[6].origin+"",M,G,q,j="",P,H,E,L=[],U=new Map,B,R,W,F,te,ne=r[5].length+1+"",le,me,ae,_e,ve,de,pe=r[6].destination+"",Ee,Oe,we,Ce="",he,Te,ye,Ie,se=r[4]&&qt(r),$=Be(r[5]);const ie=I=>I[48].id_event;for(let I=0;I<$.length;I+=1){let T=Rt(r,$,I),D=ie(T);U.set(D,L[I]=Gt(D,T))}return{c(){se&&se.c(),e=y(),t=s("ion-content"),l=s("ion-refresher"),l.innerHTML=n,i=y(),f=s("ion-list"),d=s("ion-item"),_=s("ion-avatar"),O=s("div"),g=s("div"),g.textContent=h,p=y(),b=s("ion-label"),C=s("ion-text"),z=s("h3"),M=ge(V),G=y(),q=s("div"),q.innerHTML=j,P=y(),H=s("ion-icon"),E=y();for(let I=0;I<L.length;I+=1)L[I].c();B=y(),R=s("ion-item"),W=s("ion-avatar"),F=s("div"),te=s("div"),le=ge(ne),ae=y(),_e=s("ion-label"),ve=s("ion-text"),de=s("h3"),Ee=ge(pe),Oe=y(),we=s("div"),we.innerHTML=Ce,he=y(),Te=s("ion-icon"),this.h()},l(I){se&&se.l(I),e=w(I),t=c(I,"ION-CONTENT",{});var T=m(t);l=c(T,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),oe(l)!=="svelte-1srnbs3"&&(l.innerHTML=n),i=w(T),f=c(T,"ION-LIST",{});var D=m(f);d=c(D,"ION-ITEM",{});var N=m(d);_=c(N,"ION-AVATAR",{slot:!0});var X=m(_);O=c(X,"DIV",{class:!0,title:!0,style:!0});var K=m(O);g=c(K,"DIV",{class:!0,"data-svelte-h":!0}),oe(g)!=="svelte-3lvlrb"&&(g.textContent=h),K.forEach(a),X.forEach(a),p=w(N),b=c(N,"ION-LABEL",{button:!0});var Z=m(b);C=c(Z,"ION-TEXT",{color:!0});var A=m(C);z=c(A,"H3",{});var S=m(z);M=be(S,V),S.forEach(a),A.forEach(a),G=w(Z),q=c(Z,"DIV",{class:!0,"data-svelte-h":!0}),oe(q)!=="svelte-gz9kb"&&(q.innerHTML=j),Z.forEach(a),P=w(N),H=c(N,"ION-ICON",{icon:!0,slot:!0}),m(H).forEach(a),N.forEach(a),E=w(D);for(let fe=0;fe<L.length;fe+=1)L[fe].l(D);B=w(D),R=c(D,"ION-ITEM",{});var Q=m(R);W=c(Q,"ION-AVATAR",{slot:!0});var ee=m(W);F=c(ee,"DIV",{class:!0,title:!0,style:!0});var x=m(F);te=c(x,"DIV",{class:!0});var re=m(te);le=be(re,ne),re.forEach(a),x.forEach(a),ee.forEach(a),ae=w(Q),_e=c(Q,"ION-LABEL",{button:!0});var ke=m(_e);ve=c(ke,"ION-TEXT",{color:!0});var ce=m(ve);de=c(ce,"H3",{});var Ne=m(de);Ee=be(Ne,pe),Ne.forEach(a),ce.forEach(a),Oe=w(ke),we=c(ke,"DIV",{class:!0,"data-svelte-h":!0}),oe(we)!=="svelte-130ohbs"&&(we.innerHTML=Ce),ke.forEach(a),he=w(Q),Te=c(Q,"ION-ICON",{icon:!0,slot:!0}),m(Te).forEach(a),Q.forEach(a),D.forEach(a),T.forEach(a),this.h()},h(){v(l,"slot","fixed"),Y(g,"class","order svelte-egzizz"),Y(O,"class","order-wrapper svelte-egzizz"),Y(O,"title",u="$"+r[6].origin),k(O,"background-color",r[6].color),k(O,"color",Me(r[6].color)),v(_,"slot","start"),v(C,"color","#2e2e2e"),Y(q,"class","sub svelte-egzizz"),v(b,"button",""),v(H,"icon",Re),v(H,"slot","end"),Y(te,"class","order svelte-egzizz"),Y(F,"class","order-wrapper svelte-egzizz"),Y(F,"title",me="$"+r[6].destination),k(F,"background-color",r[6].color),k(F,"color",Me(r[6].color)),v(W,"slot","start"),v(ve,"color","#2e2e2e"),Y(we,"class","sub svelte-egzizz"),v(_e,"button",""),v(Te,"icon",Re),v(Te,"slot","end")},m(I,T){se&&se.m(I,T),J(I,e,T),J(I,t,T),o(t,l),r[30](l),o(t,i),o(t,f),o(f,d),o(d,_),o(_,O),o(O,g),o(d,p),o(d,b),o(b,C),o(C,z),o(z,M),o(b,G),o(b,q),o(d,P),o(d,H),o(f,E);for(let D=0;D<L.length;D+=1)L[D]&&L[D].m(f,null);o(f,B),o(f,R),o(R,W),o(W,F),o(F,te),o(te,le),o(R,ae),o(R,_e),o(_e,ve),o(ve,de),o(de,Ee),o(_e,Oe),o(_e,we),o(R,he),o(R,Te),ye||(Ie=[ue(l,"ionRefresh",r[10]),ue(b,"click",r[31]),ue(_e,"click",r[33])],ye=!0)},p(I,T){I[4]?se?se.p(I,T):(se=qt(I),se.c(),se.m(e.parentNode,e)):se&&(se.d(1),se=null),T[0]&64&&u!==(u="$"+I[6].origin)&&Y(O,"title",u),T[0]&64&&k(O,"background-color",I[6].color),T[0]&64&&k(O,"color",Me(I[6].color)),T[0]&64&&V!==(V=I[6].origin+"")&&Le(M,V),T[0]&331808&&($=Be(I[5]),L=xe(L,T,ie,1,I,$,U,f,$e,Gt,B,Rt)),T[0]&32&&ne!==(ne=I[5].length+1+"")&&Le(le,ne),T[0]&64&&me!==(me="$"+I[6].destination)&&Y(F,"title",me),T[0]&64&&k(F,"background-color",I[6].color),T[0]&64&&k(F,"color",Me(I[6].color)),T[0]&64&&pe!==(pe=I[6].destination+"")&&Le(Ee,pe)},d(I){I&&(a(e),a(t)),se&&se.d(I),r[30](null);for(let T=0;T<L.length;T+=1)L[T].d();ye=!1,He(Ie)}}}function Eo(r){let e,t;function l(f,d){return d[0]&144&&(e=null),e==null&&(e=!!(f[7].filter(To).every(Co)&&!f[4])),e?ko:Io}let n=l(r,[-1,-1]),i=n(r);return{c(){i.c(),t=Se()},l(f){i.l(f),t=Se()},m(f,d){i.m(f,d),J(f,t,d)},p(f,d){n===(n=l(f,d))&&i?i.p(f,d):(i.d(1),i=n(f),i&&(i.c(),i.m(t.parentNode,t)))},d(f){f&&a(t),i.d(f)}}}function qt(r){let e=r[14]("",r[1],r[0])+"",t;return{c(){t=ge(e)},l(l){t=be(l,e)},m(l,n){J(l,t,n)},p(l,n){n[0]&3&&e!==(e=l[14]("",l[1],l[0])+"")&&Le(t,e)},d(l){l&&a(t)}}}function jt(r){let e;return{c(){e=s("span"),this.h()},l(t){e=c(t,"SPAN",{class:!0}),m(e).forEach(a),this.h()},h(){Y(e,"class","notes svelte-egzizz")},m(t,l){J(t,e,l)},d(t){t&&a(e)}}}function Gt(r,e){let t,l,n,i,f=parseInt(e[48].pos)+1+"",d,_,O,g,h,u,p=e[48].title+"",b,C,z=e[48].support_list&&e[48].support_list.length||e[16](e[48]),V,M,G,q,j=z&&jt();function P(){return e[32](e[48])}return{key:r,first:null,c(){t=s("ion-item"),l=s("ion-avatar"),n=s("div"),i=s("div"),d=ge(f),O=y(),g=s("ion-label"),h=s("ion-text"),u=s("h3"),b=ge(p),C=y(),j&&j.c(),V=y(),M=s("ion-icon"),this.h()},l(H){t=c(H,"ION-ITEM",{});var E=m(t);l=c(E,"ION-AVATAR",{slot:!0});var L=m(l);n=c(L,"DIV",{class:!0,title:!0,style:!0});var U=m(n);i=c(U,"DIV",{class:!0});var B=m(i);d=be(B,f),B.forEach(a),U.forEach(a),L.forEach(a),O=w(E),g=c(E,"ION-LABEL",{button:!0});var R=m(g);h=c(R,"ION-TEXT",{color:!0});var W=m(h);u=c(W,"H3",{});var F=m(u);b=be(F,p),C=w(F),j&&j.l(F),F.forEach(a),W.forEach(a),R.forEach(a),V=w(E),M=c(E,"ION-ICON",{icon:!0,slot:!0,style:!0}),m(M).forEach(a),E.forEach(a),this.h()},h(){Y(i,"class","order svelte-egzizz"),Y(n,"class","order-wrapper svelte-egzizz"),Y(n,"title",_=Xe(e[48].status)),k(n,"background-color",Pe(e[48].status,e[48].date_service)),k(n,"color",Me(Pe(e[48].status))),v(l,"slot","start"),v(h,"color","#2e2e2e"),v(g,"button",""),v(M,"icon",Re),v(M,"slot","end"),k(M,"color",Pe(e[48].status,e[48].date_service)),this.first=t},m(H,E){J(H,t,E),o(t,l),o(l,n),o(n,i),o(i,d),o(t,O),o(t,g),o(g,h),o(h,u),o(u,b),o(u,C),j&&j.m(u,null),o(t,V),o(t,M),G||(q=ue(g,"click",P),G=!0)},p(H,E){e=H,E[0]&32&&f!==(f=parseInt(e[48].pos)+1+"")&&Le(d,f),E[0]&32&&_!==(_=Xe(e[48].status))&&Y(n,"title",_),E[0]&32&&k(n,"background-color",Pe(e[48].status,e[48].date_service)),E[0]&32&&k(n,"color",Me(Pe(e[48].status))),E[0]&32&&p!==(p=e[48].title+"")&&Le(b,p),E[0]&32&&(z=e[48].support_list&&e[48].support_list.length||e[16](e[48])),z?j||(j=jt(),j.c(),j.m(u,null)):j&&(j.d(1),j=null),E[0]&32&&k(M,"color",Pe(e[48].status,e[48].date_service))},d(H){H&&a(t),j&&j.d(),G=!1,q()}}}function Io(r){let e=r[14](r[7],r[1],r[0])+"",t,l,n,i,f='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Pull to refresh" refreshing-spinner="circles" refreshing-text="Refreshing..."></ion-refresher-content>',d,_,O,g,h,u,p="0",b,C,z,V,M,G=r[6].origin+"",q,j,P,H="",E,L,U,B=[],R=new Map,W,F,te,ne,le,me=r[5].length+1+"",ae,_e,ve,de,pe,Ee,Oe=r[6].destination+"",we,Ce,he,Te="",ye,Ie,se,$,ie=Be(r[5]);const I=T=>T[48].id_event;for(let T=0;T<ie.length;T+=1){let D=Ut(r,ie,T),N=I(D);R.set(N,B[T]=Xt(N,D))}return{c(){t=ge(e),l=y(),n=s("ion-content"),i=s("ion-refresher"),i.innerHTML=f,d=y(),_=s("ion-list"),O=s("ion-item"),g=s("ion-avatar"),h=s("div"),u=s("div"),u.textContent=p,C=y(),z=s("ion-label"),V=s("ion-text"),M=s("h3"),q=ge(G),j=y(),P=s("div"),P.innerHTML=H,E=y(),L=s("ion-icon"),U=y();for(let T=0;T<B.length;T+=1)B[T].c();W=y(),F=s("ion-item"),te=s("ion-avatar"),ne=s("div"),le=s("div"),ae=ge(me),ve=y(),de=s("ion-label"),pe=s("ion-text"),Ee=s("h3"),we=ge(Oe),Ce=y(),he=s("div"),he.innerHTML=Te,ye=y(),Ie=s("ion-icon"),this.h()},l(T){t=be(T,e),l=w(T),n=c(T,"ION-CONTENT",{});var D=m(n);i=c(D,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),oe(i)!=="svelte-dvt1s"&&(i.innerHTML=f),d=w(D),_=c(D,"ION-LIST",{});var N=m(_);O=c(N,"ION-ITEM",{});var X=m(O);g=c(X,"ION-AVATAR",{slot:!0});var K=m(g);h=c(K,"DIV",{class:!0,title:!0,style:!0});var Z=m(h);u=c(Z,"DIV",{class:!0,"data-svelte-h":!0}),oe(u)!=="svelte-3lvlrb"&&(u.textContent=p),Z.forEach(a),K.forEach(a),C=w(X),z=c(X,"ION-LABEL",{button:!0});var A=m(z);V=c(A,"ION-TEXT",{color:!0});var S=m(V);M=c(S,"H3",{});var Q=m(M);q=be(Q,G),Q.forEach(a),S.forEach(a),j=w(A),P=c(A,"DIV",{class:!0,"data-svelte-h":!0}),oe(P)!=="svelte-gz9kb"&&(P.innerHTML=H),A.forEach(a),E=w(X),L=c(X,"ION-ICON",{icon:!0,slot:!0}),m(L).forEach(a),X.forEach(a),U=w(N);for(let Ae=0;Ae<B.length;Ae+=1)B[Ae].l(N);W=w(N),F=c(N,"ION-ITEM",{});var ee=m(F);te=c(ee,"ION-AVATAR",{slot:!0});var x=m(te);ne=c(x,"DIV",{class:!0,title:!0,style:!0});var re=m(ne);le=c(re,"DIV",{class:!0});var ke=m(le);ae=be(ke,me),ke.forEach(a),re.forEach(a),x.forEach(a),ve=w(ee),de=c(ee,"ION-LABEL",{button:!0});var ce=m(de);pe=c(ce,"ION-TEXT",{color:!0});var Ne=m(pe);Ee=c(Ne,"H3",{});var fe=m(Ee);we=be(fe,Oe),fe.forEach(a),Ne.forEach(a),Ce=w(ce),he=c(ce,"DIV",{class:!0,"data-svelte-h":!0}),oe(he)!=="svelte-130ohbs"&&(he.innerHTML=Te),ce.forEach(a),ye=w(ee),Ie=c(ee,"ION-ICON",{icon:!0,slot:!0}),m(Ie).forEach(a),ee.forEach(a),N.forEach(a),D.forEach(a),this.h()},h(){v(i,"slot","fixed"),Y(u,"class","order svelte-egzizz"),Y(h,"class","order-wrapper svelte-egzizz"),Y(h,"title",b="$"+r[6].origin),k(h,"background-color",r[6].color),k(h,"color",Me(r[6].color)),v(g,"slot","start"),v(V,"color","#2e2e2e"),Y(P,"class","sub svelte-egzizz"),v(z,"button",""),v(L,"icon",Re),v(L,"slot","end"),Y(le,"class","order svelte-egzizz"),Y(ne,"class","order-wrapper svelte-egzizz"),Y(ne,"title",_e="$"+r[6].destination),k(ne,"background-color",r[6].color),k(ne,"color",Me(r[6].color)),v(te,"slot","start"),v(pe,"color","#2e2e2e"),Y(he,"class","sub svelte-egzizz"),v(de,"button",""),v(Ie,"icon",Re),v(Ie,"slot","end")},m(T,D){J(T,t,D),J(T,l,D),J(T,n,D),o(n,i),r[26](i),o(n,d),o(n,_),o(_,O),o(O,g),o(g,h),o(h,u),o(O,C),o(O,z),o(z,V),o(V,M),o(M,q),o(z,j),o(z,P),o(O,E),o(O,L),o(_,U);for(let N=0;N<B.length;N+=1)B[N]&&B[N].m(_,null);o(_,W),o(_,F),o(F,te),o(te,ne),o(ne,le),o(le,ae),o(F,ve),o(F,de),o(de,pe),o(pe,Ee),o(Ee,we),o(de,Ce),o(de,he),o(F,ye),o(F,Ie),se||($=[ue(i,"ionRefresh",r[10]),ue(z,"click",r[27]),ue(de,"click",r[29])],se=!0)},p(T,D){D[0]&131&&e!==(e=T[14](T[7],T[1],T[0])+"")&&Le(t,e),D[0]&64&&b!==(b="$"+T[6].origin)&&Y(h,"title",b),D[0]&64&&k(h,"background-color",T[6].color),D[0]&64&&k(h,"color",Me(T[6].color)),D[0]&64&&G!==(G=T[6].origin+"")&&Le(q,G),D[0]&331808&&(ie=Be(T[5]),B=xe(B,D,I,1,T,ie,R,_,$e,Xt,W,Ut)),D[0]&32&&me!==(me=T[5].length+1+"")&&Le(ae,me),D[0]&64&&_e!==(_e="$"+T[6].destination)&&Y(ne,"title",_e),D[0]&64&&k(ne,"background-color",T[6].color),D[0]&64&&k(ne,"color",Me(T[6].color)),D[0]&64&&Oe!==(Oe=T[6].destination+"")&&Le(we,Oe)},d(T){T&&(a(t),a(l),a(n)),r[26](null);for(let D=0;D<B.length;D+=1)B[D].d();se=!1,He($)}}}function ko(r){let e,t,l='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Jale para actualizar" refreshing-spinner="circles" refreshing-text="Actualizando..."></ion-refresher-content>',n,i,f,d,_,O,g="0",h,u,p,b,C,z=r[6].origin+"",V,M,G,q="",j,P,H,E=[],L=new Map,U,B,R,W,F,te=r[5].length+1+"",ne,le,me,ae,_e,ve,de=r[6].destination+"",pe,Ee,Oe,we="",Ce,he,Te,ye,Ie=Be(r[5]);const se=$=>$[48].id_event;for(let $=0;$<Ie.length;$+=1){let ie=Vt(r,Ie,$),I=se(ie);L.set(I,E[$]=Jt(I,ie))}return{c(){e=s("ion-content"),t=s("ion-refresher"),t.innerHTML=l,n=y(),i=s("ion-list"),f=s("ion-item"),d=s("ion-avatar"),_=s("div"),O=s("div"),O.textContent=g,u=y(),p=s("ion-label"),b=s("ion-text"),C=s("h3"),V=ge(z),M=y(),G=s("div"),G.innerHTML=q,j=y(),P=s("ion-icon"),H=y();for(let $=0;$<E.length;$+=1)E[$].c();U=y(),B=s("ion-item"),R=s("ion-avatar"),W=s("div"),F=s("div"),ne=ge(te),me=y(),ae=s("ion-label"),_e=s("ion-text"),ve=s("h3"),pe=ge(de),Ee=y(),Oe=s("div"),Oe.innerHTML=we,Ce=y(),he=s("ion-icon"),this.h()},l($){e=c($,"ION-CONTENT",{});var ie=m(e);t=c(ie,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),oe(t)!=="svelte-15ukrgn"&&(t.innerHTML=l),n=w(ie),i=c(ie,"ION-LIST",{});var I=m(i);f=c(I,"ION-ITEM",{});var T=m(f);d=c(T,"ION-AVATAR",{slot:!0});var D=m(d);_=c(D,"DIV",{class:!0,title:!0,style:!0});var N=m(_);O=c(N,"DIV",{class:!0,"data-svelte-h":!0}),oe(O)!=="svelte-3lvlrb"&&(O.textContent=g),N.forEach(a),D.forEach(a),u=w(T),p=c(T,"ION-LABEL",{button:!0});var X=m(p);b=c(X,"ION-TEXT",{color:!0});var K=m(b);C=c(K,"H3",{});var Z=m(C);V=be(Z,z),Z.forEach(a),K.forEach(a),M=w(X),G=c(X,"DIV",{class:!0,"data-svelte-h":!0}),oe(G)!=="svelte-gz9kb"&&(G.innerHTML=q),X.forEach(a),j=w(T),P=c(T,"ION-ICON",{icon:!0,slot:!0}),m(P).forEach(a),T.forEach(a),H=w(I);for(let ce=0;ce<E.length;ce+=1)E[ce].l(I);U=w(I),B=c(I,"ION-ITEM",{});var A=m(B);R=c(A,"ION-AVATAR",{slot:!0});var S=m(R);W=c(S,"DIV",{class:!0,title:!0,style:!0});var Q=m(W);F=c(Q,"DIV",{class:!0});var ee=m(F);ne=be(ee,te),ee.forEach(a),Q.forEach(a),S.forEach(a),me=w(A),ae=c(A,"ION-LABEL",{button:!0});var x=m(ae);_e=c(x,"ION-TEXT",{color:!0});var re=m(_e);ve=c(re,"H3",{});var ke=m(ve);pe=be(ke,de),ke.forEach(a),re.forEach(a),Ee=w(x),Oe=c(x,"DIV",{class:!0,"data-svelte-h":!0}),oe(Oe)!=="svelte-130ohbs"&&(Oe.innerHTML=we),x.forEach(a),Ce=w(A),he=c(A,"ION-ICON",{icon:!0,slot:!0}),m(he).forEach(a),A.forEach(a),I.forEach(a),ie.forEach(a),this.h()},h(){v(t,"slot","fixed"),Y(O,"class","order svelte-egzizz"),Y(_,"class","order-wrapper svelte-egzizz"),Y(_,"title",h="$"+r[6].origin),k(_,"background-color",r[6].color),k(_,"color",Me(r[6].color)),v(d,"slot","start"),v(b,"color","#2e2e2e"),Y(G,"class","sub svelte-egzizz"),v(p,"button",""),v(P,"icon",Re),v(P,"slot","end"),Y(F,"class","order svelte-egzizz"),Y(W,"class","order-wrapper svelte-egzizz"),Y(W,"title",le="$"+r[6].destination),k(W,"background-color",r[6].color),k(W,"color",Me(r[6].color)),v(R,"slot","start"),v(_e,"color","#2e2e2e"),Y(Oe,"class","sub svelte-egzizz"),v(ae,"button",""),v(he,"icon",Re),v(he,"slot","end")},m($,ie){J($,e,ie),o(e,t),r[22](t),o(e,n),o(e,i),o(i,f),o(f,d),o(d,_),o(_,O),o(f,u),o(f,p),o(p,b),o(b,C),o(C,V),o(p,M),o(p,G),o(f,j),o(f,P),o(i,H);for(let I=0;I<E.length;I+=1)E[I]&&E[I].m(i,null);o(i,U),o(i,B),o(B,R),o(R,W),o(W,F),o(F,ne),o(B,me),o(B,ae),o(ae,_e),o(_e,ve),o(ve,pe),o(ae,Ee),o(ae,Oe),o(B,Ce),o(B,he),Te||(ye=[ue(t,"ionRefresh",r[10]),ue(p,"click",r[23]),ue(ae,"click",r[25])],Te=!0)},p($,ie){ie[0]&64&&h!==(h="$"+$[6].origin)&&Y(_,"title",h),ie[0]&64&&k(_,"background-color",$[6].color),ie[0]&64&&k(_,"color",Me($[6].color)),ie[0]&64&&z!==(z=$[6].origin+"")&&Le(V,z),ie[0]&331808&&(Ie=Be($[5]),E=xe(E,ie,se,1,$,Ie,L,i,$e,Jt,U,Vt)),ie[0]&32&&te!==(te=$[5].length+1+"")&&Le(ne,te),ie[0]&64&&le!==(le="$"+$[6].destination)&&Y(W,"title",le),ie[0]&64&&k(W,"background-color",$[6].color),ie[0]&64&&k(W,"color",Me($[6].color)),ie[0]&64&&de!==(de=$[6].destination+"")&&Le(pe,de)},d($){$&&a(e),r[22](null);for(let ie=0;ie<E.length;ie+=1)E[ie].d();Te=!1,He(ye)}}}function Kt(r){let e;return{c(){e=s("span"),this.h()},l(t){e=c(t,"SPAN",{class:!0}),m(e).forEach(a),this.h()},h(){Y(e,"class","notes svelte-egzizz")},m(t,l){J(t,e,l)},d(t){t&&a(e)}}}function Xt(r,e){let t,l,n,i,f=parseInt(e[48].pos)+1+"",d,_,O,g,h,u,p=e[48].title+"",b,C,z=e[48].support_list&&e[48].support_list.length||e[16](e[48]),V,M,G="",q,j,P,H,E=z&&Kt();function L(){return e[28](e[48])}return{key:r,first:null,c(){t=s("ion-item"),l=s("ion-avatar"),n=s("div"),i=s("div"),d=ge(f),O=y(),g=s("ion-label"),h=s("ion-text"),u=s("h3"),b=ge(p),C=y(),E&&E.c(),V=y(),M=s("div"),M.innerHTML=G,q=y(),j=s("ion-icon"),this.h()},l(U){t=c(U,"ION-ITEM",{});var B=m(t);l=c(B,"ION-AVATAR",{slot:!0});var R=m(l);n=c(R,"DIV",{class:!0,title:!0,style:!0});var W=m(n);i=c(W,"DIV",{class:!0});var F=m(i);d=be(F,f),F.forEach(a),W.forEach(a),R.forEach(a),O=w(B),g=c(B,"ION-LABEL",{button:!0});var te=m(g);h=c(te,"ION-TEXT",{color:!0});var ne=m(h);u=c(ne,"H3",{});var le=m(u);b=be(le,p),C=w(le),E&&E.l(le),le.forEach(a),ne.forEach(a),V=w(te),M=c(te,"DIV",{class:!0,"data-svelte-h":!0}),oe(M)!=="svelte-qaecoo"&&(M.innerHTML=G),te.forEach(a),q=w(B),j=c(B,"ION-ICON",{icon:!0,slot:!0}),m(j).forEach(a),B.forEach(a),this.h()},h(){Y(i,"class","order svelte-egzizz"),Y(n,"class","order-wrapper svelte-egzizz"),Y(n,"title",_=Xe(e[48].status)),k(n,"background-color",Pe(e[48].status,e[48].date_service)),k(n,"color",Me(Pe(e[48].status))),v(l,"slot","start"),v(h,"color","#2e2e2e"),Y(M,"class","sub svelte-egzizz"),v(g,"button",""),v(j,"icon",Re),v(j,"slot","end"),this.first=t},m(U,B){J(U,t,B),o(t,l),o(l,n),o(n,i),o(i,d),o(t,O),o(t,g),o(g,h),o(h,u),o(u,b),o(u,C),E&&E.m(u,null),o(g,V),o(g,M),o(t,q),o(t,j),P||(H=ue(g,"click",L),P=!0)},p(U,B){e=U,B[0]&32&&f!==(f=parseInt(e[48].pos)+1+"")&&Le(d,f),B[0]&32&&_!==(_=Xe(e[48].status))&&Y(n,"title",_),B[0]&32&&k(n,"background-color",Pe(e[48].status,e[48].date_service)),B[0]&32&&k(n,"color",Me(Pe(e[48].status))),B[0]&32&&p!==(p=e[48].title+"")&&Le(b,p),B[0]&32&&(z=e[48].support_list&&e[48].support_list.length||e[16](e[48])),z?E||(E=Kt(),E.c(),E.m(u,null)):E&&(E.d(1),E=null)},d(U){U&&a(t),E&&E.d(),P=!1,H()}}}function Wt(r){let e;return{c(){e=s("span"),this.h()},l(t){e=c(t,"SPAN",{class:!0}),m(e).forEach(a),this.h()},h(){Y(e,"class","notes svelte-egzizz")},m(t,l){J(t,e,l)},d(t){t&&a(e)}}}function Jt(r,e){let t,l,n,i,f=parseInt(e[48].pos)+1+"",d,_,O,g,h,u,p=e[48].title+"",b,C,z=e[48].support_list&&e[48].support_list.length||e[16](e[48]),V,M,G="",q,j,P,H,E=z&&Wt();function L(){return e[24](e[48])}return{key:r,first:null,c(){t=s("ion-item"),l=s("ion-avatar"),n=s("div"),i=s("div"),d=ge(f),O=y(),g=s("ion-label"),h=s("ion-text"),u=s("h3"),b=ge(p),C=y(),E&&E.c(),V=y(),M=s("div"),M.innerHTML=G,q=y(),j=s("ion-icon"),this.h()},l(U){t=c(U,"ION-ITEM",{});var B=m(t);l=c(B,"ION-AVATAR",{slot:!0});var R=m(l);n=c(R,"DIV",{class:!0,title:!0,style:!0});var W=m(n);i=c(W,"DIV",{class:!0});var F=m(i);d=be(F,f),F.forEach(a),W.forEach(a),R.forEach(a),O=w(B),g=c(B,"ION-LABEL",{button:!0});var te=m(g);h=c(te,"ION-TEXT",{color:!0});var ne=m(h);u=c(ne,"H3",{});var le=m(u);b=be(le,p),C=w(le),E&&E.l(le),le.forEach(a),ne.forEach(a),V=w(te),M=c(te,"DIV",{class:!0,"data-svelte-h":!0}),oe(M)!=="svelte-qaecoo"&&(M.innerHTML=G),te.forEach(a),q=w(B),j=c(B,"ION-ICON",{icon:!0,slot:!0}),m(j).forEach(a),B.forEach(a),this.h()},h(){Y(i,"class","order svelte-egzizz"),Y(n,"class","order-wrapper svelte-egzizz"),Y(n,"title",_=Xe(e[48].status)),k(n,"background-color",Pe(e[48].status,e[48].date_service)),k(n,"color",Me(Pe(e[48].status))),v(l,"slot","start"),v(h,"color","#2e2e2e"),Y(M,"class","sub svelte-egzizz"),v(g,"button",""),v(j,"icon",Re),v(j,"slot","end"),this.first=t},m(U,B){J(U,t,B),o(t,l),o(l,n),o(n,i),o(i,d),o(t,O),o(t,g),o(g,h),o(h,u),o(u,b),o(u,C),E&&E.m(u,null),o(g,V),o(g,M),o(t,q),o(t,j),P||(H=ue(g,"click",L),P=!0)},p(U,B){e=U,B[0]&32&&f!==(f=parseInt(e[48].pos)+1+"")&&Le(d,f),B[0]&32&&_!==(_=Xe(e[48].status))&&Y(n,"title",_),B[0]&32&&k(n,"background-color",Pe(e[48].status,e[48].date_service)),B[0]&32&&k(n,"color",Me(Pe(e[48].status))),B[0]&32&&p!==(p=e[48].title+"")&&Le(b,p),B[0]&32&&(z=e[48].support_list&&e[48].support_list.length||e[16](e[48])),z?E||(E=Wt(),E.c(),E.m(u,null)):E&&(E.d(1),E=null)},d(U){U&&a(t),E&&E.d(),P=!1,H()}}}function Oo(r){let e,t,l,n,i=`<ion-icon icon="${Ln}"></ion-icon>`,f,d,_,O=`<ion-icon icon="${zn}"></ion-icon>`,g,h,u=(r[6].name?r[6].name.toUpperCase():"")+"",p,b,C,z='<ion-segment-button value="list"><ion-label>Paradas</ion-label></ion-segment-button> <ion-segment-button value="map"><ion-label>Mapa</ion-label></ion-segment-button>',V,M,G,q;function j(E,L){if(E[9]==="list")return go;if(E[9]==="map")return vo}let P=j(r),H=P&&P(r);return{c(){e=s("ion-header"),t=s("ion-toolbar"),l=s("ion-buttons"),n=s("ion-button"),n.innerHTML=i,f=y(),d=s("ion-buttons"),_=s("ion-button"),_.innerHTML=O,g=y(),h=s("ion-title"),p=ge(u),b=y(),C=s("ion-segment"),C.innerHTML=z,V=y(),H&&H.c(),M=Se(),this.h()},l(E){e=c(E,"ION-HEADER",{translucent:!0});var L=m(e);t=c(L,"ION-TOOLBAR",{});var U=m(t);l=c(U,"ION-BUTTONS",{slot:!0});var B=m(l);n=c(B,"ION-BUTTON",{title:!0,alt:!0,"data-svelte-h":!0}),oe(n)!=="svelte-7ppz3r"&&(n.innerHTML=i),B.forEach(a),f=w(U),d=c(U,"ION-BUTTONS",{slot:!0});var R=m(d);_=c(R,"ION-BUTTON",{"data-svelte-h":!0}),oe(_)!=="svelte-nf50hj"&&(_.innerHTML=O),R.forEach(a),g=w(U),h=c(U,"ION-TITLE",{});var W=m(h);p=be(W,u),W.forEach(a),U.forEach(a),b=w(L),C=c(L,"ION-SEGMENT",{value:!0,"data-svelte-h":!0}),oe(C)!=="svelte-lue4c9"&&(C.innerHTML=z),L.forEach(a),V=w(E),H&&H.l(E),M=Se(),this.h()},h(){v(n,"title","Atrás"),v(n,"alt","Atrás"),v(l,"slot","start"),v(d,"slot","end"),v(C,"value","list"),v(e,"translucent","")},m(E,L){J(E,e,L),o(e,t),o(t,l),o(l,n),o(t,f),o(t,d),o(d,_),o(t,g),o(t,h),o(h,p),o(e,b),o(e,C),J(E,V,L),H&&H.m(E,L),J(E,M,L),G||(q=[ue(n,"click",r[17]),ue(_,"click",r[20]),ue(C,"ionChange",r[21])],G=!0)},p(E,L){L[0]&64&&u!==(u=(E[6].name?E[6].name.toUpperCase():"")+"")&&Le(p,u),P===(P=j(E))&&H?H.p(E,L):(H&&H.d(1),H=P&&P(E),H&&(H.c(),H.m(M.parentNode,M)))},d(E){E&&(a(e),a(V),a(M)),H&&H.d(E),G=!1,He(q)}}}function No(r){let e,t,l,n=r[2]&&Ft(r);return{c(){e=y(),n&&n.c(),t=Se(),this.h()},l(i){an("svelte-kn0kph",Bt.head).forEach(a),e=w(i),n&&n.l(i),t=Se(),this.h()},h(){Bt.title="Rutaflow - Detalles de ruta"},m(i,f){J(i,e,f),n&&n.m(i,f),J(i,t,f),l=!0},p(i,f){i[2]?n?(n.p(i,f),f[0]&4&&it(n,1)):(n=Ft(i),n.c(),it(n,1),n.m(t.parentNode,t)):n&&(pn(),st(n,1,1,()=>{n=null}),un())},i(i){l||(it(n),l=!0)},o(i){st(n),l=!1},d(i){i&&(a(e),a(t)),n&&n.d(i)}}}function Pe(r,e=""){let t="#ffffff";return r==="pending"&&!e?t="#f2e300":r=="pending"&&e?t="#F6A833":r==="completed"&&(t="#44d900"),t}function Xe(r){let e="";return r=="pending"?e="Pendiente":r=="completed"&&(e="Completado"),e}function Me(r){r.slice(0,1)==="#"&&(r=r.slice(1)),r.length===3&&(r=r.split("").map(function(i){return i+i}).join(""));const e=parseInt(r.substr(0,2),16),t=parseInt(r.substr(2,2),16),l=parseInt(r.substr(4,2),16);return(e*299+t*587+l*114)/1e3>=128?"#414040":"#fff"}function Yt(r,e){for(let t=0;t<e.length;t++)if(e[t].alias===r)return e[t].val;return""}const To=r=>r.mandatory==="1",Co=r=>r.img;function yo(r,e,t){let l;sn(r,An,I=>t(19,l=I));var n=this&&this.__awaiter||function(I,T,D,N){function X(K){return K instanceof D?K:new D(function(Z){Z(K)})}return new(D||(D=Promise))(function(K,Z){function A(ee){try{Q(N.next(ee))}catch(x){Z(x)}}function S(ee){try{Q(N.throw(ee))}catch(x){Z(x)}}function Q(ee){ee.done?K(ee.value):X(ee.value).then(A,S)}Q((N=N.apply(I,T||[])).next())})};let{routeId:i}=e,{driverId:f}=e,d=rt,_=new Object,O=!0,g=!1,h=[],u={},p=[],b=[],C,z=!1,V="list",M,G="",q="",j=new Object;const P=()=>n(void 0,void 0,void 0,function*(){yield L(i),C.complete()});Ze(()=>n(void 0,void 0,void 0,function*(){_e(),yield L(i)}));function H(I){return n(this,void 0,void 0,function*(){if(t(9,V=I),V==="map"){yield cn(),M=document.getElementById("g_map");const T=new google.maps.Map(M,{zoom:8,center:{lat:20.6745683,lng:-103.3986104},mapId:"4504f8b37365c3d0"}),D=new google.maps.LatLngBounds,{AdvancedMarkerElement:N,PinElement:X}=yield google.maps.importLibrary("marker");navigator.geolocation?navigator.geolocation.getCurrentPosition(function(K){const Z=new google.maps.LatLng(K.coords.latitude,K.coords.longitude);new google.maps.Marker({position:Z,map:T,icon:{path:google.maps.SymbolPath.CIRCLE,fillColor:"#0062ff",fillOpacity:1,scale:6,strokeColor:"#ffffff",strokeWeight:2}}),new google.maps.Circle({strokeColor:"#00BFFF",strokeOpacity:.5,strokeWeight:1,fillColor:"#00BFFF",fillOpacity:.2,map:T,center:Z,radius:K.coords.accuracy}),D.extend(Z)},function(K){console.error("Error retrieving location:",K)}):console.error("Geolocation not supported by this browser."),u.lat1===u.lat2&&u.lon1===u.lon2?E(D,T,{lat:u.lat2,lon:u.lon2,color:u.color,title:u.destination},{type:"icon",iconClass:"icon-home",title:"Origen/Destino",glyph:`0,${String(h.length+1)}`}):(E(D,T,{lat:u.lat1,lon:u.lon1,color:u.color,title:u.origin},{type:"icon",iconClass:"icon-home",title:"Origen",glyph:"0"}),E(D,T,{lat:u.lat2,lon:u.lon2,color:u.color,title:u.destination},{type:"icon",iconClass:"icon-flag",title:"Destino",glyph:String(h.length+1)})),h.forEach((K,Z)=>{const A=parseFloat(K.lat),S=parseFloat(K.lon),Q=new google.maps.LatLng(A,S),ee=new google.maps.Marker({position:{lat:A,lng:S},map:T,title:K.title}),x=new X({background:Pe(K.status,K.date_service),borderColor:"#000",glyphColor:"#000",glyph:(parseInt(K.pos)+1).toString()});new N({map:T,position:Q,content:x.element,title:"Parada "+(parseInt(K.pos)+1).toString()+": "+K.title}).addListener("click",function(ke){B(K,!1)}),D.extend(ee.getPosition())}),T.fitBounds(D)}})}function E(I,T,D,N){return n(this,void 0,void 0,function*(){let X;const K=parseFloat(D.lat),Z=parseFloat(D.lon),A=new google.maps.LatLng(K,Z),{AdvancedMarkerElement:S,PinElement:Q}=yield google.maps.importLibrary("marker");N.type=="icon"?(X=document.createElement("i"),X.className=`${N.iconClass} icon`,X.style.fontSize="14px",X.style.color=Me(D.color),X.style.fontWeight="600"):N.type=="text";const ee=new google.maps.Marker({position:{lat:K,lng:Z},map:T,title:`${N.title}. ${D.title}`}),x=new Q({background:D.color,borderColor:"#000",glyphColor:Me(D.color),glyph:N.glyph});return new S({map:T,position:A,content:x.element,title:N.title+": "+D.title}).addListener("click",function(ke){R(u,N.title=="Destino"||N.title=="Origen/Destino")}),ee})}function L(I){return n(this,void 0,void 0,function*(){let T=new FormData;T.append("id_route",I),T=ae(T);try{const N=yield(yield fetch(`${d}api/admin/report/seguimiento_list.php`,{method:"POST",body:T})).json();t(6,u=N.data.seguimiento_list[0]),t(5,h=N.data.event_list),t(7,p=N.data.checklist),b=N.data.expenses,u&&t(4,g=u.km_inicial=="0"&&u.gas_inicial=="0"),t(3,O=!1)}catch(D){t(3,O=!1),console.error("Error fetching data:",D)}})}const U=I=>new Promise((T,D)=>{let N=new FormData;N.append("id_route",I.id_route),N.append("id_event",I.id_event),N=ae(N),fetch(`${d}api/admin/evidence/evidence_by_event.php`,{method:"POST",body:N}).then(X=>X.json()).then(X=>{T(X.data.event_evidence[0])}).catch(X=>{console.error("Error fetching data:",X),D(X)})}),B=(I,T)=>{U(I).then(D=>{I.stopsApproval=G,I.smsActive=q,D&&(I.img=D.img,I.driver_comments=D.driver_comments,I.comments=D.comments),Ue("modal-delivery-info",Mt,{delivery:I,isLast:T}).then(N=>{}).finally(()=>{L(i)})})},R=(I,T)=>{var D=new Object;T?D={title:I.destination,line1:I.dest_address}:D={title:I.origin,line1:I.origin_address},D.client_name=I.client_name,D.client_phone=I.tel,D.id_route=I.id_route,D.stopsApproval=G,D.smsActive=q;var N=!0;Ue("modal-delivery-info",Mt,{delivery:D,isLast:T,flag:N})},W=(I,T,D)=>{var N=!1;return z||(z=!0,Ue("modal-checklist",en,{checklist:I,driverId:T,routeId:D,isLast:N}).then(X=>{z=!1}),ne(D,"checklist")),""},F=I=>n(void 0,void 0,void 0,function*(){return yield L(I),b.length>0?Ue("modal-expense-detail",mo,{routeId:I,expenses:b}).then(T=>{}):Ue("modal-expense",ft,{routeId:I}).then(T=>{}),""}),te=I=>{if(I.tracking_type=="subscription"){if(I.subscriber_info&&I.payment_type==="cash"&&new Date(I.subscriber_info.payment_next)<new Date)return!0}else if(I.tracking_type=="ecommerce"&&Number(I.payment_pending)>0)return!0;return!1};function ne(I,T){let D=new FormData;return D.append("id_route",I),D.append("status",T),D=ae(D),fetch(`${d}api/admin/route/change_status.php`,{method:"POST",body:D}).then(N=>N.json()).then(N=>{}).catch(N=>{console.error("Error fetching data:",N)}),""}const le=()=>{_.type=="super"||_.type=="admin"?qe("/drivers/me"):_.id_driver&&qe(`/drivers/${_.id_driver}`)},me=(I,T)=>n(void 0,void 0,void 0,function*(){yield(yield je.create({header:I||"Error",message:T||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()});function ae(I){return I.append("token",_.token),I.append("id_user_over",_.id_user),I}const _e=()=>n(void 0,void 0,void 0,function*(){if(_.id_enterprise){let I=new FormData;I.append("id_enterprise",_.id_enterprise),I=ae(I);try{const T=yield fetch(`${d}api/admin/enterprise/enterprise_settings.php`,{method:"POST",body:I});T.ok?(j=(yield T.json()).nodos,G=Yt("stops_wait_approval",j),q=Yt("sms_active",j)):console.error("File upload failed:",T.statusText)}catch(T){console.error("Error during file upload:",T)}}}),ve=()=>F(i),de=I=>H(I.detail.value);function pe(I){De[I?"unshift":"push"](()=>{C=I,t(8,C)})}const Ee=()=>{R(u,!1)},Oe=I=>{const T=h.findIndex(Z=>Z.id_event===I.id_event),D=T===0,N=T>0?h[T-1]:null,X=D||N&&N.img!==null,K=I.img!==null&&I.img!=="";X||D&&!K?B(I,!1):me("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")},we=()=>{R(u,!0)};function Ce(I){De[I?"unshift":"push"](()=>{C=I,t(8,C)})}const he=()=>{R(u,!1)},Te=I=>{const T=h.findIndex(Z=>Z.id_event===I.id_event),D=T===0,N=T>0?h[T-1]:null,X=D||N&&N.img!==null,K=I.img!==null&&I.img!=="";X||D&&!K?B(I,!1):me("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")},ye=()=>{R(u,!0)};function Ie(I){De[I?"unshift":"push"](()=>{C=I,t(8,C)})}const se=()=>{R(u,!1)},$=I=>{const T=h.findIndex(Z=>Z.id_event===I.id_event),D=T===0,N=T>0?h[T-1]:null,X=D||N&&N.img!==null,K=I.img!==null&&I.img!=="";X||D&&!K?B(I,!1):me("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")},ie=()=>{R(u,!0)};return r.$$set=I=>{"routeId"in I&&t(0,i=I.routeId),"driverId"in I&&t(1,f=I.driverId)},r.$$.update=()=>{r.$$.dirty[0]&524293&&(t(0,{routeId:i,driverId:f}=l.params,i,(t(1,f),t(19,l),t(2,_),t(0,i))),t(2,_=JSON.parse(localStorage.getItem("userSession"))),_?_.id_user&&(_.type=="admin"||_.type=="super")?(L(i),qe(`/drivers/me/routes/${i}`)):_.id_user&&_.id_driver&&(L(i),qe(`/drivers/${_.id_driver}/routes/${i}`)):qe("/"))},[i,f,_,O,g,h,u,p,C,V,P,H,B,R,W,F,te,le,me,l,ve,de,pe,Ee,Oe,we,Ce,he,Te,ye,Ie,se,$,ie]}class Po extends Je{constructor(e){super(),Ye(this,e,yo,No,We,{routeId:0,driverId:1},null,[-1,-1])}}export{Po as component};

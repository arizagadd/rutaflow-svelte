import{s as ie,e as p,b as m,q as w,h as f,v as _,i as re,x as H,n as V,z as de,A as x,j as P,d as K,m as k,f as pe,w as u,G as Q,o as me}from"../chunks/index.BgXu2Isl.js";import{S as se,i as le,f as X,b as Y,d as Z,m as $,t as ee,a as te,e as ne}from"../chunks/index.Dk8PUFqT.js";import"../chunks/index-6e05b96e.C_9q9BoX.js";import{D as fe,a as oe}from"../chunks/overlays-b874c3c3.Dmq1hB91.js";import{a as _e}from"../chunks/authStore.BrPPkCsK.js";import{g as C}from"../chunks/entry.Ku51L176.js";function he(o){let e,a,s;return{c(){e=p("ion-input"),this.h()},l(t){e=m(t,"ION-INPUT",{type:!0,name:!0,placeholder:!0,value:!0}),w(e).forEach(f),this.h()},h(){_(e,"type",o[2]),_(e,"name",o[1]),_(e,"placeholder",o[3]),_(e,"value",o[0])},m(t,i){re(t,e,i),a||(s=[H(e,"ionBlur",o[5]),H(e,"ionChange",o[4])],a=!0)},p(t,[i]){i&4&&_(e,"type",t[2]),i&2&&_(e,"name",t[1]),i&8&&_(e,"placeholder",t[3]),i&1&&_(e,"value",t[0])},i:V,o:V,d(t){t&&f(e),a=!1,de(s)}}}function ve(o,e,a){let{name:s=""}=e,{type:t="text"}=e,{placeholder:i=""}=e,{value:c}=e;function d(n){a(0,c=n.target.value)}function b(){}return o.$$set=n=>{"name"in n&&a(1,s=n.name),"type"in n&&a(2,t=n.type),"placeholder"in n&&a(3,i=n.placeholder),"value"in n&&a(0,c=n.value)},[c,s,t,i,d,b]}class ae extends se{constructor(e){super(),le(this,e,ve,he,ie,{name:1,type:2,placeholder:3,value:0})}}function ge(o){let e,a,s,t='<ion-col></ion-col> <ion-col class="w-80 text-center svelte-dlpg8h"><img src="/rutaflow.png" alt="Rutaflow" class="svelte-dlpg8h"/></ion-col> <ion-col></ion-col>',i,c,d,b,n,v,O,l,h,g,E,I,A,L,N,j='<ion-col class="signup-col"><ion-button class="submit-btn svelte-dlpg8h" color="#2c83d3" expand="block" type="submit">Ingresar</ion-button></ion-col>',D,R,B;function ue(r){o[3](r)}let W={type:"text",placeholder:"Correo o Teléfono",name:"email",required:!0};o[0].email!==void 0&&(W.value=o[0].email),l=new ae({props:W}),x.push(()=>X(l,"value",ue));function ce(r){o[4](r)}let z={type:"password",placeholder:"Contraseña",name:"password",required:!0};return o[0].password!==void 0&&(z.value=o[0].password),I=new ae({props:z}),x.push(()=>X(I,"value",ce)),{c(){e=p("ion-app"),a=p("ion-content"),s=p("ion-row"),s.innerHTML=t,i=P(),c=p("div"),d=p("form"),b=p("ion-row"),n=p("ion-col"),v=p("ion-list"),O=p("ion-item"),Y(l.$$.fragment),g=P(),E=p("ion-item"),Y(I.$$.fragment),L=P(),N=p("ion-row"),N.innerHTML=j,this.h()},l(r){e=m(r,"ION-APP",{"color-mode":!0});var S=w(e);a=m(S,"ION-CONTENT",{class:!0,padding:!0});var y=w(a);s=m(y,"ION-ROW",{class:!0,"data-svelte-h":!0}),K(s)!=="svelte-xx8z9p"&&(s.innerHTML=t),i=k(y),c=m(y,"DIV",{class:!0});var T=w(c);d=m(T,"FORM",{});var M=w(d);b=m(M,"ION-ROW",{});var F=w(b);n=m(F,"ION-COL",{});var J=w(n);v=m(J,"ION-LIST",{});var q=w(v);O=m(q,"ION-ITEM",{});var U=w(O);Z(l.$$.fragment,U),U.forEach(f),g=k(q),E=m(q,"ION-ITEM",{});var G=w(E);Z(I.$$.fragment,G),G.forEach(f),q.forEach(f),J.forEach(f),F.forEach(f),L=k(M),N=m(M,"ION-ROW",{"data-svelte-h":!0}),K(N)!=="svelte-sdgh4c"&&(N.innerHTML=j),M.forEach(f),T.forEach(f),y.forEach(f),S.forEach(f),this.h()},h(){_(s,"class","logo-row svelte-dlpg8h"),pe(c,"class","login-box svelte-dlpg8h"),_(a,"class","login-content"),_(a,"padding",""),_(e,"color-mode","light")},m(r,S){re(r,e,S),u(e,a),u(a,s),u(a,i),u(a,c),u(c,d),u(d,b),u(b,n),u(n,v),u(v,O),$(l,O,null),u(v,g),u(v,E),$(I,E,null),u(d,L),u(d,N),D=!0,R||(B=H(d,"submit",o[1]),R=!0)},p(r,[S]){const y={};!h&&S&1&&(h=!0,y.value=r[0].email,Q(()=>h=!1)),l.$set(y);const T={};!A&&S&1&&(A=!0,T.value=r[0].password,Q(()=>A=!1)),I.$set(T)},i(r){D||(ee(l.$$.fragment,r),ee(I.$$.fragment,r),D=!0)},o(r){te(l.$$.fragment,r),te(I.$$.fragment,r),D=!1},d(r){r&&f(e),ne(l),ne(I),R=!1,B()}}}function we(o,e,a){let s=fe,t={},i=new Object;me(()=>{localStorage.clear()});const c=n=>{n.preventDefault();const v=async()=>{await(await oe.create({header:"Datos inválidos",message:"El correo/teléfono o la contraseña son incorrectos, vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()},O=async()=>{await(await oe.create({header:"Sin perfil de operador",message:"Su cuenta no cuenta con un perfil de operador creado",buttons:[{text:"Cerrar"}]})).present()},l=new FormData;return l.append("email",t.email),l.append("pass",t.password),fetch(`${s}api/admin/user/user_login.php`,{method:"POST",body:l}).then(h=>h.json()).then(h=>{if(h.nodos.length){const g=h.nodos[0];localStorage.setItem("userSession",JSON.stringify(g)),_e.set({resolved:!0,id:g.id_driver?g.id_driver:"me",user:{userData:g}}),g.id_driver?C(`/drivers/${g.id_driver}`):(C("/drivers/me"),O())}else v()}).catch(h=>{v()})};function d(n){o.$$.not_equal(t.email,n)&&(t.email=n,a(0,t))}function b(n){o.$$.not_equal(t.password,n)&&(t.password=n,a(0,t))}return o.$$.update=()=>{o.$$.dirty&4&&(a(2,i=JSON.parse(localStorage.getItem("userSession"))),i?i.id_user&&(i.type=="admin"||i.type=="super")?C("/drivers/me"):i.id_user&&i.id_driver&&C(`/drivers/${i.id_driver}`):C("/"))},[t,c,i,d,b]}class Ee extends se{constructor(e){super(),le(this,e,we,ge,ie,{})}}export{Ee as component};

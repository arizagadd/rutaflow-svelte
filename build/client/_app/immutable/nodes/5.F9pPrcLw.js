import{Z as Ot,s as Qe,e as d,j as T,b as f,q as g,d as le,h as u,m as C,v as b,i as W,w as r,x as de,n as Le,z as ze,_ as Mn,k as xe,B as c,o as tt,$ as yt,t as ye,r as we,f as V,a0 as Pt,y as Ae,a1 as st,A as Ue,F as wt,J as Sn,a2 as gt,a3 as Ge,a4 as Nt,a5 as Tt,l as Pn,p as An}from"../chunks/index.CdEBkEwf.js";import{S as Ze,i as $e,t as et,a as lt,b as kn,d as En,m as In,e as On,c as Dn,g as xn}from"../chunks/index.Dw8w8a4z.js";import{e as Fe,u as ct,d as ut,g as je,a as Ye,h as qe,b as Bn,c as Un,i as yn,f as Hn,j as wn,k as Rn,m as zn,n as pt,t as bt,s as Vn,o as Fn,q as Ct,r as Nn,v as Tn,w as Lt,x as Ke,y as Wn,z as qn,A as Mt,B as jn,C as Gn,I as Kn,D as Xn,E as Jn,F as Yn,p as Qn}from"../chunks/index.DspNRzHM.js";import"../chunks/index-6e05b96e.C_9q9BoX.js";import{m as nt,D as dt,a as Xe,W as Zn,b as $n}from"../chunks/overlays-b874c3c3.zxwplYQb.js";import{q as ei,t as ti}from"../chunks/ion-modal.BYMRzj9z.js";import{g as at}from"../chunks/entry.DDOSk10t.js";const ni=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global,ii=(l,e)=>{if(!customElements.get(l)){class t extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){new e({target:this.shadowRoot,props:this.componentProps||{}})}}customElements.define(l,t)}},oi=l=>document.createElement(l).constructor!==HTMLElement,li=(l,e)=>{oi(l)||ii(l,e)},Je=async(l,e,t={},n={})=>{ei(),ti(),li(l,e);const i=await nt.create({component:l,componentProps:t,...n});return i.addEventListener("ionModalDidPresent",()=>{const o=i.querySelector(l);o&&(o.componentProps=t)}),await i.present(),i.onWillDismiss()};let ot=Ot({km_inicial:[],gas_inicial:[],km_final:[],gas_final:[]}),Cn=Ot({flag:[]});function ri(l){let e,t,n,i,o="Cancelar",s,a,h="Captura de Km/Gas",k,v,_,m="Confirmar",p,E,y,w,P,B,A;return{c(){e=d("ion-header"),t=d("ion-toolbar"),n=d("ion-buttons"),i=d("ion-button"),i.textContent=o,s=T(),a=d("ion-title"),a.textContent=h,k=T(),v=d("ion-buttons"),_=d("ion-button"),_.textContent=m,p=T(),E=d("ion-content"),y=d("ion-item"),w=d("ion-input"),this.h()},l(U){e=f(U,"ION-HEADER",{translucent:!0});var F=g(e);t=f(F,"ION-TOOLBAR",{});var q=g(t);n=f(q,"ION-BUTTONS",{slot:!0});var N=g(n);i=f(N,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),le(i)!=="svelte-17pq4f4"&&(i.textContent=o),N.forEach(u),s=C(q),a=f(q,"ION-TITLE",{"data-svelte-h":!0}),le(a)!=="svelte-1yhkaq7"&&(a.textContent=h),k=C(q),v=f(q,"ION-BUTTONS",{slot:!0});var H=g(v);_=f(H,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),le(_)!=="svelte-cm6j4s"&&(_.textContent=m),H.forEach(u),q.forEach(u),F.forEach(u),p=C(U),E=f(U,"ION-CONTENT",{fullscreen:!0});var S=g(E);y=f(S,"ION-ITEM",{});var O=g(y);w=f(O,"ION-INPUT",{class:!0,inputmode:!0,pattern:!0,type:!0,placeholder:!0,value:!0,required:!0});var M=g(w);M.forEach(u),O.forEach(u),S.forEach(u),this.h()},h(){b(i,"color","medium"),b(n,"slot","start"),b(_,"strong",""),b(v,"slot","end"),b(e,"translucent",""),b(w,"class","fin-km"),b(w,"inputmode","numeric"),b(w,"pattern","[0-9]*"),b(w,"type","number"),b(w,"placeholder",P="Ingresa "+l[0]+" actual"),b(w,"value",l[1]),b(w,"required",""),b(E,"fullscreen","")},m(U,F){W(U,e,F),r(e,t),r(t,n),r(n,i),r(t,s),r(t,a),r(t,k),r(t,v),r(v,_),W(U,p,F),W(U,E,F),r(E,y),r(y,w),B||(A=[de(i,"click",l[2]),de(_,"click",l[3]),de(w,"input",l[4])],B=!0)},p(U,[F]){F&1&&P!==(P="Ingresa "+U[0]+" actual")&&b(w,"placeholder",P),F&2&&b(w,"value",U[1])},i:Le,o:Le,d(U){U&&(u(e),u(p),u(E)),B=!1,ze(A)}}}function si(l,e,t){const n=Mn();let o=document.querySelector("ion-modal").componentProps.data_type,s="";Cn.subscribe(_=>{o=_.flag[0],o=="km_final"||o=="km_inicial"?t(0,s="kilometraje"):t(0,s="litros de gasolina")});let a=0;function h(){nt.dismiss()}function k(){n("modalResult",{data:"Your data",role:"confirm"}),o=="km_inicial"?ot.update(m=>({...m,km_inicial:[a]})):o=="gas_inicial"?ot.update(m=>({...m,gas_inicial:[a]})):o=="km_final"?ot.update(m=>({...m,km_final:[a]})):o=="gas_final"&&ot.update(m=>({...m,gas_final:[a]})),h()}return[s,a,h,k,_=>t(1,a=_.target.value)]}class ai extends Ze{constructor(e){super(),$e(this,e,si,ri,Qe,{})}}const kt=Ot({items:[],checkedIndices:[],mandatory:[]});function At(l,e,t){const n=l.slice();return n[56]=e[t],n[57]=e,n[58]=t,n}function ci(l){let e,t,n,i,o,s="Kilometraje inicial",a,h,k=l[2]?l[2]+" km.":"Cargar km",v,_,m,p,E,y,w,P="Gasolina inicial (litros)",B,A,U=l[3]?l[3]+" litros":"Cargar gas",F,q,N,H;return q=yt(l[22][0]),{c(){e=d("ion-item"),t=d("ion-label"),n=d("input"),i=T(),o=d("p"),o.textContent=s,a=T(),h=d("ion-button"),v=ye(k),_=T(),m=d("ion-item"),p=d("ion-label"),E=d("input"),y=T(),w=d("p"),w.textContent=P,B=T(),A=d("ion-button"),F=ye(U),this.h()},l(S){e=f(S,"ION-ITEM",{});var O=g(e);t=f(O,"ION-LABEL",{style:!0});var M=g(t);n=f(M,"INPUT",{id:!0,style:!0,type:!0}),i=C(M),o=f(M,"P",{style:!0,"data-svelte-h":!0}),le(o)!=="svelte-88twxi"&&(o.textContent=s),M.forEach(u),a=C(O),h=f(O,"ION-BUTTON",{fill:!0,size:!0,class:!0,"aria-selected":!0});var R=g(h);v=we(R,k),R.forEach(u),O.forEach(u),_=C(S),m=f(S,"ION-ITEM",{});var x=g(m);p=f(x,"ION-LABEL",{style:!0});var j=g(p);E=f(j,"INPUT",{id:!0,style:!0,type:!0}),y=C(j),w=f(j,"P",{style:!0,"data-svelte-h":!0}),le(w)!=="svelte-1ux30eb"&&(w.textContent=P),j.forEach(u),B=C(x),A=f(x,"ION-BUTTON",{fill:!0,class:!0,size:!0,style:!0});var Y=g(A);F=we(Y,U),Y.forEach(u),x.forEach(u),this.h()},h(){V(n,"id","chkbox-km-ini"),c(n,"pointer-events","auto"),V(n,"type","checkbox"),n.required=!0,c(o,"margin-left","10px"),c(t,"display","flex"),b(h,"fill","outline"),b(h,"size","small"),b(h,"class","loadKmInicial"),b(h,"aria-selected",""),V(E,"id","chkbox-gas-ini"),c(E,"pointer-events","auto"),V(E,"type","checkbox"),E.required=!0,c(w,"margin-left","10px"),c(p,"display","flex"),b(A,"fill","outline"),b(A,"class","loadGasInicial"),b(A,"size","small"),c(A,"height","16px "),q.p(n,E)},m(S,O){W(S,e,O),r(e,t),r(t,n),n.checked=~(l[6]||[]).indexOf(n.__value),l[29](n),r(t,i),r(t,o),r(e,a),r(e,h),r(h,v),W(S,_,O),W(S,m,O),r(m,p),r(p,E),l[31](E),E.checked=~(l[6]||[]).indexOf(E.__value),r(p,y),r(p,w),r(m,B),r(m,A),r(A,F),N||(H=[de(n,"change",l[28]),de(h,"click",l[30]),de(E,"change",l[32]),de(A,"click",l[33])],N=!0)},p(S,O){O[0]&65&&(n.checked=~(S[6]||[]).indexOf(n.__value)),O[0]&4&&k!==(k=S[2]?S[2]+" km.":"Cargar km")&&Ae(v,k),O[0]&65&&(E.checked=~(S[6]||[]).indexOf(E.__value)),O[0]&8&&U!==(U=S[3]?S[3]+" litros":"Cargar gas")&&Ae(F,U)},d(S){S&&(u(e),u(_),u(m)),l[29](null),l[31](null),q.r(),N=!1,ze(H)}}}function ui(l){let e,t,n,i,o,s="Kilometraje final",a,h,k=l[4]?l[4]+" km.":"Cargar km",v,_,m,p,E,y,w,P="Gasolina final (litros)",B,A,U=l[5]?l[5]+" litros":"Cargar gas",F,q,N,H;return q=yt(l[22][0]),{c(){e=d("ion-item"),t=d("ion-label"),n=d("input"),i=T(),o=d("p"),o.textContent=s,a=T(),h=d("ion-button"),v=ye(k),_=T(),m=d("ion-item"),p=d("ion-label"),E=d("input"),y=T(),w=d("p"),w.textContent=P,B=T(),A=d("ion-button"),F=ye(U),this.h()},l(S){e=f(S,"ION-ITEM",{});var O=g(e);t=f(O,"ION-LABEL",{style:!0});var M=g(t);n=f(M,"INPUT",{id:!0,style:!0,type:!0}),i=C(M),o=f(M,"P",{style:!0,"data-svelte-h":!0}),le(o)!=="svelte-ccmu71"&&(o.textContent=s),M.forEach(u),a=C(O),h=f(O,"ION-BUTTON",{fill:!0,size:!0,class:!0,"aria-selected":!0});var R=g(h);v=we(R,k),R.forEach(u),O.forEach(u),_=C(S),m=f(S,"ION-ITEM",{});var x=g(m);p=f(x,"ION-LABEL",{style:!0});var j=g(p);E=f(j,"INPUT",{id:!0,style:!0,type:!0}),y=C(j),w=f(j,"P",{style:!0,"data-svelte-h":!0}),le(w)!=="svelte-wsoyd2"&&(w.textContent=P),j.forEach(u),B=C(x),A=f(x,"ION-BUTTON",{fill:!0,size:!0,class:!0});var Y=g(A);F=we(Y,U),Y.forEach(u),x.forEach(u),this.h()},h(){V(n,"id","chkbox-km-fin"),c(n,"pointer-events","auto"),V(n,"type","checkbox"),n.required=!0,c(o,"margin-left","10px"),c(t,"display","flex"),b(h,"fill","outline"),b(h,"size","small"),b(h,"class","loadKmInicial"),b(h,"aria-selected",""),V(E,"id","chkbox-gas-fin"),c(E,"pointer-events","auto"),V(E,"type","checkbox"),E.required=!0,c(w,"margin-left","10px"),c(p,"display","flex"),b(A,"fill","outline"),b(A,"size","small"),b(A,"class","loadGasInicial"),q.p(n,E)},m(S,O){W(S,e,O),r(e,t),r(t,n),n.checked=~(l[6]||[]).indexOf(n.__value),l[23](n),r(t,i),r(t,o),r(e,a),r(e,h),r(h,v),W(S,_,O),W(S,m,O),r(m,p),r(p,E),E.checked=~(l[6]||[]).indexOf(E.__value),l[26](E),r(p,y),r(p,w),r(m,B),r(m,A),r(A,F),N||(H=[de(n,"change",l[21]),de(h,"click",l[24]),de(E,"change",l[25]),de(A,"click",l[27])],N=!0)},p(S,O){O[0]&65&&(n.checked=~(S[6]||[]).indexOf(n.__value)),O[0]&16&&k!==(k=S[4]?S[4]+" km.":"Cargar km")&&Ae(v,k),O[0]&65&&(E.checked=~(S[6]||[]).indexOf(E.__value)),O[0]&32&&U!==(U=S[5]?S[5]+" litros":"Cargar gas")&&Ae(F,U)},d(S){S&&(u(e),u(_),u(m)),l[23](null),l[26](null),q.r(),N=!1,ze(H)}}}function Dt(l){let e=[],t=new Map,n,i=Fe(l[0]);const o=s=>s[56].id_checklist_event;for(let s=0;s<i.length;s+=1){let a=At(l,i,s),h=o(a);t.set(h,e[s]=xt(h,a))}return{c(){for(let s=0;s<e.length;s+=1)e[s].c();n=xe()},l(s){for(let a=0;a<e.length;a+=1)e[a].l(s);n=xe()},m(s,a){for(let h=0;h<e.length;h+=1)e[h]&&e[h].m(s,a);W(s,n,a)},p(s,a){a[0]&827841&&(i=Fe(s[0]),e=ct(e,a,o,1,s,i,t,n.parentNode,ut,xt,n,At))},d(s){s&&u(n);for(let a=0;a<e.length;a+=1)e[a].d(s)}}}function di(l){let e,t=(l[15][l[56].id_checklist_event]?l[15][l[56].id_checklist_event]:"Cargar evidencia")+"",n,i;return{c(){e=d("label"),n=ye(t),this.h()},l(o){e=f(o,"LABEL",{for:!0,class:!0});var s=g(e);n=we(s,t),s.forEach(u),this.h()},h(){V(e,"for",i="chklist-"+l[56].id_checklist_event),V(e,"class","button-label")},m(o,s){W(o,e,s),r(e,n)},p(o,s){s[0]&32769&&t!==(t=(o[15][o[56].id_checklist_event]?o[15][o[56].id_checklist_event]:"Cargar evidencia")+"")&&Ae(n,t),s[0]&1&&i!==(i="chklist-"+o[56].id_checklist_event)&&V(e,"for",i)},d(o){o&&u(e)}}}function fi(l){let e;return{c(){e=d("ion-spinner"),this.h()},l(t){e=f(t,"ION-SPINNER",{name:!0,class:!0}),g(e).forEach(u),this.h()},h(){b(e,"name","dots"),b(e,"class","button-spinner")},m(t,n){W(t,e,n)},p:Le,d(t){t&&u(e)}}}function xt(l,e){let t,n,i,o,s,a=!1,h=e[56],k,v,_=e[56].item+"",m,p,E,y=e[56].mandatory=="1"?" * ":"",w,P,B,A,U,F,q,N,H,S,O;const M=()=>e[35](i,h),R=()=>e[35](null,h);function x(){return e[36](e[56])}function j(Q,L){return Q[13][Q[56].id_checklist_event]?fi:di}let Y=j(e),ie=Y(e);function be(...Q){return e[38](e[56],...Q)}return H=yt(e[22][0]),{key:l,first:null,c(){t=d("ion-item"),n=d("ion-label"),i=d("input"),k=T(),v=d("p"),m=ye(_),p=T(),E=d("b"),w=ye(y),P=T(),B=d("ion-button"),A=d("div"),ie.c(),U=T(),F=d("input"),N=T(),this.h()},l(Q){t=f(Q,"ION-ITEM",{});var L=g(t);n=f(L,"ION-LABEL",{style:!0});var re=g(n);i=f(re,"INPUT",{id:!0,style:!0,type:!0}),k=C(re),v=f(re,"P",{style:!0});var he=g(v);m=we(he,_),he.forEach(u),p=C(re),E=f(re,"B",{style:!0});var se=g(E);w=we(se,y),se.forEach(u),re.forEach(u),P=C(L),B=f(L,"ION-BUTTON",{fill:!0,class:!0,size:!0});var oe=g(B);A=f(oe,"DIV",{class:!0});var ne=g(A);ie.l(ne),U=C(ne),F=f(ne,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0,capture:!0}),ne.forEach(u),oe.forEach(u),N=C(L),L.forEach(u),this.h()},h(){V(i,"id",o=`chkbox-${e[56].id_checklist_event}`),c(i,"pointer-events","auto"),V(i,"type","checkbox"),i.__value=s=e[56].id_checklist_event,Pt(i,i.__value),i.required=!0,c(v,"margin-left","10px"),c(E,"margin-left","5px"),c(n,"display","flex"),c(F,"display","none"),V(F,"id",q="chklist-"+e[56].id_checklist_event),V(F,"name","fileToUpload"),V(F,"type","file"),V(F,"accept","image/*"),V(F,"capture","environment"),V(A,"class","button-content"),b(B,"fill","outline"),b(B,"class","loadEvidence"),b(B,"size","small"),H.p(i),this.first=t},m(Q,L){W(Q,t,L),r(t,n),r(n,i),i.checked=~(e[6]||[]).indexOf(i.__value),M(),r(n,k),r(n,v),r(v,m),r(n,p),r(n,E),r(E,w),r(t,P),r(t,B),r(B,A),ie.m(A,null),r(A,U),r(A,F),e[37](F),r(t,N),S||(O=[de(i,"change",e[34]),de(i,"change",x),de(F,"change",be)],S=!0)},p(Q,L){e=Q,L[0]&1&&o!==(o=`chkbox-${e[56].id_checklist_event}`)&&V(i,"id",o),L[0]&1&&s!==(s=e[56].id_checklist_event)&&(i.__value=s,Pt(i,i.__value),a=!0),(a||L[0]&65)&&(i.checked=~(e[6]||[]).indexOf(i.__value)),h!==e[56]&&(R(),h=e[56],M()),L[0]&1&&_!==(_=e[56].item+"")&&Ae(m,_),L[0]&1&&y!==(y=e[56].mandatory=="1"?" * ":"")&&Ae(w,y),Y===(Y=j(e))&&ie?ie.p(e,L):(ie.d(1),ie=Y(e),ie&&(ie.c(),ie.m(A,U))),L[0]&1&&q!==(q="chklist-"+e[56].id_checklist_event)&&V(F,"id",q)},d(Q){Q&&u(t),R(),ie.d(),e[37](null),H.r(),S=!1,ze(O)}}}function Bt(l){let e,t='<ion-spinner name="dots" style="color:white;"></ion-spinner>';return{c(){e=d("div"),e.innerHTML=t,this.h()},l(n){e=f(n,"DIV",{class:!0,style:!0,"data-svelte-h":!0}),le(e)!=="svelte-1muo9sg"&&(e.innerHTML=t),this.h()},h(){V(e,"class","overlay"),c(e,"position","fixed"),c(e,"top","0"),c(e,"left","0"),c(e,"width","100vw"),c(e,"height","100vh"),c(e,"background","rgba(0, 0, 0, 0.5)"),c(e,"display","flex"),c(e,"align-items","center"),c(e,"justify-content","center"),c(e,"z-index","9999")},m(n,i){W(n,e,i)},d(n){n&&u(e)}}}function hi(l){let e,t,n,i,o="Cancelar",s,a,h="REQUERIMIENTOS DE RUTA",k,v,_,m,p,E,y,w="Confirmar",P,B,A,U;function F(O,M){return O[1]?ui:ci}let q=F(l),N=q(l),H=l[0]&&Dt(l),S=l[14]&&Bt();return{c(){e=d("ion-header"),t=d("ion-toolbar"),n=d("ion-buttons"),i=d("ion-button"),i.textContent=o,s=T(),a=d("ion-title"),a.textContent=h,k=T(),v=d("ion-content"),_=d("ion-list"),N.c(),m=T(),H&&H.c(),p=T(),E=d("ion-footer"),y=d("ion-button"),y.textContent=w,P=T(),S&&S.c(),B=xe(),this.h()},l(O){e=f(O,"ION-HEADER",{translucent:!0});var M=g(e);t=f(M,"ION-TOOLBAR",{});var R=g(t);n=f(R,"ION-BUTTONS",{slot:!0});var x=g(n);i=f(x,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),le(i)!=="svelte-18837zq"&&(i.textContent=o),x.forEach(u),s=C(R),a=f(R,"ION-TITLE",{"data-svelte-h":!0}),le(a)!=="svelte-19bar5p"&&(a.textContent=h),R.forEach(u),M.forEach(u),k=C(O),v=f(O,"ION-CONTENT",{fullscreen:!0});var j=g(v);_=f(j,"ION-LIST",{});var Y=g(_);N.l(Y),m=C(Y),H&&H.l(Y),Y.forEach(u),j.forEach(u),p=C(O),E=f(O,"ION-FOOTER",{});var ie=g(E);y=f(ie,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),le(y)!=="svelte-1vqzxem"&&(y.textContent=w),ie.forEach(u),P=C(O),S&&S.l(O),B=xe(),this.h()},h(){b(i,"color","medium"),b(n,"slot","start"),b(e,"translucent",""),b(v,"fullscreen",""),b(y,"fill","outline"),b(y,"color","tertiary"),b(y,"strong",""),c(y,"width","99%"),c(y,"height","auto"),c(y,"margin-bottom","120px")},m(O,M){W(O,e,M),r(e,t),r(t,n),r(n,i),r(t,s),r(t,a),W(O,k,M),W(O,v,M),r(v,_),N.m(_,null),r(_,m),H&&H.m(_,null),W(O,p,M),W(O,E,M),r(E,y),W(O,P,M),S&&S.m(O,M),W(O,B,M),A||(U=[de(i,"click",l[16]),de(y,"click",l[17])],A=!0)},p(O,M){q===(q=F(O))&&N?N.p(O,M):(N.d(1),N=q(O),N&&(N.c(),N.m(_,m))),O[0]?H?H.p(O,M):(H=Dt(O),H.c(),H.m(_,null)):H&&(H.d(1),H=null),O[14]?S||(S=Bt(),S.c(),S.m(B.parentNode,B)):S&&(S.d(1),S=null)},i:Le,o:Le,d(O){O&&(u(e),u(k),u(v),u(p),u(E),u(P),u(B)),N.d(),H&&H.d(),S&&S.d(O),A=!1,ze(U)}}}function Et(l,e){if(typeof l=="object"&&l!==null||Array.isArray(l)){if(Array.isArray(l))return l.map(t=>Et(t,e)).flat();{const t=Object.keys(l);let n;return e=="id_checklist_event"?n=t.filter(o=>o.toLowerCase().includes("id_checklist_event")).map(o=>l[o]):e=="mandatory"?n=t.filter(o=>o.toLowerCase().includes("mandatory")).map(o=>l[o]):(console.error("Tipo de dato no reconocido."),n=!1),n}}else return console.error("Invalid input. Please provide a valid object or array."),[]}function _i(){return new Promise((l,e)=>{if(!navigator.geolocation)return e("Geoloc no soportada");navigator.geolocation.getCurrentPosition(t=>l({lat:+t.coords.latitude.toFixed(6),lng:+t.coords.longitude.toFixed(6)}),t=>e(t),{enableHighAccuracy:!0,maximumAge:0,timeout:8e3})})}function pi(l,e,t){let n=dt,i,o=[],s,a=!1,h,k,v,_,m=[],p=null,E={},y,w,P,B,A={},U=new Object,F=!1,q={},N={};tt(()=>{i=document.querySelector("ion-modal");const J=(i==null?void 0:i.componentProps)||{};if(t(0,o=J.checklist||[]),J.driverId,s=J.routeId,t(1,a=!!J.isLast),U=JSON.parse(localStorage.getItem("userSession")),a||kt.update(Z=>(Z.mandatory=Et(o,"mandatory"),Z.items=Et(o,"id_checklist_event"),Z)),i){i.breakpoints=[.25,.85,1],i.initialBreakpoint=.85;const Z=ge=>{var Te;const _e=(Te=ge.detail)==null?void 0:Te.breakpoint;_e&&_e>=.6&&i.setCurrentBreakpoint(.95)};i.addEventListener("ionBreakpointDidChange",Z)}});function H(J){t(13,A[J]=!0,A)}const S=async()=>{await(await Xe.create({header:"Datos o checklist incompletos",message:"Carga la evidencia requerida y marca todas las casillas para confirmar",buttons:[{text:"Cerrar"}]})).present()},O=async(J,Z)=>{await(await Xe.create({header:J||"Error",message:Z||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()},M=async J=>{await(await Xe.create({header:"Datos inválidos",message:J=="km"?"Llena correctamente el campo de kilometraje inicial":"Llena correctamente el campo de gasolina inicial",buttons:[{text:"Cerrar"}]})).present()},R=()=>{nt.dismiss()},x=async()=>{if(t(14,F=!0),a){const J=Q(v,"km"),Z=Q(_,"gas"),ge={km_final:J,gas_final:Z,id_route:s,id_user_over:U.id_user,token:U.token};J&&Z?(R(),je(`${n}api/admin/checklist/add_evidence.php`,function(_e){_e.success?(t(14,F=!1),O("Datos capturados","El kilometraje y gasolina final fueron registrados correctamente, espere aprobación para finalizar ruta")):(t(14,F=!1),O("Error","Vuelva a intentar capturar los datos solicitados"))},ge)):S()}else{const J=Q(h,"km"),Z=Q(k,"gas");let ge=null;try{ge=await _i()}catch(_e){console.warn("GPS no disponible:",_e)}kt.update(_e=>{const Te=_e.mandatory,D=_e.items.filter((pe,Ne)=>_e.mandatory[Ne]==="1").every(pe=>_e.checkedIndices.includes(pe)),X=Array.isArray(Te)&&Te.some(pe=>pe==="1")&&!D?"checklist-pending":"enroute";if(J&&Z){let pe=new FormData;pe=oe(pe),pe.append("km_inicial",J),pe.append("gas_inicial",Z),pe.append("id_route",s),ge&&(pe.append("lat",ge.lat),pe.append("lng",ge.lng));for(const Ne in q)if(Object.prototype.hasOwnProperty.call(q,Ne)){const{img:ve,img_id:Pe}=q[Ne];pe.append(`selectedImages[${Ne}][img]`,ve),pe.append(`selectedImages[${Ne}][img_id]`,Pe)}fetch(`${n}api/admin/checklist/add_evidence.php`,{method:"POST",body:pe}).then(Ne=>Ne.json()).then(()=>{be(s,X)}).catch(Ne=>{console.error("Error fetching data:",Ne)}).finally(()=>{t(14,F=!1),R()})}else(!J||!Z)&&S();return _e})}se()},j=async(J,Z)=>{H(Z);const _e=J.target.files[0],Te=await Y(_e);if(Te){let I=new FormData;I.append("fileToUpload",Te),I=oe(I);try{const D=await fetch(`${n}api/admin/manager/upload_img_driver.php`,{method:"POST",body:I});if(D.ok){const z=await D.json();q={...q,[Z]:{img:z.img,img_id:z.img_id}},t(15,N={...N,[Z]:z.filename}),ie(Z),t(8,E[Z].checked=!0,E),t(13,A[Z]=!1,A)}else console.error("File upload failed:",D.statusText)}catch(D){console.error("Error durante la carga del archivo:",D)}}},Y=async J=>new Promise(Z=>{const ge=new Image;ge.src=URL.createObjectURL(J),ge.onload=()=>{const _e=document.createElement("canvas"),Te=_e.getContext("2d"),I=800,D=600;let z=ge.width,X=ge.height;z>I&&(X*=I/z,z=I),X>D&&(z*=D/X,X=D),_e.width=z,_e.height=X,Te.drawImage(ge,0,0,z,X),_e.toBlob(pe=>{Z(pe),URL.revokeObjectURL(ge.src),Te.clearRect(0,0,_e.width,_e.height)},"image/jpeg",.7)}}),ie=J=>{kt.update(Z=>(Z.checkedIndices.indexOf(J)===-1?Z.checkedIndices.push(J):console.error(`ID ${J} is already checked.`),Z.items.forEach(_e=>{_e.id_checklist_event===J&&(_e.checked=!0)}),Z))};function be(J,Z){let ge=new FormData;ge.append("id_route",J),ge.append("status",Z),ge=oe(ge),fetch(`${n}api/admin/route/change_status.php`,{method:"POST",body:ge}).then(_e=>_e.json()).then(_e=>{}).catch(_e=>{console.error("Error fetching data:",_e)})}function Q(J,Z){return/^\d+$/.test(J)?parseInt(J,10):(M(Z),null)}function L(J,Z){re(Z),i||(i=document.querySelector("ion-modal")),i&&(i.componentProps.data_type=Z),Je("modal-gas-km",ai,{r:Z},{breakpoints:[.25,.85,1],initialBreakpoint:.85,backdropBreakpoint:.25,handle:!0,handleBehavior:"cycle",canDismiss:!0,showBackdrop:!0}).then(()=>{ot.subscribe(ge=>he(ge,Z))})}function re(J){Cn.update(Z=>({...Z,flag:[J]}))}function he(J,Z){t(2,h=J.km_inicial?J.km_inicial:null),t(3,k=J.gas_inicial?J.gas_inicial:null),t(4,v=J.km_final?J.km_final:null),t(5,_=J.gas_final?J.gas_final:null),Z=="km_inicial"&&y&&t(9,y.checked=!0,y),Z=="gas_inicial"&&w&&t(10,w.checked=!0,w),Z=="km_final"&&P&&t(11,P.checked=!0,P),Z=="gas_final"&&B&&t(12,B.checked=!0,B)}function se(){ot.set({km_inicial:[],gas_inicial:[],km_final:[],gas_final:[]})}function oe(J){return J.append("token",U.token),J.append("id_user_over",U.id_user),J}const ne=[[]];function fe(){m=st(ne[0],this.__value,this.checked),t(6,m)}function ue(J){Ue[J?"unshift":"push"](()=>{P=J,t(11,P)})}const ae=J=>L(J,"km_final");function te(){m=st(ne[0],this.__value,this.checked),t(6,m)}function ke(J){Ue[J?"unshift":"push"](()=>{B=J,t(12,B)})}const me=J=>L(J,"gas_final");function Oe(){m=st(ne[0],this.__value,this.checked),t(6,m)}function $(J){Ue[J?"unshift":"push"](()=>{y=J,t(9,y)})}const ee=J=>L(J,"km_inicial");function G(J){Ue[J?"unshift":"push"](()=>{w=J,t(10,w)})}function ce(){m=st(ne[0],this.__value,this.checked),t(6,m)}const Ie=J=>L(J,"gas_inicial");function K(){m=st(ne[0],this.__value,this.checked),t(6,m)}function Ee(J,Z){Ue[J?"unshift":"push"](()=>{E[Z.id_checklist_event]=J,t(8,E)})}const Se=J=>ie(J.id_checklist_event);function Me(J){Ue[J?"unshift":"push"](()=>{p=J,t(7,p)})}return[o,a,h,k,v,_,m,p,E,y,w,P,B,A,F,N,R,x,j,ie,L,fe,ne,ue,ae,te,ke,me,Oe,$,ee,G,ce,Ie,K,Ee,Se,Me,(J,Z)=>j(Z,J.id_checklist_event)]}class Ln extends Ze{constructor(e){super(),$e(this,e,pi,hi,Qe,{},null,[-1,-1])}}/*!
 * Signature Pad v5.0.10 | https://github.com/szimek/signature_pad
 * (c) 2025 Szymon Nowak | Released under the MIT license
 */class mt{constructor(e,t,n,i){if(isNaN(e)||isNaN(t))throw new Error(`Point is invalid: (${e}, ${t})`);this.x=+e,this.y=+t,this.pressure=n||0,this.time=i||Date.now()}distanceTo(e){return Math.sqrt(Math.pow(this.x-e.x,2)+Math.pow(this.y-e.y,2))}equals(e){return this.x===e.x&&this.y===e.y&&this.pressure===e.pressure&&this.time===e.time}velocityFrom(e){return this.time!==e.time?this.distanceTo(e)/(this.time-e.time):0}}class St{static fromPoints(e,t){const n=this.calculateControlPoints(e[0],e[1],e[2]).c2,i=this.calculateControlPoints(e[1],e[2],e[3]).c1;return new St(e[1],n,i,e[2],t.start,t.end)}static calculateControlPoints(e,t,n){const i=e.x-t.x,o=e.y-t.y,s=t.x-n.x,a=t.y-n.y,h={x:(e.x+t.x)/2,y:(e.y+t.y)/2},k={x:(t.x+n.x)/2,y:(t.y+n.y)/2},v=Math.sqrt(i*i+o*o),_=Math.sqrt(s*s+a*a),m=h.x-k.x,p=h.y-k.y,E=v+_==0?0:_/(v+_),y={x:k.x+m*E,y:k.y+p*E},w=t.x-y.x,P=t.y-y.y;return{c1:new mt(h.x+w,h.y+P),c2:new mt(k.x+w,k.y+P)}}constructor(e,t,n,i,o,s){this.startPoint=e,this.control2=t,this.control1=n,this.endPoint=i,this.startWidth=o,this.endWidth=s}length(){let t=0,n,i;for(let o=0;o<=10;o+=1){const s=o/10,a=this.point(s,this.startPoint.x,this.control1.x,this.control2.x,this.endPoint.x),h=this.point(s,this.startPoint.y,this.control1.y,this.control2.y,this.endPoint.y);if(o>0){const k=a-n,v=h-i;t+=Math.sqrt(k*k+v*v)}n=a,i=h}return t}point(e,t,n,i,o){return t*(1-e)*(1-e)*(1-e)+3*n*(1-e)*(1-e)*e+3*i*(1-e)*e*e+o*e*e*e}}class mi{constructor(){try{this._et=new EventTarget}catch{this._et=document}}addEventListener(e,t,n){this._et.addEventListener(e,t,n)}dispatchEvent(e){return this._et.dispatchEvent(e)}removeEventListener(e,t,n){this._et.removeEventListener(e,t,n)}}function vi(l,e=250){let t=0,n=null,i,o,s;const a=()=>{t=Date.now(),n=null,i=l.apply(o,s),n||(o=null,s=[])};return function(...k){const v=Date.now(),_=e-(v-t);return o=this,s=k,_<=0||_>e?(n&&(clearTimeout(n),n=null),t=v,i=l.apply(o,s),n||(o=null,s=[])):n||(n=window.setTimeout(a,_)),i}}class vt extends mi{constructor(e,t={}){var n,i,o;super(),this.canvas=e,this._drawingStroke=!1,this._isEmpty=!0,this._lastPoints=[],this._data=[],this._lastVelocity=0,this._lastWidth=0,this.velocityFilterWeight=t.velocityFilterWeight||.7,this.minWidth=t.minWidth||.5,this.maxWidth=t.maxWidth||2.5,this.throttle=(n=t.throttle)!==null&&n!==void 0?n:16,this.minDistance=(i=t.minDistance)!==null&&i!==void 0?i:5,this.dotSize=t.dotSize||0,this.penColor=t.penColor||"black",this.backgroundColor=t.backgroundColor||"rgba(0,0,0,0)",this.compositeOperation=t.compositeOperation||"source-over",this.canvasContextOptions=(o=t.canvasContextOptions)!==null&&o!==void 0?o:{},this._strokeMoveUpdate=this.throttle?vi(vt.prototype._strokeUpdate,this.throttle):vt.prototype._strokeUpdate,this._handleMouseDown=this._handleMouseDown.bind(this),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this._handleTouchStart=this._handleTouchStart.bind(this),this._handleTouchMove=this._handleTouchMove.bind(this),this._handleTouchEnd=this._handleTouchEnd.bind(this),this._handlePointerDown=this._handlePointerDown.bind(this),this._handlePointerMove=this._handlePointerMove.bind(this),this._handlePointerUp=this._handlePointerUp.bind(this),this._ctx=e.getContext("2d",this.canvasContextOptions),this.clear(),this.on()}clear(){const{_ctx:e,canvas:t}=this;e.fillStyle=this.backgroundColor,e.clearRect(0,0,t.width,t.height),e.fillRect(0,0,t.width,t.height),this._data=[],this._reset(this._getPointGroupOptions()),this._isEmpty=!0,this._strokePointerId=void 0}fromDataURL(e,t={}){return new Promise((n,i)=>{const o=new Image,s=t.ratio||window.devicePixelRatio||1,a=t.width||this.canvas.width/s,h=t.height||this.canvas.height/s,k=t.xOffset||0,v=t.yOffset||0;this._reset(this._getPointGroupOptions()),o.onload=()=>{this._ctx.drawImage(o,k,v,a,h),n()},o.onerror=_=>{i(_)},o.crossOrigin="anonymous",o.src=e,this._isEmpty=!1})}toDataURL(e="image/png",t){switch(e){case"image/svg+xml":return typeof t!="object"&&(t=void 0),`data:image/svg+xml;base64,${btoa(this.toSVG(t))}`;default:return typeof t!="number"&&(t=void 0),this.canvas.toDataURL(e,t)}}on(){this.canvas.style.touchAction="none",this.canvas.style.msTouchAction="none",this.canvas.style.userSelect="none";const e=/Macintosh/.test(navigator.userAgent)&&"ontouchstart"in document;window.PointerEvent&&!e?this._handlePointerEvents():(this._handleMouseEvents(),"ontouchstart"in window&&this._handleTouchEvents())}off(){this.canvas.style.touchAction="auto",this.canvas.style.msTouchAction="auto",this.canvas.style.userSelect="auto",this.canvas.removeEventListener("pointerdown",this._handlePointerDown),this.canvas.removeEventListener("mousedown",this._handleMouseDown),this.canvas.removeEventListener("touchstart",this._handleTouchStart),this._removeMoveUpEventListeners()}_getListenerFunctions(){var e;const t=window.document===this.canvas.ownerDocument?window:(e=this.canvas.ownerDocument.defaultView)!==null&&e!==void 0?e:this.canvas.ownerDocument;return{addEventListener:t.addEventListener.bind(t),removeEventListener:t.removeEventListener.bind(t)}}_removeMoveUpEventListeners(){const{removeEventListener:e}=this._getListenerFunctions();e("pointermove",this._handlePointerMove),e("pointerup",this._handlePointerUp),e("mousemove",this._handleMouseMove),e("mouseup",this._handleMouseUp),e("touchmove",this._handleTouchMove),e("touchend",this._handleTouchEnd)}isEmpty(){return this._isEmpty}fromData(e,{clear:t=!0}={}){t&&this.clear(),this._fromData(e,this._drawCurve.bind(this),this._drawDot.bind(this)),this._data=this._data.concat(e)}toData(){return this._data}_isLeftButtonPressed(e,t){return t?e.buttons===1:(e.buttons&1)===1}_pointerEventToSignatureEvent(e){return{event:e,type:e.type,x:e.clientX,y:e.clientY,pressure:"pressure"in e?e.pressure:0}}_touchEventToSignatureEvent(e){const t=e.changedTouches[0];return{event:e,type:e.type,x:t.clientX,y:t.clientY,pressure:t.force}}_handleMouseDown(e){!this._isLeftButtonPressed(e,!0)||this._drawingStroke||this._strokeBegin(this._pointerEventToSignatureEvent(e))}_handleMouseMove(e){if(!this._isLeftButtonPressed(e,!0)||!this._drawingStroke){this._strokeEnd(this._pointerEventToSignatureEvent(e),!1);return}this._strokeMoveUpdate(this._pointerEventToSignatureEvent(e))}_handleMouseUp(e){this._isLeftButtonPressed(e)||this._strokeEnd(this._pointerEventToSignatureEvent(e))}_handleTouchStart(e){e.targetTouches.length!==1||this._drawingStroke||(e.cancelable&&e.preventDefault(),this._strokeBegin(this._touchEventToSignatureEvent(e)))}_handleTouchMove(e){if(e.targetTouches.length===1){if(e.cancelable&&e.preventDefault(),!this._drawingStroke){this._strokeEnd(this._touchEventToSignatureEvent(e),!1);return}this._strokeMoveUpdate(this._touchEventToSignatureEvent(e))}}_handleTouchEnd(e){e.targetTouches.length===0&&(e.cancelable&&e.preventDefault(),this._strokeEnd(this._touchEventToSignatureEvent(e)))}_getPointerId(e){return e.persistentDeviceId||e.pointerId}_allowPointerId(e,t=!1){return typeof this._strokePointerId>"u"?t:this._getPointerId(e)===this._strokePointerId}_handlePointerDown(e){this._drawingStroke||!this._isLeftButtonPressed(e)||!this._allowPointerId(e,!0)||(this._strokePointerId=this._getPointerId(e),e.preventDefault(),this._strokeBegin(this._pointerEventToSignatureEvent(e)))}_handlePointerMove(e){if(this._allowPointerId(e)){if(!this._isLeftButtonPressed(e,!0)||!this._drawingStroke){this._strokeEnd(this._pointerEventToSignatureEvent(e),!1);return}e.preventDefault(),this._strokeMoveUpdate(this._pointerEventToSignatureEvent(e))}}_handlePointerUp(e){this._isLeftButtonPressed(e)||!this._allowPointerId(e)||(e.preventDefault(),this._strokeEnd(this._pointerEventToSignatureEvent(e)))}_getPointGroupOptions(e){return{penColor:e&&"penColor"in e?e.penColor:this.penColor,dotSize:e&&"dotSize"in e?e.dotSize:this.dotSize,minWidth:e&&"minWidth"in e?e.minWidth:this.minWidth,maxWidth:e&&"maxWidth"in e?e.maxWidth:this.maxWidth,velocityFilterWeight:e&&"velocityFilterWeight"in e?e.velocityFilterWeight:this.velocityFilterWeight,compositeOperation:e&&"compositeOperation"in e?e.compositeOperation:this.compositeOperation}}_strokeBegin(e){if(!this.dispatchEvent(new CustomEvent("beginStroke",{detail:e,cancelable:!0})))return;const{addEventListener:n}=this._getListenerFunctions();switch(e.event.type){case"mousedown":n("mousemove",this._handleMouseMove,{passive:!1}),n("mouseup",this._handleMouseUp,{passive:!1});break;case"touchstart":n("touchmove",this._handleTouchMove,{passive:!1}),n("touchend",this._handleTouchEnd,{passive:!1});break;case"pointerdown":n("pointermove",this._handlePointerMove,{passive:!1}),n("pointerup",this._handlePointerUp,{passive:!1});break}this._drawingStroke=!0;const i=this._getPointGroupOptions(),o=Object.assign(Object.assign({},i),{points:[]});this._data.push(o),this._reset(i),this._strokeUpdate(e)}_strokeUpdate(e){if(!this._drawingStroke)return;if(this._data.length===0){this._strokeBegin(e);return}this.dispatchEvent(new CustomEvent("beforeUpdateStroke",{detail:e}));const t=this._createPoint(e.x,e.y,e.pressure),n=this._data[this._data.length-1],i=n.points,o=i.length>0&&i[i.length-1],s=o?t.distanceTo(o)<=this.minDistance:!1,a=this._getPointGroupOptions(n);if(!o||!(o&&s)){const h=this._addPoint(t,a);o?h&&this._drawCurve(h,a):this._drawDot(t,a),i.push({time:t.time,x:t.x,y:t.y,pressure:t.pressure})}this.dispatchEvent(new CustomEvent("afterUpdateStroke",{detail:e}))}_strokeEnd(e,t=!0){this._removeMoveUpEventListeners(),this._drawingStroke&&(t&&this._strokeUpdate(e),this._drawingStroke=!1,this._strokePointerId=void 0,this.dispatchEvent(new CustomEvent("endStroke",{detail:e})))}_handlePointerEvents(){this._drawingStroke=!1,this.canvas.addEventListener("pointerdown",this._handlePointerDown,{passive:!1})}_handleMouseEvents(){this._drawingStroke=!1,this.canvas.addEventListener("mousedown",this._handleMouseDown,{passive:!1})}_handleTouchEvents(){this.canvas.addEventListener("touchstart",this._handleTouchStart,{passive:!1})}_reset(e){this._lastPoints=[],this._lastVelocity=0,this._lastWidth=(e.minWidth+e.maxWidth)/2,this._ctx.fillStyle=e.penColor,this._ctx.globalCompositeOperation=e.compositeOperation}_createPoint(e,t,n){const i=this.canvas.getBoundingClientRect();return new mt(e-i.left,t-i.top,n,new Date().getTime())}_addPoint(e,t){const{_lastPoints:n}=this;if(n.push(e),n.length>2){n.length===3&&n.unshift(n[0]);const i=this._calculateCurveWidths(n[1],n[2],t),o=St.fromPoints(n,i);return n.shift(),o}return null}_calculateCurveWidths(e,t,n){const i=n.velocityFilterWeight*t.velocityFrom(e)+(1-n.velocityFilterWeight)*this._lastVelocity,o=this._strokeWidth(i,n),s={end:o,start:this._lastWidth};return this._lastVelocity=i,this._lastWidth=o,s}_strokeWidth(e,t){return Math.max(t.maxWidth/(e+1),t.minWidth)}_drawCurveSegment(e,t,n){const i=this._ctx;i.moveTo(e,t),i.arc(e,t,n,0,2*Math.PI,!1),this._isEmpty=!1}_drawCurve(e,t){const n=this._ctx,i=e.endWidth-e.startWidth,o=Math.ceil(e.length())*2;n.beginPath(),n.fillStyle=t.penColor;for(let s=0;s<o;s+=1){const a=s/o,h=a*a,k=h*a,v=1-a,_=v*v,m=_*v;let p=m*e.startPoint.x;p+=3*_*a*e.control1.x,p+=3*v*h*e.control2.x,p+=k*e.endPoint.x;let E=m*e.startPoint.y;E+=3*_*a*e.control1.y,E+=3*v*h*e.control2.y,E+=k*e.endPoint.y;const y=Math.min(e.startWidth+k*i,t.maxWidth);this._drawCurveSegment(p,E,y)}n.closePath(),n.fill()}_drawDot(e,t){const n=this._ctx,i=t.dotSize>0?t.dotSize:(t.minWidth+t.maxWidth)/2;n.beginPath(),this._drawCurveSegment(e.x,e.y,i),n.closePath(),n.fillStyle=t.penColor,n.fill()}_fromData(e,t,n){for(const i of e){const{points:o}=i,s=this._getPointGroupOptions(i);if(o.length>1)for(let a=0;a<o.length;a+=1){const h=o[a],k=new mt(h.x,h.y,h.pressure,h.time);a===0&&this._reset(s);const v=this._addPoint(k,s);v&&t(v,s)}else this._reset(s),n(o[0],s)}}toSVG({includeBackgroundColor:e=!1}={}){const t=this._data,n=Math.max(window.devicePixelRatio||1,1),i=0,o=0,s=this.canvas.width/n,a=this.canvas.height/n,h=document.createElementNS("http://www.w3.org/2000/svg","svg");if(h.setAttribute("xmlns","http://www.w3.org/2000/svg"),h.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),h.setAttribute("viewBox",`${i} ${o} ${s} ${a}`),h.setAttribute("width",s.toString()),h.setAttribute("height",a.toString()),e&&this.backgroundColor){const k=document.createElement("rect");k.setAttribute("width","100%"),k.setAttribute("height","100%"),k.setAttribute("fill",this.backgroundColor),h.appendChild(k)}return this._fromData(t,(k,{penColor:v})=>{const _=document.createElement("path");if(!isNaN(k.control1.x)&&!isNaN(k.control1.y)&&!isNaN(k.control2.x)&&!isNaN(k.control2.y)){const m=`M ${k.startPoint.x.toFixed(3)},${k.startPoint.y.toFixed(3)} C ${k.control1.x.toFixed(3)},${k.control1.y.toFixed(3)} ${k.control2.x.toFixed(3)},${k.control2.y.toFixed(3)} ${k.endPoint.x.toFixed(3)},${k.endPoint.y.toFixed(3)}`;_.setAttribute("d",m),_.setAttribute("stroke-width",(k.endWidth*2.25).toFixed(3)),_.setAttribute("stroke",v),_.setAttribute("fill","none"),_.setAttribute("stroke-linecap","round"),h.appendChild(_)}},(k,{penColor:v,dotSize:_,minWidth:m,maxWidth:p})=>{const E=document.createElement("circle"),y=_>0?_:(m+p)/2;E.setAttribute("r",y.toString()),E.setAttribute("cx",k.x.toString()),E.setAttribute("cy",k.y.toString()),E.setAttribute("fill",v),h.appendChild(E)}),h.outerHTML}}function gi(l){let e,t;return{c(){e=d("div"),t=d("canvas"),this.h()},l(n){e=f(n,"DIV",{class:!0,style:!0});var i=g(e);t=f(i,"CANVAS",{class:!0,style:!0}),g(t).forEach(u),i.forEach(u),this.h()},h(){V(t,"class","signature-canvas"),c(t,"position","absolute"),c(t,"top","0"),c(t,"left","0"),c(t,"width","100%"),c(t,"height","100%"),c(t,"display","block"),V(e,"class","signature-container"),c(e,"position","relative"),c(e,"width","100%"),c(e,"height","150px"),c(e,"border","1px solid #ccc"),c(e,"border-radius","4px"),c(e,"touch-action","none"),c(e,"-ms-touch-action","none")},m(n,i){W(n,e,i),r(e,t),l[5](t),l[6](e)},p:Le,i:Le,o:Le,d(n){n&&u(e),l[5](null),l[6](null)}}}function bi(l,e,t){let n,i,o,s;function a(){o&&o.clear()}async function h(p="image/png"){return!o||o.isEmpty()?(await(await Xe.create({header:"Firma vacía",message:"No existe firma por guardar",buttons:[{text:"Cerrar"}]})).present(),null):o.toDataURL(p)}function k(){v(),o&&o.clear()}function v(){const p=Math.max(window.devicePixelRatio||1,1),E=i.clientWidth,y=i.clientHeight;if(!E||!y)return;const w=32767,P=Math.min(p,w/E,w/y);t(0,n.width=Math.floor(E*P),n),t(0,n.height=Math.floor(y*P),n);const B=n.getContext("2d");try{B.scale(P,P)}catch(A){console.warn("Canvas scale failed:",A)}}tt(async()=>{await wt(),v(),o=new vt(n,{backgroundColor:"rgba(255, 255, 255, 0)",penColor:"black"}),s=new ResizeObserver(v),s.observe(i)}),Sn(()=>{s&&s.disconnect()});function _(p){Ue[p?"unshift":"push"](()=>{n=p,t(0,n)})}function m(p){Ue[p?"unshift":"push"](()=>{i=p,t(1,i)})}return[n,i,a,h,k,_,m]}class ki extends Ze{constructor(e){super(),$e(this,e,bi,gi,Qe,{clear:2,save:3,reset:4})}get clear(){return this.$$.ctx[2]}get save(){return this.$$.ctx[3]}get reset(){return this.$$.ctx[4]}}function Ut(l,e,t){const n=l.slice();return n[60]=e[t],n[62]=t,n}function Ei(l){let e,t,n,i,o;return{c(){e=d("ion-buttons"),t=d("ion-button"),n=ye("Confirmar"),this.h()},l(s){e=f(s,"ION-BUTTONS",{slot:!0});var a=g(e);t=f(a,"ION-BUTTON",{strong:!0,disabled:!0});var h=g(t);n=we(h,"Confirmar"),h.forEach(u),a.forEach(u),this.h()},h(){b(t,"strong",""),b(t,"disabled",l[23]()),b(e,"slot","end")},m(s,a){W(s,e,a),r(e,t),r(t,n),i||(o=de(t,"click",l[26]),i=!0)},p:Le,d(s){s&&u(e),i=!1,o()}}}function Ii(l){let e,t,n,i,o,s="Empresa",a,h,k=l[12].enterprise_name+"",v;return{c(){e=d("ion-item"),t=d("ion-icon"),n=T(),i=d("ion-label"),o=d("p"),o.textContent=s,a=T(),h=d("h2"),v=ye(k),this.h()},l(_){e=f(_,"ION-ITEM",{});var m=g(e);t=f(m,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(u),n=C(m),i=f(m,"ION-LABEL",{});var p=g(i);o=f(p,"P",{"data-svelte-h":!0}),le(o)!=="svelte-6noid3"&&(o.textContent=s),a=C(p),h=f(p,"H2",{});var E=g(h);v=we(E,k),E.forEach(u),p.forEach(u),m.forEach(u),this.h()},h(){b(t,"icon",Tn),b(t,"slot","start")},m(_,m){W(_,e,m),r(e,t),r(e,n),r(e,i),r(i,o),r(i,a),r(i,h),r(h,v)},p:Le,d(_){_&&u(e)}}}function Oi(l){let e,t,n,i,o,s="Negocio",a,h,k=l[12].client_name+"",v;return{c(){e=d("ion-item"),t=d("ion-icon"),n=T(),i=d("ion-label"),o=d("p"),o.textContent=s,a=T(),h=d("h2"),v=ye(k),this.h()},l(_){e=f(_,"ION-ITEM",{});var m=g(e);t=f(m,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(u),n=C(m),i=f(m,"ION-LABEL",{});var p=g(i);o=f(p,"P",{"data-svelte-h":!0}),le(o)!=="svelte-57b1dg"&&(o.textContent=s),a=C(p),h=f(p,"H2",{});var E=g(h);v=we(E,k),E.forEach(u),p.forEach(u),m.forEach(u),this.h()},h(){b(t,"icon",Tn),b(t,"slot","start")},m(_,m){W(_,e,m),r(e,t),r(e,n),r(e,i),r(i,o),r(i,a),r(i,h),r(h,v)},p:Le,d(_){_&&u(e)}}}function yi(l){let e,t,n,i,o,s="Teléfono de Negocio",a,h,k=l[12].client_phone+"",v;return{c(){e=d("ion-item"),t=d("ion-icon"),n=T(),i=d("ion-label"),o=d("p"),o.textContent=s,a=T(),h=d("h2"),v=ye(k),this.h()},l(_){e=f(_,"ION-ITEM",{href:!0});var m=g(e);t=f(m,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(u),n=C(m),i=f(m,"ION-LABEL",{class:!0});var p=g(i);o=f(p,"P",{"data-svelte-h":!0}),le(o)!=="svelte-1u5l7fz"&&(o.textContent=s),a=C(p),h=f(p,"H2",{});var E=g(h);v=we(E,k),E.forEach(u),p.forEach(u),m.forEach(u),this.h()},h(){b(t,"icon",Bn),b(t,"slot","start"),b(i,"class","ion-text-wrap"),b(e,"href","tel:"+l[12].client_phone)},m(_,m){W(_,e,m),r(e,t),r(e,n),r(e,i),r(i,o),r(i,a),r(i,h),r(h,v)},p:Le,d(_){_&&u(e)}}}function wi(l){let e,t,n,i,o,s="Domicilio Alternativo",a,h,k=l[12].line2+"",v,_,m;return{c(){e=d("ion-item"),t=d("ion-icon"),n=T(),i=d("ion-label"),o=d("p"),o.textContent=s,a=T(),h=d("h2"),v=ye(k),_=T(),m=d("ion-icon"),this.h()},l(p){e=f(p,"ION-ITEM",{href:!0});var E=g(e);t=f(E,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(u),n=C(E),i=f(E,"ION-LABEL",{class:!0});var y=g(i);o=f(y,"P",{"data-svelte-h":!0}),le(o)!=="svelte-1ub9uzw"&&(o.textContent=s),a=C(y),h=f(y,"H2",{});var w=g(h);v=we(w,k),w.forEach(u),y.forEach(u),_=C(E),m=f(E,"ION-ICON",{icon:!0,slot:!0}),g(m).forEach(u),E.forEach(u),this.h()},h(){b(t,"icon",Lt),b(t,"slot","start"),b(i,"class","ion-text-wrap"),b(m,"icon",Ke),b(m,"slot","end"),b(e,"href","https://www.google.com/maps/searhc/?api=1&query="+l[12].line2)},m(p,E){W(p,e,E),r(e,t),r(e,n),r(e,i),r(i,o),r(i,a),r(i,h),r(h,v),r(e,_),r(e,m)},p:Le,d(p){p&&u(e)}}}function Ni(l){let e,t,n,i,o,s="Domicilio",a,h,k=l[12].line1+"",v,_,m,p,E=l[12].line2&&l[12].line2.trim().length,y,w=E&&Ti(l);return{c(){e=d("ion-item"),t=d("ion-icon"),n=T(),i=d("ion-label"),o=d("p"),o.textContent=s,a=T(),h=d("h2"),v=ye(k),_=T(),m=d("ion-icon"),p=T(),w&&w.c(),y=xe(),this.h()},l(P){e=f(P,"ION-ITEM",{href:!0});var B=g(e);t=f(B,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(u),n=C(B),i=f(B,"ION-LABEL",{class:!0});var A=g(i);o=f(A,"P",{"data-svelte-h":!0}),le(o)!=="svelte-cbm7q1"&&(o.textContent=s),a=C(A),h=f(A,"H2",{});var U=g(h);v=we(U,k),U.forEach(u),A.forEach(u),_=C(B),m=f(B,"ION-ICON",{icon:!0,slot:!0}),g(m).forEach(u),B.forEach(u),p=C(P),w&&w.l(P),y=xe(),this.h()},h(){b(t,"icon",Lt),b(t,"slot","start"),b(i,"class","ion-text-wrap"),b(m,"icon",Ke),b(m,"slot","end"),b(e,"href","https://www.google.com/maps/search/?api=1&query="+l[12].line1)},m(P,B){W(P,e,B),r(e,t),r(e,n),r(e,i),r(i,o),r(i,a),r(i,h),r(h,v),r(e,_),r(e,m),W(P,p,B),w&&w.m(P,B),W(P,y,B)},p(P,B){E&&w.p(P,B)},d(P){P&&(u(e),u(p),u(y)),w&&w.d(P)}}}function Ti(l){let e,t,n,i,o,s="Domicilio Alternativo",a,h,k=l[12].line2+"",v,_,m;return{c(){e=d("ion-item"),t=d("ion-icon"),n=T(),i=d("ion-label"),o=d("p"),o.textContent=s,a=T(),h=d("h2"),v=ye(k),_=T(),m=d("ion-icon"),this.h()},l(p){e=f(p,"ION-ITEM",{href:!0});var E=g(e);t=f(E,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(u),n=C(E),i=f(E,"ION-LABEL",{class:!0});var y=g(i);o=f(y,"P",{"data-svelte-h":!0}),le(o)!=="svelte-1ub9uzw"&&(o.textContent=s),a=C(y),h=f(y,"H2",{});var w=g(h);v=we(w,k),w.forEach(u),y.forEach(u),_=C(E),m=f(E,"ION-ICON",{icon:!0,slot:!0}),g(m).forEach(u),E.forEach(u),this.h()},h(){b(t,"icon",Lt),b(t,"slot","start"),b(i,"class","ion-text-wrap"),b(m,"icon",Ke),b(m,"slot","end"),b(e,"href","https://www.google.com/maps/search/?api=1&query="+l[12].line2)},m(p,E){W(p,e,E),r(e,t),r(e,n),r(e,i),r(i,o),r(i,a),r(i,h),r(h,v),r(e,_),r(e,m)},p:Le,d(p){p&&u(e)}}}function Ci(l){let e,t,n,i,o,s="Contacto del Cliente",a,h,k,v,_=l[17]&&l[17]==="1"&&Li(l);return{c(){e=d("ion-item"),t=d("ion-icon"),n=T(),i=d("ion-label"),o=d("p"),o.textContent=s,a=T(),h=d("h2"),k=ye(l[19]),v=T(),_&&_.c(),this.h()},l(m){e=f(m,"ION-ITEM",{});var p=g(e);t=f(p,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(u),n=C(p),i=f(p,"ION-LABEL",{class:!0});var E=g(i);o=f(E,"P",{"data-svelte-h":!0}),le(o)!=="svelte-1utsyb6"&&(o.textContent=s),a=C(E),h=f(E,"H2",{});var y=g(h);k=we(y,l[19]),y.forEach(u),E.forEach(u),v=C(p),_&&_.l(p),p.forEach(u),this.h()},h(){b(t,"icon",Un),b(t,"slot","start"),b(i,"class","ion-text-wrap")},m(m,p){W(m,e,p),r(e,t),r(e,n),r(e,i),r(i,o),r(i,a),r(i,h),r(h,k),r(e,v),_&&_.m(e,null)},p(m,p){m[17]&&m[17]==="1"&&_.p(m,p)},d(m){m&&u(e),_&&_.d()}}}function Li(l){let e,t=`<ion-icon icon="${Wn}" slot="start"></ion-icon>
                        Notificar Cliente`,n,i;return{c(){e=d("ion-button"),e.innerHTML=t,this.h()},l(o){e=f(o,"ION-BUTTON",{fill:!0,style:!0,"data-svelte-h":!0}),le(e)!=="svelte-149vhpt"&&(e.innerHTML=t),this.h()},h(){b(e,"fill","outline"),c(e,"margin-left","16px")},m(o,s){W(o,e,s),n||(i=de(e,"click",l[27]),n=!0)},p:Le,d(o){o&&u(e),n=!1,i()}}}function Mi(l){let e,t,n,i,o,s="Notas de ubicación",a,h,k;return{c(){e=d("ion-item"),t=d("ion-icon"),n=T(),i=d("ion-label"),o=d("p"),o.textContent=s,a=T(),h=d("h2"),k=ye(l[20]),this.h()},l(v){e=f(v,"ION-ITEM",{});var _=g(e);t=f(_,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(u),n=C(_),i=f(_,"ION-LABEL",{class:!0});var m=g(i);o=f(m,"P",{"data-svelte-h":!0}),le(o)!=="svelte-nhm2ft"&&(o.textContent=s),a=C(m),h=f(m,"H2",{});var p=g(h);k=we(p,l[20]),p.forEach(u),m.forEach(u),_.forEach(u),this.h()},h(){b(t,"icon",yn),b(t,"slot","start"),b(i,"class","ion-text-wrap")},m(v,_){W(v,e,_),r(e,t),r(e,n),r(e,i),r(i,o),r(i,a),r(i,h),r(h,k)},p:Le,d(v){v&&u(e)}}}function Si(l){let e,t,n,i,o,s="Horarios",a,h,k=l[12].schedule+"",v;return{c(){e=d("ion-item"),t=d("ion-icon"),n=T(),i=d("ion-label"),o=d("p"),o.textContent=s,a=T(),h=d("h2"),v=ye(k),this.h()},l(_){e=f(_,"ION-ITEM",{});var m=g(e);t=f(m,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(u),n=C(m),i=f(m,"ION-LABEL",{});var p=g(i);o=f(p,"P",{"data-svelte-h":!0}),le(o)!=="svelte-11q7hm5"&&(o.textContent=s),a=C(p),h=f(p,"H2",{});var E=g(h);v=we(E,k),E.forEach(u),p.forEach(u),m.forEach(u),this.h()},h(){b(t,"icon",Hn),b(t,"slot","start")},m(_,m){W(_,e,m),r(e,t),r(e,n),r(e,i),r(i,o),r(i,a),r(i,h),r(h,v)},p:Le,d(_){_&&u(e)}}}function Pi(l){let e,t,n,i,o,s="Notas del operador",a,h,k=l[12].driver_comments+"",v;return{c(){e=d("ion-item"),t=d("ion-icon"),n=T(),i=d("ion-label"),o=d("p"),o.textContent=s,a=T(),h=d("h2"),v=ye(k),this.h()},l(_){e=f(_,"ION-ITEM",{});var m=g(e);t=f(m,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(u),n=C(m),i=f(m,"ION-LABEL",{});var p=g(i);o=f(p,"P",{"data-svelte-h":!0}),le(o)!=="svelte-1yk9qp4"&&(o.textContent=s),a=C(p),h=f(p,"H2",{});var E=g(h);v=we(E,k),E.forEach(u),p.forEach(u),m.forEach(u),this.h()},h(){b(t,"icon",wn),b(t,"slot","start")},m(_,m){W(_,e,m),r(e,t),r(e,n),r(e,i),r(i,o),r(i,a),r(i,h),r(h,v)},p:Le,d(_){_&&u(e)}}}function Ai(l){let e,t=l[12].logistic_comments!="<br>"&&Di(l);return{c(){t&&t.c(),e=xe()},l(n){t&&t.l(n),e=xe()},m(n,i){t&&t.m(n,i),W(n,e,i)},p(n,i){n[12].logistic_comments!="<br>"&&t.p(n,i)},d(n){n&&u(e),t&&t.d(n)}}}function Di(l){let e,t,n,i,o,s="Comentarios logísticos",a,h,k=l[12].logistic_comments+"",v;return{c(){e=d("ion-item"),t=d("ion-icon"),n=T(),i=d("ion-label"),o=d("p"),o.textContent=s,a=T(),h=d("h2"),v=ye(k),this.h()},l(_){e=f(_,"ION-ITEM",{});var m=g(e);t=f(m,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(u),n=C(m),i=f(m,"ION-LABEL",{class:!0});var p=g(i);o=f(p,"P",{"data-svelte-h":!0}),le(o)!=="svelte-1iz85r6"&&(o.textContent=s),a=C(p),h=f(p,"H2",{});var E=g(h);v=we(E,k),E.forEach(u),p.forEach(u),m.forEach(u),this.h()},h(){b(t,"icon",yn),b(t,"slot","start"),b(i,"class","ion-text-wrap")},m(_,m){W(_,e,m),r(e,t),r(e,n),r(e,i),r(i,o),r(i,a),r(i,h),r(h,v)},p:Le,d(_){_&&u(e)}}}function xi(l){let e,t,n,i,o="<p>Etiqueta</p>",s,a,h=(l[12].tag?l[12].tag:"")+"",k;return{c(){e=d("ion-item"),t=d("ion-icon"),n=T(),i=d("ion-label"),i.innerHTML=o,s=T(),a=d("div"),k=ye(h),this.h()},l(v){e=f(v,"ION-ITEM",{});var _=g(e);t=f(_,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(u),n=C(_),i=f(_,"ION-LABEL",{class:!0,"data-svelte-h":!0}),le(i)!=="svelte-50rr6d"&&(i.innerHTML=o),s=C(_),a=f(_,"DIV",{class:!0,style:!0});var m=g(a);k=we(m,h),m.forEach(u),_.forEach(u),this.h()},h(){b(t,"icon",Rn),b(t,"slot","start"),b(i,"class","ion-text-wrap"),V(a,"class","stop-tag"),c(a,"background-color",l[21]),c(a,"border","1px solid "+l[22]),c(a,"color",l[12].tag_color),c(a,"font-size","14px"),c(a,"text-align","center"),c(a,"align-content","center"),c(a,"border-radius","20px"),c(a,"white-space","normal"),c(a,"padding","4px 8px"),c(a,"width","auto",1),c(a,"display","inline-block")},m(v,_){W(v,e,_),r(e,t),r(e,n),r(e,i),r(e,s),r(e,a),r(a,k)},p:Le,d(v){v&&u(e)}}}function Bi(l){let e,t,n,i,o="<p>Estado de entrega</p>",s,a,h,k="Entregado",v,_,m="No Entregado",p,E,y="Entrega Parcial",w,P,B,A,U,F="<p>Notas</p>",q,N,H,S,O,M,R=l[12].status!=="completed"&&l[18]==="1"&&!l[15]&&Ui(l),x=!l[15]&&Hi(l);return{c(){e=d("ion-item"),t=d("ion-icon"),n=T(),i=d("ion-label"),i.innerHTML=o,s=T(),a=d("ion-select"),h=d("ion-select-option"),h.textContent=k,v=T(),_=d("ion-select-option"),_.textContent=m,p=T(),E=d("ion-select-option"),E.textContent=y,w=T(),P=d("ion-item"),B=d("ion-icon"),A=T(),U=d("ion-label"),U.innerHTML=F,q=T(),N=d("ion-textarea"),H=T(),R&&R.c(),S=T(),x&&x.c(),O=xe(),this.h()},l(j){e=f(j,"ION-ITEM",{});var Y=g(e);t=f(Y,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(u),n=C(Y),i=f(Y,"ION-LABEL",{class:!0,"data-svelte-h":!0}),le(i)!=="svelte-1ql9csq"&&(i.innerHTML=o),s=C(Y),a=f(Y,"ION-SELECT",{value:!0,disabled:!0});var ie=g(a);h=f(ie,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),le(h)!=="svelte-1nhq8vd"&&(h.textContent=k),v=C(ie),_=f(ie,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),le(_)!=="svelte-dhd4r3"&&(_.textContent=m),p=C(ie),E=f(ie,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),le(E)!=="svelte-17taxwo"&&(E.textContent=y),ie.forEach(u),Y.forEach(u),w=C(j),P=f(j,"ION-ITEM",{});var be=g(P);B=f(be,"ION-ICON",{icon:!0,slot:!0}),g(B).forEach(u),A=C(be),U=f(be,"ION-LABEL",{class:!0,"data-svelte-h":!0}),le(U)!=="svelte-c9yniu"&&(U.innerHTML=F),q=C(be),N=f(be,"ION-TEXTAREA",{placeholder:!0,readonly:!0,disabled:!0}),g(N).forEach(u),be.forEach(u),H=C(j),R&&R.l(j),S=C(j),x&&x.l(j),O=xe(),this.h()},h(){b(t,"icon",zn),b(t,"slot","start"),b(i,"class","ion-text-wrap"),b(h,"value","delivered"),b(_,"value","notdelivered"),b(E,"value","partialdeliver"),b(a,"value",l[16]?l[16]:"delivered"),b(a,"disabled",l[15]),b(B,"icon",pt),b(B,"slot","start"),b(U,"class","ion-text-wrap"),b(N,"placeholder","Escribe aquí..."),b(N,"readonly",l[15]),b(N,"disabled",l[15])},m(j,Y){W(j,e,Y),r(e,t),r(e,n),r(e,i),r(e,s),r(e,a),r(a,h),r(a,v),r(a,_),r(a,p),r(a,E),l[36](a),W(j,w,Y),W(j,P,Y),r(P,B),r(P,A),r(P,U),r(P,q),r(P,N),l[37](N),W(j,H,Y),R&&R.m(j,Y),W(j,S,Y),x&&x.m(j,Y),W(j,O,Y),M=!0},p(j,Y){j[12].status!=="completed"&&j[18]==="1"&&!j[15]&&R.p(j,Y),j[15]||x.p(j,Y)},i(j){M||(et(R),M=!0)},o(j){lt(R),M=!1},d(j){j&&(u(e),u(w),u(P),u(H),u(S),u(O)),l[36](null),l[37](null),R&&R.d(j),x&&x.d(j)}}}function Ui(l){let e,t,n="<p>Firma de entregado</p>",i,o,s,a,h,k,v,_,m,p,E,y,w,P,B,A,U,F,q={};return a=new ki({props:q}),l[38](a),{c(){e=d("section"),t=d("ion-label"),t.innerHTML=n,i=T(),o=d("br"),s=T(),kn(a.$$.fragment),h=T(),k=d("section"),v=d("ion-button"),_=d("ion-icon"),m=ye(`\r
                        Borrar`),E=T(),y=d("ion-button"),w=d("ion-icon"),P=ye(`\r
                        Guardar`),this.h()},l(N){e=f(N,"SECTION",{style:!0});var H=g(e);t=f(H,"ION-LABEL",{class:!0,style:!0,"data-svelte-h":!0}),le(t)!=="svelte-1lie3gz"&&(t.innerHTML=n),i=C(H),o=f(H,"BR",{}),s=C(H),En(a.$$.fragment,H),H.forEach(u),h=C(N),k=f(N,"SECTION",{style:!0});var S=g(k);v=f(S,"ION-BUTTON",{style:!0,fill:!0,disabled:!0});var O=g(v);_=f(O,"ION-ICON",{icon:!0,slot:!0}),g(_).forEach(u),m=we(O,`\r
                        Borrar`),O.forEach(u),E=C(S),y=f(S,"ION-BUTTON",{style:!0,disabled:!0});var M=g(y);w=f(M,"ION-ICON",{icon:!0,slot:!0}),g(w).forEach(u),P=we(M,`\r
                        Guardar`),M.forEach(u),S.forEach(u),this.h()},h(){b(t,"class","ion-text-wrap"),c(t,"padding","10px 0px"),c(e,"display","flex"),c(e,"flex-direction","column"),c(e,"align-items","center"),c(e,"padding","0px 16px 16px"),b(_,"icon",bt),b(_,"slot","start"),c(v,"flex","1"),b(v,"fill","outline"),b(v,"disabled",p=l[11]||l[12].status=="completed"),b(w,"icon",Vn),b(w,"slot","start"),c(y,"flex","1"),b(y,"disabled",B=l[11]||l[12].status=="completed"),c(k,"display","flex"),c(k,"gap","8px"),c(k,"padding","0px 16px")},m(N,H){W(N,e,H),r(e,t),r(e,i),r(e,o),r(e,s),In(a,e,null),W(N,h,H),W(N,k,H),r(k,v),r(v,_),r(v,m),r(k,E),r(k,y),r(y,w),r(y,P),A=!0,U||(F=[de(v,"click",l[34]),de(y,"click",l[33])],U=!0)},p(N,H){const S={};a.$set(S),(!A||H[0]&2048&&p!==(p=N[11]||N[12].status=="completed"))&&b(v,"disabled",p),(!A||H[0]&2048&&B!==(B=N[11]||N[12].status=="completed"))&&b(y,"disabled",B)},i(N){A||(et(a.$$.fragment,N),A=!0)},o(N){lt(a.$$.fragment,N),A=!1},d(N){N&&(u(e),u(h),u(k)),l[38](null),On(a),U=!1,ze(F)}}}function Hi(l){let e,t,n=l[5]===!0&&Ht(l),i=(l[6]===!0||l[6]===!1&&l[5]===!1)&&Rt(l);return{c(){e=d("section"),n&&n.c(),t=T(),i&&i.c(),this.h()},l(o){e=f(o,"SECTION",{style:!0});var s=g(e);n&&n.l(s),t=C(s),i&&i.l(s),s.forEach(u),this.h()},h(){c(e,"display","flex"),c(e,"gap","8px"),c(e,"padding","16px 16px 6px")},m(o,s){W(o,e,s),n&&n.m(e,null),r(e,t),i&&i.m(e,null)},p(o,s){o[5]===!0?n?n.p(o,s):(n=Ht(o),n.c(),n.m(e,t)):n&&(n.d(1),n=null),o[6]===!0||o[6]===!1&&o[5]===!1?i?i.p(o,s):(i=Rt(o),i.c(),i.m(e,null)):i&&(i.d(1),i=null)},d(o){o&&u(e),n&&n.d(),i&&i.d()}}}function Ht(l){let e,t=`<ion-icon icon="${qn}" slot="start"></ion-icon>
                        Ingreso`,n,i;return{c(){e=d("ion-button"),e.innerHTML=t,this.h()},l(o){e=f(o,"ION-BUTTON",{id:!0,style:!0,"data-svelte-h":!0}),le(e)!=="svelte-izs0s1"&&(e.innerHTML=t),this.h()},h(){b(e,"id","checkInBtn"),c(e,"flex","1")},m(o,s){W(o,e,s),n||(i=de(e,"click",l[28]),n=!0)},p:Le,d(o){o&&u(e),n=!1,i()}}}function Rt(l){let e,t,n,i,o,s;return{c(){e=d("ion-button"),t=d("ion-icon"),n=ye(`\r
                        Salida`),this.h()},l(a){e=f(a,"ION-BUTTON",{id:!0,style:!0,disabled:!0});var h=g(e);t=f(h,"ION-ICON",{icon:!0,slot:!0}),g(t).forEach(u),n=we(h,`\r
                        Salida`),h.forEach(u),this.h()},h(){b(t,"icon",Fn),b(t,"slot","start"),b(e,"id","checkOutBtn"),c(e,"flex","1"),b(e,"disabled",i=l[6]===!1)},m(a,h){W(a,e,h),r(e,t),r(e,n),o||(s=de(e,"click",l[29]),o=!0)},p(a,h){h[0]&64&&i!==(i=a[6]===!1)&&b(e,"disabled",i)},d(a){a&&u(e),o=!1,s()}}}function Ri(l){let e,t,n,i,o,s,a,h;return{c(){e=d("section"),t=d("ion-button"),n=d("label"),i=d("ion-icon"),o=ye(`\r
                        Subir Evidencia\r
                        `),s=d("input"),this.h()},l(k){e=f(k,"SECTION",{style:!0});var v=g(e);t=f(v,"ION-BUTTON",{fill:!0,class:!0,style:!0,disabled:!0});var _=g(t);n=f(_,"LABEL",{for:!0,style:!0});var m=g(n);i=f(m,"ION-ICON",{icon:!0,slot:!0,style:!0}),g(i).forEach(u),o=we(m,`\r
                        Subir Evidencia\r
                        `),s=f(m,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0,capture:!0}),m.forEach(u),_.forEach(u),v.forEach(u),this.h()},h(){b(i,"icon",Ct),b(i,"slot","start"),c(i,"vertical-align","middle"),c(s,"display","none"),V(s,"id","eventEvidence"),V(s,"name","fileToUpload"),V(s,"type","file"),s.multiple=!0,V(s,"accept","image/*"),V(s,"capture","environment"),s.disabled=l[23](),V(n,"for","eventEvidence"),c(n,"width","100%"),c(n,"height","100%"),c(n,"pointer-events",l[23]()?"none":"auto"),b(t,"fill","outline"),b(t,"class","loadEvidence"),c(t,"flex","1"),c(t,"display","flex"),c(t,"align-items","center"),c(t,"gap","8px"),b(t,"disabled",l[23]()),c(e,"display","flex"),c(e,"gap","8px"),c(e,"padding","0px 16px")},m(k,v){W(k,e,v),r(e,t),r(t,n),r(n,i),r(n,o),r(n,s),a||(h=[de(s,"change",l[24]),de(s,"click",l[25])],a=!0)},p:Le,d(k){k&&u(e),a=!1,ze(h)}}}function zt(l){let e,t,n=Fe(l[3]),i=[];for(let o=0;o<n.length;o+=1)i[o]=Vt(Ut(l,n,o));return{c(){e=d("section"),t=d("div");for(let o=0;o<i.length;o+=1)i[o].c();this.h()},l(o){e=f(o,"SECTION",{});var s=g(e);t=f(s,"DIV",{class:!0,style:!0});var a=g(t);for(let h=0;h<i.length;h+=1)i[h].l(a);a.forEach(u),s.forEach(u),this.h()},h(){V(t,"class","image-grid"),c(t,"display","grid"),c(t,"grid-template-columns","repeat(auto-fill, minmax(100px, 1fr))"),c(t,"gap","10px"),c(t,"padding","0px 10px")},m(o,s){W(o,e,s),r(e,t);for(let a=0;a<i.length;a+=1)i[a]&&i[a].m(t,null)},p(o,s){if(s[0]&1073778696|s[1]&2){n=Fe(o[3]);let a;for(a=0;a<n.length;a+=1){const h=Ut(o,n,a);i[a]?i[a].p(h,s):(i[a]=Vt(h),i[a].c(),i[a].m(t,null))}for(;a<i.length;a+=1)i[a].d(1);i.length=n.length}},d(o){o&&u(e),gt(i,o)}}}function zi(l){let e,t=`<ion-icon icon="${bt}"></ion-icon>`,n,i;function o(){return l[40](l[62])}return{c(){e=d("button"),e.innerHTML=t,this.h()},l(s){e=f(s,"BUTTON",{class:!0,style:!0,"data-svelte-h":!0}),le(e)!=="svelte-mf38w5"&&(e.innerHTML=t),this.h()},h(){V(e,"class","remove-button"),c(e,"position","absolute"),c(e,"top","5px"),c(e,"right","5px"),c(e,"border","none"),c(e,"cursor","pointer"),c(e,"font-size","18px"),c(e,"background","white"),c(e,"border-radius","50%"),c(e,"padding","3px 4px 0px"),c(e,"box-shadow","2px 2px 6px rgba(0, 0, 0, 0.3)"),c(e,"color","#0000008f")},m(s,a){W(s,e,a),n||(i=de(e,"click",o),n=!0)},p(s,a){l=s},d(s){s&&u(e),n=!1,i()}}}function Vt(l){let e,t,n,i,o,s,a;function h(){return l[39](l[60])}let k=l[12].status!=="completed"&&!l[15]&&zi(l);return{c(){e=d("div"),t=d("ion-img"),i=T(),k&&k.c(),o=T(),this.h()},l(v){e=f(v,"DIV",{class:!0,style:!0});var _=g(e);t=f(_,"ION-IMG",{src:!0,alt:!0,style:!0}),g(t).forEach(u),i=C(_),k&&k.l(_),o=C(_),_.forEach(u),this.h()},h(){Ge(t.src,n=l[60])||b(t,"src",n),b(t,"alt","Evidencia fotográfica"),c(t,"width","100%"),c(t,"height","100px"),c(t,"object-fit","cover"),c(t,"cursor","pointer"),c(t,"border","1px solid #ccc"),c(t,"border-radius","4px"),c(t,"margin-top","16px"),V(e,"class","image-container"),c(e,"position","relative")},m(v,_){W(v,e,_),r(e,t),r(e,i),k&&k.m(e,null),r(e,o),s||(a=de(t,"click",h),s=!0)},p(v,_){l=v,_[0]&8&&!Ge(t.src,n=l[60])&&b(t,"src",n),l[12].status!=="completed"&&!l[15]&&k.p(l,_)},d(v){v&&u(e),k&&k.d(),s=!1,a()}}}function Ft(l){let e,t='<ion-spinner name="dots" style="color:white;"></ion-spinner>';return{c(){e=d("div"),e.innerHTML=t,this.h()},l(n){e=f(n,"DIV",{class:!0,style:!0,"data-svelte-h":!0}),le(e)!=="svelte-1aosxw0"&&(e.innerHTML=t),this.h()},h(){V(e,"class","overlay"),c(e,"position","fixed"),c(e,"top","0"),c(e,"left","0"),c(e,"width","100vw"),c(e,"height","100vh"),c(e,"background","rgba(0, 0, 0, 0.5)"),c(e,"display","flex"),c(e,"align-items","center"),c(e,"justify-content","center"),c(e,"z-index","9999")},m(n,i){W(n,e,i)},d(n){n&&u(e)}}}function Wt(l){let e,t,n,i,o,s,a=`<ion-icon icon="${Mt}"></ion-icon>`,h,k;return{c(){e=d("div"),t=d("div"),n=d("ion-img"),o=T(),s=d("button"),s.innerHTML=a,this.h()},l(v){e=f(v,"DIV",{class:!0,style:!0});var _=g(e);t=f(_,"DIV",{class:!0,style:!0});var m=g(t);n=f(m,"ION-IMG",{src:!0,alt:!0,style:!0}),g(n).forEach(u),o=C(m),s=f(m,"BUTTON",{class:!0,style:!0,"data-svelte-h":!0}),le(s)!=="svelte-183t4ti"&&(s.innerHTML=a),m.forEach(u),_.forEach(u),this.h()},h(){Ge(n.src,i=l[8])||b(n,"src",i),b(n,"alt","Evidencia fotográfica"),c(n,"width","100%"),c(n,"height","auto"),V(s,"class","close-button"),c(s,"position","absolute"),c(s,"top","5px"),c(s,"right","5px"),c(s,"background","white"),c(s,"color","#444444d1"),c(s,"border","none"),c(s,"cursor","pointer"),c(s,"padding","2px 2px 0px 6px"),c(s,"border-radius","50%"),c(s,"font-size","20px"),V(t,"class","modal-content"),c(t,"position","relative"),c(t,"background","white"),c(t,"padding","20px"),c(t,"border-radius","8px"),c(t,"max-width","90vw"),c(t,"max-height","90vh"),c(t,"overflow","auto"),V(e,"class","modal-overlay"),c(e,"position","fixed"),c(e,"top","0"),c(e,"left","0"),c(e,"width","100vw"),c(e,"height","100vh"),c(e,"background","rgba(0, 0, 0, 0.8)"),c(e,"display","flex"),c(e,"justify-content","center"),c(e,"align-items","center"),c(e,"z-index","1000")},m(v,_){W(v,e,_),r(e,t),r(t,n),r(t,o),r(t,s),h||(k=[de(s,"click",l[31]),de(t,"click",Nt(l[35])),de(e,"click",l[31])],h=!0)},p(v,_){_[0]&256&&!Ge(n.src,i=v[8])&&b(n,"src",i)},d(v){v&&u(e),h=!1,ze(k)}}}function Vi(l){let e,t,n,i,o="Cerrar",s,a,h=l[12].title+"",k,v,_,m,p,E,y=l[12].client_phone&&l[12].client_phone.trim().length,w,P,B,A,U=l[12].schedule&&l[12].schedule.trim().length,F,q,N=l[12].logistic_comments&&l[12].logistic_comments.trim().length,H,S,O,M,R,x,j,Y,ie,be,Q=(!l[13]&&!l[14]||l[13]&&l[14])&&Ei(l);function L(K,Ee){return K[12].client_name!=null?Oi:Ii}let he=L(l)(l),se=y&&yi(l);function oe(K,Ee){if(K[12].line1&&K[12].line1.trim().length)return Ni;if(K[12].line2&&K[12].line2.trim().length)return wi}let ne=oe(l),fe=ne&&ne(l),ue=l[19]&&Ci(l),ae=l[20]&&l[20]!=="<br>"&&Mi(l),te=U&&Si(l),ke=l[12].driver_comments&&Pi(l),me=N&&Ai(l),Oe=l[12].tag&&l[12].tag_color&&xi(l),$=!l[14]&&Bi(l),ee=(l[13]&&l[14]||!l[13]&&!l[14])&&Ri(l),G=l[2]&&zt(l),ce=l[4]&&Ft(),Ie=l[7]&&Wt(l);return{c(){e=d("ion-header"),t=d("ion-toolbar"),n=d("ion-buttons"),i=d("ion-button"),i.textContent=o,s=T(),a=d("ion-title"),k=ye(h),v=T(),Q&&Q.c(),_=T(),m=d("ion-content"),p=d("ion-list"),he.c(),E=T(),se&&se.c(),w=T(),fe&&fe.c(),P=T(),ue&&ue.c(),B=T(),ae&&ae.c(),A=T(),te&&te.c(),F=T(),ke&&ke.c(),q=T(),me&&me.c(),H=T(),Oe&&Oe.c(),S=T(),$&&$.c(),O=T(),ee&&ee.c(),M=T(),G&&G.c(),R=T(),ce&&ce.c(),x=T(),Ie&&Ie.c(),j=xe(),this.h()},l(K){e=f(K,"ION-HEADER",{translucent:!0});var Ee=g(e);t=f(Ee,"ION-TOOLBAR",{});var Se=g(t);n=f(Se,"ION-BUTTONS",{slot:!0});var Me=g(n);i=f(Me,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),le(i)!=="svelte-2ks32x"&&(i.textContent=o),Me.forEach(u),s=C(Se),a=f(Se,"ION-TITLE",{style:!0,title:!0});var Ce=g(a);k=we(Ce,h),Ce.forEach(u),v=C(Se),Q&&Q.l(Se),Se.forEach(u),Ee.forEach(u),_=C(K),m=f(K,"ION-CONTENT",{fullscreen:!0});var J=g(m);p=f(J,"ION-LIST",{});var Z=g(p);he.l(Z),E=C(Z),se&&se.l(Z),w=C(Z),fe&&fe.l(Z),P=C(Z),ue&&ue.l(Z),B=C(Z),ae&&ae.l(Z),A=C(Z),te&&te.l(Z),F=C(Z),ke&&ke.l(Z),q=C(Z),me&&me.l(Z),H=C(Z),Oe&&Oe.l(Z),S=C(Z),$&&$.l(Z),O=C(Z),ee&&ee.l(Z),M=C(Z),G&&G.l(Z),Z.forEach(u),J.forEach(u),R=C(K),ce&&ce.l(K),x=C(K),Ie&&Ie.l(K),j=xe(),this.h()},h(){b(i,"color","medium"),b(n,"slot","start"),c(a,"text-align","center"),b(a,"title",l[12].title),b(e,"translucent",""),b(m,"fullscreen","")},m(K,Ee){W(K,e,Ee),r(e,t),r(t,n),r(n,i),r(t,s),r(t,a),r(a,k),r(t,v),Q&&Q.m(t,null),W(K,_,Ee),W(K,m,Ee),r(m,p),he.m(p,null),r(p,E),se&&se.m(p,null),r(p,w),fe&&fe.m(p,null),r(p,P),ue&&ue.m(p,null),r(p,B),ae&&ae.m(p,null),r(p,A),te&&te.m(p,null),r(p,F),ke&&ke.m(p,null),r(p,q),me&&me.m(p,null),r(p,H),Oe&&Oe.m(p,null),r(p,S),$&&$.m(p,null),r(p,O),ee&&ee.m(p,null),r(p,M),G&&G.m(p,null),W(K,R,Ee),ce&&ce.m(K,Ee),W(K,x,Ee),Ie&&Ie.m(K,Ee),W(K,j,Ee),Y=!0,ie||(be=de(i,"click",l[0]),ie=!0)},p(K,Ee){(!K[13]&&!K[14]||K[13]&&K[14])&&Q.p(K,Ee),he.p(K,Ee),y&&se.p(K,Ee),fe&&fe.p(K,Ee),K[19]&&ue.p(K,Ee),K[20]&&K[20]!=="<br>"&&ae.p(K,Ee),U&&te.p(K,Ee),K[12].driver_comments&&ke.p(K,Ee),N&&me.p(K,Ee),K[12].tag&&K[12].tag_color&&Oe.p(K,Ee),K[14]||$.p(K,Ee),(K[13]&&K[14]||!K[13]&&!K[14])&&ee.p(K,Ee),K[2]?G?G.p(K,Ee):(G=zt(K),G.c(),G.m(p,null)):G&&(G.d(1),G=null),K[4]?ce||(ce=Ft(),ce.c(),ce.m(x.parentNode,x)):ce&&(ce.d(1),ce=null),K[7]?Ie?Ie.p(K,Ee):(Ie=Wt(K),Ie.c(),Ie.m(j.parentNode,j)):Ie&&(Ie.d(1),Ie=null)},i(K){Y||(et($),Y=!0)},o(K){lt($),Y=!1},d(K){K&&(u(e),u(_),u(m),u(R),u(x),u(j)),Q&&Q.d(),he.d(),se&&se.d(),fe&&fe.d(),ue&&ue.d(),ae&&ae.d(),te&&te.d(),ke&&ke.d(),me&&me.d(),Oe&&Oe.d(),$&&$.d(),ee&&ee.d(),G&&G.d(),ce&&ce.d(K),Ie&&Ie.d(K),ie=!1,be()}}}function Fi(l){const[e,t]=l.split(","),n=e.match(/:(.*?);/)[1],i=atob(t),o=i.length,s=new Uint8Array(o);for(let a=0;a<o;a++)s[a]=i.charCodeAt(a);return new Blob([s],{type:n})}function Wi(l,e,t){let n=dt,i=document.querySelector("ion-modal"),o=i.componentProps.delivery,s=i.componentProps.isLast||!1,a=i.componentProps.flag||!1,h=!!i.componentProps.readOnly,k=o.driver_comments?o.driver_comments:"",v=o.deliver_status?o.deliver_status:"",_=o.img?o.img:"",m=o.img_id?o.img_id:"",p=_?Ye(_):new Array,E=m?Ye(m):new Array,y={latitude:null,longitude:null},w=o.stopsApproval,P=o.smsActive,B=o.signatureActive,A=!1,U=!0,F=!1,q=o.phone_notification,N=o.comments_ext,H=!1,S="",O=new Object,M="",R=o.tag_color?qe(o.tag_color,.2):"",x=o.tag_color?qe(o.tag_color,.3):"",j,Y=!1;const ie=()=>h||o.status=="completed";tt(()=>{O=JSON.parse(localStorage.getItem("userSession")),be()});function be(){o.date_service?o.date_service&&!o.date_completed&&!o.service_time?(t(5,U=!1),t(6,F=!0)):o.date_service&&o.date_completed&&o.service_time&&(t(5,U=!1),t(6,F=!1)):(t(5,U=!0),t(6,F=!1))}const Q=async(I,D)=>{await(await Xe.create({header:I||"Error",message:D||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()},L=async(I="",D="",z="",X=function(Ne={}){},pe={})=>{await(await Xe.create({header:I||"Error",message:D||"Vuelva a intentar",buttons:[{text:"No",role:"cancel",handler:()=>{}},{text:"Sí",handler:()=>{t(4,A=!0),je(z,function(ve={}){t(4,A=!1),X(ve)},pe)}}]})).present()};async function re(I,D){await(await Xe.create({header:"¿Cómo quieres notificar?",message:`Elige el medio para enviar mensaje a ${I.title} (${D})`,buttons:[{text:"SMS",handler:()=>ke("sms",I,D)},{text:"WhatsApp",handler:()=>ke("whatsapp",I,D)}]})).present()}const he=async I=>{if(h){Q("Solo lectura","Completa los requisitos para editar.");return}if(p.length>=5){Q("Límite de evidencias","Solo se permite subir 5 fotos por parada");return}if(a&&s&&p.length>=1){Q("Límite de evidencias","Para el final de la ruta solo se permite subir 1 foto");return}const z=I.target.files[0];if(z)try{t(4,A=!0);const X=await ne(z);X&&je(`${n}api/admin/manager/upload_img_driver.php`,function(pe){pe.success?(t(2,_=_?`${_},${pe.img}`:pe.img),m=m?`${m},${pe.img_id}`:pe.img_id,t(3,p=Ye(_)),E=Ye(m)):Q("Carga fallida","Actualiza la página y vuelve a intentar. Si el problema persiste, contacta a soporte.")},{fileToUpload:X})}catch(X){console.error("Compression error:",X)}finally{t(4,A=!1)}};function se(I){var z;if(h){(z=I==null?void 0:I.preventDefault)==null||z.call(I),Q("Solo lectura","Completa los requisitos para editar.");return}var D=o.service_time;!D&&U&&!s&&!a&&(I.preventDefault(),Q("Registrar Ingreso","Antes de subir la evidencia registra el ingreso a la actual parada."))}function oe(){if(h){Q("Solo lectura","Completa los requisitos para editar.");return}var I=a?o.date_completed:!1;if(!I&&!U&&F&&!s&&!a){var D=new Object;D.id_event=o.id_event,D.type="checkout",D.id_user_over=O.id_user,D.token=O.token,L("Registrar Salida","¿Completaste tu entrega?",n+"api/admin/route/record_check_date.php",function(z){z.minutes&&Q("Tiempo por parada","Completaste la parada en "+z.minutes+" minutos.")},D)}}const ne=async I=>new Promise(D=>{const z=new Image;z.src=URL.createObjectURL(I),z.onload=()=>{const X=document.createElement("canvas"),pe=X.getContext("2d"),Ne=800,ve=600;let Pe=z.width,Be=z.height;Pe>Ne&&(Be*=Ne/Pe,Pe=Ne),Be>ve&&(Pe*=ve/Be,Be=ve),X.width=Pe,X.height=Be,pe.drawImage(z,0,0,Pe,Be),X.toBlob(Ve=>{D(Ve),URL.revokeObjectURL(z.src),pe.clearRect(0,0,X.width,X.height)},"image/jpeg",.7)}});async function fe(){try{if(i!=null&&i.isConnected){await i.dismiss({data:Date.now()});return}const I=await nt.getTop();I&&await I.dismiss({data:Date.now()})}catch{console.warn("Close Modal Safe: modal ya cerrado o inexistente")}}const ue=async()=>{if(h){Q("Solo lectura","Completa los requisitos para confirmar.");return}if(!A){t(4,A=!0);try{if(t(2,_=p.join(",")),m=E.join(","),oe(),await te())if(M.value=="delivered"||M.value!=="delivered"&&(k.value||o.driver_comments)||a&&s){const D={id_route:o.id_route,...!a&&!s&&{id_event:o.id_event},...!a&&!s&&{comments:k.value},...!a&&!s&&{deliver_status:M.value},img:_,img_id:m,lat:y.latitude,lon:y.longitude,...w==="0"&&{approve:"0"},...s&&{isLast:!0},...a&&s&&{destiny:!0},id_user_over:O.id_user,token:O.token};D.img&&D.img_id||_?je(`${n}api/admin/evidence/send_evidence.php`,function(z){if(z.success==!0){fe();const X=D.id_route;s&&(ae("","",X,s),w=="0"&&K(X,"completed"))}else t(4,A=!1),Q("Carga fallida","Actualiza la página y vuelve a intentar cargar la información!")},D):Q("Información incompleta","Cargar evidencia fotográfica faltante para completar parada.")}else Q("Motivo de status de entrega","Favor de ingresar en notas el motivo por el que la entrega no fue entregada correctamente");else Q("Ubicación faltante","Asegúrate darle permisos a Rutaflow para acceder a tu ubicación")}catch(I){console.error("Error fetching data:",I)}finally{t(4,A=!1)}}},ae=(I,D,z,X)=>{i.componentProps.routeId=z,i.componentProps.driverId=o.id_driver,Je("modal-km-gas",Ln,{checklist:I,driverId:D,routeId:z,isLast:X}).then(pe=>{})},te=async()=>navigator.geolocation?new Promise((I,D)=>{navigator.geolocation.getCurrentPosition(z=>{y.latitude=z.coords.latitude,y.longitude=z.coords.longitude,I(!0)},z=>{console.error("Error getting location:",z),I(!1)})}):(console.error("Geolocation is not supported by your browser"),!1);async function ke(I,D,z){const X={};if(I==="sms"){X.id_user_over=O.id_user,X.token=O.token,X.client_phone=z,X.client_name=D.title,X.delivery_phone=D.client_phone,X.enterprise_name=D.enterprise_name,je(`${n}api/admin/message_central/send_sms.php`,me("SMS",D.title,z),X);return}try{var pe=D.client_phone?`
Si deseas contactarnos, entra al siguiente link: https://wa.me/${D.client_phone}.`:".";X.text=`*Rutaflow*

El repartidor va en camino a tu domicilio ${D.title}${pe}

Enviado por _${D.enterprise_name}_`,X.phone=z;const ve=await(await fetch(`${Zn}`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`${$n}`},body:JSON.stringify(X)})).json();me("WHATSAPP",D.title,z)(ve)}catch(Ne){console.error(Ne),Q("WHATSAPP no enviado","Ocurrió un error de red.")}}function me(I,D,z){return X=>{X.success?Q(`${I} enviado`,`Se envió correctamente un ${I} a ${D} con número ${z}.`):Q(`${I} no enviado`,`Hubo un error al enviar ${I} a ${D} (${z}).`)}}function Oe(I){I.stopPropagation(),re(o,q)}function $(){if(h){Q("Solo lectura","Completa los requisitos para editar.");return}t(5,U=!1),t(6,F=!0),G(o.id_event,"checkin")}function ee(){if(h){Q("Solo lectura","Completa los requisitos para editar.");return}t(6,F=!1),t(5,U=!1),G(o.id_event,"checkout")}async function G(I,D){if(!h&&D){let z=new Object;z.type=D,z.id_event=I,z.id_user_over=O.id_user,z.token=O.token;try{je(`${n}api/admin/route/record_check_date.php`,function(X){X.minutes&&Q("Tiempo por parada","Completaste la parada en "+X.minutes+" minutos.")},z)}catch(X){console.error("Error during file upload:",X)}finally{}}}const ce=I=>{t(8,S=I),t(7,H=!0)},Ie=()=>{t(7,H=!1),t(8,S="")};function K(I,D){let z=new Object;return z.id_route=I,z.status=D,z.id_user_over=O.id_user,z.token=O.token,je(`${n}api/admin/route/change_status.php`,function(){},z),""}function Ee(I=0){if(!h){var D=Nn(I,p,E,_);t(3,p=D.files),E=D.img_ids,t(2,_=D.selectedImages)}}async function Se(){if(h){Q("Solo lectura","No puedes guardar la firma ahora.");return}const I=await j.save();if(I){t(11,Y=!0);let D=Fi(I);je(`${n}api/admin/manager/upload_img_driver.php`,function(z){z.success?(t(2,_=_?`${_},${z.img}`:z.img),m=m?`${m},${z.img_id}`:z.img_id,t(3,p=Ye(_)),E=Ye(m)):Q("Carga fallida","Actualiza la página y vuelve a intentar. Si el problema persiste, contacta a soporte.")},{fileToUpload:D})}}function Me(){h||j.clear()}function Ce(I){Tt.call(this,l,I)}function J(I){Ue[I?"unshift":"push"](()=>{M=I,t(9,M)})}function Z(I){Ue[I?"unshift":"push"](()=>{k=I,t(1,k)})}function ge(I){Ue[I?"unshift":"push"](()=>{j=I,t(10,j)})}return[fe,k,_,p,A,U,F,H,S,M,j,Y,o,s,a,h,v,P,B,q,N,R,x,ie,he,se,ue,Oe,$,ee,ce,Ie,Ee,Se,Me,Ce,J,Z,ge,I=>ce(I),I=>Ee(I)]}class qt extends Ze{constructor(e){super(),$e(this,e,Wi,Vi,Qe,{closeModal:0},null,[-1,-1,-1])}get closeModal(){return this.$$.ctx[0]}}function jt(l,e,t){const n=l.slice();return n[32]=e[t],n[34]=t,n}function Gt(l){let e,t,n=Fe(l[1]),i=[];for(let o=0;o<n.length;o+=1)i[o]=Kt(jt(l,n,o));return{c(){e=d("section"),t=d("div");for(let o=0;o<i.length;o+=1)i[o].c();this.h()},l(o){e=f(o,"SECTION",{});var s=g(e);t=f(s,"DIV",{class:!0,style:!0});var a=g(t);for(let h=0;h<i.length;h+=1)i[h].l(a);a.forEach(u),s.forEach(u),this.h()},h(){V(t,"class","image-grid"),c(t,"display","grid"),c(t,"grid-template-columns","repeat(auto-fill, minmax(100px, 1fr))"),c(t,"gap","10px"),c(t,"padding","0px 10px")},m(o,s){W(o,e,s),r(e,t);for(let a=0;a<i.length;a+=1)i[a]&&i[a].m(t,null)},p(o,s){if(s[0]&32770){n=Fe(o[1]);let a;for(a=0;a<n.length;a+=1){const h=jt(o,n,a);i[a]?i[a].p(h,s):(i[a]=Kt(h),i[a].c(),i[a].m(t,null))}for(;a<i.length;a+=1)i[a].d(1);i.length=n.length}},d(o){o&&u(e),gt(i,o)}}}function Kt(l){let e,t,n,i,o,s=`<ion-icon icon="${bt}"></ion-icon>`,a,h,k;function v(){return l[22](l[32])}function _(){return l[23](l[34])}return{c(){e=d("div"),t=d("ion-img"),i=T(),o=d("button"),o.innerHTML=s,a=T(),this.h()},l(m){e=f(m,"DIV",{class:!0,style:!0});var p=g(e);t=f(p,"ION-IMG",{src:!0,alt:!0,style:!0}),g(t).forEach(u),i=C(p),o=f(p,"BUTTON",{class:!0,style:!0,"data-svelte-h":!0}),le(o)!=="svelte-zguiov"&&(o.innerHTML=s),a=C(p),p.forEach(u),this.h()},h(){Ge(t.src,n=l[32])||b(t,"src",n),b(t,"alt","Evidencia fotográfica"),c(t,"width","100%"),c(t,"height","100px"),c(t,"object-fit","cover"),c(t,"cursor","pointer"),c(t,"border","1px solid #ccc"),c(t,"border-radius","4px"),c(t,"margin-top","16px"),V(o,"class","remove-button"),c(o,"position","absolute"),c(o,"top","5px"),c(o,"right","5px"),c(o,"border","none"),c(o,"cursor","pointer"),c(o,"font-size","18px"),c(o,"background","white"),c(o,"border-radius","50%"),c(o,"padding","3px 4px 0px"),c(o,"box-shadow","2px 2px 6px rgba(0, 0, 0, 0.3)"),c(o,"color","#0000008f"),V(e,"class","image-container"),c(e,"position","relative")},m(m,p){W(m,e,p),r(e,t),r(e,i),r(e,o),r(e,a),h||(k=[de(t,"click",v),de(o,"click",_)],h=!0)},p(m,p){l=m,p[0]&2&&!Ge(t.src,n=l[32])&&b(t,"src",n)},d(m){m&&u(e),h=!1,ze(k)}}}function Xt(l){let e,t='<ion-spinner name="dots" style="color:white;"></ion-spinner>';return{c(){e=d("div"),e.innerHTML=t,this.h()},l(n){e=f(n,"DIV",{class:!0,style:!0,"data-svelte-h":!0}),le(e)!=="svelte-h8s7r2"&&(e.innerHTML=t),this.h()},h(){V(e,"class","overlay"),c(e,"position","fixed"),c(e,"top","0"),c(e,"left","0"),c(e,"width","100vw"),c(e,"height","100vh"),c(e,"background","rgba(0, 0, 0, 0.5)"),c(e,"display","flex"),c(e,"align-items","center"),c(e,"justify-content","center"),c(e,"z-index","9999")},m(n,i){W(n,e,i)},d(n){n&&u(e)}}}function Jt(l){let e,t,n,i,o,s,a=`<ion-icon icon="${Mt}"></ion-icon>`,h,k;return{c(){e=d("div"),t=d("div"),n=d("ion-img"),o=T(),s=d("button"),s.innerHTML=a,this.h()},l(v){e=f(v,"DIV",{class:!0,style:!0});var _=g(e);t=f(_,"DIV",{class:!0,style:!0});var m=g(t);n=f(m,"ION-IMG",{src:!0,alt:!0,style:!0}),g(n).forEach(u),o=C(m),s=f(m,"BUTTON",{class:!0,style:!0,"data-svelte-h":!0}),le(s)!=="svelte-g0qr0o"&&(s.innerHTML=a),m.forEach(u),_.forEach(u),this.h()},h(){Ge(n.src,i=l[8])||b(n,"src",i),b(n,"alt","Evidencia fotográfica"),c(n,"width","100%"),c(n,"height","auto"),V(s,"class","close-button"),c(s,"position","absolute"),c(s,"top","5px"),c(s,"right","5px"),c(s,"background","white"),c(s,"color","#444444d1"),c(s,"border","none"),c(s,"cursor","pointer"),c(s,"padding","2px 2px 0px 6px"),c(s,"border-radius","50%"),c(s,"font-size","20px"),V(t,"class","modal-content"),c(t,"position","relative"),c(t,"background","white"),c(t,"padding","20px"),c(t,"border-radius","8px"),c(t,"max-width","90vw"),c(t,"max-height","90vh"),c(t,"overflow","auto"),V(e,"class","modal-overlay"),c(e,"position","fixed"),c(e,"top","0"),c(e,"left","0"),c(e,"width","100vw"),c(e,"height","100vh"),c(e,"background","rgba(0, 0, 0, 0.8)"),c(e,"display","flex"),c(e,"justify-content","center"),c(e,"align-items","center"),c(e,"z-index","1000")},m(v,_){W(v,e,_),r(e,t),r(t,n),r(t,o),r(t,s),h||(k=[de(s,"click",l[16]),de(t,"click",Nt(l[17])),de(e,"click",l[16])],h=!0)},p(v,_){_[0]&256&&!Ge(n.src,i=v[8])&&b(n,"src",i)},d(v){v&&u(e),h=!1,ze(k)}}}function qi(l){let e,t,n,i,o="Cancelar",s,a,h="AGREGAR GASTO",k,v,_,m="Confirmar",p,E,y,w,P,B,A,U,F,q,N,H,S,O,M,R,x,j,Y='Tipo de pago <ion-text color="danger">(Obligatorio)</ion-text>',ie,be,Q="Efectivo",L,re,he="Tarjeta",se,oe,ne="Transferencia",fe,ue,ae,te,ke,me,Oe,$,ee,G,ce=`<ion-icon icon="${Ct}" slot="start"></ion-icon>
                        Subir Evidencia`,Ie,K,Ee,Se,Me,Ce,J,Z,ge=l[0]&&Gt(l),_e=l[6]&&Xt(),Te=l[7]&&Jt(l);return{c(){e=d("ion-header"),t=d("ion-toolbar"),n=d("ion-buttons"),i=d("ion-button"),i.textContent=o,s=T(),a=d("ion-title"),a.textContent=h,k=T(),v=d("ion-buttons"),_=d("ion-button"),_.textContent=m,p=T(),E=d("ion-content"),y=d("ion-list"),w=d("ion-item"),P=d("ion-icon"),B=T(),A=d("ion-input"),U=T(),F=d("ion-item"),q=d("ion-icon"),N=T(),H=d("ion-input"),S=T(),O=d("ion-item"),M=d("ion-icon"),R=T(),x=d("ion-select"),j=d("div"),j.innerHTML=Y,ie=T(),be=d("ion-select-option"),be.textContent=Q,L=T(),re=d("ion-select-option"),re.textContent=he,se=T(),oe=d("ion-select-option"),oe.textContent=ne,fe=T(),ue=d("ion-item"),ae=d("ion-icon"),te=T(),ke=d("ion-textarea"),me=T(),Oe=d("section"),$=d("label"),ee=d("ion-button"),G=d("label"),G.innerHTML=ce,Ie=T(),K=d("input"),Ee=T(),ge&&ge.c(),Se=T(),_e&&_e.c(),Me=T(),Te&&Te.c(),Ce=xe(),this.h()},l(I){e=f(I,"ION-HEADER",{translucent:!0});var D=g(e);t=f(D,"ION-TOOLBAR",{});var z=g(t);n=f(z,"ION-BUTTONS",{slot:!0});var X=g(n);i=f(X,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),le(i)!=="svelte-1f8rjcf"&&(i.textContent=o),X.forEach(u),s=C(z),a=f(z,"ION-TITLE",{title:!0,"data-svelte-h":!0}),le(a)!=="svelte-efps2s"&&(a.textContent=h),k=C(z),v=f(z,"ION-BUTTONS",{slot:!0});var pe=g(v);_=f(pe,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),le(_)!=="svelte-k5zoz0"&&(_.textContent=m),pe.forEach(u),z.forEach(u),D.forEach(u),p=C(I),E=f(I,"ION-CONTENT",{fullscreen:!0});var Ne=g(E);y=f(Ne,"ION-LIST",{});var ve=g(y);w=f(ve,"ION-ITEM",{});var Pe=g(w);P=f(Pe,"ION-ICON",{icon:!0,slot:!0}),g(P).forEach(u),B=C(Pe),A=f(Pe,"ION-INPUT",{label:!0,type:!0,placeholder:!0,value:!0}),g(A).forEach(u),Pe.forEach(u),U=C(ve),F=f(ve,"ION-ITEM",{});var Be=g(F);q=f(Be,"ION-ICON",{icon:!0,slot:!0}),g(q).forEach(u),N=C(Be),H=f(Be,"ION-INPUT",{label:!0,type:!0,value:!0}),g(H).forEach(u),Be.forEach(u),S=C(ve),O=f(ve,"ION-ITEM",{});var Ve=g(O);M=f(Ve,"ION-ICON",{icon:!0,slot:!0}),g(M).forEach(u),R=C(Ve),x=f(Ve,"ION-SELECT",{placeholder:!0,value:!0});var De=g(x);j=f(De,"DIV",{slot:!0,"data-svelte-h":!0}),le(j)!=="svelte-wl764p"&&(j.innerHTML=Y),ie=C(De),be=f(De,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),le(be)!=="svelte-i9crym"&&(be.textContent=Q),L=C(De),re=f(De,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),le(re)!=="svelte-fx0z11"&&(re.textContent=he),se=C(De),oe=f(De,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),le(oe)!=="svelte-1c24jf2"&&(oe.textContent=ne),De.forEach(u),Ve.forEach(u),fe=C(ve),ue=f(ve,"ION-ITEM",{});var We=g(ue);ae=f(We,"ION-ICON",{icon:!0,slot:!0}),g(ae).forEach(u),te=C(We),ke=f(We,"ION-TEXTAREA",{label:!0,placeholder:!0}),g(ke).forEach(u),We.forEach(u),me=C(ve),Oe=f(ve,"SECTION",{});var it=g(Oe);$=f(it,"LABEL",{for:!0,style:!0});var ft=g($);ee=f(ft,"ION-BUTTON",{fill:!0,size:!0,class:!0,expand:!0});var ht=g(ee);G=f(ht,"LABEL",{for:!0,style:!0,"data-svelte-h":!0}),le(G)!=="svelte-1m9yw22"&&(G.innerHTML=ce),Ie=C(ht),K=f(ht,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0,capture:!0}),ht.forEach(u),ft.forEach(u),it.forEach(u),Ee=C(ve),ge&&ge.l(ve),ve.forEach(u),Ne.forEach(u),Se=C(I),_e&&_e.l(I),Me=C(I),Te&&Te.l(I),Ce=xe(),this.h()},h(){b(i,"color","medium"),b(n,"slot","start"),b(a,"title",""),b(_,"strong",""),b(v,"slot","end"),b(e,"translucent",""),b(P,"icon",wn),b(P,"slot","start"),b(A,"label","Concepto"),b(A,"type","text"),b(A,"placeholder","Escribe aquí..."),b(A,"value",l[9]?l[9]:""),b(q,"icon",pt),b(q,"slot","start"),b(H,"label","Monto $"),b(H,"type","number"),b(H,"value",l[10]?l[10]:""),b(M,"icon",jn),b(M,"slot","start"),V(j,"slot","label"),b(be,"value","cash"),b(re,"value","card"),b(oe,"value","transfer"),b(x,"placeholder","Tipo de pago"),b(x,"value",l[11]?l[11]:""),b(ae,"icon",pt),b(ae,"slot","start"),b(ke,"label","Comentarios"),b(ke,"placeholder","Escribe aquí..."),V(G,"for","eventEvidence"),c(G,"width","100%"),c(G,"padding","8px"),c(K,"display","none"),V(K,"id","eventEvidence"),V(K,"name","fileToUpload"),V(K,"type","file"),V(K,"accept","image/*"),V(K,"capture","environment"),b(ee,"fill","outline"),b(ee,"size","small"),b(ee,"class","loadEvidence"),b(ee,"expand","block"),V($,"for","eventEvidence"),c($,"display","block"),c($,"width","100%"),b(E,"fullscreen","")},m(I,D){W(I,e,D),r(e,t),r(t,n),r(n,i),r(t,s),r(t,a),r(t,k),r(t,v),r(v,_),W(I,p,D),W(I,E,D),r(E,y),r(y,w),r(w,P),r(w,B),r(w,A),l[18](A),r(y,U),r(y,F),r(F,q),r(F,N),r(F,H),l[19](H),r(y,S),r(y,O),r(O,M),r(O,R),r(O,x),r(x,j),r(x,ie),r(x,be),r(x,L),r(x,re),r(x,se),r(x,oe),l[20](x),r(y,fe),r(y,ue),r(ue,ae),r(ue,te),r(ue,ke),l[21](ke),r(y,me),r(y,Oe),r(Oe,$),r($,ee),r(ee,G),r(ee,Ie),r(ee,K),r(y,Ee),ge&&ge.m(y,null),W(I,Se,D),_e&&_e.m(I,D),W(I,Me,D),Te&&Te.m(I,D),W(I,Ce,D),J||(Z=[de(i,"click",l[13]),de(_,"click",l[14]),de(K,"change",l[12])],J=!0)},p(I,D){I[0]?ge?ge.p(I,D):(ge=Gt(I),ge.c(),ge.m(y,null)):ge&&(ge.d(1),ge=null),I[6]?_e||(_e=Xt(),_e.c(),_e.m(Me.parentNode,Me)):_e&&(_e.d(1),_e=null),I[7]?Te?Te.p(I,D):(Te=Jt(I),Te.c(),Te.m(Ce.parentNode,Ce)):Te&&(Te.d(1),Te=null)},i:Le,o:Le,d(I){I&&(u(e),u(p),u(E),u(Se),u(Me),u(Ce)),l[18](null),l[19](null),l[20](null),l[21](null),ge&&ge.d(),_e&&_e.d(I),Te&&Te.d(I),J=!1,ze(Z)}}}function ji(l,e,t){let n=dt,i=document.querySelector("ion-modal"),o=i.componentProps.routeId,s=i.componentProps.ex_concept,a=i.componentProps.ex_amount,h=i.componentProps.ex_type,k=i.componentProps.id_expense,v="",_=new Array,m="",p="",E=0,y="",w="",P=!1,B=new Object,A=!1,U="";tt(()=>{B=JSON.parse(localStorage.getItem("userSession"))});const F=async(L,re)=>{await(await Xe.create({header:L||"Error",message:re||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()},q=async L=>{t(6,P=!0);const he=L.target.files[0],se=await N(he);if(se){var oe=new Object;oe.fileToUpload=se,oe.id_user_over=B.id_user,oe.token=B.token;try{je(`${n}api/admin/manager/upload_img_driver.php`,function(ne){ne.success?(t(0,v=ne.img),t(1,_=Ye(v)),m=ne.img_id):F("Error","No se pudo subir la imagen"),t(6,P=!1)},oe)}catch(ne){console.error("Error during file upload:",ne)}finally{t(6,P=!1)}}},N=async L=>new Promise(re=>{const he=new Image;he.src=URL.createObjectURL(L),he.onload=()=>{const se=document.createElement("canvas"),oe=se.getContext("2d"),ne=800,fe=600;let ue=he.width,ae=he.height;ue>ne&&(ae*=ne/ue,ue=ne),ae>fe&&(ue*=fe/ae,ae=fe),se.width=ue,se.height=ae,oe.drawImage(he,0,0,ue,ae),se.toBlob(te=>{re(te),URL.revokeObjectURL(he.src),oe.clearRect(0,0,se.width,se.height)},"image/jpeg",.7)}}),H=()=>{nt.dismiss()},S=()=>{var L=new Object;L.id_route=o,L.comments=y.value,L.type=p.value,L.img=v,L.img_id=m,L.amount=E.value,L.concept=w.value,L.status="done",L.id_expense=k||"null",L.id_user_over=B.id_user,L.token=B.token,!m||!v||!E.value||!w.value?F("Datos incompletos","Llena los datos requeridos para completar el registro"):je(`${n}api/admin/expenses/add_expense.php`,function(re){H()},L)},O=L=>{t(8,U=L),t(7,A=!0)},M=()=>{t(7,A=!1),t(8,U="")};function R(L){Tt.call(this,l,L)}function x(L){Ue[L?"unshift":"push"](()=>{w=L,t(5,w)})}function j(L){Ue[L?"unshift":"push"](()=>{E=L,t(3,E)})}function Y(L){Ue[L?"unshift":"push"](()=>{p=L,t(2,p)})}function ie(L){Ue[L?"unshift":"push"](()=>{y=L,t(4,y)})}return[v,_,p,E,y,w,P,A,U,s,a,h,q,H,S,O,M,R,x,j,Y,ie,L=>O(L),L=>removeFile(L)]}class It extends Ze{constructor(e){super(),$e(this,e,ji,qi,Qe,{},null,[-1,-1])}}function Yt(l,e,t){const n=l.slice();return n[32]=e[t],n[34]=t,n}function Qt(l,e,t){const n=l.slice();return n[35]=e[t],n}function Zt(l){let e,t,n,i,o,s,a=l[35].label+"",h,k,v,_;function m(){return l[18](l[35])}return{c(){e=d("div"),t=d("ion-button"),n=d("ion-icon"),o=T(),s=d("div"),h=ye(a),k=T(),this.h()},l(p){e=f(p,"DIV",{class:!0});var E=g(e);t=f(E,"ION-BUTTON",{color:!0,fill:!0,size:!0});var y=g(t);n=f(y,"ION-ICON",{slot:!0,icon:!0}),g(n).forEach(u),y.forEach(u),o=C(E),s=f(E,"DIV",{class:!0,style:!0});var w=g(s);h=we(w,a),w.forEach(u),k=C(E),E.forEach(u),this.h()},h(){b(n,"slot","icon-only"),b(n,"icon",l[35].icon),b(t,"color",i=l[6]===l[35].id?"primary":"medium"),b(t,"fill","clear"),b(t,"size","small"),V(s,"class","motive-caption"),c(s,"font-size","11px"),c(s,"margin-top","2px"),c(s,"text-align","center"),c(s,"line-height","1.1"),V(e,"class","motive-button")},m(p,E){W(p,e,E),r(e,t),r(t,n),r(e,o),r(e,s),r(s,h),r(e,k),v||(_=de(t,"click",m),v=!0)},p(p,E){l=p,E[0]&64&&i!==(i=l[6]===l[35].id?"primary":"medium")&&b(t,"color",i)},d(p){p&&u(e),v=!1,_()}}}function $t(l){let e;return{c(){e=d("div"),this.h()},l(t){e=f(t,"DIV",{id:!0,style:!0}),g(e).forEach(u),this.h()},h(){V(e,"id","motive-map"),c(e,"height","220px"),c(e,"margin","12px 16px"),c(e,"border-radius","8px")},m(t,n){W(t,e,n),l[19](e)},p:Le,d(t){t&&u(e),l[19](null)}}}function en(l){let e,t,n=Fe(l[1]),i=[];for(let o=0;o<n.length;o+=1)i[o]=tn(Yt(l,n,o));return{c(){e=d("section"),t=d("div");for(let o=0;o<i.length;o+=1)i[o].c();this.h()},l(o){e=f(o,"SECTION",{});var s=g(e);t=f(s,"DIV",{class:!0,style:!0});var a=g(t);for(let h=0;h<i.length;h+=1)i[h].l(a);a.forEach(u),s.forEach(u),this.h()},h(){V(t,"class","image-grid"),c(t,"display","grid"),c(t,"grid-template-columns","repeat(auto-fill, minmax(100px, 1fr))"),c(t,"gap","10px"),c(t,"padding","0px 10px")},m(o,s){W(o,e,s),r(e,t);for(let a=0;a<i.length;a+=1)i[a]&&i[a].m(t,null)},p(o,s){if(s[0]&73730){n=Fe(o[1]);let a;for(a=0;a<n.length;a+=1){const h=Yt(o,n,a);i[a]?i[a].p(h,s):(i[a]=tn(h),i[a].c(),i[a].m(t,null))}for(;a<i.length;a+=1)i[a].d(1);i.length=n.length}},d(o){o&&u(e),gt(i,o)}}}function tn(l){let e,t,n,i,o,s=`<ion-icon icon="${bt}"></ion-icon>`,a,h,k;function v(){return l[21](l[32])}function _(){return l[22](l[34])}return{c(){e=d("div"),t=d("ion-img"),i=T(),o=d("button"),o.innerHTML=s,a=T(),this.h()},l(m){e=f(m,"DIV",{class:!0,style:!0});var p=g(e);t=f(p,"ION-IMG",{src:!0,alt:!0,style:!0}),g(t).forEach(u),i=C(p),o=f(p,"BUTTON",{class:!0,style:!0,"data-svelte-h":!0}),le(o)!=="svelte-ulzohx"&&(o.innerHTML=s),a=C(p),p.forEach(u),this.h()},h(){Ge(t.src,n=l[32])||b(t,"src",n),b(t,"alt","Evidencia fotográfica"),c(t,"width","100%"),c(t,"height","100px"),c(t,"object-fit","cover"),c(t,"cursor","pointer"),c(t,"border","1px solid #ccc"),c(t,"border-radius","4px"),c(t,"margin-top","16px"),V(o,"class","remove-button"),c(o,"position","absolute"),c(o,"top","5px"),c(o,"right","5px"),c(o,"border","none"),c(o,"cursor","pointer"),c(o,"font-size","18px"),c(o,"background","white"),c(o,"border-radius","50%"),c(o,"padding","3px 4px 0px"),c(o,"box-shadow","2px 2px 6px rgba(0, 0, 0, 0.3)"),c(o,"color","#0000008f"),V(e,"class","image-container"),c(e,"position","relative")},m(m,p){W(m,e,p),r(e,t),r(e,i),r(e,o),r(e,a),h||(k=[de(t,"click",v),de(o,"click",_)],h=!0)},p(m,p){l=m,p[0]&2&&!Ge(t.src,n=l[32])&&b(t,"src",n)},d(m){m&&u(e),h=!1,ze(k)}}}function nn(l){let e,t,n,i,o,s,a=`<ion-icon icon="${Mt}"></ion-icon>`,h,k;return{c(){e=d("div"),t=d("div"),n=d("ion-img"),o=T(),s=d("button"),s.innerHTML=a,this.h()},l(v){e=f(v,"DIV",{class:!0,style:!0});var _=g(e);t=f(_,"DIV",{class:!0,style:!0});var m=g(t);n=f(m,"ION-IMG",{src:!0,alt:!0,style:!0}),g(n).forEach(u),o=C(m),s=f(m,"BUTTON",{class:!0,style:!0,"data-svelte-h":!0}),le(s)!=="svelte-1fdruw6"&&(s.innerHTML=a),m.forEach(u),_.forEach(u),this.h()},h(){Ge(n.src,i=l[5])||b(n,"src",i),b(n,"alt","Evidencia fotográfica"),c(n,"width","100%"),c(n,"height","auto"),V(s,"class","close-button"),c(s,"position","absolute"),c(s,"top","5px"),c(s,"right","5px"),c(s,"background","white"),c(s,"color","#444444d1"),c(s,"border","none"),c(s,"cursor","pointer"),c(s,"padding","2px 2px 0px 6px"),c(s,"border-radius","50%"),c(s,"font-size","20px"),V(t,"class","modal-content"),c(t,"position","relative"),c(t,"background","white"),c(t,"padding","20px"),c(t,"border-radius","8px"),c(t,"max-width","90vw"),c(t,"max-height","90vh"),c(t,"overflow","auto"),V(e,"class","modal-overlay"),c(e,"position","fixed"),c(e,"top","0"),c(e,"left","0"),c(e,"width","100vw"),c(e,"height","100vh"),c(e,"background","rgba(0, 0, 0, 0.8)"),c(e,"display","flex"),c(e,"justify-content","center"),c(e,"align-items","center"),c(e,"z-index","1000")},m(v,_){W(v,e,_),r(e,t),r(t,n),r(t,o),r(t,s),h||(k=[de(s,"click",l[14]),de(t,"click",Nt(l[17])),de(e,"click",l[14])],h=!0)},p(v,_){_[0]&32&&!Ge(n.src,i=v[5])&&b(n,"src",i)},d(v){v&&u(e),h=!1,ze(k)}}}function on(l){let e,t='<ion-spinner name="dots" style="color:white;"></ion-spinner>';return{c(){e=d("div"),e.innerHTML=t,this.h()},l(n){e=f(n,"DIV",{class:!0,style:!0,"data-svelte-h":!0}),le(e)!=="svelte-1mz0rrk"&&(e.innerHTML=t),this.h()},h(){V(e,"class","overlay"),c(e,"position","fixed"),c(e,"top","0"),c(e,"left","0"),c(e,"width","100vw"),c(e,"height","100vh"),c(e,"background","rgba(0, 0, 0, 0.5)"),c(e,"display","flex"),c(e,"align-items","center"),c(e,"justify-content","center"),c(e,"z-index","9999")},m(n,i){W(n,e,i)},d(n){n&&u(e)}}}function Gi(l){let e,t,n,i,o="Cancelar",s,a,h="AGREGAR INCIDENCIA",k,v,_,m="Confirmar",p,E,y,w,P,B,A,U,F,q,N,H,S,O,M,R,x=`<ion-icon icon="${Ct}" slot="start"></ion-icon>
            Subir Evidencia`,j,Y,ie,be,Q,L,re,he,se=Fe(l[9]),oe=[];for(let te=0;te<se.length;te+=1)oe[te]=Zt(Qt(l,se,te));let ne=l[7].lat&&$t(l),fe=l[0]&&en(l),ue=l[4]&&nn(l),ae=l[3]&&on();return{c(){e=d("ion-header"),t=d("ion-toolbar"),n=d("ion-buttons"),i=d("ion-button"),i.textContent=o,s=T(),a=d("ion-title"),a.textContent=h,k=T(),v=d("ion-buttons"),_=d("ion-button"),_.textContent=m,p=T(),E=d("ion-content"),y=d("ion-list"),w=d("ion-item"),P=d("div");for(let te=0;te<oe.length;te+=1)oe[te].c();B=T(),ne&&ne.c(),A=T(),U=d("ion-item"),F=d("ion-icon"),q=T(),N=d("ion-textarea"),H=T(),S=d("section"),O=d("label"),M=d("ion-button"),R=d("label"),R.innerHTML=x,j=T(),Y=d("input"),ie=T(),fe&&fe.c(),be=T(),ue&&ue.c(),Q=T(),ae&&ae.c(),L=xe(),this.h()},l(te){e=f(te,"ION-HEADER",{translucent:!0});var ke=g(e);t=f(ke,"ION-TOOLBAR",{});var me=g(t);n=f(me,"ION-BUTTONS",{slot:!0});var Oe=g(n);i=f(Oe,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),le(i)!=="svelte-1f8rjcf"&&(i.textContent=o),Oe.forEach(u),s=C(me),a=f(me,"ION-TITLE",{title:!0,"data-svelte-h":!0}),le(a)!=="svelte-zr4yw3"&&(a.textContent=h),k=C(me),v=f(me,"ION-BUTTONS",{slot:!0});var $=g(v);_=f($,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),le(_)!=="svelte-1afq5zm"&&(_.textContent=m),$.forEach(u),me.forEach(u),ke.forEach(u),p=C(te),E=f(te,"ION-CONTENT",{fullscreen:!0});var ee=g(E);y=f(ee,"ION-LIST",{});var G=g(y);w=f(G,"ION-ITEM",{lines:!0,class:!0,style:!0});var ce=g(w);P=f(ce,"DIV",{class:!0,style:!0});var Ie=g(P);for(let Ce=0;Ce<oe.length;Ce+=1)oe[Ce].l(Ie);Ie.forEach(u),ce.forEach(u),B=C(G),ne&&ne.l(G),A=C(G),U=f(G,"ION-ITEM",{});var K=g(U);F=f(K,"ION-ICON",{icon:!0,slot:!0}),g(F).forEach(u),q=C(K),N=f(K,"ION-TEXTAREA",{label:!0,placeholder:!0}),g(N).forEach(u),K.forEach(u),H=C(G),S=f(G,"SECTION",{});var Ee=g(S);O=f(Ee,"LABEL",{for:!0,style:!0});var Se=g(O);M=f(Se,"ION-BUTTON",{fill:!0,size:!0,class:!0,expand:!0});var Me=g(M);R=f(Me,"LABEL",{for:!0,style:!0,"data-svelte-h":!0}),le(R)!=="svelte-1tbnglg"&&(R.innerHTML=x),j=C(Me),Y=f(Me,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0,capture:!0}),Me.forEach(u),Se.forEach(u),Ee.forEach(u),ie=C(G),fe&&fe.l(G),G.forEach(u),ee.forEach(u),be=C(te),ue&&ue.l(te),Q=C(te),ae&&ae.l(te),L=xe(),this.h()},h(){b(i,"color","medium"),b(n,"slot","start"),b(a,"title",""),b(_,"strong",""),b(v,"slot","end"),b(e,"translucent",""),V(P,"class","motive-grid"),c(P,"display","flex"),c(P,"gap","8px"),c(P,"flex-wrap","wrap"),c(P,"justify-content","center"),c(P,"margin-top","6px"),b(w,"lines","none"),b(w,"class","motive-item"),c(w,"display","grid"),c(w,"justify-content","center"),c(w,"margin-bottom","15px"),b(F,"icon",pt),b(F,"slot","start"),b(N,"label","Comentarios"),b(N,"placeholder","Escribe aquí..."),V(R,"for","eventEvidence"),c(R,"width","100%"),c(R,"padding","8px"),c(Y,"display","none"),V(Y,"id","eventEvidence"),V(Y,"name","fileToUpload"),V(Y,"type","file"),V(Y,"accept","image/*"),V(Y,"capture","environment"),b(M,"fill","outline"),b(M,"size","small"),b(M,"class","loadEvidence"),b(M,"expand","block"),V(O,"for","eventEvidence"),c(O,"display","block"),c(O,"width","100%"),b(E,"fullscreen","")},m(te,ke){W(te,e,ke),r(e,t),r(t,n),r(n,i),r(t,s),r(t,a),r(t,k),r(t,v),r(v,_),W(te,p,ke),W(te,E,ke),r(E,y),r(y,w),r(w,P);for(let me=0;me<oe.length;me+=1)oe[me]&&oe[me].m(P,null);r(y,B),ne&&ne.m(y,null),r(y,A),r(y,U),r(U,F),r(U,q),r(U,N),l[20](N),r(y,H),r(y,S),r(S,O),r(O,M),r(M,R),r(M,j),r(M,Y),r(y,ie),fe&&fe.m(y,null),W(te,be,ke),ue&&ue.m(te,ke),W(te,Q,ke),ae&&ae.m(te,ke),W(te,L,ke),re||(he=[de(i,"click",l[11]),de(_,"click",l[12]),de(Y,"change",l[10])],re=!0)},p(te,ke){if(ke[0]&33344){se=Fe(te[9]);let me;for(me=0;me<se.length;me+=1){const Oe=Qt(te,se,me);oe[me]?oe[me].p(Oe,ke):(oe[me]=Zt(Oe),oe[me].c(),oe[me].m(P,null))}for(;me<oe.length;me+=1)oe[me].d(1);oe.length=se.length}te[7].lat?ne?ne.p(te,ke):(ne=$t(te),ne.c(),ne.m(y,A)):ne&&(ne.d(1),ne=null),te[0]?fe?fe.p(te,ke):(fe=en(te),fe.c(),fe.m(y,null)):fe&&(fe.d(1),fe=null),te[4]?ue?ue.p(te,ke):(ue=nn(te),ue.c(),ue.m(Q.parentNode,Q)):ue&&(ue.d(1),ue=null),te[3]?ae||(ae=on(),ae.c(),ae.m(L.parentNode,L)):ae&&(ae.d(1),ae=null)},i:Le,o:Le,d(te){te&&(u(e),u(p),u(E),u(be),u(Q),u(L)),gt(oe,te),ne&&ne.d(),l[20](null),fe&&fe.d(),ue&&ue.d(te),ae&&ae.d(te),re=!1,ze(he)}}}function Ki(l,e,t){let n=dt,o=document.querySelector("ion-modal").componentProps.routeId,s="",a=s?Ye(s):new Array,h="",k=!1,v=new Object,_=!1,m="",p="",E={lat:null,lng:null},y,w,P;const B=[{id:"car_accident",icon:"/car-accident.svg",label:"Accidente"},{id:"hospital",icon:"/hospital.svg",label:"Hospital"},{id:"wc",icon:"/toilet.svg",label:"Baño"},{id:"restaurant",icon:"/restaurant.svg",label:"Restaurant"},{id:"parking",icon:"/parking.svg",label:"Parking"},{id:"traffic",icon:"/traffic.svg",label:"Tráfico"}];tt(()=>{v=JSON.parse(localStorage.getItem("userSession"))});const A=async(L,re)=>{await(await Xe.create({header:L||"Error",message:re||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()},U=async L=>{t(3,k=!0);try{if(a.length>=5){A("Límite de evidencias","Solo se permite subir 5 fotos por parada");return}const he=L.target.files[0],se=await F(he);if(!se){A("Error","No se pudo comprimir la imagen");return}const oe={fileToUpload:se,id_user_over:v.id_user,token:v.token},ne=await new Promise((fe,ue)=>{je(`${n}api/admin/manager/upload_img_driver.php`,ae=>fe(ae),oe)});ne.success?(t(0,s=s?`${s},${ne.img}`:ne.img),t(1,a=Ye(s))):A("Error","No se pudo subir la imagen")}catch(re){console.error("Error during file upload:",re),A("Error","Algo salió mal al subir la imagen.")}finally{t(3,k=!1)}},F=async L=>new Promise(re=>{const he=new Image;he.src=URL.createObjectURL(L),he.onload=()=>{const se=document.createElement("canvas"),oe=se.getContext("2d"),ne=800,fe=600;let ue=he.width,ae=he.height;ue>ne&&(ae*=ne/ue,ue=ne),ae>fe&&(ue*=fe/ae,ae=fe),se.width=ue,se.height=ae,oe.drawImage(he,0,0,ue,ae),se.toBlob(te=>{re(te),URL.revokeObjectURL(he.src),oe.clearRect(0,0,se.width,se.height)},"image/jpeg",.7)}}),q=()=>{nt.dismiss()},N=()=>{t(3,k=!0);var L=new Object;t(0,s=a.join(",")),L.id_route=o,L.comments=h.value,L.lat=E.lat,L.lng=E.lng,L.type=p,L.img=s,L.id_user_over=v.id_user,L.token=v.token,L.id_driver=v.id_driver,!p||!s||!L.comments||!L.img?(t(3,k=!1),A("Datos incompletos","Llena los datos requeridos para completar el registro")):!L.lat||!L.lng?(t(3,k=!1),A("Ubicación no disponible","Por favor, asegúrate de que la ubicación está activada en tu dispositivo.")):je(`${n}api/admin/incidence/add_incidence.php`,function(re){re?(t(3,k=!1),A("Éxito","Incidencia registrada correctamente")):(t(3,k=!1),A("Error","No se pudo registrar la incidencia. Por favor, inténtalo de nuevo.")),q()},L)},H=L=>{t(5,m=L),t(4,_=!0)},S=()=>{t(4,_=!1),t(5,m="")};async function O(L){t(6,p=L),t(3,k=!0),navigator.geolocation&&navigator.geolocation.getCurrentPosition(async re=>{t(7,E.lat=re.coords.latitude,E),t(7,E.lng=re.coords.longitude,E),await M()},()=>console.log("Geolocalización denegada"))}async function M(){if(await wt(),!y)return;const{Map:L}=await google.maps.importLibrary("maps"),{AdvancedMarkerElement:re}=await google.maps.importLibrary("marker");w?w.setCenter(E):w=new L(y,{zoom:15,center:E,mapId:"4504f8b37365c3d0"});const he=B.find(ne=>ne.id===p);if(!he)return;P&&P.setMap(null);const se=document.createElement("div");se.style.cssText=`
      display:flex;align-items:center;justify-content:center;
      width:38px;height:38px;border-radius:50%;
      background:#ffffff;border:2px solid #d13434;
      box-shadow:0 0 4px rgba(0,0,0,.3);
  `;const oe=document.createElement("ion-icon");oe.setAttribute("icon",he.icon),oe.style.cssText="font-size:24px;color:#d13434;",se.appendChild(oe),P=new re({map:w,position:E,title:he.label,content:se}),t(3,k=!1)}function R(L=0){var re=Nn(L,a,[""],s);t(1,a=re.files),t(0,s=re.selectedImages)}function x(L){Tt.call(this,l,L)}const j=L=>O(L.id);function Y(L){Ue[L?"unshift":"push"](()=>{y=L,t(8,y)})}function ie(L){Ue[L?"unshift":"push"](()=>{h=L,t(2,h)})}return[s,a,h,k,_,m,p,E,y,B,U,q,N,H,S,O,R,x,j,Y,ie,L=>H(L),L=>R(L)]}class Xi extends Ze{constructor(e){super(),$e(this,e,Ki,Gi,Qe,{},null,[-1,-1])}}function ln(l,e,t){const n=l.slice();return n[7]=e[t],n}function Ji(l){let e,t="Cargar gasto",n,i;function o(...s){return l[4](l[7],...s)}return{c(){e=d("ion-button"),e.textContent=t,this.h()},l(s){e=f(s,"ION-BUTTON",{fill:!0,size:!0,"aria-selected":!0,"data-svelte-h":!0}),le(e)!=="svelte-175aelj"&&(e.textContent=t),this.h()},h(){b(e,"fill","outline"),b(e,"size","small"),b(e,"aria-selected","")},m(s,a){W(s,e,a),n||(i=de(e,"click",o),n=!0)},p(s,a){l=s},d(s){s&&u(e),n=!1,i()}}}function Yi(l){let e,t="Gasto completado";return{c(){e=d("ion-button"),e.textContent=t,this.h()},l(n){e=f(n,"ION-BUTTON",{fill:!0,size:!0,"aria-selected":!0,"data-svelte-h":!0}),le(e)!=="svelte-tlger7"&&(e.textContent=t),this.h()},h(){b(e,"fill","solid"),b(e,"size","small"),b(e,"aria-selected","")},m(n,i){W(n,e,i)},p:Le,d(n){n&&u(e)}}}function rn(l,e){let t,n,i,o=e[7].concept+"",s,a,h;function k(m,p){return m[7].status=="done"?Yi:Ji}let _=k(e)(e);return{key:l,first:null,c(){t=d("ion-item"),n=d("ion-label"),i=d("p"),s=ye(o),a=T(),_.c(),h=T(),this.h()},l(m){t=f(m,"ION-ITEM",{});var p=g(t);n=f(p,"ION-LABEL",{style:!0});var E=g(n);i=f(E,"P",{style:!0});var y=g(i);s=we(y,o),y.forEach(u),E.forEach(u),a=C(p),_.l(p),h=C(p),p.forEach(u),this.h()},h(){c(i,"margin-left","10px"),c(n,"display","flex"),this.first=t},m(m,p){W(m,t,p),r(t,n),r(n,i),r(i,s),r(t,a),_.m(t,null),r(t,h)},p(m,p){e=m,_.p(e,p)},d(m){m&&u(t),_.d()}}}function Qi(l){let e,t,n,i,o=`<ion-icon style="font-size: 25px!important;" icon="${Gn}"></ion-icon>`,s,a,h="LISTA DE GASTOS",k,v,_,m=[],p=new Map,E,y,w,P="Cerrar",B,A,U=Fe(l[0]);const F=q=>q[7].id_expenses;for(let q=0;q<U.length;q+=1){let N=ln(l,U,q),H=F(N);p.set(H,m[q]=rn(H,N))}return{c(){e=d("ion-header"),t=d("ion-toolbar"),n=d("ion-buttons"),i=d("ion-button"),i.innerHTML=o,s=T(),a=d("ion-title"),a.textContent=h,k=T(),v=d("ion-content"),_=d("ion-list");for(let q=0;q<m.length;q+=1)m[q].c();E=T(),y=d("ion-footer"),w=d("ion-button"),w.textContent=P,this.h()},l(q){e=f(q,"ION-HEADER",{translucent:!0});var N=g(e);t=f(N,"ION-TOOLBAR",{});var H=g(t);n=f(H,"ION-BUTTONS",{slot:!0});var S=g(n);i=f(S,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),le(i)!=="svelte-160xz3i"&&(i.innerHTML=o),S.forEach(u),s=C(H),a=f(H,"ION-TITLE",{"data-svelte-h":!0}),le(a)!=="svelte-1phn90x"&&(a.textContent=h),H.forEach(u),N.forEach(u),k=C(q),v=f(q,"ION-CONTENT",{fullscreen:!0});var O=g(v);_=f(O,"ION-LIST",{});var M=g(_);for(let x=0;x<m.length;x+=1)m[x].l(M);M.forEach(u),O.forEach(u),E=C(q),y=f(q,"ION-FOOTER",{});var R=g(y);w=f(R,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),le(w)!=="svelte-zv7v83"&&(w.textContent=P),R.forEach(u),this.h()},h(){b(i,"color","medium"),b(n,"slot","end"),b(e,"translucent",""),b(v,"fullscreen",""),b(w,"fill","outline"),b(w,"color","tertiary"),b(w,"strong",""),c(w,"width","99%"),c(w,"height","auto")},m(q,N){W(q,e,N),r(e,t),r(t,n),r(n,i),r(t,s),r(t,a),W(q,k,N),W(q,v,N),r(v,_);for(let H=0;H<m.length;H+=1)m[H]&&m[H].m(_,null);W(q,E,N),W(q,y,N),r(y,w),B||(A=[de(i,"click",l[3]),de(w,"click",l[1])],B=!0)},p(q,[N]){N&5&&(U=Fe(q[0]),m=ct(m,N,F,1,q,U,p,_,ut,rn,null,ln))},i:Le,o:Le,d(q){q&&(u(e),u(k),u(v),u(E),u(y));for(let N=0;N<m.length;N+=1)m[N].d();B=!1,ze(A)}}}function Zi(l){let e=document.querySelector("ion-modal");e.componentProps.routeId;let t=e.componentProps.expenses;tt(()=>{});const n=()=>{nt.dismiss()};function i(a,h,k,v,_){e.componentProps.ex_amount=k,e.componentProps.ex_concept=h,e.componentProps.ex_type=v,e.componentProps.id_expense=_,Je("modal-expense",It,{amount:k,concept:h,type:v,id_expense:_}).then(()=>{}),n()}return[t,n,i,a=>{Je("modal-expense",It,{routeId:a}).then(h=>{}),n()},(a,h)=>i(h,a.concept,a.amount,a.type,a.id_expenses)]}class $i extends Ze{constructor(e){super(),$e(this,e,Zi,Qi,Qe,{})}}const{document:sn}=ni;function an(l,e,t){const n=l.slice();return n[61]=e[t],n[63]=t,n}function cn(l,e,t){const n=l.slice();return n[61]=e[t],n[63]=t,n}function un(l,e,t){const n=l.slice();return n[61]=e[t],n[63]=t,n}function dn(l){let e,t;return e=new Kn({props:{$$slots:{default:[ho]},$$scope:{ctx:l}}}),{c(){kn(e.$$.fragment)},l(n){En(e.$$.fragment,n)},m(n,i){In(e,n,i),t=!0},p(n,i){const o={};i[0]&1021|i[2]&16&&(o.$$scope={dirty:i,ctx:n}),e.$set(o)},i(n){t||(et(e.$$.fragment,n),t=!0)},o(n){lt(e.$$.fragment,n),t=!1},d(n){On(e,n)}}}function eo(l){let e,t='<div id="g_map" style="width: 100%; height: 100vh;"></div>';return{c(){e=d("ion-content"),e.innerHTML=t},l(n){e=f(n,"ION-CONTENT",{"data-svelte-h":!0}),le(e)!=="svelte-h8v4nk"&&(e.innerHTML=t)},m(n,i){W(n,e,i)},p:Le,d(n){n&&u(e)}}}function to(l){let e;function t(o,s){if(o[6].length>0)return io;if(!o[2])return no}let n=t(l),i=n&&n(l);return{c(){i&&i.c(),e=xe()},l(o){i&&i.l(o),e=xe()},m(o,s){i&&i.m(o,s),W(o,e,s)},p(o,s){n===(n=t(o))&&i?i.p(o,s):(i&&i.d(1),i=n&&n(o),i&&(i.c(),i.m(e.parentNode,e)))},d(o){o&&u(e),i&&i.d(o)}}}function no(l){let e,t,n,i='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Jala para actualizar" refreshing-spinner="circles" refreshing-text="Actualizando..."></ion-refresher-content>',o,s,a,h,k,v,_="0",m,p,E,y,w,P=l[5].origin+"",B,A,U,F,q,N,H=[],S=new Map,O,M,R,x,j,Y=l[4].length+1+"",ie,be,Q,L,re,he,se=l[5].destination+"",oe,ne,fe,ue="",ae,te,ke,me,Oe=l[3]&&fn(),$=Fe(l[4]);const ee=G=>G[61].id_event;for(let G=0;G<$.length;G+=1){let ce=an(l,$,G),Ie=ee(ce);S.set(Ie,H[G]=_n(Ie,ce))}return{c(){Oe&&Oe.c(),e=T(),t=d("ion-content"),n=d("ion-refresher"),n.innerHTML=i,o=T(),s=d("ion-list"),a=d("ion-item"),h=d("ion-avatar"),k=d("div"),v=d("div"),v.textContent=_,p=T(),E=d("ion-label"),y=d("ion-text"),w=d("h3"),B=ye(P),A=T(),U=d("div"),F=T(),q=d("ion-icon"),N=T();for(let G=0;G<H.length;G+=1)H[G].c();O=T(),M=d("ion-item"),R=d("ion-avatar"),x=d("div"),j=d("div"),ie=ye(Y),Q=T(),L=d("ion-label"),re=d("ion-text"),he=d("h3"),oe=ye(se),ne=T(),fe=d("div"),fe.innerHTML=ue,ae=T(),te=d("ion-icon"),this.h()},l(G){Oe&&Oe.l(G),e=C(G),t=f(G,"ION-CONTENT",{});var ce=g(t);n=f(ce,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),le(n)!=="svelte-1mlmyg"&&(n.innerHTML=i),o=C(ce),s=f(ce,"ION-LIST",{});var Ie=g(s);a=f(Ie,"ION-ITEM",{});var K=g(a);h=f(K,"ION-AVATAR",{slot:!0});var Ee=g(h);k=f(Ee,"DIV",{class:!0,title:!0,style:!0});var Se=g(k);v=f(Se,"DIV",{class:!0,"data-svelte-h":!0}),le(v)!=="svelte-b78non"&&(v.textContent=_),Se.forEach(u),Ee.forEach(u),p=C(K),E=f(K,"ION-LABEL",{button:!0});var Me=g(E);y=f(Me,"ION-TEXT",{color:!0});var Ce=g(y);w=f(Ce,"H3",{});var J=g(w);B=we(J,P),J.forEach(u),Ce.forEach(u),A=C(Me),U=f(Me,"DIV",{class:!0}),g(U).forEach(u),Me.forEach(u),F=C(K),q=f(K,"ION-ICON",{icon:!0,slot:!0}),g(q).forEach(u),K.forEach(u),N=C(Ie);for(let X=0;X<H.length;X+=1)H[X].l(Ie);O=C(Ie),M=f(Ie,"ION-ITEM",{});var Z=g(M);R=f(Z,"ION-AVATAR",{slot:!0});var ge=g(R);x=f(ge,"DIV",{class:!0,title:!0,style:!0});var _e=g(x);j=f(_e,"DIV",{class:!0});var Te=g(j);ie=we(Te,Y),Te.forEach(u),_e.forEach(u),ge.forEach(u),Q=C(Z),L=f(Z,"ION-LABEL",{button:!0});var I=g(L);re=f(I,"ION-TEXT",{color:!0});var D=g(re);he=f(D,"H3",{});var z=g(he);oe=we(z,se),z.forEach(u),D.forEach(u),ne=C(I),fe=f(I,"DIV",{class:!0,"data-svelte-h":!0}),le(fe)!=="svelte-1284run"&&(fe.innerHTML=ue),I.forEach(u),ae=C(Z),te=f(Z,"ION-ICON",{icon:!0,slot:!0}),g(te).forEach(u),Z.forEach(u),Ie.forEach(u),ce.forEach(u),this.h()},h(){b(n,"slot","fixed"),V(v,"class","order svelte-1ita8l7"),V(k,"class","order-wrapper svelte-1ita8l7"),V(k,"title",m="$"+l[5].origin),c(k,"background-color",l[5].color),c(k,"color",He(l[5].color)),b(h,"slot","start"),b(y,"color","#2e2e2e"),V(U,"class","sub svelte-1ita8l7"),b(E,"button",""),b(q,"icon",Ke),b(q,"slot","end"),V(j,"class","order svelte-1ita8l7"),V(x,"class","order-wrapper svelte-1ita8l7"),V(x,"title",be="$"+l[5].destination),c(x,"background-color",l[5].color),c(x,"color",He(l[5].color)),b(R,"slot","start"),b(re,"color","#2e2e2e"),V(fe,"class","sub svelte-1ita8l7"),b(L,"button",""),b(te,"icon",Ke),b(te,"slot","end")},m(G,ce){Oe&&Oe.m(G,ce),W(G,e,ce),W(G,t,ce),r(t,n),l[33](n),r(t,o),r(t,s),r(s,a),r(a,h),r(h,k),r(k,v),r(a,p),r(a,E),r(E,y),r(y,w),r(w,B),r(E,A),r(E,U),r(a,F),r(a,q),r(s,N);for(let Ie=0;Ie<H.length;Ie+=1)H[Ie]&&H[Ie].m(s,null);r(s,O),r(s,M),r(M,R),r(R,x),r(x,j),r(j,ie),r(M,Q),r(M,L),r(L,re),r(re,he),r(he,oe),r(L,ne),r(L,fe),r(M,ae),r(M,te),ke||(me=[de(n,"ionRefresh",l[11]),de(E,"click",l[34]),de(L,"click",l[36])],ke=!0)},p(G,ce){G[3]?Oe||(Oe=fn(),Oe.c(),Oe.m(e.parentNode,e)):Oe&&(Oe.d(1),Oe=null),ce[0]&32&&m!==(m="$"+G[5].origin)&&V(k,"title",m),ce[0]&32&&c(k,"background-color",G[5].color),ce[0]&32&&c(k,"color",He(G[5].color)),ce[0]&32&&P!==(P=G[5].origin+"")&&Ae(B,P),ce[0]&664080&&($=Fe(G[4]),H=ct(H,ce,ee,1,G,$,S,s,ut,_n,O,an)),ce[0]&16&&Y!==(Y=G[4].length+1+"")&&Ae(ie,Y),ce[0]&32&&be!==(be="$"+G[5].destination)&&V(x,"title",be),ce[0]&32&&c(x,"background-color",G[5].color),ce[0]&32&&c(x,"color",He(G[5].color)),ce[0]&32&&se!==(se=G[5].destination+"")&&Ae(oe,se)},d(G){G&&(u(e),u(t)),Oe&&Oe.d(G),l[33](null);for(let ce=0;ce<H.length;ce+=1)H[ce].d();ke=!1,ze(me)}}}function io(l){let e,t;function n(s,a){return a[0]&72&&(e=null),e==null&&(e=!!(s[6].filter(po).every(mo)&&!s[3])),e?so:ro}let i=n(l,[-1,-1,-1]),o=i(l);return{c(){o.c(),t=xe()},l(s){o.l(s),t=xe()},m(s,a){o.m(s,a),W(s,t,a)},p(s,a){i===(i=n(s,a))&&o?o.p(s,a):(o.d(1),o=i(s),o&&(o.c(),o.m(t.parentNode,t)))},d(s){s&&u(t),o.d(s)}}}function fn(l){return{c:Le,l:Le,m:Le,d:Le}}function hn(l){let e;return{c(){e=d("span"),this.h()},l(t){e=f(t,"SPAN",{class:!0}),g(e).forEach(u),this.h()},h(){V(e,"class","notes svelte-1ita8l7")},m(t,n){W(t,e,n)},d(t){t&&u(e)}}}function oo(l){let e;return{c(){e=d("ion-icon"),this.h()},l(t){e=f(t,"ION-ICON",{icon:!0,slot:!0,style:!0}),g(e).forEach(u),this.h()},h(){b(e,"icon",Ke),b(e,"slot","end"),c(e,"color",Re(l[61].status,l[61].date_service))},m(t,n){W(t,e,n)},p(t,n){n[0]&16&&c(e,"color",Re(t[61].status,t[61].date_service))},d(t){t&&u(e)}}}function lo(l){let e,t=(l[61].tag?l[61].tag:"")+"",n;return{c(){e=d("div"),n=ye(t),this.h()},l(i){e=f(i,"DIV",{class:!0,slot:!0,style:!0});var o=g(e);n=we(o,t),o.forEach(u),this.h()},h(){V(e,"class","stop-tag"),V(e,"slot","end"),c(e,"background-color",qe(l[61].tag_color,.3)),c(e,"border","1px solid "+qe(l[61].tag_color,.4)),c(e,"color",l[61].tag_color),c(e,"font-size","10px"),c(e,"text-align","center"),c(e,"align-content","center"),c(e,"border-radius","20px"),c(e,"white-space","normal"),c(e,"padding","3px 6px"),c(e,"width","auto",1),c(e,"display","inline-block"),c(e,"font-weight","500")},m(i,o){W(i,e,o),r(e,n)},p(i,o){o[0]&16&&t!==(t=(i[61].tag?i[61].tag:"")+"")&&Ae(n,t),o[0]&16&&c(e,"background-color",qe(i[61].tag_color,.3)),o[0]&16&&c(e,"border","1px solid "+qe(i[61].tag_color,.4)),o[0]&16&&c(e,"color",i[61].tag_color)},d(i){i&&u(e)}}}function _n(l,e){let t,n,i,o,s=parseInt(e[61].pos)+1+"",a,h,k,v,_,m,p=e[61].title+"",E,y,w=e[61].support_list&&e[61].support_list.length||e[17](e[61]),P,B,A,U=w&&hn();function F(){return e[35](e[61])}function q(S,O){return S[61].tag_color&&S[61].tag?lo:oo}let N=q(e),H=N(e);return{key:l,first:null,c(){t=d("ion-item"),n=d("ion-avatar"),i=d("div"),o=d("div"),a=ye(s),k=T(),v=d("ion-label"),_=d("ion-text"),m=d("h3"),E=ye(p),y=T(),U&&U.c(),P=T(),H.c(),this.h()},l(S){t=f(S,"ION-ITEM",{});var O=g(t);n=f(O,"ION-AVATAR",{slot:!0});var M=g(n);i=f(M,"DIV",{class:!0,title:!0,style:!0});var R=g(i);o=f(R,"DIV",{class:!0});var x=g(o);a=we(x,s),x.forEach(u),R.forEach(u),M.forEach(u),k=C(O),v=f(O,"ION-LABEL",{button:!0});var j=g(v);_=f(j,"ION-TEXT",{color:!0});var Y=g(_);m=f(Y,"H3",{});var ie=g(m);E=we(ie,p),y=C(ie),U&&U.l(ie),ie.forEach(u),Y.forEach(u),j.forEach(u),P=C(O),H.l(O),O.forEach(u),this.h()},h(){V(o,"class","order svelte-1ita8l7"),V(i,"class","order-wrapper svelte-1ita8l7"),V(i,"title",h=rt(e[61].status)),c(i,"background-color",Re(e[61].status,e[61].date_service)),c(i,"color",He(Re(e[61].status))),b(n,"slot","start"),b(_,"color","#2e2e2e"),b(v,"button",""),this.first=t},m(S,O){W(S,t,O),r(t,n),r(n,i),r(i,o),r(o,a),r(t,k),r(t,v),r(v,_),r(_,m),r(m,E),r(m,y),U&&U.m(m,null),r(t,P),H.m(t,null),B||(A=de(v,"click",F),B=!0)},p(S,O){e=S,O[0]&16&&s!==(s=parseInt(e[61].pos)+1+"")&&Ae(a,s),O[0]&16&&h!==(h=rt(e[61].status))&&V(i,"title",h),O[0]&16&&c(i,"background-color",Re(e[61].status,e[61].date_service)),O[0]&16&&c(i,"color",He(Re(e[61].status))),O[0]&16&&p!==(p=e[61].title+"")&&Ae(E,p),O[0]&16&&(w=e[61].support_list&&e[61].support_list.length||e[17](e[61])),w?U||(U=hn(),U.c(),U.m(m,null)):U&&(U.d(1),U=null),N===(N=q(e))&&H?H.p(e,O):(H.d(1),H=N(e),H&&(H.c(),H.m(t,null)))},d(S){S&&u(t),U&&U.d(),H.d(),B=!1,A()}}}function ro(l){let e,t,n='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Pull to refresh" refreshing-spinner="circles" refreshing-text="Refreshing..."></ion-refresher-content>',i,o,s,a,h,k,v="0",_,m,p,E,y,w=l[5].origin+"",P,B,A,U,F,q,N=[],H=new Map,S,O,M,R,x,j=l[4].length+1+"",Y,ie,be,Q,L,re,he=l[5].destination+"",se,oe,ne,fe="",ue,ae,te,ke,me=Fe(l[4]);const Oe=$=>$[61].id_event;for(let $=0;$<me.length;$+=1){let ee=cn(l,me,$),G=Oe(ee);H.set(G,N[$]=mn(G,ee))}return{c(){e=d("ion-content"),t=d("ion-refresher"),t.innerHTML=n,i=T(),o=d("ion-list"),s=d("ion-item"),a=d("ion-avatar"),h=d("div"),k=d("div"),k.textContent=v,m=T(),p=d("ion-label"),E=d("ion-text"),y=d("h3"),P=ye(w),B=T(),A=d("div"),U=T(),F=d("ion-icon"),q=T();for(let $=0;$<N.length;$+=1)N[$].c();S=T(),O=d("ion-item"),M=d("ion-avatar"),R=d("div"),x=d("div"),Y=ye(j),be=T(),Q=d("ion-label"),L=d("ion-text"),re=d("h3"),se=ye(he),oe=T(),ne=d("div"),ne.innerHTML=fe,ue=T(),ae=d("ion-icon"),this.h()},l($){e=f($,"ION-CONTENT",{});var ee=g(e);t=f(ee,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),le(t)!=="svelte-1l8nqqz"&&(t.innerHTML=n),i=C(ee),o=f(ee,"ION-LIST",{});var G=g(o);s=f(G,"ION-ITEM",{});var ce=g(s);a=f(ce,"ION-AVATAR",{slot:!0});var Ie=g(a);h=f(Ie,"DIV",{class:!0,title:!0,style:!0});var K=g(h);k=f(K,"DIV",{class:!0,"data-svelte-h":!0}),le(k)!=="svelte-b78non"&&(k.textContent=v),K.forEach(u),Ie.forEach(u),m=C(ce),p=f(ce,"ION-LABEL",{button:!0});var Ee=g(p);E=f(Ee,"ION-TEXT",{color:!0});var Se=g(E);y=f(Se,"H3",{});var Me=g(y);P=we(Me,w),Me.forEach(u),Se.forEach(u),B=C(Ee),A=f(Ee,"DIV",{class:!0}),g(A).forEach(u),Ee.forEach(u),U=C(ce),F=f(ce,"ION-ICON",{icon:!0,slot:!0}),g(F).forEach(u),ce.forEach(u),q=C(G);for(let D=0;D<N.length;D+=1)N[D].l(G);S=C(G),O=f(G,"ION-ITEM",{});var Ce=g(O);M=f(Ce,"ION-AVATAR",{slot:!0});var J=g(M);R=f(J,"DIV",{class:!0,title:!0,style:!0});var Z=g(R);x=f(Z,"DIV",{class:!0});var ge=g(x);Y=we(ge,j),ge.forEach(u),Z.forEach(u),J.forEach(u),be=C(Ce),Q=f(Ce,"ION-LABEL",{button:!0});var _e=g(Q);L=f(_e,"ION-TEXT",{color:!0});var Te=g(L);re=f(Te,"H3",{});var I=g(re);se=we(I,he),I.forEach(u),Te.forEach(u),oe=C(_e),ne=f(_e,"DIV",{class:!0,"data-svelte-h":!0}),le(ne)!=="svelte-1uxrbi7"&&(ne.innerHTML=fe),_e.forEach(u),ue=C(Ce),ae=f(Ce,"ION-ICON",{icon:!0,slot:!0}),g(ae).forEach(u),Ce.forEach(u),G.forEach(u),ee.forEach(u),this.h()},h(){b(t,"slot","fixed"),V(k,"class","order svelte-1ita8l7"),V(h,"class","order-wrapper svelte-1ita8l7"),V(h,"title",_="$"+l[5].origin),c(h,"background-color",l[5].color),c(h,"color",He(l[5].color)),b(a,"slot","start"),b(E,"color","#2e2e2e"),V(A,"class","sub svelte-1ita8l7"),b(p,"button",""),b(F,"icon",Ke),b(F,"slot","end"),V(x,"class","order svelte-1ita8l7"),V(R,"class","order-wrapper svelte-1ita8l7"),V(R,"title",ie="$"+l[5].destination),c(R,"background-color",l[5].color),c(R,"color",He(l[5].color)),b(M,"slot","start"),b(L,"color","#2e2e2e"),V(ne,"class","sub svelte-1ita8l7"),b(Q,"button",""),b(ae,"icon",Ke),b(ae,"slot","end")},m($,ee){W($,e,ee),r(e,t),l[29](t),r(e,i),r(e,o),r(o,s),r(s,a),r(a,h),r(h,k),r(s,m),r(s,p),r(p,E),r(E,y),r(y,P),r(p,B),r(p,A),r(s,U),r(s,F),r(o,q);for(let G=0;G<N.length;G+=1)N[G]&&N[G].m(o,null);r(o,S),r(o,O),r(O,M),r(M,R),r(R,x),r(x,Y),r(O,be),r(O,Q),r(Q,L),r(L,re),r(re,se),r(Q,oe),r(Q,ne),r(O,ue),r(O,ae),te||(ke=[de(t,"ionRefresh",l[11]),de(p,"click",l[30]),de(Q,"click",l[32])],te=!0)},p($,ee){ee[0]&32&&_!==(_="$"+$[5].origin)&&V(h,"title",_),ee[0]&32&&c(h,"background-color",$[5].color),ee[0]&32&&c(h,"color",He($[5].color)),ee[0]&32&&w!==(w=$[5].origin+"")&&Ae(P,w),ee[0]&664080&&(me=Fe($[4]),N=ct(N,ee,Oe,1,$,me,H,o,ut,mn,S,cn)),ee[0]&16&&j!==(j=$[4].length+1+"")&&Ae(Y,j),ee[0]&32&&ie!==(ie="$"+$[5].destination)&&V(R,"title",ie),ee[0]&32&&c(R,"background-color",$[5].color),ee[0]&32&&c(R,"color",He($[5].color)),ee[0]&32&&he!==(he=$[5].destination+"")&&Ae(se,he)},d($){$&&u(e),l[29](null);for(let ee=0;ee<N.length;ee+=1)N[ee].d();te=!1,ze(ke)}}}function so(l){let e,t,n='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Jale para actualizar" refreshing-spinner="circles" refreshing-text="Actualizando..."></ion-refresher-content>',i,o,s,a,h,k,v="0",_,m,p,E,y,w=l[5].origin+"",P,B,A,U,F,q,N=[],H=new Map,S,O,M,R,x,j=l[4].length+1+"",Y,ie,be,Q,L,re,he=l[5].destination+"",se,oe,ne,fe="",ue,ae,te,ke,me=Fe(l[4]);const Oe=$=>$[61].id_event;for(let $=0;$<me.length;$+=1){let ee=un(l,me,$),G=Oe(ee);H.set(G,N[$]=gn(G,ee))}return{c(){e=d("ion-content"),t=d("ion-refresher"),t.innerHTML=n,i=T(),o=d("ion-list"),s=d("ion-item"),a=d("ion-avatar"),h=d("div"),k=d("div"),k.textContent=v,m=T(),p=d("ion-label"),E=d("ion-text"),y=d("h3"),P=ye(w),B=T(),A=d("div"),U=T(),F=d("ion-icon"),q=T();for(let $=0;$<N.length;$+=1)N[$].c();S=T(),O=d("ion-item"),M=d("ion-avatar"),R=d("div"),x=d("div"),Y=ye(j),be=T(),Q=d("ion-label"),L=d("ion-text"),re=d("h3"),se=ye(he),oe=T(),ne=d("div"),ne.innerHTML=fe,ue=T(),ae=d("ion-icon"),this.h()},l($){e=f($,"ION-CONTENT",{});var ee=g(e);t=f(ee,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),le(t)!=="svelte-vjbhg4"&&(t.innerHTML=n),i=C(ee),o=f(ee,"ION-LIST",{});var G=g(o);s=f(G,"ION-ITEM",{});var ce=g(s);a=f(ce,"ION-AVATAR",{slot:!0});var Ie=g(a);h=f(Ie,"DIV",{class:!0,title:!0,style:!0});var K=g(h);k=f(K,"DIV",{class:!0,"data-svelte-h":!0}),le(k)!=="svelte-b78non"&&(k.textContent=v),K.forEach(u),Ie.forEach(u),m=C(ce),p=f(ce,"ION-LABEL",{button:!0});var Ee=g(p);E=f(Ee,"ION-TEXT",{color:!0});var Se=g(E);y=f(Se,"H3",{});var Me=g(y);P=we(Me,w),Me.forEach(u),Se.forEach(u),B=C(Ee),A=f(Ee,"DIV",{class:!0}),g(A).forEach(u),Ee.forEach(u),U=C(ce),F=f(ce,"ION-ICON",{icon:!0,slot:!0}),g(F).forEach(u),ce.forEach(u),q=C(G);for(let D=0;D<N.length;D+=1)N[D].l(G);S=C(G),O=f(G,"ION-ITEM",{});var Ce=g(O);M=f(Ce,"ION-AVATAR",{slot:!0});var J=g(M);R=f(J,"DIV",{class:!0,title:!0,style:!0});var Z=g(R);x=f(Z,"DIV",{class:!0});var ge=g(x);Y=we(ge,j),ge.forEach(u),Z.forEach(u),J.forEach(u),be=C(Ce),Q=f(Ce,"ION-LABEL",{button:!0});var _e=g(Q);L=f(_e,"ION-TEXT",{color:!0});var Te=g(L);re=f(Te,"H3",{});var I=g(re);se=we(I,he),I.forEach(u),Te.forEach(u),oe=C(_e),ne=f(_e,"DIV",{class:!0,"data-svelte-h":!0}),le(ne)!=="svelte-1uxrbi7"&&(ne.innerHTML=fe),_e.forEach(u),ue=C(Ce),ae=f(Ce,"ION-ICON",{icon:!0,slot:!0}),g(ae).forEach(u),Ce.forEach(u),G.forEach(u),ee.forEach(u),this.h()},h(){b(t,"slot","fixed"),V(k,"class","order svelte-1ita8l7"),V(h,"class","order-wrapper svelte-1ita8l7"),V(h,"title",_="$"+l[5].origin),c(h,"background-color",l[5].color),c(h,"color",He(l[5].color)),b(a,"slot","start"),b(E,"color","#2e2e2e"),V(A,"class","sub svelte-1ita8l7"),b(p,"button",""),b(F,"icon",Ke),b(F,"slot","end"),V(x,"class","order svelte-1ita8l7"),V(R,"class","order-wrapper svelte-1ita8l7"),V(R,"title",ie="$"+l[5].destination),c(R,"background-color",l[5].color),c(R,"color",He(l[5].color)),b(M,"slot","start"),b(L,"color","#2e2e2e"),V(ne,"class","sub svelte-1ita8l7"),b(Q,"button",""),b(ae,"icon",Ke),b(ae,"slot","end")},m($,ee){W($,e,ee),r(e,t),l[25](t),r(e,i),r(e,o),r(o,s),r(s,a),r(a,h),r(h,k),r(s,m),r(s,p),r(p,E),r(E,y),r(y,P),r(p,B),r(p,A),r(s,U),r(s,F),r(o,q);for(let G=0;G<N.length;G+=1)N[G]&&N[G].m(o,null);r(o,S),r(o,O),r(O,M),r(M,R),r(R,x),r(x,Y),r(O,be),r(O,Q),r(Q,L),r(L,re),r(re,se),r(Q,oe),r(Q,ne),r(O,ue),r(O,ae),te||(ke=[de(t,"ionRefresh",l[11]),de(p,"click",l[26]),de(Q,"click",l[28])],te=!0)},p($,ee){ee[0]&32&&_!==(_="$"+$[5].origin)&&V(h,"title",_),ee[0]&32&&c(h,"background-color",$[5].color),ee[0]&32&&c(h,"color",He($[5].color)),ee[0]&32&&w!==(w=$[5].origin+"")&&Ae(P,w),ee[0]&664080&&(me=Fe($[4]),N=ct(N,ee,Oe,1,$,me,H,o,ut,gn,S,un)),ee[0]&16&&j!==(j=$[4].length+1+"")&&Ae(Y,j),ee[0]&32&&ie!==(ie="$"+$[5].destination)&&V(R,"title",ie),ee[0]&32&&c(R,"background-color",$[5].color),ee[0]&32&&c(R,"color",He($[5].color)),ee[0]&32&&he!==(he=$[5].destination+"")&&Ae(se,he)},d($){$&&u(e),l[25](null);for(let ee=0;ee<N.length;ee+=1)N[ee].d();te=!1,ze(ke)}}}function pn(l){let e;return{c(){e=d("span"),this.h()},l(t){e=f(t,"SPAN",{class:!0}),g(e).forEach(u),this.h()},h(){V(e,"class","notes svelte-1ita8l7")},m(t,n){W(t,e,n)},d(t){t&&u(e)}}}function ao(l){let e;return{c(){e=d("ion-icon"),this.h()},l(t){e=f(t,"ION-ICON",{icon:!0,slot:!0,style:!0}),g(e).forEach(u),this.h()},h(){b(e,"icon",Ke),b(e,"slot","end"),c(e,"color",Re(l[61].status,l[61].date_service))},m(t,n){W(t,e,n)},p(t,n){n[0]&16&&c(e,"color",Re(t[61].status,t[61].date_service))},d(t){t&&u(e)}}}function co(l){let e,t=(l[61].tag?l[61].tag:"")+"",n;return{c(){e=d("div"),n=ye(t),this.h()},l(i){e=f(i,"DIV",{class:!0,slot:!0,style:!0});var o=g(e);n=we(o,t),o.forEach(u),this.h()},h(){V(e,"class","stop-tag"),V(e,"slot","end"),c(e,"background-color",qe(l[61].tag_color,.3)),c(e,"border","1px solid "+qe(l[61].tag_color,.4)),c(e,"color",l[61].tag_color),c(e,"font-size","10px"),c(e,"text-align","center"),c(e,"align-content","center"),c(e,"border-radius","20px"),c(e,"white-space","normal"),c(e,"padding","3px 6px"),c(e,"width","auto",1),c(e,"display","inline-block"),c(e,"font-weight","500")},m(i,o){W(i,e,o),r(e,n)},p(i,o){o[0]&16&&t!==(t=(i[61].tag?i[61].tag:"")+"")&&Ae(n,t),o[0]&16&&c(e,"background-color",qe(i[61].tag_color,.3)),o[0]&16&&c(e,"border","1px solid "+qe(i[61].tag_color,.4)),o[0]&16&&c(e,"color",i[61].tag_color)},d(i){i&&u(e)}}}function mn(l,e){let t,n,i,o,s=parseInt(e[61].pos)+1+"",a,h,k,v,_,m,p=e[61].title+"",E,y,w=e[61].support_list&&e[61].support_list.length||e[17](e[61]),P,B,A="",U,F,q,N=w&&pn();function H(){return e[31](e[61])}function S(R,x){return R[61].tag_color&&R[61].tag?co:ao}let O=S(e),M=O(e);return{key:l,first:null,c(){t=d("ion-item"),n=d("ion-avatar"),i=d("div"),o=d("div"),a=ye(s),k=T(),v=d("ion-label"),_=d("ion-text"),m=d("h3"),E=ye(p),y=T(),N&&N.c(),P=T(),B=d("div"),B.innerHTML=A,U=T(),M.c(),this.h()},l(R){t=f(R,"ION-ITEM",{});var x=g(t);n=f(x,"ION-AVATAR",{slot:!0});var j=g(n);i=f(j,"DIV",{class:!0,title:!0,style:!0});var Y=g(i);o=f(Y,"DIV",{class:!0});var ie=g(o);a=we(ie,s),ie.forEach(u),Y.forEach(u),j.forEach(u),k=C(x),v=f(x,"ION-LABEL",{button:!0});var be=g(v);_=f(be,"ION-TEXT",{color:!0});var Q=g(_);m=f(Q,"H3",{});var L=g(m);E=we(L,p),y=C(L),N&&N.l(L),L.forEach(u),Q.forEach(u),P=C(be),B=f(be,"DIV",{class:!0,"data-svelte-h":!0}),le(B)!=="svelte-4k5p1b"&&(B.innerHTML=A),be.forEach(u),U=C(x),M.l(x),x.forEach(u),this.h()},h(){V(o,"class","order svelte-1ita8l7"),V(i,"class","order-wrapper svelte-1ita8l7"),V(i,"title",h=rt(e[61].status)),c(i,"background-color",Re(e[61].status,e[61].date_service)),c(i,"color",He(Re(e[61].status))),b(n,"slot","start"),b(_,"color","#2e2e2e"),V(B,"class","sub svelte-1ita8l7"),b(v,"button",""),this.first=t},m(R,x){W(R,t,x),r(t,n),r(n,i),r(i,o),r(o,a),r(t,k),r(t,v),r(v,_),r(_,m),r(m,E),r(m,y),N&&N.m(m,null),r(v,P),r(v,B),r(t,U),M.m(t,null),F||(q=de(v,"click",H),F=!0)},p(R,x){e=R,x[0]&16&&s!==(s=parseInt(e[61].pos)+1+"")&&Ae(a,s),x[0]&16&&h!==(h=rt(e[61].status))&&V(i,"title",h),x[0]&16&&c(i,"background-color",Re(e[61].status,e[61].date_service)),x[0]&16&&c(i,"color",He(Re(e[61].status))),x[0]&16&&p!==(p=e[61].title+"")&&Ae(E,p),x[0]&16&&(w=e[61].support_list&&e[61].support_list.length||e[17](e[61])),w?N||(N=pn(),N.c(),N.m(m,null)):N&&(N.d(1),N=null),O===(O=S(e))&&M?M.p(e,x):(M.d(1),M=O(e),M&&(M.c(),M.m(t,null)))},d(R){R&&u(t),N&&N.d(),M.d(),F=!1,q()}}}function vn(l){let e;return{c(){e=d("span"),this.h()},l(t){e=f(t,"SPAN",{class:!0}),g(e).forEach(u),this.h()},h(){V(e,"class","notes svelte-1ita8l7")},m(t,n){W(t,e,n)},d(t){t&&u(e)}}}function uo(l){let e;return{c(){e=d("ion-icon"),this.h()},l(t){e=f(t,"ION-ICON",{icon:!0,slot:!0,style:!0}),g(e).forEach(u),this.h()},h(){b(e,"icon",Ke),b(e,"slot","end"),c(e,"color",Re(l[61].status,l[61].date_service))},m(t,n){W(t,e,n)},p(t,n){n[0]&16&&c(e,"color",Re(t[61].status,t[61].date_service))},d(t){t&&u(e)}}}function fo(l){let e,t=(l[61].tag?l[61].tag:"")+"",n;return{c(){e=d("div"),n=ye(t),this.h()},l(i){e=f(i,"DIV",{class:!0,slot:!0,style:!0});var o=g(e);n=we(o,t),o.forEach(u),this.h()},h(){V(e,"class","stop-tag"),V(e,"slot","end"),c(e,"background-color",qe(l[61].tag_color,.3)),c(e,"border","1px solid "+qe(l[61].tag_color,.4)),c(e,"color",l[61].tag_color),c(e,"font-size","10px"),c(e,"text-align","center"),c(e,"align-content","center"),c(e,"border-radius","20px"),c(e,"white-space","normal"),c(e,"padding","3px 6px"),c(e,"width","auto",1),c(e,"display","inline-block"),c(e,"font-weight","500")},m(i,o){W(i,e,o),r(e,n)},p(i,o){o[0]&16&&t!==(t=(i[61].tag?i[61].tag:"")+"")&&Ae(n,t),o[0]&16&&c(e,"background-color",qe(i[61].tag_color,.3)),o[0]&16&&c(e,"border","1px solid "+qe(i[61].tag_color,.4)),o[0]&16&&c(e,"color",i[61].tag_color)},d(i){i&&u(e)}}}function gn(l,e){let t,n,i,o,s=parseInt(e[61].pos)+1+"",a,h,k,v,_,m,p=e[61].title+"",E,y,w=e[61].support_list&&e[61].support_list.length||e[17](e[61]),P,B,A="",U,F,q,N=w&&vn();function H(){return e[27](e[61])}function S(R,x){return R[61].tag_color&&R[61].tag?fo:uo}let O=S(e),M=O(e);return{key:l,first:null,c(){t=d("ion-item"),n=d("ion-avatar"),i=d("div"),o=d("div"),a=ye(s),k=T(),v=d("ion-label"),_=d("ion-text"),m=d("h3"),E=ye(p),y=T(),N&&N.c(),P=T(),B=d("div"),B.innerHTML=A,U=T(),M.c(),this.h()},l(R){t=f(R,"ION-ITEM",{});var x=g(t);n=f(x,"ION-AVATAR",{slot:!0});var j=g(n);i=f(j,"DIV",{class:!0,title:!0,style:!0});var Y=g(i);o=f(Y,"DIV",{class:!0});var ie=g(o);a=we(ie,s),ie.forEach(u),Y.forEach(u),j.forEach(u),k=C(x),v=f(x,"ION-LABEL",{button:!0});var be=g(v);_=f(be,"ION-TEXT",{color:!0});var Q=g(_);m=f(Q,"H3",{});var L=g(m);E=we(L,p),y=C(L),N&&N.l(L),L.forEach(u),Q.forEach(u),P=C(be),B=f(be,"DIV",{class:!0,"data-svelte-h":!0}),le(B)!=="svelte-4k5p1b"&&(B.innerHTML=A),be.forEach(u),U=C(x),M.l(x),x.forEach(u),this.h()},h(){V(o,"class","order svelte-1ita8l7"),V(i,"class","order-wrapper svelte-1ita8l7"),V(i,"title",h=rt(e[61].status)),c(i,"background-color",Re(e[61].status,e[61].date_service)),c(i,"color",He(Re(e[61].status))),b(n,"slot","start"),b(_,"color","#2e2e2e"),V(B,"class","sub svelte-1ita8l7"),b(v,"button",""),this.first=t},m(R,x){W(R,t,x),r(t,n),r(n,i),r(i,o),r(o,a),r(t,k),r(t,v),r(v,_),r(_,m),r(m,E),r(m,y),N&&N.m(m,null),r(v,P),r(v,B),r(t,U),M.m(t,null),F||(q=de(v,"click",H),F=!0)},p(R,x){e=R,x[0]&16&&s!==(s=parseInt(e[61].pos)+1+"")&&Ae(a,s),x[0]&16&&h!==(h=rt(e[61].status))&&V(i,"title",h),x[0]&16&&c(i,"background-color",Re(e[61].status,e[61].date_service)),x[0]&16&&c(i,"color",He(Re(e[61].status))),x[0]&16&&p!==(p=e[61].title+"")&&Ae(E,p),x[0]&16&&(w=e[61].support_list&&e[61].support_list.length||e[17](e[61])),w?N||(N=vn(),N.c(),N.m(m,null)):N&&(N.d(1),N=null),O===(O=S(e))&&M?M.p(e,x):(M.d(1),M=O(e),M&&(M.c(),M.m(t,null)))},d(R){R&&u(t),N&&N.d(),M.d(),F=!1,q()}}}function ho(l){let e,t,n,i,o=`<ion-icon icon="${Xn}"></ion-icon>`,s,a,h,k=`<ion-icon icon="${Jn}"></ion-icon>`,v,_,m=`<ion-icon icon="${Yn}"></ion-icon>`,p,E,y=(l[5].name?l[5].name.toUpperCase():"")+"",w,P,B,A='<ion-segment-button value="list"><ion-label>Paradas</ion-label></ion-segment-button> <ion-segment-button value="map"><ion-label>Mapa</ion-label></ion-segment-button>',U,F,q,N;function H(M,R){if(M[8]==="list")return to;if(M[8]==="map")return eo}let S=H(l),O=S&&S(l);return{c(){e=d("ion-header"),t=d("ion-toolbar"),n=d("ion-buttons"),i=d("ion-button"),i.innerHTML=o,s=T(),a=d("ion-buttons"),h=d("ion-button"),h.innerHTML=k,v=T(),_=d("ion-button"),_.innerHTML=m,p=T(),E=d("ion-title"),w=ye(y),P=T(),B=d("ion-segment"),B.innerHTML=A,U=T(),O&&O.c(),F=xe(),this.h()},l(M){e=f(M,"ION-HEADER",{translucent:!0});var R=g(e);t=f(R,"ION-TOOLBAR",{});var x=g(t);n=f(x,"ION-BUTTONS",{slot:!0});var j=g(n);i=f(j,"ION-BUTTON",{title:!0,alt:!0,"data-svelte-h":!0}),le(i)!=="svelte-1a21unf"&&(i.innerHTML=o),j.forEach(u),s=C(x),a=f(x,"ION-BUTTONS",{slot:!0});var Y=g(a);h=f(Y,"ION-BUTTON",{"data-svelte-h":!0}),le(h)!=="svelte-dy3728"&&(h.innerHTML=k),v=C(Y),_=f(Y,"ION-BUTTON",{"data-svelte-h":!0}),le(_)!=="svelte-1omw1hr"&&(_.innerHTML=m),Y.forEach(u),p=C(x),E=f(x,"ION-TITLE",{});var ie=g(E);w=we(ie,y),ie.forEach(u),x.forEach(u),P=C(R),B=f(R,"ION-SEGMENT",{value:!0,"data-svelte-h":!0}),le(B)!=="svelte-1rseadq"&&(B.innerHTML=A),R.forEach(u),U=C(M),O&&O.l(M),F=xe(),this.h()},h(){b(i,"title","Atrás"),b(i,"alt","Atrás"),b(n,"slot","start"),b(a,"slot","end"),b(B,"value","list"),b(e,"translucent","")},m(M,R){W(M,e,R),r(e,t),r(t,n),r(n,i),r(t,s),r(t,a),r(a,h),r(a,v),r(a,_),r(t,p),r(t,E),r(E,w),r(e,P),r(e,B),W(M,U,R),O&&O.m(M,R),W(M,F,R),q||(N=[de(i,"click",l[18]),de(h,"click",l[22]),de(_,"click",l[23]),de(B,"ionChange",l[24])],q=!0)},p(M,R){R[0]&32&&y!==(y=(M[5].name?M[5].name.toUpperCase():"")+"")&&Ae(w,y),S===(S=H(M))&&O?O.p(M,R):(O&&O.d(1),O=S&&S(M),O&&(O.c(),O.m(F.parentNode,F)))},d(M){M&&(u(e),u(U),u(F)),O&&O.d(M),q=!1,ze(N)}}}function bn(l){let e,t='<ion-spinner name="dots" style="color:white;"></ion-spinner>';return{c(){e=d("div"),e.innerHTML=t,this.h()},l(n){e=f(n,"DIV",{class:!0,style:!0,"data-svelte-h":!0}),le(e)!=="svelte-1aosxw0"&&(e.innerHTML=t),this.h()},h(){V(e,"class","overlay"),c(e,"position","fixed"),c(e,"top","0"),c(e,"left","0"),c(e,"width","100vw"),c(e,"height","100vh"),c(e,"background","rgba(0, 0, 0, 0.5)"),c(e,"display","flex"),c(e,"align-items","center"),c(e,"justify-content","center"),c(e,"z-index","9999")},m(n,i){W(n,e,i)},d(n){n&&u(e)}}}function _o(l){let e,t,n,i,o=l[1]&&dn(l),s=l[10]&&bn();return{c(){e=T(),o&&o.c(),t=T(),s&&s.c(),n=xe(),this.h()},l(a){Pn("svelte-kn0kph",sn.head).forEach(u),e=C(a),o&&o.l(a),t=C(a),s&&s.l(a),n=xe(),this.h()},h(){sn.title="Rutaflow - Detalles de ruta"},m(a,h){W(a,e,h),o&&o.m(a,h),W(a,t,h),s&&s.m(a,h),W(a,n,h),i=!0},p(a,h){a[1]?o?(o.p(a,h),h[0]&2&&et(o,1)):(o=dn(a),o.c(),et(o,1),o.m(t.parentNode,t)):o&&(xn(),lt(o,1,1,()=>{o=null}),Dn()),a[10]?s||(s=bn(),s.c(),s.m(n.parentNode,n)):s&&(s.d(1),s=null)},i(a){i||(et(o),i=!0)},o(a){lt(o),i=!1},d(a){a&&(u(e),u(t),u(n)),o&&o.d(a),s&&s.d(a)}}}function Re(l,e=""){let t="#ffffff";return l==="pending"&&!e?t="#f2e300":l=="pending"&&e?t="#F6A833":l==="completed"&&(t="#44d900"),t}function rt(l){let e="";return l=="pending"?e="Pendiente":l=="completed"&&(e="Completado"),e}function He(l){if(!l)return"#414040";l.slice(0,1)==="#"&&(l=l.slice(1)),l.length===3&&(l=l.split("").map(function(o){return o+o}).join(""));const e=parseInt(l.substr(0,2),16),t=parseInt(l.substr(2,2),16),n=parseInt(l.substr(4,2),16);return(e*299+t*587+n*114)/1e3>=128?"#414040":"#fff"}function _t(l,e){for(let t=0;t<e.length;t++)if(e[t].alias===l)return e[t].val;return""}const po=l=>l.mandatory==="1",mo=l=>l.img;function vo(l,e,t){let n;An(l,Qn,I=>t(21,n=I));var i=this&&this.__awaiter||function(I,D,z,X){function pe(Ne){return Ne instanceof z?Ne:new z(function(ve){ve(Ne)})}return new(z||(z=Promise))(function(Ne,ve){function Pe(De){try{Ve(X.next(De))}catch(We){ve(We)}}function Be(De){try{Ve(X.throw(De))}catch(We){ve(We)}}function Ve(De){De.done?Ne(De.value):pe(De.value).then(Pe,Be)}Ve((X=X.apply(I,D||[])).next())})};let{routeId:o}=e,{driverId:s}=e,a=dt,h=new Object,k=!0,v=!1,_=[],m=[],p={},E=[],y=[],w,P=!1,B="list",A,U="",F="",q="",N="0",H=new Object,S="",O=!1,M=!1;const R={car_accident:"/car-accident.svg",restaurant:"/restaurant.svg",parking:"/parking.svg",hospital:"/hospital.svg",wc:"/toilet.svg",traffic:"/traffic.svg"},x=()=>i(void 0,void 0,void 0,function*(){yield re(o),w.complete()});tt(()=>i(void 0,void 0,void 0,function*(){Oe(),yield re(o)}));function j(){const I=(E||[]).filter(D=>D.mandatory==="1");return I.length?!I.every(D=>!!D.img):!1}function Y(){const I=v||(p==null?void 0:p.km_inicial)==="0"||(p==null?void 0:p.gas_inicial)==="0",D=j();return I||D}function ie(){return!Y()}function be(){return i(this,void 0,void 0,function*(){return M||!Y()?!0:new Promise(I=>i(this,void 0,void 0,function*(){yield(yield Xe.create({header:"Checklist",message:"Favor de completar checklist para iniciar viaje ✅",buttons:[{text:"Previsualizar",role:"cancel",handler:()=>{M=!0,I(!0)}},{text:"Completar",handler:()=>{M=!0,ne(E,s,o),I(!1)}}]})).present()}))})}function Q(I){return i(this,void 0,void 0,function*(){if((yield be())&&(t(8,B=I),B==="map")){yield wt(),A=document.getElementById("g_map");const z=new google.maps.Map(A,{zoom:8,center:{lat:20.6745683,lng:-103.3986104},mapId:"4504f8b37365c3d0"}),X=new google.maps.LatLngBounds,{AdvancedMarkerElement:pe,PinElement:Ne}=yield google.maps.importLibrary("marker");navigator.geolocation?navigator.geolocation.getCurrentPosition(function(ve){const Pe=new google.maps.LatLng(ve.coords.latitude,ve.coords.longitude);new google.maps.Marker({position:Pe,map:z,icon:{path:google.maps.SymbolPath.CIRCLE,fillColor:"#0062ff",fillOpacity:1,scale:6,strokeColor:"#ffffff",strokeWeight:2}}),new google.maps.Circle({strokeColor:"#00BFFF",strokeOpacity:.5,strokeWeight:1,fillColor:"#00BFFF",fillOpacity:.2,map:z,center:Pe,radius:ve.coords.accuracy}),X.extend(Pe)},function(ve){console.error("Error retrieving location:",ve)}):console.error("Geolocation not supported by this browser."),p.lat1===p.lat2&&p.lon1===p.lon2?L(X,z,{lat:p.lat2,lon:p.lon2,color:p.color,title:p.destination},{type:"icon",iconClass:"icon-home",title:"Origen/Destino",glyph:`0,${String(_.length+1)}`}):(L(X,z,{lat:p.lat1,lon:p.lon1,color:p.color,title:p.origin},{type:"icon",iconClass:"icon-home",title:"Origen",glyph:"0"}),L(X,z,{lat:p.lat2,lon:p.lon2,color:p.color,title:p.destination},{type:"icon",iconClass:"icon-flag",title:"Destino",glyph:String(_.length+1)})),_.forEach(ve=>{const Pe=parseFloat(ve.lat),Be=parseFloat(ve.lon),Ve=new google.maps.LatLng(Pe,Be),De=new google.maps.Marker({position:{lat:Pe,lng:Be},map:z,title:ve.title}),We=new Ne({background:Re(ve.status,ve.date_service),borderColor:"#000",glyphColor:"#000",glyph:(parseInt(ve.pos)+1).toString()});new pe({map:z,position:Ve,content:We.element,title:"Parada "+(parseInt(ve.pos)+1).toString()+": "+ve.title}).addListener("click",function(){se(ve,!1)}),X.extend(De.getPosition())}),m.forEach(ve=>{const Pe=+ve.lat,Be=+ve.lng;if(isNaN(Pe)||isNaN(Be))return;const Ve=R[ve.type]||"alert-sharp",De=document.createElement("div");De.style.cssText="display:flex;align-items:center;justify-content:center;transform:scale(.85);";const We=document.createElement("ion-icon");Ve.startsWith("/")?We.setAttribute("src",Ve):We.setAttribute("icon",Ve),We.style.cssText="font-size:20px;color:#d13434;",De.appendChild(We);const it=new Ne({background:"#fff",borderColor:"#000",glyph:De}),ft=new pe({map:z,position:{lat:Pe,lng:Be},content:it.element,title:ve.motive||ve.type});X.extend(ft.position)}),z.fitBounds(X)}})}function L(I,D,z,X){return i(this,void 0,void 0,function*(){let pe;const Ne=parseFloat(z.lat),ve=parseFloat(z.lon),Pe=new google.maps.LatLng(Ne,ve),{AdvancedMarkerElement:Be,PinElement:Ve}=yield google.maps.importLibrary("marker");X.type=="icon"?(pe=document.createElement("i"),pe.className=`${X.iconClass} icon`,pe.style.fontSize="14px",pe.style.color=He(z.color),pe.style.fontWeight="600"):X.type=="text";const De=new google.maps.Marker({position:{lat:Ne,lng:ve},map:D,title:`${X.title}. ${z.title}`}),We=new Ve({background:z.color,borderColor:"#000",glyphColor:He(z.color),glyph:X.glyph});return new Be({map:D,position:Pe,content:We.element,title:X.title+": "+z.title}).addListener("click",function(){oe(p,X.title=="Destino"||X.title=="Origen/Destino")}),De})}function re(I){return i(this,void 0,void 0,function*(){let D=new FormData;D.append("id_route",I),D=me(D),D.append("id_enterprise",h.id_enterprise);try{const X=yield(yield fetch(`${a}api/admin/report/seguimiento_list.php`,{method:"POST",body:D})).json();t(5,p=X.data.seguimiento_list[0]),t(4,_=X.data.event_list),t(6,E=X.data.checklist),y=X.data.expenses,m=X.data.incidence_list,p&&t(3,v=p.km_inicial=="0"&&p.gas_inicial=="0"),!M&&Y()&&(yield be()),t(2,k=!1)}catch(z){t(2,k=!1),console.error("Error fetching data:",z)}})}const he=I=>new Promise((D,z)=>{let X=new FormData;X.append("id_route",I.id_route),X.append("id_event",I.id_event),X=me(X),fetch(`${a}api/admin/evidence/evidence_by_event.php`,{method:"POST",body:X}).then(pe=>pe.json()).then(pe=>{D(pe.data.event_evidence[0])}).catch(pe=>{console.error("Error fetching data:",pe),z(pe)})});function se(I,D,z){const X=typeof z=="boolean"?z:!ie();return S||(S=i(this,void 0,void 0,function*(){let pe=null;try{pe=yield he(I)}catch{}const Ne=Object.assign(Object.assign(Object.assign({},I),{stopsApproval:U,smsActive:F,signatureActive:q}),pe||{});try{yield Je("modal-delivery-info",qt,{delivery:Ne,isLast:D,readOnly:X})}finally{S=null,re(o)}}),S)}const oe=(I,D)=>{let z={};D?z={title:I.destination,line1:I.dest_address}:z={title:I.origin,line1:I.origin_address},z.enterprise_name=I.enterprise_name,z.client_name=I.client_name,z.client_phone=I.tel,z.id_route=I.id_route,z.stopsApproval=U,z.smsActive=F,Je("modal-delivery-info",qt,{delivery:z,isLast:D,flag:!0,readOnly:!ie()})},ne=(I,D,z)=>(t(10,O=!0),P||(P=!0,Je("modal-checklist",Ln,{checklist:I,driverId:D,routeId:z,isLast:!1},{breakpoints:[.25,.5,.9],initialBreakpoint:.75,backdropBreakpoint:.25,handle:!0,handleBehavior:"cycle",canDismiss:!0,showBackdrop:!0}).then(()=>{t(10,O=!1),P=!1,re(z)})),""),fe=I=>i(void 0,void 0,void 0,function*(){return t(10,O=!0),yield re(I),y.length>0?Je("modal-expense-detail",$i,{routeId:I,expenses:y}).then(()=>{t(10,O=!1)}):Je("modal-expense",It,{routeId:I}).then(()=>{t(10,O=!1)}),""}),ue=I=>i(void 0,void 0,void 0,function*(){return t(10,O=!0),yield re(I),Je("modal-incidence",Xi,{routeId:I}).then(()=>{t(10,O=!1)}),""}),ae=I=>{if(I.tracking_type=="subscription"){if(I.subscriber_info&&I.payment_type==="cash"&&new Date(I.subscriber_info.payment_next)<new Date)return!0}else if(I.tracking_type=="ecommerce"&&Number(I.payment_pending)>0)return!0;return!1},te=()=>{h.type=="super"||h.type=="admin"?at("/drivers/me"):h.id_driver&&at(`/drivers/${h.id_driver}`)},ke=(I,D)=>i(void 0,void 0,void 0,function*(){yield(yield Xe.create({header:I||"Error",message:D||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()});function me(I){return I.append("token",h.token),I.append("id_user_over",h.id_user),I}const Oe=()=>i(void 0,void 0,void 0,function*(){if(h.id_enterprise){let I=new FormData;I.append("id_enterprise",h.id_enterprise),I=me(I);try{const D=yield fetch(`${a}api/admin/enterprise/enterprise_settings.php`,{method:"POST",body:I});D.ok?(H=(yield D.json()).nodos,U=_t("stops_wait_approval",H),F=_t("sms_active",H),t(9,N=_t("stops_order_restriction",H)),q=_t("signature_active",H)):console.error("File upload failed:",D.statusText)}catch(D){console.error("Error during file upload:",D)}}}),$=()=>ue(o),ee=()=>fe(o),G=I=>Q(I.detail.value);function ce(I){Ue[I?"unshift":"push"](()=>{w=I,t(7,w)})}const Ie=()=>{oe(p,!1)},K=I=>{const D=_.findIndex(ve=>ve.id_event===I.id_event),z=D===0,X=D>0?_[D-1]:null,pe=z||X&&X.img!==null,Ne=I.img!==null&&I.img!=="";pe||z&&!Ne||N=="1"?se(I,!1):ke("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")},Ee=()=>{oe(p,!0)};function Se(I){Ue[I?"unshift":"push"](()=>{w=I,t(7,w)})}const Me=()=>{oe(p,!1)},Ce=I=>{const D=_.findIndex(ve=>ve.id_event===I.id_event),z=D===0,X=D>0?_[D-1]:null,pe=z||X&&X.img!==null,Ne=I.img!==null&&I.img!=="";pe||z&&!Ne||N=="1"?se(I,!1):ke("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")},J=()=>{oe(p,!0)};function Z(I){Ue[I?"unshift":"push"](()=>{w=I,t(7,w)})}const ge=()=>{oe(p,!1)},_e=I=>{const D=_.findIndex(ve=>ve.id_event===I.id_event),z=D===0,X=D>0?_[D-1]:null,pe=z||X&&X.img!==null,Ne=I.img!==null&&I.img!=="";pe||z&&!Ne||N=="1"?se(I,!1):ke("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")},Te=()=>{oe(p,!0)};return l.$$set=I=>{"routeId"in I&&t(0,o=I.routeId),"driverId"in I&&t(20,s=I.driverId)},l.$$.update=()=>{l.$$.dirty[0]&2097155&&(t(0,{routeId:o,driverId:s}=n.params,o,(t(20,s),t(21,n),t(1,h),t(0,o))),t(1,h=JSON.parse(localStorage.getItem("userSession"))),h?h.id_user&&(h.type=="admin"||h.type=="super")?(re(o),at(`/drivers/me/routes/${o}`)):h.id_user&&h.id_driver&&(re(o),at(`/drivers/${h.id_driver}/routes/${o}`)):at("/"))},[o,h,k,v,_,p,E,w,B,N,O,x,Q,se,oe,fe,ue,ae,te,ke,s,n,$,ee,G,ce,Ie,K,Ee,Se,Me,Ce,J,Z,ge,_e,Te]}class wo extends Ze{constructor(e){super(),$e(this,e,vo,_o,Qe,{routeId:0,driverId:20},null,[-1,-1,-1])}}export{wo as component};

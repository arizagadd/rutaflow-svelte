import{Z as Et,s as xe,e as c,j as N,b as u,q as E,d as Q,h as a,m as T,v as p,i as H,w as i,x as oe,n as Ne,z as Ge,_ as sn,B as j,o as lt,k as Re,$ as It,t as ue,r as fe,f as Z,a0 as cn,a1 as ot,A as Be,y as Ae,a2 as dt,l as un,p as fn,F as _n}from"../chunks/index.BzUyNcuj.js";import{S as $e,i as et,t as _t,a as mt,c as dn,b as hn,d as pn,m as mn,e as vn,g as gn}from"../chunks/index.D9GPdhpm.js";import{e as qe,u as it,d as rt,a as bn,c as vt,b as nn,f as En,g as In,i as on,h as kn,j as ln,k as On,m as Nn,s as kt,n as tt,o as Tn,q as Cn,r as yn,t as wn,v as Ln,w as Sn,p as Mn}from"../chunks/index.Ck0_1-DO.js";import"../chunks/index-6e05b96e.C_9q9BoX.js";import{m as at,a as We,I as Pn}from"../chunks/IonPage.xQ4lM5iK.js";import{q as An,t as Bn}from"../chunks/ion-modal.BYMRzj9z.js";import{g as Xe}from"../chunks/entry.zY2rL7Aj.js";const Dn=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global,zn=(l,e)=>{if(!customElements.get(l)){class t extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const n={};for(const r of this.attributes)n[r.name]=r.value;new e({target:this.shadowRoot,props:n})}}customElements.define(l,t)}},Hn=function(l){return document.createElement(l).constructor!==HTMLElement},Rn=(l,e)=>{Hn(l)||zn(l,e)},Ke=async(l,e,t)=>{An(),Bn(),Rn(l,e);const o=await at.create({component:l,componentProps:t});return o.present(),await o.onWillDismiss()};let Qe=Et({km_inicial:[],gas_inicial:[],km_final:[],gas_final:[]}),rn=Et({flag:[]});function Un(l){let e,t,o,n,r="Cancelar",d,_,g="Captura de Km/Gas",O,k,f,s="Confirmar",b,h,v,m,w,y,z;return{c(){e=c("ion-header"),t=c("ion-toolbar"),o=c("ion-buttons"),n=c("ion-button"),n.textContent=r,d=N(),_=c("ion-title"),_.textContent=g,O=N(),k=c("ion-buttons"),f=c("ion-button"),f.textContent=s,b=N(),h=c("ion-content"),v=c("ion-item"),m=c("ion-input"),this.h()},l(A){e=u(A,"ION-HEADER",{translucent:!0});var R=E(e);t=u(R,"ION-TOOLBAR",{});var C=E(t);o=u(C,"ION-BUTTONS",{slot:!0});var L=E(o);n=u(L,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),Q(n)!=="svelte-17pq4f4"&&(n.textContent=r),L.forEach(a),d=T(C),_=u(C,"ION-TITLE",{"data-svelte-h":!0}),Q(_)!=="svelte-1yhkaq7"&&(_.textContent=g),O=T(C),k=u(C,"ION-BUTTONS",{slot:!0});var M=E(k);f=u(M,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),Q(f)!=="svelte-cm6j4s"&&(f.textContent=s),M.forEach(a),C.forEach(a),R.forEach(a),b=T(A),h=u(A,"ION-CONTENT",{fullscreen:!0});var I=E(h);v=u(I,"ION-ITEM",{});var B=E(v);m=u(B,"ION-INPUT",{class:!0,inputmode:!0,pattern:!0,type:!0,placeholder:!0,value:!0,required:!0});var F=E(m);F.forEach(a),B.forEach(a),I.forEach(a),this.h()},h(){p(n,"color","medium"),p(o,"slot","start"),p(f,"strong",""),p(k,"slot","end"),p(e,"translucent",""),p(m,"class","fin-km"),p(m,"inputmode","numeric"),p(m,"pattern","[0-9]*"),p(m,"type","number"),p(m,"placeholder",w="Ingresa "+l[0]+" actual"),p(m,"value",l[1]),p(m,"required",""),p(h,"fullscreen","")},m(A,R){H(A,e,R),i(e,t),i(t,o),i(o,n),i(t,d),i(t,_),i(t,O),i(t,k),i(k,f),H(A,b,R),H(A,h,R),i(h,v),i(v,m),y||(z=[oe(n,"click",l[2]),oe(f,"click",l[3]),oe(m,"input",l[4])],y=!0)},p(A,[R]){R&1&&w!==(w="Ingresa "+A[0]+" actual")&&p(m,"placeholder",w),R&2&&p(m,"value",A[1])},i:Ne,o:Ne,d(A){A&&(a(e),a(b),a(h)),y=!1,Ge(z)}}}function Fn(l,e,t){const o=sn();let n=document.querySelector("ion-modal"),r=n.componentProps.data_type;n.componentProps.isLast;let d;rn.subscribe(f=>{r=f.flag[0],r=="km_final"||r=="km_inicial"?t(0,d="kilometraje"):t(0,d="litros de gasolina")});let _=0;function g(){at.dismiss()}function O(){o("modalResult",{data:"Your data",role:"confirm"}),r=="km_inicial"?Qe.update(s=>({...s,km_inicial:[_]})):r=="gas_inicial"?Qe.update(s=>({...s,gas_inicial:[_]})):r=="km_final"?Qe.update(s=>({...s,km_final:[_]})):r=="gas_final"&&Qe.update(s=>({...s,gas_final:[_]})),g()}return[d,_,g,O,f=>t(1,_=f.target.value)]}class qn extends $e{constructor(e){super(),et(this,e,Fn,Un,xe,{})}}const ht=Et({items:[],checkedIndices:[],mandatory:[]});function wt(l,e,t){const o=l.slice();return o[51]=e[t],o[52]=e,o[53]=t,o}function jn(l){let e,t,o,n,r,d="Kilometraje inicial",_,g,O=l[0]?l[0]+" km.":"Cargar km",k,f,s,b,h,v,m,w="Gasolina inicial (litros)",y,z,A=l[1]?l[1]+" litros":"Cargar gas",R,C,L,M;return C=It(l[21][0]),{c(){e=c("ion-item"),t=c("ion-label"),o=c("input"),n=N(),r=c("p"),r.textContent=d,_=N(),g=c("ion-button"),k=ue(O),f=N(),s=c("ion-item"),b=c("ion-label"),h=c("input"),v=N(),m=c("p"),m.textContent=w,y=N(),z=c("ion-button"),R=ue(A),this.h()},l(I){e=u(I,"ION-ITEM",{});var B=E(e);t=u(B,"ION-LABEL",{style:!0});var F=E(t);o=u(F,"INPUT",{id:!0,style:!0,type:!0}),n=T(F),r=u(F,"P",{style:!0,"data-svelte-h":!0}),Q(r)!=="svelte-88twxi"&&(r.textContent=d),F.forEach(a),_=T(B),g=u(B,"ION-BUTTON",{fill:!0,size:!0,class:!0,"aria-selected":!0});var P=E(g);k=fe(P,O),P.forEach(a),B.forEach(a),f=T(I),s=u(I,"ION-ITEM",{});var V=E(s);b=u(V,"ION-LABEL",{style:!0});var G=E(b);h=u(G,"INPUT",{id:!0,style:!0,type:!0}),v=T(G),m=u(G,"P",{style:!0,"data-svelte-h":!0}),Q(m)!=="svelte-1ux30eb"&&(m.textContent=w),G.forEach(a),y=T(V),z=u(V,"ION-BUTTON",{fill:!0,class:!0,size:!0,style:!0});var W=E(z);R=fe(W,A),W.forEach(a),V.forEach(a),this.h()},h(){Z(o,"id","chkbox-km-ini"),j(o,"pointer-events","auto"),Z(o,"type","checkbox"),o.required=!0,j(r,"margin-left","10px"),j(t,"display","flex"),p(g,"fill","outline"),p(g,"size","small"),p(g,"class","loadKmInicial"),p(g,"aria-selected",""),Z(h,"id","chkbox-gas-ini"),j(h,"pointer-events","auto"),Z(h,"type","checkbox"),h.required=!0,j(m,"margin-left","10px"),j(b,"display","flex"),p(z,"fill","outline"),p(z,"class","loadGasInicial"),p(z,"size","small"),j(z,"height","16px "),C.p(o,h)},m(I,B){H(I,e,B),i(e,t),i(t,o),o.checked=~(l[4]||[]).indexOf(o.__value),l[28](o),i(t,n),i(t,r),i(e,_),i(e,g),i(g,k),H(I,f,B),H(I,s,B),i(s,b),i(b,h),l[30](h),h.checked=~(l[4]||[]).indexOf(h.__value),i(b,v),i(b,m),i(s,y),i(s,z),i(z,R),L||(M=[oe(o,"change",l[27]),oe(g,"click",l[29]),oe(h,"change",l[31]),oe(z,"click",l[32])],L=!0)},p(I,B){B[0]&16&&(o.checked=~(I[4]||[]).indexOf(o.__value)),B[0]&1&&O!==(O=I[0]?I[0]+" km.":"Cargar km")&&Ae(k,O),B[0]&16&&(h.checked=~(I[4]||[]).indexOf(h.__value)),B[0]&2&&A!==(A=I[1]?I[1]+" litros":"Cargar gas")&&Ae(R,A)},d(I){I&&(a(e),a(f),a(s)),l[28](null),l[30](null),C.r(),L=!1,Ge(M)}}}function Vn(l){let e,t,o,n,r,d="Kilometraje final",_,g,O=l[2]?l[2]+" km.":"Cargar km",k,f,s,b,h,v,m,w="Gasolina final (litros)",y,z,A=l[3]?l[3]+" litros":"Cargar gas",R,C,L,M;return C=It(l[21][0]),{c(){e=c("ion-item"),t=c("ion-label"),o=c("input"),n=N(),r=c("p"),r.textContent=d,_=N(),g=c("ion-button"),k=ue(O),f=N(),s=c("ion-item"),b=c("ion-label"),h=c("input"),v=N(),m=c("p"),m.textContent=w,y=N(),z=c("ion-button"),R=ue(A),this.h()},l(I){e=u(I,"ION-ITEM",{});var B=E(e);t=u(B,"ION-LABEL",{style:!0});var F=E(t);o=u(F,"INPUT",{id:!0,style:!0,type:!0}),n=T(F),r=u(F,"P",{style:!0,"data-svelte-h":!0}),Q(r)!=="svelte-ccmu71"&&(r.textContent=d),F.forEach(a),_=T(B),g=u(B,"ION-BUTTON",{fill:!0,size:!0,class:!0,"aria-selected":!0});var P=E(g);k=fe(P,O),P.forEach(a),B.forEach(a),f=T(I),s=u(I,"ION-ITEM",{});var V=E(s);b=u(V,"ION-LABEL",{style:!0});var G=E(b);h=u(G,"INPUT",{id:!0,style:!0,type:!0}),v=T(G),m=u(G,"P",{style:!0,"data-svelte-h":!0}),Q(m)!=="svelte-wsoyd2"&&(m.textContent=w),G.forEach(a),y=T(V),z=u(V,"ION-BUTTON",{fill:!0,size:!0,class:!0});var W=E(z);R=fe(W,A),W.forEach(a),V.forEach(a),this.h()},h(){Z(o,"id","chkbox-km-fin"),j(o,"pointer-events","auto"),Z(o,"type","checkbox"),o.required=!0,j(r,"margin-left","10px"),j(t,"display","flex"),p(g,"fill","outline"),p(g,"size","small"),p(g,"class","loadKmInicial"),p(g,"aria-selected",""),Z(h,"id","chkbox-gas-fin"),j(h,"pointer-events","auto"),Z(h,"type","checkbox"),h.required=!0,j(m,"margin-left","10px"),j(b,"display","flex"),p(z,"fill","outline"),p(z,"size","small"),p(z,"class","loadGasInicial"),C.p(o,h)},m(I,B){H(I,e,B),i(e,t),i(t,o),o.checked=~(l[4]||[]).indexOf(o.__value),l[22](o),i(t,n),i(t,r),i(e,_),i(e,g),i(g,k),H(I,f,B),H(I,s,B),i(s,b),i(b,h),h.checked=~(l[4]||[]).indexOf(h.__value),l[25](h),i(b,v),i(b,m),i(s,y),i(s,z),i(z,R),L||(M=[oe(o,"change",l[20]),oe(g,"click",l[23]),oe(h,"change",l[24]),oe(z,"click",l[26])],L=!0)},p(I,B){B[0]&16&&(o.checked=~(I[4]||[]).indexOf(o.__value)),B[0]&4&&O!==(O=I[2]?I[2]+" km.":"Cargar km")&&Ae(k,O),B[0]&16&&(h.checked=~(I[4]||[]).indexOf(h.__value)),B[0]&8&&A!==(A=I[3]?I[3]+" litros":"Cargar gas")&&Ae(R,A)},d(I){I&&(a(e),a(f),a(s)),l[22](null),l[25](null),C.r(),L=!1,Ge(M)}}}function Gn(l){let e=[],t=new Map,o,n=qe(l[13]);const r=d=>d[51].id_checklist_event;for(let d=0;d<n.length;d+=1){let _=wt(l,n,d),g=r(_);t.set(g,e[d]=Lt(g,_))}return{c(){for(let d=0;d<e.length;d+=1)e[d].c();o=Re()},l(d){for(let _=0;_<e.length;_+=1)e[_].l(d);o=Re()},m(d,_){for(let g=0;g<e.length;g+=1)e[g]&&e[g].m(d,_);H(d,o,_)},p(d,_){_[0]&407664&&(n=qe(d[13]),e=it(e,_,r,1,d,n,t,o.parentNode,rt,Lt,o,wt))},d(d){d&&a(o);for(let _=0;_<e.length;_+=1)e[_].d(d)}}}function Kn(l){let e,t=(l[12][l[51].id_checklist_event]?l[12][l[51].id_checklist_event]:"Cargar evidencia")+"",o;return{c(){e=c("label"),o=ue(t),this.h()},l(n){e=u(n,"LABEL",{for:!0,class:!0});var r=E(e);o=fe(r,t),r.forEach(a),this.h()},h(){Z(e,"for","chklist-"+l[51].id_checklist_event),Z(e,"class","button-label svelte-1ruehls")},m(n,r){H(n,e,r),i(e,o)},p(n,r){r[0]&4096&&t!==(t=(n[12][n[51].id_checklist_event]?n[12][n[51].id_checklist_event]:"Cargar evidencia")+"")&&Ae(o,t)},d(n){n&&a(e)}}}function Wn(l){let e;return{c(){e=c("ion-spinner"),this.h()},l(t){e=u(t,"ION-SPINNER",{name:!0,class:!0}),E(e).forEach(a),this.h()},h(){p(e,"name","dots"),p(e,"class","button-spinner svelte-1ruehls")},m(t,o){H(t,e,o)},p:Ne,d(t){t&&a(e)}}}function Lt(l,e){let t,o,n,r=e[51],d,_,g=e[51].item+"",O,k,f,s=e[51].mandatory=="1"?" * ":"",b,h,v,m,w,y,z,A,R,C;const L=()=>e[34](n,r),M=()=>e[34](null,r);function I(){return e[35](e[51])}function B(G,W){return G[11][G[51].id_checklist_event]?Wn:Kn}let F=B(e),P=F(e);function V(...G){return e[37](e[51],...G)}return A=It(e[21][0]),{key:l,first:null,c(){t=c("ion-item"),o=c("ion-label"),n=c("input"),d=N(),_=c("p"),O=ue(g),k=N(),f=c("b"),b=ue(s),h=N(),v=c("ion-button"),m=c("div"),P.c(),w=N(),y=c("input"),z=N(),this.h()},l(G){t=u(G,"ION-ITEM",{});var W=E(t);o=u(W,"ION-LABEL",{style:!0});var $=E(o);n=u($,"INPUT",{id:!0,style:!0,type:!0}),d=T($),_=u($,"P",{style:!0});var Ee=E(_);O=fe(Ee,g),k=T(Ee),Ee.forEach(a),f=u($,"B",{style:!0});var ie=E(f);b=fe(ie,s),ie.forEach(a),$.forEach(a),h=T(W),v=u(W,"ION-BUTTON",{fill:!0,class:!0,size:!0});var he=E(v);m=u(he,"DIV",{class:!0});var Oe=E(m);P.l(Oe),w=T(Oe),y=u(Oe,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0}),Oe.forEach(a),he.forEach(a),z=T(W),W.forEach(a),this.h()},h(){Z(n,"id",`chkbox-${e[51].id_checklist_event}`),j(n,"pointer-events","auto"),Z(n,"type","checkbox"),n.__value=e[51].id_checklist_event,cn(n,n.__value),n.required=!0,j(_,"margin-left","10px"),j(f,"margin-left","5px"),j(o,"display","flex"),j(y,"display","none"),Z(y,"id","chklist-"+e[51].id_checklist_event),Z(y,"name","fileToUpload"),Z(y,"type","file"),Z(y,"accept","image/*"),Z(m,"class","button-content svelte-1ruehls"),p(v,"fill","outline"),p(v,"class","loadEvidence svelte-1ruehls"),p(v,"size","small"),A.p(n),this.first=t},m(G,W){H(G,t,W),i(t,o),i(o,n),n.checked=~(e[4]||[]).indexOf(n.__value),L(),i(o,d),i(o,_),i(_,O),i(_,k),i(o,f),i(f,b),i(t,h),i(t,v),i(v,m),P.m(m,null),i(m,w),i(m,y),e[36](y),i(t,z),R||(C=[oe(n,"change",e[33]),oe(n,"change",I),oe(y,"change",V)],R=!0)},p(G,W){e=G,W[0]&16&&(n.checked=~(e[4]||[]).indexOf(n.__value)),r!==e[51]&&(M(),r=e[51],L()),F===(F=B(e))&&P?P.p(e,W):(P.d(1),P=F(e),P&&(P.c(),P.m(m,w)))},d(G){G&&a(t),M(),P.d(),e[36](null),A.r(),R=!1,Ge(C)}}}function Xn(l){let e,t,o,n,r="Cancelar",d,_,g="REQUERIMIENTOS DE RUTA",O,k,f,s,b,h,v,m="Confirmar",w,y;function z(L,M){return L[14]?Vn:jn}let R=z(l)(l),C=l[13]&&Gn(l);return{c(){e=c("ion-header"),t=c("ion-toolbar"),o=c("ion-buttons"),n=c("ion-button"),n.textContent=r,d=N(),_=c("ion-title"),_.textContent=g,O=N(),k=c("ion-content"),f=c("ion-list"),R.c(),s=N(),C&&C.c(),b=N(),h=c("ion-footer"),v=c("ion-button"),v.textContent=m,this.h()},l(L){e=u(L,"ION-HEADER",{translucent:!0});var M=E(e);t=u(M,"ION-TOOLBAR",{});var I=E(t);o=u(I,"ION-BUTTONS",{slot:!0});var B=E(o);n=u(B,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),Q(n)!=="svelte-1dnmkxs"&&(n.textContent=r),B.forEach(a),d=T(I),_=u(I,"ION-TITLE",{"data-svelte-h":!0}),Q(_)!=="svelte-19bar5p"&&(_.textContent=g),I.forEach(a),M.forEach(a),O=T(L),k=u(L,"ION-CONTENT",{fullscreen:!0});var F=E(k);f=u(F,"ION-LIST",{});var P=E(f);R.l(P),s=T(P),C&&C.l(P),P.forEach(a),F.forEach(a),b=T(L),h=u(L,"ION-FOOTER",{});var V=E(h);v=u(V,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),Q(v)!=="svelte-g82qqw"&&(v.textContent=m),V.forEach(a),this.h()},h(){p(n,"color","medium"),p(o,"slot","start"),p(e,"translucent",""),p(k,"fullscreen",""),p(v,"fill","outline"),p(v,"color","tertiary"),p(v,"strong",""),j(v,"width","99%"),j(v,"height","auto")},m(L,M){H(L,e,M),i(e,t),i(t,o),i(o,n),i(t,d),i(t,_),H(L,O,M),H(L,k,M),i(k,f),R.m(f,null),i(f,s),C&&C.m(f,null),H(L,b,M),H(L,h,M),i(h,v),w||(y=[oe(n,"click",l[15]),oe(v,"click",l[16])],w=!0)},p(L,M){R.p(L,M),L[13]&&C.p(L,M)},i:Ne,o:Ne,d(L){L&&(a(e),a(O),a(k),a(b),a(h)),R.d(),C&&C.d(),w=!1,Ge(y)}}}function gt(l,e){if(typeof l=="object"&&l!==null||Array.isArray(l)){if(Array.isArray(l))return l.map(t=>gt(t,e)).flat();{const t=Object.keys(l);let o;return e=="id_checklist_event"?o=t.filter(r=>r.toLowerCase().includes("id_checklist_event")).map(r=>l[r]):e=="mandatory"?o=t.filter(r=>r.toLowerCase().includes("mandatory")).map(r=>l[r]):(console.error("Tipo de dato no reconocido."),o=!1),o}}else return console.error("Invalid input. Please provide a valid object or array."),[]}function pt(l,e){let t=new FormData;t.append("id_route",l),t.append("status",e),fetch("https://app.rutaflow.com/api/admin/route/change_status.php",{method:"POST",body:t}).then(o=>o.json()).then(o=>{}).catch(o=>{console.error("Error fetching data:",o)})}function Jn(l,e,t){let o=document.querySelector("ion-modal");const n=o.componentProps.checklist,r=o.componentProps.driverId,d=o.componentProps.routeId,_=o.componentProps.isLast;let g,O,k,f,s=[],b=null,h={},v,m,w,y,z={},A={},R={};lt(()=>{_?console.log("Último checklist"):ht.update(D=>(D.mandatory=gt(n,"mandatory"),D.items=gt(n,"id_checklist_event"),D))});function C(D){t(11,z[D]=!0,z)}const L=async()=>{await(await We.create({header:"Datos o checklist incompletos",message:"Carga la evidencia requerida y marca todas las casillas para confirmar",buttons:[{text:"Cerrar"}]})).present()},M=async()=>{await(await We.create({header:"Datos capturados",message:"El kilometraje y gasolina final fueron registrados correctamente, espere aprobación para finalizar ruta",buttons:[{text:"Cerrar"}]})).present()},I=async D=>{await(await We.create({header:"Datos inválidos",message:D=="km"?"Llena correctamente el campo de kilometraje inicial":"Llena correctamente el campo de gasolina inicial",buttons:[{text:"Cerrar"}]})).present()},B=()=>{at.dismiss(),r?Xe(`/drivers/${r}`):Xe("/drivers/me")},F=()=>{if(_){var D=W(k,"km"),K=W(f,"gas");const ge=new FormData;ge.append("km_final",D),ge.append("gas_final",K),ge.append("id_route",d),D&&K?(B(),fetch("https://app.rutaflow.com/api/admin/checklist/add_evidence.php",{method:"POST",body:ge}).then(ee=>ee.json()).then(ee=>{M()}).catch(ee=>{console.error("Error fetching data:",ee)})):L()}else{var ye=W(g,"km"),Se=W(O,"gas");ht.update(ge=>{ge.items;const ee=ge.mandatory;if(ge.items.filter((x,ne)=>ge.mandatory[ne]==="1").every(x=>ge.checkedIndices.includes(x))&&ye&&Se){B();const x=new FormData;for(const ne in A)if(A.hasOwnProperty(ne)){const{img:Pe,img_id:be}=A[ne];x.append(`selectedImages[${ne}][img]`,Pe),x.append(`selectedImages[${ne}][img_id]`,be)}x.append("km_inicial",ye),x.append("gas_inicial",Se),x.append("id_route",d),fetch("https://app.rutaflow.com/api/admin/checklist/add_evidence.php",{method:"POST",body:x}).then(ne=>ne.json()).then(ne=>{ee&&ee.some(Pe=>Pe==="1")?pt(d,"checklist-pending"):pt(d,"enroute")}).catch(ne=>{console.error("Error fetching data:",ne)})}else if(!ee&&ye&&Se){var ce=new FormData;ce.append("km_inicial",ye),ce.append("gas_inicial",Se),fetch("https://app.rutaflow.com/api/admin/checklist/add_evidence.php",{method:"POST",body:ce}).then(x=>x.json()).then(x=>{pt(d,"enroute")}).catch(x=>{console.error("Error fetching data:",x)})}else L();return ge})}he()},P=async(D,K)=>{C(K);const Se=D.target.files[0],ge=await V(Se);if(ge){const ee=new FormData;ee.append("fileToUpload",ge);try{const me=await fetch("https://app.rutaflow.com/api/admin/manager/upload_img_driver.php",{method:"POST",body:ee});if(me.ok){const se=await me.json();A={...A,[K]:{img:se.img,img_id:se.img_id}},t(12,R={...R,[K]:se.filename}),G(K),t(6,h[K].checked=!0,h),t(11,z[K]=!1,z)}else console.error("File upload failed:",me.statusText)}catch(me){console.error("Error during file upload:",me)}}},V=async D=>new Promise(K=>{const ye=new FileReader;ye.onload=Se=>{const ge=new Image;ge.src=Se.target.result,ge.onload=()=>{const ee=document.createElement("canvas"),me=ee.getContext("2d"),se=800,ce=600;let x=ge.width,ne=ge.height;x>se&&(ne*=se/x,x=se),ne>ce&&(x*=ce/ne,ne=ce),ee.width=x,ee.height=ne,me.drawImage(ge,0,0,x,ne),ee.toBlob(Pe=>{K(Pe)},"image/jpeg",.7)}},ye.readAsDataURL(D)}),G=D=>{ht.update(K=>(K.checkedIndices.indexOf(D)===-1?K.checkedIndices.push(D):console.error(`ID ${D} is already checked.`),K.items.forEach(Se=>{Se.id_checklist_event===D&&(Se.checked=!0)}),K))};function W(D,K){return/^\d+$/.test(D)?parseInt(D,10):(I(K),null)}function $(D,K){Ee(K),o.componentProps.data_type=K,Ke("modal-gas-km",qn,{r:K}).then(()=>{Qe.subscribe(ye=>{ie(ye,K)})})}function Ee(D){rn.update(K=>({...K,flag:[D]}))}function ie(D,K){t(0,g=D.km_inicial?D.km_inicial:null),t(1,O=D.gas_inicial?D.gas_inicial:null),t(2,k=D.km_final?D.km_final:null),t(3,f=D.gas_final?D.gas_final:null),K=="km_inicial"&&v&&t(7,v.checked=!0,v),K=="gas_inicial"&&m&&t(8,m.checked=!0,m),K=="km_final"&&w&&t(9,w.checked=!0,w),K=="gas_final"&&y&&t(10,y.checked=!0,y)}function he(){Qe.set({km_inicial:[],gas_inicial:[],km_final:[],gas_final:[]})}const Oe=[[]];function S(){s=ot(Oe[0],this.__value,this.checked),t(4,s)}function q(D){Be[D?"unshift":"push"](()=>{w=D,t(9,w)})}const U=D=>$(D,"km_final");function X(){s=ot(Oe[0],this.__value,this.checked),t(4,s)}function te(D){Be[D?"unshift":"push"](()=>{y=D,t(10,y)})}const J=D=>$(D,"gas_final");function re(){s=ot(Oe[0],this.__value,this.checked),t(4,s)}function le(D){Be[D?"unshift":"push"](()=>{v=D,t(7,v)})}const pe=D=>$(D,"km_inicial");function _e(D){Be[D?"unshift":"push"](()=>{m=D,t(8,m)})}function ae(){s=ot(Oe[0],this.__value,this.checked),t(4,s)}const ve=D=>$(D,"gas_inicial");function Le(){s=ot(Oe[0],this.__value,this.checked),t(4,s)}function Fe(D,K){Be[D?"unshift":"push"](()=>{h[K.id_checklist_event]=D,t(6,h)})}const ze=D=>G(D.id_checklist_event);function je(D){Be[D?"unshift":"push"](()=>{b=D,t(5,b)})}return[g,O,k,f,s,b,h,v,m,w,y,z,R,n,_,B,F,P,G,$,S,Oe,q,U,X,te,J,re,le,pe,_e,ae,ve,Le,Fe,ze,je,(D,K)=>P(K,D.id_checklist_event)]}class an extends $e{constructor(e){super(),et(this,e,Jn,Xn,xe,{},null,[-1,-1])}}function Qn(l){let e,t,o,n,r,d="Teléfono de Negocio",_,g,O=l[10].client_phone+"",k;return{c(){e=c("ion-item"),t=c("ion-icon"),o=N(),n=c("ion-label"),r=c("p"),r.textContent=d,_=N(),g=c("h2"),k=ue(O),this.h()},l(f){e=u(f,"ION-ITEM",{href:!0});var s=E(e);t=u(s,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(a),o=T(s),n=u(s,"ION-LABEL",{class:!0});var b=E(n);r=u(b,"P",{"data-svelte-h":!0}),Q(r)!=="svelte-1u5l7fz"&&(r.textContent=d),_=T(b),g=u(b,"H2",{});var h=E(g);k=fe(h,O),h.forEach(a),b.forEach(a),s.forEach(a),this.h()},h(){p(t,"icon",En),p(t,"slot","start"),p(n,"class","ion-text-wrap"),p(e,"href","tel:"+l[10].client_phone)},m(f,s){H(f,e,s),i(e,t),i(e,o),i(e,n),i(n,r),i(n,_),i(n,g),i(g,k)},p:Ne,d(f){f&&a(e)}}}function Yn(l){let e,t,o,n,r,d="Domicilio Alternativo",_,g,O=l[10].line2+"",k,f,s;return{c(){e=c("ion-item"),t=c("ion-icon"),o=N(),n=c("ion-label"),r=c("p"),r.textContent=d,_=N(),g=c("h2"),k=ue(O),f=N(),s=c("ion-icon"),this.h()},l(b){e=u(b,"ION-ITEM",{href:!0});var h=E(e);t=u(h,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(a),o=T(h),n=u(h,"ION-LABEL",{class:!0});var v=E(n);r=u(v,"P",{"data-svelte-h":!0}),Q(r)!=="svelte-1ub9uzw"&&(r.textContent=d),_=T(v),g=u(v,"H2",{});var m=E(g);k=fe(m,O),m.forEach(a),v.forEach(a),f=T(h),s=u(h,"ION-ICON",{icon:!0,slot:!0}),E(s).forEach(a),h.forEach(a),this.h()},h(){p(t,"icon",kt),p(t,"slot","start"),p(n,"class","ion-text-wrap"),p(s,"icon",tt),p(s,"slot","end"),p(e,"href","https://www.google.com/maps/searhc/?api=1&query="+l[10].line2)},m(b,h){H(b,e,h),i(e,t),i(e,o),i(e,n),i(n,r),i(n,_),i(n,g),i(g,k),i(e,f),i(e,s)},p:Ne,d(b){b&&a(e)}}}function Zn(l){let e,t,o,n,r,d="Domicilio",_,g,O=l[10].line1+"",k,f,s,b,h=l[10].line2&&l[10].line2.trim().length,v,m=h&&xn(l);return{c(){e=c("ion-item"),t=c("ion-icon"),o=N(),n=c("ion-label"),r=c("p"),r.textContent=d,_=N(),g=c("h2"),k=ue(O),f=N(),s=c("ion-icon"),b=N(),m&&m.c(),v=Re(),this.h()},l(w){e=u(w,"ION-ITEM",{href:!0});var y=E(e);t=u(y,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(a),o=T(y),n=u(y,"ION-LABEL",{class:!0});var z=E(n);r=u(z,"P",{"data-svelte-h":!0}),Q(r)!=="svelte-cbm7q1"&&(r.textContent=d),_=T(z),g=u(z,"H2",{});var A=E(g);k=fe(A,O),A.forEach(a),z.forEach(a),f=T(y),s=u(y,"ION-ICON",{icon:!0,slot:!0}),E(s).forEach(a),y.forEach(a),b=T(w),m&&m.l(w),v=Re(),this.h()},h(){p(t,"icon",kt),p(t,"slot","start"),p(n,"class","ion-text-wrap"),p(s,"icon",tt),p(s,"slot","end"),p(e,"href","https://www.google.com/maps/search/?api=1&query="+l[10].line1)},m(w,y){H(w,e,y),i(e,t),i(e,o),i(e,n),i(n,r),i(n,_),i(n,g),i(g,k),i(e,f),i(e,s),H(w,b,y),m&&m.m(w,y),H(w,v,y)},p(w,y){h&&m.p(w,y)},d(w){w&&(a(e),a(b),a(v)),m&&m.d(w)}}}function xn(l){let e,t,o,n,r,d="Domicilio Alternativo",_,g,O=l[10].line2+"",k,f,s;return{c(){e=c("ion-item"),t=c("ion-icon"),o=N(),n=c("ion-label"),r=c("p"),r.textContent=d,_=N(),g=c("h2"),k=ue(O),f=N(),s=c("ion-icon"),this.h()},l(b){e=u(b,"ION-ITEM",{href:!0});var h=E(e);t=u(h,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(a),o=T(h),n=u(h,"ION-LABEL",{class:!0});var v=E(n);r=u(v,"P",{"data-svelte-h":!0}),Q(r)!=="svelte-1ub9uzw"&&(r.textContent=d),_=T(v),g=u(v,"H2",{});var m=E(g);k=fe(m,O),m.forEach(a),v.forEach(a),f=T(h),s=u(h,"ION-ICON",{icon:!0,slot:!0}),E(s).forEach(a),h.forEach(a),this.h()},h(){p(t,"icon",kt),p(t,"slot","start"),p(n,"class","ion-text-wrap"),p(s,"icon",tt),p(s,"slot","end"),p(e,"href","https://www.google.com/maps/search/?api=1&query="+l[10].line2)},m(b,h){H(b,e,h),i(e,t),i(e,o),i(e,n),i(n,r),i(n,_),i(n,g),i(g,k),i(e,f),i(e,s)},p:Ne,d(b){b&&a(e)}}}function St(l){let e,t,o,n,r,d="Contacto del Cliente",_,g,O,k,f=l[2]&&l[2]==="1"&&Mt(l);return{c(){e=c("ion-item"),t=c("ion-icon"),o=N(),n=c("ion-label"),r=c("p"),r.textContent=d,_=N(),g=c("h2"),O=ue(l[6]),k=N(),f&&f.c(),this.h()},l(s){e=u(s,"ION-ITEM",{});var b=E(e);t=u(b,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(a),o=T(b),n=u(b,"ION-LABEL",{class:!0});var h=E(n);r=u(h,"P",{"data-svelte-h":!0}),Q(r)!=="svelte-1utsyb6"&&(r.textContent=d),_=T(h),g=u(h,"H2",{});var v=E(g);O=fe(v,l[6]),v.forEach(a),h.forEach(a),k=T(b),f&&f.l(b),b.forEach(a),this.h()},h(){p(t,"icon",In),p(t,"slot","start"),p(n,"class","ion-text-wrap")},m(s,b){H(s,e,b),i(e,t),i(e,o),i(e,n),i(n,r),i(n,_),i(n,g),i(g,O),i(e,k),f&&f.m(e,null)},p(s,b){b[0]&64&&Ae(O,s[6]),s[2]&&s[2]==="1"?f?f.p(s,b):(f=Mt(s),f.c(),f.m(e,null)):f&&(f.d(1),f=null)},d(s){s&&a(e),f&&f.d()}}}function Mt(l){let e,t=`<ion-icon icon="${Tn}" slot="start"></ion-icon>
                        Notificar Cliente`,o,n;return{c(){e=c("ion-button"),e.innerHTML=t,this.h()},l(r){e=u(r,"ION-BUTTON",{fill:!0,style:!0,"data-svelte-h":!0}),Q(e)!=="svelte-w3qtwm"&&(e.innerHTML=t),this.h()},h(){p(e,"fill","outline"),j(e,"margin-left","16px")},m(r,d){H(r,e,d),o||(n=oe(e,"click",l[14]),o=!0)},p:Ne,d(r){r&&a(e),o=!1,n()}}}function Pt(l){let e,t,o,n,r,d="Notas de ubicación",_,g,O;return{c(){e=c("ion-item"),t=c("ion-icon"),o=N(),n=c("ion-label"),r=c("p"),r.textContent=d,_=N(),g=c("h2"),O=ue(l[7]),this.h()},l(k){e=u(k,"ION-ITEM",{});var f=E(e);t=u(f,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(a),o=T(f),n=u(f,"ION-LABEL",{class:!0});var s=E(n);r=u(s,"P",{"data-svelte-h":!0}),Q(r)!=="svelte-nhm2ft"&&(r.textContent=d),_=T(s),g=u(s,"H2",{});var b=E(g);O=fe(b,l[7]),b.forEach(a),s.forEach(a),f.forEach(a),this.h()},h(){p(t,"icon",on),p(t,"slot","start"),p(n,"class","ion-text-wrap")},m(k,f){H(k,e,f),i(e,t),i(e,o),i(e,n),i(n,r),i(n,_),i(n,g),i(g,O)},p(k,f){f[0]&128&&Ae(O,k[7])},d(k){k&&a(e)}}}function $n(l){let e,t,o,n,r,d="Horarios",_,g,O=l[10].schedule+"",k;return{c(){e=c("ion-item"),t=c("ion-icon"),o=N(),n=c("ion-label"),r=c("p"),r.textContent=d,_=N(),g=c("h2"),k=ue(O),this.h()},l(f){e=u(f,"ION-ITEM",{});var s=E(e);t=u(s,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(a),o=T(s),n=u(s,"ION-LABEL",{});var b=E(n);r=u(b,"P",{"data-svelte-h":!0}),Q(r)!=="svelte-11q7hm5"&&(r.textContent=d),_=T(b),g=u(b,"H2",{});var h=E(g);k=fe(h,O),h.forEach(a),b.forEach(a),s.forEach(a),this.h()},h(){p(t,"icon",kn),p(t,"slot","start")},m(f,s){H(f,e,s),i(e,t),i(e,o),i(e,n),i(n,r),i(n,_),i(n,g),i(g,k)},p:Ne,d(f){f&&a(e)}}}function eo(l){let e,t,o,n,r,d="Notas del operador",_,g,O=l[10].driver_comments+"",k;return{c(){e=c("ion-item"),t=c("ion-icon"),o=N(),n=c("ion-label"),r=c("p"),r.textContent=d,_=N(),g=c("h2"),k=ue(O),this.h()},l(f){e=u(f,"ION-ITEM",{});var s=E(e);t=u(s,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(a),o=T(s),n=u(s,"ION-LABEL",{});var b=E(n);r=u(b,"P",{"data-svelte-h":!0}),Q(r)!=="svelte-1yk9qp4"&&(r.textContent=d),_=T(b),g=u(b,"H2",{});var h=E(g);k=fe(h,O),h.forEach(a),b.forEach(a),s.forEach(a),this.h()},h(){p(t,"icon",ln),p(t,"slot","start")},m(f,s){H(f,e,s),i(e,t),i(e,o),i(e,n),i(n,r),i(n,_),i(n,g),i(g,k)},p:Ne,d(f){f&&a(e)}}}function to(l){let e,t=l[10].logistic_comments!="<br>"&&no(l);return{c(){t&&t.c(),e=Re()},l(o){t&&t.l(o),e=Re()},m(o,n){t&&t.m(o,n),H(o,e,n)},p(o,n){o[10].logistic_comments!="<br>"&&t.p(o,n)},d(o){o&&a(e),t&&t.d(o)}}}function no(l){let e,t,o,n,r,d="Comentarios logísticos",_,g,O=l[10].logistic_comments+"",k;return{c(){e=c("ion-item"),t=c("ion-icon"),o=N(),n=c("ion-label"),r=c("p"),r.textContent=d,_=N(),g=c("h2"),k=ue(O),this.h()},l(f){e=u(f,"ION-ITEM",{});var s=E(e);t=u(s,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(a),o=T(s),n=u(s,"ION-LABEL",{class:!0});var b=E(n);r=u(b,"P",{"data-svelte-h":!0}),Q(r)!=="svelte-1iz85r6"&&(r.textContent=d),_=T(b),g=u(b,"H2",{});var h=E(g);k=fe(h,O),h.forEach(a),b.forEach(a),s.forEach(a),this.h()},h(){p(t,"icon",on),p(t,"slot","start"),p(n,"class","ion-text-wrap")},m(f,s){H(f,e,s),i(e,t),i(e,o),i(e,n),i(n,r),i(n,_),i(n,g),i(g,k)},p:Ne,d(f){f&&a(e)}}}function At(l){let e,t,o,n;return{c(){e=c("ion-item"),t=c("ion-icon"),o=N(),n=c("ion-textarea"),this.h()},l(r){e=u(r,"ION-ITEM",{});var d=E(e);t=u(d,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(a),o=T(d),n=u(d,"ION-TEXTAREA",{placeholder:!0}),E(n).forEach(a),d.forEach(a),this.h()},h(){p(t,"icon",On),p(t,"slot","start"),p(n,"placeholder","Escribe el motivo...")},m(r,d){H(r,e,d),i(e,t),i(e,o),i(e,n),l[17](n)},p:Ne,d(r){r&&a(e),l[17](null)}}}function Bt(l){let e,t=`<ion-icon icon="${Cn}" slot="start"></ion-icon>
                    Ingreso`,o,n;return{c(){e=c("ion-button"),e.innerHTML=t,this.h()},l(r){e=u(r,"ION-BUTTON",{id:!0,style:!0,"data-svelte-h":!0}),Q(e)!=="svelte-151bg1z"&&(e.innerHTML=t),this.h()},h(){p(e,"id","checkInBtn"),j(e,"flex","1")},m(r,d){H(r,e,d),o||(n=oe(e,"click",l[15]),o=!0)},p:Ne,d(r){r&&a(e),o=!1,n()}}}function Dt(l){let e,t,o,n,r,d;return{c(){e=c("ion-button"),t=c("ion-icon"),o=ue(`
                    Salida`),this.h()},l(_){e=u(_,"ION-BUTTON",{id:!0,style:!0,disabled:!0});var g=E(e);t=u(g,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(a),o=fe(g,`
                    Salida`),g.forEach(a),this.h()},h(){p(t,"icon",Nn),p(t,"slot","start"),p(e,"id","checkOutBtn"),j(e,"flex","1"),p(e,"disabled",n=l[5]===!1)},m(_,g){H(_,e,g),i(e,t),i(e,o),r||(d=oe(e,"click",l[16]),r=!0)},p(_,g){g[0]&32&&n!==(n=_[5]===!1)&&p(e,"disabled",n)},d(_){_&&a(e),r=!1,d()}}}function zt(l){let e,t='<ion-spinner name="dots"></ion-spinner>';return{c(){e=c("section"),e.innerHTML=t,this.h()},l(o){e=u(o,"SECTION",{style:!0,"data-svelte-h":!0}),Q(e)!=="svelte-1sj3e0"&&(e.innerHTML=t),this.h()},h(){j(e,"text-align","center")},m(o,n){H(o,e,n)},d(o){o&&a(e)}}}function Ht(l){let e,t,o;return{c(){e=c("section"),t=c("ion-img"),this.h()},l(n){e=u(n,"SECTION",{});var r=E(e);t=u(r,"ION-IMG",{src:!0,alt:!0,style:!0}),E(t).forEach(a),r.forEach(a),this.h()},h(){dt(t.src,o=l[1])||p(t,"src",o),p(t,"alt","Evidencia fotográfica"),j(t,"max-width","100%"),j(t,"margin-top","16px")},m(n,r){H(n,e,r),i(e,t)},p(n,r){r[0]&2&&!dt(t.src,o=n[1])&&p(t,"src",o)},d(n){n&&a(e)}}}function oo(l){let e,t,o,n,r="Cancelar",d,_,g=l[10].title+"",O,k,f,s,b="Confirmar",h,v,m,w,y,z,A,R,C="Negocio",L,M,I=l[10].client_name+"",B,F,P=l[10].client_phone&&l[10].client_phone.trim().length,V,G,W,$,Ee=l[10].schedule&&l[10].schedule.trim().length,ie,he,Oe=l[10].logistic_comments&&l[10].logistic_comments.trim().length,S,q,U,X,te,J,re,le,pe,_e,ae,ve,Le,Fe,ze,je="Subir Evidencia",Ue,D,K,ye,Se,ge,ee=P&&Qn(l);function me(Y,ke){if(Y[10].line1&&Y[10].line1.trim().length)return Zn;if(Y[10].line2&&Y[10].line2.trim().length)return Yn}let se=me(l),ce=se&&se(l),x=l[6]&&St(l),ne=l[7]&&l[7]!=="<br>"&&Pt(l),Pe=Ee&&$n(l),be=l[10].driver_comments&&eo(l),He=Oe&&to(l),Te=l[8]&&At(l),Ce=l[4]===!0&&Bt(l),Ie=(l[5]===!0||l[5]===!1&&l[4]===!1)&&Dt(l),we=l[3]&&zt(),Me=l[1]&&Ht(l);return{c(){e=c("ion-header"),t=c("ion-toolbar"),o=c("ion-buttons"),n=c("ion-button"),n.textContent=r,d=N(),_=c("ion-title"),O=ue(g),k=N(),f=c("ion-buttons"),s=c("ion-button"),s.textContent=b,h=N(),v=c("ion-content"),m=c("ion-list"),w=c("ion-item"),y=c("ion-icon"),z=N(),A=c("ion-label"),R=c("p"),R.textContent=C,L=N(),M=c("h2"),B=ue(I),F=N(),ee&&ee.c(),V=N(),ce&&ce.c(),G=N(),x&&x.c(),W=N(),ne&&ne.c(),$=N(),Pe&&Pe.c(),ie=N(),be&&be.c(),he=N(),He&&He.c(),S=N(),Te&&Te.c(),q=N(),U=c("ion-item"),X=c("ion-icon"),te=N(),J=c("ion-textarea"),re=N(),le=c("section"),Ce&&Ce.c(),pe=N(),Ie&&Ie.c(),_e=N(),ae=c("section"),ve=c("ion-button"),Le=c("ion-icon"),Fe=N(),ze=c("label"),ze.textContent=je,Ue=N(),D=c("input"),K=N(),we&&we.c(),ye=N(),Me&&Me.c(),this.h()},l(Y){e=u(Y,"ION-HEADER",{translucent:!0});var ke=E(e);t=u(ke,"ION-TOOLBAR",{});var Ve=E(t);o=u(Ve,"ION-BUTTONS",{slot:!0});var nt=E(o);n=u(nt,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),Q(n)!=="svelte-1f8rjcf"&&(n.textContent=r),nt.forEach(a),d=T(Ve),_=u(Ve,"ION-TITLE",{style:!0,title:!0});var Ot=E(_);O=fe(Ot,g),Ot.forEach(a),k=T(Ve),f=u(Ve,"ION-BUTTONS",{slot:!0});var Nt=E(f);s=u(Nt,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),Q(s)!=="svelte-1ida0il"&&(s.textContent=b),Nt.forEach(a),Ve.forEach(a),ke.forEach(a),h=T(Y),v=u(Y,"ION-CONTENT",{fullscreen:!0});var Tt=E(v);m=u(Tt,"ION-LIST",{});var de=E(m);w=u(de,"ION-ITEM",{});var st=E(w);y=u(st,"ION-ICON",{icon:!0,slot:!0}),E(y).forEach(a),z=T(st),A=u(st,"ION-LABEL",{});var ct=E(A);R=u(ct,"P",{"data-svelte-h":!0}),Q(R)!=="svelte-57b1dg"&&(R.textContent=C),L=T(ct),M=u(ct,"H2",{});var Ct=E(M);B=fe(Ct,I),Ct.forEach(a),ct.forEach(a),st.forEach(a),F=T(de),ee&&ee.l(de),V=T(de),ce&&ce.l(de),G=T(de),x&&x.l(de),W=T(de),ne&&ne.l(de),$=T(de),Pe&&Pe.l(de),ie=T(de),be&&be.l(de),he=T(de),He&&He.l(de),S=T(de),Te&&Te.l(de),q=T(de),U=u(de,"ION-ITEM",{});var ut=E(U);X=u(ut,"ION-ICON",{icon:!0,slot:!0}),E(X).forEach(a),te=T(ut),J=u(ut,"ION-TEXTAREA",{label:!0,placeholder:!0}),E(J).forEach(a),ut.forEach(a),re=T(de),le=u(de,"SECTION",{style:!0});var ft=E(le);Ce&&Ce.l(ft),pe=T(ft),Ie&&Ie.l(ft),ft.forEach(a),_e=T(de),ae=u(de,"SECTION",{style:!0});var yt=E(ae);ve=u(yt,"ION-BUTTON",{fill:!0,class:!0,style:!0});var Je=E(ve);Le=u(Je,"ION-ICON",{icon:!0,slot:!0}),E(Le).forEach(a),Fe=T(Je),ze=u(Je,"LABEL",{for:!0,"data-svelte-h":!0}),Q(ze)!=="svelte-7lscau"&&(ze.textContent=je),Ue=T(Je),D=u(Je,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0}),Je.forEach(a),yt.forEach(a),K=T(de),we&&we.l(de),ye=T(de),Me&&Me.l(de),de.forEach(a),Tt.forEach(a),this.h()},h(){p(n,"color","medium"),p(o,"slot","start"),j(_,"text-align","center"),p(_,"title",l[10].title),p(s,"strong",""),p(f,"slot","end"),p(e,"translucent",""),p(y,"icon",bn),p(y,"slot","start"),p(X,"icon",vt),p(X,"slot","start"),p(J,"label","Notas"),p(J,"placeholder","Escribe aquí..."),j(le,"display","flex"),j(le,"gap","8px"),j(le,"padding","16px 16px 6px"),p(Le,"icon",nn),p(Le,"slot","start"),Z(ze,"for","eventEvidence"),j(D,"display","none"),Z(D,"id","eventEvidence"),Z(D,"name","fileToUpload"),Z(D,"type","file"),Z(D,"accept","image/*"),p(ve,"fill","outline"),p(ve,"class","loadEvidence"),j(ve,"flex","1"),j(ae,"display","flex"),j(ae,"gap","8px"),j(ae,"padding","0px 16px"),p(v,"fullscreen","")},m(Y,ke){H(Y,e,ke),i(e,t),i(t,o),i(o,n),i(t,d),i(t,_),i(_,O),i(t,k),i(t,f),i(f,s),H(Y,h,ke),H(Y,v,ke),i(v,m),i(m,w),i(w,y),i(w,z),i(w,A),i(A,R),i(A,L),i(A,M),i(M,B),i(m,F),ee&&ee.m(m,null),i(m,V),ce&&ce.m(m,null),i(m,G),x&&x.m(m,null),i(m,W),ne&&ne.m(m,null),i(m,$),Pe&&Pe.m(m,null),i(m,ie),be&&be.m(m,null),i(m,he),He&&He.m(m,null),i(m,S),Te&&Te.m(m,null),i(m,q),i(m,U),i(U,X),i(U,te),i(U,J),l[18](J),i(m,re),i(m,le),Ce&&Ce.m(le,null),i(le,pe),Ie&&Ie.m(le,null),i(m,_e),i(m,ae),i(ae,ve),i(ve,Le),i(ve,Fe),i(ve,ze),i(ve,Ue),i(ve,D),i(m,K),we&&we.m(m,null),i(m,ye),Me&&Me.m(m,null),Se||(ge=[oe(n,"click",l[12]),oe(s,"click",l[13]),oe(D,"change",l[11])],Se=!0)},p(Y,ke){P&&ee.p(Y,ke),ce&&ce.p(Y,ke),Y[6]?x?x.p(Y,ke):(x=St(Y),x.c(),x.m(m,W)):x&&(x.d(1),x=null),Y[7]&&Y[7]!=="<br>"?ne?ne.p(Y,ke):(ne=Pt(Y),ne.c(),ne.m(m,$)):ne&&(ne.d(1),ne=null),Ee&&Pe.p(Y,ke),Y[10].driver_comments&&be.p(Y,ke),Oe&&He.p(Y,ke),Y[8]?Te?Te.p(Y,ke):(Te=At(Y),Te.c(),Te.m(m,q)):Te&&(Te.d(1),Te=null),Y[4]===!0?Ce?Ce.p(Y,ke):(Ce=Bt(Y),Ce.c(),Ce.m(le,pe)):Ce&&(Ce.d(1),Ce=null),Y[5]===!0||Y[5]===!1&&Y[4]===!1?Ie?Ie.p(Y,ke):(Ie=Dt(Y),Ie.c(),Ie.m(le,null)):Ie&&(Ie.d(1),Ie=null),Y[3]?we||(we=zt(),we.c(),we.m(m,ye)):we&&(we.d(1),we=null),Y[1]?Me?Me.p(Y,ke):(Me=Ht(Y),Me.c(),Me.m(m,null)):Me&&(Me.d(1),Me=null)},i:Ne,o:Ne,d(Y){Y&&(a(e),a(h),a(v)),ee&&ee.d(),ce&&ce.d(),x&&x.d(),ne&&ne.d(),Pe&&Pe.d(),be&&be.d(),He&&He.d(),Te&&Te.d(),l[18](null),Ce&&Ce.d(),Ie&&Ie.d(),we&&we.d(),Me&&Me.d(),Se=!1,Ge(ge)}}}const Rt=/Teléfono:\s*(\d{10,})/;function Ut(l,e){for(let t=0;t<e.length;t++)if(e[t].alias===l)return e[t].val;return""}function lo(l,e,t){let o=document.querySelector("ion-modal"),n=o.componentProps.delivery,r=o.componentProps.isLast,d=n.driver_comments?n.driver_comments:"",_=n.img?n.img:"",g="",O={latitude:null,longitude:null},k=new Object,f="",s="",b=!1,h=!0,v=!1,m="",w=n.comments_ext,y=!1,z="";lt(()=>{W(),A()});function A(){n.date_service?n.date_service&&!n.date_completed&&!n.service_time?(t(4,h=!1),t(5,v=!0)):n.date_service&&n.date_completed&&n.service_time&&(t(4,h=!1),t(5,v=!1)):(t(4,h=!0),t(5,v=!1))}if(n.comments_ext){const S=n.comments_ext.match(Rt);S&&(m=S[1],w=n.comments_ext.replace(Rt,"").trim())}const R=async()=>{await(await We.create({header:"SMS enviado",message:"Se envío correctamente un SMS a "+n.title+" con número de teléfono: "+m,buttons:[{text:"Cerrar"}]})).present()},C=async()=>{await(await We.create({header:"SMS no enviado",message:"Hubo un error al enviar SMS a "+n.title+" con número de teléfono: "+phoneNumber0+". Por favor contacte a soporte.",buttons:[{text:"Cerrar"}]})).present()};async function L(S){await(await We.create({header:"Tiempo por parada",message:"Completaste la parada en "+S+" minutos.",buttons:[{text:"Cerrar"}]})).present()}const M=async S=>{t(3,b=!0);const U=S.target.files[0],X=await I(U);if(X){const te=new FormData;te.append("fileToUpload",X);try{const J=await fetch("https://app.rutaflow.com/api/admin/manager/upload_img_driver.php",{method:"POST",body:te});if(J.ok){const re=await J.json();t(1,_=re.img),g=re.img_id}else console.error("File upload failed:",J.statusText)}catch(J){console.error("Error during file upload:",J)}finally{t(3,b=!1)}}},I=async S=>new Promise(q=>{const U=new FileReader;U.onload=X=>{const te=new Image;te.src=X.target.result,te.onload=()=>{const J=document.createElement("canvas"),re=J.getContext("2d"),le=800,pe=600;let _e=te.width,ae=te.height;_e>le&&(ae*=le/_e,_e=le),ae>pe&&(_e*=pe/ae,ae=pe),J.width=_e,J.height=ae,re.drawImage(te,0,0,_e,ae),J.toBlob(ve=>{q(ve)},"image/jpeg",.7)}},U.readAsDataURL(S)}),B=()=>{o.dismiss({data:Date.now()})},F=async()=>{try{if(await V()){const q={id_route:n.id_route,id_event:n.id_event,comments:d.value,img:_,img_id:g,lat:O.latitude,lon:O.longitude,...f==="0"&&{approve:"0"},...r&&{isLast:!0}},U=new FormData;for(const le in q)U.append(le,q[le]);const te=await(await fetch("https://app.rutaflow.com/api/admin/evidence/send_evidence.php",{method:"POST",body:U})).json();B();const J={},re=q.id_route;r&&P("","",re,r)}}catch(S){console.error("Error fetching data:",S)}},P=(S,q,U,X)=>{o.componentProps.routeId=U,o.componentProps.driverId=n.id_driver,Ke("modal-km-gas",an,{checklist:S,driverId:q,routeId:U,isLast:X}).then(te=>{})},V=async()=>navigator.geolocation?new Promise((S,q)=>{navigator.geolocation.getCurrentPosition(U=>{O.latitude=U.coords.latitude,O.longitude=U.coords.longitude,S(!0)},U=>{console.error("Error getting location:",U),S(!1)})}):(console.error("Geolocation is not supported by your browser"),!1);async function G(S){S.stopPropagation();const q=new FormData;q.append("client_phone",m),q.append("client_name",n.title),q.append("delivery_phone",n.client_phone),q.append("enterprise_name",n.enterprise_name);try{const U=await fetch("https://app.rutaflow.com/api/admin/message_central/send_sms.php",{method:"POST",body:q});if(U.ok){const X=await U.json();R()}else C()}catch(U){console.error("Error during file upload:",U)}}const W=async S=>{if(n.id_enterprise){const q=new FormData;q.append("id_enterprise",n.id_enterprise);try{const U=await fetch("https://app.rutaflow.com/api/admin/enterprise/enterprise_settings.php",{method:"POST",body:q});U.ok?(k=(await U.json()).nodos,f=Ut("stops_wait_approval",k),t(2,s=Ut("sms_active",k))):console.error("File upload failed:",U.statusText)}catch(U){console.error("Error during file upload:",U)}}};function $(){t(4,h=!1),t(5,v=!0),ie(n.id_event,"checkin")}function Ee(){t(5,v=!1),t(4,h=!1),ie(n.id_event,"checkout")}async function ie(S,q){if(q){const U=new FormData;U.append("type",q),U.append("id_event",S);try{const X=await fetch("https://app.rutaflow.com/api/admin/route/record_check_date.php",{method:"POST",body:U});if(X.ok){const te=await X.json();te.minutes&&L(te.minutes)}else console.error("File upload failed:",X.statusText)}catch(X){console.error("Error during file upload:",X)}finally{}}}function he(S){Be[S?"unshift":"push"](()=>{z=S,t(9,z)})}function Oe(S){Be[S?"unshift":"push"](()=>{d=S,t(0,d)})}return[d,_,s,b,h,v,m,w,y,z,n,M,B,F,G,$,Ee,he,Oe]}class io extends $e{constructor(e){super(),et(this,e,lo,oo,xe,{},null,[-1,-1])}}function Ft(l){let e;return{c(){e=c("ion-spinner"),this.h()},l(t){e=u(t,"ION-SPINNER",{name:!0}),E(e).forEach(a),this.h()},h(){p(e,"name","dots")},m(t,o){H(t,e,o)},d(t){t&&a(e)}}}function qt(l){let e,t,o;return{c(){e=c("section"),t=c("ion-img"),this.h()},l(n){e=u(n,"SECTION",{});var r=E(e);t=u(r,"ION-IMG",{src:!0,alt:!0,style:!0}),E(t).forEach(a),r.forEach(a),this.h()},h(){dt(t.src,o=l[0])||p(t,"src",o),p(t,"alt","Evidencia fotográfica"),j(t,"max-width","100%"),j(t,"margin-top","16px")},m(n,r){H(n,e,r),i(e,t)},p(n,r){r&1&&!dt(t.src,o=n[0])&&p(t,"src",o)},d(n){n&&a(e)}}}function ro(l){let e,t,o,n,r="Cancelar",d,_,g="AGREGAR GASTO",O,k,f,s,b,h,v,m,w,y,z,A,R,C,L,M,I,B,F='Tipo de pago <ion-text color="danger">(Obligatorio)</ion-text>',P,V,G="Efectivo",W,$,Ee="Tarjeta",ie,he,Oe="Transferencia",S,q,U,X,te,J,re,le,pe,_e,ae=`<ion-icon icon="${nn}" slot="start"></ion-icon>
                        Subir Evidencia`,ve,Le,Fe,ze,je,Ue,D,K,ye="Confirmar",Se,ge,ee=l[5]&&Ft(),me=l[0]&&qt(l);return{c(){e=c("ion-header"),t=c("ion-toolbar"),o=c("ion-buttons"),n=c("ion-button"),n.textContent=r,d=N(),_=c("ion-title"),_.textContent=g,O=N(),k=c("ion-content"),f=c("ion-list"),s=c("ion-item"),b=c("ion-icon"),h=N(),v=c("ion-input"),m=N(),w=c("ion-item"),y=c("ion-icon"),z=N(),A=c("ion-input"),R=N(),C=c("ion-item"),L=c("ion-icon"),M=N(),I=c("ion-select"),B=c("div"),B.innerHTML=F,P=N(),V=c("ion-select-option"),V.textContent=G,W=N(),$=c("ion-select-option"),$.textContent=Ee,ie=N(),he=c("ion-select-option"),he.textContent=Oe,S=N(),q=c("ion-item"),U=c("ion-icon"),X=N(),te=c("ion-textarea"),J=N(),re=c("section"),le=c("label"),pe=c("ion-button"),_e=c("label"),_e.innerHTML=ae,ve=N(),Le=c("input"),Fe=N(),ee&&ee.c(),ze=N(),me&&me.c(),je=N(),Ue=c("ion-footer"),D=c("ion-toolbar"),K=c("ion-button"),K.textContent=ye,this.h()},l(se){e=u(se,"ION-HEADER",{translucent:!0});var ce=E(e);t=u(ce,"ION-TOOLBAR",{});var x=E(t);o=u(x,"ION-BUTTONS",{slot:!0});var ne=E(o);n=u(ne,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),Q(n)!=="svelte-1f8rjcf"&&(n.textContent=r),ne.forEach(a),d=T(x),_=u(x,"ION-TITLE",{title:!0,"data-svelte-h":!0}),Q(_)!=="svelte-efps2s"&&(_.textContent=g),x.forEach(a),ce.forEach(a),O=T(se),k=u(se,"ION-CONTENT",{fullscreen:!0});var Pe=E(k);f=u(Pe,"ION-LIST",{});var be=E(f);s=u(be,"ION-ITEM",{});var He=E(s);b=u(He,"ION-ICON",{icon:!0,slot:!0}),E(b).forEach(a),h=T(He),v=u(He,"ION-INPUT",{label:!0,type:!0,placeholder:!0,value:!0}),E(v).forEach(a),He.forEach(a),m=T(be),w=u(be,"ION-ITEM",{});var Te=E(w);y=u(Te,"ION-ICON",{icon:!0,slot:!0}),E(y).forEach(a),z=T(Te),A=u(Te,"ION-INPUT",{label:!0,type:!0,value:!0}),E(A).forEach(a),Te.forEach(a),R=T(be),C=u(be,"ION-ITEM",{});var Ce=E(C);L=u(Ce,"ION-ICON",{icon:!0,slot:!0}),E(L).forEach(a),M=T(Ce),I=u(Ce,"ION-SELECT",{placeholder:!0,value:!0});var Ie=E(I);B=u(Ie,"DIV",{slot:!0,"data-svelte-h":!0}),Q(B)!=="svelte-wl764p"&&(B.innerHTML=F),P=T(Ie),V=u(Ie,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),Q(V)!=="svelte-i9crym"&&(V.textContent=G),W=T(Ie),$=u(Ie,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),Q($)!=="svelte-fx0z11"&&($.textContent=Ee),ie=T(Ie),he=u(Ie,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),Q(he)!=="svelte-1c24jf2"&&(he.textContent=Oe),Ie.forEach(a),Ce.forEach(a),S=T(be),q=u(be,"ION-ITEM",{});var we=E(q);U=u(we,"ION-ICON",{icon:!0,slot:!0}),E(U).forEach(a),X=T(we),te=u(we,"ION-TEXTAREA",{label:!0,placeholder:!0}),E(te).forEach(a),we.forEach(a),J=T(be),re=u(be,"SECTION",{});var Me=E(re);le=u(Me,"LABEL",{for:!0,style:!0});var Y=E(le);pe=u(Y,"ION-BUTTON",{fill:!0,size:!0,class:!0,expand:!0});var ke=E(pe);_e=u(ke,"LABEL",{for:!0,style:!0,"data-svelte-h":!0}),Q(_e)!=="svelte-1m9yw22"&&(_e.innerHTML=ae),ve=T(ke),Le=u(ke,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0}),ke.forEach(a),Y.forEach(a),Me.forEach(a),Fe=T(be),ee&&ee.l(be),ze=T(be),me&&me.l(be),be.forEach(a),Pe.forEach(a),je=T(se),Ue=u(se,"ION-FOOTER",{});var Ve=E(Ue);D=u(Ve,"ION-TOOLBAR",{});var nt=E(D);K=u(nt,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),Q(K)!=="svelte-1c7dl3f"&&(K.textContent=ye),nt.forEach(a),Ve.forEach(a),this.h()},h(){p(n,"color","medium"),p(o,"slot","start"),p(_,"title",""),p(e,"translucent",""),p(b,"icon",ln),p(b,"slot","start"),p(v,"label","Concepto"),p(v,"type","text"),p(v,"placeholder","Escribe aquí..."),p(v,"value",l[6]?l[6]:""),p(y,"icon",vt),p(y,"slot","start"),p(A,"label","Cantidad"),p(A,"type","number"),p(A,"value",l[7]?l[7]:""),p(L,"icon",yn),p(L,"slot","start"),Z(B,"slot","label"),p(V,"value","cash"),p($,"value","card"),p(he,"value","transfer"),p(I,"placeholder","Tipo de pago"),p(I,"value",l[8]?l[8]:""),p(U,"icon",vt),p(U,"slot","start"),p(te,"label","Comentarios"),p(te,"placeholder","Escribe aquí..."),Z(_e,"for","eventEvidence"),j(_e,"width","100%"),j(_e,"padding","8px"),j(Le,"display","none"),Z(Le,"id","eventEvidence"),Z(Le,"name","fileToUpload"),Z(Le,"type","file"),Z(Le,"accept","image/*"),p(pe,"fill","outline"),p(pe,"size","small"),p(pe,"class","loadEvidence"),p(pe,"expand","block"),Z(le,"for","eventEvidence"),j(le,"display","block"),j(le,"width","100%"),p(k,"fullscreen",""),p(K,"fill","outline"),p(K,"color","tertiary"),p(K,"strong",""),j(K,"width","99%"),j(K,"height","auto")},m(se,ce){H(se,e,ce),i(e,t),i(t,o),i(o,n),i(t,d),i(t,_),H(se,O,ce),H(se,k,ce),i(k,f),i(f,s),i(s,b),i(s,h),i(s,v),l[12](v),i(f,m),i(f,w),i(w,y),i(w,z),i(w,A),l[13](A),i(f,R),i(f,C),i(C,L),i(C,M),i(C,I),i(I,B),i(I,P),i(I,V),i(I,W),i(I,$),i(I,ie),i(I,he),l[14](I),i(f,S),i(f,q),i(q,U),i(q,X),i(q,te),l[15](te),i(f,J),i(f,re),i(re,le),i(le,pe),i(pe,_e),i(pe,ve),i(pe,Le),i(f,Fe),ee&&ee.m(f,null),i(f,ze),me&&me.m(f,null),H(se,je,ce),H(se,Ue,ce),i(Ue,D),i(D,K),Se||(ge=[oe(n,"click",l[10]),oe(Le,"change",l[9]),oe(K,"click",l[11])],Se=!0)},p(se,[ce]){se[5]?ee||(ee=Ft(),ee.c(),ee.m(f,ze)):ee&&(ee.d(1),ee=null),se[0]?me?me.p(se,ce):(me=qt(se),me.c(),me.m(f,null)):me&&(me.d(1),me=null)},i:Ne,o:Ne,d(se){se&&(a(e),a(O),a(k),a(je),a(Ue)),l[12](null),l[13](null),l[14](null),l[15](null),ee&&ee.d(),me&&me.d(),Se=!1,Ge(ge)}}}function ao(l,e,t){let o=document.querySelector("ion-modal"),n=o.componentProps.routeId,r=o.componentProps.ex_concept,d=o.componentProps.ex_amount,_=o.componentProps.ex_type,g=o.componentProps.id_expense,O="",k="",f="",s=0,b="",h="",v=!1;lt(()=>{});const m=async(I,B)=>{await(await We.create({header:I,message:B,buttons:[{text:"Cerrar"}]})).present()},w=async I=>{t(5,v=!0);const F=I.target.files[0],P=await y(F);if(P){const V=new FormData;V.append("fileToUpload",P);try{const G=await fetch("https://app.rutaflow.com/api/admin/manager/upload_img_driver.php",{method:"POST",body:V});if(G.ok){const W=await G.json();t(0,O=W.img),k=W.img_id}else console.error("File upload failed:",G.statusText)}catch(G){console.error("Error during file upload:",G)}finally{t(5,v=!1)}}},y=async I=>new Promise(B=>{const F=new FileReader;F.onload=P=>{const V=new Image;V.src=P.target.result,V.onload=()=>{const G=document.createElement("canvas"),W=G.getContext("2d"),$=800,Ee=600;let ie=V.width,he=V.height;ie>$&&(he*=$/ie,ie=$),he>Ee&&(ie*=Ee/he,he=Ee),G.width=ie,G.height=he,W.drawImage(V,0,0,ie,he),G.toBlob(Oe=>{B(Oe)},"image/jpeg",.7)}},F.readAsDataURL(I)}),z=()=>{at.dismiss()},A=()=>{var I=new Object;I.id_route=n,I.comments=b.value,I.type=f.value,I.img=O,I.img_id=k,I.amount=s.value,I.concept=h.value,I.status="done",I.id_expense=g||"null";const B=new FormData;for(const F in I)B.append(F,I[F]);!k||!O||!b.value||!s.value||!h.value?m("Datos incompletos","Llena los datos requeridos para completar el registro"):fetch("https://app.rutaflow.com/api/admin/expenses/add_expense.php",{method:"POST",body:B}).then(F=>F.json()).then(F=>{z()}).catch(F=>{console.error("Error fetching data:",F)})};function R(I){Be[I?"unshift":"push"](()=>{h=I,t(4,h)})}function C(I){Be[I?"unshift":"push"](()=>{s=I,t(2,s)})}function L(I){Be[I?"unshift":"push"](()=>{f=I,t(1,f)})}function M(I){Be[I?"unshift":"push"](()=>{b=I,t(3,b)})}return[O,f,s,b,h,v,r,d,_,w,z,A,R,C,L,M]}class bt extends $e{constructor(e){super(),et(this,e,ao,ro,xe,{})}}function jt(l,e,t){const o=l.slice();return o[7]=e[t],o}function so(l){let e,t="Cargar gasto",o,n;function r(...d){return l[4](l[7],...d)}return{c(){e=c("ion-button"),e.textContent=t,this.h()},l(d){e=u(d,"ION-BUTTON",{fill:!0,size:!0,"aria-selected":!0,"data-svelte-h":!0}),Q(e)!=="svelte-175aelj"&&(e.textContent=t),this.h()},h(){p(e,"fill","outline"),p(e,"size","small"),p(e,"aria-selected","")},m(d,_){H(d,e,_),o||(n=oe(e,"click",r),o=!0)},p(d,_){l=d},d(d){d&&a(e),o=!1,n()}}}function co(l){let e,t="Gasto completado";return{c(){e=c("ion-button"),e.textContent=t,this.h()},l(o){e=u(o,"ION-BUTTON",{fill:!0,size:!0,"aria-selected":!0,"data-svelte-h":!0}),Q(e)!=="svelte-tlger7"&&(e.textContent=t),this.h()},h(){p(e,"fill","solid"),p(e,"size","small"),p(e,"aria-selected","")},m(o,n){H(o,e,n)},p:Ne,d(o){o&&a(e)}}}function Vt(l,e){let t,o,n,r=e[7].concept+"",d,_,g;function O(s,b){return s[7].status=="done"?co:so}let f=O(e)(e);return{key:l,first:null,c(){t=c("ion-item"),o=c("ion-label"),n=c("p"),d=ue(r),_=N(),f.c(),g=N(),this.h()},l(s){t=u(s,"ION-ITEM",{});var b=E(t);o=u(b,"ION-LABEL",{style:!0});var h=E(o);n=u(h,"P",{style:!0});var v=E(n);d=fe(v,r),v.forEach(a),h.forEach(a),_=T(b),f.l(b),g=T(b),b.forEach(a),this.h()},h(){j(n,"margin-left","10px"),j(o,"display","flex"),this.first=t},m(s,b){H(s,t,b),i(t,o),i(o,n),i(n,d),i(t,_),f.m(t,null),i(t,g)},p(s,b){e=s,f.p(e,b)},d(s){s&&a(t),f.d()}}}function uo(l){let e,t,o,n,r=`<ion-icon style="font-size: 25px!important;" icon="${wn}"></ion-icon>`,d,_,g="LISTA DE GASTOS",O,k,f,s=[],b=new Map,h,v,m,w="Cerrar",y,z,A=qe(l[0]);const R=C=>C[7].id_expenses;for(let C=0;C<A.length;C+=1){let L=jt(l,A,C),M=R(L);b.set(M,s[C]=Vt(M,L))}return{c(){e=c("ion-header"),t=c("ion-toolbar"),o=c("ion-buttons"),n=c("ion-button"),n.innerHTML=r,d=N(),_=c("ion-title"),_.textContent=g,O=N(),k=c("ion-content"),f=c("ion-list");for(let C=0;C<s.length;C+=1)s[C].c();h=N(),v=c("ion-footer"),m=c("ion-button"),m.textContent=w,this.h()},l(C){e=u(C,"ION-HEADER",{translucent:!0});var L=E(e);t=u(L,"ION-TOOLBAR",{});var M=E(t);o=u(M,"ION-BUTTONS",{slot:!0});var I=E(o);n=u(I,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),Q(n)!=="svelte-160xz3i"&&(n.innerHTML=r),I.forEach(a),d=T(M),_=u(M,"ION-TITLE",{"data-svelte-h":!0}),Q(_)!=="svelte-1phn90x"&&(_.textContent=g),M.forEach(a),L.forEach(a),O=T(C),k=u(C,"ION-CONTENT",{fullscreen:!0});var B=E(k);f=u(B,"ION-LIST",{});var F=E(f);for(let V=0;V<s.length;V+=1)s[V].l(F);F.forEach(a),B.forEach(a),h=T(C),v=u(C,"ION-FOOTER",{});var P=E(v);m=u(P,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),Q(m)!=="svelte-zv7v83"&&(m.textContent=w),P.forEach(a),this.h()},h(){p(n,"color","medium"),p(o,"slot","end"),p(e,"translucent",""),p(k,"fullscreen",""),p(m,"fill","outline"),p(m,"color","tertiary"),p(m,"strong",""),j(m,"width","99%"),j(m,"height","auto")},m(C,L){H(C,e,L),i(e,t),i(t,o),i(o,n),i(t,d),i(t,_),H(C,O,L),H(C,k,L),i(k,f);for(let M=0;M<s.length;M+=1)s[M]&&s[M].m(f,null);H(C,h,L),H(C,v,L),i(v,m),y||(z=[oe(n,"click",l[3]),oe(m,"click",l[1])],y=!0)},p(C,[L]){L&5&&(A=qe(C[0]),s=it(s,L,R,1,C,A,b,f,rt,Vt,null,jt))},i:Ne,o:Ne,d(C){C&&(a(e),a(O),a(k),a(h),a(v));for(let L=0;L<s.length;L+=1)s[L].d();y=!1,Ge(z)}}}function fo(l){let e=document.querySelector("ion-modal");e.componentProps.routeId;let t=e.componentProps.expenses;lt(()=>{});const o=()=>{at.dismiss()};function n(_,g,O,k,f){e.componentProps.ex_amount=O,e.componentProps.ex_concept=g,e.componentProps.ex_type=k,e.componentProps.id_expense=f,Ke("modal-expense",bt,{amount:O,concept:g,type:k,id_expense:f}).then(()=>{}),o()}return[t,o,n,_=>{Ke("modal-expense",bt,{routeId:_}).then(g=>{}),o()},(_,g)=>n(g,_.concept,_.amount,_.type,_.id_expenses)]}class _o extends $e{constructor(e){super(),et(this,e,fo,uo,xe,{})}}const{document:Gt}=Dn;function Kt(l,e,t){const o=l.slice();return o[34]=e[t],o}function Wt(l,e,t){const o=l.slice();return o[34]=e[t],o[36]=t,o}function Xt(l,e,t){const o=l.slice();return o[34]=e[t],o[36]=t,o}function Jt(l){let e,t;return e=new Pn({props:{$$slots:{default:[Eo]},$$scope:{ctx:l}}}),{c(){hn(e.$$.fragment)},l(o){pn(e.$$.fragment,o)},m(o,n){mn(e,o,n),t=!0},p(o,n){const r={};n[0]&1019|n[1]&512&&(r.$$scope={dirty:n,ctx:o}),e.$set(r)},i(o){t||(_t(e.$$.fragment,o),t=!0)},o(o){mt(e.$$.fragment,o),t=!1},d(o){vn(e,o)}}}function ho(l){let e,t='<div id="g_map" style="width: 100%; height: 100vh;"></div>';return{c(){e=c("ion-content"),e.innerHTML=t},l(o){e=u(o,"ION-CONTENT",{"data-svelte-h":!0}),Q(e)!=="svelte-1ydw6i9"&&(e.innerHTML=t)},m(o,n){H(o,e,n)},p:Ne,d(o){o&&a(e)}}}function po(l){let e;function t(r,d){if(r[7].length>0)return vo;if(!r[3])return mo}let o=t(l),n=o&&o(l);return{c(){n&&n.c(),e=Re()},l(r){n&&n.l(r),e=Re()},m(r,d){n&&n.m(r,d),H(r,e,d)},p(r,d){o===(o=t(r))&&n?n.p(r,d):(n&&n.d(1),n=o&&o(r),n&&(n.c(),n.m(e.parentNode,e)))},d(r){r&&a(e),n&&n.d(r)}}}function mo(l){let e,t,o,n='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Jala para actualizar" refreshing-spinner="circles" refreshing-text="Actualizando..."></ion-refresher-content>',r,d,_=[],g=new Map,O,k,f=l[4]&&Qt(l),s=qe(l[5]);const b=h=>h[34].id_event;for(let h=0;h<s.length;h+=1){let v=Kt(l,s,h),m=b(v);g.set(m,_[h]=Zt(m,v))}return{c(){f&&f.c(),e=N(),t=c("ion-content"),o=c("ion-refresher"),o.innerHTML=n,r=N(),d=c("ion-list");for(let h=0;h<_.length;h+=1)_[h].c();this.h()},l(h){f&&f.l(h),e=T(h),t=u(h,"ION-CONTENT",{});var v=E(t);o=u(v,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),Q(o)!=="svelte-1srnbs3"&&(o.innerHTML=n),r=T(v),d=u(v,"ION-LIST",{});var m=E(d);for(let w=0;w<_.length;w+=1)_[w].l(m);m.forEach(a),v.forEach(a),this.h()},h(){p(o,"slot","fixed")},m(h,v){f&&f.m(h,v),H(h,e,v),H(h,t,v),i(t,o),l[26](o),i(t,r),i(t,d);for(let m=0;m<_.length;m+=1)_[m]&&_[m].m(d,null);O||(k=oe(o,"ionRefresh",l[10]),O=!0)},p(h,v){h[4]?f?f.p(h,v):(f=Qt(h),f.c(),f.m(e.parentNode,e)):f&&(f.d(1),f=null),v[0]&167968&&(s=qe(h[5]),_=it(_,v,b,1,h,s,g,d,rt,Zt,null,Kt))},d(h){h&&(a(e),a(t)),f&&f.d(h),l[26](null);for(let v=0;v<_.length;v+=1)_[v].d();O=!1,k()}}}function vo(l){let e,t;function o(d,_){return _[0]&144&&(e=null),e==null&&(e=!!(d[7].filter(Oo).every(No)&&!d[4])),e?bo:go}let n=o(l,[-1,-1]),r=n(l);return{c(){r.c(),t=Re()},l(d){r.l(d),t=Re()},m(d,_){r.m(d,_),H(d,t,_)},p(d,_){n===(n=o(d,_))&&r?r.p(d,_):(r.d(1),r=n(d),r&&(r.c(),r.m(t.parentNode,t)))},d(d){d&&a(t),r.d(d)}}}function Qt(l){let e=l[13]("",l[1],l[0])+"",t;return{c(){t=ue(e)},l(o){t=fe(o,e)},m(o,n){H(o,t,n)},p(o,n){n[0]&3&&e!==(e=o[13]("",o[1],o[0])+"")&&Ae(t,e)},d(o){o&&a(t)}}}function Yt(l){let e;return{c(){e=c("span"),this.h()},l(t){e=u(t,"SPAN",{class:!0}),E(e).forEach(a),this.h()},h(){Z(e,"class","notes svelte-egzizz")},m(t,o){H(t,e,o)},d(t){t&&a(e)}}}function Zt(l,e){let t,o,n,r,d=parseInt(e[34].pos)+1+"",_,g,O,k,f,s,b=e[34].title+"",h,v,m=e[34].support_list&&e[34].support_list.length||e[15](e[34]),w,y,z,A,R,C=m&&Yt();function L(){return e[27](e[34])}return{key:l,first:null,c(){t=c("ion-item"),o=c("ion-avatar"),n=c("div"),r=c("div"),_=ue(d),O=N(),k=c("ion-label"),f=c("ion-text"),s=c("h3"),h=ue(b),v=N(),C&&C.c(),w=N(),y=c("ion-icon"),z=N(),this.h()},l(M){t=u(M,"ION-ITEM",{});var I=E(t);o=u(I,"ION-AVATAR",{slot:!0});var B=E(o);n=u(B,"DIV",{class:!0,title:!0,style:!0});var F=E(n);r=u(F,"DIV",{class:!0});var P=E(r);_=fe(P,d),P.forEach(a),F.forEach(a),B.forEach(a),O=T(I),k=u(I,"ION-LABEL",{button:!0});var V=E(k);f=u(V,"ION-TEXT",{color:!0});var G=E(f);s=u(G,"H3",{});var W=E(s);h=fe(W,b),v=T(W),C&&C.l(W),W.forEach(a),G.forEach(a),V.forEach(a),w=T(I),y=u(I,"ION-ICON",{icon:!0,slot:!0,style:!0}),E(y).forEach(a),z=T(I),I.forEach(a),this.h()},h(){Z(r,"class","order svelte-egzizz"),Z(n,"class","order-wrapper svelte-egzizz"),Z(n,"title",g=Ye(e[34].status)),j(n,"background-color",De(e[34].status,e[34].date_service)),j(n,"color",Ze(De(e[34].status))),p(o,"slot","start"),p(f,"color","#2e2e2e"),p(k,"button",""),p(y,"icon",tt),p(y,"slot","end"),j(y,"color",De(e[34].status,e[34].date_service)),this.first=t},m(M,I){H(M,t,I),i(t,o),i(o,n),i(n,r),i(r,_),i(t,O),i(t,k),i(k,f),i(f,s),i(s,h),i(s,v),C&&C.m(s,null),i(t,w),i(t,y),i(t,z),A||(R=oe(k,"click",L),A=!0)},p(M,I){e=M,I[0]&32&&d!==(d=parseInt(e[34].pos)+1+"")&&Ae(_,d),I[0]&32&&g!==(g=Ye(e[34].status))&&Z(n,"title",g),I[0]&32&&j(n,"background-color",De(e[34].status,e[34].date_service)),I[0]&32&&j(n,"color",Ze(De(e[34].status))),I[0]&32&&b!==(b=e[34].title+"")&&Ae(h,b),I[0]&32&&(m=e[34].support_list&&e[34].support_list.length||e[15](e[34])),m?C||(C=Yt(),C.c(),C.m(s,null)):C&&(C.d(1),C=null),I[0]&32&&j(y,"color",De(e[34].status,e[34].date_service))},d(M){M&&a(t),C&&C.d(),A=!1,R()}}}function go(l){let e=l[13](l[7],l[1],l[0])+"",t,o,n,r,d='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Pull to refresh" refreshing-spinner="circles" refreshing-text="Refreshing..."></ion-refresher-content>',_,g,O=[],k=new Map,f,s,b=qe(l[5]);const h=v=>v[34].id_event;for(let v=0;v<b.length;v+=1){let m=Wt(l,b,v),w=h(m);k.set(w,O[v]=$t(w,m))}return{c(){t=ue(e),o=N(),n=c("ion-content"),r=c("ion-refresher"),r.innerHTML=d,_=N(),g=c("ion-list");for(let v=0;v<O.length;v+=1)O[v].c();this.h()},l(v){t=fe(v,e),o=T(v),n=u(v,"ION-CONTENT",{});var m=E(n);r=u(m,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),Q(r)!=="svelte-dvt1s"&&(r.innerHTML=d),_=T(m),g=u(m,"ION-LIST",{});var w=E(g);for(let y=0;y<O.length;y+=1)O[y].l(w);w.forEach(a),m.forEach(a),this.h()},h(){p(r,"slot","fixed")},m(v,m){H(v,t,m),H(v,o,m),H(v,n,m),i(n,r),l[24](r),i(n,_),i(n,g);for(let w=0;w<O.length;w+=1)O[w]&&O[w].m(g,null);f||(s=oe(r,"ionRefresh",l[10]),f=!0)},p(v,m){m[0]&131&&e!==(e=v[13](v[7],v[1],v[0])+"")&&Ae(t,e),m[0]&299040&&(b=qe(v[5]),O=it(O,m,h,1,v,b,k,g,rt,$t,null,Wt))},d(v){v&&(a(t),a(o),a(n)),l[24](null);for(let m=0;m<O.length;m+=1)O[m].d();f=!1,s()}}}function bo(l){let e,t,o='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Jale para actualizar" refreshing-spinner="circles" refreshing-text="Actualizando..."></ion-refresher-content>',n,r,d=[],_=new Map,g,O,k=qe(l[5]);const f=s=>s[34].id_event;for(let s=0;s<k.length;s+=1){let b=Xt(l,k,s),h=f(b);_.set(h,d[s]=tn(h,b))}return{c(){e=c("ion-content"),t=c("ion-refresher"),t.innerHTML=o,n=N(),r=c("ion-list");for(let s=0;s<d.length;s+=1)d[s].c();this.h()},l(s){e=u(s,"ION-CONTENT",{});var b=E(e);t=u(b,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),Q(t)!=="svelte-15ukrgn"&&(t.innerHTML=o),n=T(b),r=u(b,"ION-LIST",{});var h=E(r);for(let v=0;v<d.length;v+=1)d[v].l(h);h.forEach(a),b.forEach(a),this.h()},h(){p(t,"slot","fixed")},m(s,b){H(s,e,b),i(e,t),l[22](t),i(e,n),i(e,r);for(let h=0;h<d.length;h+=1)d[h]&&d[h].m(r,null);g||(O=oe(t,"ionRefresh",l[10]),g=!0)},p(s,b){b[0]&299040&&(k=qe(s[5]),d=it(d,b,f,1,s,k,_,r,rt,tn,null,Xt))},d(s){s&&a(e),l[22](null);for(let b=0;b<d.length;b+=1)d[b].d();g=!1,O()}}}function xt(l){let e;return{c(){e=c("span"),this.h()},l(t){e=u(t,"SPAN",{class:!0}),E(e).forEach(a),this.h()},h(){Z(e,"class","notes svelte-egzizz")},m(t,o){H(t,e,o)},d(t){t&&a(e)}}}function $t(l,e){let t,o,n,r,d=parseInt(e[34].pos)+1+"",_,g,O,k,f,s,b=e[34].title+"",h,v,m=e[34].support_list&&e[34].support_list.length||e[15](e[34]),w,y,z="",A,R,C,L,M,I=m&&xt();function B(){return e[25](e[34],e[36])}return{key:l,first:null,c(){t=c("ion-item"),o=c("ion-avatar"),n=c("div"),r=c("div"),_=ue(d),O=N(),k=c("ion-label"),f=c("ion-text"),s=c("h3"),h=ue(b),v=N(),I&&I.c(),w=N(),y=c("div"),y.innerHTML=z,A=N(),R=c("ion-icon"),C=N(),this.h()},l(F){t=u(F,"ION-ITEM",{});var P=E(t);o=u(P,"ION-AVATAR",{slot:!0});var V=E(o);n=u(V,"DIV",{class:!0,title:!0,style:!0});var G=E(n);r=u(G,"DIV",{class:!0});var W=E(r);_=fe(W,d),W.forEach(a),G.forEach(a),V.forEach(a),O=T(P),k=u(P,"ION-LABEL",{button:!0});var $=E(k);f=u($,"ION-TEXT",{color:!0});var Ee=E(f);s=u(Ee,"H3",{});var ie=E(s);h=fe(ie,b),v=T(ie),I&&I.l(ie),ie.forEach(a),Ee.forEach(a),w=T($),y=u($,"DIV",{class:!0,"data-svelte-h":!0}),Q(y)!=="svelte-qaecoo"&&(y.innerHTML=z),$.forEach(a),A=T(P),R=u(P,"ION-ICON",{icon:!0,slot:!0}),E(R).forEach(a),C=T(P),P.forEach(a),this.h()},h(){Z(r,"class","order svelte-egzizz"),Z(n,"class","order-wrapper svelte-egzizz"),Z(n,"title",g=Ye(e[34].status)),j(n,"background-color",De(e[34].status,e[34].date_service)),j(n,"color",Ze(De(e[34].status))),p(o,"slot","start"),p(f,"color","#2e2e2e"),Z(y,"class","sub svelte-egzizz"),p(k,"button",""),p(R,"icon",tt),p(R,"slot","end"),this.first=t},m(F,P){H(F,t,P),i(t,o),i(o,n),i(n,r),i(r,_),i(t,O),i(t,k),i(k,f),i(f,s),i(s,h),i(s,v),I&&I.m(s,null),i(k,w),i(k,y),i(t,A),i(t,R),i(t,C),L||(M=oe(k,"click",B),L=!0)},p(F,P){e=F,P[0]&32&&d!==(d=parseInt(e[34].pos)+1+"")&&Ae(_,d),P[0]&32&&g!==(g=Ye(e[34].status))&&Z(n,"title",g),P[0]&32&&j(n,"background-color",De(e[34].status,e[34].date_service)),P[0]&32&&j(n,"color",Ze(De(e[34].status))),P[0]&32&&b!==(b=e[34].title+"")&&Ae(h,b),P[0]&32&&(m=e[34].support_list&&e[34].support_list.length||e[15](e[34])),m?I||(I=xt(),I.c(),I.m(s,null)):I&&(I.d(1),I=null)},d(F){F&&a(t),I&&I.d(),L=!1,M()}}}function en(l){let e;return{c(){e=c("span"),this.h()},l(t){e=u(t,"SPAN",{class:!0}),E(e).forEach(a),this.h()},h(){Z(e,"class","notes svelte-egzizz")},m(t,o){H(t,e,o)},d(t){t&&a(e)}}}function tn(l,e){let t,o,n,r,d=parseInt(e[34].pos)+1+"",_,g,O,k,f,s,b=e[34].title+"",h,v,m=e[34].support_list&&e[34].support_list.length||e[15](e[34]),w,y,z="",A,R,C,L,M,I=m&&en();function B(){return e[23](e[34],e[36])}return{key:l,first:null,c(){t=c("ion-item"),o=c("ion-avatar"),n=c("div"),r=c("div"),_=ue(d),O=N(),k=c("ion-label"),f=c("ion-text"),s=c("h3"),h=ue(b),v=N(),I&&I.c(),w=N(),y=c("div"),y.innerHTML=z,A=N(),R=c("ion-icon"),C=N(),this.h()},l(F){t=u(F,"ION-ITEM",{});var P=E(t);o=u(P,"ION-AVATAR",{slot:!0});var V=E(o);n=u(V,"DIV",{class:!0,title:!0,style:!0});var G=E(n);r=u(G,"DIV",{class:!0});var W=E(r);_=fe(W,d),W.forEach(a),G.forEach(a),V.forEach(a),O=T(P),k=u(P,"ION-LABEL",{button:!0});var $=E(k);f=u($,"ION-TEXT",{color:!0});var Ee=E(f);s=u(Ee,"H3",{});var ie=E(s);h=fe(ie,b),v=T(ie),I&&I.l(ie),ie.forEach(a),Ee.forEach(a),w=T($),y=u($,"DIV",{class:!0,"data-svelte-h":!0}),Q(y)!=="svelte-qaecoo"&&(y.innerHTML=z),$.forEach(a),A=T(P),R=u(P,"ION-ICON",{icon:!0,slot:!0}),E(R).forEach(a),C=T(P),P.forEach(a),this.h()},h(){Z(r,"class","order svelte-egzizz"),Z(n,"class","order-wrapper svelte-egzizz"),Z(n,"title",g=Ye(e[34].status)),j(n,"background-color",De(e[34].status,e[34].date_service)),j(n,"color",Ze(De(e[34].status))),p(o,"slot","start"),p(f,"color","#2e2e2e"),Z(y,"class","sub svelte-egzizz"),p(k,"button",""),p(R,"icon",tt),p(R,"slot","end"),this.first=t},m(F,P){H(F,t,P),i(t,o),i(o,n),i(n,r),i(r,_),i(t,O),i(t,k),i(k,f),i(f,s),i(s,h),i(s,v),I&&I.m(s,null),i(k,w),i(k,y),i(t,A),i(t,R),i(t,C),L||(M=oe(k,"click",B),L=!0)},p(F,P){e=F,P[0]&32&&d!==(d=parseInt(e[34].pos)+1+"")&&Ae(_,d),P[0]&32&&g!==(g=Ye(e[34].status))&&Z(n,"title",g),P[0]&32&&j(n,"background-color",De(e[34].status,e[34].date_service)),P[0]&32&&j(n,"color",Ze(De(e[34].status))),P[0]&32&&b!==(b=e[34].title+"")&&Ae(h,b),P[0]&32&&(m=e[34].support_list&&e[34].support_list.length||e[15](e[34])),m?I||(I=en(),I.c(),I.m(s,null)):I&&(I.d(1),I=null)},d(F){F&&a(t),I&&I.d(),L=!1,M()}}}function Eo(l){let e,t,o,n,r=`<ion-icon icon="${Ln}"></ion-icon>`,d,_,g,O=`<ion-icon icon="${Sn}"></ion-icon>`,k,f,s=(l[6].name?l[6].name.toUpperCase():"")+"",b,h,v,m='<ion-segment-button value="list"><ion-label>Paradas</ion-label></ion-segment-button> <ion-segment-button value="map"><ion-label>Mapa</ion-label></ion-segment-button>',w,y,z,A;function R(M,I){if(M[9]==="list")return po;if(M[9]==="map")return ho}let C=R(l),L=C&&C(l);return{c(){e=c("ion-header"),t=c("ion-toolbar"),o=c("ion-buttons"),n=c("ion-button"),n.innerHTML=r,d=N(),_=c("ion-buttons"),g=c("ion-button"),g.innerHTML=O,k=N(),f=c("ion-title"),b=ue(s),h=N(),v=c("ion-segment"),v.innerHTML=m,w=N(),L&&L.c(),y=Re(),this.h()},l(M){e=u(M,"ION-HEADER",{translucent:!0});var I=E(e);t=u(I,"ION-TOOLBAR",{});var B=E(t);o=u(B,"ION-BUTTONS",{slot:!0});var F=E(o);n=u(F,"ION-BUTTON",{title:!0,alt:!0,"data-svelte-h":!0}),Q(n)!=="svelte-7ppz3r"&&(n.innerHTML=r),F.forEach(a),d=T(B),_=u(B,"ION-BUTTONS",{slot:!0});var P=E(_);g=u(P,"ION-BUTTON",{"data-svelte-h":!0}),Q(g)!=="svelte-nf50hj"&&(g.innerHTML=O),P.forEach(a),k=T(B),f=u(B,"ION-TITLE",{});var V=E(f);b=fe(V,s),V.forEach(a),B.forEach(a),h=T(I),v=u(I,"ION-SEGMENT",{value:!0,"data-svelte-h":!0}),Q(v)!=="svelte-lue4c9"&&(v.innerHTML=m),I.forEach(a),w=T(M),L&&L.l(M),y=Re(),this.h()},h(){p(n,"title","Atrás"),p(n,"alt","Atrás"),p(o,"slot","start"),p(_,"slot","end"),p(v,"value","list"),p(e,"translucent","")},m(M,I){H(M,e,I),i(e,t),i(t,o),i(o,n),i(t,d),i(t,_),i(_,g),i(t,k),i(t,f),i(f,b),i(e,h),i(e,v),H(M,w,I),L&&L.m(M,I),H(M,y,I),z||(A=[oe(n,"click",l[16]),oe(g,"click",l[20]),oe(v,"ionChange",l[21])],z=!0)},p(M,I){I[0]&64&&s!==(s=(M[6].name?M[6].name.toUpperCase():"")+"")&&Ae(b,s),C===(C=R(M))&&L?L.p(M,I):(L&&L.d(1),L=C&&C(M),L&&(L.c(),L.m(y.parentNode,y)))},d(M){M&&(a(e),a(w),a(y)),L&&L.d(M),z=!1,Ge(A)}}}function Io(l){let e,t,o,n=l[2]&&Jt(l);return{c(){e=N(),n&&n.c(),t=Re(),this.h()},l(r){un("svelte-kn0kph",Gt.head).forEach(a),e=T(r),n&&n.l(r),t=Re(),this.h()},h(){Gt.title="Rutaflow - Detalles de ruta"},m(r,d){H(r,e,d),n&&n.m(r,d),H(r,t,d),o=!0},p(r,d){r[2]?n?(n.p(r,d),d[0]&4&&_t(n,1)):(n=Jt(r),n.c(),_t(n,1),n.m(t.parentNode,t)):n&&(gn(),mt(n,1,1,()=>{n=null}),dn())},i(r){o||(_t(n),o=!0)},o(r){mt(n),o=!1},d(r){r&&(a(e),a(t)),n&&n.d(r)}}}function De(l,e=""){let t="#ffffff";return l==="pending"&&!e?t="#f2e300":l=="pending"&&e?t="#F6A833":l==="completed"&&(t="#44d900"),t}function Ye(l){let e="";return l=="pending"?e="Pendiente":l=="completed"&&(e="Completado"),e}function Ze(l){l.slice(0,1)==="#"&&(l=l.slice(1)),l.length===3&&(l=l.split("").map(function(r){return r+r}).join(""));const e=parseInt(l.substr(0,2),16),t=parseInt(l.substr(2,2),16),o=parseInt(l.substr(4,2),16);return(e*299+t*587+o*114)/1e3>=128?"#414040":"#fff"}function ko(l,e){let t=new FormData;return t.append("id_route",l),t.append("status",e),fetch("https://app.rutaflow.com/api/admin/route/change_status.php",{method:"POST",body:t}).then(o=>o.json()).then(o=>{}).catch(o=>{console.error("Error fetching data:",o)}),""}const Oo=l=>l.mandatory==="1",No=l=>l.img;function To(l,e,t){let o;fn(l,Mn,S=>t(19,o=S));var n=this&&this.__awaiter||function(S,q,U,X){function te(J){return J instanceof U?J:new U(function(re){re(J)})}return new(U||(U=Promise))(function(J,re){function le(ae){try{_e(X.next(ae))}catch(ve){re(ve)}}function pe(ae){try{_e(X.throw(ae))}catch(ve){re(ve)}}function _e(ae){ae.done?J(ae.value):te(ae.value).then(le,pe)}_e((X=X.apply(S,q||[])).next())})};let{routeId:r}=e,{driverId:d}=e,_=new Object,g=!0,O=!1,k=[],f={},s=[],b=[],h,v=!1,m="list",w;const y=()=>n(void 0,void 0,void 0,function*(){yield A(r),h.complete()});lt(()=>n(void 0,void 0,void 0,function*(){d=="41"&&(localStorage.clear(),console.log("Cleared session from localStorage")),yield A(r)}));function z(S){return n(this,void 0,void 0,function*(){if(t(9,m=S),m==="map"){yield _n(),w=document.getElementById("g_map");const q=new google.maps.Map(w,{zoom:8,center:{lat:20.6745683,lng:-103.3986104},mapId:"4504f8b37365c3d0"}),U=new google.maps.LatLngBounds,{AdvancedMarkerElement:X,PinElement:te}=yield google.maps.importLibrary("marker");navigator.geolocation?navigator.geolocation.getCurrentPosition(function(J){const re=new google.maps.LatLng(J.coords.latitude,J.coords.longitude);new google.maps.Marker({position:re,map:q,icon:{path:google.maps.SymbolPath.CIRCLE,fillColor:"#0062ff",fillOpacity:1,scale:6,strokeColor:"#ffffff",strokeWeight:2}}),new google.maps.Circle({strokeColor:"#00BFFF",strokeOpacity:.5,strokeWeight:1,fillColor:"#00BFFF",fillOpacity:.2,map:q,center:re,radius:J.coords.accuracy}),U.extend(re)},function(J){console.error("Error retrieving location:",J)}):console.error("Geolocation not supported by this browser."),k.forEach((J,re)=>{const le=parseFloat(J.lat),pe=parseFloat(J.lon),_e=new google.maps.LatLng(le,pe),ae=new google.maps.Marker({position:{lat:le,lng:pe},map:q,title:J.title}),ve=new te({background:De(J.status,J.date_service),borderColor:"#000",glyphColor:"#000",glyph:(parseInt(J.pos)+1).toString()});new X({map:q,position:_e,content:ve.element,title:"Parada "+(parseInt(J.pos)+1).toString()+": "+J.title}).addListener("click",function(Fe){C(J,P(re))}),U.extend(ae.getPosition())}),q.fitBounds(U)}})}function A(S){return n(this,void 0,void 0,function*(){const q=new FormData;q.append("id_route",S);try{const X=yield(yield fetch("https://app.rutaflow.com/api/admin/report/seguimiento_list.php",{method:"POST",body:q})).json();t(6,f=X.data.seguimiento_list[0]),t(5,k=X.data.event_list),t(7,s=X.data.checklist),b=X.data.expenses,f&&t(4,O=f.km_inicial=="0"&&f.gas_inicial=="0"),t(3,g=!1)}catch(U){t(3,g=!1),console.error("Error fetching data:",U)}})}const R=S=>new Promise((q,U)=>{const X=new FormData;X.append("id_route",S.id_route),X.append("id_event",S.id_event),fetch("https://app.rutaflow.com/api/admin/evidence/evidence_by_event.php",{method:"POST",body:X}).then(te=>te.json()).then(te=>{q(te.data.event_evidence[0])}).catch(te=>{console.error("Error fetching data:",te),U(te)})}),C=(S,q)=>{R(S).then(U=>{U&&(S.img=U.img,S.driver_comments=U.driver_comments,S.comments=U.comments),Ke("modal-delivery-info",io,{delivery:S,isLast:q}).then(X=>{}).finally(()=>{A(r)})})},L=(S,q,U)=>{var X=!1;return v||(v=!0,Ke("modal-checklist",an,{checklist:S,driverId:q,routeId:U,isLast:X}).then(te=>{v=!1}),ko(U,"checklist")),""},M=S=>n(void 0,void 0,void 0,function*(){return yield A(S),b.length>0?Ke("modal-expense-detail",_o,{routeId:S,expenses:b}).then(q=>{}):Ke("modal-expense",bt,{routeId:S}).then(q=>{}),""}),I=S=>{if(S.tracking_type=="subscription"){if(S.subscriber_info&&S.payment_type==="cash"&&new Date(S.subscriber_info.payment_next)<new Date)return!0}else if(S.tracking_type=="ecommerce"&&Number(S.payment_pending)>0)return!0;return!1},B=()=>{_.type=="super"||_.type=="admin"?Xe("/drivers/me"):_.id_driver&&Xe(`/drivers/${_.id_driver}`)},F=(S,q)=>n(void 0,void 0,void 0,function*(){yield(yield We.create({header:S||"Error",message:q||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()});function P(S){return S===k.length-1}const V=()=>M(r),G=S=>z(S.detail.value);function W(S){Be[S?"unshift":"push"](()=>{h=S,t(8,h)})}const $=(S,q)=>C(S,P(q));function Ee(S){Be[S?"unshift":"push"](()=>{h=S,t(8,h)})}const ie=(S,q)=>C(S,P(q));function he(S){Be[S?"unshift":"push"](()=>{h=S,t(8,h)})}const Oe=S=>{const q=k.findIndex(re=>re.id_event===S.id_event),U=q===0,X=q>0?k[q-1]:null,te=U||X&&X.img!==null,J=S.img!==null&&S.img!=="";te||U&&!J?C(S):F("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")};return l.$$set=S=>{"routeId"in S&&t(0,r=S.routeId),"driverId"in S&&t(1,d=S.driverId)},l.$$.update=()=>{l.$$.dirty[0]&524293&&(t(0,{routeId:r,driverId:d}=o.params,r,(t(1,d),t(19,o),t(2,_),t(0,r))),t(2,_=JSON.parse(localStorage.getItem("userSession"))),_?_.id_user&&(_.type=="admin"||_.type=="super")?(A(r),Xe(`/drivers/me/routes/${r}`)):_.id_user&&_.id_driver&&(A(r),Xe(`/drivers/${_.id_driver}/routes/${r}`)):Xe("/"))},[r,d,_,g,O,k,f,s,h,m,y,z,C,L,M,I,B,F,P,o,V,G,W,$,Ee,ie,he,Oe]}class Ao extends $e{constructor(e){super(),et(this,e,To,Io,xe,{routeId:0,driverId:1},null,[-1,-1])}}export{Ao as component};

import{Z as Et,s as xe,e as s,j as N,b as c,q as E,d as Q,h as a,m as T,v as g,i as F,w as r,x as le,n as ye,z as Ge,_ as sn,B as G,o as it,k as Ue,$ as It,t as fe,r as _e,f as x,a0 as cn,a1 as ot,A as He,y as ze,a2 as dt,l as un,p as fn,F as _n}from"../chunks/index.BYLndrM5.js";import{S as $e,i as et,t as _t,a as mt,c as dn,b as hn,d as pn,m as mn,e as vn,g as gn}from"../chunks/index.BNHbygFo.js";import{e as je,u as lt,d as rt,a as bn,c as vt,b as nn,f as En,g as In,i as on,h as kn,j as ln,k as On,m as Nn,s as kt,n as tt,o as Tn,q as Cn,r as yn,t as wn,v as Ln,w as Sn,p as Mn}from"../chunks/index.CNNCy6Ex.js";import"../chunks/index-48209844.IIRtDZyg.js";import{m as at,D as ht,a as Xe,I as An}from"../chunks/IonPage.BVdVa1Lg.js";import{q as Pn,t as Dn}from"../chunks/ion-modal.CsJaVgKZ.js";import{g as We}from"../chunks/entry.BmW3zoA4.js";const Bn=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global,zn=(l,e)=>{if(!customElements.get(l)){class t extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const n={};for(const i of this.attributes)n[i.name]=i.value;new e({target:this.shadowRoot,props:n})}}customElements.define(l,t)}},Hn=function(l){return document.createElement(l).constructor!==HTMLElement},Rn=(l,e)=>{Hn(l)||zn(l,e)},Ke=async(l,e,t)=>{Pn(),Dn(),Rn(l,e);const o=await at.create({component:l,componentProps:t});return o.present(),await o.onWillDismiss()};let Ye=Et({km_inicial:[],gas_inicial:[],km_final:[],gas_final:[]}),rn=Et({flag:[]});function Un(l){let e,t,o,n,i="Cancelar",d,_,p="Captura de Km/Gas",O,I,f,u="Confirmar",b,m,h,v,L,C,j;return{c(){e=s("ion-header"),t=s("ion-toolbar"),o=s("ion-buttons"),n=s("ion-button"),n.textContent=i,d=N(),_=s("ion-title"),_.textContent=p,O=N(),I=s("ion-buttons"),f=s("ion-button"),f.textContent=u,b=N(),m=s("ion-content"),h=s("ion-item"),v=s("ion-input"),this.h()},l(D){e=c(D,"ION-HEADER",{translucent:!0});var z=E(e);t=c(z,"ION-TOOLBAR",{});var w=E(t);o=c(w,"ION-BUTTONS",{slot:!0});var y=E(o);n=c(y,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),Q(n)!=="svelte-17pq4f4"&&(n.textContent=i),y.forEach(a),d=T(w),_=c(w,"ION-TITLE",{"data-svelte-h":!0}),Q(_)!=="svelte-1yhkaq7"&&(_.textContent=p),O=T(w),I=c(w,"ION-BUTTONS",{slot:!0});var A=E(I);f=c(A,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),Q(f)!=="svelte-cm6j4s"&&(f.textContent=u),A.forEach(a),w.forEach(a),z.forEach(a),b=T(D),m=c(D,"ION-CONTENT",{fullscreen:!0});var k=E(m);h=c(k,"ION-ITEM",{});var S=E(h);v=c(S,"ION-INPUT",{class:!0,inputmode:!0,pattern:!0,type:!0,placeholder:!0,value:!0,required:!0});var V=E(v);V.forEach(a),S.forEach(a),k.forEach(a),this.h()},h(){g(n,"color","medium"),g(o,"slot","start"),g(f,"strong",""),g(I,"slot","end"),g(e,"translucent",""),g(v,"class","fin-km"),g(v,"inputmode","numeric"),g(v,"pattern","[0-9]*"),g(v,"type","number"),g(v,"placeholder",L="Ingresa "+l[0]+" actual"),g(v,"value",l[1]),g(v,"required",""),g(m,"fullscreen","")},m(D,z){F(D,e,z),r(e,t),r(t,o),r(o,n),r(t,d),r(t,_),r(t,O),r(t,I),r(I,f),F(D,b,z),F(D,m,z),r(m,h),r(h,v),C||(j=[le(n,"click",l[2]),le(f,"click",l[3]),le(v,"input",l[4])],C=!0)},p(D,[z]){z&1&&L!==(L="Ingresa "+D[0]+" actual")&&g(v,"placeholder",L),z&2&&g(v,"value",D[1])},i:ye,o:ye,d(D){D&&(a(e),a(b),a(m)),C=!1,Ge(j)}}}function Fn(l,e,t){const o=sn();let n=document.querySelector("ion-modal"),i=n.componentProps.data_type;n.componentProps.isLast;let d;rn.subscribe(f=>{i=f.flag[0],i=="km_final"||i=="km_inicial"?t(0,d="kilometraje"):t(0,d="litros de gasolina")});let _=0;function p(){at.dismiss()}function O(){o("modalResult",{data:"Your data",role:"confirm"}),i=="km_inicial"?Ye.update(u=>({...u,km_inicial:[_]})):i=="gas_inicial"?Ye.update(u=>({...u,gas_inicial:[_]})):i=="km_final"?Ye.update(u=>({...u,km_final:[_]})):i=="gas_final"&&Ye.update(u=>({...u,gas_final:[_]})),p()}return[d,_,p,O,f=>t(1,_=f.target.value)]}class qn extends $e{constructor(e){super(),et(this,e,Fn,Un,xe,{})}}const pt=Et({items:[],checkedIndices:[],mandatory:[]});function wt(l,e,t){const o=l.slice();return o[53]=e[t],o[54]=e,o[55]=t,o}function jn(l){let e,t,o,n,i,d="Kilometraje inicial",_,p,O=l[0]?l[0]+" km.":"Cargar km",I,f,u,b,m,h,v,L="Gasolina inicial (litros)",C,j,D=l[1]?l[1]+" litros":"Cargar gas",z,w,y,A;return w=It(l[21][0]),{c(){e=s("ion-item"),t=s("ion-label"),o=s("input"),n=N(),i=s("p"),i.textContent=d,_=N(),p=s("ion-button"),I=fe(O),f=N(),u=s("ion-item"),b=s("ion-label"),m=s("input"),h=N(),v=s("p"),v.textContent=L,C=N(),j=s("ion-button"),z=fe(D),this.h()},l(k){e=c(k,"ION-ITEM",{});var S=E(e);t=c(S,"ION-LABEL",{style:!0});var V=E(t);o=c(V,"INPUT",{id:!0,style:!0,type:!0}),n=T(V),i=c(V,"P",{style:!0,"data-svelte-h":!0}),Q(i)!=="svelte-88twxi"&&(i.textContent=d),V.forEach(a),_=T(S),p=c(S,"ION-BUTTON",{fill:!0,size:!0,class:!0,"aria-selected":!0});var M=E(p);I=_e(M,O),M.forEach(a),S.forEach(a),f=T(k),u=c(k,"ION-ITEM",{});var K=E(u);b=c(K,"ION-LABEL",{style:!0});var W=E(b);m=c(W,"INPUT",{id:!0,style:!0,type:!0}),h=T(W),v=c(W,"P",{style:!0,"data-svelte-h":!0}),Q(v)!=="svelte-1ux30eb"&&(v.textContent=L),W.forEach(a),C=T(K),j=c(K,"ION-BUTTON",{fill:!0,class:!0,size:!0,style:!0});var X=E(j);z=_e(X,D),X.forEach(a),K.forEach(a),this.h()},h(){x(o,"id","chkbox-km-ini"),G(o,"pointer-events","auto"),x(o,"type","checkbox"),o.required=!0,G(i,"margin-left","10px"),G(t,"display","flex"),g(p,"fill","outline"),g(p,"size","small"),g(p,"class","loadKmInicial"),g(p,"aria-selected",""),x(m,"id","chkbox-gas-ini"),G(m,"pointer-events","auto"),x(m,"type","checkbox"),m.required=!0,G(v,"margin-left","10px"),G(b,"display","flex"),g(j,"fill","outline"),g(j,"class","loadGasInicial"),g(j,"size","small"),G(j,"height","16px "),w.p(o,m)},m(k,S){F(k,e,S),r(e,t),r(t,o),o.checked=~(l[4]||[]).indexOf(o.__value),l[28](o),r(t,n),r(t,i),r(e,_),r(e,p),r(p,I),F(k,f,S),F(k,u,S),r(u,b),r(b,m),l[30](m),m.checked=~(l[4]||[]).indexOf(m.__value),r(b,h),r(b,v),r(u,C),r(u,j),r(j,z),y||(A=[le(o,"change",l[27]),le(p,"click",l[29]),le(m,"change",l[31]),le(j,"click",l[32])],y=!0)},p(k,S){S[0]&16&&(o.checked=~(k[4]||[]).indexOf(o.__value)),S[0]&1&&O!==(O=k[0]?k[0]+" km.":"Cargar km")&&ze(I,O),S[0]&16&&(m.checked=~(k[4]||[]).indexOf(m.__value)),S[0]&2&&D!==(D=k[1]?k[1]+" litros":"Cargar gas")&&ze(z,D)},d(k){k&&(a(e),a(f),a(u)),l[28](null),l[30](null),w.r(),y=!1,Ge(A)}}}function Vn(l){let e,t,o,n,i,d="Kilometraje final",_,p,O=l[2]?l[2]+" km.":"Cargar km",I,f,u,b,m,h,v,L="Gasolina final (litros)",C,j,D=l[3]?l[3]+" litros":"Cargar gas",z,w,y,A;return w=It(l[21][0]),{c(){e=s("ion-item"),t=s("ion-label"),o=s("input"),n=N(),i=s("p"),i.textContent=d,_=N(),p=s("ion-button"),I=fe(O),f=N(),u=s("ion-item"),b=s("ion-label"),m=s("input"),h=N(),v=s("p"),v.textContent=L,C=N(),j=s("ion-button"),z=fe(D),this.h()},l(k){e=c(k,"ION-ITEM",{});var S=E(e);t=c(S,"ION-LABEL",{style:!0});var V=E(t);o=c(V,"INPUT",{id:!0,style:!0,type:!0}),n=T(V),i=c(V,"P",{style:!0,"data-svelte-h":!0}),Q(i)!=="svelte-ccmu71"&&(i.textContent=d),V.forEach(a),_=T(S),p=c(S,"ION-BUTTON",{fill:!0,size:!0,class:!0,"aria-selected":!0});var M=E(p);I=_e(M,O),M.forEach(a),S.forEach(a),f=T(k),u=c(k,"ION-ITEM",{});var K=E(u);b=c(K,"ION-LABEL",{style:!0});var W=E(b);m=c(W,"INPUT",{id:!0,style:!0,type:!0}),h=T(W),v=c(W,"P",{style:!0,"data-svelte-h":!0}),Q(v)!=="svelte-wsoyd2"&&(v.textContent=L),W.forEach(a),C=T(K),j=c(K,"ION-BUTTON",{fill:!0,size:!0,class:!0});var X=E(j);z=_e(X,D),X.forEach(a),K.forEach(a),this.h()},h(){x(o,"id","chkbox-km-fin"),G(o,"pointer-events","auto"),x(o,"type","checkbox"),o.required=!0,G(i,"margin-left","10px"),G(t,"display","flex"),g(p,"fill","outline"),g(p,"size","small"),g(p,"class","loadKmInicial"),g(p,"aria-selected",""),x(m,"id","chkbox-gas-fin"),G(m,"pointer-events","auto"),x(m,"type","checkbox"),m.required=!0,G(v,"margin-left","10px"),G(b,"display","flex"),g(j,"fill","outline"),g(j,"size","small"),g(j,"class","loadGasInicial"),w.p(o,m)},m(k,S){F(k,e,S),r(e,t),r(t,o),o.checked=~(l[4]||[]).indexOf(o.__value),l[22](o),r(t,n),r(t,i),r(e,_),r(e,p),r(p,I),F(k,f,S),F(k,u,S),r(u,b),r(b,m),m.checked=~(l[4]||[]).indexOf(m.__value),l[25](m),r(b,h),r(b,v),r(u,C),r(u,j),r(j,z),y||(A=[le(o,"change",l[20]),le(p,"click",l[23]),le(m,"change",l[24]),le(j,"click",l[26])],y=!0)},p(k,S){S[0]&16&&(o.checked=~(k[4]||[]).indexOf(o.__value)),S[0]&4&&O!==(O=k[2]?k[2]+" km.":"Cargar km")&&ze(I,O),S[0]&16&&(m.checked=~(k[4]||[]).indexOf(m.__value)),S[0]&8&&D!==(D=k[3]?k[3]+" litros":"Cargar gas")&&ze(z,D)},d(k){k&&(a(e),a(f),a(u)),l[22](null),l[25](null),w.r(),y=!1,Ge(A)}}}function Gn(l){let e=[],t=new Map,o,n=je(l[13]);const i=d=>d[53].id_checklist_event;for(let d=0;d<n.length;d+=1){let _=wt(l,n,d),p=i(_);t.set(p,e[d]=Lt(p,_))}return{c(){for(let d=0;d<e.length;d+=1)e[d].c();o=Ue()},l(d){for(let _=0;_<e.length;_+=1)e[_].l(d);o=Ue()},m(d,_){for(let p=0;p<e.length;p+=1)e[p]&&e[p].m(d,_);F(d,o,_)},p(d,_){_[0]&407664&&(n=je(d[13]),e=lt(e,_,i,1,d,n,t,o.parentNode,rt,Lt,o,wt))},d(d){d&&a(o);for(let _=0;_<e.length;_+=1)e[_].d(d)}}}function Kn(l){let e,t=(l[12][l[53].id_checklist_event]?l[12][l[53].id_checklist_event]:"Cargar evidencia")+"",o;return{c(){e=s("label"),o=fe(t),this.h()},l(n){e=c(n,"LABEL",{for:!0,class:!0});var i=E(e);o=_e(i,t),i.forEach(a),this.h()},h(){x(e,"for","chklist-"+l[53].id_checklist_event),x(e,"class","button-label svelte-1ruehls")},m(n,i){F(n,e,i),r(e,o)},p(n,i){i[0]&4096&&t!==(t=(n[12][n[53].id_checklist_event]?n[12][n[53].id_checklist_event]:"Cargar evidencia")+"")&&ze(o,t)},d(n){n&&a(e)}}}function Wn(l){let e;return{c(){e=s("ion-spinner"),this.h()},l(t){e=c(t,"ION-SPINNER",{name:!0,class:!0}),E(e).forEach(a),this.h()},h(){g(e,"name","dots"),g(e,"class","button-spinner svelte-1ruehls")},m(t,o){F(t,e,o)},p:ye,d(t){t&&a(e)}}}function Lt(l,e){let t,o,n,i=e[53],d,_,p=e[53].item+"",O,I,f,u=e[53].mandatory=="1"?" * ":"",b,m,h,v,L,C,j,D,z,w;const y=()=>e[34](n,i),A=()=>e[34](null,i);function k(){return e[35](e[53])}function S(W,X){return W[11][W[53].id_checklist_event]?Wn:Kn}let V=S(e),M=V(e);function K(...W){return e[37](e[53],...W)}return D=It(e[21][0]),{key:l,first:null,c(){t=s("ion-item"),o=s("ion-label"),n=s("input"),d=N(),_=s("p"),O=fe(p),I=N(),f=s("b"),b=fe(u),m=N(),h=s("ion-button"),v=s("div"),M.c(),L=N(),C=s("input"),j=N(),this.h()},l(W){t=c(W,"ION-ITEM",{});var X=E(t);o=c(X,"ION-LABEL",{style:!0});var ne=E(o);n=c(ne,"INPUT",{id:!0,style:!0,type:!0}),d=T(ne),_=c(ne,"P",{style:!0});var de=E(_);O=_e(de,p),I=T(de),de.forEach(a),f=c(ne,"B",{style:!0});var ae=E(f);b=_e(ae,u),ae.forEach(a),ne.forEach(a),m=T(X),h=c(X,"ION-BUTTON",{fill:!0,class:!0,size:!0});var ve=E(h);v=c(ve,"DIV",{class:!0});var Ie=E(v);M.l(Ie),L=T(Ie),C=c(Ie,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0}),Ie.forEach(a),ve.forEach(a),j=T(X),X.forEach(a),this.h()},h(){x(n,"id",`chkbox-${e[53].id_checklist_event}`),G(n,"pointer-events","auto"),x(n,"type","checkbox"),n.__value=e[53].id_checklist_event,cn(n,n.__value),n.required=!0,G(_,"margin-left","10px"),G(f,"margin-left","5px"),G(o,"display","flex"),G(C,"display","none"),x(C,"id","chklist-"+e[53].id_checklist_event),x(C,"name","fileToUpload"),x(C,"type","file"),x(C,"accept","image/*"),x(v,"class","button-content svelte-1ruehls"),g(h,"fill","outline"),g(h,"class","loadEvidence svelte-1ruehls"),g(h,"size","small"),D.p(n),this.first=t},m(W,X){F(W,t,X),r(t,o),r(o,n),n.checked=~(e[4]||[]).indexOf(n.__value),y(),r(o,d),r(o,_),r(_,O),r(_,I),r(o,f),r(f,b),r(t,m),r(t,h),r(h,v),M.m(v,null),r(v,L),r(v,C),e[36](C),r(t,j),z||(w=[le(n,"change",e[33]),le(n,"change",k),le(C,"change",K)],z=!0)},p(W,X){e=W,X[0]&16&&(n.checked=~(e[4]||[]).indexOf(n.__value)),i!==e[53]&&(A(),i=e[53],y()),V===(V=S(e))&&M?M.p(e,X):(M.d(1),M=V(e),M&&(M.c(),M.m(v,L)))},d(W){W&&a(t),A(),M.d(),e[36](null),D.r(),z=!1,Ge(w)}}}function Xn(l){let e,t,o,n,i="Cancelar",d,_,p="REQUERIMIENTOS DE RUTA",O,I,f,u,b,m,h,v="Confirmar",L,C;function j(y,A){return y[14]?Vn:jn}let z=j(l)(l),w=l[13]&&Gn(l);return{c(){e=s("ion-header"),t=s("ion-toolbar"),o=s("ion-buttons"),n=s("ion-button"),n.textContent=i,d=N(),_=s("ion-title"),_.textContent=p,O=N(),I=s("ion-content"),f=s("ion-list"),z.c(),u=N(),w&&w.c(),b=N(),m=s("ion-footer"),h=s("ion-button"),h.textContent=v,this.h()},l(y){e=c(y,"ION-HEADER",{translucent:!0});var A=E(e);t=c(A,"ION-TOOLBAR",{});var k=E(t);o=c(k,"ION-BUTTONS",{slot:!0});var S=E(o);n=c(S,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),Q(n)!=="svelte-1dnmkxs"&&(n.textContent=i),S.forEach(a),d=T(k),_=c(k,"ION-TITLE",{"data-svelte-h":!0}),Q(_)!=="svelte-19bar5p"&&(_.textContent=p),k.forEach(a),A.forEach(a),O=T(y),I=c(y,"ION-CONTENT",{fullscreen:!0});var V=E(I);f=c(V,"ION-LIST",{});var M=E(f);z.l(M),u=T(M),w&&w.l(M),M.forEach(a),V.forEach(a),b=T(y),m=c(y,"ION-FOOTER",{});var K=E(m);h=c(K,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),Q(h)!=="svelte-g82qqw"&&(h.textContent=v),K.forEach(a),this.h()},h(){g(n,"color","medium"),g(o,"slot","start"),g(e,"translucent",""),g(I,"fullscreen",""),g(h,"fill","outline"),g(h,"color","tertiary"),g(h,"strong",""),G(h,"width","99%"),G(h,"height","auto")},m(y,A){F(y,e,A),r(e,t),r(t,o),r(o,n),r(t,d),r(t,_),F(y,O,A),F(y,I,A),r(I,f),z.m(f,null),r(f,u),w&&w.m(f,null),F(y,b,A),F(y,m,A),r(m,h),L||(C=[le(n,"click",l[15]),le(h,"click",l[16])],L=!0)},p(y,A){z.p(y,A),y[13]&&w.p(y,A)},i:ye,o:ye,d(y){y&&(a(e),a(O),a(I),a(b),a(m)),z.d(),w&&w.d(),L=!1,Ge(C)}}}function gt(l,e){if(typeof l=="object"&&l!==null||Array.isArray(l)){if(Array.isArray(l))return l.map(t=>gt(t,e)).flat();{const t=Object.keys(l);let o;return e=="id_checklist_event"?o=t.filter(i=>i.toLowerCase().includes("id_checklist_event")).map(i=>l[i]):e=="mandatory"?o=t.filter(i=>i.toLowerCase().includes("mandatory")).map(i=>l[i]):(console.error("Tipo de dato no reconocido."),o=!1),o}}else return console.error("Invalid input. Please provide a valid object or array."),[]}function Jn(l,e,t){let o=ht,n=document.querySelector("ion-modal");const i=n.componentProps.checklist,d=n.componentProps.driverId,_=n.componentProps.routeId,p=n.componentProps.isLast;let O,I,f,u,b=[],m=null,h={},v,L,C,j,D={},z={},w={};it(()=>{p?console.log("Último checklist"):pt.update(U=>(U.mandatory=gt(i,"mandatory"),U.items=gt(i,"id_checklist_event"),U))});function y(U){t(11,D[U]=!0,D)}const A=async()=>{await(await Xe.create({header:"Datos o checklist incompletos",message:"Carga la evidencia requerida y marca todas las casillas para confirmar",buttons:[{text:"Cerrar"}]})).present()},k=async()=>{await(await Xe.create({header:"Datos capturados",message:"El kilometraje y gasolina final fueron registrados correctamente, espere aprobación para finalizar ruta",buttons:[{text:"Cerrar"}]})).present()},S=async U=>{await(await Xe.create({header:"Datos inválidos",message:U=="km"?"Llena correctamente el campo de kilometraje inicial":"Llena correctamente el campo de gasolina inicial",buttons:[{text:"Cerrar"}]})).present()},V=()=>{at.dismiss(),d?We(`/drivers/${d}`):We("/drivers/me")},M=()=>{if(p){var U=de(f,"km"),$=de(u,"gas");const oe=new FormData;oe.append("km_final",U),oe.append("gas_final",$),oe.append("id_route",_),U&&$?(V(),fetch(`${o}api/admin/checklist/add_evidence.php`,{method:"POST",body:oe}).then(ie=>ie.json()).then(ie=>{k()}).catch(ie=>{console.error("Error fetching data:",ie)})):A()}else{var Ce=de(O,"km"),te=de(I,"gas");pt.update(oe=>{oe.items;const ie=oe.mandatory;if(oe.items.filter((se,ee)=>oe.mandatory[ee]==="1").every(se=>oe.checkedIndices.includes(se))&&Ce&&te){V();const se=new FormData;for(const ee in z)if(z.hasOwnProperty(ee)){const{img:Le,img_id:Oe}=z[ee];se.append(`selectedImages[${ee}][img]`,Le),se.append(`selectedImages[${ee}][img_id]`,Oe)}se.append("km_inicial",Ce),se.append("gas_inicial",te),se.append("id_route",_),fetch(`${o}api/admin/checklist/add_evidence.php`,{method:"POST",body:se}).then(ee=>ee.json()).then(ee=>{ie&&ie.some(Le=>Le==="1")?ne(_,"checklist-pending"):ne(_,"enroute")}).catch(ee=>{console.error("Error fetching data:",ee)})}else if(!ie&&Ce&&te){var ge=new FormData;ge.append("km_inicial",Ce),ge.append("gas_inicial",te),fetch(`${o}api/admin/checklist/add_evidence.php`,{method:"POST",body:ge}).then(se=>se.json()).then(se=>{ne(_,"enroute")}).catch(se=>{console.error("Error fetching data:",se)})}else A();return oe})}Be()},K=async(U,$)=>{y($);const te=U.target.files[0],oe=await W(te);if(oe){const ie=new FormData;ie.append("fileToUpload",oe);try{const ce=await fetch(`${o}api/admin/manager/upload_img_driver.php`,{method:"POST",body:ie});if(ce.ok){const ue=await ce.json();z={...z,[$]:{img:ue.img,img_id:ue.img_id}},t(12,w={...w,[$]:ue.filename}),X($),t(6,h[$].checked=!0,h),t(11,D[$]=!1,D)}else console.error("File upload failed:",ce.statusText)}catch(ce){console.error("Error during file upload:",ce)}}},W=async U=>new Promise($=>{const Ce=new FileReader;Ce.onload=te=>{const oe=new Image;oe.src=te.target.result,oe.onload=()=>{const ie=document.createElement("canvas"),ce=ie.getContext("2d"),ue=800,ge=600;let se=oe.width,ee=oe.height;se>ue&&(ee*=ue/se,se=ue),ee>ge&&(se*=ge/ee,ee=ge),ie.width=se,ie.height=ee,ce.drawImage(oe,0,0,se,ee),ie.toBlob(Le=>{$(Le)},"image/jpeg",.7)}},Ce.readAsDataURL(U)}),X=U=>{pt.update($=>($.checkedIndices.indexOf(U)===-1?$.checkedIndices.push(U):console.error(`ID ${U} is already checked.`),$.items.forEach(te=>{te.id_checklist_event===U&&(te.checked=!0)}),$))};function ne(U,$){let Ce=new FormData;Ce.append("id_route",U),Ce.append("status",$),fetch(`${o}api/admin/route/change_status.php`,{method:"POST",body:Ce}).then(te=>te.json()).then(te=>{}).catch(te=>{console.error("Error fetching data:",te)})}function de(U,$){return/^\d+$/.test(U)?parseInt(U,10):(S($),null)}function ae(U,$){ve($),n.componentProps.data_type=$,Ke("modal-gas-km",qn,{r:$}).then(()=>{Ye.subscribe(Ce=>{Ie(Ce,$)})})}function ve(U){rn.update($=>({...$,flag:[U]}))}function Ie(U,$){t(0,O=U.km_inicial?U.km_inicial:null),t(1,I=U.gas_inicial?U.gas_inicial:null),t(2,f=U.km_final?U.km_final:null),t(3,u=U.gas_final?U.gas_final:null),$=="km_inicial"&&v&&t(7,v.checked=!0,v),$=="gas_inicial"&&L&&t(8,L.checked=!0,L),$=="km_final"&&C&&t(9,C.checked=!0,C),$=="gas_final"&&j&&t(10,j.checked=!0,j)}function Be(){Ye.set({km_inicial:[],gas_inicial:[],km_final:[],gas_final:[]})}const ke=[[]];function B(){b=ot(ke[0],this.__value,this.checked),t(4,b)}function H(U){He[U?"unshift":"push"](()=>{C=U,t(9,C)})}const P=U=>ae(U,"km_final");function R(){b=ot(ke[0],this.__value,this.checked),t(4,b)}function J(U){He[U?"unshift":"push"](()=>{j=U,t(10,j)})}const q=U=>ae(U,"gas_final");function Y(){b=ot(ke[0],this.__value,this.checked),t(4,b)}function he(U){He[U?"unshift":"push"](()=>{v=U,t(7,v)})}const Ne=U=>ae(U,"km_inicial");function pe(U){He[U?"unshift":"push"](()=>{L=U,t(8,L)})}function re(){b=ot(ke[0],this.__value,this.checked),t(4,b)}const Te=U=>ae(U,"gas_inicial");function Pe(){b=ot(ke[0],this.__value,this.checked),t(4,b)}function qe(U,$){He[U?"unshift":"push"](()=>{h[$.id_checklist_event]=U,t(6,h)})}const Fe=U=>X(U.id_checklist_event);function Ae(U){He[U?"unshift":"push"](()=>{m=U,t(5,m)})}return[O,I,f,u,b,m,h,v,L,C,j,D,w,i,p,V,M,K,X,ae,B,ke,H,P,R,J,q,Y,he,Ne,pe,re,Te,Pe,qe,Fe,Ae,(U,$)=>K($,U.id_checklist_event)]}class an extends $e{constructor(e){super(),et(this,e,Jn,Xn,xe,{},null,[-1,-1])}}function Yn(l){let e,t,o,n,i,d="Teléfono de Negocio",_,p,O=l[10].client_phone+"",I;return{c(){e=s("ion-item"),t=s("ion-icon"),o=N(),n=s("ion-label"),i=s("p"),i.textContent=d,_=N(),p=s("h2"),I=fe(O),this.h()},l(f){e=c(f,"ION-ITEM",{href:!0});var u=E(e);t=c(u,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(a),o=T(u),n=c(u,"ION-LABEL",{class:!0});var b=E(n);i=c(b,"P",{"data-svelte-h":!0}),Q(i)!=="svelte-1u5l7fz"&&(i.textContent=d),_=T(b),p=c(b,"H2",{});var m=E(p);I=_e(m,O),m.forEach(a),b.forEach(a),u.forEach(a),this.h()},h(){g(t,"icon",En),g(t,"slot","start"),g(n,"class","ion-text-wrap"),g(e,"href","tel:"+l[10].client_phone)},m(f,u){F(f,e,u),r(e,t),r(e,o),r(e,n),r(n,i),r(n,_),r(n,p),r(p,I)},p:ye,d(f){f&&a(e)}}}function Qn(l){let e,t,o,n,i,d="Domicilio Alternativo",_,p,O=l[10].line2+"",I,f,u;return{c(){e=s("ion-item"),t=s("ion-icon"),o=N(),n=s("ion-label"),i=s("p"),i.textContent=d,_=N(),p=s("h2"),I=fe(O),f=N(),u=s("ion-icon"),this.h()},l(b){e=c(b,"ION-ITEM",{href:!0});var m=E(e);t=c(m,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(a),o=T(m),n=c(m,"ION-LABEL",{class:!0});var h=E(n);i=c(h,"P",{"data-svelte-h":!0}),Q(i)!=="svelte-1ub9uzw"&&(i.textContent=d),_=T(h),p=c(h,"H2",{});var v=E(p);I=_e(v,O),v.forEach(a),h.forEach(a),f=T(m),u=c(m,"ION-ICON",{icon:!0,slot:!0}),E(u).forEach(a),m.forEach(a),this.h()},h(){g(t,"icon",kt),g(t,"slot","start"),g(n,"class","ion-text-wrap"),g(u,"icon",tt),g(u,"slot","end"),g(e,"href","https://www.google.com/maps/searhc/?api=1&query="+l[10].line2)},m(b,m){F(b,e,m),r(e,t),r(e,o),r(e,n),r(n,i),r(n,_),r(n,p),r(p,I),r(e,f),r(e,u)},p:ye,d(b){b&&a(e)}}}function Zn(l){let e,t,o,n,i,d="Domicilio",_,p,O=l[10].line1+"",I,f,u,b,m=l[10].line2&&l[10].line2.trim().length,h,v=m&&xn(l);return{c(){e=s("ion-item"),t=s("ion-icon"),o=N(),n=s("ion-label"),i=s("p"),i.textContent=d,_=N(),p=s("h2"),I=fe(O),f=N(),u=s("ion-icon"),b=N(),v&&v.c(),h=Ue(),this.h()},l(L){e=c(L,"ION-ITEM",{href:!0});var C=E(e);t=c(C,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(a),o=T(C),n=c(C,"ION-LABEL",{class:!0});var j=E(n);i=c(j,"P",{"data-svelte-h":!0}),Q(i)!=="svelte-cbm7q1"&&(i.textContent=d),_=T(j),p=c(j,"H2",{});var D=E(p);I=_e(D,O),D.forEach(a),j.forEach(a),f=T(C),u=c(C,"ION-ICON",{icon:!0,slot:!0}),E(u).forEach(a),C.forEach(a),b=T(L),v&&v.l(L),h=Ue(),this.h()},h(){g(t,"icon",kt),g(t,"slot","start"),g(n,"class","ion-text-wrap"),g(u,"icon",tt),g(u,"slot","end"),g(e,"href","https://www.google.com/maps/search/?api=1&query="+l[10].line1)},m(L,C){F(L,e,C),r(e,t),r(e,o),r(e,n),r(n,i),r(n,_),r(n,p),r(p,I),r(e,f),r(e,u),F(L,b,C),v&&v.m(L,C),F(L,h,C)},p(L,C){m&&v.p(L,C)},d(L){L&&(a(e),a(b),a(h)),v&&v.d(L)}}}function xn(l){let e,t,o,n,i,d="Domicilio Alternativo",_,p,O=l[10].line2+"",I,f,u;return{c(){e=s("ion-item"),t=s("ion-icon"),o=N(),n=s("ion-label"),i=s("p"),i.textContent=d,_=N(),p=s("h2"),I=fe(O),f=N(),u=s("ion-icon"),this.h()},l(b){e=c(b,"ION-ITEM",{href:!0});var m=E(e);t=c(m,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(a),o=T(m),n=c(m,"ION-LABEL",{class:!0});var h=E(n);i=c(h,"P",{"data-svelte-h":!0}),Q(i)!=="svelte-1ub9uzw"&&(i.textContent=d),_=T(h),p=c(h,"H2",{});var v=E(p);I=_e(v,O),v.forEach(a),h.forEach(a),f=T(m),u=c(m,"ION-ICON",{icon:!0,slot:!0}),E(u).forEach(a),m.forEach(a),this.h()},h(){g(t,"icon",kt),g(t,"slot","start"),g(n,"class","ion-text-wrap"),g(u,"icon",tt),g(u,"slot","end"),g(e,"href","https://www.google.com/maps/search/?api=1&query="+l[10].line2)},m(b,m){F(b,e,m),r(e,t),r(e,o),r(e,n),r(n,i),r(n,_),r(n,p),r(p,I),r(e,f),r(e,u)},p:ye,d(b){b&&a(e)}}}function St(l){let e,t,o,n,i,d="Contacto del Cliente",_,p,O,I,f=l[2]&&l[2]==="1"&&Mt(l);return{c(){e=s("ion-item"),t=s("ion-icon"),o=N(),n=s("ion-label"),i=s("p"),i.textContent=d,_=N(),p=s("h2"),O=fe(l[6]),I=N(),f&&f.c(),this.h()},l(u){e=c(u,"ION-ITEM",{});var b=E(e);t=c(b,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(a),o=T(b),n=c(b,"ION-LABEL",{class:!0});var m=E(n);i=c(m,"P",{"data-svelte-h":!0}),Q(i)!=="svelte-1utsyb6"&&(i.textContent=d),_=T(m),p=c(m,"H2",{});var h=E(p);O=_e(h,l[6]),h.forEach(a),m.forEach(a),I=T(b),f&&f.l(b),b.forEach(a),this.h()},h(){g(t,"icon",In),g(t,"slot","start"),g(n,"class","ion-text-wrap")},m(u,b){F(u,e,b),r(e,t),r(e,o),r(e,n),r(n,i),r(n,_),r(n,p),r(p,O),r(e,I),f&&f.m(e,null)},p(u,b){b[0]&64&&ze(O,u[6]),u[2]&&u[2]==="1"?f?f.p(u,b):(f=Mt(u),f.c(),f.m(e,null)):f&&(f.d(1),f=null)},d(u){u&&a(e),f&&f.d()}}}function Mt(l){let e,t=`<ion-icon icon="${Tn}" slot="start"></ion-icon>
                        Notificar Cliente`,o,n;return{c(){e=s("ion-button"),e.innerHTML=t,this.h()},l(i){e=c(i,"ION-BUTTON",{fill:!0,style:!0,"data-svelte-h":!0}),Q(e)!=="svelte-w3qtwm"&&(e.innerHTML=t),this.h()},h(){g(e,"fill","outline"),G(e,"margin-left","16px")},m(i,d){F(i,e,d),o||(n=le(e,"click",l[15]),o=!0)},p:ye,d(i){i&&a(e),o=!1,n()}}}function At(l){let e,t,o,n,i,d="Notas de ubicación",_,p,O;return{c(){e=s("ion-item"),t=s("ion-icon"),o=N(),n=s("ion-label"),i=s("p"),i.textContent=d,_=N(),p=s("h2"),O=fe(l[7]),this.h()},l(I){e=c(I,"ION-ITEM",{});var f=E(e);t=c(f,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(a),o=T(f),n=c(f,"ION-LABEL",{class:!0});var u=E(n);i=c(u,"P",{"data-svelte-h":!0}),Q(i)!=="svelte-nhm2ft"&&(i.textContent=d),_=T(u),p=c(u,"H2",{});var b=E(p);O=_e(b,l[7]),b.forEach(a),u.forEach(a),f.forEach(a),this.h()},h(){g(t,"icon",on),g(t,"slot","start"),g(n,"class","ion-text-wrap")},m(I,f){F(I,e,f),r(e,t),r(e,o),r(e,n),r(n,i),r(n,_),r(n,p),r(p,O)},p(I,f){f[0]&128&&ze(O,I[7])},d(I){I&&a(e)}}}function $n(l){let e,t,o,n,i,d="Horarios",_,p,O=l[10].schedule+"",I;return{c(){e=s("ion-item"),t=s("ion-icon"),o=N(),n=s("ion-label"),i=s("p"),i.textContent=d,_=N(),p=s("h2"),I=fe(O),this.h()},l(f){e=c(f,"ION-ITEM",{});var u=E(e);t=c(u,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(a),o=T(u),n=c(u,"ION-LABEL",{});var b=E(n);i=c(b,"P",{"data-svelte-h":!0}),Q(i)!=="svelte-11q7hm5"&&(i.textContent=d),_=T(b),p=c(b,"H2",{});var m=E(p);I=_e(m,O),m.forEach(a),b.forEach(a),u.forEach(a),this.h()},h(){g(t,"icon",kn),g(t,"slot","start")},m(f,u){F(f,e,u),r(e,t),r(e,o),r(e,n),r(n,i),r(n,_),r(n,p),r(p,I)},p:ye,d(f){f&&a(e)}}}function eo(l){let e,t,o,n,i,d="Notas del operador",_,p,O=l[10].driver_comments+"",I;return{c(){e=s("ion-item"),t=s("ion-icon"),o=N(),n=s("ion-label"),i=s("p"),i.textContent=d,_=N(),p=s("h2"),I=fe(O),this.h()},l(f){e=c(f,"ION-ITEM",{});var u=E(e);t=c(u,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(a),o=T(u),n=c(u,"ION-LABEL",{});var b=E(n);i=c(b,"P",{"data-svelte-h":!0}),Q(i)!=="svelte-1yk9qp4"&&(i.textContent=d),_=T(b),p=c(b,"H2",{});var m=E(p);I=_e(m,O),m.forEach(a),b.forEach(a),u.forEach(a),this.h()},h(){g(t,"icon",ln),g(t,"slot","start")},m(f,u){F(f,e,u),r(e,t),r(e,o),r(e,n),r(n,i),r(n,_),r(n,p),r(p,I)},p:ye,d(f){f&&a(e)}}}function to(l){let e,t=l[10].logistic_comments!="<br>"&&no(l);return{c(){t&&t.c(),e=Ue()},l(o){t&&t.l(o),e=Ue()},m(o,n){t&&t.m(o,n),F(o,e,n)},p(o,n){o[10].logistic_comments!="<br>"&&t.p(o,n)},d(o){o&&a(e),t&&t.d(o)}}}function no(l){let e,t,o,n,i,d="Comentarios logísticos",_,p,O=l[10].logistic_comments+"",I;return{c(){e=s("ion-item"),t=s("ion-icon"),o=N(),n=s("ion-label"),i=s("p"),i.textContent=d,_=N(),p=s("h2"),I=fe(O),this.h()},l(f){e=c(f,"ION-ITEM",{});var u=E(e);t=c(u,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(a),o=T(u),n=c(u,"ION-LABEL",{class:!0});var b=E(n);i=c(b,"P",{"data-svelte-h":!0}),Q(i)!=="svelte-1iz85r6"&&(i.textContent=d),_=T(b),p=c(b,"H2",{});var m=E(p);I=_e(m,O),m.forEach(a),b.forEach(a),u.forEach(a),this.h()},h(){g(t,"icon",on),g(t,"slot","start"),g(n,"class","ion-text-wrap")},m(f,u){F(f,e,u),r(e,t),r(e,o),r(e,n),r(n,i),r(n,_),r(n,p),r(p,I)},p:ye,d(f){f&&a(e)}}}function Pt(l){let e,t,o,n;return{c(){e=s("ion-item"),t=s("ion-icon"),o=N(),n=s("ion-textarea"),this.h()},l(i){e=c(i,"ION-ITEM",{});var d=E(e);t=c(d,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(a),o=T(d),n=c(d,"ION-TEXTAREA",{placeholder:!0}),E(n).forEach(a),d.forEach(a),this.h()},h(){g(t,"icon",On),g(t,"slot","start"),g(n,"placeholder","Escribe el motivo...")},m(i,d){F(i,e,d),r(e,t),r(e,o),r(e,n),l[18](n)},p:ye,d(i){i&&a(e),l[18](null)}}}function Dt(l){let e,t=`<ion-icon icon="${Cn}" slot="start"></ion-icon>
                    Ingreso`,o,n;return{c(){e=s("ion-button"),e.innerHTML=t,this.h()},l(i){e=c(i,"ION-BUTTON",{id:!0,style:!0,"data-svelte-h":!0}),Q(e)!=="svelte-151bg1z"&&(e.innerHTML=t),this.h()},h(){g(e,"id","checkInBtn"),G(e,"flex","1")},m(i,d){F(i,e,d),o||(n=le(e,"click",l[16]),o=!0)},p:ye,d(i){i&&a(e),o=!1,n()}}}function Bt(l){let e,t,o,n,i,d;return{c(){e=s("ion-button"),t=s("ion-icon"),o=fe(`
                    Salida`),this.h()},l(_){e=c(_,"ION-BUTTON",{id:!0,style:!0,disabled:!0});var p=E(e);t=c(p,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(a),o=_e(p,`
                    Salida`),p.forEach(a),this.h()},h(){g(t,"icon",Nn),g(t,"slot","start"),g(e,"id","checkOutBtn"),G(e,"flex","1"),g(e,"disabled",n=l[5]===!1)},m(_,p){F(_,e,p),r(e,t),r(e,o),i||(d=le(e,"click",l[17]),i=!0)},p(_,p){p[0]&32&&n!==(n=_[5]===!1)&&g(e,"disabled",n)},d(_){_&&a(e),i=!1,d()}}}function zt(l){let e,t='<ion-spinner name="dots"></ion-spinner>';return{c(){e=s("section"),e.innerHTML=t,this.h()},l(o){e=c(o,"SECTION",{style:!0,"data-svelte-h":!0}),Q(e)!=="svelte-1sj3e0"&&(e.innerHTML=t),this.h()},h(){G(e,"text-align","center")},m(o,n){F(o,e,n)},d(o){o&&a(e)}}}function Ht(l){let e,t,o;return{c(){e=s("section"),t=s("ion-img"),this.h()},l(n){e=c(n,"SECTION",{});var i=E(e);t=c(i,"ION-IMG",{src:!0,alt:!0,style:!0}),E(t).forEach(a),i.forEach(a),this.h()},h(){dt(t.src,o=l[1])||g(t,"src",o),g(t,"alt","Evidencia fotográfica"),G(t,"max-width","100%"),G(t,"margin-top","16px")},m(n,i){F(n,e,i),r(e,t)},p(n,i){i[0]&2&&!dt(t.src,o=n[1])&&g(t,"src",o)},d(n){n&&a(e)}}}function oo(l){let e,t,o,n,i="Cancelar",d,_,p=l[10].title+"",O,I,f,u,b="Confirmar",m,h,v,L,C,j,D,z,w="Negocio",y,A,k=l[10].client_name+"",S,V,M=l[10].client_phone&&l[10].client_phone.trim().length,K,W,X,ne,de=l[10].schedule&&l[10].schedule.trim().length,ae,ve,Ie=l[10].logistic_comments&&l[10].logistic_comments.trim().length,Be,ke,B,H,P,R,J,q,Y,he,Ne,pe,re,Te,Pe,qe="Subir Evidencia",Fe,Ae,De,U,$,Ce,te=M&&Yn(l);function oe(Z,Ee){if(Z[10].line1&&Z[10].line1.trim().length)return Zn;if(Z[10].line2&&Z[10].line2.trim().length)return Qn}let ie=oe(l),ce=ie&&ie(l),ue=l[6]&&St(l),ge=l[7]&&l[7]!=="<br>"&&At(l),se=de&&$n(l),ee=l[10].driver_comments&&eo(l),Le=Ie&&to(l),Oe=l[8]&&Pt(l),we=l[4]===!0&&Dt(l),be=(l[5]===!0||l[5]===!1&&l[4]===!1)&&Bt(l),Se=l[3]&&zt(),Me=l[1]&&Ht(l);return{c(){e=s("ion-header"),t=s("ion-toolbar"),o=s("ion-buttons"),n=s("ion-button"),n.textContent=i,d=N(),_=s("ion-title"),O=fe(p),I=N(),f=s("ion-buttons"),u=s("ion-button"),u.textContent=b,m=N(),h=s("ion-content"),v=s("ion-list"),L=s("ion-item"),C=s("ion-icon"),j=N(),D=s("ion-label"),z=s("p"),z.textContent=w,y=N(),A=s("h2"),S=fe(k),V=N(),te&&te.c(),K=N(),ce&&ce.c(),W=N(),ue&&ue.c(),X=N(),ge&&ge.c(),ne=N(),se&&se.c(),ae=N(),ee&&ee.c(),ve=N(),Le&&Le.c(),Be=N(),Oe&&Oe.c(),ke=N(),B=s("ion-item"),H=s("ion-icon"),P=N(),R=s("ion-textarea"),J=N(),q=s("section"),we&&we.c(),Y=N(),be&&be.c(),he=N(),Ne=s("section"),pe=s("ion-button"),re=s("ion-icon"),Te=N(),Pe=s("label"),Pe.textContent=qe,Fe=N(),Ae=s("input"),De=N(),Se&&Se.c(),U=N(),Me&&Me.c(),this.h()},l(Z){e=c(Z,"ION-HEADER",{translucent:!0});var Ee=E(e);t=c(Ee,"ION-TOOLBAR",{});var Ve=E(t);o=c(Ve,"ION-BUTTONS",{slot:!0});var nt=E(o);n=c(nt,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),Q(n)!=="svelte-1f8rjcf"&&(n.textContent=i),nt.forEach(a),d=T(Ve),_=c(Ve,"ION-TITLE",{style:!0,title:!0});var Ot=E(_);O=_e(Ot,p),Ot.forEach(a),I=T(Ve),f=c(Ve,"ION-BUTTONS",{slot:!0});var Nt=E(f);u=c(Nt,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),Q(u)!=="svelte-1ida0il"&&(u.textContent=b),Nt.forEach(a),Ve.forEach(a),Ee.forEach(a),m=T(Z),h=c(Z,"ION-CONTENT",{fullscreen:!0});var Tt=E(h);v=c(Tt,"ION-LIST",{});var me=E(v);L=c(me,"ION-ITEM",{});var st=E(L);C=c(st,"ION-ICON",{icon:!0,slot:!0}),E(C).forEach(a),j=T(st),D=c(st,"ION-LABEL",{});var ct=E(D);z=c(ct,"P",{"data-svelte-h":!0}),Q(z)!=="svelte-57b1dg"&&(z.textContent=w),y=T(ct),A=c(ct,"H2",{});var Ct=E(A);S=_e(Ct,k),Ct.forEach(a),ct.forEach(a),st.forEach(a),V=T(me),te&&te.l(me),K=T(me),ce&&ce.l(me),W=T(me),ue&&ue.l(me),X=T(me),ge&&ge.l(me),ne=T(me),se&&se.l(me),ae=T(me),ee&&ee.l(me),ve=T(me),Le&&Le.l(me),Be=T(me),Oe&&Oe.l(me),ke=T(me),B=c(me,"ION-ITEM",{});var ut=E(B);H=c(ut,"ION-ICON",{icon:!0,slot:!0}),E(H).forEach(a),P=T(ut),R=c(ut,"ION-TEXTAREA",{label:!0,placeholder:!0}),E(R).forEach(a),ut.forEach(a),J=T(me),q=c(me,"SECTION",{style:!0});var ft=E(q);we&&we.l(ft),Y=T(ft),be&&be.l(ft),ft.forEach(a),he=T(me),Ne=c(me,"SECTION",{style:!0});var yt=E(Ne);pe=c(yt,"ION-BUTTON",{fill:!0,class:!0,style:!0});var Je=E(pe);re=c(Je,"ION-ICON",{icon:!0,slot:!0}),E(re).forEach(a),Te=T(Je),Pe=c(Je,"LABEL",{for:!0,"data-svelte-h":!0}),Q(Pe)!=="svelte-7lscau"&&(Pe.textContent=qe),Fe=T(Je),Ae=c(Je,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0}),Je.forEach(a),yt.forEach(a),De=T(me),Se&&Se.l(me),U=T(me),Me&&Me.l(me),me.forEach(a),Tt.forEach(a),this.h()},h(){g(n,"color","medium"),g(o,"slot","start"),G(_,"text-align","center"),g(_,"title",l[10].title),g(u,"strong",""),g(f,"slot","end"),g(e,"translucent",""),g(C,"icon",bn),g(C,"slot","start"),g(H,"icon",vt),g(H,"slot","start"),g(R,"label","Notas"),g(R,"placeholder","Escribe aquí..."),G(q,"display","flex"),G(q,"gap","8px"),G(q,"padding","16px 16px 6px"),g(re,"icon",nn),g(re,"slot","start"),x(Pe,"for","eventEvidence"),G(Ae,"display","none"),x(Ae,"id","eventEvidence"),x(Ae,"name","fileToUpload"),x(Ae,"type","file"),x(Ae,"accept","image/*"),g(pe,"fill","outline"),g(pe,"class","loadEvidence"),G(pe,"flex","1"),G(Ne,"display","flex"),G(Ne,"gap","8px"),G(Ne,"padding","0px 16px"),g(h,"fullscreen","")},m(Z,Ee){F(Z,e,Ee),r(e,t),r(t,o),r(o,n),r(t,d),r(t,_),r(_,O),r(t,I),r(t,f),r(f,u),F(Z,m,Ee),F(Z,h,Ee),r(h,v),r(v,L),r(L,C),r(L,j),r(L,D),r(D,z),r(D,y),r(D,A),r(A,S),r(v,V),te&&te.m(v,null),r(v,K),ce&&ce.m(v,null),r(v,W),ue&&ue.m(v,null),r(v,X),ge&&ge.m(v,null),r(v,ne),se&&se.m(v,null),r(v,ae),ee&&ee.m(v,null),r(v,ve),Le&&Le.m(v,null),r(v,Be),Oe&&Oe.m(v,null),r(v,ke),r(v,B),r(B,H),r(B,P),r(B,R),l[19](R),r(v,J),r(v,q),we&&we.m(q,null),r(q,Y),be&&be.m(q,null),r(v,he),r(v,Ne),r(Ne,pe),r(pe,re),r(pe,Te),r(pe,Pe),r(pe,Fe),r(pe,Ae),r(v,De),Se&&Se.m(v,null),r(v,U),Me&&Me.m(v,null),$||(Ce=[le(n,"click",l[13]),le(u,"click",l[14]),le(Ae,"change",l[11]),le(Ae,"click",l[12])],$=!0)},p(Z,Ee){M&&te.p(Z,Ee),ce&&ce.p(Z,Ee),Z[6]?ue?ue.p(Z,Ee):(ue=St(Z),ue.c(),ue.m(v,X)):ue&&(ue.d(1),ue=null),Z[7]&&Z[7]!=="<br>"?ge?ge.p(Z,Ee):(ge=At(Z),ge.c(),ge.m(v,ne)):ge&&(ge.d(1),ge=null),de&&se.p(Z,Ee),Z[10].driver_comments&&ee.p(Z,Ee),Ie&&Le.p(Z,Ee),Z[8]?Oe?Oe.p(Z,Ee):(Oe=Pt(Z),Oe.c(),Oe.m(v,ke)):Oe&&(Oe.d(1),Oe=null),Z[4]===!0?we?we.p(Z,Ee):(we=Dt(Z),we.c(),we.m(q,Y)):we&&(we.d(1),we=null),Z[5]===!0||Z[5]===!1&&Z[4]===!1?be?be.p(Z,Ee):(be=Bt(Z),be.c(),be.m(q,null)):be&&(be.d(1),be=null),Z[3]?Se||(Se=zt(),Se.c(),Se.m(v,U)):Se&&(Se.d(1),Se=null),Z[1]?Me?Me.p(Z,Ee):(Me=Ht(Z),Me.c(),Me.m(v,null)):Me&&(Me.d(1),Me=null)},i:ye,o:ye,d(Z){Z&&(a(e),a(m),a(h)),te&&te.d(),ce&&ce.d(),ue&&ue.d(),ge&&ge.d(),se&&se.d(),ee&&ee.d(),Le&&Le.d(),Oe&&Oe.d(),l[19](null),we&&we.d(),be&&be.d(),Se&&Se.d(),Me&&Me.d(),$=!1,Ge(Ce)}}}const Rt=/Teléfono:\s*(\d{10,})/;function Ut(l,e){for(let t=0;t<e.length;t++)if(e[t].alias===l)return e[t].val;return""}function io(l,e,t){let o=ht,n=document.querySelector("ion-modal"),i=n.componentProps.delivery,d=n.componentProps.isLast,_=i.driver_comments?i.driver_comments:"",p=i.img?i.img:"",O="",I={latitude:null,longitude:null},f=new Object,u="",b="",m=!1,h=!0,v=!1,L="",C=i.comments_ext,j=!1,D="";it(()=>{ae(),w()});async function z(H="",P,R={}){const J=new FormData;t(3,m=!0);for(const[q,Y]of Object.entries(R))J.append(q,Y);try{const q=await fetch(H,{method:"POST",body:J});if(q.ok){const Y=await q.json();P(Y)}else console.error("Request failed:",q.statusText)}catch(q){console.error("Error during file upload:",q)}finally{t(3,m=!1)}}function w(){i.date_service?i.date_service&&!i.date_completed&&!i.service_time?(t(4,h=!1),t(5,v=!0)):i.date_service&&i.date_completed&&i.service_time&&(t(4,h=!1),t(5,v=!1)):(t(4,h=!0),t(5,v=!1))}if(i.comments_ext){const H=i.comments_ext.match(Rt);H&&(L=H[1],C=i.comments_ext.replace(Rt,"").trim())}const y=async(H,P)=>{await(await Xe.create({header:H||"Error",message:P||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()},A=async(H="",P="",R="",J,q={})=>{await(await Xe.create({header:H||"Error",message:P||"Vuelva a intentar",buttons:[{text:"No",role:"cancel",handler:()=>{console.log('User selected "No"')}},{text:"Sí",handler:()=>{z(R,J,q)}}]})).present()},k=async H=>{const R=H.target.files[0],J=await M(R);if(J){var q=new Object;q.fileToUpload=J,z(`${o}api/admin/manager/upload_img_driver.php`,function(Y){t(1,p=Y.img),O=Y.img_id},q)}};function S(H){!i.service_time&&h&&(H.preventDefault(),y("Registrar Ingreso","Antes de subir la evidencia registra el ingreso a la actual parada."))}function V(){if(console.log("entrar"),!i.date_completed&&!h&&v){var H=new Object;H.id_event=i.id_event,H.type="checkout",A("Registrar Salida","¿Completaste tu entrega?",o+"api/admin/route/record_check_date.php",function(P){P.minutes&&y("Tiempo por parada","Completaste la parada en "+P.minutes+" minutos.")},H)}}const M=async H=>new Promise(P=>{const R=new FileReader;R.onload=J=>{const q=new Image;q.src=J.target.result,q.onload=()=>{const Y=document.createElement("canvas"),he=Y.getContext("2d"),Ne=800,pe=600;let re=q.width,Te=q.height;re>Ne&&(Te*=Ne/re,re=Ne),Te>pe&&(re*=pe/Te,Te=pe),Y.width=re,Y.height=Te,he.drawImage(q,0,0,re,Te),Y.toBlob(Pe=>{P(Pe)},"image/jpeg",.7)}},R.readAsDataURL(H)}),K=()=>{n.dismiss({data:Date.now()})},W=async()=>{try{if(V(),await ne()){const P={id_route:i.id_route,id_event:i.id_event,comments:_.value,img:p,img_id:O,lat:I.latitude,lon:I.longitude,...u==="0"&&{approve:"0"},...d&&{isLast:!0}};P.img&&P.img_id?z(`${o}api/admin/evidence/send_evidence.php`,function(R){if(R.success==!0){const J=P.id_route;K(),d&&X("","",J,d)}else y("Carga fallida","Actualiza la página y vuelve a intentar cargar la información!")},P):i.img?K():y("Información incompleta","Cargar evidencia fotográfica faltante para completar parada.")}}catch(H){console.error("Error fetching data:",H)}},X=(H,P,R,J)=>{n.componentProps.routeId=R,n.componentProps.driverId=i.id_driver,Ke("modal-km-gas",an,{checklist:H,driverId:P,routeId:R,isLast:J}).then(q=>{})},ne=async()=>navigator.geolocation?new Promise((H,P)=>{navigator.geolocation.getCurrentPosition(R=>{I.latitude=R.coords.latitude,I.longitude=R.coords.longitude,H(!0)},R=>{console.error("Error getting location:",R),H(!1)})}):(console.error("Geolocation is not supported by your browser"),!1);async function de(H){H.stopPropagation();const P=new FormData;P.append("client_phone",L),P.append("client_name",i.title),P.append("delivery_phone",i.client_phone),P.append("enterprise_name",i.enterprise_name);try{const R=await fetch(`${o}api/admin/message_central/send_sms.php`,{method:"POST",body:P});if(R.ok){const J=await R.json();y("SMS enviado","Se envío correctamente un SMS a "+i.title+" con número de teléfono: "+L)}else y("SMS no enviado","Hubo un error al enviar SMS a "+i.title+" con número de teléfono: "+phoneNumber0+". Por favor contacte a soporte.")}catch(R){console.error("Error during file upload:",R)}}const ae=async()=>{if(i.id_enterprise){const H=new FormData;H.append("id_enterprise",i.id_enterprise);try{const P=await fetch(`${o}api/admin/enterprise/enterprise_settings.php`,{method:"POST",body:H});P.ok?(f=(await P.json()).nodos,u=Ut("stops_wait_approval",f),t(2,b=Ut("sms_active",f))):console.error("File upload failed:",P.statusText)}catch(P){console.error("Error during file upload:",P)}}};function ve(){t(4,h=!1),t(5,v=!0),Be(i.id_event,"checkin")}function Ie(){t(5,v=!1),t(4,h=!1),Be(i.id_event,"checkout")}async function Be(H,P){if(P){const R=new FormData;R.append("type",P),R.append("id_event",H);try{const J=await fetch(`${o}api/admin/route/record_check_date.php`,{method:"POST",body:R});if(J.ok){const q=await J.json();q.minutes&&y("Tiempo por parada","Completaste la parada en "+q.minutes+" minutos.")}else console.error("File upload failed:",J.statusText)}catch(J){console.error("Error during file upload:",J)}finally{}}}function ke(H){He[H?"unshift":"push"](()=>{D=H,t(9,D)})}function B(H){He[H?"unshift":"push"](()=>{_=H,t(0,_)})}return[_,p,b,m,h,v,L,C,j,D,i,k,S,K,W,de,ve,Ie,ke,B]}class lo extends $e{constructor(e){super(),et(this,e,io,oo,xe,{},null,[-1,-1])}}function Ft(l){let e;return{c(){e=s("ion-spinner"),this.h()},l(t){e=c(t,"ION-SPINNER",{name:!0}),E(e).forEach(a),this.h()},h(){g(e,"name","dots")},m(t,o){F(t,e,o)},d(t){t&&a(e)}}}function qt(l){let e,t,o;return{c(){e=s("section"),t=s("ion-img"),this.h()},l(n){e=c(n,"SECTION",{});var i=E(e);t=c(i,"ION-IMG",{src:!0,alt:!0,style:!0}),E(t).forEach(a),i.forEach(a),this.h()},h(){dt(t.src,o=l[0])||g(t,"src",o),g(t,"alt","Evidencia fotográfica"),G(t,"max-width","100%"),G(t,"margin-top","16px")},m(n,i){F(n,e,i),r(e,t)},p(n,i){i&1&&!dt(t.src,o=n[0])&&g(t,"src",o)},d(n){n&&a(e)}}}function ro(l){let e,t,o,n,i="Cancelar",d,_,p="AGREGAR GASTO",O,I,f,u,b,m,h,v,L,C,j,D,z,w,y,A,k,S,V='Tipo de pago <ion-text color="danger">(Obligatorio)</ion-text>',M,K,W="Efectivo",X,ne,de="Tarjeta",ae,ve,Ie="Transferencia",Be,ke,B,H,P,R,J,q,Y,he,Ne=`<ion-icon icon="${nn}" slot="start"></ion-icon>
                        Subir Evidencia`,pe,re,Te,Pe,qe,Fe,Ae,De,U="Confirmar",$,Ce,te=l[5]&&Ft(),oe=l[0]&&qt(l);return{c(){e=s("ion-header"),t=s("ion-toolbar"),o=s("ion-buttons"),n=s("ion-button"),n.textContent=i,d=N(),_=s("ion-title"),_.textContent=p,O=N(),I=s("ion-content"),f=s("ion-list"),u=s("ion-item"),b=s("ion-icon"),m=N(),h=s("ion-input"),v=N(),L=s("ion-item"),C=s("ion-icon"),j=N(),D=s("ion-input"),z=N(),w=s("ion-item"),y=s("ion-icon"),A=N(),k=s("ion-select"),S=s("div"),S.innerHTML=V,M=N(),K=s("ion-select-option"),K.textContent=W,X=N(),ne=s("ion-select-option"),ne.textContent=de,ae=N(),ve=s("ion-select-option"),ve.textContent=Ie,Be=N(),ke=s("ion-item"),B=s("ion-icon"),H=N(),P=s("ion-textarea"),R=N(),J=s("section"),q=s("label"),Y=s("ion-button"),he=s("label"),he.innerHTML=Ne,pe=N(),re=s("input"),Te=N(),te&&te.c(),Pe=N(),oe&&oe.c(),qe=N(),Fe=s("ion-footer"),Ae=s("ion-toolbar"),De=s("ion-button"),De.textContent=U,this.h()},l(ie){e=c(ie,"ION-HEADER",{translucent:!0});var ce=E(e);t=c(ce,"ION-TOOLBAR",{});var ue=E(t);o=c(ue,"ION-BUTTONS",{slot:!0});var ge=E(o);n=c(ge,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),Q(n)!=="svelte-1f8rjcf"&&(n.textContent=i),ge.forEach(a),d=T(ue),_=c(ue,"ION-TITLE",{title:!0,"data-svelte-h":!0}),Q(_)!=="svelte-efps2s"&&(_.textContent=p),ue.forEach(a),ce.forEach(a),O=T(ie),I=c(ie,"ION-CONTENT",{fullscreen:!0});var se=E(I);f=c(se,"ION-LIST",{});var ee=E(f);u=c(ee,"ION-ITEM",{});var Le=E(u);b=c(Le,"ION-ICON",{icon:!0,slot:!0}),E(b).forEach(a),m=T(Le),h=c(Le,"ION-INPUT",{label:!0,type:!0,placeholder:!0,value:!0}),E(h).forEach(a),Le.forEach(a),v=T(ee),L=c(ee,"ION-ITEM",{});var Oe=E(L);C=c(Oe,"ION-ICON",{icon:!0,slot:!0}),E(C).forEach(a),j=T(Oe),D=c(Oe,"ION-INPUT",{label:!0,type:!0,value:!0}),E(D).forEach(a),Oe.forEach(a),z=T(ee),w=c(ee,"ION-ITEM",{});var we=E(w);y=c(we,"ION-ICON",{icon:!0,slot:!0}),E(y).forEach(a),A=T(we),k=c(we,"ION-SELECT",{placeholder:!0,value:!0});var be=E(k);S=c(be,"DIV",{slot:!0,"data-svelte-h":!0}),Q(S)!=="svelte-wl764p"&&(S.innerHTML=V),M=T(be),K=c(be,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),Q(K)!=="svelte-i9crym"&&(K.textContent=W),X=T(be),ne=c(be,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),Q(ne)!=="svelte-fx0z11"&&(ne.textContent=de),ae=T(be),ve=c(be,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),Q(ve)!=="svelte-1c24jf2"&&(ve.textContent=Ie),be.forEach(a),we.forEach(a),Be=T(ee),ke=c(ee,"ION-ITEM",{});var Se=E(ke);B=c(Se,"ION-ICON",{icon:!0,slot:!0}),E(B).forEach(a),H=T(Se),P=c(Se,"ION-TEXTAREA",{label:!0,placeholder:!0}),E(P).forEach(a),Se.forEach(a),R=T(ee),J=c(ee,"SECTION",{});var Me=E(J);q=c(Me,"LABEL",{for:!0,style:!0});var Z=E(q);Y=c(Z,"ION-BUTTON",{fill:!0,size:!0,class:!0,expand:!0});var Ee=E(Y);he=c(Ee,"LABEL",{for:!0,style:!0,"data-svelte-h":!0}),Q(he)!=="svelte-1m9yw22"&&(he.innerHTML=Ne),pe=T(Ee),re=c(Ee,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0}),Ee.forEach(a),Z.forEach(a),Me.forEach(a),Te=T(ee),te&&te.l(ee),Pe=T(ee),oe&&oe.l(ee),ee.forEach(a),se.forEach(a),qe=T(ie),Fe=c(ie,"ION-FOOTER",{});var Ve=E(Fe);Ae=c(Ve,"ION-TOOLBAR",{});var nt=E(Ae);De=c(nt,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),Q(De)!=="svelte-1c7dl3f"&&(De.textContent=U),nt.forEach(a),Ve.forEach(a),this.h()},h(){g(n,"color","medium"),g(o,"slot","start"),g(_,"title",""),g(e,"translucent",""),g(b,"icon",ln),g(b,"slot","start"),g(h,"label","Concepto"),g(h,"type","text"),g(h,"placeholder","Escribe aquí..."),g(h,"value",l[6]?l[6]:""),g(C,"icon",vt),g(C,"slot","start"),g(D,"label","Cantidad"),g(D,"type","number"),g(D,"value",l[7]?l[7]:""),g(y,"icon",yn),g(y,"slot","start"),x(S,"slot","label"),g(K,"value","cash"),g(ne,"value","card"),g(ve,"value","transfer"),g(k,"placeholder","Tipo de pago"),g(k,"value",l[8]?l[8]:""),g(B,"icon",vt),g(B,"slot","start"),g(P,"label","Comentarios"),g(P,"placeholder","Escribe aquí..."),x(he,"for","eventEvidence"),G(he,"width","100%"),G(he,"padding","8px"),G(re,"display","none"),x(re,"id","eventEvidence"),x(re,"name","fileToUpload"),x(re,"type","file"),x(re,"accept","image/*"),g(Y,"fill","outline"),g(Y,"size","small"),g(Y,"class","loadEvidence"),g(Y,"expand","block"),x(q,"for","eventEvidence"),G(q,"display","block"),G(q,"width","100%"),g(I,"fullscreen",""),g(De,"fill","outline"),g(De,"color","tertiary"),g(De,"strong",""),G(De,"width","99%"),G(De,"height","auto")},m(ie,ce){F(ie,e,ce),r(e,t),r(t,o),r(o,n),r(t,d),r(t,_),F(ie,O,ce),F(ie,I,ce),r(I,f),r(f,u),r(u,b),r(u,m),r(u,h),l[12](h),r(f,v),r(f,L),r(L,C),r(L,j),r(L,D),l[13](D),r(f,z),r(f,w),r(w,y),r(w,A),r(w,k),r(k,S),r(k,M),r(k,K),r(k,X),r(k,ne),r(k,ae),r(k,ve),l[14](k),r(f,Be),r(f,ke),r(ke,B),r(ke,H),r(ke,P),l[15](P),r(f,R),r(f,J),r(J,q),r(q,Y),r(Y,he),r(Y,pe),r(Y,re),r(f,Te),te&&te.m(f,null),r(f,Pe),oe&&oe.m(f,null),F(ie,qe,ce),F(ie,Fe,ce),r(Fe,Ae),r(Ae,De),$||(Ce=[le(n,"click",l[10]),le(re,"change",l[9]),le(De,"click",l[11])],$=!0)},p(ie,[ce]){ie[5]?te||(te=Ft(),te.c(),te.m(f,Pe)):te&&(te.d(1),te=null),ie[0]?oe?oe.p(ie,ce):(oe=qt(ie),oe.c(),oe.m(f,null)):oe&&(oe.d(1),oe=null)},i:ye,o:ye,d(ie){ie&&(a(e),a(O),a(I),a(qe),a(Fe)),l[12](null),l[13](null),l[14](null),l[15](null),te&&te.d(),oe&&oe.d(),$=!1,Ge(Ce)}}}function ao(l,e,t){let o=ht,n=document.querySelector("ion-modal"),i=n.componentProps.routeId,d=n.componentProps.ex_concept,_=n.componentProps.ex_amount,p=n.componentProps.ex_type,O=n.componentProps.id_expense,I="",f="",u="",b=0,m="",h="",v=!1;it(()=>{});const L=async(S,V)=>{await(await Xe.create({header:S||"Error",message:V||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()},C=async S=>{t(5,v=!0);const M=S.target.files[0],K=await j(M);if(K){const W=new FormData;W.append("fileToUpload",K);try{const X=await fetch(`${o}api/admin/manager/upload_img_driver.php`,{method:"POST",body:W});if(X.ok){const ne=await X.json();t(0,I=ne.img),f=ne.img_id}else console.error("File upload failed:",X.statusText)}catch(X){console.error("Error during file upload:",X)}finally{t(5,v=!1)}}},j=async S=>new Promise(V=>{const M=new FileReader;M.onload=K=>{const W=new Image;W.src=K.target.result,W.onload=()=>{const X=document.createElement("canvas"),ne=X.getContext("2d"),de=800,ae=600;let ve=W.width,Ie=W.height;ve>de&&(Ie*=de/ve,ve=de),Ie>ae&&(ve*=ae/Ie,Ie=ae),X.width=ve,X.height=Ie,ne.drawImage(W,0,0,ve,Ie),X.toBlob(Be=>{V(Be)},"image/jpeg",.7)}},M.readAsDataURL(S)}),D=()=>{at.dismiss()},z=()=>{var S=new Object;S.id_route=i,S.comments=m.value,S.type=u.value,S.img=I,S.img_id=f,S.amount=b.value,S.concept=h.value,S.status="done",S.id_expense=O||"null";const V=new FormData;for(const M in S)V.append(M,S[M]);!f||!I||!m.value||!b.value||!h.value?L("Datos incompletos","Llena los datos requeridos para completar el registro"):fetch(`${o}api/admin/expenses/add_expense.php`,{method:"POST",body:V}).then(M=>M.json()).then(M=>{D()}).catch(M=>{console.error("Error fetching data:",M)})};function w(S){He[S?"unshift":"push"](()=>{h=S,t(4,h)})}function y(S){He[S?"unshift":"push"](()=>{b=S,t(2,b)})}function A(S){He[S?"unshift":"push"](()=>{u=S,t(1,u)})}function k(S){He[S?"unshift":"push"](()=>{m=S,t(3,m)})}return[I,u,b,m,h,v,d,_,p,C,D,z,w,y,A,k]}class bt extends $e{constructor(e){super(),et(this,e,ao,ro,xe,{})}}function jt(l,e,t){const o=l.slice();return o[7]=e[t],o}function so(l){let e,t="Cargar gasto",o,n;function i(...d){return l[4](l[7],...d)}return{c(){e=s("ion-button"),e.textContent=t,this.h()},l(d){e=c(d,"ION-BUTTON",{fill:!0,size:!0,"aria-selected":!0,"data-svelte-h":!0}),Q(e)!=="svelte-175aelj"&&(e.textContent=t),this.h()},h(){g(e,"fill","outline"),g(e,"size","small"),g(e,"aria-selected","")},m(d,_){F(d,e,_),o||(n=le(e,"click",i),o=!0)},p(d,_){l=d},d(d){d&&a(e),o=!1,n()}}}function co(l){let e,t="Gasto completado";return{c(){e=s("ion-button"),e.textContent=t,this.h()},l(o){e=c(o,"ION-BUTTON",{fill:!0,size:!0,"aria-selected":!0,"data-svelte-h":!0}),Q(e)!=="svelte-tlger7"&&(e.textContent=t),this.h()},h(){g(e,"fill","solid"),g(e,"size","small"),g(e,"aria-selected","")},m(o,n){F(o,e,n)},p:ye,d(o){o&&a(e)}}}function Vt(l,e){let t,o,n,i=e[7].concept+"",d,_,p;function O(u,b){return u[7].status=="done"?co:so}let f=O(e)(e);return{key:l,first:null,c(){t=s("ion-item"),o=s("ion-label"),n=s("p"),d=fe(i),_=N(),f.c(),p=N(),this.h()},l(u){t=c(u,"ION-ITEM",{});var b=E(t);o=c(b,"ION-LABEL",{style:!0});var m=E(o);n=c(m,"P",{style:!0});var h=E(n);d=_e(h,i),h.forEach(a),m.forEach(a),_=T(b),f.l(b),p=T(b),b.forEach(a),this.h()},h(){G(n,"margin-left","10px"),G(o,"display","flex"),this.first=t},m(u,b){F(u,t,b),r(t,o),r(o,n),r(n,d),r(t,_),f.m(t,null),r(t,p)},p(u,b){e=u,f.p(e,b)},d(u){u&&a(t),f.d()}}}function uo(l){let e,t,o,n,i=`<ion-icon style="font-size: 25px!important;" icon="${wn}"></ion-icon>`,d,_,p="LISTA DE GASTOS",O,I,f,u=[],b=new Map,m,h,v,L="Cerrar",C,j,D=je(l[0]);const z=w=>w[7].id_expenses;for(let w=0;w<D.length;w+=1){let y=jt(l,D,w),A=z(y);b.set(A,u[w]=Vt(A,y))}return{c(){e=s("ion-header"),t=s("ion-toolbar"),o=s("ion-buttons"),n=s("ion-button"),n.innerHTML=i,d=N(),_=s("ion-title"),_.textContent=p,O=N(),I=s("ion-content"),f=s("ion-list");for(let w=0;w<u.length;w+=1)u[w].c();m=N(),h=s("ion-footer"),v=s("ion-button"),v.textContent=L,this.h()},l(w){e=c(w,"ION-HEADER",{translucent:!0});var y=E(e);t=c(y,"ION-TOOLBAR",{});var A=E(t);o=c(A,"ION-BUTTONS",{slot:!0});var k=E(o);n=c(k,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),Q(n)!=="svelte-160xz3i"&&(n.innerHTML=i),k.forEach(a),d=T(A),_=c(A,"ION-TITLE",{"data-svelte-h":!0}),Q(_)!=="svelte-1phn90x"&&(_.textContent=p),A.forEach(a),y.forEach(a),O=T(w),I=c(w,"ION-CONTENT",{fullscreen:!0});var S=E(I);f=c(S,"ION-LIST",{});var V=E(f);for(let K=0;K<u.length;K+=1)u[K].l(V);V.forEach(a),S.forEach(a),m=T(w),h=c(w,"ION-FOOTER",{});var M=E(h);v=c(M,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),Q(v)!=="svelte-zv7v83"&&(v.textContent=L),M.forEach(a),this.h()},h(){g(n,"color","medium"),g(o,"slot","end"),g(e,"translucent",""),g(I,"fullscreen",""),g(v,"fill","outline"),g(v,"color","tertiary"),g(v,"strong",""),G(v,"width","99%"),G(v,"height","auto")},m(w,y){F(w,e,y),r(e,t),r(t,o),r(o,n),r(t,d),r(t,_),F(w,O,y),F(w,I,y),r(I,f);for(let A=0;A<u.length;A+=1)u[A]&&u[A].m(f,null);F(w,m,y),F(w,h,y),r(h,v),C||(j=[le(n,"click",l[3]),le(v,"click",l[1])],C=!0)},p(w,[y]){y&5&&(D=je(w[0]),u=lt(u,y,z,1,w,D,b,f,rt,Vt,null,jt))},i:ye,o:ye,d(w){w&&(a(e),a(O),a(I),a(m),a(h));for(let y=0;y<u.length;y+=1)u[y].d();C=!1,Ge(j)}}}function fo(l){let e=document.querySelector("ion-modal");e.componentProps.routeId;let t=e.componentProps.expenses;it(()=>{});const o=()=>{at.dismiss()};function n(_,p,O,I,f){e.componentProps.ex_amount=O,e.componentProps.ex_concept=p,e.componentProps.ex_type=I,e.componentProps.id_expense=f,Ke("modal-expense",bt,{amount:O,concept:p,type:I,id_expense:f}).then(()=>{}),o()}return[t,o,n,_=>{Ke("modal-expense",bt,{routeId:_}).then(p=>{}),o()},(_,p)=>n(p,_.concept,_.amount,_.type,_.id_expenses)]}class _o extends $e{constructor(e){super(),et(this,e,fo,uo,xe,{})}}const{document:Gt}=Bn;function Kt(l,e,t){const o=l.slice();return o[36]=e[t],o[38]=t,o}function Wt(l,e,t){const o=l.slice();return o[36]=e[t],o[38]=t,o}function Xt(l,e,t){const o=l.slice();return o[36]=e[t],o[38]=t,o}function Jt(l){let e,t;return e=new An({props:{$$slots:{default:[Eo]},$$scope:{ctx:l}}}),{c(){hn(e.$$.fragment)},l(o){pn(e.$$.fragment,o)},m(o,n){mn(e,o,n),t=!0},p(o,n){const i={};n[0]&1019|n[1]&1024&&(i.$$scope={dirty:n,ctx:o}),e.$set(i)},i(o){t||(_t(e.$$.fragment,o),t=!0)},o(o){mt(e.$$.fragment,o),t=!1},d(o){vn(e,o)}}}function ho(l){let e,t='<div id="g_map" style="width: 100%; height: 100vh;"></div>';return{c(){e=s("ion-content"),e.innerHTML=t},l(o){e=c(o,"ION-CONTENT",{"data-svelte-h":!0}),Q(e)!=="svelte-1ydw6i9"&&(e.innerHTML=t)},m(o,n){F(o,e,n)},p:ye,d(o){o&&a(e)}}}function po(l){let e;function t(i,d){if(i[7].length>0)return vo;if(!i[3])return mo}let o=t(l),n=o&&o(l);return{c(){n&&n.c(),e=Ue()},l(i){n&&n.l(i),e=Ue()},m(i,d){n&&n.m(i,d),F(i,e,d)},p(i,d){o===(o=t(i))&&n?n.p(i,d):(n&&n.d(1),n=o&&o(i),n&&(n.c(),n.m(e.parentNode,e)))},d(i){i&&a(e),n&&n.d(i)}}}function mo(l){let e,t,o,n='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Jala para actualizar" refreshing-spinner="circles" refreshing-text="Actualizando..."></ion-refresher-content>',i,d,_=[],p=new Map,O,I,f=l[4]&&Yt(l),u=je(l[5]);const b=m=>m[36].id_event;for(let m=0;m<u.length;m+=1){let h=Kt(l,u,m),v=b(h);p.set(v,_[m]=Zt(v,h))}return{c(){f&&f.c(),e=N(),t=s("ion-content"),o=s("ion-refresher"),o.innerHTML=n,i=N(),d=s("ion-list");for(let m=0;m<_.length;m+=1)_[m].c();this.h()},l(m){f&&f.l(m),e=T(m),t=c(m,"ION-CONTENT",{});var h=E(t);o=c(h,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),Q(o)!=="svelte-1srnbs3"&&(o.innerHTML=n),i=T(h),d=c(h,"ION-LIST",{});var v=E(d);for(let L=0;L<_.length;L+=1)_[L].l(v);v.forEach(a),h.forEach(a),this.h()},h(){g(o,"slot","fixed")},m(m,h){f&&f.m(m,h),F(m,e,h),F(m,t,h),r(t,o),l[26](o),r(t,i),r(t,d);for(let v=0;v<_.length;v+=1)_[v]&&_[v].m(d,null);O||(I=le(o,"ionRefresh",l[10]),O=!0)},p(m,h){m[4]?f?f.p(m,h):(f=Yt(m),f.c(),f.m(e.parentNode,e)):f&&(f.d(1),f=null),h[0]&430112&&(u=je(m[5]),_=lt(_,h,b,1,m,u,p,d,rt,Zt,null,Kt))},d(m){m&&(a(e),a(t)),f&&f.d(m),l[26](null);for(let h=0;h<_.length;h+=1)_[h].d();O=!1,I()}}}function vo(l){let e,t;function o(d,_){return _[0]&144&&(e=null),e==null&&(e=!!(d[7].filter(ko).every(Oo)&&!d[4])),e?bo:go}let n=o(l,[-1,-1]),i=n(l);return{c(){i.c(),t=Ue()},l(d){i.l(d),t=Ue()},m(d,_){i.m(d,_),F(d,t,_)},p(d,_){n===(n=o(d,_))&&i?i.p(d,_):(i.d(1),i=n(d),i&&(i.c(),i.m(t.parentNode,t)))},d(d){d&&a(t),i.d(d)}}}function Yt(l){let e=l[13]("",l[1],l[0])+"",t;return{c(){t=fe(e)},l(o){t=_e(o,e)},m(o,n){F(o,t,n)},p(o,n){n[0]&3&&e!==(e=o[13]("",o[1],o[0])+"")&&ze(t,e)},d(o){o&&a(t)}}}function Qt(l){let e;return{c(){e=s("span"),this.h()},l(t){e=c(t,"SPAN",{class:!0}),E(e).forEach(a),this.h()},h(){x(e,"class","notes svelte-egzizz")},m(t,o){F(t,e,o)},d(t){t&&a(e)}}}function Zt(l,e){let t,o,n,i,d=parseInt(e[36].pos)+1+"",_,p,O,I,f,u,b=e[36].title+"",m,h,v=e[36].support_list&&e[36].support_list.length||e[15](e[36]),L,C,j,D,z,w=v&&Qt();function y(){return e[27](e[36],e[38])}return{key:l,first:null,c(){t=s("ion-item"),o=s("ion-avatar"),n=s("div"),i=s("div"),_=fe(d),O=N(),I=s("ion-label"),f=s("ion-text"),u=s("h3"),m=fe(b),h=N(),w&&w.c(),L=N(),C=s("ion-icon"),j=N(),this.h()},l(A){t=c(A,"ION-ITEM",{});var k=E(t);o=c(k,"ION-AVATAR",{slot:!0});var S=E(o);n=c(S,"DIV",{class:!0,title:!0,style:!0});var V=E(n);i=c(V,"DIV",{class:!0});var M=E(i);_=_e(M,d),M.forEach(a),V.forEach(a),S.forEach(a),O=T(k),I=c(k,"ION-LABEL",{button:!0});var K=E(I);f=c(K,"ION-TEXT",{color:!0});var W=E(f);u=c(W,"H3",{});var X=E(u);m=_e(X,b),h=T(X),w&&w.l(X),X.forEach(a),W.forEach(a),K.forEach(a),L=T(k),C=c(k,"ION-ICON",{icon:!0,slot:!0,style:!0}),E(C).forEach(a),j=T(k),k.forEach(a),this.h()},h(){x(i,"class","order svelte-egzizz"),x(n,"class","order-wrapper svelte-egzizz"),x(n,"title",p=Qe(e[36].status)),G(n,"background-color",Re(e[36].status,e[36].date_service)),G(n,"color",Ze(Re(e[36].status))),g(o,"slot","start"),g(f,"color","#2e2e2e"),g(I,"button",""),g(C,"icon",tt),g(C,"slot","end"),G(C,"color",Re(e[36].status,e[36].date_service)),this.first=t},m(A,k){F(A,t,k),r(t,o),r(o,n),r(n,i),r(i,_),r(t,O),r(t,I),r(I,f),r(f,u),r(u,m),r(u,h),w&&w.m(u,null),r(t,L),r(t,C),r(t,j),D||(z=le(I,"click",y),D=!0)},p(A,k){e=A,k[0]&32&&d!==(d=parseInt(e[36].pos)+1+"")&&ze(_,d),k[0]&32&&p!==(p=Qe(e[36].status))&&x(n,"title",p),k[0]&32&&G(n,"background-color",Re(e[36].status,e[36].date_service)),k[0]&32&&G(n,"color",Ze(Re(e[36].status))),k[0]&32&&b!==(b=e[36].title+"")&&ze(m,b),k[0]&32&&(v=e[36].support_list&&e[36].support_list.length||e[15](e[36])),v?w||(w=Qt(),w.c(),w.m(u,null)):w&&(w.d(1),w=null),k[0]&32&&G(C,"color",Re(e[36].status,e[36].date_service))},d(A){A&&a(t),w&&w.d(),D=!1,z()}}}function go(l){let e=l[13](l[7],l[1],l[0])+"",t,o,n,i,d='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Pull to refresh" refreshing-spinner="circles" refreshing-text="Refreshing..."></ion-refresher-content>',_,p,O=[],I=new Map,f,u,b=je(l[5]);const m=h=>h[36].id_event;for(let h=0;h<b.length;h+=1){let v=Wt(l,b,h),L=m(v);I.set(L,O[h]=$t(L,v))}return{c(){t=fe(e),o=N(),n=s("ion-content"),i=s("ion-refresher"),i.innerHTML=d,_=N(),p=s("ion-list");for(let h=0;h<O.length;h+=1)O[h].c();this.h()},l(h){t=_e(h,e),o=T(h),n=c(h,"ION-CONTENT",{});var v=E(n);i=c(v,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),Q(i)!=="svelte-dvt1s"&&(i.innerHTML=d),_=T(v),p=c(v,"ION-LIST",{});var L=E(p);for(let C=0;C<O.length;C+=1)O[C].l(L);L.forEach(a),v.forEach(a),this.h()},h(){g(i,"slot","fixed")},m(h,v){F(h,t,v),F(h,o,v),F(h,n,v),r(n,i),l[24](i),r(n,_),r(n,p);for(let L=0;L<O.length;L+=1)O[L]&&O[L].m(p,null);f||(u=le(i,"ionRefresh",l[10]),f=!0)},p(h,v){v[0]&131&&e!==(e=h[13](h[7],h[1],h[0])+"")&&ze(t,e),v[0]&430112&&(b=je(h[5]),O=lt(O,v,m,1,h,b,I,p,rt,$t,null,Wt))},d(h){h&&(a(t),a(o),a(n)),l[24](null);for(let v=0;v<O.length;v+=1)O[v].d();f=!1,u()}}}function bo(l){let e,t,o='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Jale para actualizar" refreshing-spinner="circles" refreshing-text="Actualizando..."></ion-refresher-content>',n,i,d=[],_=new Map,p,O,I=je(l[5]);const f=u=>u[36].id_event;for(let u=0;u<I.length;u+=1){let b=Xt(l,I,u),m=f(b);_.set(m,d[u]=tn(m,b))}return{c(){e=s("ion-content"),t=s("ion-refresher"),t.innerHTML=o,n=N(),i=s("ion-list");for(let u=0;u<d.length;u+=1)d[u].c();this.h()},l(u){e=c(u,"ION-CONTENT",{});var b=E(e);t=c(b,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),Q(t)!=="svelte-15ukrgn"&&(t.innerHTML=o),n=T(b),i=c(b,"ION-LIST",{});var m=E(i);for(let h=0;h<d.length;h+=1)d[h].l(m);m.forEach(a),b.forEach(a),this.h()},h(){g(t,"slot","fixed")},m(u,b){F(u,e,b),r(e,t),l[22](t),r(e,n),r(e,i);for(let m=0;m<d.length;m+=1)d[m]&&d[m].m(i,null);p||(O=le(t,"ionRefresh",l[10]),p=!0)},p(u,b){b[0]&430112&&(I=je(u[5]),d=lt(d,b,f,1,u,I,_,i,rt,tn,null,Xt))},d(u){u&&a(e),l[22](null);for(let b=0;b<d.length;b+=1)d[b].d();p=!1,O()}}}function xt(l){let e;return{c(){e=s("span"),this.h()},l(t){e=c(t,"SPAN",{class:!0}),E(e).forEach(a),this.h()},h(){x(e,"class","notes svelte-egzizz")},m(t,o){F(t,e,o)},d(t){t&&a(e)}}}function $t(l,e){let t,o,n,i,d=parseInt(e[36].pos)+1+"",_,p,O,I,f,u,b=e[36].title+"",m,h,v=e[36].support_list&&e[36].support_list.length||e[15](e[36]),L,C,j="",D,z,w,y,A,k=v&&xt();function S(){return e[25](e[36],e[38])}return{key:l,first:null,c(){t=s("ion-item"),o=s("ion-avatar"),n=s("div"),i=s("div"),_=fe(d),O=N(),I=s("ion-label"),f=s("ion-text"),u=s("h3"),m=fe(b),h=N(),k&&k.c(),L=N(),C=s("div"),C.innerHTML=j,D=N(),z=s("ion-icon"),w=N(),this.h()},l(V){t=c(V,"ION-ITEM",{});var M=E(t);o=c(M,"ION-AVATAR",{slot:!0});var K=E(o);n=c(K,"DIV",{class:!0,title:!0,style:!0});var W=E(n);i=c(W,"DIV",{class:!0});var X=E(i);_=_e(X,d),X.forEach(a),W.forEach(a),K.forEach(a),O=T(M),I=c(M,"ION-LABEL",{button:!0});var ne=E(I);f=c(ne,"ION-TEXT",{color:!0});var de=E(f);u=c(de,"H3",{});var ae=E(u);m=_e(ae,b),h=T(ae),k&&k.l(ae),ae.forEach(a),de.forEach(a),L=T(ne),C=c(ne,"DIV",{class:!0,"data-svelte-h":!0}),Q(C)!=="svelte-qaecoo"&&(C.innerHTML=j),ne.forEach(a),D=T(M),z=c(M,"ION-ICON",{icon:!0,slot:!0}),E(z).forEach(a),w=T(M),M.forEach(a),this.h()},h(){x(i,"class","order svelte-egzizz"),x(n,"class","order-wrapper svelte-egzizz"),x(n,"title",p=Qe(e[36].status)),G(n,"background-color",Re(e[36].status,e[36].date_service)),G(n,"color",Ze(Re(e[36].status))),g(o,"slot","start"),g(f,"color","#2e2e2e"),x(C,"class","sub svelte-egzizz"),g(I,"button",""),g(z,"icon",tt),g(z,"slot","end"),this.first=t},m(V,M){F(V,t,M),r(t,o),r(o,n),r(n,i),r(i,_),r(t,O),r(t,I),r(I,f),r(f,u),r(u,m),r(u,h),k&&k.m(u,null),r(I,L),r(I,C),r(t,D),r(t,z),r(t,w),y||(A=le(I,"click",S),y=!0)},p(V,M){e=V,M[0]&32&&d!==(d=parseInt(e[36].pos)+1+"")&&ze(_,d),M[0]&32&&p!==(p=Qe(e[36].status))&&x(n,"title",p),M[0]&32&&G(n,"background-color",Re(e[36].status,e[36].date_service)),M[0]&32&&G(n,"color",Ze(Re(e[36].status))),M[0]&32&&b!==(b=e[36].title+"")&&ze(m,b),M[0]&32&&(v=e[36].support_list&&e[36].support_list.length||e[15](e[36])),v?k||(k=xt(),k.c(),k.m(u,null)):k&&(k.d(1),k=null)},d(V){V&&a(t),k&&k.d(),y=!1,A()}}}function en(l){let e;return{c(){e=s("span"),this.h()},l(t){e=c(t,"SPAN",{class:!0}),E(e).forEach(a),this.h()},h(){x(e,"class","notes svelte-egzizz")},m(t,o){F(t,e,o)},d(t){t&&a(e)}}}function tn(l,e){let t,o,n,i,d=parseInt(e[36].pos)+1+"",_,p,O,I,f,u,b=e[36].title+"",m,h,v=e[36].support_list&&e[36].support_list.length||e[15](e[36]),L,C,j="",D,z,w,y,A,k=v&&en();function S(){return e[23](e[36],e[38])}return{key:l,first:null,c(){t=s("ion-item"),o=s("ion-avatar"),n=s("div"),i=s("div"),_=fe(d),O=N(),I=s("ion-label"),f=s("ion-text"),u=s("h3"),m=fe(b),h=N(),k&&k.c(),L=N(),C=s("div"),C.innerHTML=j,D=N(),z=s("ion-icon"),w=N(),this.h()},l(V){t=c(V,"ION-ITEM",{});var M=E(t);o=c(M,"ION-AVATAR",{slot:!0});var K=E(o);n=c(K,"DIV",{class:!0,title:!0,style:!0});var W=E(n);i=c(W,"DIV",{class:!0});var X=E(i);_=_e(X,d),X.forEach(a),W.forEach(a),K.forEach(a),O=T(M),I=c(M,"ION-LABEL",{button:!0});var ne=E(I);f=c(ne,"ION-TEXT",{color:!0});var de=E(f);u=c(de,"H3",{});var ae=E(u);m=_e(ae,b),h=T(ae),k&&k.l(ae),ae.forEach(a),de.forEach(a),L=T(ne),C=c(ne,"DIV",{class:!0,"data-svelte-h":!0}),Q(C)!=="svelte-qaecoo"&&(C.innerHTML=j),ne.forEach(a),D=T(M),z=c(M,"ION-ICON",{icon:!0,slot:!0}),E(z).forEach(a),w=T(M),M.forEach(a),this.h()},h(){x(i,"class","order svelte-egzizz"),x(n,"class","order-wrapper svelte-egzizz"),x(n,"title",p=Qe(e[36].status)),G(n,"background-color",Re(e[36].status,e[36].date_service)),G(n,"color",Ze(Re(e[36].status))),g(o,"slot","start"),g(f,"color","#2e2e2e"),x(C,"class","sub svelte-egzizz"),g(I,"button",""),g(z,"icon",tt),g(z,"slot","end"),this.first=t},m(V,M){F(V,t,M),r(t,o),r(o,n),r(n,i),r(i,_),r(t,O),r(t,I),r(I,f),r(f,u),r(u,m),r(u,h),k&&k.m(u,null),r(I,L),r(I,C),r(t,D),r(t,z),r(t,w),y||(A=le(I,"click",S),y=!0)},p(V,M){e=V,M[0]&32&&d!==(d=parseInt(e[36].pos)+1+"")&&ze(_,d),M[0]&32&&p!==(p=Qe(e[36].status))&&x(n,"title",p),M[0]&32&&G(n,"background-color",Re(e[36].status,e[36].date_service)),M[0]&32&&G(n,"color",Ze(Re(e[36].status))),M[0]&32&&b!==(b=e[36].title+"")&&ze(m,b),M[0]&32&&(v=e[36].support_list&&e[36].support_list.length||e[15](e[36])),v?k||(k=en(),k.c(),k.m(u,null)):k&&(k.d(1),k=null)},d(V){V&&a(t),k&&k.d(),y=!1,A()}}}function Eo(l){let e,t,o,n,i=`<ion-icon icon="${Ln}"></ion-icon>`,d,_,p,O=`<ion-icon icon="${Sn}"></ion-icon>`,I,f,u=(l[6].name?l[6].name.toUpperCase():"")+"",b,m,h,v='<ion-segment-button value="list"><ion-label>Paradas</ion-label></ion-segment-button> <ion-segment-button value="map"><ion-label>Mapa</ion-label></ion-segment-button>',L,C,j,D;function z(A,k){if(A[9]==="list")return po;if(A[9]==="map")return ho}let w=z(l),y=w&&w(l);return{c(){e=s("ion-header"),t=s("ion-toolbar"),o=s("ion-buttons"),n=s("ion-button"),n.innerHTML=i,d=N(),_=s("ion-buttons"),p=s("ion-button"),p.innerHTML=O,I=N(),f=s("ion-title"),b=fe(u),m=N(),h=s("ion-segment"),h.innerHTML=v,L=N(),y&&y.c(),C=Ue(),this.h()},l(A){e=c(A,"ION-HEADER",{translucent:!0});var k=E(e);t=c(k,"ION-TOOLBAR",{});var S=E(t);o=c(S,"ION-BUTTONS",{slot:!0});var V=E(o);n=c(V,"ION-BUTTON",{title:!0,alt:!0,"data-svelte-h":!0}),Q(n)!=="svelte-7ppz3r"&&(n.innerHTML=i),V.forEach(a),d=T(S),_=c(S,"ION-BUTTONS",{slot:!0});var M=E(_);p=c(M,"ION-BUTTON",{"data-svelte-h":!0}),Q(p)!=="svelte-nf50hj"&&(p.innerHTML=O),M.forEach(a),I=T(S),f=c(S,"ION-TITLE",{});var K=E(f);b=_e(K,u),K.forEach(a),S.forEach(a),m=T(k),h=c(k,"ION-SEGMENT",{value:!0,"data-svelte-h":!0}),Q(h)!=="svelte-lue4c9"&&(h.innerHTML=v),k.forEach(a),L=T(A),y&&y.l(A),C=Ue(),this.h()},h(){g(n,"title","Atrás"),g(n,"alt","Atrás"),g(o,"slot","start"),g(_,"slot","end"),g(h,"value","list"),g(e,"translucent","")},m(A,k){F(A,e,k),r(e,t),r(t,o),r(o,n),r(t,d),r(t,_),r(_,p),r(t,I),r(t,f),r(f,b),r(e,m),r(e,h),F(A,L,k),y&&y.m(A,k),F(A,C,k),j||(D=[le(n,"click",l[16]),le(p,"click",l[20]),le(h,"ionChange",l[21])],j=!0)},p(A,k){k[0]&64&&u!==(u=(A[6].name?A[6].name.toUpperCase():"")+"")&&ze(b,u),w===(w=z(A))&&y?y.p(A,k):(y&&y.d(1),y=w&&w(A),y&&(y.c(),y.m(C.parentNode,C)))},d(A){A&&(a(e),a(L),a(C)),y&&y.d(A),j=!1,Ge(D)}}}function Io(l){let e,t,o,n=l[2]&&Jt(l);return{c(){e=N(),n&&n.c(),t=Ue(),this.h()},l(i){un("svelte-kn0kph",Gt.head).forEach(a),e=T(i),n&&n.l(i),t=Ue(),this.h()},h(){Gt.title="Rutaflow - Detalles de ruta"},m(i,d){F(i,e,d),n&&n.m(i,d),F(i,t,d),o=!0},p(i,d){i[2]?n?(n.p(i,d),d[0]&4&&_t(n,1)):(n=Jt(i),n.c(),_t(n,1),n.m(t.parentNode,t)):n&&(gn(),mt(n,1,1,()=>{n=null}),dn())},i(i){o||(_t(n),o=!0)},o(i){mt(n),o=!1},d(i){i&&(a(e),a(t)),n&&n.d(i)}}}function Re(l,e=""){let t="#ffffff";return l==="pending"&&!e?t="#f2e300":l=="pending"&&e?t="#F6A833":l==="completed"&&(t="#44d900"),t}function Qe(l){let e="";return l=="pending"?e="Pendiente":l=="completed"&&(e="Completado"),e}function Ze(l){l.slice(0,1)==="#"&&(l=l.slice(1)),l.length===3&&(l=l.split("").map(function(i){return i+i}).join(""));const e=parseInt(l.substr(0,2),16),t=parseInt(l.substr(2,2),16),o=parseInt(l.substr(4,2),16);return(e*299+t*587+o*114)/1e3>=128?"#414040":"#fff"}const ko=l=>l.mandatory==="1",Oo=l=>l.img;function No(l,e,t){let o;fn(l,Mn,B=>t(19,o=B));var n=this&&this.__awaiter||function(B,H,P,R){function J(q){return q instanceof P?q:new P(function(Y){Y(q)})}return new(P||(P=Promise))(function(q,Y){function he(re){try{pe(R.next(re))}catch(Te){Y(Te)}}function Ne(re){try{pe(R.throw(re))}catch(Te){Y(Te)}}function pe(re){re.done?q(re.value):J(re.value).then(he,Ne)}pe((R=R.apply(B,H||[])).next())})};let{routeId:i}=e,{driverId:d}=e,_=ht,p=new Object,O=!0,I=!1,f=[],u={},b=[],m=[],h,v=!1,L="list",C;const j=()=>n(void 0,void 0,void 0,function*(){yield z(i),h.complete()});it(()=>n(void 0,void 0,void 0,function*(){yield z(i)}));function D(B){return n(this,void 0,void 0,function*(){if(t(9,L=B),L==="map"){yield _n(),C=document.getElementById("g_map");const H=new google.maps.Map(C,{zoom:8,center:{lat:20.6745683,lng:-103.3986104},mapId:"4504f8b37365c3d0"}),P=new google.maps.LatLngBounds,{AdvancedMarkerElement:R,PinElement:J}=yield google.maps.importLibrary("marker");navigator.geolocation?navigator.geolocation.getCurrentPosition(function(q){const Y=new google.maps.LatLng(q.coords.latitude,q.coords.longitude);new google.maps.Marker({position:Y,map:H,icon:{path:google.maps.SymbolPath.CIRCLE,fillColor:"#0062ff",fillOpacity:1,scale:6,strokeColor:"#ffffff",strokeWeight:2}}),new google.maps.Circle({strokeColor:"#00BFFF",strokeOpacity:.5,strokeWeight:1,fillColor:"#00BFFF",fillOpacity:.2,map:H,center:Y,radius:q.coords.accuracy}),P.extend(Y)},function(q){console.error("Error retrieving location:",q)}):console.error("Geolocation not supported by this browser."),f.forEach((q,Y)=>{const he=parseFloat(q.lat),Ne=parseFloat(q.lon),pe=new google.maps.LatLng(he,Ne),re=new google.maps.Marker({position:{lat:he,lng:Ne},map:H,title:q.title}),Te=new J({background:Re(q.status,q.date_service),borderColor:"#000",glyphColor:"#000",glyph:(parseInt(q.pos)+1).toString()});new R({map:H,position:pe,content:Te.element,title:"Parada "+(parseInt(q.pos)+1).toString()+": "+q.title}).addListener("click",function(qe){y(q,W(Y))}),P.extend(re.getPosition())}),H.fitBounds(P)}})}function z(B){return n(this,void 0,void 0,function*(){const H=new FormData;H.append("id_route",B);try{const R=yield(yield fetch(`${_}api/admin/report/seguimiento_list.php`,{method:"POST",body:H})).json();t(6,u=R.data.seguimiento_list[0]),t(5,f=R.data.event_list),t(7,b=R.data.checklist),m=R.data.expenses,u&&t(4,I=u.km_inicial=="0"&&u.gas_inicial=="0"),t(3,O=!1)}catch(P){t(3,O=!1),console.error("Error fetching data:",P)}})}const w=B=>new Promise((H,P)=>{const R=new FormData;R.append("id_route",B.id_route),R.append("id_event",B.id_event),fetch(`${_}api/admin/evidence/evidence_by_event.php`,{method:"POST",body:R}).then(J=>J.json()).then(J=>{H(J.data.event_evidence[0])}).catch(J=>{console.error("Error fetching data:",J),P(J)})}),y=(B,H)=>{w(B).then(P=>{P&&(B.img=P.img,B.driver_comments=P.driver_comments,B.comments=P.comments),Ke("modal-delivery-info",lo,{delivery:B,isLast:H}).then(R=>{}).finally(()=>{z(i)})})},A=(B,H,P)=>{var R=!1;return v||(v=!0,Ke("modal-checklist",an,{checklist:B,driverId:H,routeId:P,isLast:R}).then(J=>{v=!1}),V(P,"checklist")),""},k=B=>n(void 0,void 0,void 0,function*(){return yield z(B),m.length>0?Ke("modal-expense-detail",_o,{routeId:B,expenses:m}).then(H=>{}):Ke("modal-expense",bt,{routeId:B}).then(H=>{}),""}),S=B=>{if(B.tracking_type=="subscription"){if(B.subscriber_info&&B.payment_type==="cash"&&new Date(B.subscriber_info.payment_next)<new Date)return!0}else if(B.tracking_type=="ecommerce"&&Number(B.payment_pending)>0)return!0;return!1};function V(B,H){let P=new FormData;return P.append("id_route",B),P.append("status",H),fetch(`${_}api/admin/route/change_status.php`,{method:"POST",body:P}).then(R=>R.json()).then(R=>{}).catch(R=>{console.error("Error fetching data:",R)}),""}const M=()=>{p.id_driver?We(`/drivers/${p.id_driver}`):We("/drivers/me")},K=(B,H)=>n(void 0,void 0,void 0,function*(){yield(yield Xe.create({header:B||"Error",message:H||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()});function W(B){return B===f.length-1}const X=()=>k(i),ne=B=>D(B.detail.value);function de(B){He[B?"unshift":"push"](()=>{h=B,t(8,h)})}const ae=(B,H)=>{const P=f.findIndex(he=>he.id_event===B.id_event),R=P===0,J=P>0?f[P-1]:null,q=R||J&&J.img!==null,Y=B.img!==null&&B.img!=="";q||R&&!Y?y(B,W(H)):K("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")};function ve(B){He[B?"unshift":"push"](()=>{h=B,t(8,h)})}const Ie=(B,H)=>{const P=f.findIndex(he=>he.id_event===B.id_event),R=P===0,J=P>0?f[P-1]:null,q=R||J&&J.img!==null,Y=B.img!==null&&B.img!=="";q||R&&!Y?y(B,W(H)):K("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")};function Be(B){He[B?"unshift":"push"](()=>{h=B,t(8,h)})}const ke=(B,H)=>{const P=f.findIndex(he=>he.id_event===B.id_event),R=P===0,J=P>0?f[P-1]:null,q=R||J&&J.img!==null,Y=B.img!==null&&B.img!=="";q||R&&!Y?y(B,W(H)):K("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")};return l.$$set=B=>{"routeId"in B&&t(0,i=B.routeId),"driverId"in B&&t(1,d=B.driverId)},l.$$.update=()=>{l.$$.dirty[0]&524293&&(t(0,{routeId:i,driverId:d}=o.params,i,(t(1,d),t(19,o),t(2,p),t(0,i))),t(2,p=JSON.parse(localStorage.getItem("userSession"))),p?p.id_user&&(p.type=="admin"||p.type=="superadmin")?(z(i),We(`/drivers/me/routes/${i}`)):p.id_user&&p.id_driver&&(z(i),We(`/drivers/${p.id_driver}/routes/${i}`)):We("/"))},[i,d,p,O,I,f,u,b,h,L,j,D,y,A,k,S,M,K,W,o,X,ne,de,ae,ve,Ie,Be,ke]}class Ao extends $e{constructor(e){super(),et(this,e,No,Io,xe,{routeId:0,driverId:1},null,[-1,-1])}}export{Ao as component};

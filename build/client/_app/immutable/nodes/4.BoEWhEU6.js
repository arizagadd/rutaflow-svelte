import{s as be,j as L,k as P,l as ke,h as f,m as C,i as N,p as ge,o as ye,e as v,t as H,b,q as g,r as M,d as Z,v as U,w as d,x as K,y as W,z as Ie,A as ae,n as le,f as q,B as J,C as he}from"../chunks/index.CdEBkEwf.js";import{S as Ee,i as Ne,t as $,a as ne,c as Oe,b as Te,d as Ae,m as Se,e as we,g as De}from"../chunks/index.Dw8w8a4z.js";import{g as Re,l as Le,p as Ce,e as x,u as me,d as ve}from"../chunks/index.FEiZiFOn.js";import"../chunks/index-6e05b96e.C_9q9BoX.js";import{I as He,a as Me,D as Be}from"../chunks/IonPage.CWLPDgAr.js";import{g as Y}from"../chunks/entry.sf7mHP6E.js";function ue(l,e,o){const t=l.slice();return t[20]=e[o],t}function ce(l,e,o){const t=l.slice();return t[20]=e[o],t}function fe(l){let e,o;return e=new He({props:{$$slots:{default:[Ye]},$$scope:{ctx:l}}}),{c(){Te(e.$$.fragment)},l(t){Ae(e.$$.fragment,t)},m(t,n){Se(e,t,n),o=!0},p(t,n){const i={};n&33554559&&(i.$$scope={dirty:n,ctx:t}),e.$set(i)},i(t){o||($(e.$$.fragment,t),o=!0)},o(t){ne(e.$$.fragment,t),o=!1},d(t){we(e,t)}}}function ze(l){let e;function o(i,r){return i[2].length!=0?Ue:Ve}let t=o(l),n=t(l);return{c(){n.c(),e=P()},l(i){n.l(i),e=P()},m(i,r){n.m(i,r),N(i,e,r)},p(i,r){t===(t=o(i))&&n?n.p(i,r):(n.d(1),n=t(i),n&&(n.c(),n.m(e.parentNode,e)))},d(i){i&&f(e),n.d(i)}}}function Fe(l){let e;function o(i,r){return i[2].length!=0?Je:je}let t=o(l),n=t(l);return{c(){n.c(),e=P()},l(i){n.l(i),e=P()},m(i,r){n.m(i,r),N(i,e,r)},p(i,r){t===(t=o(i))&&n?n.p(i,r):(n.d(1),n=t(i),n&&(n.c(),n.m(e.parentNode,e)))},d(i){i&&f(e),n.d(i)}}}function Ve(l){let e=l[10]("false")+"",o;return{c(){o=H(e)},l(t){o=M(t,e)},m(t,n){N(t,o,n)},p:le,d(t){t&&f(o)}}}function Ue(l){let e=[],o=new Map,t,n=x(l[2].filter(l[16]));const i=r=>r[20].id_route;for(let r=0;r<n.length;r+=1){let a=ue(l,n,r),u=i(a);o.set(u,e[r]=_e(u,a))}return{c(){for(let r=0;r<e.length;r+=1)e[r].c();t=P()},l(r){for(let a=0;a<e.length;a+=1)e[a].l(r);t=P()},m(r,a){for(let u=0;u<e.length;u+=1)e[u]&&e[u].m(r,a);N(r,t,a)},p(r,a){a&3589&&(n=x(r[2].filter(r[16])),e=me(e,a,i,1,r,n,o,t.parentNode,ve,_e,t,ue))},d(r){r&&f(t);for(let a=0;a<e.length;a+=1)e[a].d(r)}}}function qe(l){let e=l[10]("false")+"",o;return{c(){o=H(e)},l(t){o=M(t,e)},m(t,n){N(t,o,n)},p:le,d(t){t&&f(o)}}}function Pe(l){let e,o,t,n,i=l[11](l[20].name.charAt(0))+"",r,a,u,s,p,T=l[20].name+"",y,A,I,B,E=l[20].date_start+"",O,z,R,S,F,j;return{c(){e=v("ion-item"),o=v("ion-avatar"),t=v("div"),n=v("div"),r=H(i),u=L(),s=v("ion-label"),p=v("h2"),y=H(T),A=L(),I=v("h3"),B=H("Inicio: "),O=H(E),z=L(),R=v("div"),S=L(),this.h()},l(c){e=b(c,"ION-ITEM",{button:!0});var _=g(e);o=b(_,"ION-AVATAR",{slot:!0});var w=g(o);t=b(w,"DIV",{class:!0,style:!0,title:!0});var k=g(t);n=b(k,"DIV",{class:!0,style:!0});var m=g(n);r=M(m,i),m.forEach(f),k.forEach(f),w.forEach(f),u=C(_),s=b(_,"ION-LABEL",{});var h=g(s);p=b(h,"H2",{});var D=g(p);y=M(D,T),D.forEach(f),A=C(h),I=b(h,"H3",{class:!0});var V=g(I);B=M(V,"Inicio: "),O=M(V,E),V.forEach(f),h.forEach(f),z=C(_),R=b(_,"DIV",{slot:!0}),g(R).forEach(f),S=C(_),_.forEach(f),this.h()},h(){q(n,"class","route-symbol svelte-1xh3ip"),q(n,"style",""),q(t,"class","route-color svelte-1xh3ip"),J(t,"background-color",G(l[20].status)),J(t,"color",te(G(l[20].status))),q(t,"title",a=ee(l[20].status)),U(o,"slot","start"),q(I,"class","text-muted svelte-1xh3ip"),q(R,"slot","end"),U(e,"button","")},m(c,_){N(c,e,_),d(e,o),d(o,t),d(t,n),d(n,r),d(e,u),d(e,s),d(s,p),d(p,y),d(s,A),d(s,I),d(I,B),d(I,O),d(e,z),d(e,R),d(e,S),F||(j=K(e,"click",function(){he(l[9](l[20].id_route,l[20].status))&&l[9](l[20].id_route,l[20].status).apply(this,arguments)}),F=!0)},p(c,_){l=c,_&5&&i!==(i=l[11](l[20].name.charAt(0))+"")&&W(r,i),_&5&&J(t,"background-color",G(l[20].status)),_&5&&J(t,"color",te(G(l[20].status))),_&5&&a!==(a=ee(l[20].status))&&q(t,"title",a),_&5&&T!==(T=l[20].name+"")&&W(y,T),_&5&&E!==(E=l[20].date_start+"")&&W(O,E)},d(c){c&&f(e),F=!1,j()}}}function _e(l,e){let o=e[10]("true")+"",t,n,i;function r(s,p){return s[20].status!="completed"&&s[20].status!="cancelled"&&s[20].status!="finished"?Pe:qe}let a=r(e),u=a(e);return{key:l,first:null,c(){t=H(o),n=L(),u.c(),i=P(),this.h()},l(s){t=M(s,o),n=C(s),u.l(s),i=P(),this.h()},h(){this.first=t},m(s,p){N(s,t,p),N(s,n,p),u.m(s,p),N(s,i,p)},p(s,p){e=s,a===(a=r(e))&&u?u.p(e,p):(u.d(1),u=a(e),u&&(u.c(),u.m(i.parentNode,i)))},d(s){s&&(f(t),f(n),f(i)),u.d(s)}}}function je(l){let e=l[10]("false")+"",o;return{c(){o=H(e)},l(t){o=M(t,e)},m(t,n){N(t,o,n)},p:le,d(t){t&&f(o)}}}function Je(l){let e=[],o=new Map,t,n=x(l[2]);const i=r=>r[20].id_route;for(let r=0;r<n.length;r+=1){let a=ce(l,n,r),u=i(a);o.set(u,e[r]=de(u,a))}return{c(){for(let r=0;r<e.length;r+=1)e[r].c();t=P()},l(r){for(let a=0;a<e.length;a+=1)e[a].l(r);t=P()},m(r,a){for(let u=0;u<e.length;u+=1)e[u]&&e[u].m(r,a);N(r,t,a)},p(r,a){a&3588&&(n=x(r[2]),e=me(e,a,i,1,r,n,o,t.parentNode,ve,de,t,ce))},d(r){r&&f(t);for(let a=0;a<e.length;a+=1)e[a].d(r)}}}function Ge(l){let e=l[10]("false")+"",o;return{c(){o=H(e)},l(t){o=M(t,e)},m(t,n){N(t,o,n)},p:le,d(t){t&&f(o)}}}function We(l){let e,o,t,n,i=l[11](l[20].name.charAt(0))+"",r,a,u,s,p,T=(l[20].name?l[20].name.toUpperCase():"")+"",y,A,I,B,E=l[20].date_start+"",O,z,R,S,F,j;return{c(){e=v("ion-item"),o=v("ion-avatar"),t=v("div"),n=v("div"),r=H(i),u=L(),s=v("ion-label"),p=v("h2"),y=H(T),A=L(),I=v("h3"),B=H("Inicio: "),O=H(E),z=L(),R=v("div"),S=L(),this.h()},l(c){e=b(c,"ION-ITEM",{button:!0});var _=g(e);o=b(_,"ION-AVATAR",{slot:!0});var w=g(o);t=b(w,"DIV",{class:!0,style:!0,title:!0});var k=g(t);n=b(k,"DIV",{class:!0,style:!0});var m=g(n);r=M(m,i),m.forEach(f),k.forEach(f),w.forEach(f),u=C(_),s=b(_,"ION-LABEL",{});var h=g(s);p=b(h,"H2",{});var D=g(p);y=M(D,T),D.forEach(f),A=C(h),I=b(h,"H3",{class:!0});var V=g(I);B=M(V,"Inicio: "),O=M(V,E),V.forEach(f),h.forEach(f),z=C(_),R=b(_,"DIV",{slot:!0}),g(R).forEach(f),S=C(_),_.forEach(f),this.h()},h(){q(n,"class","route-symbol svelte-1xh3ip"),q(n,"style",""),q(t,"class","route-color svelte-1xh3ip"),J(t,"background-color",G(l[20].status)),J(t,"color",te(G(l[20].status))),q(t,"title",a=ee(l[20].status)),U(o,"slot","start"),q(I,"class","text-muted svelte-1xh3ip"),q(R,"slot","end"),U(e,"button","")},m(c,_){N(c,e,_),d(e,o),d(o,t),d(t,n),d(n,r),d(e,u),d(e,s),d(s,p),d(p,y),d(s,A),d(s,I),d(I,B),d(I,O),d(e,z),d(e,R),d(e,S),F||(j=K(e,"click",function(){he(l[9](l[20].id_route,l[20].status))&&l[9](l[20].id_route,l[20].status).apply(this,arguments)}),F=!0)},p(c,_){l=c,_&4&&i!==(i=l[11](l[20].name.charAt(0))+"")&&W(r,i),_&4&&J(t,"background-color",G(l[20].status)),_&4&&J(t,"color",te(G(l[20].status))),_&4&&a!==(a=ee(l[20].status))&&q(t,"title",a),_&4&&T!==(T=(l[20].name?l[20].name.toUpperCase():"")+"")&&W(y,T),_&4&&E!==(E=l[20].date_start+"")&&W(O,E)},d(c){c&&f(e),F=!1,j()}}}function de(l,e){let o=e[10]("true")+"",t,n,i;function r(s,p){return s[20].status!="completed"&&s[20].status!="cancelled"&&s[20].status!="finished"?We:Ge}let a=r(e),u=a(e);return{key:l,first:null,c(){t=H(o),n=L(),u.c(),i=P(),this.h()},l(s){t=M(s,o),n=C(s),u.l(s),i=P(),this.h()},h(){this.first=t},m(s,p){N(s,t,p),N(s,n,p),u.m(s,p),N(s,i,p)},p(s,p){e=s,a===(a=r(e))&&u?u.p(e,p):(u.d(1),u=a(e),u&&(u.c(),u.m(i.parentNode,i)))},d(s){s&&(f(t),f(n),f(i)),u.d(s)}}}function pe(l){let e,o='<ion-row class="h-full items-center"><ion-col class="text-center"><h2 class="text-3xl text-muted mb-4 svelte-1xh3ip">No hay rutas pendientes para hoy</h2> <p class="text-muted svelte-1xh3ip">Espere indicaciones de su supervisor</p></ion-col></ion-row>';return{c(){e=v("ion-grid"),e.innerHTML=o,this.h()},l(t){e=b(t,"ION-GRID",{class:!0,"data-svelte-h":!0}),Z(e)!=="svelte-3d9uou"&&(e.innerHTML=o),this.h()},h(){U(e,"class","ion-text-center h-full")},m(t,n){N(t,e,n)},d(t){t&&f(e)}}}function Ye(l){let e,o,t,n,i=l[1].name+"",r,a,u,s,p='<ion-select-option value="enroute">Rutas en curso</ion-select-option> <ion-select-option value="routes-of-day">Rutas del día</ion-select-option> <ion-select-option value="yesterday-routes">Rutas de ayer</ion-select-option> <ion-select-option value="week-routes">Rutas de la semana</ion-select-option>',T,y,A,I=`<ion-icon icon="${Le}"></ion-icon>`,B,E,O,z='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Jale para actualizar" refreshing-spinner="circles" refreshing-text="Actualizando..."></ion-refresher-content>',R,S,F,j,c;function _(h,D){return h[0]=="me"&&h[4]?Fe:ze}let w=_(l),k=w(l),m=!l[3]&&pe();return{c(){e=v("ion-header"),o=v("ion-toolbar"),t=v("ion-buttons"),n=v("ion-button"),r=H(i),a=L(),u=v("ion-title"),s=v("ion-select"),s.innerHTML=p,T=L(),y=v("ion-buttons"),A=v("ion-button"),A.innerHTML=I,B=L(),E=v("ion-content"),O=v("ion-refresher"),O.innerHTML=z,R=L(),S=v("ion-list"),k.c(),F=L(),m&&m.c(),this.h()},l(h){e=b(h,"ION-HEADER",{translucent:!0});var D=g(e);o=b(D,"ION-TOOLBAR",{});var V=g(o);t=b(V,"ION-BUTTONS",{slot:!0});var oe=g(t);n=b(oe,"ION-BUTTON",{});var ie=g(n);r=M(ie,i),ie.forEach(f),oe.forEach(f),a=C(V),u=b(V,"ION-TITLE",{});var re=g(u);s=b(re,"ION-SELECT",{id:!0,interface:!0,value:!0,"data-svelte-h":!0}),Z(s)!=="svelte-znqezo"&&(s.innerHTML=p),re.forEach(f),T=C(V),y=b(V,"ION-BUTTONS",{slot:!0});var se=g(y);A=b(se,"ION-BUTTON",{title:!0,alt:!0,"data-svelte-h":!0}),Z(A)!=="svelte-83ekyc"&&(A.innerHTML=I),se.forEach(f),V.forEach(f),D.forEach(f),B=C(h),E=b(h,"ION-CONTENT",{});var Q=g(E);O=b(Q,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),Z(O)!=="svelte-1wkherr"&&(O.innerHTML=z),R=C(Q),S=b(Q,"ION-LIST",{});var X=g(S);k.l(X),F=C(X),m&&m.l(X),X.forEach(f),Q.forEach(f),this.h()},h(){U(t,"slot","start"),U(s,"id","quick-filter"),U(s,"interface","action-sheet"),U(s,"value","routes-of-day"),U(A,"title","Salir"),U(A,"alt","Salir"),U(y,"slot","end"),U(e,"translucent",""),U(O,"slot","fixed")},m(h,D){N(h,e,D),d(e,o),d(o,t),d(t,n),d(n,r),d(o,a),d(o,u),d(u,s),l[14](s),d(o,T),d(o,y),d(y,A),N(h,B,D),N(h,E,D),d(E,O),l[15](O),d(E,R),d(E,S),k.m(S,null),d(S,F),m&&m.m(S,null),j||(c=[K(s,"ionChange",l[8]),K(A,"click",l[12]),K(O,"ionRefresh",l[7])],j=!0)},p(h,D){D&2&&i!==(i=h[1].name+"")&&W(r,i),w===(w=_(h))&&k?k.p(h,D):(k.d(1),k=w(h),k&&(k.c(),k.m(S,F))),h[3]?m&&(m.d(1),m=null):m||(m=pe(),m.c(),m.m(S,null))},d(h){h&&(f(e),f(B),f(E)),l[14](null),l[15](null),k.d(),m&&m.d(),j=!1,Ie(c)}}}function Ke(l){let e,o,t,n=l[1]&&fe(l);return{c(){e=L(),n&&n.c(),o=P(),this.h()},l(i){ke("svelte-qavk4j",document.head).forEach(f),e=C(i),n&&n.l(i),o=P(),this.h()},h(){document.title="Rutas - Rutaflow"},m(i,r){N(i,e,r),n&&n.m(i,r),N(i,o,r),t=!0},p(i,[r]){i[1]?n?(n.p(i,r),r&2&&$(n,1)):(n=fe(i),n.c(),$(n,1),n.m(o.parentNode,o)):n&&(De(),ne(n,1,1,()=>{n=null}),Oe())},i(i){t||($(n),t=!0)},o(i){ne(n),t=!1},d(i){i&&(f(e),f(o)),n&&n.d(i)}}}function G(l){let e="#ffffff";return l==="pending"?e="#FAD733":l==="completed"?e="#27C24C":l=="enroute"?e="#3BBAC2":l=="paused"?e="#949DB9":l=="cancelled"?e="#F05050":l=="checklist"?e="#F6A833":l=="checklist-pending"&&(e="#E98C00"),e}function ee(l){let e="";return l==="pending"?e="Pendiente":l==="completed"?e="Completado":l=="enroute"?e="En ruta":l=="paused"?e="Pausado":l=="cancelled"?e="Cancelado":l=="checklist"?e="En checklist":l=="checklist-pending"&&(e="Pendiente de aprobar checklist"),e}function te(l){l.slice(0,1)==="#"&&(l=l.slice(1)),l.length===3&&(l=l.split("").map(function(i){return i+i}).join(""));const e=parseInt(l.substr(0,2),16),o=parseInt(l.substr(2,2),16),t=parseInt(l.substr(4,2),16);return(e*299+o*587+t*114)/1e3>=128?"#414040":"#fff"}function Qe(){var l=new Date,e=l.getDate(),o=l.getMonth()+1,t=l.getFullYear(),n=t+"-"+o+"-"+e;return{today:n,year:t,month:o,date:l,day:e}}function Xe(l,e,o){let t;ge(l,Ce,c=>o(13,t=c));let{driverId:n}=e,i=Be,r=[],a=new Object,u=!1,s=!1,p=new Object,T,y="routes-of-day";const A=async()=>{await I(),T.complete()};ye(async()=>{A()});function I(){var c=new Object;c.id_enterprise=p.id_enterprise?p.id_enterprise:"null",c.id_user_over=p.id_user,c.token=p.token;var _=y.value?y.value:y;console.log("Selected Filter:",_);let w=Qe();if(_==="enroute")c.status="enroute";else if(_==="routes-of-day")c.actual_date=w.today;else if(_==="yesterday-routes"){let k=new Date(w.date);k.setDate(k.getDate()-1);let m=k.toISOString().split("T")[0];c.actual_date=m}else if(_==="week-routes"){let k=w.date.getDay(),m=k===0?6:k-1,h=new Date(w.date);h.setDate(w.date.getDate()-m);let D=h.toISOString().split("T")[0];c.actual_date=D,c.actual_date2=w.today}Re(`${i}api/admin/report/seguimiento_list.php`,function(k){const m=k;o(2,r=m.data.seguimiento_list),a=m.data.event_list},c)}function B(c,_){_=="checklist-pending"?z("Checklist Pendiente de Autorizar","La lista de requerimientos de ruta está en revisión, podrás inciar la ruta una vez autorizado el checklist."):Y(`/drivers/${n}/routes/${c}`)}function E(c){return c=="true"?o(3,u=!0):o(3,u=!1),""}const O=c=>c.charAt(0).toUpperCase()+c.slice(1),z=async(c,_)=>{await(await Me.create({header:c||"Error",message:_||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()},R=()=>{Y("/"),o(4,s=!1),localStorage.removeItem("userSession")};function S(c){ae[c?"unshift":"push"](()=>{y=c,o(6,y)})}function F(c){ae[c?"unshift":"push"](()=>{T=c,o(5,T)})}const j=c=>c.id_driver===n;return l.$$set=c=>{"driverId"in c&&o(0,n=c.driverId)},l.$$.update=()=>{l.$$.dirty&8195&&(o(0,{driverId:n}=t.params,n),o(1,p=JSON.parse(localStorage.getItem("userSession"))),p?n=="me"&&p.id_user?p.type=="admin"||p.type=="super"?(Y("/drivers/me"),I(),o(4,s=!0)):(z("Usuario no autorizado","Este usuario no tiene acceso a la app de Rutaflow, entrar en contacto con soporte"),Y("/")):p&&n&&(Y(`/drivers/${p.id_driver}`),I()):(z("Sesión cerrada","Será redireccionado para volver a ingresar"),Y("/")))},[n,p,r,u,s,T,y,A,I,B,E,O,R,t,S,F,j]}class nt extends Ee{constructor(e){super(),Ne(this,e,Xe,Ke,be,{driverId:0})}}export{nt as component};

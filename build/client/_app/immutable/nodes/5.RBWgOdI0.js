import{Z as Et,s as xe,e as s,j as N,b as c,q as E,d as Y,h as a,m as T,v as g,i as H,w as r,x as ae,n as Ce,z as Ge,_ as sn,B as q,o as it,k as Ue,$ as It,t as pe,r as me,f as x,a0 as cn,a1 as ot,A as He,y as De,a2 as dt,l as un,p as fn,F as _n}from"../chunks/index.BYLndrM5.js";import{S as $e,i as et,t as _t,a as mt,c as dn,b as hn,d as pn,m as mn,e as vn,g as gn}from"../chunks/index.BNHbygFo.js";import{e as je,u as lt,d as rt,a as bn,c as vt,b as nn,f as En,g as In,i as on,h as kn,j as ln,k as On,m as Nn,s as kt,n as tt,o as Tn,q as Cn,r as yn,t as wn,v as Ln,w as Sn,p as Mn}from"../chunks/index.CFncrMVC.js";import"../chunks/index-48209844.IIRtDZyg.js";import{m as at,D as ht,a as Qe,I as Pn}from"../chunks/IonPage.BBnnmgsL.js";import{q as An,t as Dn}from"../chunks/ion-modal.CsJaVgKZ.js";import{g as We}from"../chunks/entry.BwQ2z8Tu.js";const Bn=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global,zn=(l,e)=>{if(!customElements.get(l)){class t extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const n={};for(const i of this.attributes)n[i.name]=i.value;new e({target:this.shadowRoot,props:n})}}customElements.define(l,t)}},Hn=function(l){return document.createElement(l).constructor!==HTMLElement},Rn=(l,e)=>{Hn(l)||zn(l,e)},Ke=async(l,e,t)=>{An(),Dn(),Rn(l,e);const o=await at.create({component:l,componentProps:t});return o.present(),await o.onWillDismiss()};let Je=Et({km_inicial:[],gas_inicial:[],km_final:[],gas_final:[]}),rn=Et({flag:[]});function Un(l){let e,t,o,n,i="Cancelar",d,_,h="Captura de Km/Gas",O,I,f,u="Confirmar",b,p,m,v,w,y,R;return{c(){e=s("ion-header"),t=s("ion-toolbar"),o=s("ion-buttons"),n=s("ion-button"),n.textContent=i,d=N(),_=s("ion-title"),_.textContent=h,O=N(),I=s("ion-buttons"),f=s("ion-button"),f.textContent=u,b=N(),p=s("ion-content"),m=s("ion-item"),v=s("ion-input"),this.h()},l(D){e=c(D,"ION-HEADER",{translucent:!0});var B=E(e);t=c(B,"ION-TOOLBAR",{});var C=E(t);o=c(C,"ION-BUTTONS",{slot:!0});var L=E(o);n=c(L,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),Y(n)!=="svelte-17pq4f4"&&(n.textContent=i),L.forEach(a),d=T(C),_=c(C,"ION-TITLE",{"data-svelte-h":!0}),Y(_)!=="svelte-1yhkaq7"&&(_.textContent=h),O=T(C),I=c(C,"ION-BUTTONS",{slot:!0});var A=E(I);f=c(A,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),Y(f)!=="svelte-cm6j4s"&&(f.textContent=u),A.forEach(a),C.forEach(a),B.forEach(a),b=T(D),p=c(D,"ION-CONTENT",{fullscreen:!0});var k=E(p);m=c(k,"ION-ITEM",{});var M=E(m);v=c(M,"ION-INPUT",{class:!0,inputmode:!0,pattern:!0,type:!0,placeholder:!0,value:!0,required:!0});var U=E(v);U.forEach(a),M.forEach(a),k.forEach(a),this.h()},h(){g(n,"color","medium"),g(o,"slot","start"),g(f,"strong",""),g(I,"slot","end"),g(e,"translucent",""),g(v,"class","fin-km"),g(v,"inputmode","numeric"),g(v,"pattern","[0-9]*"),g(v,"type","number"),g(v,"placeholder",w="Ingresa "+l[0]+" actual"),g(v,"value",l[1]),g(v,"required",""),g(p,"fullscreen","")},m(D,B){H(D,e,B),r(e,t),r(t,o),r(o,n),r(t,d),r(t,_),r(t,O),r(t,I),r(I,f),H(D,b,B),H(D,p,B),r(p,m),r(m,v),y||(R=[ae(n,"click",l[2]),ae(f,"click",l[3]),ae(v,"input",l[4])],y=!0)},p(D,[B]){B&1&&w!==(w="Ingresa "+D[0]+" actual")&&g(v,"placeholder",w),B&2&&g(v,"value",D[1])},i:Ce,o:Ce,d(D){D&&(a(e),a(b),a(p)),y=!1,Ge(R)}}}function Fn(l,e,t){const o=sn();let n=document.querySelector("ion-modal"),i=n.componentProps.data_type;n.componentProps.isLast;let d;rn.subscribe(f=>{i=f.flag[0],i=="km_final"||i=="km_inicial"?t(0,d="kilometraje"):t(0,d="litros de gasolina")});let _=0;function h(){at.dismiss()}function O(){o("modalResult",{data:"Your data",role:"confirm"}),i=="km_inicial"?Je.update(u=>({...u,km_inicial:[_]})):i=="gas_inicial"?Je.update(u=>({...u,gas_inicial:[_]})):i=="km_final"?Je.update(u=>({...u,km_final:[_]})):i=="gas_final"&&Je.update(u=>({...u,gas_final:[_]})),h()}return[d,_,h,O,f=>t(1,_=f.target.value)]}class qn extends $e{constructor(e){super(),et(this,e,Fn,Un,xe,{})}}const pt=Et({items:[],checkedIndices:[],mandatory:[]});function wt(l,e,t){const o=l.slice();return o[53]=e[t],o[54]=e,o[55]=t,o}function jn(l){let e,t,o,n,i,d="Kilometraje inicial",_,h,O=l[0]?l[0]+" km.":"Cargar km",I,f,u,b,p,m,v,w="Gasolina inicial (litros)",y,R,D=l[1]?l[1]+" litros":"Cargar gas",B,C,L,A;return C=It(l[21][0]),{c(){e=s("ion-item"),t=s("ion-label"),o=s("input"),n=N(),i=s("p"),i.textContent=d,_=N(),h=s("ion-button"),I=pe(O),f=N(),u=s("ion-item"),b=s("ion-label"),p=s("input"),m=N(),v=s("p"),v.textContent=w,y=N(),R=s("ion-button"),B=pe(D),this.h()},l(k){e=c(k,"ION-ITEM",{});var M=E(e);t=c(M,"ION-LABEL",{style:!0});var U=E(t);o=c(U,"INPUT",{id:!0,style:!0,type:!0}),n=T(U),i=c(U,"P",{style:!0,"data-svelte-h":!0}),Y(i)!=="svelte-88twxi"&&(i.textContent=d),U.forEach(a),_=T(M),h=c(M,"ION-BUTTON",{fill:!0,size:!0,class:!0,"aria-selected":!0});var P=E(h);I=me(P,O),P.forEach(a),M.forEach(a),f=T(k),u=c(k,"ION-ITEM",{});var j=E(u);b=c(j,"ION-LABEL",{style:!0});var V=E(b);p=c(V,"INPUT",{id:!0,style:!0,type:!0}),m=T(V),v=c(V,"P",{style:!0,"data-svelte-h":!0}),Y(v)!=="svelte-1ux30eb"&&(v.textContent=w),V.forEach(a),y=T(j),R=c(j,"ION-BUTTON",{fill:!0,class:!0,size:!0,style:!0});var G=E(R);B=me(G,D),G.forEach(a),j.forEach(a),this.h()},h(){x(o,"id","chkbox-km-ini"),q(o,"pointer-events","auto"),x(o,"type","checkbox"),o.required=!0,q(i,"margin-left","10px"),q(t,"display","flex"),g(h,"fill","outline"),g(h,"size","small"),g(h,"class","loadKmInicial"),g(h,"aria-selected",""),x(p,"id","chkbox-gas-ini"),q(p,"pointer-events","auto"),x(p,"type","checkbox"),p.required=!0,q(v,"margin-left","10px"),q(b,"display","flex"),g(R,"fill","outline"),g(R,"class","loadGasInicial"),g(R,"size","small"),q(R,"height","16px "),C.p(o,p)},m(k,M){H(k,e,M),r(e,t),r(t,o),o.checked=~(l[4]||[]).indexOf(o.__value),l[28](o),r(t,n),r(t,i),r(e,_),r(e,h),r(h,I),H(k,f,M),H(k,u,M),r(u,b),r(b,p),l[30](p),p.checked=~(l[4]||[]).indexOf(p.__value),r(b,m),r(b,v),r(u,y),r(u,R),r(R,B),L||(A=[ae(o,"change",l[27]),ae(h,"click",l[29]),ae(p,"change",l[31]),ae(R,"click",l[32])],L=!0)},p(k,M){M[0]&16&&(o.checked=~(k[4]||[]).indexOf(o.__value)),M[0]&1&&O!==(O=k[0]?k[0]+" km.":"Cargar km")&&De(I,O),M[0]&16&&(p.checked=~(k[4]||[]).indexOf(p.__value)),M[0]&2&&D!==(D=k[1]?k[1]+" litros":"Cargar gas")&&De(B,D)},d(k){k&&(a(e),a(f),a(u)),l[28](null),l[30](null),C.r(),L=!1,Ge(A)}}}function Vn(l){let e,t,o,n,i,d="Kilometraje final",_,h,O=l[2]?l[2]+" km.":"Cargar km",I,f,u,b,p,m,v,w="Gasolina final (litros)",y,R,D=l[3]?l[3]+" litros":"Cargar gas",B,C,L,A;return C=It(l[21][0]),{c(){e=s("ion-item"),t=s("ion-label"),o=s("input"),n=N(),i=s("p"),i.textContent=d,_=N(),h=s("ion-button"),I=pe(O),f=N(),u=s("ion-item"),b=s("ion-label"),p=s("input"),m=N(),v=s("p"),v.textContent=w,y=N(),R=s("ion-button"),B=pe(D),this.h()},l(k){e=c(k,"ION-ITEM",{});var M=E(e);t=c(M,"ION-LABEL",{style:!0});var U=E(t);o=c(U,"INPUT",{id:!0,style:!0,type:!0}),n=T(U),i=c(U,"P",{style:!0,"data-svelte-h":!0}),Y(i)!=="svelte-ccmu71"&&(i.textContent=d),U.forEach(a),_=T(M),h=c(M,"ION-BUTTON",{fill:!0,size:!0,class:!0,"aria-selected":!0});var P=E(h);I=me(P,O),P.forEach(a),M.forEach(a),f=T(k),u=c(k,"ION-ITEM",{});var j=E(u);b=c(j,"ION-LABEL",{style:!0});var V=E(b);p=c(V,"INPUT",{id:!0,style:!0,type:!0}),m=T(V),v=c(V,"P",{style:!0,"data-svelte-h":!0}),Y(v)!=="svelte-wsoyd2"&&(v.textContent=w),V.forEach(a),y=T(j),R=c(j,"ION-BUTTON",{fill:!0,size:!0,class:!0});var G=E(R);B=me(G,D),G.forEach(a),j.forEach(a),this.h()},h(){x(o,"id","chkbox-km-fin"),q(o,"pointer-events","auto"),x(o,"type","checkbox"),o.required=!0,q(i,"margin-left","10px"),q(t,"display","flex"),g(h,"fill","outline"),g(h,"size","small"),g(h,"class","loadKmInicial"),g(h,"aria-selected",""),x(p,"id","chkbox-gas-fin"),q(p,"pointer-events","auto"),x(p,"type","checkbox"),p.required=!0,q(v,"margin-left","10px"),q(b,"display","flex"),g(R,"fill","outline"),g(R,"size","small"),g(R,"class","loadGasInicial"),C.p(o,p)},m(k,M){H(k,e,M),r(e,t),r(t,o),o.checked=~(l[4]||[]).indexOf(o.__value),l[22](o),r(t,n),r(t,i),r(e,_),r(e,h),r(h,I),H(k,f,M),H(k,u,M),r(u,b),r(b,p),p.checked=~(l[4]||[]).indexOf(p.__value),l[25](p),r(b,m),r(b,v),r(u,y),r(u,R),r(R,B),L||(A=[ae(o,"change",l[20]),ae(h,"click",l[23]),ae(p,"change",l[24]),ae(R,"click",l[26])],L=!0)},p(k,M){M[0]&16&&(o.checked=~(k[4]||[]).indexOf(o.__value)),M[0]&4&&O!==(O=k[2]?k[2]+" km.":"Cargar km")&&De(I,O),M[0]&16&&(p.checked=~(k[4]||[]).indexOf(p.__value)),M[0]&8&&D!==(D=k[3]?k[3]+" litros":"Cargar gas")&&De(B,D)},d(k){k&&(a(e),a(f),a(u)),l[22](null),l[25](null),C.r(),L=!1,Ge(A)}}}function Gn(l){let e=[],t=new Map,o,n=je(l[13]);const i=d=>d[53].id_checklist_event;for(let d=0;d<n.length;d+=1){let _=wt(l,n,d),h=i(_);t.set(h,e[d]=Lt(h,_))}return{c(){for(let d=0;d<e.length;d+=1)e[d].c();o=Ue()},l(d){for(let _=0;_<e.length;_+=1)e[_].l(d);o=Ue()},m(d,_){for(let h=0;h<e.length;h+=1)e[h]&&e[h].m(d,_);H(d,o,_)},p(d,_){_[0]&407664&&(n=je(d[13]),e=lt(e,_,i,1,d,n,t,o.parentNode,rt,Lt,o,wt))},d(d){d&&a(o);for(let _=0;_<e.length;_+=1)e[_].d(d)}}}function Kn(l){let e,t=(l[12][l[53].id_checklist_event]?l[12][l[53].id_checklist_event]:"Cargar evidencia")+"",o;return{c(){e=s("label"),o=pe(t),this.h()},l(n){e=c(n,"LABEL",{for:!0,class:!0});var i=E(e);o=me(i,t),i.forEach(a),this.h()},h(){x(e,"for","chklist-"+l[53].id_checklist_event),x(e,"class","button-label svelte-1ruehls")},m(n,i){H(n,e,i),r(e,o)},p(n,i){i[0]&4096&&t!==(t=(n[12][n[53].id_checklist_event]?n[12][n[53].id_checklist_event]:"Cargar evidencia")+"")&&De(o,t)},d(n){n&&a(e)}}}function Wn(l){let e;return{c(){e=s("ion-spinner"),this.h()},l(t){e=c(t,"ION-SPINNER",{name:!0,class:!0}),E(e).forEach(a),this.h()},h(){g(e,"name","dots"),g(e,"class","button-spinner svelte-1ruehls")},m(t,o){H(t,e,o)},p:Ce,d(t){t&&a(e)}}}function Lt(l,e){let t,o,n,i=e[53],d,_,h=e[53].item+"",O,I,f,u=e[53].mandatory=="1"?" * ":"",b,p,m,v,w,y,R,D,B,C;const L=()=>e[34](n,i),A=()=>e[34](null,i);function k(){return e[35](e[53])}function M(V,G){return V[11][V[53].id_checklist_event]?Wn:Kn}let U=M(e),P=U(e);function j(...V){return e[37](e[53],...V)}return D=It(e[21][0]),{key:l,first:null,c(){t=s("ion-item"),o=s("ion-label"),n=s("input"),d=N(),_=s("p"),O=pe(h),I=N(),f=s("b"),b=pe(u),p=N(),m=s("ion-button"),v=s("div"),P.c(),w=N(),y=s("input"),R=N(),this.h()},l(V){t=c(V,"ION-ITEM",{});var G=E(t);o=c(G,"ION-LABEL",{style:!0});var oe=E(o);n=c(oe,"INPUT",{id:!0,style:!0,type:!0}),d=T(oe),_=c(oe,"P",{style:!0});var he=E(_);O=me(he,h),I=T(he),he.forEach(a),f=c(oe,"B",{style:!0});var ce=E(f);b=me(ce,u),ce.forEach(a),oe.forEach(a),p=T(G),m=c(G,"ION-BUTTON",{fill:!0,class:!0,size:!0});var be=E(m);v=c(be,"DIV",{class:!0});var Q=E(v);P.l(Q),w=T(Q),y=c(Q,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0}),Q.forEach(a),be.forEach(a),R=T(G),G.forEach(a),this.h()},h(){x(n,"id",`chkbox-${e[53].id_checklist_event}`),q(n,"pointer-events","auto"),x(n,"type","checkbox"),n.__value=e[53].id_checklist_event,cn(n,n.__value),n.required=!0,q(_,"margin-left","10px"),q(f,"margin-left","5px"),q(o,"display","flex"),q(y,"display","none"),x(y,"id","chklist-"+e[53].id_checklist_event),x(y,"name","fileToUpload"),x(y,"type","file"),x(y,"accept","image/*"),x(v,"class","button-content svelte-1ruehls"),g(m,"fill","outline"),g(m,"class","loadEvidence svelte-1ruehls"),g(m,"size","small"),D.p(n),this.first=t},m(V,G){H(V,t,G),r(t,o),r(o,n),n.checked=~(e[4]||[]).indexOf(n.__value),L(),r(o,d),r(o,_),r(_,O),r(_,I),r(o,f),r(f,b),r(t,p),r(t,m),r(m,v),P.m(v,null),r(v,w),r(v,y),e[36](y),r(t,R),B||(C=[ae(n,"change",e[33]),ae(n,"change",k),ae(y,"change",j)],B=!0)},p(V,G){e=V,G[0]&16&&(n.checked=~(e[4]||[]).indexOf(n.__value)),i!==e[53]&&(A(),i=e[53],L()),U===(U=M(e))&&P?P.p(e,G):(P.d(1),P=U(e),P&&(P.c(),P.m(v,w)))},d(V){V&&a(t),A(),P.d(),e[36](null),D.r(),B=!1,Ge(C)}}}function Xn(l){let e,t,o,n,i="Cancelar",d,_,h="REQUERIMIENTOS DE RUTA",O,I,f,u,b,p,m,v="Confirmar",w,y;function R(L,A){return L[14]?Vn:jn}let B=R(l)(l),C=l[13]&&Gn(l);return{c(){e=s("ion-header"),t=s("ion-toolbar"),o=s("ion-buttons"),n=s("ion-button"),n.textContent=i,d=N(),_=s("ion-title"),_.textContent=h,O=N(),I=s("ion-content"),f=s("ion-list"),B.c(),u=N(),C&&C.c(),b=N(),p=s("ion-footer"),m=s("ion-button"),m.textContent=v,this.h()},l(L){e=c(L,"ION-HEADER",{translucent:!0});var A=E(e);t=c(A,"ION-TOOLBAR",{});var k=E(t);o=c(k,"ION-BUTTONS",{slot:!0});var M=E(o);n=c(M,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),Y(n)!=="svelte-1dnmkxs"&&(n.textContent=i),M.forEach(a),d=T(k),_=c(k,"ION-TITLE",{"data-svelte-h":!0}),Y(_)!=="svelte-19bar5p"&&(_.textContent=h),k.forEach(a),A.forEach(a),O=T(L),I=c(L,"ION-CONTENT",{fullscreen:!0});var U=E(I);f=c(U,"ION-LIST",{});var P=E(f);B.l(P),u=T(P),C&&C.l(P),P.forEach(a),U.forEach(a),b=T(L),p=c(L,"ION-FOOTER",{});var j=E(p);m=c(j,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),Y(m)!=="svelte-g82qqw"&&(m.textContent=v),j.forEach(a),this.h()},h(){g(n,"color","medium"),g(o,"slot","start"),g(e,"translucent",""),g(I,"fullscreen",""),g(m,"fill","outline"),g(m,"color","tertiary"),g(m,"strong",""),q(m,"width","99%"),q(m,"height","auto")},m(L,A){H(L,e,A),r(e,t),r(t,o),r(o,n),r(t,d),r(t,_),H(L,O,A),H(L,I,A),r(I,f),B.m(f,null),r(f,u),C&&C.m(f,null),H(L,b,A),H(L,p,A),r(p,m),w||(y=[ae(n,"click",l[15]),ae(m,"click",l[16])],w=!0)},p(L,A){B.p(L,A),L[13]&&C.p(L,A)},i:Ce,o:Ce,d(L){L&&(a(e),a(O),a(I),a(b),a(p)),B.d(),C&&C.d(),w=!1,Ge(y)}}}function gt(l,e){if(typeof l=="object"&&l!==null||Array.isArray(l)){if(Array.isArray(l))return l.map(t=>gt(t,e)).flat();{const t=Object.keys(l);let o;return e=="id_checklist_event"?o=t.filter(i=>i.toLowerCase().includes("id_checklist_event")).map(i=>l[i]):e=="mandatory"?o=t.filter(i=>i.toLowerCase().includes("mandatory")).map(i=>l[i]):(console.error("Tipo de dato no reconocido."),o=!1),o}}else return console.error("Invalid input. Please provide a valid object or array."),[]}function Jn(l,e,t){let o=ht,n=document.querySelector("ion-modal");const i=n.componentProps.checklist,d=n.componentProps.driverId,_=n.componentProps.routeId,h=n.componentProps.isLast;let O,I,f,u,b=[],p=null,m={},v,w,y,R,D={},B={},C={};it(()=>{h?console.log("Último checklist"):pt.update(z=>(z.mandatory=gt(i,"mandatory"),z.items=gt(i,"id_checklist_event"),z))});function L(z){t(11,D[z]=!0,D)}const A=async()=>{await(await Qe.create({header:"Datos o checklist incompletos",message:"Carga la evidencia requerida y marca todas las casillas para confirmar",buttons:[{text:"Cerrar"}]})).present()},k=async()=>{await(await Qe.create({header:"Datos capturados",message:"El kilometraje y gasolina final fueron registrados correctamente, espere aprobación para finalizar ruta",buttons:[{text:"Cerrar"}]})).present()},M=async z=>{await(await Qe.create({header:"Datos inválidos",message:z=="km"?"Llena correctamente el campo de kilometraje inicial":"Llena correctamente el campo de gasolina inicial",buttons:[{text:"Cerrar"}]})).present()},U=()=>{at.dismiss(),d?We(`/drivers/${d}`):We("/drivers/me")},P=()=>{if(h){var z=he(f,"km"),$=he(u,"gas");const le=new FormData;le.append("km_final",z),le.append("gas_final",$),le.append("id_route",_),z&&$?(U(),fetch(`${o}api/admin/checklist/add_evidence.php`,{method:"POST",body:le}).then(re=>re.json()).then(re=>{k()}).catch(re=>{console.error("Error fetching data:",re)})):A()}else{var Te=he(O,"km"),ne=he(I,"gas");pt.update(le=>{le.items;const re=le.mandatory;if(le.items.filter((ue,ee)=>le.mandatory[ee]==="1").every(ue=>le.checkedIndices.includes(ue))&&Te&&ne){U();const ue=new FormData;for(const ee in B)if(B.hasOwnProperty(ee)){const{img:Le,img_id:Ne}=B[ee];ue.append(`selectedImages[${ee}][img]`,Le),ue.append(`selectedImages[${ee}][img_id]`,Ne)}ue.append("km_inicial",Te),ue.append("gas_inicial",ne),ue.append("id_route",_),fetch(`${o}api/admin/checklist/add_evidence.php`,{method:"POST",body:ue}).then(ee=>ee.json()).then(ee=>{re&&re.some(Le=>Le==="1")?oe(_,"checklist-pending"):oe(_,"enroute")}).catch(ee=>{console.error("Error fetching data:",ee)})}else if(!re&&Te&&ne){var Ee=new FormData;Ee.append("km_inicial",Te),Ee.append("gas_inicial",ne),fetch(`${o}api/admin/checklist/add_evidence.php`,{method:"POST",body:Ee}).then(ue=>ue.json()).then(ue=>{oe(_,"enroute")}).catch(ue=>{console.error("Error fetching data:",ue)})}else A();return le})}ie()},j=async(z,$)=>{L($);const ne=z.target.files[0],le=await V(ne);if(le){const re=new FormData;re.append("fileToUpload",le);try{const _e=await fetch(`${o}api/admin/manager/upload_img_driver.php`,{method:"POST",body:re});if(_e.ok){const de=await _e.json();B={...B,[$]:{img:de.img,img_id:de.img_id}},t(12,C={...C,[$]:de.filename}),G($),t(6,m[$].checked=!0,m),t(11,D[$]=!1,D)}else console.error("File upload failed:",_e.statusText)}catch(_e){console.error("Error during file upload:",_e)}}},V=async z=>new Promise($=>{const Te=new FileReader;Te.onload=ne=>{const le=new Image;le.src=ne.target.result,le.onload=()=>{const re=document.createElement("canvas"),_e=re.getContext("2d"),de=800,Ee=600;let ue=le.width,ee=le.height;ue>de&&(ee*=de/ue,ue=de),ee>Ee&&(ue*=Ee/ee,ee=Ee),re.width=ue,re.height=ee,_e.drawImage(le,0,0,ue,ee),re.toBlob(Le=>{$(Le)},"image/jpeg",.7)}},Te.readAsDataURL(z)}),G=z=>{pt.update($=>($.checkedIndices.indexOf(z)===-1?$.checkedIndices.push(z):console.error(`ID ${z} is already checked.`),$.items.forEach(ne=>{ne.id_checklist_event===z&&(ne.checked=!0)}),$))};function oe(z,$){let Te=new FormData;Te.append("id_route",z),Te.append("status",$),fetch(`${o}api/admin/route/change_status.php`,{method:"POST",body:Te}).then(ne=>ne.json()).then(ne=>{}).catch(ne=>{console.error("Error fetching data:",ne)})}function he(z,$){return/^\d+$/.test(z)?parseInt(z,10):(M($),null)}function ce(z,$){be($),n.componentProps.data_type=$,Ke("modal-gas-km",qn,{r:$}).then(()=>{Je.subscribe(Te=>{Q(Te,$)})})}function be(z){rn.update($=>({...$,flag:[z]}))}function Q(z,$){t(0,O=z.km_inicial?z.km_inicial:null),t(1,I=z.gas_inicial?z.gas_inicial:null),t(2,f=z.km_final?z.km_final:null),t(3,u=z.gas_final?z.gas_final:null),$=="km_inicial"&&v&&t(7,v.checked=!0,v),$=="gas_inicial"&&w&&t(8,w.checked=!0,w),$=="km_final"&&y&&t(9,y.checked=!0,y),$=="gas_final"&&R&&t(10,R.checked=!0,R)}function ie(){Je.set({km_inicial:[],gas_inicial:[],km_final:[],gas_final:[]})}const X=[[]];function S(){b=ot(X[0],this.__value,this.checked),t(4,b)}function K(z){He[z?"unshift":"push"](()=>{y=z,t(9,y)})}const F=z=>ce(z,"km_final");function J(){b=ot(X[0],this.__value,this.checked),t(4,b)}function se(z){He[z?"unshift":"push"](()=>{R=z,t(10,R)})}const W=z=>ce(z,"gas_final");function te(){b=ot(X[0],this.__value,this.checked),t(4,b)}function fe(z){He[z?"unshift":"push"](()=>{v=z,t(7,v)})}const we=z=>ce(z,"km_inicial");function ke(z){He[z?"unshift":"push"](()=>{w=z,t(8,w)})}function ve(){b=ot(X[0],this.__value,this.checked),t(4,b)}const Be=z=>ce(z,"gas_inicial");function ze(){b=ot(X[0],this.__value,this.checked),t(4,b)}function qe(z,$){He[z?"unshift":"push"](()=>{m[$.id_checklist_event]=z,t(6,m)})}const Fe=z=>G(z.id_checklist_event);function Pe(z){He[z?"unshift":"push"](()=>{p=z,t(5,p)})}return[O,I,f,u,b,p,m,v,w,y,R,D,C,i,h,U,P,j,G,ce,S,X,K,F,J,se,W,te,fe,we,ke,ve,Be,ze,qe,Fe,Pe,(z,$)=>j($,z.id_checklist_event)]}class an extends $e{constructor(e){super(),et(this,e,Jn,Xn,xe,{},null,[-1,-1])}}function Qn(l){let e,t,o,n,i,d="Teléfono de Negocio",_,h,O=l[10].client_phone+"",I;return{c(){e=s("ion-item"),t=s("ion-icon"),o=N(),n=s("ion-label"),i=s("p"),i.textContent=d,_=N(),h=s("h2"),I=pe(O),this.h()},l(f){e=c(f,"ION-ITEM",{href:!0});var u=E(e);t=c(u,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(a),o=T(u),n=c(u,"ION-LABEL",{class:!0});var b=E(n);i=c(b,"P",{"data-svelte-h":!0}),Y(i)!=="svelte-1u5l7fz"&&(i.textContent=d),_=T(b),h=c(b,"H2",{});var p=E(h);I=me(p,O),p.forEach(a),b.forEach(a),u.forEach(a),this.h()},h(){g(t,"icon",En),g(t,"slot","start"),g(n,"class","ion-text-wrap"),g(e,"href","tel:"+l[10].client_phone)},m(f,u){H(f,e,u),r(e,t),r(e,o),r(e,n),r(n,i),r(n,_),r(n,h),r(h,I)},p:Ce,d(f){f&&a(e)}}}function Yn(l){let e,t,o,n,i,d="Domicilio Alternativo",_,h,O=l[10].line2+"",I,f,u;return{c(){e=s("ion-item"),t=s("ion-icon"),o=N(),n=s("ion-label"),i=s("p"),i.textContent=d,_=N(),h=s("h2"),I=pe(O),f=N(),u=s("ion-icon"),this.h()},l(b){e=c(b,"ION-ITEM",{href:!0});var p=E(e);t=c(p,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(a),o=T(p),n=c(p,"ION-LABEL",{class:!0});var m=E(n);i=c(m,"P",{"data-svelte-h":!0}),Y(i)!=="svelte-1ub9uzw"&&(i.textContent=d),_=T(m),h=c(m,"H2",{});var v=E(h);I=me(v,O),v.forEach(a),m.forEach(a),f=T(p),u=c(p,"ION-ICON",{icon:!0,slot:!0}),E(u).forEach(a),p.forEach(a),this.h()},h(){g(t,"icon",kt),g(t,"slot","start"),g(n,"class","ion-text-wrap"),g(u,"icon",tt),g(u,"slot","end"),g(e,"href","https://www.google.com/maps/searhc/?api=1&query="+l[10].line2)},m(b,p){H(b,e,p),r(e,t),r(e,o),r(e,n),r(n,i),r(n,_),r(n,h),r(h,I),r(e,f),r(e,u)},p:Ce,d(b){b&&a(e)}}}function Zn(l){let e,t,o,n,i,d="Domicilio",_,h,O=l[10].line1+"",I,f,u,b,p=l[10].line2&&l[10].line2.trim().length,m,v=p&&xn(l);return{c(){e=s("ion-item"),t=s("ion-icon"),o=N(),n=s("ion-label"),i=s("p"),i.textContent=d,_=N(),h=s("h2"),I=pe(O),f=N(),u=s("ion-icon"),b=N(),v&&v.c(),m=Ue(),this.h()},l(w){e=c(w,"ION-ITEM",{href:!0});var y=E(e);t=c(y,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(a),o=T(y),n=c(y,"ION-LABEL",{class:!0});var R=E(n);i=c(R,"P",{"data-svelte-h":!0}),Y(i)!=="svelte-cbm7q1"&&(i.textContent=d),_=T(R),h=c(R,"H2",{});var D=E(h);I=me(D,O),D.forEach(a),R.forEach(a),f=T(y),u=c(y,"ION-ICON",{icon:!0,slot:!0}),E(u).forEach(a),y.forEach(a),b=T(w),v&&v.l(w),m=Ue(),this.h()},h(){g(t,"icon",kt),g(t,"slot","start"),g(n,"class","ion-text-wrap"),g(u,"icon",tt),g(u,"slot","end"),g(e,"href","https://www.google.com/maps/search/?api=1&query="+l[10].line1)},m(w,y){H(w,e,y),r(e,t),r(e,o),r(e,n),r(n,i),r(n,_),r(n,h),r(h,I),r(e,f),r(e,u),H(w,b,y),v&&v.m(w,y),H(w,m,y)},p(w,y){p&&v.p(w,y)},d(w){w&&(a(e),a(b),a(m)),v&&v.d(w)}}}function xn(l){let e,t,o,n,i,d="Domicilio Alternativo",_,h,O=l[10].line2+"",I,f,u;return{c(){e=s("ion-item"),t=s("ion-icon"),o=N(),n=s("ion-label"),i=s("p"),i.textContent=d,_=N(),h=s("h2"),I=pe(O),f=N(),u=s("ion-icon"),this.h()},l(b){e=c(b,"ION-ITEM",{href:!0});var p=E(e);t=c(p,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(a),o=T(p),n=c(p,"ION-LABEL",{class:!0});var m=E(n);i=c(m,"P",{"data-svelte-h":!0}),Y(i)!=="svelte-1ub9uzw"&&(i.textContent=d),_=T(m),h=c(m,"H2",{});var v=E(h);I=me(v,O),v.forEach(a),m.forEach(a),f=T(p),u=c(p,"ION-ICON",{icon:!0,slot:!0}),E(u).forEach(a),p.forEach(a),this.h()},h(){g(t,"icon",kt),g(t,"slot","start"),g(n,"class","ion-text-wrap"),g(u,"icon",tt),g(u,"slot","end"),g(e,"href","https://www.google.com/maps/search/?api=1&query="+l[10].line2)},m(b,p){H(b,e,p),r(e,t),r(e,o),r(e,n),r(n,i),r(n,_),r(n,h),r(h,I),r(e,f),r(e,u)},p:Ce,d(b){b&&a(e)}}}function St(l){let e,t,o,n,i,d="Contacto del Cliente",_,h,O,I,f=l[2]&&l[2]==="1"&&Mt(l);return{c(){e=s("ion-item"),t=s("ion-icon"),o=N(),n=s("ion-label"),i=s("p"),i.textContent=d,_=N(),h=s("h2"),O=pe(l[6]),I=N(),f&&f.c(),this.h()},l(u){e=c(u,"ION-ITEM",{});var b=E(e);t=c(b,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(a),o=T(b),n=c(b,"ION-LABEL",{class:!0});var p=E(n);i=c(p,"P",{"data-svelte-h":!0}),Y(i)!=="svelte-1utsyb6"&&(i.textContent=d),_=T(p),h=c(p,"H2",{});var m=E(h);O=me(m,l[6]),m.forEach(a),p.forEach(a),I=T(b),f&&f.l(b),b.forEach(a),this.h()},h(){g(t,"icon",In),g(t,"slot","start"),g(n,"class","ion-text-wrap")},m(u,b){H(u,e,b),r(e,t),r(e,o),r(e,n),r(n,i),r(n,_),r(n,h),r(h,O),r(e,I),f&&f.m(e,null)},p(u,b){b[0]&64&&De(O,u[6]),u[2]&&u[2]==="1"?f?f.p(u,b):(f=Mt(u),f.c(),f.m(e,null)):f&&(f.d(1),f=null)},d(u){u&&a(e),f&&f.d()}}}function Mt(l){let e,t=`<ion-icon icon="${Tn}" slot="start"></ion-icon>
                        Notificar Cliente`,o,n;return{c(){e=s("ion-button"),e.innerHTML=t,this.h()},l(i){e=c(i,"ION-BUTTON",{fill:!0,style:!0,"data-svelte-h":!0}),Y(e)!=="svelte-w3qtwm"&&(e.innerHTML=t),this.h()},h(){g(e,"fill","outline"),q(e,"margin-left","16px")},m(i,d){H(i,e,d),o||(n=ae(e,"click",l[14]),o=!0)},p:Ce,d(i){i&&a(e),o=!1,n()}}}function Pt(l){let e,t,o,n,i,d="Notas de ubicación",_,h,O;return{c(){e=s("ion-item"),t=s("ion-icon"),o=N(),n=s("ion-label"),i=s("p"),i.textContent=d,_=N(),h=s("h2"),O=pe(l[7]),this.h()},l(I){e=c(I,"ION-ITEM",{});var f=E(e);t=c(f,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(a),o=T(f),n=c(f,"ION-LABEL",{class:!0});var u=E(n);i=c(u,"P",{"data-svelte-h":!0}),Y(i)!=="svelte-nhm2ft"&&(i.textContent=d),_=T(u),h=c(u,"H2",{});var b=E(h);O=me(b,l[7]),b.forEach(a),u.forEach(a),f.forEach(a),this.h()},h(){g(t,"icon",on),g(t,"slot","start"),g(n,"class","ion-text-wrap")},m(I,f){H(I,e,f),r(e,t),r(e,o),r(e,n),r(n,i),r(n,_),r(n,h),r(h,O)},p(I,f){f[0]&128&&De(O,I[7])},d(I){I&&a(e)}}}function $n(l){let e,t,o,n,i,d="Horarios",_,h,O=l[10].schedule+"",I;return{c(){e=s("ion-item"),t=s("ion-icon"),o=N(),n=s("ion-label"),i=s("p"),i.textContent=d,_=N(),h=s("h2"),I=pe(O),this.h()},l(f){e=c(f,"ION-ITEM",{});var u=E(e);t=c(u,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(a),o=T(u),n=c(u,"ION-LABEL",{});var b=E(n);i=c(b,"P",{"data-svelte-h":!0}),Y(i)!=="svelte-11q7hm5"&&(i.textContent=d),_=T(b),h=c(b,"H2",{});var p=E(h);I=me(p,O),p.forEach(a),b.forEach(a),u.forEach(a),this.h()},h(){g(t,"icon",kn),g(t,"slot","start")},m(f,u){H(f,e,u),r(e,t),r(e,o),r(e,n),r(n,i),r(n,_),r(n,h),r(h,I)},p:Ce,d(f){f&&a(e)}}}function eo(l){let e,t,o,n,i,d="Notas del operador",_,h,O=l[10].driver_comments+"",I;return{c(){e=s("ion-item"),t=s("ion-icon"),o=N(),n=s("ion-label"),i=s("p"),i.textContent=d,_=N(),h=s("h2"),I=pe(O),this.h()},l(f){e=c(f,"ION-ITEM",{});var u=E(e);t=c(u,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(a),o=T(u),n=c(u,"ION-LABEL",{});var b=E(n);i=c(b,"P",{"data-svelte-h":!0}),Y(i)!=="svelte-1yk9qp4"&&(i.textContent=d),_=T(b),h=c(b,"H2",{});var p=E(h);I=me(p,O),p.forEach(a),b.forEach(a),u.forEach(a),this.h()},h(){g(t,"icon",ln),g(t,"slot","start")},m(f,u){H(f,e,u),r(e,t),r(e,o),r(e,n),r(n,i),r(n,_),r(n,h),r(h,I)},p:Ce,d(f){f&&a(e)}}}function to(l){let e,t=l[10].logistic_comments!="<br>"&&no(l);return{c(){t&&t.c(),e=Ue()},l(o){t&&t.l(o),e=Ue()},m(o,n){t&&t.m(o,n),H(o,e,n)},p(o,n){o[10].logistic_comments!="<br>"&&t.p(o,n)},d(o){o&&a(e),t&&t.d(o)}}}function no(l){let e,t,o,n,i,d="Comentarios logísticos",_,h,O=l[10].logistic_comments+"",I;return{c(){e=s("ion-item"),t=s("ion-icon"),o=N(),n=s("ion-label"),i=s("p"),i.textContent=d,_=N(),h=s("h2"),I=pe(O),this.h()},l(f){e=c(f,"ION-ITEM",{});var u=E(e);t=c(u,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(a),o=T(u),n=c(u,"ION-LABEL",{class:!0});var b=E(n);i=c(b,"P",{"data-svelte-h":!0}),Y(i)!=="svelte-1iz85r6"&&(i.textContent=d),_=T(b),h=c(b,"H2",{});var p=E(h);I=me(p,O),p.forEach(a),b.forEach(a),u.forEach(a),this.h()},h(){g(t,"icon",on),g(t,"slot","start"),g(n,"class","ion-text-wrap")},m(f,u){H(f,e,u),r(e,t),r(e,o),r(e,n),r(n,i),r(n,_),r(n,h),r(h,I)},p:Ce,d(f){f&&a(e)}}}function At(l){let e,t,o,n;return{c(){e=s("ion-item"),t=s("ion-icon"),o=N(),n=s("ion-textarea"),this.h()},l(i){e=c(i,"ION-ITEM",{});var d=E(e);t=c(d,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(a),o=T(d),n=c(d,"ION-TEXTAREA",{placeholder:!0}),E(n).forEach(a),d.forEach(a),this.h()},h(){g(t,"icon",On),g(t,"slot","start"),g(n,"placeholder","Escribe el motivo...")},m(i,d){H(i,e,d),r(e,t),r(e,o),r(e,n),l[17](n)},p:Ce,d(i){i&&a(e),l[17](null)}}}function Dt(l){let e,t=`<ion-icon icon="${Cn}" slot="start"></ion-icon>
                    Ingreso`,o,n;return{c(){e=s("ion-button"),e.innerHTML=t,this.h()},l(i){e=c(i,"ION-BUTTON",{id:!0,style:!0,"data-svelte-h":!0}),Y(e)!=="svelte-151bg1z"&&(e.innerHTML=t),this.h()},h(){g(e,"id","checkInBtn"),q(e,"flex","1")},m(i,d){H(i,e,d),o||(n=ae(e,"click",l[15]),o=!0)},p:Ce,d(i){i&&a(e),o=!1,n()}}}function Bt(l){let e,t,o,n,i,d;return{c(){e=s("ion-button"),t=s("ion-icon"),o=pe(`
                    Salida`),this.h()},l(_){e=c(_,"ION-BUTTON",{id:!0,style:!0,disabled:!0});var h=E(e);t=c(h,"ION-ICON",{icon:!0,slot:!0}),E(t).forEach(a),o=me(h,`
                    Salida`),h.forEach(a),this.h()},h(){g(t,"icon",Nn),g(t,"slot","start"),g(e,"id","checkOutBtn"),q(e,"flex","1"),g(e,"disabled",n=l[5]===!1)},m(_,h){H(_,e,h),r(e,t),r(e,o),i||(d=ae(e,"click",l[16]),i=!0)},p(_,h){h[0]&32&&n!==(n=_[5]===!1)&&g(e,"disabled",n)},d(_){_&&a(e),i=!1,d()}}}function zt(l){let e,t='<ion-spinner name="dots"></ion-spinner>';return{c(){e=s("section"),e.innerHTML=t,this.h()},l(o){e=c(o,"SECTION",{style:!0,"data-svelte-h":!0}),Y(e)!=="svelte-1sj3e0"&&(e.innerHTML=t),this.h()},h(){q(e,"text-align","center")},m(o,n){H(o,e,n)},d(o){o&&a(e)}}}function Ht(l){let e,t,o;return{c(){e=s("section"),t=s("ion-img"),this.h()},l(n){e=c(n,"SECTION",{});var i=E(e);t=c(i,"ION-IMG",{src:!0,alt:!0,style:!0}),E(t).forEach(a),i.forEach(a),this.h()},h(){dt(t.src,o=l[1])||g(t,"src",o),g(t,"alt","Evidencia fotográfica"),q(t,"max-width","100%"),q(t,"margin-top","16px")},m(n,i){H(n,e,i),r(e,t)},p(n,i){i[0]&2&&!dt(t.src,o=n[1])&&g(t,"src",o)},d(n){n&&a(e)}}}function oo(l){let e,t,o,n,i="Cancelar",d,_,h=l[10].title+"",O,I,f,u,b="Confirmar",p,m,v,w,y,R,D,B,C="Negocio",L,A,k=l[10].client_name+"",M,U,P=l[10].client_phone&&l[10].client_phone.trim().length,j,V,G,oe,he=l[10].schedule&&l[10].schedule.trim().length,ce,be,Q=l[10].logistic_comments&&l[10].logistic_comments.trim().length,ie,X,S,K,F,J,se,W,te,fe,we,ke,ve,Be,ze,qe="Subir Evidencia",Fe,Pe,Ae,z,$,Te,ne=P&&Qn(l);function le(Z,Oe){if(Z[10].line1&&Z[10].line1.trim().length)return Zn;if(Z[10].line2&&Z[10].line2.trim().length)return Yn}let re=le(l),_e=re&&re(l),de=l[6]&&St(l),Ee=l[7]&&l[7]!=="<br>"&&Pt(l),ue=he&&$n(l),ee=l[10].driver_comments&&eo(l),Le=Q&&to(l),Ne=l[8]&&At(l),ye=l[4]===!0&&Dt(l),Ie=(l[5]===!0||l[5]===!1&&l[4]===!1)&&Bt(l),Se=l[3]&&zt(),Me=l[1]&&Ht(l);return{c(){e=s("ion-header"),t=s("ion-toolbar"),o=s("ion-buttons"),n=s("ion-button"),n.textContent=i,d=N(),_=s("ion-title"),O=pe(h),I=N(),f=s("ion-buttons"),u=s("ion-button"),u.textContent=b,p=N(),m=s("ion-content"),v=s("ion-list"),w=s("ion-item"),y=s("ion-icon"),R=N(),D=s("ion-label"),B=s("p"),B.textContent=C,L=N(),A=s("h2"),M=pe(k),U=N(),ne&&ne.c(),j=N(),_e&&_e.c(),V=N(),de&&de.c(),G=N(),Ee&&Ee.c(),oe=N(),ue&&ue.c(),ce=N(),ee&&ee.c(),be=N(),Le&&Le.c(),ie=N(),Ne&&Ne.c(),X=N(),S=s("ion-item"),K=s("ion-icon"),F=N(),J=s("ion-textarea"),se=N(),W=s("section"),ye&&ye.c(),te=N(),Ie&&Ie.c(),fe=N(),we=s("section"),ke=s("ion-button"),ve=s("ion-icon"),Be=N(),ze=s("label"),ze.textContent=qe,Fe=N(),Pe=s("input"),Ae=N(),Se&&Se.c(),z=N(),Me&&Me.c(),this.h()},l(Z){e=c(Z,"ION-HEADER",{translucent:!0});var Oe=E(e);t=c(Oe,"ION-TOOLBAR",{});var Ve=E(t);o=c(Ve,"ION-BUTTONS",{slot:!0});var nt=E(o);n=c(nt,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),Y(n)!=="svelte-1f8rjcf"&&(n.textContent=i),nt.forEach(a),d=T(Ve),_=c(Ve,"ION-TITLE",{style:!0,title:!0});var Ot=E(_);O=me(Ot,h),Ot.forEach(a),I=T(Ve),f=c(Ve,"ION-BUTTONS",{slot:!0});var Nt=E(f);u=c(Nt,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),Y(u)!=="svelte-1ida0il"&&(u.textContent=b),Nt.forEach(a),Ve.forEach(a),Oe.forEach(a),p=T(Z),m=c(Z,"ION-CONTENT",{fullscreen:!0});var Tt=E(m);v=c(Tt,"ION-LIST",{});var ge=E(v);w=c(ge,"ION-ITEM",{});var st=E(w);y=c(st,"ION-ICON",{icon:!0,slot:!0}),E(y).forEach(a),R=T(st),D=c(st,"ION-LABEL",{});var ct=E(D);B=c(ct,"P",{"data-svelte-h":!0}),Y(B)!=="svelte-57b1dg"&&(B.textContent=C),L=T(ct),A=c(ct,"H2",{});var Ct=E(A);M=me(Ct,k),Ct.forEach(a),ct.forEach(a),st.forEach(a),U=T(ge),ne&&ne.l(ge),j=T(ge),_e&&_e.l(ge),V=T(ge),de&&de.l(ge),G=T(ge),Ee&&Ee.l(ge),oe=T(ge),ue&&ue.l(ge),ce=T(ge),ee&&ee.l(ge),be=T(ge),Le&&Le.l(ge),ie=T(ge),Ne&&Ne.l(ge),X=T(ge),S=c(ge,"ION-ITEM",{});var ut=E(S);K=c(ut,"ION-ICON",{icon:!0,slot:!0}),E(K).forEach(a),F=T(ut),J=c(ut,"ION-TEXTAREA",{label:!0,placeholder:!0}),E(J).forEach(a),ut.forEach(a),se=T(ge),W=c(ge,"SECTION",{style:!0});var ft=E(W);ye&&ye.l(ft),te=T(ft),Ie&&Ie.l(ft),ft.forEach(a),fe=T(ge),we=c(ge,"SECTION",{style:!0});var yt=E(we);ke=c(yt,"ION-BUTTON",{fill:!0,class:!0,style:!0});var Xe=E(ke);ve=c(Xe,"ION-ICON",{icon:!0,slot:!0}),E(ve).forEach(a),Be=T(Xe),ze=c(Xe,"LABEL",{for:!0,"data-svelte-h":!0}),Y(ze)!=="svelte-7lscau"&&(ze.textContent=qe),Fe=T(Xe),Pe=c(Xe,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0}),Xe.forEach(a),yt.forEach(a),Ae=T(ge),Se&&Se.l(ge),z=T(ge),Me&&Me.l(ge),ge.forEach(a),Tt.forEach(a),this.h()},h(){g(n,"color","medium"),g(o,"slot","start"),q(_,"text-align","center"),g(_,"title",l[10].title),g(u,"strong",""),g(f,"slot","end"),g(e,"translucent",""),g(y,"icon",bn),g(y,"slot","start"),g(K,"icon",vt),g(K,"slot","start"),g(J,"label","Notas"),g(J,"placeholder","Escribe aquí..."),q(W,"display","flex"),q(W,"gap","8px"),q(W,"padding","16px 16px 6px"),g(ve,"icon",nn),g(ve,"slot","start"),x(ze,"for","eventEvidence"),q(Pe,"display","none"),x(Pe,"id","eventEvidence"),x(Pe,"name","fileToUpload"),x(Pe,"type","file"),x(Pe,"accept","image/*"),g(ke,"fill","outline"),g(ke,"class","loadEvidence"),q(ke,"flex","1"),q(we,"display","flex"),q(we,"gap","8px"),q(we,"padding","0px 16px"),g(m,"fullscreen","")},m(Z,Oe){H(Z,e,Oe),r(e,t),r(t,o),r(o,n),r(t,d),r(t,_),r(_,O),r(t,I),r(t,f),r(f,u),H(Z,p,Oe),H(Z,m,Oe),r(m,v),r(v,w),r(w,y),r(w,R),r(w,D),r(D,B),r(D,L),r(D,A),r(A,M),r(v,U),ne&&ne.m(v,null),r(v,j),_e&&_e.m(v,null),r(v,V),de&&de.m(v,null),r(v,G),Ee&&Ee.m(v,null),r(v,oe),ue&&ue.m(v,null),r(v,ce),ee&&ee.m(v,null),r(v,be),Le&&Le.m(v,null),r(v,ie),Ne&&Ne.m(v,null),r(v,X),r(v,S),r(S,K),r(S,F),r(S,J),l[18](J),r(v,se),r(v,W),ye&&ye.m(W,null),r(W,te),Ie&&Ie.m(W,null),r(v,fe),r(v,we),r(we,ke),r(ke,ve),r(ke,Be),r(ke,ze),r(ke,Fe),r(ke,Pe),r(v,Ae),Se&&Se.m(v,null),r(v,z),Me&&Me.m(v,null),$||(Te=[ae(n,"click",l[12]),ae(u,"click",l[13]),ae(Pe,"change",l[11])],$=!0)},p(Z,Oe){P&&ne.p(Z,Oe),_e&&_e.p(Z,Oe),Z[6]?de?de.p(Z,Oe):(de=St(Z),de.c(),de.m(v,G)):de&&(de.d(1),de=null),Z[7]&&Z[7]!=="<br>"?Ee?Ee.p(Z,Oe):(Ee=Pt(Z),Ee.c(),Ee.m(v,oe)):Ee&&(Ee.d(1),Ee=null),he&&ue.p(Z,Oe),Z[10].driver_comments&&ee.p(Z,Oe),Q&&Le.p(Z,Oe),Z[8]?Ne?Ne.p(Z,Oe):(Ne=At(Z),Ne.c(),Ne.m(v,X)):Ne&&(Ne.d(1),Ne=null),Z[4]===!0?ye?ye.p(Z,Oe):(ye=Dt(Z),ye.c(),ye.m(W,te)):ye&&(ye.d(1),ye=null),Z[5]===!0||Z[5]===!1&&Z[4]===!1?Ie?Ie.p(Z,Oe):(Ie=Bt(Z),Ie.c(),Ie.m(W,null)):Ie&&(Ie.d(1),Ie=null),Z[3]?Se||(Se=zt(),Se.c(),Se.m(v,z)):Se&&(Se.d(1),Se=null),Z[1]?Me?Me.p(Z,Oe):(Me=Ht(Z),Me.c(),Me.m(v,null)):Me&&(Me.d(1),Me=null)},i:Ce,o:Ce,d(Z){Z&&(a(e),a(p),a(m)),ne&&ne.d(),_e&&_e.d(),de&&de.d(),Ee&&Ee.d(),ue&&ue.d(),ee&&ee.d(),Le&&Le.d(),Ne&&Ne.d(),l[18](null),ye&&ye.d(),Ie&&Ie.d(),Se&&Se.d(),Me&&Me.d(),$=!1,Ge(Te)}}}const Rt=/Teléfono:\s*(\d{10,})/;function Ut(l,e){for(let t=0;t<e.length;t++)if(e[t].alias===l)return e[t].val;return""}function io(l,e,t){let o=ht,n=document.querySelector("ion-modal"),i=n.componentProps.delivery,d=n.componentProps.isLast,_=i.driver_comments?i.driver_comments:"",h=i.img?i.img:"",O="",I={latitude:null,longitude:null},f=new Object,u="",b="",p=!1,m=!0,v=!1,w="",y=i.comments_ext,R=!1,D="";it(()=>{V(),B()});function B(){i.date_service?i.date_service&&!i.date_completed&&!i.service_time?(t(4,m=!1),t(5,v=!0)):i.date_service&&i.date_completed&&i.service_time&&(t(4,m=!1),t(5,v=!1)):(t(4,m=!0),t(5,v=!1))}if(i.comments_ext){const Q=i.comments_ext.match(Rt);Q&&(w=Q[1],y=i.comments_ext.replace(Rt,"").trim())}const C=async(Q,ie)=>{await(await Qe.create({header:Q||"Error",message:ie||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()},L=async Q=>{t(3,p=!0);const X=Q.target.files[0],S=await A(X);if(S){const K=new FormData;K.append("fileToUpload",S);try{const F=await fetch(`${o}api/admin/manager/upload_img_driver.php`,{method:"POST",body:K});if(F.ok){const J=await F.json();t(1,h=J.img),O=J.img_id}else console.error("File upload failed:",F.statusText)}catch(F){console.error("Error during file upload:",F)}finally{t(3,p=!1)}}},A=async Q=>new Promise(ie=>{const X=new FileReader;X.onload=S=>{const K=new Image;K.src=S.target.result,K.onload=()=>{const F=document.createElement("canvas"),J=F.getContext("2d"),se=800,W=600;let te=K.width,fe=K.height;te>se&&(fe*=se/te,te=se),fe>W&&(te*=W/fe,fe=W),F.width=te,F.height=fe,J.drawImage(K,0,0,te,fe),F.toBlob(we=>{ie(we)},"image/jpeg",.7)}},X.readAsDataURL(Q)}),k=()=>{n.dismiss({data:Date.now()})},M=async()=>{try{if(await P()){const ie={id_route:i.id_route,id_event:i.id_event,comments:_.value,img:h,img_id:O,lat:I.latitude,lon:I.longitude,...u==="0"&&{approve:"0"},...d&&{isLast:!0}},X=new FormData;for(const S in ie)X.append(S,ie[S]);if(ie.img&&ie.img_id)if((await(await fetch(`${o}api/admin/evidence/send_evidence.php`,{method:"POST",body:X})).json()).success==!0){const F=ie.id_route;k(),d&&U("","",F,d)}else C("Carga fallida","Actualiza la página y vuelve a intentar cargar la información!");else i.img?k():C("Información incompleta","Cargar evidencia fotográfica faltante para completar parada.")}}catch(Q){console.error("Error fetching data:",Q)}},U=(Q,ie,X,S)=>{n.componentProps.routeId=X,n.componentProps.driverId=i.id_driver,Ke("modal-km-gas",an,{checklist:Q,driverId:ie,routeId:X,isLast:S}).then(K=>{})},P=async()=>navigator.geolocation?new Promise((Q,ie)=>{navigator.geolocation.getCurrentPosition(X=>{I.latitude=X.coords.latitude,I.longitude=X.coords.longitude,Q(!0)},X=>{console.error("Error getting location:",X),Q(!1)})}):(console.error("Geolocation is not supported by your browser"),!1);async function j(Q){Q.stopPropagation();const ie=new FormData;ie.append("client_phone",w),ie.append("client_name",i.title),ie.append("delivery_phone",i.client_phone),ie.append("enterprise_name",i.enterprise_name);try{const X=await fetch(`${o}api/admin/message_central/send_sms.php`,{method:"POST",body:ie});if(X.ok){const S=await X.json();C("SMS enviado","Se envío correctamente un SMS a "+i.title+" con número de teléfono: "+w)}else C("SMS no enviado","Hubo un error al enviar SMS a "+i.title+" con número de teléfono: "+phoneNumber0+". Por favor contacte a soporte.")}catch(X){console.error("Error during file upload:",X)}}const V=async Q=>{if(i.id_enterprise){const ie=new FormData;ie.append("id_enterprise",i.id_enterprise);try{const X=await fetch(`${o}api/admin/enterprise/enterprise_settings.php`,{method:"POST",body:ie});X.ok?(f=(await X.json()).nodos,u=Ut("stops_wait_approval",f),t(2,b=Ut("sms_active",f))):console.error("File upload failed:",X.statusText)}catch(X){console.error("Error during file upload:",X)}}};function G(){t(4,m=!1),t(5,v=!0),he(i.id_event,"checkin")}function oe(){t(5,v=!1),t(4,m=!1),he(i.id_event,"checkout")}async function he(Q,ie){if(ie){const X=new FormData;X.append("type",ie),X.append("id_event",Q);try{const S=await fetch(`${o}api/admin/route/record_check_date.php`,{method:"POST",body:X});if(S.ok){const K=await S.json();K.minutes&&C("Tiempo por parada","Completaste la parada en "+K.minutes+" minutos.")}else console.error("File upload failed:",S.statusText)}catch(S){console.error("Error during file upload:",S)}finally{}}}function ce(Q){He[Q?"unshift":"push"](()=>{D=Q,t(9,D)})}function be(Q){He[Q?"unshift":"push"](()=>{_=Q,t(0,_)})}return[_,h,b,p,m,v,w,y,R,D,i,L,k,M,j,G,oe,ce,be]}class lo extends $e{constructor(e){super(),et(this,e,io,oo,xe,{},null,[-1,-1])}}function Ft(l){let e;return{c(){e=s("ion-spinner"),this.h()},l(t){e=c(t,"ION-SPINNER",{name:!0}),E(e).forEach(a),this.h()},h(){g(e,"name","dots")},m(t,o){H(t,e,o)},d(t){t&&a(e)}}}function qt(l){let e,t,o;return{c(){e=s("section"),t=s("ion-img"),this.h()},l(n){e=c(n,"SECTION",{});var i=E(e);t=c(i,"ION-IMG",{src:!0,alt:!0,style:!0}),E(t).forEach(a),i.forEach(a),this.h()},h(){dt(t.src,o=l[0])||g(t,"src",o),g(t,"alt","Evidencia fotográfica"),q(t,"max-width","100%"),q(t,"margin-top","16px")},m(n,i){H(n,e,i),r(e,t)},p(n,i){i&1&&!dt(t.src,o=n[0])&&g(t,"src",o)},d(n){n&&a(e)}}}function ro(l){let e,t,o,n,i="Cancelar",d,_,h="AGREGAR GASTO",O,I,f,u,b,p,m,v,w,y,R,D,B,C,L,A,k,M,U='Tipo de pago <ion-text color="danger">(Obligatorio)</ion-text>',P,j,V="Efectivo",G,oe,he="Tarjeta",ce,be,Q="Transferencia",ie,X,S,K,F,J,se,W,te,fe,we=`<ion-icon icon="${nn}" slot="start"></ion-icon>
                        Subir Evidencia`,ke,ve,Be,ze,qe,Fe,Pe,Ae,z="Confirmar",$,Te,ne=l[5]&&Ft(),le=l[0]&&qt(l);return{c(){e=s("ion-header"),t=s("ion-toolbar"),o=s("ion-buttons"),n=s("ion-button"),n.textContent=i,d=N(),_=s("ion-title"),_.textContent=h,O=N(),I=s("ion-content"),f=s("ion-list"),u=s("ion-item"),b=s("ion-icon"),p=N(),m=s("ion-input"),v=N(),w=s("ion-item"),y=s("ion-icon"),R=N(),D=s("ion-input"),B=N(),C=s("ion-item"),L=s("ion-icon"),A=N(),k=s("ion-select"),M=s("div"),M.innerHTML=U,P=N(),j=s("ion-select-option"),j.textContent=V,G=N(),oe=s("ion-select-option"),oe.textContent=he,ce=N(),be=s("ion-select-option"),be.textContent=Q,ie=N(),X=s("ion-item"),S=s("ion-icon"),K=N(),F=s("ion-textarea"),J=N(),se=s("section"),W=s("label"),te=s("ion-button"),fe=s("label"),fe.innerHTML=we,ke=N(),ve=s("input"),Be=N(),ne&&ne.c(),ze=N(),le&&le.c(),qe=N(),Fe=s("ion-footer"),Pe=s("ion-toolbar"),Ae=s("ion-button"),Ae.textContent=z,this.h()},l(re){e=c(re,"ION-HEADER",{translucent:!0});var _e=E(e);t=c(_e,"ION-TOOLBAR",{});var de=E(t);o=c(de,"ION-BUTTONS",{slot:!0});var Ee=E(o);n=c(Ee,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),Y(n)!=="svelte-1f8rjcf"&&(n.textContent=i),Ee.forEach(a),d=T(de),_=c(de,"ION-TITLE",{title:!0,"data-svelte-h":!0}),Y(_)!=="svelte-efps2s"&&(_.textContent=h),de.forEach(a),_e.forEach(a),O=T(re),I=c(re,"ION-CONTENT",{fullscreen:!0});var ue=E(I);f=c(ue,"ION-LIST",{});var ee=E(f);u=c(ee,"ION-ITEM",{});var Le=E(u);b=c(Le,"ION-ICON",{icon:!0,slot:!0}),E(b).forEach(a),p=T(Le),m=c(Le,"ION-INPUT",{label:!0,type:!0,placeholder:!0,value:!0}),E(m).forEach(a),Le.forEach(a),v=T(ee),w=c(ee,"ION-ITEM",{});var Ne=E(w);y=c(Ne,"ION-ICON",{icon:!0,slot:!0}),E(y).forEach(a),R=T(Ne),D=c(Ne,"ION-INPUT",{label:!0,type:!0,value:!0}),E(D).forEach(a),Ne.forEach(a),B=T(ee),C=c(ee,"ION-ITEM",{});var ye=E(C);L=c(ye,"ION-ICON",{icon:!0,slot:!0}),E(L).forEach(a),A=T(ye),k=c(ye,"ION-SELECT",{placeholder:!0,value:!0});var Ie=E(k);M=c(Ie,"DIV",{slot:!0,"data-svelte-h":!0}),Y(M)!=="svelte-wl764p"&&(M.innerHTML=U),P=T(Ie),j=c(Ie,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),Y(j)!=="svelte-i9crym"&&(j.textContent=V),G=T(Ie),oe=c(Ie,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),Y(oe)!=="svelte-fx0z11"&&(oe.textContent=he),ce=T(Ie),be=c(Ie,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),Y(be)!=="svelte-1c24jf2"&&(be.textContent=Q),Ie.forEach(a),ye.forEach(a),ie=T(ee),X=c(ee,"ION-ITEM",{});var Se=E(X);S=c(Se,"ION-ICON",{icon:!0,slot:!0}),E(S).forEach(a),K=T(Se),F=c(Se,"ION-TEXTAREA",{label:!0,placeholder:!0}),E(F).forEach(a),Se.forEach(a),J=T(ee),se=c(ee,"SECTION",{});var Me=E(se);W=c(Me,"LABEL",{for:!0,style:!0});var Z=E(W);te=c(Z,"ION-BUTTON",{fill:!0,size:!0,class:!0,expand:!0});var Oe=E(te);fe=c(Oe,"LABEL",{for:!0,style:!0,"data-svelte-h":!0}),Y(fe)!=="svelte-1m9yw22"&&(fe.innerHTML=we),ke=T(Oe),ve=c(Oe,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0}),Oe.forEach(a),Z.forEach(a),Me.forEach(a),Be=T(ee),ne&&ne.l(ee),ze=T(ee),le&&le.l(ee),ee.forEach(a),ue.forEach(a),qe=T(re),Fe=c(re,"ION-FOOTER",{});var Ve=E(Fe);Pe=c(Ve,"ION-TOOLBAR",{});var nt=E(Pe);Ae=c(nt,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),Y(Ae)!=="svelte-1c7dl3f"&&(Ae.textContent=z),nt.forEach(a),Ve.forEach(a),this.h()},h(){g(n,"color","medium"),g(o,"slot","start"),g(_,"title",""),g(e,"translucent",""),g(b,"icon",ln),g(b,"slot","start"),g(m,"label","Concepto"),g(m,"type","text"),g(m,"placeholder","Escribe aquí..."),g(m,"value",l[6]?l[6]:""),g(y,"icon",vt),g(y,"slot","start"),g(D,"label","Cantidad"),g(D,"type","number"),g(D,"value",l[7]?l[7]:""),g(L,"icon",yn),g(L,"slot","start"),x(M,"slot","label"),g(j,"value","cash"),g(oe,"value","card"),g(be,"value","transfer"),g(k,"placeholder","Tipo de pago"),g(k,"value",l[8]?l[8]:""),g(S,"icon",vt),g(S,"slot","start"),g(F,"label","Comentarios"),g(F,"placeholder","Escribe aquí..."),x(fe,"for","eventEvidence"),q(fe,"width","100%"),q(fe,"padding","8px"),q(ve,"display","none"),x(ve,"id","eventEvidence"),x(ve,"name","fileToUpload"),x(ve,"type","file"),x(ve,"accept","image/*"),g(te,"fill","outline"),g(te,"size","small"),g(te,"class","loadEvidence"),g(te,"expand","block"),x(W,"for","eventEvidence"),q(W,"display","block"),q(W,"width","100%"),g(I,"fullscreen",""),g(Ae,"fill","outline"),g(Ae,"color","tertiary"),g(Ae,"strong",""),q(Ae,"width","99%"),q(Ae,"height","auto")},m(re,_e){H(re,e,_e),r(e,t),r(t,o),r(o,n),r(t,d),r(t,_),H(re,O,_e),H(re,I,_e),r(I,f),r(f,u),r(u,b),r(u,p),r(u,m),l[12](m),r(f,v),r(f,w),r(w,y),r(w,R),r(w,D),l[13](D),r(f,B),r(f,C),r(C,L),r(C,A),r(C,k),r(k,M),r(k,P),r(k,j),r(k,G),r(k,oe),r(k,ce),r(k,be),l[14](k),r(f,ie),r(f,X),r(X,S),r(X,K),r(X,F),l[15](F),r(f,J),r(f,se),r(se,W),r(W,te),r(te,fe),r(te,ke),r(te,ve),r(f,Be),ne&&ne.m(f,null),r(f,ze),le&&le.m(f,null),H(re,qe,_e),H(re,Fe,_e),r(Fe,Pe),r(Pe,Ae),$||(Te=[ae(n,"click",l[10]),ae(ve,"change",l[9]),ae(Ae,"click",l[11])],$=!0)},p(re,[_e]){re[5]?ne||(ne=Ft(),ne.c(),ne.m(f,ze)):ne&&(ne.d(1),ne=null),re[0]?le?le.p(re,_e):(le=qt(re),le.c(),le.m(f,null)):le&&(le.d(1),le=null)},i:Ce,o:Ce,d(re){re&&(a(e),a(O),a(I),a(qe),a(Fe)),l[12](null),l[13](null),l[14](null),l[15](null),ne&&ne.d(),le&&le.d(),$=!1,Ge(Te)}}}function ao(l,e,t){let o=ht,n=document.querySelector("ion-modal"),i=n.componentProps.routeId,d=n.componentProps.ex_concept,_=n.componentProps.ex_amount,h=n.componentProps.ex_type,O=n.componentProps.id_expense,I="",f="",u="",b=0,p="",m="",v=!1;it(()=>{});const w=async(M,U)=>{await(await Qe.create({header:M||"Error",message:U||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()},y=async M=>{t(5,v=!0);const P=M.target.files[0],j=await R(P);if(j){const V=new FormData;V.append("fileToUpload",j);try{const G=await fetch(`${o}api/admin/manager/upload_img_driver.php`,{method:"POST",body:V});if(G.ok){const oe=await G.json();t(0,I=oe.img),f=oe.img_id}else console.error("File upload failed:",G.statusText)}catch(G){console.error("Error during file upload:",G)}finally{t(5,v=!1)}}},R=async M=>new Promise(U=>{const P=new FileReader;P.onload=j=>{const V=new Image;V.src=j.target.result,V.onload=()=>{const G=document.createElement("canvas"),oe=G.getContext("2d"),he=800,ce=600;let be=V.width,Q=V.height;be>he&&(Q*=he/be,be=he),Q>ce&&(be*=ce/Q,Q=ce),G.width=be,G.height=Q,oe.drawImage(V,0,0,be,Q),G.toBlob(ie=>{U(ie)},"image/jpeg",.7)}},P.readAsDataURL(M)}),D=()=>{at.dismiss()},B=()=>{var M=new Object;M.id_route=i,M.comments=p.value,M.type=u.value,M.img=I,M.img_id=f,M.amount=b.value,M.concept=m.value,M.status="done",M.id_expense=O||"null";const U=new FormData;for(const P in M)U.append(P,M[P]);!f||!I||!p.value||!b.value||!m.value?w("Datos incompletos","Llena los datos requeridos para completar el registro"):fetch(`${o}api/admin/expenses/add_expense.php`,{method:"POST",body:U}).then(P=>P.json()).then(P=>{D()}).catch(P=>{console.error("Error fetching data:",P)})};function C(M){He[M?"unshift":"push"](()=>{m=M,t(4,m)})}function L(M){He[M?"unshift":"push"](()=>{b=M,t(2,b)})}function A(M){He[M?"unshift":"push"](()=>{u=M,t(1,u)})}function k(M){He[M?"unshift":"push"](()=>{p=M,t(3,p)})}return[I,u,b,p,m,v,d,_,h,y,D,B,C,L,A,k]}class bt extends $e{constructor(e){super(),et(this,e,ao,ro,xe,{})}}function jt(l,e,t){const o=l.slice();return o[7]=e[t],o}function so(l){let e,t="Cargar gasto",o,n;function i(...d){return l[4](l[7],...d)}return{c(){e=s("ion-button"),e.textContent=t,this.h()},l(d){e=c(d,"ION-BUTTON",{fill:!0,size:!0,"aria-selected":!0,"data-svelte-h":!0}),Y(e)!=="svelte-175aelj"&&(e.textContent=t),this.h()},h(){g(e,"fill","outline"),g(e,"size","small"),g(e,"aria-selected","")},m(d,_){H(d,e,_),o||(n=ae(e,"click",i),o=!0)},p(d,_){l=d},d(d){d&&a(e),o=!1,n()}}}function co(l){let e,t="Gasto completado";return{c(){e=s("ion-button"),e.textContent=t,this.h()},l(o){e=c(o,"ION-BUTTON",{fill:!0,size:!0,"aria-selected":!0,"data-svelte-h":!0}),Y(e)!=="svelte-tlger7"&&(e.textContent=t),this.h()},h(){g(e,"fill","solid"),g(e,"size","small"),g(e,"aria-selected","")},m(o,n){H(o,e,n)},p:Ce,d(o){o&&a(e)}}}function Vt(l,e){let t,o,n,i=e[7].concept+"",d,_,h;function O(u,b){return u[7].status=="done"?co:so}let f=O(e)(e);return{key:l,first:null,c(){t=s("ion-item"),o=s("ion-label"),n=s("p"),d=pe(i),_=N(),f.c(),h=N(),this.h()},l(u){t=c(u,"ION-ITEM",{});var b=E(t);o=c(b,"ION-LABEL",{style:!0});var p=E(o);n=c(p,"P",{style:!0});var m=E(n);d=me(m,i),m.forEach(a),p.forEach(a),_=T(b),f.l(b),h=T(b),b.forEach(a),this.h()},h(){q(n,"margin-left","10px"),q(o,"display","flex"),this.first=t},m(u,b){H(u,t,b),r(t,o),r(o,n),r(n,d),r(t,_),f.m(t,null),r(t,h)},p(u,b){e=u,f.p(e,b)},d(u){u&&a(t),f.d()}}}function uo(l){let e,t,o,n,i=`<ion-icon style="font-size: 25px!important;" icon="${wn}"></ion-icon>`,d,_,h="LISTA DE GASTOS",O,I,f,u=[],b=new Map,p,m,v,w="Cerrar",y,R,D=je(l[0]);const B=C=>C[7].id_expenses;for(let C=0;C<D.length;C+=1){let L=jt(l,D,C),A=B(L);b.set(A,u[C]=Vt(A,L))}return{c(){e=s("ion-header"),t=s("ion-toolbar"),o=s("ion-buttons"),n=s("ion-button"),n.innerHTML=i,d=N(),_=s("ion-title"),_.textContent=h,O=N(),I=s("ion-content"),f=s("ion-list");for(let C=0;C<u.length;C+=1)u[C].c();p=N(),m=s("ion-footer"),v=s("ion-button"),v.textContent=w,this.h()},l(C){e=c(C,"ION-HEADER",{translucent:!0});var L=E(e);t=c(L,"ION-TOOLBAR",{});var A=E(t);o=c(A,"ION-BUTTONS",{slot:!0});var k=E(o);n=c(k,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),Y(n)!=="svelte-160xz3i"&&(n.innerHTML=i),k.forEach(a),d=T(A),_=c(A,"ION-TITLE",{"data-svelte-h":!0}),Y(_)!=="svelte-1phn90x"&&(_.textContent=h),A.forEach(a),L.forEach(a),O=T(C),I=c(C,"ION-CONTENT",{fullscreen:!0});var M=E(I);f=c(M,"ION-LIST",{});var U=E(f);for(let j=0;j<u.length;j+=1)u[j].l(U);U.forEach(a),M.forEach(a),p=T(C),m=c(C,"ION-FOOTER",{});var P=E(m);v=c(P,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),Y(v)!=="svelte-zv7v83"&&(v.textContent=w),P.forEach(a),this.h()},h(){g(n,"color","medium"),g(o,"slot","end"),g(e,"translucent",""),g(I,"fullscreen",""),g(v,"fill","outline"),g(v,"color","tertiary"),g(v,"strong",""),q(v,"width","99%"),q(v,"height","auto")},m(C,L){H(C,e,L),r(e,t),r(t,o),r(o,n),r(t,d),r(t,_),H(C,O,L),H(C,I,L),r(I,f);for(let A=0;A<u.length;A+=1)u[A]&&u[A].m(f,null);H(C,p,L),H(C,m,L),r(m,v),y||(R=[ae(n,"click",l[3]),ae(v,"click",l[1])],y=!0)},p(C,[L]){L&5&&(D=je(C[0]),u=lt(u,L,B,1,C,D,b,f,rt,Vt,null,jt))},i:Ce,o:Ce,d(C){C&&(a(e),a(O),a(I),a(p),a(m));for(let L=0;L<u.length;L+=1)u[L].d();y=!1,Ge(R)}}}function fo(l){let e=document.querySelector("ion-modal");e.componentProps.routeId;let t=e.componentProps.expenses;it(()=>{});const o=()=>{at.dismiss()};function n(_,h,O,I,f){e.componentProps.ex_amount=O,e.componentProps.ex_concept=h,e.componentProps.ex_type=I,e.componentProps.id_expense=f,Ke("modal-expense",bt,{amount:O,concept:h,type:I,id_expense:f}).then(()=>{}),o()}return[t,o,n,_=>{Ke("modal-expense",bt,{routeId:_}).then(h=>{}),o()},(_,h)=>n(h,_.concept,_.amount,_.type,_.id_expenses)]}class _o extends $e{constructor(e){super(),et(this,e,fo,uo,xe,{})}}const{document:Gt}=Bn;function Kt(l,e,t){const o=l.slice();return o[36]=e[t],o[38]=t,o}function Wt(l,e,t){const o=l.slice();return o[36]=e[t],o[38]=t,o}function Xt(l,e,t){const o=l.slice();return o[36]=e[t],o[38]=t,o}function Jt(l){let e,t;return e=new Pn({props:{$$slots:{default:[Eo]},$$scope:{ctx:l}}}),{c(){hn(e.$$.fragment)},l(o){pn(e.$$.fragment,o)},m(o,n){mn(e,o,n),t=!0},p(o,n){const i={};n[0]&1019|n[1]&1024&&(i.$$scope={dirty:n,ctx:o}),e.$set(i)},i(o){t||(_t(e.$$.fragment,o),t=!0)},o(o){mt(e.$$.fragment,o),t=!1},d(o){vn(e,o)}}}function ho(l){let e,t='<div id="g_map" style="width: 100%; height: 100vh;"></div>';return{c(){e=s("ion-content"),e.innerHTML=t},l(o){e=c(o,"ION-CONTENT",{"data-svelte-h":!0}),Y(e)!=="svelte-1ydw6i9"&&(e.innerHTML=t)},m(o,n){H(o,e,n)},p:Ce,d(o){o&&a(e)}}}function po(l){let e;function t(i,d){if(i[7].length>0)return vo;if(!i[3])return mo}let o=t(l),n=o&&o(l);return{c(){n&&n.c(),e=Ue()},l(i){n&&n.l(i),e=Ue()},m(i,d){n&&n.m(i,d),H(i,e,d)},p(i,d){o===(o=t(i))&&n?n.p(i,d):(n&&n.d(1),n=o&&o(i),n&&(n.c(),n.m(e.parentNode,e)))},d(i){i&&a(e),n&&n.d(i)}}}function mo(l){let e,t,o,n='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Jala para actualizar" refreshing-spinner="circles" refreshing-text="Actualizando..."></ion-refresher-content>',i,d,_=[],h=new Map,O,I,f=l[4]&&Qt(l),u=je(l[5]);const b=p=>p[36].id_event;for(let p=0;p<u.length;p+=1){let m=Kt(l,u,p),v=b(m);h.set(v,_[p]=Zt(v,m))}return{c(){f&&f.c(),e=N(),t=s("ion-content"),o=s("ion-refresher"),o.innerHTML=n,i=N(),d=s("ion-list");for(let p=0;p<_.length;p+=1)_[p].c();this.h()},l(p){f&&f.l(p),e=T(p),t=c(p,"ION-CONTENT",{});var m=E(t);o=c(m,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),Y(o)!=="svelte-1srnbs3"&&(o.innerHTML=n),i=T(m),d=c(m,"ION-LIST",{});var v=E(d);for(let w=0;w<_.length;w+=1)_[w].l(v);v.forEach(a),m.forEach(a),this.h()},h(){g(o,"slot","fixed")},m(p,m){f&&f.m(p,m),H(p,e,m),H(p,t,m),r(t,o),l[26](o),r(t,i),r(t,d);for(let v=0;v<_.length;v+=1)_[v]&&_[v].m(d,null);O||(I=ae(o,"ionRefresh",l[10]),O=!0)},p(p,m){p[4]?f?f.p(p,m):(f=Qt(p),f.c(),f.m(e.parentNode,e)):f&&(f.d(1),f=null),m[0]&430112&&(u=je(p[5]),_=lt(_,m,b,1,p,u,h,d,rt,Zt,null,Kt))},d(p){p&&(a(e),a(t)),f&&f.d(p),l[26](null);for(let m=0;m<_.length;m+=1)_[m].d();O=!1,I()}}}function vo(l){let e,t;function o(d,_){return _[0]&144&&(e=null),e==null&&(e=!!(d[7].filter(ko).every(Oo)&&!d[4])),e?bo:go}let n=o(l,[-1,-1]),i=n(l);return{c(){i.c(),t=Ue()},l(d){i.l(d),t=Ue()},m(d,_){i.m(d,_),H(d,t,_)},p(d,_){n===(n=o(d,_))&&i?i.p(d,_):(i.d(1),i=n(d),i&&(i.c(),i.m(t.parentNode,t)))},d(d){d&&a(t),i.d(d)}}}function Qt(l){let e=l[13]("",l[1],l[0])+"",t;return{c(){t=pe(e)},l(o){t=me(o,e)},m(o,n){H(o,t,n)},p(o,n){n[0]&3&&e!==(e=o[13]("",o[1],o[0])+"")&&De(t,e)},d(o){o&&a(t)}}}function Yt(l){let e;return{c(){e=s("span"),this.h()},l(t){e=c(t,"SPAN",{class:!0}),E(e).forEach(a),this.h()},h(){x(e,"class","notes svelte-egzizz")},m(t,o){H(t,e,o)},d(t){t&&a(e)}}}function Zt(l,e){let t,o,n,i,d=parseInt(e[36].pos)+1+"",_,h,O,I,f,u,b=e[36].title+"",p,m,v=e[36].support_list&&e[36].support_list.length||e[15](e[36]),w,y,R,D,B,C=v&&Yt();function L(){return e[27](e[36],e[38])}return{key:l,first:null,c(){t=s("ion-item"),o=s("ion-avatar"),n=s("div"),i=s("div"),_=pe(d),O=N(),I=s("ion-label"),f=s("ion-text"),u=s("h3"),p=pe(b),m=N(),C&&C.c(),w=N(),y=s("ion-icon"),R=N(),this.h()},l(A){t=c(A,"ION-ITEM",{});var k=E(t);o=c(k,"ION-AVATAR",{slot:!0});var M=E(o);n=c(M,"DIV",{class:!0,title:!0,style:!0});var U=E(n);i=c(U,"DIV",{class:!0});var P=E(i);_=me(P,d),P.forEach(a),U.forEach(a),M.forEach(a),O=T(k),I=c(k,"ION-LABEL",{button:!0});var j=E(I);f=c(j,"ION-TEXT",{color:!0});var V=E(f);u=c(V,"H3",{});var G=E(u);p=me(G,b),m=T(G),C&&C.l(G),G.forEach(a),V.forEach(a),j.forEach(a),w=T(k),y=c(k,"ION-ICON",{icon:!0,slot:!0,style:!0}),E(y).forEach(a),R=T(k),k.forEach(a),this.h()},h(){x(i,"class","order svelte-egzizz"),x(n,"class","order-wrapper svelte-egzizz"),x(n,"title",h=Ye(e[36].status)),q(n,"background-color",Re(e[36].status,e[36].date_service)),q(n,"color",Ze(Re(e[36].status))),g(o,"slot","start"),g(f,"color","#2e2e2e"),g(I,"button",""),g(y,"icon",tt),g(y,"slot","end"),q(y,"color",Re(e[36].status,e[36].date_service)),this.first=t},m(A,k){H(A,t,k),r(t,o),r(o,n),r(n,i),r(i,_),r(t,O),r(t,I),r(I,f),r(f,u),r(u,p),r(u,m),C&&C.m(u,null),r(t,w),r(t,y),r(t,R),D||(B=ae(I,"click",L),D=!0)},p(A,k){e=A,k[0]&32&&d!==(d=parseInt(e[36].pos)+1+"")&&De(_,d),k[0]&32&&h!==(h=Ye(e[36].status))&&x(n,"title",h),k[0]&32&&q(n,"background-color",Re(e[36].status,e[36].date_service)),k[0]&32&&q(n,"color",Ze(Re(e[36].status))),k[0]&32&&b!==(b=e[36].title+"")&&De(p,b),k[0]&32&&(v=e[36].support_list&&e[36].support_list.length||e[15](e[36])),v?C||(C=Yt(),C.c(),C.m(u,null)):C&&(C.d(1),C=null),k[0]&32&&q(y,"color",Re(e[36].status,e[36].date_service))},d(A){A&&a(t),C&&C.d(),D=!1,B()}}}function go(l){let e=l[13](l[7],l[1],l[0])+"",t,o,n,i,d='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Pull to refresh" refreshing-spinner="circles" refreshing-text="Refreshing..."></ion-refresher-content>',_,h,O=[],I=new Map,f,u,b=je(l[5]);const p=m=>m[36].id_event;for(let m=0;m<b.length;m+=1){let v=Wt(l,b,m),w=p(v);I.set(w,O[m]=$t(w,v))}return{c(){t=pe(e),o=N(),n=s("ion-content"),i=s("ion-refresher"),i.innerHTML=d,_=N(),h=s("ion-list");for(let m=0;m<O.length;m+=1)O[m].c();this.h()},l(m){t=me(m,e),o=T(m),n=c(m,"ION-CONTENT",{});var v=E(n);i=c(v,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),Y(i)!=="svelte-dvt1s"&&(i.innerHTML=d),_=T(v),h=c(v,"ION-LIST",{});var w=E(h);for(let y=0;y<O.length;y+=1)O[y].l(w);w.forEach(a),v.forEach(a),this.h()},h(){g(i,"slot","fixed")},m(m,v){H(m,t,v),H(m,o,v),H(m,n,v),r(n,i),l[24](i),r(n,_),r(n,h);for(let w=0;w<O.length;w+=1)O[w]&&O[w].m(h,null);f||(u=ae(i,"ionRefresh",l[10]),f=!0)},p(m,v){v[0]&131&&e!==(e=m[13](m[7],m[1],m[0])+"")&&De(t,e),v[0]&430112&&(b=je(m[5]),O=lt(O,v,p,1,m,b,I,h,rt,$t,null,Wt))},d(m){m&&(a(t),a(o),a(n)),l[24](null);for(let v=0;v<O.length;v+=1)O[v].d();f=!1,u()}}}function bo(l){let e,t,o='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Jale para actualizar" refreshing-spinner="circles" refreshing-text="Actualizando..."></ion-refresher-content>',n,i,d=[],_=new Map,h,O,I=je(l[5]);const f=u=>u[36].id_event;for(let u=0;u<I.length;u+=1){let b=Xt(l,I,u),p=f(b);_.set(p,d[u]=tn(p,b))}return{c(){e=s("ion-content"),t=s("ion-refresher"),t.innerHTML=o,n=N(),i=s("ion-list");for(let u=0;u<d.length;u+=1)d[u].c();this.h()},l(u){e=c(u,"ION-CONTENT",{});var b=E(e);t=c(b,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),Y(t)!=="svelte-15ukrgn"&&(t.innerHTML=o),n=T(b),i=c(b,"ION-LIST",{});var p=E(i);for(let m=0;m<d.length;m+=1)d[m].l(p);p.forEach(a),b.forEach(a),this.h()},h(){g(t,"slot","fixed")},m(u,b){H(u,e,b),r(e,t),l[22](t),r(e,n),r(e,i);for(let p=0;p<d.length;p+=1)d[p]&&d[p].m(i,null);h||(O=ae(t,"ionRefresh",l[10]),h=!0)},p(u,b){b[0]&430112&&(I=je(u[5]),d=lt(d,b,f,1,u,I,_,i,rt,tn,null,Xt))},d(u){u&&a(e),l[22](null);for(let b=0;b<d.length;b+=1)d[b].d();h=!1,O()}}}function xt(l){let e;return{c(){e=s("span"),this.h()},l(t){e=c(t,"SPAN",{class:!0}),E(e).forEach(a),this.h()},h(){x(e,"class","notes svelte-egzizz")},m(t,o){H(t,e,o)},d(t){t&&a(e)}}}function $t(l,e){let t,o,n,i,d=parseInt(e[36].pos)+1+"",_,h,O,I,f,u,b=e[36].title+"",p,m,v=e[36].support_list&&e[36].support_list.length||e[15](e[36]),w,y,R="",D,B,C,L,A,k=v&&xt();function M(){return e[25](e[36],e[38])}return{key:l,first:null,c(){t=s("ion-item"),o=s("ion-avatar"),n=s("div"),i=s("div"),_=pe(d),O=N(),I=s("ion-label"),f=s("ion-text"),u=s("h3"),p=pe(b),m=N(),k&&k.c(),w=N(),y=s("div"),y.innerHTML=R,D=N(),B=s("ion-icon"),C=N(),this.h()},l(U){t=c(U,"ION-ITEM",{});var P=E(t);o=c(P,"ION-AVATAR",{slot:!0});var j=E(o);n=c(j,"DIV",{class:!0,title:!0,style:!0});var V=E(n);i=c(V,"DIV",{class:!0});var G=E(i);_=me(G,d),G.forEach(a),V.forEach(a),j.forEach(a),O=T(P),I=c(P,"ION-LABEL",{button:!0});var oe=E(I);f=c(oe,"ION-TEXT",{color:!0});var he=E(f);u=c(he,"H3",{});var ce=E(u);p=me(ce,b),m=T(ce),k&&k.l(ce),ce.forEach(a),he.forEach(a),w=T(oe),y=c(oe,"DIV",{class:!0,"data-svelte-h":!0}),Y(y)!=="svelte-qaecoo"&&(y.innerHTML=R),oe.forEach(a),D=T(P),B=c(P,"ION-ICON",{icon:!0,slot:!0}),E(B).forEach(a),C=T(P),P.forEach(a),this.h()},h(){x(i,"class","order svelte-egzizz"),x(n,"class","order-wrapper svelte-egzizz"),x(n,"title",h=Ye(e[36].status)),q(n,"background-color",Re(e[36].status,e[36].date_service)),q(n,"color",Ze(Re(e[36].status))),g(o,"slot","start"),g(f,"color","#2e2e2e"),x(y,"class","sub svelte-egzizz"),g(I,"button",""),g(B,"icon",tt),g(B,"slot","end"),this.first=t},m(U,P){H(U,t,P),r(t,o),r(o,n),r(n,i),r(i,_),r(t,O),r(t,I),r(I,f),r(f,u),r(u,p),r(u,m),k&&k.m(u,null),r(I,w),r(I,y),r(t,D),r(t,B),r(t,C),L||(A=ae(I,"click",M),L=!0)},p(U,P){e=U,P[0]&32&&d!==(d=parseInt(e[36].pos)+1+"")&&De(_,d),P[0]&32&&h!==(h=Ye(e[36].status))&&x(n,"title",h),P[0]&32&&q(n,"background-color",Re(e[36].status,e[36].date_service)),P[0]&32&&q(n,"color",Ze(Re(e[36].status))),P[0]&32&&b!==(b=e[36].title+"")&&De(p,b),P[0]&32&&(v=e[36].support_list&&e[36].support_list.length||e[15](e[36])),v?k||(k=xt(),k.c(),k.m(u,null)):k&&(k.d(1),k=null)},d(U){U&&a(t),k&&k.d(),L=!1,A()}}}function en(l){let e;return{c(){e=s("span"),this.h()},l(t){e=c(t,"SPAN",{class:!0}),E(e).forEach(a),this.h()},h(){x(e,"class","notes svelte-egzizz")},m(t,o){H(t,e,o)},d(t){t&&a(e)}}}function tn(l,e){let t,o,n,i,d=parseInt(e[36].pos)+1+"",_,h,O,I,f,u,b=e[36].title+"",p,m,v=e[36].support_list&&e[36].support_list.length||e[15](e[36]),w,y,R="",D,B,C,L,A,k=v&&en();function M(){return e[23](e[36],e[38])}return{key:l,first:null,c(){t=s("ion-item"),o=s("ion-avatar"),n=s("div"),i=s("div"),_=pe(d),O=N(),I=s("ion-label"),f=s("ion-text"),u=s("h3"),p=pe(b),m=N(),k&&k.c(),w=N(),y=s("div"),y.innerHTML=R,D=N(),B=s("ion-icon"),C=N(),this.h()},l(U){t=c(U,"ION-ITEM",{});var P=E(t);o=c(P,"ION-AVATAR",{slot:!0});var j=E(o);n=c(j,"DIV",{class:!0,title:!0,style:!0});var V=E(n);i=c(V,"DIV",{class:!0});var G=E(i);_=me(G,d),G.forEach(a),V.forEach(a),j.forEach(a),O=T(P),I=c(P,"ION-LABEL",{button:!0});var oe=E(I);f=c(oe,"ION-TEXT",{color:!0});var he=E(f);u=c(he,"H3",{});var ce=E(u);p=me(ce,b),m=T(ce),k&&k.l(ce),ce.forEach(a),he.forEach(a),w=T(oe),y=c(oe,"DIV",{class:!0,"data-svelte-h":!0}),Y(y)!=="svelte-qaecoo"&&(y.innerHTML=R),oe.forEach(a),D=T(P),B=c(P,"ION-ICON",{icon:!0,slot:!0}),E(B).forEach(a),C=T(P),P.forEach(a),this.h()},h(){x(i,"class","order svelte-egzizz"),x(n,"class","order-wrapper svelte-egzizz"),x(n,"title",h=Ye(e[36].status)),q(n,"background-color",Re(e[36].status,e[36].date_service)),q(n,"color",Ze(Re(e[36].status))),g(o,"slot","start"),g(f,"color","#2e2e2e"),x(y,"class","sub svelte-egzizz"),g(I,"button",""),g(B,"icon",tt),g(B,"slot","end"),this.first=t},m(U,P){H(U,t,P),r(t,o),r(o,n),r(n,i),r(i,_),r(t,O),r(t,I),r(I,f),r(f,u),r(u,p),r(u,m),k&&k.m(u,null),r(I,w),r(I,y),r(t,D),r(t,B),r(t,C),L||(A=ae(I,"click",M),L=!0)},p(U,P){e=U,P[0]&32&&d!==(d=parseInt(e[36].pos)+1+"")&&De(_,d),P[0]&32&&h!==(h=Ye(e[36].status))&&x(n,"title",h),P[0]&32&&q(n,"background-color",Re(e[36].status,e[36].date_service)),P[0]&32&&q(n,"color",Ze(Re(e[36].status))),P[0]&32&&b!==(b=e[36].title+"")&&De(p,b),P[0]&32&&(v=e[36].support_list&&e[36].support_list.length||e[15](e[36])),v?k||(k=en(),k.c(),k.m(u,null)):k&&(k.d(1),k=null)},d(U){U&&a(t),k&&k.d(),L=!1,A()}}}function Eo(l){let e,t,o,n,i=`<ion-icon icon="${Ln}"></ion-icon>`,d,_,h,O=`<ion-icon icon="${Sn}"></ion-icon>`,I,f,u=(l[6].name?l[6].name.toUpperCase():"")+"",b,p,m,v='<ion-segment-button value="list"><ion-label>Paradas</ion-label></ion-segment-button> <ion-segment-button value="map"><ion-label>Mapa</ion-label></ion-segment-button>',w,y,R,D;function B(A,k){if(A[9]==="list")return po;if(A[9]==="map")return ho}let C=B(l),L=C&&C(l);return{c(){e=s("ion-header"),t=s("ion-toolbar"),o=s("ion-buttons"),n=s("ion-button"),n.innerHTML=i,d=N(),_=s("ion-buttons"),h=s("ion-button"),h.innerHTML=O,I=N(),f=s("ion-title"),b=pe(u),p=N(),m=s("ion-segment"),m.innerHTML=v,w=N(),L&&L.c(),y=Ue(),this.h()},l(A){e=c(A,"ION-HEADER",{translucent:!0});var k=E(e);t=c(k,"ION-TOOLBAR",{});var M=E(t);o=c(M,"ION-BUTTONS",{slot:!0});var U=E(o);n=c(U,"ION-BUTTON",{title:!0,alt:!0,"data-svelte-h":!0}),Y(n)!=="svelte-7ppz3r"&&(n.innerHTML=i),U.forEach(a),d=T(M),_=c(M,"ION-BUTTONS",{slot:!0});var P=E(_);h=c(P,"ION-BUTTON",{"data-svelte-h":!0}),Y(h)!=="svelte-nf50hj"&&(h.innerHTML=O),P.forEach(a),I=T(M),f=c(M,"ION-TITLE",{});var j=E(f);b=me(j,u),j.forEach(a),M.forEach(a),p=T(k),m=c(k,"ION-SEGMENT",{value:!0,"data-svelte-h":!0}),Y(m)!=="svelte-lue4c9"&&(m.innerHTML=v),k.forEach(a),w=T(A),L&&L.l(A),y=Ue(),this.h()},h(){g(n,"title","Atrás"),g(n,"alt","Atrás"),g(o,"slot","start"),g(_,"slot","end"),g(m,"value","list"),g(e,"translucent","")},m(A,k){H(A,e,k),r(e,t),r(t,o),r(o,n),r(t,d),r(t,_),r(_,h),r(t,I),r(t,f),r(f,b),r(e,p),r(e,m),H(A,w,k),L&&L.m(A,k),H(A,y,k),R||(D=[ae(n,"click",l[16]),ae(h,"click",l[20]),ae(m,"ionChange",l[21])],R=!0)},p(A,k){k[0]&64&&u!==(u=(A[6].name?A[6].name.toUpperCase():"")+"")&&De(b,u),C===(C=B(A))&&L?L.p(A,k):(L&&L.d(1),L=C&&C(A),L&&(L.c(),L.m(y.parentNode,y)))},d(A){A&&(a(e),a(w),a(y)),L&&L.d(A),R=!1,Ge(D)}}}function Io(l){let e,t,o,n=l[2]&&Jt(l);return{c(){e=N(),n&&n.c(),t=Ue(),this.h()},l(i){un("svelte-kn0kph",Gt.head).forEach(a),e=T(i),n&&n.l(i),t=Ue(),this.h()},h(){Gt.title="Rutaflow - Detalles de ruta"},m(i,d){H(i,e,d),n&&n.m(i,d),H(i,t,d),o=!0},p(i,d){i[2]?n?(n.p(i,d),d[0]&4&&_t(n,1)):(n=Jt(i),n.c(),_t(n,1),n.m(t.parentNode,t)):n&&(gn(),mt(n,1,1,()=>{n=null}),dn())},i(i){o||(_t(n),o=!0)},o(i){mt(n),o=!1},d(i){i&&(a(e),a(t)),n&&n.d(i)}}}function Re(l,e=""){let t="#ffffff";return l==="pending"&&!e?t="#f2e300":l=="pending"&&e?t="#F6A833":l==="completed"&&(t="#44d900"),t}function Ye(l){let e="";return l=="pending"?e="Pendiente":l=="completed"&&(e="Completado"),e}function Ze(l){l.slice(0,1)==="#"&&(l=l.slice(1)),l.length===3&&(l=l.split("").map(function(i){return i+i}).join(""));const e=parseInt(l.substr(0,2),16),t=parseInt(l.substr(2,2),16),o=parseInt(l.substr(4,2),16);return(e*299+t*587+o*114)/1e3>=128?"#414040":"#fff"}const ko=l=>l.mandatory==="1",Oo=l=>l.img;function No(l,e,t){let o;fn(l,Mn,S=>t(19,o=S));var n=this&&this.__awaiter||function(S,K,F,J){function se(W){return W instanceof F?W:new F(function(te){te(W)})}return new(F||(F=Promise))(function(W,te){function fe(ve){try{ke(J.next(ve))}catch(Be){te(Be)}}function we(ve){try{ke(J.throw(ve))}catch(Be){te(Be)}}function ke(ve){ve.done?W(ve.value):se(ve.value).then(fe,we)}ke((J=J.apply(S,K||[])).next())})};let{routeId:i}=e,{driverId:d}=e,_=ht,h=new Object,O=!0,I=!1,f=[],u={},b=[],p=[],m,v=!1,w="list",y;const R=()=>n(void 0,void 0,void 0,function*(){yield B(i),m.complete()});it(()=>n(void 0,void 0,void 0,function*(){yield B(i)}));function D(S){return n(this,void 0,void 0,function*(){if(t(9,w=S),w==="map"){yield _n(),y=document.getElementById("g_map");const K=new google.maps.Map(y,{zoom:8,center:{lat:20.6745683,lng:-103.3986104},mapId:"4504f8b37365c3d0"}),F=new google.maps.LatLngBounds,{AdvancedMarkerElement:J,PinElement:se}=yield google.maps.importLibrary("marker");navigator.geolocation?navigator.geolocation.getCurrentPosition(function(W){const te=new google.maps.LatLng(W.coords.latitude,W.coords.longitude);new google.maps.Marker({position:te,map:K,icon:{path:google.maps.SymbolPath.CIRCLE,fillColor:"#0062ff",fillOpacity:1,scale:6,strokeColor:"#ffffff",strokeWeight:2}}),new google.maps.Circle({strokeColor:"#00BFFF",strokeOpacity:.5,strokeWeight:1,fillColor:"#00BFFF",fillOpacity:.2,map:K,center:te,radius:W.coords.accuracy}),F.extend(te)},function(W){console.error("Error retrieving location:",W)}):console.error("Geolocation not supported by this browser."),f.forEach((W,te)=>{const fe=parseFloat(W.lat),we=parseFloat(W.lon),ke=new google.maps.LatLng(fe,we),ve=new google.maps.Marker({position:{lat:fe,lng:we},map:K,title:W.title}),Be=new se({background:Re(W.status,W.date_service),borderColor:"#000",glyphColor:"#000",glyph:(parseInt(W.pos)+1).toString()});new J({map:K,position:ke,content:Be.element,title:"Parada "+(parseInt(W.pos)+1).toString()+": "+W.title}).addListener("click",function(qe){L(W,V(te))}),F.extend(ve.getPosition())}),K.fitBounds(F)}})}function B(S){return n(this,void 0,void 0,function*(){const K=new FormData;K.append("id_route",S);try{const J=yield(yield fetch(`${_}api/admin/report/seguimiento_list.php`,{method:"POST",body:K})).json();t(6,u=J.data.seguimiento_list[0]),t(5,f=J.data.event_list),t(7,b=J.data.checklist),p=J.data.expenses,u&&t(4,I=u.km_inicial=="0"&&u.gas_inicial=="0"),t(3,O=!1)}catch(F){t(3,O=!1),console.error("Error fetching data:",F)}})}const C=S=>new Promise((K,F)=>{const J=new FormData;J.append("id_route",S.id_route),J.append("id_event",S.id_event),fetch(`${_}api/admin/evidence/evidence_by_event.php`,{method:"POST",body:J}).then(se=>se.json()).then(se=>{K(se.data.event_evidence[0])}).catch(se=>{console.error("Error fetching data:",se),F(se)})}),L=(S,K)=>{C(S).then(F=>{F&&(S.img=F.img,S.driver_comments=F.driver_comments,S.comments=F.comments),Ke("modal-delivery-info",lo,{delivery:S,isLast:K}).then(J=>{}).finally(()=>{B(i)})})},A=(S,K,F)=>{var J=!1;return v||(v=!0,Ke("modal-checklist",an,{checklist:S,driverId:K,routeId:F,isLast:J}).then(se=>{v=!1}),U(F,"checklist")),""},k=S=>n(void 0,void 0,void 0,function*(){return yield B(S),p.length>0?Ke("modal-expense-detail",_o,{routeId:S,expenses:p}).then(K=>{}):Ke("modal-expense",bt,{routeId:S}).then(K=>{}),""}),M=S=>{if(S.tracking_type=="subscription"){if(S.subscriber_info&&S.payment_type==="cash"&&new Date(S.subscriber_info.payment_next)<new Date)return!0}else if(S.tracking_type=="ecommerce"&&Number(S.payment_pending)>0)return!0;return!1};function U(S,K){let F=new FormData;return F.append("id_route",S),F.append("status",K),fetch(`${_}api/admin/route/change_status.php`,{method:"POST",body:F}).then(J=>J.json()).then(J=>{}).catch(J=>{console.error("Error fetching data:",J)}),""}const P=()=>{h.id_driver?We(`/drivers/${h.id_driver}`):We("/drivers/me")},j=(S,K)=>n(void 0,void 0,void 0,function*(){yield(yield Qe.create({header:S||"Error",message:K||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()});function V(S){return S===f.length-1}const G=()=>k(i),oe=S=>D(S.detail.value);function he(S){He[S?"unshift":"push"](()=>{m=S,t(8,m)})}const ce=(S,K)=>{const F=f.findIndex(fe=>fe.id_event===S.id_event),J=F===0,se=F>0?f[F-1]:null,W=J||se&&se.img!==null,te=S.img!==null&&S.img!=="";W||J&&!te?L(S,V(K)):j("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")};function be(S){He[S?"unshift":"push"](()=>{m=S,t(8,m)})}const Q=(S,K)=>{const F=f.findIndex(fe=>fe.id_event===S.id_event),J=F===0,se=F>0?f[F-1]:null,W=J||se&&se.img!==null,te=S.img!==null&&S.img!=="";W||J&&!te?L(S,V(K)):j("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")};function ie(S){He[S?"unshift":"push"](()=>{m=S,t(8,m)})}const X=(S,K)=>{const F=f.findIndex(fe=>fe.id_event===S.id_event),J=F===0,se=F>0?f[F-1]:null,W=J||se&&se.img!==null,te=S.img!==null&&S.img!=="";W||J&&!te?L(S,V(K)):j("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")};return l.$$set=S=>{"routeId"in S&&t(0,i=S.routeId),"driverId"in S&&t(1,d=S.driverId)},l.$$.update=()=>{l.$$.dirty[0]&524293&&(t(0,{routeId:i,driverId:d}=o.params,i,(t(1,d),t(19,o),t(2,h),t(0,i))),t(2,h=JSON.parse(localStorage.getItem("userSession"))),h?h.id_user&&(h.type=="admin"||h.type=="superadmin")?(B(i),We(`/drivers/me/routes/${i}`)):h.id_user&&h.id_driver&&(B(i),We(`/drivers/${h.id_driver}/routes/${i}`)):We("/"))},[i,d,h,O,I,f,u,b,m,w,R,D,L,A,k,M,P,j,V,o,G,oe,he,ce,be,Q,ie,X]}class Po extends $e{constructor(e){super(),et(this,e,No,Io,xe,{routeId:0,driverId:1},null,[-1,-1])}}export{Po as component};

import{Z as ut,s as Ke,e as s,j as w,b as c,q as v,d as oe,h as a,m as L,v as m,i as V,w as r,x as ae,n as Oe,z as Be,_ as Zt,B as G,o as Ye,k as Ae,$ as ft,t as ge,r as be,f as x,a0 as xt,a1 as Je,A as Me,y as ye,a2 as ot,l as $t,p as en,F as tn}from"../chunks/index.BzUyNcuj.js";import{S as We,i as Xe,t as nt,a as rt,c as nn,b as on,d as ln,m as rn,e as an,g as sn}from"../chunks/index.D9GPdhpm.js";import{e as ze,u as Qe,d as Ze,a as cn,b as un,c as fn,i as Wt,f as _n,g as Xt,h as dn,j as at,k as hn,m as Jt,s as _t,n as Ue,o as pn,q as mn,r as vn,t as gn,v as bn,w as En,p as In}from"../chunks/index.Cg4Lo-P2.js";import"../chunks/index-6e05b96e.C_9q9BoX.js";import{m as xe,D as it,a as qe,I as kn}from"../chunks/IonPage.BWAz1V0F.js";import{q as On,t as Nn}from"../chunks/ion-modal.BYMRzj9z.js";import{g as Fe}from"../chunks/entry.nnZsqDy6.js";const Tn=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global,Cn=(l,e)=>{if(!customElements.get(l)){class t extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const n={};for(const i of this.attributes)n[i.name]=i.value;new e({target:this.shadowRoot,props:n})}}customElements.define(l,t)}},yn=function(l){return document.createElement(l).constructor!==HTMLElement},wn=(l,e)=>{yn(l)||Cn(l,e)},He=async(l,e,t)=>{On(),Nn(),wn(l,e);const o=await xe.create({component:l,componentProps:t});return o.present(),await o.onWillDismiss()};let je=ut({km_inicial:[],gas_inicial:[],km_final:[],gas_final:[]}),Yt=ut({flag:[]});function Ln(l){let e,t,o,n,i="Cancelar",_,h,d="Captura de Km/Gas",k,E,u,f="Confirmar",p,g,b,I,A,M,q;return{c(){e=s("ion-header"),t=s("ion-toolbar"),o=s("ion-buttons"),n=s("ion-button"),n.textContent=i,_=w(),h=s("ion-title"),h.textContent=d,k=w(),E=s("ion-buttons"),u=s("ion-button"),u.textContent=f,p=w(),g=s("ion-content"),b=s("ion-item"),I=s("ion-input"),this.h()},l(R){e=c(R,"ION-HEADER",{translucent:!0});var U=v(e);t=c(U,"ION-TOOLBAR",{});var y=v(t);o=c(y,"ION-BUTTONS",{slot:!0});var P=v(o);n=c(P,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),oe(n)!=="svelte-17pq4f4"&&(n.textContent=i),P.forEach(a),_=L(y),h=c(y,"ION-TITLE",{"data-svelte-h":!0}),oe(h)!=="svelte-1yhkaq7"&&(h.textContent=d),k=L(y),E=c(y,"ION-BUTTONS",{slot:!0});var N=v(E);u=c(N,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),oe(u)!=="svelte-cm6j4s"&&(u.textContent=f),N.forEach(a),y.forEach(a),U.forEach(a),p=L(R),g=c(R,"ION-CONTENT",{fullscreen:!0});var O=v(g);b=c(O,"ION-ITEM",{});var S=v(b);I=c(S,"ION-INPUT",{class:!0,inputmode:!0,pattern:!0,type:!0,placeholder:!0,value:!0,required:!0});var H=v(I);H.forEach(a),S.forEach(a),O.forEach(a),this.h()},h(){m(n,"color","medium"),m(o,"slot","start"),m(u,"strong",""),m(E,"slot","end"),m(e,"translucent",""),m(I,"class","fin-km"),m(I,"inputmode","numeric"),m(I,"pattern","[0-9]*"),m(I,"type","number"),m(I,"placeholder",A="Ingresa "+l[0]+" actual"),m(I,"value",l[1]),m(I,"required",""),m(g,"fullscreen","")},m(R,U){V(R,e,U),r(e,t),r(t,o),r(o,n),r(t,_),r(t,h),r(t,k),r(t,E),r(E,u),V(R,p,U),V(R,g,U),r(g,b),r(b,I),M||(q=[ae(n,"click",l[2]),ae(u,"click",l[3]),ae(I,"input",l[4])],M=!0)},p(R,[U]){U&1&&A!==(A="Ingresa "+R[0]+" actual")&&m(I,"placeholder",A),U&2&&m(I,"value",R[1])},i:Oe,o:Oe,d(R){R&&(a(e),a(p),a(g)),M=!1,Be(q)}}}function Mn(l,e,t){const o=Zt();let n=document.querySelector("ion-modal"),i=n.componentProps.data_type;n.componentProps.isLast;let _;Yt.subscribe(u=>{i=u.flag[0],i=="km_final"||i=="km_inicial"?t(0,_="kilometraje"):t(0,_="litros de gasolina")});let h=0;function d(){xe.dismiss()}function k(){o("modalResult",{data:"Your data",role:"confirm"}),i=="km_inicial"?je.update(f=>({...f,km_inicial:[h]})):i=="gas_inicial"?je.update(f=>({...f,gas_inicial:[h]})):i=="km_final"?je.update(f=>({...f,km_final:[h]})):i=="gas_final"&&je.update(f=>({...f,gas_final:[h]})),d()}return[_,h,d,k,u=>t(1,h=u.target.value)]}class Sn extends We{constructor(e){super(),Xe(this,e,Mn,Ln,Ke,{})}}const lt=ut({items:[],checkedIndices:[],mandatory:[]});function vt(l,e,t){const o=l.slice();return o[53]=e[t],o[54]=e,o[55]=t,o}function An(l){let e,t,o,n,i,_="Kilometraje inicial",h,d,k=l[0]?l[0]+" km.":"Cargar km",E,u,f,p,g,b,I,A="Gasolina inicial (litros)",M,q,R=l[1]?l[1]+" litros":"Cargar gas",U,y,P,N;return y=ft(l[21][0]),{c(){e=s("ion-item"),t=s("ion-label"),o=s("input"),n=w(),i=s("p"),i.textContent=_,h=w(),d=s("ion-button"),E=ge(k),u=w(),f=s("ion-item"),p=s("ion-label"),g=s("input"),b=w(),I=s("p"),I.textContent=A,M=w(),q=s("ion-button"),U=ge(R),this.h()},l(O){e=c(O,"ION-ITEM",{});var S=v(e);t=c(S,"ION-LABEL",{style:!0});var H=v(t);o=c(H,"INPUT",{id:!0,style:!0,type:!0}),n=L(H),i=c(H,"P",{style:!0,"data-svelte-h":!0}),oe(i)!=="svelte-88twxi"&&(i.textContent=_),H.forEach(a),h=L(S),d=c(S,"ION-BUTTON",{fill:!0,size:!0,class:!0,"aria-selected":!0});var z=v(d);E=be(z,k),z.forEach(a),S.forEach(a),u=L(O),f=c(O,"ION-ITEM",{});var K=v(f);p=c(K,"ION-LABEL",{style:!0});var Y=v(p);g=c(Y,"INPUT",{id:!0,style:!0,type:!0}),b=L(Y),I=c(Y,"P",{style:!0,"data-svelte-h":!0}),oe(I)!=="svelte-1ux30eb"&&(I.textContent=A),Y.forEach(a),M=L(K),q=c(K,"ION-BUTTON",{fill:!0,class:!0,size:!0,style:!0});var X=v(q);U=be(X,R),X.forEach(a),K.forEach(a),this.h()},h(){x(o,"id","chkbox-km-ini"),G(o,"pointer-events","auto"),x(o,"type","checkbox"),o.required=!0,G(i,"margin-left","10px"),G(t,"display","flex"),m(d,"fill","outline"),m(d,"size","small"),m(d,"class","loadKmInicial"),m(d,"aria-selected",""),x(g,"id","chkbox-gas-ini"),G(g,"pointer-events","auto"),x(g,"type","checkbox"),g.required=!0,G(I,"margin-left","10px"),G(p,"display","flex"),m(q,"fill","outline"),m(q,"class","loadGasInicial"),m(q,"size","small"),G(q,"height","16px "),y.p(o,g)},m(O,S){V(O,e,S),r(e,t),r(t,o),o.checked=~(l[4]||[]).indexOf(o.__value),l[28](o),r(t,n),r(t,i),r(e,h),r(e,d),r(d,E),V(O,u,S),V(O,f,S),r(f,p),r(p,g),l[30](g),g.checked=~(l[4]||[]).indexOf(g.__value),r(p,b),r(p,I),r(f,M),r(f,q),r(q,U),P||(N=[ae(o,"change",l[27]),ae(d,"click",l[29]),ae(g,"change",l[31]),ae(q,"click",l[32])],P=!0)},p(O,S){S[0]&16&&(o.checked=~(O[4]||[]).indexOf(o.__value)),S[0]&1&&k!==(k=O[0]?O[0]+" km.":"Cargar km")&&ye(E,k),S[0]&16&&(g.checked=~(O[4]||[]).indexOf(g.__value)),S[0]&2&&R!==(R=O[1]?O[1]+" litros":"Cargar gas")&&ye(U,R)},d(O){O&&(a(e),a(u),a(f)),l[28](null),l[30](null),y.r(),P=!1,Be(N)}}}function Dn(l){let e,t,o,n,i,_="Kilometraje final",h,d,k=l[2]?l[2]+" km.":"Cargar km",E,u,f,p,g,b,I,A="Gasolina final (litros)",M,q,R=l[3]?l[3]+" litros":"Cargar gas",U,y,P,N;return y=ft(l[21][0]),{c(){e=s("ion-item"),t=s("ion-label"),o=s("input"),n=w(),i=s("p"),i.textContent=_,h=w(),d=s("ion-button"),E=ge(k),u=w(),f=s("ion-item"),p=s("ion-label"),g=s("input"),b=w(),I=s("p"),I.textContent=A,M=w(),q=s("ion-button"),U=ge(R),this.h()},l(O){e=c(O,"ION-ITEM",{});var S=v(e);t=c(S,"ION-LABEL",{style:!0});var H=v(t);o=c(H,"INPUT",{id:!0,style:!0,type:!0}),n=L(H),i=c(H,"P",{style:!0,"data-svelte-h":!0}),oe(i)!=="svelte-ccmu71"&&(i.textContent=_),H.forEach(a),h=L(S),d=c(S,"ION-BUTTON",{fill:!0,size:!0,class:!0,"aria-selected":!0});var z=v(d);E=be(z,k),z.forEach(a),S.forEach(a),u=L(O),f=c(O,"ION-ITEM",{});var K=v(f);p=c(K,"ION-LABEL",{style:!0});var Y=v(p);g=c(Y,"INPUT",{id:!0,style:!0,type:!0}),b=L(Y),I=c(Y,"P",{style:!0,"data-svelte-h":!0}),oe(I)!=="svelte-wsoyd2"&&(I.textContent=A),Y.forEach(a),M=L(K),q=c(K,"ION-BUTTON",{fill:!0,size:!0,class:!0});var X=v(q);U=be(X,R),X.forEach(a),K.forEach(a),this.h()},h(){x(o,"id","chkbox-km-fin"),G(o,"pointer-events","auto"),x(o,"type","checkbox"),o.required=!0,G(i,"margin-left","10px"),G(t,"display","flex"),m(d,"fill","outline"),m(d,"size","small"),m(d,"class","loadKmInicial"),m(d,"aria-selected",""),x(g,"id","chkbox-gas-fin"),G(g,"pointer-events","auto"),x(g,"type","checkbox"),g.required=!0,G(I,"margin-left","10px"),G(p,"display","flex"),m(q,"fill","outline"),m(q,"size","small"),m(q,"class","loadGasInicial"),y.p(o,g)},m(O,S){V(O,e,S),r(e,t),r(t,o),o.checked=~(l[4]||[]).indexOf(o.__value),l[22](o),r(t,n),r(t,i),r(e,h),r(e,d),r(d,E),V(O,u,S),V(O,f,S),r(f,p),r(p,g),g.checked=~(l[4]||[]).indexOf(g.__value),l[25](g),r(p,b),r(p,I),r(f,M),r(f,q),r(q,U),P||(N=[ae(o,"change",l[20]),ae(d,"click",l[23]),ae(g,"change",l[24]),ae(q,"click",l[26])],P=!0)},p(O,S){S[0]&16&&(o.checked=~(O[4]||[]).indexOf(o.__value)),S[0]&4&&k!==(k=O[2]?O[2]+" km.":"Cargar km")&&ye(E,k),S[0]&16&&(g.checked=~(O[4]||[]).indexOf(g.__value)),S[0]&8&&R!==(R=O[3]?O[3]+" litros":"Cargar gas")&&ye(U,R)},d(O){O&&(a(e),a(u),a(f)),l[22](null),l[25](null),y.r(),P=!1,Be(N)}}}function Pn(l){let e=[],t=new Map,o,n=ze(l[13]);const i=_=>_[53].id_checklist_event;for(let _=0;_<n.length;_+=1){let h=vt(l,n,_),d=i(h);t.set(d,e[_]=gt(d,h))}return{c(){for(let _=0;_<e.length;_+=1)e[_].c();o=Ae()},l(_){for(let h=0;h<e.length;h+=1)e[h].l(_);o=Ae()},m(_,h){for(let d=0;d<e.length;d+=1)e[d]&&e[d].m(_,h);V(_,o,h)},p(_,h){h[0]&407664&&(n=ze(_[13]),e=Qe(e,h,i,1,_,n,t,o.parentNode,Ze,gt,o,vt))},d(_){_&&a(o);for(let h=0;h<e.length;h+=1)e[h].d(_)}}}function zn(l){let e,t=(l[12][l[53].id_checklist_event]?l[12][l[53].id_checklist_event]:"Cargar evidencia")+"",o;return{c(){e=s("label"),o=ge(t),this.h()},l(n){e=c(n,"LABEL",{for:!0,class:!0});var i=v(e);o=be(i,t),i.forEach(a),this.h()},h(){x(e,"for","chklist-"+l[53].id_checklist_event),x(e,"class","button-label svelte-1ruehls")},m(n,i){V(n,e,i),r(e,o)},p(n,i){i[0]&4096&&t!==(t=(n[12][n[53].id_checklist_event]?n[12][n[53].id_checklist_event]:"Cargar evidencia")+"")&&ye(o,t)},d(n){n&&a(e)}}}function Bn(l){let e;return{c(){e=s("ion-spinner"),this.h()},l(t){e=c(t,"ION-SPINNER",{name:!0,class:!0}),v(e).forEach(a),this.h()},h(){m(e,"name","dots"),m(e,"class","button-spinner svelte-1ruehls")},m(t,o){V(t,e,o)},p:Oe,d(t){t&&a(e)}}}function gt(l,e){let t,o,n,i=e[53],_,h,d=e[53].item+"",k,E,u,f=e[53].mandatory=="1"?" * ":"",p,g,b,I,A,M,q,R,U,y;const P=()=>e[34](n,i),N=()=>e[34](null,i);function O(){return e[35](e[53])}function S(Y,X){return Y[11][Y[53].id_checklist_event]?Bn:zn}let H=S(e),z=H(e);function K(...Y){return e[37](e[53],...Y)}return R=ft(e[21][0]),{key:l,first:null,c(){t=s("ion-item"),o=s("ion-label"),n=s("input"),_=w(),h=s("p"),k=ge(d),E=w(),u=s("b"),p=ge(f),g=w(),b=s("ion-button"),I=s("div"),z.c(),A=w(),M=s("input"),q=w(),this.h()},l(Y){t=c(Y,"ION-ITEM",{});var X=v(t);o=c(X,"ION-LABEL",{style:!0});var ie=v(o);n=c(ie,"INPUT",{id:!0,style:!0,type:!0}),_=L(ie),h=c(ie,"P",{style:!0});var fe=v(h);k=be(fe,d),E=L(fe),fe.forEach(a),u=c(ie,"B",{style:!0});var de=v(u);p=be(de,f),de.forEach(a),ie.forEach(a),g=L(X),b=c(X,"ION-BUTTON",{fill:!0,class:!0,size:!0});var se=v(b);I=c(se,"DIV",{class:!0});var Ee=v(I);z.l(Ee),A=L(Ee),M=c(Ee,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0}),Ee.forEach(a),se.forEach(a),q=L(X),X.forEach(a),this.h()},h(){x(n,"id",`chkbox-${e[53].id_checklist_event}`),G(n,"pointer-events","auto"),x(n,"type","checkbox"),n.__value=e[53].id_checklist_event,xt(n,n.__value),n.required=!0,G(h,"margin-left","10px"),G(u,"margin-left","5px"),G(o,"display","flex"),G(M,"display","none"),x(M,"id","chklist-"+e[53].id_checklist_event),x(M,"name","fileToUpload"),x(M,"type","file"),x(M,"accept","image/*"),x(I,"class","button-content svelte-1ruehls"),m(b,"fill","outline"),m(b,"class","loadEvidence svelte-1ruehls"),m(b,"size","small"),R.p(n),this.first=t},m(Y,X){V(Y,t,X),r(t,o),r(o,n),n.checked=~(e[4]||[]).indexOf(n.__value),P(),r(o,_),r(o,h),r(h,k),r(h,E),r(o,u),r(u,p),r(t,g),r(t,b),r(b,I),z.m(I,null),r(I,A),r(I,M),e[36](M),r(t,q),U||(y=[ae(n,"change",e[33]),ae(n,"change",O),ae(M,"change",K)],U=!0)},p(Y,X){e=Y,X[0]&16&&(n.checked=~(e[4]||[]).indexOf(n.__value)),i!==e[53]&&(N(),i=e[53],P()),H===(H=S(e))&&z?z.p(e,X):(z.d(1),z=H(e),z&&(z.c(),z.m(I,A)))},d(Y){Y&&a(t),N(),z.d(),e[36](null),R.r(),U=!1,Be(y)}}}function Hn(l){let e,t,o,n,i="Cancelar",_,h,d="REQUERIMIENTOS DE RUTA",k,E,u,f,p,g,b,I="Confirmar",A,M;function q(P,N){return P[14]?Dn:An}let U=q(l)(l),y=l[13]&&Pn(l);return{c(){e=s("ion-header"),t=s("ion-toolbar"),o=s("ion-buttons"),n=s("ion-button"),n.textContent=i,_=w(),h=s("ion-title"),h.textContent=d,k=w(),E=s("ion-content"),u=s("ion-list"),U.c(),f=w(),y&&y.c(),p=w(),g=s("ion-footer"),b=s("ion-button"),b.textContent=I,this.h()},l(P){e=c(P,"ION-HEADER",{translucent:!0});var N=v(e);t=c(N,"ION-TOOLBAR",{});var O=v(t);o=c(O,"ION-BUTTONS",{slot:!0});var S=v(o);n=c(S,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),oe(n)!=="svelte-1dnmkxs"&&(n.textContent=i),S.forEach(a),_=L(O),h=c(O,"ION-TITLE",{"data-svelte-h":!0}),oe(h)!=="svelte-19bar5p"&&(h.textContent=d),O.forEach(a),N.forEach(a),k=L(P),E=c(P,"ION-CONTENT",{fullscreen:!0});var H=v(E);u=c(H,"ION-LIST",{});var z=v(u);U.l(z),f=L(z),y&&y.l(z),z.forEach(a),H.forEach(a),p=L(P),g=c(P,"ION-FOOTER",{});var K=v(g);b=c(K,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),oe(b)!=="svelte-g82qqw"&&(b.textContent=I),K.forEach(a),this.h()},h(){m(n,"color","medium"),m(o,"slot","start"),m(e,"translucent",""),m(E,"fullscreen",""),m(b,"fill","outline"),m(b,"color","tertiary"),m(b,"strong",""),G(b,"width","99%"),G(b,"height","auto")},m(P,N){V(P,e,N),r(e,t),r(t,o),r(o,n),r(t,_),r(t,h),V(P,k,N),V(P,E,N),r(E,u),U.m(u,null),r(u,f),y&&y.m(u,null),V(P,p,N),V(P,g,N),r(g,b),A||(M=[ae(n,"click",l[15]),ae(b,"click",l[16])],A=!0)},p(P,N){U.p(P,N),P[13]&&y.p(P,N)},i:Oe,o:Oe,d(P){P&&(a(e),a(k),a(E),a(p),a(g)),U.d(),y&&y.d(),A=!1,Be(M)}}}function st(l,e){if(typeof l=="object"&&l!==null||Array.isArray(l)){if(Array.isArray(l))return l.map(t=>st(t,e)).flat();{const t=Object.keys(l);let o;return e=="id_checklist_event"?o=t.filter(i=>i.toLowerCase().includes("id_checklist_event")).map(i=>l[i]):e=="mandatory"?o=t.filter(i=>i.toLowerCase().includes("mandatory")).map(i=>l[i]):(console.error("Tipo de dato no reconocido."),o=!1),o}}else return console.error("Invalid input. Please provide a valid object or array."),[]}function Rn(l,e,t){let o=it,n=document.querySelector("ion-modal");const i=n.componentProps.checklist,_=n.componentProps.driverId,h=n.componentProps.routeId,d=n.componentProps.isLast;let k,E,u,f,p=[],g=null,b={},I,A,M,q,R={},U={},y={};Ye(()=>{d?console.log("Último checklist"):lt.update(T=>(T.mandatory=st(i,"mandatory"),T.items=st(i,"id_checklist_event"),T))});function P(T){t(11,R[T]=!0,R)}const N=async()=>{await(await qe.create({header:"Datos o checklist incompletos",message:"Carga la evidencia requerida y marca todas las casillas para confirmar",buttons:[{text:"Cerrar"}]})).present()},O=async()=>{await(await qe.create({header:"Datos capturados",message:"El kilometraje y gasolina final fueron registrados correctamente, espere aprobación para finalizar ruta",buttons:[{text:"Cerrar"}]})).present()},S=async T=>{await(await qe.create({header:"Datos inválidos",message:T=="km"?"Llena correctamente el campo de kilometraje inicial":"Llena correctamente el campo de gasolina inicial",buttons:[{text:"Cerrar"}]})).present()},H=()=>{xe.dismiss(),_?Fe(`/drivers/${_}`):Fe("/drivers/me")},z=()=>{if(d){var T=fe(u,"km"),J=fe(f,"gas");const le=new FormData;le.append("km_final",T),le.append("gas_final",J),le.append("id_route",h),T&&J?(H(),fetch(`${o}api/admin/checklist/add_evidence.php`,{method:"POST",body:le}).then(re=>re.json()).then(re=>{O()}).catch(re=>{console.error("Error fetching data:",re)})):N()}else{var me=fe(k,"km"),ce=fe(E,"gas");lt.update(le=>{le.items;const re=le.mandatory;if(le.items.filter((Ie,ve)=>le.mandatory[ve]==="1").every(Ie=>le.checkedIndices.includes(Ie))&&me&&ce){H();const Ie=new FormData;for(const ve in U)if(U.hasOwnProperty(ve)){const{img:Pe,img_id:Ve}=U[ve];Ie.append(`selectedImages[${ve}][img]`,Pe),Ie.append(`selectedImages[${ve}][img_id]`,Ve)}Ie.append("km_inicial",me),Ie.append("gas_inicial",ce),Ie.append("id_route",h),fetch(`${o}api/admin/checklist/add_evidence.php`,{method:"POST",body:Ie}).then(ve=>ve.json()).then(ve=>{re&&re.some(Pe=>Pe==="1")?ie(h,"checklist-pending"):ie(h,"enroute")}).catch(ve=>{console.error("Error fetching data:",ve)})}else if(!re&&me&&ce){var we=new FormData;we.append("km_inicial",me),we.append("gas_inicial",ce),fetch(`${o}api/admin/checklist/add_evidence.php`,{method:"POST",body:we}).then(Ie=>Ie.json()).then(Ie=>{ie(h,"enroute")}).catch(Ie=>{console.error("Error fetching data:",Ie)})}else N();return le})}Ne()},K=async(T,J)=>{P(J);const ce=T.target.files[0],le=await Y(ce);if(le){const re=new FormData;re.append("fileToUpload",le);try{const ne=await fetch(`${o}api/admin/manager/upload_img_driver.php`,{method:"POST",body:re});if(ne.ok){const Ce=await ne.json();U={...U,[J]:{img:Ce.img,img_id:Ce.img_id}},t(12,y={...y,[J]:Ce.filename}),X(J),t(6,b[J].checked=!0,b),t(11,R[J]=!1,R)}else console.error("File upload failed:",ne.statusText)}catch(ne){console.error("Error during file upload:",ne)}}},Y=async T=>new Promise(J=>{const me=new FileReader;me.onload=ce=>{const le=new Image;le.src=ce.target.result,le.onload=()=>{const re=document.createElement("canvas"),ne=re.getContext("2d"),Ce=800,we=600;let Ie=le.width,ve=le.height;Ie>Ce&&(ve*=Ce/Ie,Ie=Ce),ve>we&&(Ie*=we/ve,ve=we),re.width=Ie,re.height=ve,ne.drawImage(le,0,0,Ie,ve),re.toBlob(Pe=>{J(Pe)},"image/jpeg",.7)}},me.readAsDataURL(T)}),X=T=>{lt.update(J=>(J.checkedIndices.indexOf(T)===-1?J.checkedIndices.push(T):console.error(`ID ${T} is already checked.`),J.items.forEach(ce=>{ce.id_checklist_event===T&&(ce.checked=!0)}),J))};function ie(T,J){let me=new FormData;me.append("id_route",T),me.append("status",J),fetch(`${o}api/admin/route/change_status.php`,{method:"POST",body:me}).then(ce=>ce.json()).then(ce=>{}).catch(ce=>{console.error("Error fetching data:",ce)})}function fe(T,J){return/^\d+$/.test(T)?parseInt(T,10):(S(J),null)}function de(T,J){se(J),n.componentProps.data_type=J,He("modal-gas-km",Sn,{r:J}).then(()=>{je.subscribe(me=>{Ee(me,J)})})}function se(T){Yt.update(J=>({...J,flag:[T]}))}function Ee(T,J){t(0,k=T.km_inicial?T.km_inicial:null),t(1,E=T.gas_inicial?T.gas_inicial:null),t(2,u=T.km_final?T.km_final:null),t(3,f=T.gas_final?T.gas_final:null),J=="km_inicial"&&I&&t(7,I.checked=!0,I),J=="gas_inicial"&&A&&t(8,A.checked=!0,A),J=="km_final"&&M&&t(9,M.checked=!0,M),J=="gas_final"&&q&&t(10,q.checked=!0,q)}function Ne(){je.set({km_inicial:[],gas_inicial:[],km_final:[],gas_final:[]})}const ke=[[]];function Te(){p=Je(ke[0],this.__value,this.checked),t(4,p)}function Le(T){Me[T?"unshift":"push"](()=>{M=T,t(9,M)})}const W=T=>de(T,"km_final");function Z(){p=Je(ke[0],this.__value,this.checked),t(4,p)}function C(T){Me[T?"unshift":"push"](()=>{q=T,t(10,q)})}const F=T=>de(T,"gas_final");function D(){p=Je(ke[0],this.__value,this.checked),t(4,p)}function B(T){Me[T?"unshift":"push"](()=>{I=T,t(7,I)})}const $=T=>de(T,"km_inicial");function ee(T){Me[T?"unshift":"push"](()=>{A=T,t(8,A)})}function j(){p=Je(ke[0],this.__value,this.checked),t(4,p)}const Q=T=>de(T,"gas_inicial");function te(){p=Je(ke[0],this.__value,this.checked),t(4,p)}function he(T,J){Me[T?"unshift":"push"](()=>{b[J.id_checklist_event]=T,t(6,b)})}const pe=T=>X(T.id_checklist_event);function _e(T){Me[T?"unshift":"push"](()=>{g=T,t(5,g)})}return[k,E,u,f,p,g,b,I,A,M,q,R,y,i,d,H,z,K,X,de,Te,ke,Le,W,Z,C,F,D,B,$,ee,j,Q,te,he,pe,_e,(T,J)=>K(J,T.id_checklist_event)]}class Qt extends We{constructor(e){super(),Xe(this,e,Rn,Hn,Ke,{},null,[-1,-1])}}function Un(l){let e,t,o="Confirmar",n,i;return{c(){e=s("ion-buttons"),t=s("ion-button"),t.textContent=o,this.h()},l(_){e=c(_,"ION-BUTTONS",{slot:!0});var h=v(e);t=c(h,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),oe(t)!=="svelte-1ida0il"&&(t.textContent=o),h.forEach(a),this.h()},h(){m(t,"strong",""),m(e,"slot","end")},m(_,h){V(_,e,h),r(e,t),n||(i=ae(t,"click",l[16]),n=!0)},p:Oe,d(_){_&&a(e),n=!1,i()}}}function Fn(l){let e,t,o,n,i,_="Teléfono de Negocio",h,d,k=l[10].client_phone+"",E;return{c(){e=s("ion-item"),t=s("ion-icon"),o=w(),n=s("ion-label"),i=s("p"),i.textContent=_,h=w(),d=s("h2"),E=ge(k),this.h()},l(u){e=c(u,"ION-ITEM",{href:!0});var f=v(e);t=c(f,"ION-ICON",{icon:!0,slot:!0}),v(t).forEach(a),o=L(f),n=c(f,"ION-LABEL",{class:!0});var p=v(n);i=c(p,"P",{"data-svelte-h":!0}),oe(i)!=="svelte-1u5l7fz"&&(i.textContent=_),h=L(p),d=c(p,"H2",{});var g=v(d);E=be(g,k),g.forEach(a),p.forEach(a),f.forEach(a),this.h()},h(){m(t,"icon",un),m(t,"slot","start"),m(n,"class","ion-text-wrap"),m(e,"href","tel:"+l[10].client_phone)},m(u,f){V(u,e,f),r(e,t),r(e,o),r(e,n),r(n,i),r(n,h),r(n,d),r(d,E)},p:Oe,d(u){u&&a(e)}}}function qn(l){let e,t,o,n,i,_="Domicilio Alternativo",h,d,k=l[10].line2+"",E,u,f;return{c(){e=s("ion-item"),t=s("ion-icon"),o=w(),n=s("ion-label"),i=s("p"),i.textContent=_,h=w(),d=s("h2"),E=ge(k),u=w(),f=s("ion-icon"),this.h()},l(p){e=c(p,"ION-ITEM",{href:!0});var g=v(e);t=c(g,"ION-ICON",{icon:!0,slot:!0}),v(t).forEach(a),o=L(g),n=c(g,"ION-LABEL",{class:!0});var b=v(n);i=c(b,"P",{"data-svelte-h":!0}),oe(i)!=="svelte-1ub9uzw"&&(i.textContent=_),h=L(b),d=c(b,"H2",{});var I=v(d);E=be(I,k),I.forEach(a),b.forEach(a),u=L(g),f=c(g,"ION-ICON",{icon:!0,slot:!0}),v(f).forEach(a),g.forEach(a),this.h()},h(){m(t,"icon",_t),m(t,"slot","start"),m(n,"class","ion-text-wrap"),m(f,"icon",Ue),m(f,"slot","end"),m(e,"href","https://www.google.com/maps/searhc/?api=1&query="+l[10].line2)},m(p,g){V(p,e,g),r(e,t),r(e,o),r(e,n),r(n,i),r(n,h),r(n,d),r(d,E),r(e,u),r(e,f)},p:Oe,d(p){p&&a(e)}}}function Vn(l){let e,t,o,n,i,_="Domicilio",h,d,k=l[10].line1+"",E,u,f,p,g=l[10].line2&&l[10].line2.trim().length,b,I=g&&jn(l);return{c(){e=s("ion-item"),t=s("ion-icon"),o=w(),n=s("ion-label"),i=s("p"),i.textContent=_,h=w(),d=s("h2"),E=ge(k),u=w(),f=s("ion-icon"),p=w(),I&&I.c(),b=Ae(),this.h()},l(A){e=c(A,"ION-ITEM",{href:!0});var M=v(e);t=c(M,"ION-ICON",{icon:!0,slot:!0}),v(t).forEach(a),o=L(M),n=c(M,"ION-LABEL",{class:!0});var q=v(n);i=c(q,"P",{"data-svelte-h":!0}),oe(i)!=="svelte-cbm7q1"&&(i.textContent=_),h=L(q),d=c(q,"H2",{});var R=v(d);E=be(R,k),R.forEach(a),q.forEach(a),u=L(M),f=c(M,"ION-ICON",{icon:!0,slot:!0}),v(f).forEach(a),M.forEach(a),p=L(A),I&&I.l(A),b=Ae(),this.h()},h(){m(t,"icon",_t),m(t,"slot","start"),m(n,"class","ion-text-wrap"),m(f,"icon",Ue),m(f,"slot","end"),m(e,"href","https://www.google.com/maps/search/?api=1&query="+l[10].line1)},m(A,M){V(A,e,M),r(e,t),r(e,o),r(e,n),r(n,i),r(n,h),r(n,d),r(d,E),r(e,u),r(e,f),V(A,p,M),I&&I.m(A,M),V(A,b,M)},p(A,M){g&&I.p(A,M)},d(A){A&&(a(e),a(p),a(b)),I&&I.d(A)}}}function jn(l){let e,t,o,n,i,_="Domicilio Alternativo",h,d,k=l[10].line2+"",E,u,f;return{c(){e=s("ion-item"),t=s("ion-icon"),o=w(),n=s("ion-label"),i=s("p"),i.textContent=_,h=w(),d=s("h2"),E=ge(k),u=w(),f=s("ion-icon"),this.h()},l(p){e=c(p,"ION-ITEM",{href:!0});var g=v(e);t=c(g,"ION-ICON",{icon:!0,slot:!0}),v(t).forEach(a),o=L(g),n=c(g,"ION-LABEL",{class:!0});var b=v(n);i=c(b,"P",{"data-svelte-h":!0}),oe(i)!=="svelte-1ub9uzw"&&(i.textContent=_),h=L(b),d=c(b,"H2",{});var I=v(d);E=be(I,k),I.forEach(a),b.forEach(a),u=L(g),f=c(g,"ION-ICON",{icon:!0,slot:!0}),v(f).forEach(a),g.forEach(a),this.h()},h(){m(t,"icon",_t),m(t,"slot","start"),m(n,"class","ion-text-wrap"),m(f,"icon",Ue),m(f,"slot","end"),m(e,"href","https://www.google.com/maps/search/?api=1&query="+l[10].line2)},m(p,g){V(p,e,g),r(e,t),r(e,o),r(e,n),r(n,i),r(n,h),r(n,d),r(d,E),r(e,u),r(e,f)},p:Oe,d(p){p&&a(e)}}}function bt(l){let e,t,o,n,i,_="Contacto del Cliente",h,d,k,E,u=l[2]&&l[2]==="1"&&Et(l);return{c(){e=s("ion-item"),t=s("ion-icon"),o=w(),n=s("ion-label"),i=s("p"),i.textContent=_,h=w(),d=s("h2"),k=ge(l[6]),E=w(),u&&u.c(),this.h()},l(f){e=c(f,"ION-ITEM",{});var p=v(e);t=c(p,"ION-ICON",{icon:!0,slot:!0}),v(t).forEach(a),o=L(p),n=c(p,"ION-LABEL",{class:!0});var g=v(n);i=c(g,"P",{"data-svelte-h":!0}),oe(i)!=="svelte-1utsyb6"&&(i.textContent=_),h=L(g),d=c(g,"H2",{});var b=v(d);k=be(b,l[6]),b.forEach(a),g.forEach(a),E=L(p),u&&u.l(p),p.forEach(a),this.h()},h(){m(t,"icon",fn),m(t,"slot","start"),m(n,"class","ion-text-wrap")},m(f,p){V(f,e,p),r(e,t),r(e,o),r(e,n),r(n,i),r(n,h),r(n,d),r(d,k),r(e,E),u&&u.m(e,null)},p(f,p){p[0]&64&&ye(k,f[6]),f[2]&&f[2]==="1"?u?u.p(f,p):(u=Et(f),u.c(),u.m(e,null)):u&&(u.d(1),u=null)},d(f){f&&a(e),u&&u.d()}}}function Et(l){let e,t=`<ion-icon icon="${pn}" slot="start"></ion-icon>
                        Notificar Cliente`,o,n;return{c(){e=s("ion-button"),e.innerHTML=t,this.h()},l(i){e=c(i,"ION-BUTTON",{fill:!0,style:!0,"data-svelte-h":!0}),oe(e)!=="svelte-w3qtwm"&&(e.innerHTML=t),this.h()},h(){m(e,"fill","outline"),G(e,"margin-left","16px")},m(i,_){V(i,e,_),o||(n=ae(e,"click",l[17]),o=!0)},p:Oe,d(i){i&&a(e),o=!1,n()}}}function It(l){let e,t,o,n,i,_="Notas de ubicación",h,d,k;return{c(){e=s("ion-item"),t=s("ion-icon"),o=w(),n=s("ion-label"),i=s("p"),i.textContent=_,h=w(),d=s("h2"),k=ge(l[7]),this.h()},l(E){e=c(E,"ION-ITEM",{});var u=v(e);t=c(u,"ION-ICON",{icon:!0,slot:!0}),v(t).forEach(a),o=L(u),n=c(u,"ION-LABEL",{class:!0});var f=v(n);i=c(f,"P",{"data-svelte-h":!0}),oe(i)!=="svelte-nhm2ft"&&(i.textContent=_),h=L(f),d=c(f,"H2",{});var p=v(d);k=be(p,l[7]),p.forEach(a),f.forEach(a),u.forEach(a),this.h()},h(){m(t,"icon",Wt),m(t,"slot","start"),m(n,"class","ion-text-wrap")},m(E,u){V(E,e,u),r(e,t),r(e,o),r(e,n),r(n,i),r(n,h),r(n,d),r(d,k)},p(E,u){u[0]&128&&ye(k,E[7])},d(E){E&&a(e)}}}function Gn(l){let e,t,o,n,i,_="Horarios",h,d,k=l[10].schedule+"",E;return{c(){e=s("ion-item"),t=s("ion-icon"),o=w(),n=s("ion-label"),i=s("p"),i.textContent=_,h=w(),d=s("h2"),E=ge(k),this.h()},l(u){e=c(u,"ION-ITEM",{});var f=v(e);t=c(f,"ION-ICON",{icon:!0,slot:!0}),v(t).forEach(a),o=L(f),n=c(f,"ION-LABEL",{});var p=v(n);i=c(p,"P",{"data-svelte-h":!0}),oe(i)!=="svelte-11q7hm5"&&(i.textContent=_),h=L(p),d=c(p,"H2",{});var g=v(d);E=be(g,k),g.forEach(a),p.forEach(a),f.forEach(a),this.h()},h(){m(t,"icon",_n),m(t,"slot","start")},m(u,f){V(u,e,f),r(e,t),r(e,o),r(e,n),r(n,i),r(n,h),r(n,d),r(d,E)},p:Oe,d(u){u&&a(e)}}}function Kn(l){let e,t,o,n,i,_="Notas del operador",h,d,k=l[10].driver_comments+"",E;return{c(){e=s("ion-item"),t=s("ion-icon"),o=w(),n=s("ion-label"),i=s("p"),i.textContent=_,h=w(),d=s("h2"),E=ge(k),this.h()},l(u){e=c(u,"ION-ITEM",{});var f=v(e);t=c(f,"ION-ICON",{icon:!0,slot:!0}),v(t).forEach(a),o=L(f),n=c(f,"ION-LABEL",{});var p=v(n);i=c(p,"P",{"data-svelte-h":!0}),oe(i)!=="svelte-1yk9qp4"&&(i.textContent=_),h=L(p),d=c(p,"H2",{});var g=v(d);E=be(g,k),g.forEach(a),p.forEach(a),f.forEach(a),this.h()},h(){m(t,"icon",Xt),m(t,"slot","start")},m(u,f){V(u,e,f),r(e,t),r(e,o),r(e,n),r(n,i),r(n,h),r(n,d),r(d,E)},p:Oe,d(u){u&&a(e)}}}function Wn(l){let e,t=l[10].logistic_comments!="<br>"&&Xn(l);return{c(){t&&t.c(),e=Ae()},l(o){t&&t.l(o),e=Ae()},m(o,n){t&&t.m(o,n),V(o,e,n)},p(o,n){o[10].logistic_comments!="<br>"&&t.p(o,n)},d(o){o&&a(e),t&&t.d(o)}}}function Xn(l){let e,t,o,n,i,_="Comentarios logísticos",h,d,k=l[10].logistic_comments+"",E;return{c(){e=s("ion-item"),t=s("ion-icon"),o=w(),n=s("ion-label"),i=s("p"),i.textContent=_,h=w(),d=s("h2"),E=ge(k),this.h()},l(u){e=c(u,"ION-ITEM",{});var f=v(e);t=c(f,"ION-ICON",{icon:!0,slot:!0}),v(t).forEach(a),o=L(f),n=c(f,"ION-LABEL",{class:!0});var p=v(n);i=c(p,"P",{"data-svelte-h":!0}),oe(i)!=="svelte-1iz85r6"&&(i.textContent=_),h=L(p),d=c(p,"H2",{});var g=v(d);E=be(g,k),g.forEach(a),p.forEach(a),f.forEach(a),this.h()},h(){m(t,"icon",Wt),m(t,"slot","start"),m(n,"class","ion-text-wrap")},m(u,f){V(u,e,f),r(e,t),r(e,o),r(e,n),r(n,i),r(n,h),r(n,d),r(d,E)},p:Oe,d(u){u&&a(e)}}}function kt(l){let e,t,o,n;return{c(){e=s("ion-item"),t=s("ion-icon"),o=w(),n=s("ion-textarea"),this.h()},l(i){e=c(i,"ION-ITEM",{});var _=v(e);t=c(_,"ION-ICON",{icon:!0,slot:!0}),v(t).forEach(a),o=L(_),n=c(_,"ION-TEXTAREA",{placeholder:!0}),v(n).forEach(a),_.forEach(a),this.h()},h(){m(t,"icon",dn),m(t,"slot","start"),m(n,"placeholder","Escribe el motivo...")},m(i,_){V(i,e,_),r(e,t),r(e,o),r(e,n),l[20](n)},p:Oe,d(i){i&&a(e),l[20](null)}}}function Jn(l){let e,t,o,n,i,_,h,d=l[4]===!0&&Ot(l),k=(l[5]===!0||l[5]===!1&&l[4]===!1)&&Nt(l);return{c(){e=s("ion-item"),t=s("ion-icon"),o=w(),n=s("ion-textarea"),i=w(),_=s("section"),d&&d.c(),h=w(),k&&k.c(),this.h()},l(E){e=c(E,"ION-ITEM",{});var u=v(e);t=c(u,"ION-ICON",{icon:!0,slot:!0}),v(t).forEach(a),o=L(u),n=c(u,"ION-TEXTAREA",{label:!0,placeholder:!0}),v(n).forEach(a),u.forEach(a),i=L(E),_=c(E,"SECTION",{style:!0});var f=v(_);d&&d.l(f),h=L(f),k&&k.l(f),f.forEach(a),this.h()},h(){m(t,"icon",at),m(t,"slot","start"),m(n,"label","Notas"),m(n,"placeholder","Escribe aquí..."),G(_,"display","flex"),G(_,"gap","8px"),G(_,"padding","16px 16px 6px")},m(E,u){V(E,e,u),r(e,t),r(e,o),r(e,n),l[21](n),V(E,i,u),V(E,_,u),d&&d.m(_,null),r(_,h),k&&k.m(_,null)},p(E,u){E[4]===!0?d?d.p(E,u):(d=Ot(E),d.c(),d.m(_,h)):d&&(d.d(1),d=null),E[5]===!0||E[5]===!1&&E[4]===!1?k?k.p(E,u):(k=Nt(E),k.c(),k.m(_,null)):k&&(k.d(1),k=null)},d(E){E&&(a(e),a(i),a(_)),l[21](null),d&&d.d(),k&&k.d()}}}function Ot(l){let e,t=`<ion-icon icon="${mn}" slot="start"></ion-icon>
                        Ingreso`,o,n;return{c(){e=s("ion-button"),e.innerHTML=t,this.h()},l(i){e=c(i,"ION-BUTTON",{id:!0,style:!0,"data-svelte-h":!0}),oe(e)!=="svelte-3onvnr"&&(e.innerHTML=t),this.h()},h(){m(e,"id","checkInBtn"),G(e,"flex","1")},m(i,_){V(i,e,_),o||(n=ae(e,"click",l[18]),o=!0)},p:Oe,d(i){i&&a(e),o=!1,n()}}}function Nt(l){let e,t,o,n,i,_;return{c(){e=s("ion-button"),t=s("ion-icon"),o=ge(`
                        Salida`),this.h()},l(h){e=c(h,"ION-BUTTON",{id:!0,style:!0,disabled:!0});var d=v(e);t=c(d,"ION-ICON",{icon:!0,slot:!0}),v(t).forEach(a),o=be(d,`
                        Salida`),d.forEach(a),this.h()},h(){m(t,"icon",hn),m(t,"slot","start"),m(e,"id","checkOutBtn"),G(e,"flex","1"),m(e,"disabled",n=l[5]===!1)},m(h,d){V(h,e,d),r(e,t),r(e,o),i||(_=ae(e,"click",l[19]),i=!0)},p(h,d){d[0]&32&&n!==(n=h[5]===!1)&&m(e,"disabled",n)},d(h){h&&a(e),i=!1,_()}}}function Yn(l){let e,t,o,n,i,_="Subir Evidencia",h,d,k,E;return{c(){e=s("section"),t=s("ion-button"),o=s("ion-icon"),n=w(),i=s("label"),i.textContent=_,h=w(),d=s("input"),this.h()},l(u){e=c(u,"SECTION",{style:!0});var f=v(e);t=c(f,"ION-BUTTON",{fill:!0,class:!0,style:!0});var p=v(t);o=c(p,"ION-ICON",{icon:!0,slot:!0}),v(o).forEach(a),n=L(p),i=c(p,"LABEL",{for:!0,"data-svelte-h":!0}),oe(i)!=="svelte-1wg51s6"&&(i.textContent=_),h=L(p),d=c(p,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0}),p.forEach(a),f.forEach(a),this.h()},h(){m(o,"icon",Jt),m(o,"slot","start"),x(i,"for","eventEvidence"),G(d,"display","none"),x(d,"id","eventEvidence"),x(d,"name","fileToUpload"),x(d,"type","file"),x(d,"accept","image/*"),m(t,"fill","outline"),m(t,"class","loadEvidence"),G(t,"flex","1"),G(e,"display","flex"),G(e,"gap","8px"),G(e,"padding","0px 16px")},m(u,f){V(u,e,f),r(e,t),r(t,o),r(t,n),r(t,i),r(t,h),r(t,d),k||(E=[ae(d,"change",l[13]),ae(d,"click",l[14])],k=!0)},p:Oe,d(u){u&&a(e),k=!1,Be(E)}}}function Tt(l){let e,t='<ion-spinner name="dots"></ion-spinner>';return{c(){e=s("section"),e.innerHTML=t,this.h()},l(o){e=c(o,"SECTION",{style:!0,"data-svelte-h":!0}),oe(e)!=="svelte-1sj3e0"&&(e.innerHTML=t),this.h()},h(){G(e,"text-align","center")},m(o,n){V(o,e,n)},d(o){o&&a(e)}}}function Ct(l){let e,t,o;return{c(){e=s("section"),t=s("ion-img"),this.h()},l(n){e=c(n,"SECTION",{});var i=v(e);t=c(i,"ION-IMG",{src:!0,alt:!0,style:!0}),v(t).forEach(a),i.forEach(a),this.h()},h(){ot(t.src,o=l[1])||m(t,"src",o),m(t,"alt","Evidencia fotográfica"),G(t,"max-width","100%"),G(t,"margin-top","16px")},m(n,i){V(n,e,i),r(e,t)},p(n,i){i[0]&2&&!ot(t.src,o=n[1])&&m(t,"src",o)},d(n){n&&a(e)}}}function Qn(l){let e,t,o,n,i="Cerrar",_,h,d=l[10].title+"",k,E,u,f,p,g,b,I,A,M,q="Negocio",R,U,y=l[10].client_name+"",P,N,O=l[10].client_phone&&l[10].client_phone.trim().length,S,H,z,K,Y=l[10].schedule&&l[10].schedule.trim().length,X,ie,fe=l[10].logistic_comments&&l[10].logistic_comments.trim().length,de,se,Ee,Ne,ke,Te,Le,W=(!l[11]&&!l[12]||l[11]&&l[12])&&Un(l),Z=O&&Fn(l);function C(T,J){if(T[10].line1&&T[10].line1.trim().length)return Vn;if(T[10].line2&&T[10].line2.trim().length)return qn}let F=C(l),D=F&&F(l),B=l[6]&&bt(l),$=l[7]&&l[7]!=="<br>"&&It(l),ee=Y&&Gn(l),j=l[10].driver_comments&&Kn(l),Q=fe&&Wn(l),te=l[8]&&kt(l),he=!l[12]&&Jn(l),pe=(l[11]&&l[12]||!l[11]&&!l[12])&&Yn(l),_e=l[3]&&Tt(),ue=l[1]&&Ct(l);return{c(){e=s("ion-header"),t=s("ion-toolbar"),o=s("ion-buttons"),n=s("ion-button"),n.textContent=i,_=w(),h=s("ion-title"),k=ge(d),E=w(),W&&W.c(),u=w(),f=s("ion-content"),p=s("ion-list"),g=s("ion-item"),b=s("ion-icon"),I=w(),A=s("ion-label"),M=s("p"),M.textContent=q,R=w(),U=s("h2"),P=ge(y),N=w(),Z&&Z.c(),S=w(),D&&D.c(),H=w(),B&&B.c(),z=w(),$&&$.c(),K=w(),ee&&ee.c(),X=w(),j&&j.c(),ie=w(),Q&&Q.c(),de=w(),te&&te.c(),se=w(),he&&he.c(),Ee=w(),pe&&pe.c(),Ne=w(),_e&&_e.c(),ke=w(),ue&&ue.c(),this.h()},l(T){e=c(T,"ION-HEADER",{translucent:!0});var J=v(e);t=c(J,"ION-TOOLBAR",{});var me=v(t);o=c(me,"ION-BUTTONS",{slot:!0});var ce=v(o);n=c(ce,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),oe(n)!=="svelte-2ks32x"&&(n.textContent=i),ce.forEach(a),_=L(me),h=c(me,"ION-TITLE",{style:!0,title:!0});var le=v(h);k=be(le,d),le.forEach(a),E=L(me),W&&W.l(me),me.forEach(a),J.forEach(a),u=L(T),f=c(T,"ION-CONTENT",{fullscreen:!0});var re=v(f);p=c(re,"ION-LIST",{});var ne=v(p);g=c(ne,"ION-ITEM",{});var Ce=v(g);b=c(Ce,"ION-ICON",{icon:!0,slot:!0}),v(b).forEach(a),I=L(Ce),A=c(Ce,"ION-LABEL",{});var we=v(A);M=c(we,"P",{"data-svelte-h":!0}),oe(M)!=="svelte-57b1dg"&&(M.textContent=q),R=L(we),U=c(we,"H2",{});var Ie=v(U);P=be(Ie,y),Ie.forEach(a),we.forEach(a),Ce.forEach(a),N=L(ne),Z&&Z.l(ne),S=L(ne),D&&D.l(ne),H=L(ne),B&&B.l(ne),z=L(ne),$&&$.l(ne),K=L(ne),ee&&ee.l(ne),X=L(ne),j&&j.l(ne),ie=L(ne),Q&&Q.l(ne),de=L(ne),te&&te.l(ne),se=L(ne),he&&he.l(ne),Ee=L(ne),pe&&pe.l(ne),Ne=L(ne),_e&&_e.l(ne),ke=L(ne),ue&&ue.l(ne),ne.forEach(a),re.forEach(a),this.h()},h(){m(n,"color","medium"),m(o,"slot","start"),G(h,"text-align","center"),m(h,"title",l[10].title),m(e,"translucent",""),m(b,"icon",cn),m(b,"slot","start"),m(f,"fullscreen","")},m(T,J){V(T,e,J),r(e,t),r(t,o),r(o,n),r(t,_),r(t,h),r(h,k),r(t,E),W&&W.m(t,null),V(T,u,J),V(T,f,J),r(f,p),r(p,g),r(g,b),r(g,I),r(g,A),r(A,M),r(A,R),r(A,U),r(U,P),r(p,N),Z&&Z.m(p,null),r(p,S),D&&D.m(p,null),r(p,H),B&&B.m(p,null),r(p,z),$&&$.m(p,null),r(p,K),ee&&ee.m(p,null),r(p,X),j&&j.m(p,null),r(p,ie),Q&&Q.m(p,null),r(p,de),te&&te.m(p,null),r(p,se),he&&he.m(p,null),r(p,Ee),pe&&pe.m(p,null),r(p,Ne),_e&&_e.m(p,null),r(p,ke),ue&&ue.m(p,null),Te||(Le=ae(n,"click",l[15]),Te=!0)},p(T,J){(!T[11]&&!T[12]||T[11]&&T[12])&&W.p(T,J),O&&Z.p(T,J),D&&D.p(T,J),T[6]?B?B.p(T,J):(B=bt(T),B.c(),B.m(p,z)):B&&(B.d(1),B=null),T[7]&&T[7]!=="<br>"?$?$.p(T,J):($=It(T),$.c(),$.m(p,K)):$&&($.d(1),$=null),Y&&ee.p(T,J),T[10].driver_comments&&j.p(T,J),fe&&Q.p(T,J),T[8]?te?te.p(T,J):(te=kt(T),te.c(),te.m(p,se)):te&&(te.d(1),te=null),T[12]||he.p(T,J),(T[11]&&T[12]||!T[11]&&!T[12])&&pe.p(T,J),T[3]?_e||(_e=Tt(),_e.c(),_e.m(p,ke)):_e&&(_e.d(1),_e=null),T[1]?ue?ue.p(T,J):(ue=Ct(T),ue.c(),ue.m(p,null)):ue&&(ue.d(1),ue=null)},i:Oe,o:Oe,d(T){T&&(a(e),a(u),a(f)),W&&W.d(),Z&&Z.d(),D&&D.d(),B&&B.d(),$&&$.d(),ee&&ee.d(),j&&j.d(),Q&&Q.d(),te&&te.d(),he&&he.d(),pe&&pe.d(),_e&&_e.d(),ue&&ue.d(),Te=!1,Le()}}}const yt=/Teléfono:\s*(\d{10,})/;function wt(l,e){for(let t=0;t<e.length;t++)if(e[t].alias===l)return e[t].val;return""}function Zn(l,e,t){let o=it,n=document.querySelector("ion-modal"),i=n.componentProps.delivery,_=n.componentProps.isLast||!1,h=n.componentProps.flag||!1,d=i.driver_comments?i.driver_comments:"",k=i.img?i.img:"",E="",u={latitude:null,longitude:null},f=new Object,p="",g="",b=!1,I=!0,A=!1,M="",q=i.comments_ext,R=!1,U="";Ye(()=>{se(),P()});async function y(W="",Z,C={}){const F=new FormData;t(3,b=!0);for(const[D,B]of Object.entries(C))F.append(D,B);try{const D=await fetch(W,{method:"POST",body:F});if(D.ok){const B=await D.json();Z(B)}else console.error("Request failed:",D.statusText)}catch(D){console.error("Error during file upload:",D)}finally{t(3,b=!1)}}function P(){i.date_service?i.date_service&&!i.date_completed&&!i.service_time?(t(4,I=!1),t(5,A=!0)):i.date_service&&i.date_completed&&i.service_time&&(t(4,I=!1),t(5,A=!1)):(t(4,I=!0),t(5,A=!1))}if(i.comments_ext){const W=i.comments_ext.match(yt);W&&(M=W[1],q=i.comments_ext.replace(yt,"").trim())}const N=async(W,Z)=>{await(await qe.create({header:W||"Error",message:Z||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()},O=async(W="",Z="",C="",F,D={})=>{await(await qe.create({header:W||"Error",message:Z||"Vuelva a intentar",buttons:[{text:"No",role:"cancel",handler:()=>{console.log('User selected "No"')}},{text:"Sí",handler:()=>{y(C,F,D)}}]})).present()},S=async W=>{const C=W.target.files[0],F=await K(C);if(F){var D=new Object;D.fileToUpload=F,y(`${o}api/admin/manager/upload_img_driver.php`,function(B){t(1,k=B.img),E=B.img_id},D)}};function H(W){var Z=i.service_time;!Z&&I&&!_&&!h&&(W.preventDefault(),N("Registrar Ingreso","Antes de subir la evidencia registra el ingreso a la actual parada."))}function z(){var W=h?i.date_completed:!1;if(!W&&!I&&A&&!_&&!h){var Z=new Object;Z.id_event=i.id_event,Z.type="checkout",O("Registrar Salida","¿Completaste tu entrega?",o+"api/admin/route/record_check_date.php",function(C){C.minutes&&N("Tiempo por parada","Completaste la parada en "+C.minutes+" minutos.")},Z)}}const K=async W=>new Promise(Z=>{const C=new FileReader;C.onload=F=>{const D=new Image;D.src=F.target.result,D.onload=()=>{const B=document.createElement("canvas"),$=B.getContext("2d"),ee=800,j=600;let Q=D.width,te=D.height;Q>ee&&(te*=ee/Q,Q=ee),te>j&&(Q*=j/te,te=j),B.width=Q,B.height=te,$.drawImage(D,0,0,Q,te),B.toBlob(he=>{Z(he)},"image/jpeg",.7)}},C.readAsDataURL(W)}),Y=()=>{n.dismiss({data:Date.now()})},X=async()=>{try{if(z(),await fe()){const Z={id_route:i.id_route,id_event:i.id_event,comments:d.value,img:k,img_id:E,lat:u.latitude,lon:u.longitude,...p==="0"&&{approve:"0"},..._&&{isLast:!0},...h&&_==!0&&{destiny:!0}};Z.img&&Z.img_id?y(`${o}api/admin/evidence/send_evidence.php`,function(C){if(C.success==!0){const F=Z.id_route;Y(),_&&ie("","",F,_)}else N("Carga fallida","Actualiza la página y vuelve a intentar cargar la información!")},Z):i.img?Y():N("Información incompleta","Cargar evidencia fotográfica faltante para completar parada.")}else N("Ubicación faltante","Asegúrate darle permisos a Rutaflow para acceder a tu ubicación")}catch(W){console.error("Error fetching data:",W)}},ie=(W,Z,C,F)=>{n.componentProps.routeId=C,n.componentProps.driverId=i.id_driver,He("modal-km-gas",Qt,{checklist:W,driverId:Z,routeId:C,isLast:F}).then(D=>{})},fe=async()=>navigator.geolocation?new Promise((W,Z)=>{navigator.geolocation.getCurrentPosition(C=>{u.latitude=C.coords.latitude,u.longitude=C.coords.longitude,W(!0)},C=>{console.error("Error getting location:",C),W(!1)})}):(console.error("Geolocation is not supported by your browser"),!1);async function de(W){W.stopPropagation();const Z=new FormData;Z.append("client_phone",M),Z.append("client_name",i.title),Z.append("delivery_phone",i.client_phone),Z.append("enterprise_name",i.enterprise_name);try{const C=await fetch(`${o}api/admin/message_central/send_sms.php`,{method:"POST",body:Z});if(C.ok){const F=await C.json();N("SMS enviado","Se envío correctamente un SMS a "+i.title+" con número de teléfono: "+M)}else N("SMS no enviado","Hubo un error al enviar SMS a "+i.title+" con número de teléfono: "+phoneNumber0+". Por favor contacte a soporte.")}catch(C){console.error("Error during file upload:",C)}}const se=async()=>{if(i.id_enterprise){const W=new FormData;W.append("id_enterprise",i.id_enterprise);try{const Z=await fetch(`${o}api/admin/enterprise/enterprise_settings.php`,{method:"POST",body:W});Z.ok?(f=(await Z.json()).nodos,p=wt("stops_wait_approval",f),t(2,g=wt("sms_active",f))):console.error("File upload failed:",Z.statusText)}catch(Z){console.error("Error during file upload:",Z)}}};function Ee(){t(4,I=!1),t(5,A=!0),ke(i.id_event,"checkin")}function Ne(){t(5,A=!1),t(4,I=!1),ke(i.id_event,"checkout")}async function ke(W,Z){if(Z){const C=new FormData;C.append("type",Z),C.append("id_event",W);try{const F=await fetch(`${o}api/admin/route/record_check_date.php`,{method:"POST",body:C});if(F.ok){const D=await F.json();D.minutes&&N("Tiempo por parada","Completaste la parada en "+D.minutes+" minutos.")}else console.error("File upload failed:",F.statusText)}catch(F){console.error("Error during file upload:",F)}finally{}}}function Te(W){Me[W?"unshift":"push"](()=>{U=W,t(9,U)})}function Le(W){Me[W?"unshift":"push"](()=>{d=W,t(0,d)})}return[d,k,g,b,I,A,M,q,R,U,i,_,h,S,H,Y,X,de,Ee,Ne,Te,Le]}class Lt extends We{constructor(e){super(),Xe(this,e,Zn,Qn,Ke,{},null,[-1,-1])}}function Mt(l){let e;return{c(){e=s("ion-spinner"),this.h()},l(t){e=c(t,"ION-SPINNER",{name:!0}),v(e).forEach(a),this.h()},h(){m(e,"name","dots")},m(t,o){V(t,e,o)},d(t){t&&a(e)}}}function St(l){let e,t,o;return{c(){e=s("section"),t=s("ion-img"),this.h()},l(n){e=c(n,"SECTION",{});var i=v(e);t=c(i,"ION-IMG",{src:!0,alt:!0,style:!0}),v(t).forEach(a),i.forEach(a),this.h()},h(){ot(t.src,o=l[0])||m(t,"src",o),m(t,"alt","Evidencia fotográfica"),G(t,"max-width","100%"),G(t,"margin-top","16px")},m(n,i){V(n,e,i),r(e,t)},p(n,i){i&1&&!ot(t.src,o=n[0])&&m(t,"src",o)},d(n){n&&a(e)}}}function xn(l){let e,t,o,n,i="Cancelar",_,h,d="AGREGAR GASTO",k,E,u,f,p,g,b,I,A,M,q,R,U,y,P,N,O,S,H='Tipo de pago <ion-text color="danger">(Obligatorio)</ion-text>',z,K,Y="Efectivo",X,ie,fe="Tarjeta",de,se,Ee="Transferencia",Ne,ke,Te,Le,W,Z,C,F,D,B,$=`<ion-icon icon="${Jt}" slot="start"></ion-icon>
                        Subir Evidencia`,ee,j,Q,te,he,pe,_e,ue,T="Confirmar",J,me,ce=l[5]&&Mt(),le=l[0]&&St(l);return{c(){e=s("ion-header"),t=s("ion-toolbar"),o=s("ion-buttons"),n=s("ion-button"),n.textContent=i,_=w(),h=s("ion-title"),h.textContent=d,k=w(),E=s("ion-content"),u=s("ion-list"),f=s("ion-item"),p=s("ion-icon"),g=w(),b=s("ion-input"),I=w(),A=s("ion-item"),M=s("ion-icon"),q=w(),R=s("ion-input"),U=w(),y=s("ion-item"),P=s("ion-icon"),N=w(),O=s("ion-select"),S=s("div"),S.innerHTML=H,z=w(),K=s("ion-select-option"),K.textContent=Y,X=w(),ie=s("ion-select-option"),ie.textContent=fe,de=w(),se=s("ion-select-option"),se.textContent=Ee,Ne=w(),ke=s("ion-item"),Te=s("ion-icon"),Le=w(),W=s("ion-textarea"),Z=w(),C=s("section"),F=s("label"),D=s("ion-button"),B=s("label"),B.innerHTML=$,ee=w(),j=s("input"),Q=w(),ce&&ce.c(),te=w(),le&&le.c(),he=w(),pe=s("ion-footer"),_e=s("ion-toolbar"),ue=s("ion-button"),ue.textContent=T,this.h()},l(re){e=c(re,"ION-HEADER",{translucent:!0});var ne=v(e);t=c(ne,"ION-TOOLBAR",{});var Ce=v(t);o=c(Ce,"ION-BUTTONS",{slot:!0});var we=v(o);n=c(we,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),oe(n)!=="svelte-1f8rjcf"&&(n.textContent=i),we.forEach(a),_=L(Ce),h=c(Ce,"ION-TITLE",{title:!0,"data-svelte-h":!0}),oe(h)!=="svelte-efps2s"&&(h.textContent=d),Ce.forEach(a),ne.forEach(a),k=L(re),E=c(re,"ION-CONTENT",{fullscreen:!0});var Ie=v(E);u=c(Ie,"ION-LIST",{});var ve=v(u);f=c(ve,"ION-ITEM",{});var Pe=v(f);p=c(Pe,"ION-ICON",{icon:!0,slot:!0}),v(p).forEach(a),g=L(Pe),b=c(Pe,"ION-INPUT",{label:!0,type:!0,placeholder:!0,value:!0}),v(b).forEach(a),Pe.forEach(a),I=L(ve),A=c(ve,"ION-ITEM",{});var Ve=v(A);M=c(Ve,"ION-ICON",{icon:!0,slot:!0}),v(M).forEach(a),q=L(Ve),R=c(Ve,"ION-INPUT",{label:!0,type:!0,value:!0}),v(R).forEach(a),Ve.forEach(a),U=L(ve),y=c(ve,"ION-ITEM",{});var $e=v(y);P=c($e,"ION-ICON",{icon:!0,slot:!0}),v(P).forEach(a),N=L($e),O=c($e,"ION-SELECT",{placeholder:!0,value:!0});var Re=v(O);S=c(Re,"DIV",{slot:!0,"data-svelte-h":!0}),oe(S)!=="svelte-wl764p"&&(S.innerHTML=H),z=L(Re),K=c(Re,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),oe(K)!=="svelte-i9crym"&&(K.textContent=Y),X=L(Re),ie=c(Re,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),oe(ie)!=="svelte-fx0z11"&&(ie.textContent=fe),de=L(Re),se=c(Re,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),oe(se)!=="svelte-1c24jf2"&&(se.textContent=Ee),Re.forEach(a),$e.forEach(a),Ne=L(ve),ke=c(ve,"ION-ITEM",{});var et=v(ke);Te=c(et,"ION-ICON",{icon:!0,slot:!0}),v(Te).forEach(a),Le=L(et),W=c(et,"ION-TEXTAREA",{label:!0,placeholder:!0}),v(W).forEach(a),et.forEach(a),Z=L(ve),C=c(ve,"SECTION",{});var dt=v(C);F=c(dt,"LABEL",{for:!0,style:!0});var ht=v(F);D=c(ht,"ION-BUTTON",{fill:!0,size:!0,class:!0,expand:!0});var tt=v(D);B=c(tt,"LABEL",{for:!0,style:!0,"data-svelte-h":!0}),oe(B)!=="svelte-1m9yw22"&&(B.innerHTML=$),ee=L(tt),j=c(tt,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0}),tt.forEach(a),ht.forEach(a),dt.forEach(a),Q=L(ve),ce&&ce.l(ve),te=L(ve),le&&le.l(ve),ve.forEach(a),Ie.forEach(a),he=L(re),pe=c(re,"ION-FOOTER",{});var pt=v(pe);_e=c(pt,"ION-TOOLBAR",{});var mt=v(_e);ue=c(mt,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),oe(ue)!=="svelte-1c7dl3f"&&(ue.textContent=T),mt.forEach(a),pt.forEach(a),this.h()},h(){m(n,"color","medium"),m(o,"slot","start"),m(h,"title",""),m(e,"translucent",""),m(p,"icon",Xt),m(p,"slot","start"),m(b,"label","Concepto"),m(b,"type","text"),m(b,"placeholder","Escribe aquí..."),m(b,"value",l[6]?l[6]:""),m(M,"icon",at),m(M,"slot","start"),m(R,"label","Cantidad"),m(R,"type","number"),m(R,"value",l[7]?l[7]:""),m(P,"icon",vn),m(P,"slot","start"),x(S,"slot","label"),m(K,"value","cash"),m(ie,"value","card"),m(se,"value","transfer"),m(O,"placeholder","Tipo de pago"),m(O,"value",l[8]?l[8]:""),m(Te,"icon",at),m(Te,"slot","start"),m(W,"label","Comentarios"),m(W,"placeholder","Escribe aquí..."),x(B,"for","eventEvidence"),G(B,"width","100%"),G(B,"padding","8px"),G(j,"display","none"),x(j,"id","eventEvidence"),x(j,"name","fileToUpload"),x(j,"type","file"),x(j,"accept","image/*"),m(D,"fill","outline"),m(D,"size","small"),m(D,"class","loadEvidence"),m(D,"expand","block"),x(F,"for","eventEvidence"),G(F,"display","block"),G(F,"width","100%"),m(E,"fullscreen",""),m(ue,"fill","outline"),m(ue,"color","tertiary"),m(ue,"strong",""),G(ue,"width","99%"),G(ue,"height","auto")},m(re,ne){V(re,e,ne),r(e,t),r(t,o),r(o,n),r(t,_),r(t,h),V(re,k,ne),V(re,E,ne),r(E,u),r(u,f),r(f,p),r(f,g),r(f,b),l[12](b),r(u,I),r(u,A),r(A,M),r(A,q),r(A,R),l[13](R),r(u,U),r(u,y),r(y,P),r(y,N),r(y,O),r(O,S),r(O,z),r(O,K),r(O,X),r(O,ie),r(O,de),r(O,se),l[14](O),r(u,Ne),r(u,ke),r(ke,Te),r(ke,Le),r(ke,W),l[15](W),r(u,Z),r(u,C),r(C,F),r(F,D),r(D,B),r(D,ee),r(D,j),r(u,Q),ce&&ce.m(u,null),r(u,te),le&&le.m(u,null),V(re,he,ne),V(re,pe,ne),r(pe,_e),r(_e,ue),J||(me=[ae(n,"click",l[10]),ae(j,"change",l[9]),ae(ue,"click",l[11])],J=!0)},p(re,[ne]){re[5]?ce||(ce=Mt(),ce.c(),ce.m(u,te)):ce&&(ce.d(1),ce=null),re[0]?le?le.p(re,ne):(le=St(re),le.c(),le.m(u,null)):le&&(le.d(1),le=null)},i:Oe,o:Oe,d(re){re&&(a(e),a(k),a(E),a(he),a(pe)),l[12](null),l[13](null),l[14](null),l[15](null),ce&&ce.d(),le&&le.d(),J=!1,Be(me)}}}function $n(l,e,t){let o=it,n=document.querySelector("ion-modal"),i=n.componentProps.routeId,_=n.componentProps.ex_concept,h=n.componentProps.ex_amount,d=n.componentProps.ex_type,k=n.componentProps.id_expense,E="",u="",f="",p=0,g="",b="",I=!1;Ye(()=>{});const A=async(S,H)=>{await(await qe.create({header:S,message:H,buttons:[{text:"Cerrar"}]})).present()},M=async S=>{t(5,I=!0);const z=S.target.files[0],K=await q(z);if(K){const Y=new FormData;Y.append("fileToUpload",K);try{const X=await fetch(`${o}api/admin/manager/upload_img_driver.php`,{method:"POST",body:Y});if(X.ok){const ie=await X.json();t(0,E=ie.img),u=ie.img_id}else console.error("File upload failed:",X.statusText)}catch(X){console.error("Error during file upload:",X)}finally{t(5,I=!1)}}},q=async S=>new Promise(H=>{const z=new FileReader;z.onload=K=>{const Y=new Image;Y.src=K.target.result,Y.onload=()=>{const X=document.createElement("canvas"),ie=X.getContext("2d"),fe=800,de=600;let se=Y.width,Ee=Y.height;se>fe&&(Ee*=fe/se,se=fe),Ee>de&&(se*=de/Ee,Ee=de),X.width=se,X.height=Ee,ie.drawImage(Y,0,0,se,Ee),X.toBlob(Ne=>{H(Ne)},"image/jpeg",.7)}},z.readAsDataURL(S)}),R=()=>{xe.dismiss()},U=()=>{var S=new Object;S.id_route=i,S.comments=g.value,S.type=f.value,S.img=E,S.img_id=u,S.amount=p.value,S.concept=b.value,S.status="done",S.id_expense=k||"null";const H=new FormData;for(const z in S)H.append(z,S[z]);!u||!E||!g.value||!p.value||!b.value?A("Datos incompletos","Llena los datos requeridos para completar el registro"):fetch(`${o}api/admin/expenses/add_expense.php`,{method:"POST",body:H}).then(z=>z.json()).then(z=>{R()}).catch(z=>{console.error("Error fetching data:",z)})};function y(S){Me[S?"unshift":"push"](()=>{b=S,t(4,b)})}function P(S){Me[S?"unshift":"push"](()=>{p=S,t(2,p)})}function N(S){Me[S?"unshift":"push"](()=>{f=S,t(1,f)})}function O(S){Me[S?"unshift":"push"](()=>{g=S,t(3,g)})}return[E,f,p,g,b,I,_,h,d,M,R,U,y,P,N,O]}class ct extends We{constructor(e){super(),Xe(this,e,$n,xn,Ke,{})}}function At(l,e,t){const o=l.slice();return o[7]=e[t],o}function eo(l){let e,t="Cargar gasto",o,n;function i(..._){return l[4](l[7],..._)}return{c(){e=s("ion-button"),e.textContent=t,this.h()},l(_){e=c(_,"ION-BUTTON",{fill:!0,size:!0,"aria-selected":!0,"data-svelte-h":!0}),oe(e)!=="svelte-175aelj"&&(e.textContent=t),this.h()},h(){m(e,"fill","outline"),m(e,"size","small"),m(e,"aria-selected","")},m(_,h){V(_,e,h),o||(n=ae(e,"click",i),o=!0)},p(_,h){l=_},d(_){_&&a(e),o=!1,n()}}}function to(l){let e,t="Gasto completado";return{c(){e=s("ion-button"),e.textContent=t,this.h()},l(o){e=c(o,"ION-BUTTON",{fill:!0,size:!0,"aria-selected":!0,"data-svelte-h":!0}),oe(e)!=="svelte-tlger7"&&(e.textContent=t),this.h()},h(){m(e,"fill","solid"),m(e,"size","small"),m(e,"aria-selected","")},m(o,n){V(o,e,n)},p:Oe,d(o){o&&a(e)}}}function Dt(l,e){let t,o,n,i=e[7].concept+"",_,h,d;function k(f,p){return f[7].status=="done"?to:eo}let u=k(e)(e);return{key:l,first:null,c(){t=s("ion-item"),o=s("ion-label"),n=s("p"),_=ge(i),h=w(),u.c(),d=w(),this.h()},l(f){t=c(f,"ION-ITEM",{});var p=v(t);o=c(p,"ION-LABEL",{style:!0});var g=v(o);n=c(g,"P",{style:!0});var b=v(n);_=be(b,i),b.forEach(a),g.forEach(a),h=L(p),u.l(p),d=L(p),p.forEach(a),this.h()},h(){G(n,"margin-left","10px"),G(o,"display","flex"),this.first=t},m(f,p){V(f,t,p),r(t,o),r(o,n),r(n,_),r(t,h),u.m(t,null),r(t,d)},p(f,p){e=f,u.p(e,p)},d(f){f&&a(t),u.d()}}}function no(l){let e,t,o,n,i=`<ion-icon style="font-size: 25px!important;" icon="${gn}"></ion-icon>`,_,h,d="LISTA DE GASTOS",k,E,u,f=[],p=new Map,g,b,I,A="Cerrar",M,q,R=ze(l[0]);const U=y=>y[7].id_expenses;for(let y=0;y<R.length;y+=1){let P=At(l,R,y),N=U(P);p.set(N,f[y]=Dt(N,P))}return{c(){e=s("ion-header"),t=s("ion-toolbar"),o=s("ion-buttons"),n=s("ion-button"),n.innerHTML=i,_=w(),h=s("ion-title"),h.textContent=d,k=w(),E=s("ion-content"),u=s("ion-list");for(let y=0;y<f.length;y+=1)f[y].c();g=w(),b=s("ion-footer"),I=s("ion-button"),I.textContent=A,this.h()},l(y){e=c(y,"ION-HEADER",{translucent:!0});var P=v(e);t=c(P,"ION-TOOLBAR",{});var N=v(t);o=c(N,"ION-BUTTONS",{slot:!0});var O=v(o);n=c(O,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),oe(n)!=="svelte-160xz3i"&&(n.innerHTML=i),O.forEach(a),_=L(N),h=c(N,"ION-TITLE",{"data-svelte-h":!0}),oe(h)!=="svelte-1phn90x"&&(h.textContent=d),N.forEach(a),P.forEach(a),k=L(y),E=c(y,"ION-CONTENT",{fullscreen:!0});var S=v(E);u=c(S,"ION-LIST",{});var H=v(u);for(let K=0;K<f.length;K+=1)f[K].l(H);H.forEach(a),S.forEach(a),g=L(y),b=c(y,"ION-FOOTER",{});var z=v(b);I=c(z,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),oe(I)!=="svelte-zv7v83"&&(I.textContent=A),z.forEach(a),this.h()},h(){m(n,"color","medium"),m(o,"slot","end"),m(e,"translucent",""),m(E,"fullscreen",""),m(I,"fill","outline"),m(I,"color","tertiary"),m(I,"strong",""),G(I,"width","99%"),G(I,"height","auto")},m(y,P){V(y,e,P),r(e,t),r(t,o),r(o,n),r(t,_),r(t,h),V(y,k,P),V(y,E,P),r(E,u);for(let N=0;N<f.length;N+=1)f[N]&&f[N].m(u,null);V(y,g,P),V(y,b,P),r(b,I),M||(q=[ae(n,"click",l[3]),ae(I,"click",l[1])],M=!0)},p(y,[P]){P&5&&(R=ze(y[0]),f=Qe(f,P,U,1,y,R,p,u,Ze,Dt,null,At))},i:Oe,o:Oe,d(y){y&&(a(e),a(k),a(E),a(g),a(b));for(let P=0;P<f.length;P+=1)f[P].d();M=!1,Be(q)}}}function oo(l){let e=document.querySelector("ion-modal");e.componentProps.routeId;let t=e.componentProps.expenses;Ye(()=>{});const o=()=>{xe.dismiss()};function n(h,d,k,E,u){e.componentProps.ex_amount=k,e.componentProps.ex_concept=d,e.componentProps.ex_type=E,e.componentProps.id_expense=u,He("modal-expense",ct,{amount:k,concept:d,type:E,id_expense:u}).then(()=>{}),o()}return[t,o,n,h=>{He("modal-expense",ct,{routeId:h}).then(d=>{}),o()},(h,d)=>n(d,h.concept,h.amount,h.type,h.id_expenses)]}class io extends We{constructor(e){super(),Xe(this,e,oo,no,Ke,{})}}const{document:Pt}=Tn;function zt(l,e,t){const o=l.slice();return o[40]=e[t],o[42]=t,o}function Bt(l,e,t){const o=l.slice();return o[40]=e[t],o[42]=t,o}function Ht(l,e,t){const o=l.slice();return o[40]=e[t],o[42]=t,o}function Rt(l){let e,t;return e=new kn({props:{$$slots:{default:[fo]},$$scope:{ctx:l}}}),{c(){on(e.$$.fragment)},l(o){ln(e.$$.fragment,o)},m(o,n){rn(e,o,n),t=!0},p(o,n){const i={};n[0]&1019|n[1]&16384&&(i.$$scope={dirty:n,ctx:o}),e.$set(i)},i(o){t||(nt(e.$$.fragment,o),t=!0)},o(o){rt(e.$$.fragment,o),t=!1},d(o){an(e,o)}}}function lo(l){let e,t='<div id="g_map" style="width: 100%; height: 100vh;"></div>';return{c(){e=s("ion-content"),e.innerHTML=t},l(o){e=c(o,"ION-CONTENT",{"data-svelte-h":!0}),oe(e)!=="svelte-1ydw6i9"&&(e.innerHTML=t)},m(o,n){V(o,e,n)},p:Oe,d(o){o&&a(e)}}}function ro(l){let e;function t(i,_){if(i[7].length>0)return so;if(!i[3])return ao}let o=t(l),n=o&&o(l);return{c(){n&&n.c(),e=Ae()},l(i){n&&n.l(i),e=Ae()},m(i,_){n&&n.m(i,_),V(i,e,_)},p(i,_){o===(o=t(i))&&n?n.p(i,_):(n&&n.d(1),n=o&&o(i),n&&(n.c(),n.m(e.parentNode,e)))},d(i){i&&a(e),n&&n.d(i)}}}function ao(l){let e,t,o,n='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Jala para actualizar" refreshing-spinner="circles" refreshing-text="Actualizando..."></ion-refresher-content>',i,_,h=[],d=new Map,k,E,u=l[4]&&Ut(l),f=ze(l[5]);const p=g=>g[40].id_event;for(let g=0;g<f.length;g+=1){let b=zt(l,f,g),I=p(b);d.set(I,h[g]=qt(I,b))}return{c(){u&&u.c(),e=w(),t=s("ion-content"),o=s("ion-refresher"),o.innerHTML=n,i=w(),_=s("ion-list");for(let g=0;g<h.length;g+=1)h[g].c();this.h()},l(g){u&&u.l(g),e=L(g),t=c(g,"ION-CONTENT",{});var b=v(t);o=c(b,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),oe(o)!=="svelte-1srnbs3"&&(o.innerHTML=n),i=L(b),_=c(b,"ION-LIST",{});var I=v(_);for(let A=0;A<h.length;A+=1)h[A].l(I);I.forEach(a),b.forEach(a),this.h()},h(){m(o,"slot","fixed")},m(g,b){u&&u.m(g,b),V(g,e,b),V(g,t,b),r(t,o),l[29](o),r(t,i),r(t,_);for(let I=0;I<h.length;I+=1)h[I]&&h[I].m(_,null);k||(E=ae(o,"ionRefresh",l[10]),k=!0)},p(g,b){g[4]?u?u.p(g,b):(u=Ut(g),u.c(),u.m(e.parentNode,e)):u&&(u.d(1),u=null),b[0]&856096&&(f=ze(g[5]),h=Qe(h,b,p,1,g,f,d,_,Ze,qt,null,zt))},d(g){g&&(a(e),a(t)),u&&u.d(g),l[29](null);for(let b=0;b<h.length;b+=1)h[b].d();k=!1,E()}}}function so(l){let e,t;function o(_,h){return h[0]&144&&(e=null),e==null&&(e=!!(_[7].filter(ho).every(po)&&!_[4])),e?uo:co}let n=o(l,[-1,-1]),i=n(l);return{c(){i.c(),t=Ae()},l(_){i.l(_),t=Ae()},m(_,h){i.m(_,h),V(_,t,h)},p(_,h){n===(n=o(_,h))&&i?i.p(_,h):(i.d(1),i=n(_),i&&(i.c(),i.m(t.parentNode,t)))},d(_){_&&a(t),i.d(_)}}}function Ut(l){let e=l[14]("",l[1],l[0])+"",t;return{c(){t=ge(e)},l(o){t=be(o,e)},m(o,n){V(o,t,n)},p(o,n){n[0]&3&&e!==(e=o[14]("",o[1],o[0])+"")&&ye(t,e)},d(o){o&&a(t)}}}function Ft(l){let e;return{c(){e=s("span"),this.h()},l(t){e=c(t,"SPAN",{class:!0}),v(e).forEach(a),this.h()},h(){x(e,"class","notes svelte-egzizz")},m(t,o){V(t,e,o)},d(t){t&&a(e)}}}function qt(l,e){let t,o,n,i,_=parseInt(e[40].pos)+1+"",h,d,k,E,u,f,p=e[40].title+"",g,b,I=e[40].support_list&&e[40].support_list.length||e[16](e[40]),A,M,q,R,U,y=I&&Ft();function P(){return e[30](e[40],e[42])}return{key:l,first:null,c(){t=s("ion-item"),o=s("ion-avatar"),n=s("div"),i=s("div"),h=ge(_),k=w(),E=s("ion-label"),u=s("ion-text"),f=s("h3"),g=ge(p),b=w(),y&&y.c(),A=w(),M=s("ion-icon"),q=w(),this.h()},l(N){t=c(N,"ION-ITEM",{});var O=v(t);o=c(O,"ION-AVATAR",{slot:!0});var S=v(o);n=c(S,"DIV",{class:!0,title:!0,style:!0});var H=v(n);i=c(H,"DIV",{class:!0});var z=v(i);h=be(z,_),z.forEach(a),H.forEach(a),S.forEach(a),k=L(O),E=c(O,"ION-LABEL",{button:!0});var K=v(E);u=c(K,"ION-TEXT",{color:!0});var Y=v(u);f=c(Y,"H3",{});var X=v(f);g=be(X,p),b=L(X),y&&y.l(X),X.forEach(a),Y.forEach(a),K.forEach(a),A=L(O),M=c(O,"ION-ICON",{icon:!0,slot:!0,style:!0}),v(M).forEach(a),q=L(O),O.forEach(a),this.h()},h(){x(i,"class","order svelte-egzizz"),x(n,"class","order-wrapper svelte-egzizz"),x(n,"title",d=Ge(e[40].status)),G(n,"background-color",Se(e[40].status,e[40].date_service)),G(n,"color",De(Se(e[40].status))),m(o,"slot","start"),m(u,"color","#2e2e2e"),m(E,"button",""),m(M,"icon",Ue),m(M,"slot","end"),G(M,"color",Se(e[40].status,e[40].date_service)),this.first=t},m(N,O){V(N,t,O),r(t,o),r(o,n),r(n,i),r(i,h),r(t,k),r(t,E),r(E,u),r(u,f),r(f,g),r(f,b),y&&y.m(f,null),r(t,A),r(t,M),r(t,q),R||(U=ae(E,"click",P),R=!0)},p(N,O){e=N,O[0]&32&&_!==(_=parseInt(e[40].pos)+1+"")&&ye(h,_),O[0]&32&&d!==(d=Ge(e[40].status))&&x(n,"title",d),O[0]&32&&G(n,"background-color",Se(e[40].status,e[40].date_service)),O[0]&32&&G(n,"color",De(Se(e[40].status))),O[0]&32&&p!==(p=e[40].title+"")&&ye(g,p),O[0]&32&&(I=e[40].support_list&&e[40].support_list.length||e[16](e[40])),I?y||(y=Ft(),y.c(),y.m(f,null)):y&&(y.d(1),y=null),O[0]&32&&G(M,"color",Se(e[40].status,e[40].date_service))},d(N){N&&a(t),y&&y.d(),R=!1,U()}}}function co(l){let e=l[14](l[7],l[1],l[0])+"",t,o,n,i,_='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Pull to refresh" refreshing-spinner="circles" refreshing-text="Refreshing..."></ion-refresher-content>',h,d,k=[],E=new Map,u,f,p=ze(l[5]);const g=b=>b[40].id_event;for(let b=0;b<p.length;b+=1){let I=Bt(l,p,b),A=g(I);E.set(A,k[b]=jt(A,I))}return{c(){t=ge(e),o=w(),n=s("ion-content"),i=s("ion-refresher"),i.innerHTML=_,h=w(),d=s("ion-list");for(let b=0;b<k.length;b+=1)k[b].c();this.h()},l(b){t=be(b,e),o=L(b),n=c(b,"ION-CONTENT",{});var I=v(n);i=c(I,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),oe(i)!=="svelte-dvt1s"&&(i.innerHTML=_),h=L(I),d=c(I,"ION-LIST",{});var A=v(d);for(let M=0;M<k.length;M+=1)k[M].l(A);A.forEach(a),I.forEach(a),this.h()},h(){m(i,"slot","fixed")},m(b,I){V(b,t,I),V(b,o,I),V(b,n,I),r(n,i),l[27](i),r(n,h),r(n,d);for(let A=0;A<k.length;A+=1)k[A]&&k[A].m(d,null);u||(f=ae(i,"ionRefresh",l[10]),u=!0)},p(b,I){I[0]&131&&e!==(e=b[14](b[7],b[1],b[0])+"")&&ye(t,e),I[0]&856096&&(p=ze(b[5]),k=Qe(k,I,g,1,b,p,E,d,Ze,jt,null,Bt))},d(b){b&&(a(t),a(o),a(n)),l[27](null);for(let I=0;I<k.length;I+=1)k[I].d();u=!1,f()}}}function uo(l){let e,t,o='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Jale para actualizar" refreshing-spinner="circles" refreshing-text="Actualizando..."></ion-refresher-content>',n,i,_,h,d,k,E="0",u,f,p,g,b,I=l[6].origin+"",A,M,q,R="",U,y,P,N=[],O=new Map,S,H,z,K,Y,X=l[5].length+1+"",ie,fe,de,se,Ee,Ne,ke=l[6].destination+"",Te,Le,W,Z="",C,F,D,B,$=ze(l[5]);const ee=j=>j[40].id_event;for(let j=0;j<$.length;j+=1){let Q=Ht(l,$,j),te=ee(Q);O.set(te,N[j]=Kt(te,Q))}return{c(){e=s("ion-content"),t=s("ion-refresher"),t.innerHTML=o,n=w(),i=s("ion-list"),_=s("ion-item"),h=s("ion-avatar"),d=s("div"),k=s("div"),k.textContent=E,f=w(),p=s("ion-label"),g=s("ion-text"),b=s("h3"),A=ge(I),M=w(),q=s("div"),q.innerHTML=R,U=w(),y=s("ion-icon"),P=w();for(let j=0;j<N.length;j+=1)N[j].c();S=w(),H=s("ion-item"),z=s("ion-avatar"),K=s("div"),Y=s("div"),ie=ge(X),de=w(),se=s("ion-label"),Ee=s("ion-text"),Ne=s("h3"),Te=ge(ke),Le=w(),W=s("div"),W.innerHTML=Z,C=w(),F=s("ion-icon"),this.h()},l(j){e=c(j,"ION-CONTENT",{});var Q=v(e);t=c(Q,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),oe(t)!=="svelte-15ukrgn"&&(t.innerHTML=o),n=L(Q),i=c(Q,"ION-LIST",{});var te=v(i);_=c(te,"ION-ITEM",{});var he=v(_);h=c(he,"ION-AVATAR",{slot:!0});var pe=v(h);d=c(pe,"DIV",{class:!0,title:!0,style:!0});var _e=v(d);k=c(_e,"DIV",{class:!0,"data-svelte-h":!0}),oe(k)!=="svelte-3lvlrb"&&(k.textContent=E),_e.forEach(a),pe.forEach(a),f=L(he),p=c(he,"ION-LABEL",{button:!0});var ue=v(p);g=c(ue,"ION-TEXT",{color:!0});var T=v(g);b=c(T,"H3",{});var J=v(b);A=be(J,I),J.forEach(a),T.forEach(a),M=L(ue),q=c(ue,"DIV",{class:!0,"data-svelte-h":!0}),oe(q)!=="svelte-gz9kb"&&(q.innerHTML=R),ue.forEach(a),U=L(he),y=c(he,"ION-ICON",{icon:!0,slot:!0}),v(y).forEach(a),he.forEach(a),P=L(te);for(let Ie=0;Ie<N.length;Ie+=1)N[Ie].l(te);S=L(te),H=c(te,"ION-ITEM",{});var me=v(H);z=c(me,"ION-AVATAR",{slot:!0});var ce=v(z);K=c(ce,"DIV",{class:!0,title:!0,style:!0});var le=v(K);Y=c(le,"DIV",{class:!0});var re=v(Y);ie=be(re,X),re.forEach(a),le.forEach(a),ce.forEach(a),de=L(me),se=c(me,"ION-LABEL",{button:!0});var ne=v(se);Ee=c(ne,"ION-TEXT",{color:!0});var Ce=v(Ee);Ne=c(Ce,"H3",{});var we=v(Ne);Te=be(we,ke),we.forEach(a),Ce.forEach(a),Le=L(ne),W=c(ne,"DIV",{class:!0,"data-svelte-h":!0}),oe(W)!=="svelte-130ohbs"&&(W.innerHTML=Z),ne.forEach(a),C=L(me),F=c(me,"ION-ICON",{icon:!0,slot:!0}),v(F).forEach(a),me.forEach(a),te.forEach(a),Q.forEach(a),this.h()},h(){m(t,"slot","fixed"),x(k,"class","order svelte-egzizz"),x(d,"class","order-wrapper svelte-egzizz"),x(d,"title",u="$"+l[6].origin),G(d,"background-color",l[6].color),G(d,"color",De(l[6].color)),m(h,"slot","start"),m(g,"color","#2e2e2e"),x(q,"class","sub svelte-egzizz"),m(p,"button",""),m(y,"icon",Ue),m(y,"slot","end"),x(Y,"class","order svelte-egzizz"),x(K,"class","order-wrapper svelte-egzizz"),x(K,"title",fe="$"+l[6].destination),G(K,"background-color",l[6].color),G(K,"color",De(l[6].color)),m(z,"slot","start"),m(Ee,"color","#2e2e2e"),x(W,"class","sub svelte-egzizz"),m(se,"button",""),m(F,"icon",Ue),m(F,"slot","end")},m(j,Q){V(j,e,Q),r(e,t),l[23](t),r(e,n),r(e,i),r(i,_),r(_,h),r(h,d),r(d,k),r(_,f),r(_,p),r(p,g),r(g,b),r(b,A),r(p,M),r(p,q),r(_,U),r(_,y),r(i,P);for(let te=0;te<N.length;te+=1)N[te]&&N[te].m(i,null);r(i,S),r(i,H),r(H,z),r(z,K),r(K,Y),r(Y,ie),r(H,de),r(H,se),r(se,Ee),r(Ee,Ne),r(Ne,Te),r(se,Le),r(se,W),r(H,C),r(H,F),D||(B=[ae(t,"ionRefresh",l[10]),ae(p,"click",l[24]),ae(se,"click",l[26])],D=!0)},p(j,Q){Q[0]&64&&u!==(u="$"+j[6].origin)&&x(d,"title",u),Q[0]&64&&G(d,"background-color",j[6].color),Q[0]&64&&G(d,"color",De(j[6].color)),Q[0]&64&&I!==(I=j[6].origin+"")&&ye(A,I),Q[0]&331808&&($=ze(j[5]),N=Qe(N,Q,ee,1,j,$,O,i,Ze,Kt,S,Ht)),Q[0]&32&&X!==(X=j[5].length+1+"")&&ye(ie,X),Q[0]&64&&fe!==(fe="$"+j[6].destination)&&x(K,"title",fe),Q[0]&64&&G(K,"background-color",j[6].color),Q[0]&64&&G(K,"color",De(j[6].color)),Q[0]&64&&ke!==(ke=j[6].destination+"")&&ye(Te,ke)},d(j){j&&a(e),l[23](null);for(let Q=0;Q<N.length;Q+=1)N[Q].d();D=!1,Be(B)}}}function Vt(l){let e;return{c(){e=s("span"),this.h()},l(t){e=c(t,"SPAN",{class:!0}),v(e).forEach(a),this.h()},h(){x(e,"class","notes svelte-egzizz")},m(t,o){V(t,e,o)},d(t){t&&a(e)}}}function jt(l,e){let t,o,n,i,_=parseInt(e[40].pos)+1+"",h,d,k,E,u,f,p=e[40].title+"",g,b,I=e[40].support_list&&e[40].support_list.length||e[16](e[40]),A,M,q="",R,U,y,P,N,O=I&&Vt();function S(){return e[28](e[40],e[42])}return{key:l,first:null,c(){t=s("ion-item"),o=s("ion-avatar"),n=s("div"),i=s("div"),h=ge(_),k=w(),E=s("ion-label"),u=s("ion-text"),f=s("h3"),g=ge(p),b=w(),O&&O.c(),A=w(),M=s("div"),M.innerHTML=q,R=w(),U=s("ion-icon"),y=w(),this.h()},l(H){t=c(H,"ION-ITEM",{});var z=v(t);o=c(z,"ION-AVATAR",{slot:!0});var K=v(o);n=c(K,"DIV",{class:!0,title:!0,style:!0});var Y=v(n);i=c(Y,"DIV",{class:!0});var X=v(i);h=be(X,_),X.forEach(a),Y.forEach(a),K.forEach(a),k=L(z),E=c(z,"ION-LABEL",{button:!0});var ie=v(E);u=c(ie,"ION-TEXT",{color:!0});var fe=v(u);f=c(fe,"H3",{});var de=v(f);g=be(de,p),b=L(de),O&&O.l(de),de.forEach(a),fe.forEach(a),A=L(ie),M=c(ie,"DIV",{class:!0,"data-svelte-h":!0}),oe(M)!=="svelte-qaecoo"&&(M.innerHTML=q),ie.forEach(a),R=L(z),U=c(z,"ION-ICON",{icon:!0,slot:!0}),v(U).forEach(a),y=L(z),z.forEach(a),this.h()},h(){x(i,"class","order svelte-egzizz"),x(n,"class","order-wrapper svelte-egzizz"),x(n,"title",d=Ge(e[40].status)),G(n,"background-color",Se(e[40].status,e[40].date_service)),G(n,"color",De(Se(e[40].status))),m(o,"slot","start"),m(u,"color","#2e2e2e"),x(M,"class","sub svelte-egzizz"),m(E,"button",""),m(U,"icon",Ue),m(U,"slot","end"),this.first=t},m(H,z){V(H,t,z),r(t,o),r(o,n),r(n,i),r(i,h),r(t,k),r(t,E),r(E,u),r(u,f),r(f,g),r(f,b),O&&O.m(f,null),r(E,A),r(E,M),r(t,R),r(t,U),r(t,y),P||(N=ae(E,"click",S),P=!0)},p(H,z){e=H,z[0]&32&&_!==(_=parseInt(e[40].pos)+1+"")&&ye(h,_),z[0]&32&&d!==(d=Ge(e[40].status))&&x(n,"title",d),z[0]&32&&G(n,"background-color",Se(e[40].status,e[40].date_service)),z[0]&32&&G(n,"color",De(Se(e[40].status))),z[0]&32&&p!==(p=e[40].title+"")&&ye(g,p),z[0]&32&&(I=e[40].support_list&&e[40].support_list.length||e[16](e[40])),I?O||(O=Vt(),O.c(),O.m(f,null)):O&&(O.d(1),O=null)},d(H){H&&a(t),O&&O.d(),P=!1,N()}}}function Gt(l){let e;return{c(){e=s("span"),this.h()},l(t){e=c(t,"SPAN",{class:!0}),v(e).forEach(a),this.h()},h(){x(e,"class","notes svelte-egzizz")},m(t,o){V(t,e,o)},d(t){t&&a(e)}}}function Kt(l,e){let t,o,n,i,_=parseInt(e[40].pos)+1+"",h,d,k,E,u,f,p=e[40].title+"",g,b,I=e[40].support_list&&e[40].support_list.length||e[16](e[40]),A,M,q="",R,U,y,P,N=I&&Gt();function O(){return e[25](e[40])}return{key:l,first:null,c(){t=s("ion-item"),o=s("ion-avatar"),n=s("div"),i=s("div"),h=ge(_),k=w(),E=s("ion-label"),u=s("ion-text"),f=s("h3"),g=ge(p),b=w(),N&&N.c(),A=w(),M=s("div"),M.innerHTML=q,R=w(),U=s("ion-icon"),this.h()},l(S){t=c(S,"ION-ITEM",{});var H=v(t);o=c(H,"ION-AVATAR",{slot:!0});var z=v(o);n=c(z,"DIV",{class:!0,title:!0,style:!0});var K=v(n);i=c(K,"DIV",{class:!0});var Y=v(i);h=be(Y,_),Y.forEach(a),K.forEach(a),z.forEach(a),k=L(H),E=c(H,"ION-LABEL",{button:!0});var X=v(E);u=c(X,"ION-TEXT",{color:!0});var ie=v(u);f=c(ie,"H3",{});var fe=v(f);g=be(fe,p),b=L(fe),N&&N.l(fe),fe.forEach(a),ie.forEach(a),A=L(X),M=c(X,"DIV",{class:!0,"data-svelte-h":!0}),oe(M)!=="svelte-qaecoo"&&(M.innerHTML=q),X.forEach(a),R=L(H),U=c(H,"ION-ICON",{icon:!0,slot:!0}),v(U).forEach(a),H.forEach(a),this.h()},h(){x(i,"class","order svelte-egzizz"),x(n,"class","order-wrapper svelte-egzizz"),x(n,"title",d=Ge(e[40].status)),G(n,"background-color",Se(e[40].status,e[40].date_service)),G(n,"color",De(Se(e[40].status))),m(o,"slot","start"),m(u,"color","#2e2e2e"),x(M,"class","sub svelte-egzizz"),m(E,"button",""),m(U,"icon",Ue),m(U,"slot","end"),this.first=t},m(S,H){V(S,t,H),r(t,o),r(o,n),r(n,i),r(i,h),r(t,k),r(t,E),r(E,u),r(u,f),r(f,g),r(f,b),N&&N.m(f,null),r(E,A),r(E,M),r(t,R),r(t,U),y||(P=ae(E,"click",O),y=!0)},p(S,H){e=S,H[0]&32&&_!==(_=parseInt(e[40].pos)+1+"")&&ye(h,_),H[0]&32&&d!==(d=Ge(e[40].status))&&x(n,"title",d),H[0]&32&&G(n,"background-color",Se(e[40].status,e[40].date_service)),H[0]&32&&G(n,"color",De(Se(e[40].status))),H[0]&32&&p!==(p=e[40].title+"")&&ye(g,p),H[0]&32&&(I=e[40].support_list&&e[40].support_list.length||e[16](e[40])),I?N||(N=Gt(),N.c(),N.m(f,null)):N&&(N.d(1),N=null)},d(S){S&&a(t),N&&N.d(),y=!1,P()}}}function fo(l){let e,t,o,n,i=`<ion-icon icon="${bn}"></ion-icon>`,_,h,d,k=`<ion-icon icon="${En}"></ion-icon>`,E,u,f=(l[6].name?l[6].name.toUpperCase():"")+"",p,g,b,I='<ion-segment-button value="list"><ion-label>Paradas</ion-label></ion-segment-button> <ion-segment-button value="map"><ion-label>Mapa</ion-label></ion-segment-button>',A,M,q,R;function U(N,O){if(N[9]==="list")return ro;if(N[9]==="map")return lo}let y=U(l),P=y&&y(l);return{c(){e=s("ion-header"),t=s("ion-toolbar"),o=s("ion-buttons"),n=s("ion-button"),n.innerHTML=i,_=w(),h=s("ion-buttons"),d=s("ion-button"),d.innerHTML=k,E=w(),u=s("ion-title"),p=ge(f),g=w(),b=s("ion-segment"),b.innerHTML=I,A=w(),P&&P.c(),M=Ae(),this.h()},l(N){e=c(N,"ION-HEADER",{translucent:!0});var O=v(e);t=c(O,"ION-TOOLBAR",{});var S=v(t);o=c(S,"ION-BUTTONS",{slot:!0});var H=v(o);n=c(H,"ION-BUTTON",{title:!0,alt:!0,"data-svelte-h":!0}),oe(n)!=="svelte-7ppz3r"&&(n.innerHTML=i),H.forEach(a),_=L(S),h=c(S,"ION-BUTTONS",{slot:!0});var z=v(h);d=c(z,"ION-BUTTON",{"data-svelte-h":!0}),oe(d)!=="svelte-nf50hj"&&(d.innerHTML=k),z.forEach(a),E=L(S),u=c(S,"ION-TITLE",{});var K=v(u);p=be(K,f),K.forEach(a),S.forEach(a),g=L(O),b=c(O,"ION-SEGMENT",{value:!0,"data-svelte-h":!0}),oe(b)!=="svelte-lue4c9"&&(b.innerHTML=I),O.forEach(a),A=L(N),P&&P.l(N),M=Ae(),this.h()},h(){m(n,"title","Atrás"),m(n,"alt","Atrás"),m(o,"slot","start"),m(h,"slot","end"),m(b,"value","list"),m(e,"translucent","")},m(N,O){V(N,e,O),r(e,t),r(t,o),r(o,n),r(t,_),r(t,h),r(h,d),r(t,E),r(t,u),r(u,p),r(e,g),r(e,b),V(N,A,O),P&&P.m(N,O),V(N,M,O),q||(R=[ae(n,"click",l[17]),ae(d,"click",l[21]),ae(b,"ionChange",l[22])],q=!0)},p(N,O){O[0]&64&&f!==(f=(N[6].name?N[6].name.toUpperCase():"")+"")&&ye(p,f),y===(y=U(N))&&P?P.p(N,O):(P&&P.d(1),P=y&&y(N),P&&(P.c(),P.m(M.parentNode,M)))},d(N){N&&(a(e),a(A),a(M)),P&&P.d(N),q=!1,Be(R)}}}function _o(l){let e,t,o,n=l[2]&&Rt(l);return{c(){e=w(),n&&n.c(),t=Ae(),this.h()},l(i){$t("svelte-kn0kph",Pt.head).forEach(a),e=L(i),n&&n.l(i),t=Ae(),this.h()},h(){Pt.title="Rutaflow - Detalles de ruta"},m(i,_){V(i,e,_),n&&n.m(i,_),V(i,t,_),o=!0},p(i,_){i[2]?n?(n.p(i,_),_[0]&4&&nt(n,1)):(n=Rt(i),n.c(),nt(n,1),n.m(t.parentNode,t)):n&&(sn(),rt(n,1,1,()=>{n=null}),nn())},i(i){o||(nt(n),o=!0)},o(i){rt(n),o=!1},d(i){i&&(a(e),a(t)),n&&n.d(i)}}}function Se(l,e=""){let t="#ffffff";return l==="pending"&&!e?t="#f2e300":l=="pending"&&e?t="#F6A833":l==="completed"&&(t="#44d900"),t}function Ge(l){let e="";return l=="pending"?e="Pendiente":l=="completed"&&(e="Completado"),e}function De(l){l.slice(0,1)==="#"&&(l=l.slice(1)),l.length===3&&(l=l.split("").map(function(i){return i+i}).join(""));const e=parseInt(l.substr(0,2),16),t=parseInt(l.substr(2,2),16),o=parseInt(l.substr(4,2),16);return(e*299+t*587+o*114)/1e3>=128?"#414040":"#fff"}const ho=l=>l.mandatory==="1",po=l=>l.img;function mo(l,e,t){let o;en(l,In,C=>t(20,o=C));var n=this&&this.__awaiter||function(C,F,D,B){function $(ee){return ee instanceof D?ee:new D(function(j){j(ee)})}return new(D||(D=Promise))(function(ee,j){function Q(pe){try{he(B.next(pe))}catch(_e){j(_e)}}function te(pe){try{he(B.throw(pe))}catch(_e){j(_e)}}function he(pe){pe.done?ee(pe.value):$(pe.value).then(Q,te)}he((B=B.apply(C,F||[])).next())})};let{routeId:i}=e,{driverId:_}=e,h=it,d=new Object,k=!0,E=!1,u=[],f={},p=[],g=[],b,I=!1,A="list",M;const q=()=>n(void 0,void 0,void 0,function*(){yield y(i),b.complete()});Ye(()=>n(void 0,void 0,void 0,function*(){yield y(i)}));function R(C){return n(this,void 0,void 0,function*(){if(t(9,A=C),A==="map"){yield tn(),M=document.getElementById("g_map");const F=new google.maps.Map(M,{zoom:8,center:{lat:20.6745683,lng:-103.3986104},mapId:"4504f8b37365c3d0"}),D=new google.maps.LatLngBounds,{AdvancedMarkerElement:B,PinElement:$}=yield google.maps.importLibrary("marker");navigator.geolocation?navigator.geolocation.getCurrentPosition(function(ee){const j=new google.maps.LatLng(ee.coords.latitude,ee.coords.longitude);new google.maps.Marker({position:j,map:F,icon:{path:google.maps.SymbolPath.CIRCLE,fillColor:"#0062ff",fillOpacity:1,scale:6,strokeColor:"#ffffff",strokeWeight:2}}),new google.maps.Circle({strokeColor:"#00BFFF",strokeOpacity:.5,strokeWeight:1,fillColor:"#00BFFF",fillOpacity:.2,map:F,center:j,radius:ee.coords.accuracy}),D.extend(j)},function(ee){console.error("Error retrieving location:",ee)}):console.error("Geolocation not supported by this browser."),U(D,F,{lat:f.lat1,lon:f.lon1,color:f.color,title:f.origin},{type:"icon",iconClass:"icon-home",title:"Origen",glyph:"0"}),U(D,F,{lat:f.lat2,lon:f.lon2,color:f.color,title:f.destination},{type:"icon",iconClass:"icon-flag",title:"Destino",glyph:String(u.length+1)}),u.forEach((ee,j)=>{const Q=parseFloat(ee.lat),te=parseFloat(ee.lon),he=new google.maps.LatLng(Q,te),pe=new google.maps.Marker({position:{lat:Q,lng:te},map:F,title:ee.title}),_e=new $({background:Se(ee.status,ee.date_service),borderColor:"#000",glyphColor:"#000",glyph:(parseInt(ee.pos)+1).toString()});new B({map:F,position:he,content:_e.element,title:"Parada "+(parseInt(ee.pos)+1).toString()+": "+ee.title}).addListener("click",function(T){N(ee,!1)}),D.extend(pe.getPosition())}),F.fitBounds(D)}})}function U(C,F,D,B){return n(this,void 0,void 0,function*(){let $;const ee=parseFloat(D.lat),j=parseFloat(D.lon),Q=new google.maps.LatLng(ee,j),{AdvancedMarkerElement:te,PinElement:he}=yield google.maps.importLibrary("marker");B.type=="icon"?($=document.createElement("i"),$.className=`${B.iconClass} icon`,$.style.fontSize="14px",$.style.color=De(D.color),$.style.fontWeight="600"):B.type=="text";const pe=new google.maps.Marker({position:{lat:ee,lng:j},map:F,title:`${B.title}. ${D.title}`}),_e=new he({background:D.color,borderColor:"#000",glyphColor:De(D.color),glyph:B.glyph});return new te({map:F,position:Q,content:_e.element,title:B.title+": "+D.title}).addListener("click",function(T){O(f,B.title=="Destino")}),pe})}function y(C){return n(this,void 0,void 0,function*(){const F=new FormData;F.append("id_route",C);try{const B=yield(yield fetch(`${h}api/admin/report/seguimiento_list.php`,{method:"POST",body:F})).json();t(6,f=B.data.seguimiento_list[0]),t(5,u=B.data.event_list),t(7,p=B.data.checklist),g=B.data.expenses,f&&t(4,E=f.km_inicial=="0"&&f.gas_inicial=="0"),t(3,k=!1)}catch(D){t(3,k=!1),console.error("Error fetching data:",D)}})}const P=C=>new Promise((F,D)=>{const B=new FormData;B.append("id_route",C.id_route),B.append("id_event",C.id_event),fetch(`${h}api/admin/evidence/evidence_by_event.php`,{method:"POST",body:B}).then($=>$.json()).then($=>{F($.data.event_evidence[0])}).catch($=>{console.error("Error fetching data:",$),D($)})}),N=(C,F)=>{P(C).then(D=>{D&&(C.img=D.img,C.driver_comments=D.driver_comments,C.comments=D.comments),He("modal-delivery-info",Lt,{delivery:C,isLast:F}).then(B=>{}).finally(()=>{y(i)})})},O=(C,F)=>{var D=new Object;F?D={title:C.destination,line1:C.dest_address}:D={title:C.origin,line1:C.origin_address},D.client_name=C.client_name,D.client_phone=C.tel,D.id_route=C.id_route;var B=!0;He("modal-delivery-info",Lt,{delivery:D,isLast:F,flag:B})},S=(C,F,D)=>{var B=!1;return I||(I=!0,He("modal-checklist",Qt,{checklist:C,driverId:F,routeId:D,isLast:B}).then($=>{I=!1}),K(D,"checklist")),""},H=C=>n(void 0,void 0,void 0,function*(){return yield y(C),g.length>0?He("modal-expense-detail",io,{routeId:C,expenses:g}).then(F=>{}):He("modal-expense",ct,{routeId:C}).then(F=>{}),""}),z=C=>{if(C.tracking_type=="subscription"){if(C.subscriber_info&&C.payment_type==="cash"&&new Date(C.subscriber_info.payment_next)<new Date)return!0}else if(C.tracking_type=="ecommerce"&&Number(C.payment_pending)>0)return!0;return!1};function K(C,F){let D=new FormData;return D.append("id_route",C),D.append("status",F),fetch(`${h}api/admin/route/change_status.php`,{method:"POST",body:D}).then(B=>B.json()).then(B=>{}).catch(B=>{console.error("Error fetching data:",B)}),""}const Y=()=>{d.type=="super"||d.type=="admin"?Fe("/drivers/me"):d.id_driver&&Fe(`/drivers/${d.id_driver}`)},X=(C,F)=>n(void 0,void 0,void 0,function*(){yield(yield qe.create({header:C||"Error",message:F||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()});function ie(C){return C===u.length-1}const fe=()=>H(i),de=C=>R(C.detail.value);function se(C){Me[C?"unshift":"push"](()=>{b=C,t(8,b)})}const Ee=()=>{O(f,!1)},Ne=C=>{const F=u.findIndex(j=>j.id_event===C.id_event),D=F===0,B=F>0?u[F-1]:null,$=D||B&&B.img!==null,ee=C.img!==null&&C.img!=="";$||D&&!ee?N(C,!1):X("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")},ke=()=>{O(f,!0)};function Te(C){Me[C?"unshift":"push"](()=>{b=C,t(8,b)})}const Le=(C,F)=>{const D=u.findIndex(Q=>Q.id_event===C.id_event),B=D===0,$=D>0?u[D-1]:null,ee=B||$&&$.img!==null,j=C.img!==null&&C.img!=="";ee||B&&!j?N(C,ie(F)):X("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")};function W(C){Me[C?"unshift":"push"](()=>{b=C,t(8,b)})}const Z=(C,F)=>{const D=u.findIndex(Q=>Q.id_event===C.id_event),B=D===0,$=D>0?u[D-1]:null,ee=B||$&&$.img!==null,j=C.img!==null&&C.img!=="";ee||B&&!j?N(C,ie(F)):X("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")};return l.$$set=C=>{"routeId"in C&&t(0,i=C.routeId),"driverId"in C&&t(1,_=C.driverId)},l.$$.update=()=>{l.$$.dirty[0]&1048581&&(t(0,{routeId:i,driverId:_}=o.params,i,(t(1,_),t(20,o),t(2,d),t(0,i))),t(2,d=JSON.parse(localStorage.getItem("userSession"))),d?d.id_user&&(d.type=="admin"||d.type=="super")?(y(i),Fe(`/drivers/me/routes/${i}`)):d.id_user&&d.id_driver&&(y(i),Fe(`/drivers/${d.id_driver}/routes/${i}`)):Fe("/"))},[i,_,d,k,E,u,f,p,b,A,q,R,N,O,S,H,z,Y,X,ie,o,fe,de,se,Ee,Ne,ke,Te,Le,W,Z]}class No extends We{constructor(e){super(),Xe(this,e,mo,_o,Ke,{routeId:0,driverId:1},null,[-1,-1])}}export{No as component};

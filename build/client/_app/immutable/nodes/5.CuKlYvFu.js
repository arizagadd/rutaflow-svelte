import{Z as ft,s as We,e as s,j as N,b as c,q as m,d as ne,h as a,m as T,v,i as J,w as o,x as ce,n as Ae,z as Be,_ as en,B as M,o as Ze,k as De,$ as dt,t as be,r as Ee,f as Q,a0 as tn,a1 as Qe,A as Se,y as Le,a2 as nn,a3 as Ke,a4 as on,a5 as ln,l as rn,p as an,F as sn}from"../chunks/index.CdEBkEwf.js";import{S as Je,i as Ye,t as lt,a as at,c as cn,b as un,d as fn,m as dn,e as _n,g as hn}from"../chunks/index.c2pjNB5R.js";import{e as He,u as xe,d as $e,a as pn,b as mn,c as vn,i as Yt,f as gn,g as Qt,h as bn,j as En,k as st,m as In,n as Zt,s as _t,o as Re,q as kn,r as On,t as Nn,v as Tn,w as Cn,x as yn,y as wn,z as Ln,p as An}from"../chunks/index.BHQPoT1E.js";import"../chunks/index-48209844.IIRtDZyg.js";import{m as et,D as it,a as je,I as zn}from"../chunks/IonPage.E0oGYKko.js";import{q as Mn,t as Sn}from"../chunks/ion-modal.CsJaVgKZ.js";import{g as qe}from"../chunks/entry.BtqwzgYx.js";const Dn=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global,Pn=(i,e)=>{if(!customElements.get(i)){class t extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const n={};for(const l of this.attributes)n[l.name]=l.value;new e({target:this.shadowRoot,props:n})}}customElements.define(i,t)}},Bn=function(i){return document.createElement(i).constructor!==HTMLElement},Hn=(i,e)=>{Bn(i)||Pn(i,e)},Ue=async(i,e,t)=>{Mn(),Sn(),Hn(i,e);const r=await et.create({component:i,componentProps:t});return r.present(),await r.onWillDismiss()};let Ge=ft({km_inicial:[],gas_inicial:[],km_final:[],gas_final:[]}),xt=ft({flag:[]});function Rn(i){let e,t,r,n,l="Cancelar",f,d,_="Captura de Km/Gas",k,g,h,u="Confirmar",p,b,O,A,V,S,G;return{c(){e=s("ion-header"),t=s("ion-toolbar"),r=s("ion-buttons"),n=s("ion-button"),n.textContent=l,f=N(),d=s("ion-title"),d.textContent=_,k=N(),g=s("ion-buttons"),h=s("ion-button"),h.textContent=u,p=N(),b=s("ion-content"),O=s("ion-item"),A=s("ion-input"),this.h()},l(q){e=c(q,"ION-HEADER",{translucent:!0});var j=m(e);t=c(j,"ION-TOOLBAR",{});var P=m(t);r=c(P,"ION-BUTTONS",{slot:!0});var B=m(r);n=c(B,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),ne(n)!=="svelte-17pq4f4"&&(n.textContent=l),B.forEach(a),f=T(P),d=c(P,"ION-TITLE",{"data-svelte-h":!0}),ne(d)!=="svelte-1yhkaq7"&&(d.textContent=_),k=T(P),g=c(P,"ION-BUTTONS",{slot:!0});var E=m(g);h=c(E,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),ne(h)!=="svelte-cm6j4s"&&(h.textContent=u),E.forEach(a),P.forEach(a),j.forEach(a),p=T(q),b=c(q,"ION-CONTENT",{fullscreen:!0});var y=m(b);O=c(y,"ION-ITEM",{});var U=m(O);A=c(U,"ION-INPUT",{class:!0,inputmode:!0,pattern:!0,type:!0,placeholder:!0,value:!0,required:!0});var H=m(A);H.forEach(a),U.forEach(a),y.forEach(a),this.h()},h(){v(n,"color","medium"),v(r,"slot","start"),v(h,"strong",""),v(g,"slot","end"),v(e,"translucent",""),v(A,"class","fin-km"),v(A,"inputmode","numeric"),v(A,"pattern","[0-9]*"),v(A,"type","number"),v(A,"placeholder",V="Ingresa "+i[0]+" actual"),v(A,"value",i[1]),v(A,"required",""),v(b,"fullscreen","")},m(q,j){J(q,e,j),o(e,t),o(t,r),o(r,n),o(t,f),o(t,d),o(t,k),o(t,g),o(g,h),J(q,p,j),J(q,b,j),o(b,O),o(O,A),S||(G=[ce(n,"click",i[2]),ce(h,"click",i[3]),ce(A,"input",i[4])],S=!0)},p(q,[j]){j&1&&V!==(V="Ingresa "+q[0]+" actual")&&v(A,"placeholder",V),j&2&&v(A,"value",q[1])},i:Ae,o:Ae,d(q){q&&(a(e),a(p),a(b)),S=!1,Be(G)}}}function Un(i,e,t){const r=en();let n=document.querySelector("ion-modal"),l=n.componentProps.data_type;n.componentProps.isLast;let f;xt.subscribe(h=>{l=h.flag[0],l=="km_final"||l=="km_inicial"?t(0,f="kilometraje"):t(0,f="litros de gasolina")});let d=0;function _(){et.dismiss()}function k(){r("modalResult",{data:"Your data",role:"confirm"}),l=="km_inicial"?Ge.update(u=>({...u,km_inicial:[d]})):l=="gas_inicial"?Ge.update(u=>({...u,gas_inicial:[d]})):l=="km_final"?Ge.update(u=>({...u,km_final:[d]})):l=="gas_final"&&Ge.update(u=>({...u,gas_final:[d]})),_()}return[f,d,_,k,h=>t(1,d=h.target.value)]}class Vn extends Je{constructor(e){super(),Ye(this,e,Un,Rn,We,{})}}const rt=ft({items:[],checkedIndices:[],mandatory:[]});function gt(i,e,t){const r=i.slice();return r[55]=e[t],r[56]=e,r[57]=t,r}function Fn(i){let e,t,r,n,l,f="Kilometraje inicial",d,_,k=i[0]?i[0]+" km.":"Cargar km",g,h,u,p,b,O,A,V="Gasolina inicial (litros)",S,G,q=i[1]?i[1]+" litros":"Cargar gas",j,P,B,E;return P=dt(i[21][0]),{c(){e=s("ion-item"),t=s("ion-label"),r=s("input"),n=N(),l=s("p"),l.textContent=f,d=N(),_=s("ion-button"),g=be(k),h=N(),u=s("ion-item"),p=s("ion-label"),b=s("input"),O=N(),A=s("p"),A.textContent=V,S=N(),G=s("ion-button"),j=be(q),this.h()},l(y){e=c(y,"ION-ITEM",{});var U=m(e);t=c(U,"ION-LABEL",{style:!0});var H=m(t);r=c(H,"INPUT",{id:!0,style:!0,type:!0}),n=T(H),l=c(H,"P",{style:!0,"data-svelte-h":!0}),ne(l)!=="svelte-88twxi"&&(l.textContent=f),H.forEach(a),d=T(U),_=c(U,"ION-BUTTON",{fill:!0,size:!0,class:!0,"aria-selected":!0});var R=m(_);g=Ee(R,k),R.forEach(a),U.forEach(a),h=T(y),u=c(y,"ION-ITEM",{});var W=m(u);p=c(W,"ION-LABEL",{style:!0});var F=m(p);b=c(F,"INPUT",{id:!0,style:!0,type:!0}),O=T(F),A=c(F,"P",{style:!0,"data-svelte-h":!0}),ne(A)!=="svelte-1ux30eb"&&(A.textContent=V),F.forEach(a),S=T(W),G=c(W,"ION-BUTTON",{fill:!0,class:!0,size:!0,style:!0});var ee=m(G);j=Ee(ee,q),ee.forEach(a),W.forEach(a),this.h()},h(){Q(r,"id","chkbox-km-ini"),M(r,"pointer-events","auto"),Q(r,"type","checkbox"),r.required=!0,M(l,"margin-left","10px"),M(t,"display","flex"),v(_,"fill","outline"),v(_,"size","small"),v(_,"class","loadKmInicial"),v(_,"aria-selected",""),Q(b,"id","chkbox-gas-ini"),M(b,"pointer-events","auto"),Q(b,"type","checkbox"),b.required=!0,M(A,"margin-left","10px"),M(p,"display","flex"),v(G,"fill","outline"),v(G,"class","loadGasInicial"),v(G,"size","small"),M(G,"height","16px "),P.p(r,b)},m(y,U){J(y,e,U),o(e,t),o(t,r),r.checked=~(i[4]||[]).indexOf(r.__value),i[28](r),o(t,n),o(t,l),o(e,d),o(e,_),o(_,g),J(y,h,U),J(y,u,U),o(u,p),o(p,b),i[30](b),b.checked=~(i[4]||[]).indexOf(b.__value),o(p,O),o(p,A),o(u,S),o(u,G),o(G,j),B||(E=[ce(r,"change",i[27]),ce(_,"click",i[29]),ce(b,"change",i[31]),ce(G,"click",i[32])],B=!0)},p(y,U){U[0]&16&&(r.checked=~(y[4]||[]).indexOf(r.__value)),U[0]&1&&k!==(k=y[0]?y[0]+" km.":"Cargar km")&&Le(g,k),U[0]&16&&(b.checked=~(y[4]||[]).indexOf(b.__value)),U[0]&2&&q!==(q=y[1]?y[1]+" litros":"Cargar gas")&&Le(j,q)},d(y){y&&(a(e),a(h),a(u)),i[28](null),i[30](null),P.r(),B=!1,Be(E)}}}function qn(i){let e,t,r,n,l,f="Kilometraje final",d,_,k=i[2]?i[2]+" km.":"Cargar km",g,h,u,p,b,O,A,V="Gasolina final (litros)",S,G,q=i[3]?i[3]+" litros":"Cargar gas",j,P,B,E;return P=dt(i[21][0]),{c(){e=s("ion-item"),t=s("ion-label"),r=s("input"),n=N(),l=s("p"),l.textContent=f,d=N(),_=s("ion-button"),g=be(k),h=N(),u=s("ion-item"),p=s("ion-label"),b=s("input"),O=N(),A=s("p"),A.textContent=V,S=N(),G=s("ion-button"),j=be(q),this.h()},l(y){e=c(y,"ION-ITEM",{});var U=m(e);t=c(U,"ION-LABEL",{style:!0});var H=m(t);r=c(H,"INPUT",{id:!0,style:!0,type:!0}),n=T(H),l=c(H,"P",{style:!0,"data-svelte-h":!0}),ne(l)!=="svelte-ccmu71"&&(l.textContent=f),H.forEach(a),d=T(U),_=c(U,"ION-BUTTON",{fill:!0,size:!0,class:!0,"aria-selected":!0});var R=m(_);g=Ee(R,k),R.forEach(a),U.forEach(a),h=T(y),u=c(y,"ION-ITEM",{});var W=m(u);p=c(W,"ION-LABEL",{style:!0});var F=m(p);b=c(F,"INPUT",{id:!0,style:!0,type:!0}),O=T(F),A=c(F,"P",{style:!0,"data-svelte-h":!0}),ne(A)!=="svelte-wsoyd2"&&(A.textContent=V),F.forEach(a),S=T(W),G=c(W,"ION-BUTTON",{fill:!0,size:!0,class:!0});var ee=m(G);j=Ee(ee,q),ee.forEach(a),W.forEach(a),this.h()},h(){Q(r,"id","chkbox-km-fin"),M(r,"pointer-events","auto"),Q(r,"type","checkbox"),r.required=!0,M(l,"margin-left","10px"),M(t,"display","flex"),v(_,"fill","outline"),v(_,"size","small"),v(_,"class","loadKmInicial"),v(_,"aria-selected",""),Q(b,"id","chkbox-gas-fin"),M(b,"pointer-events","auto"),Q(b,"type","checkbox"),b.required=!0,M(A,"margin-left","10px"),M(p,"display","flex"),v(G,"fill","outline"),v(G,"size","small"),v(G,"class","loadGasInicial"),P.p(r,b)},m(y,U){J(y,e,U),o(e,t),o(t,r),r.checked=~(i[4]||[]).indexOf(r.__value),i[22](r),o(t,n),o(t,l),o(e,d),o(e,_),o(_,g),J(y,h,U),J(y,u,U),o(u,p),o(p,b),b.checked=~(i[4]||[]).indexOf(b.__value),i[25](b),o(p,O),o(p,A),o(u,S),o(u,G),o(G,j),B||(E=[ce(r,"change",i[20]),ce(_,"click",i[23]),ce(b,"change",i[24]),ce(G,"click",i[26])],B=!0)},p(y,U){U[0]&16&&(r.checked=~(y[4]||[]).indexOf(r.__value)),U[0]&4&&k!==(k=y[2]?y[2]+" km.":"Cargar km")&&Le(g,k),U[0]&16&&(b.checked=~(y[4]||[]).indexOf(b.__value)),U[0]&8&&q!==(q=y[3]?y[3]+" litros":"Cargar gas")&&Le(j,q)},d(y){y&&(a(e),a(h),a(u)),i[22](null),i[25](null),P.r(),B=!1,Be(E)}}}function jn(i){let e=[],t=new Map,r,n=He(i[13]);const l=f=>f[55].id_checklist_event;for(let f=0;f<n.length;f+=1){let d=gt(i,n,f),_=l(d);t.set(_,e[f]=bt(_,d))}return{c(){for(let f=0;f<e.length;f+=1)e[f].c();r=De()},l(f){for(let d=0;d<e.length;d+=1)e[d].l(f);r=De()},m(f,d){for(let _=0;_<e.length;_+=1)e[_]&&e[_].m(f,d);J(f,r,d)},p(f,d){d[0]&407664&&(n=He(f[13]),e=xe(e,d,l,1,f,n,t,r.parentNode,$e,bt,r,gt))},d(f){f&&a(r);for(let d=0;d<e.length;d+=1)e[d].d(f)}}}function Gn(i){let e,t=(i[12][i[55].id_checklist_event]?i[12][i[55].id_checklist_event]:"Cargar evidencia")+"",r;return{c(){e=s("label"),r=be(t),this.h()},l(n){e=c(n,"LABEL",{for:!0,class:!0});var l=m(e);r=Ee(l,t),l.forEach(a),this.h()},h(){Q(e,"for","chklist-"+i[55].id_checklist_event),Q(e,"class","button-label svelte-1ruehls")},m(n,l){J(n,e,l),o(e,r)},p(n,l){l[0]&4096&&t!==(t=(n[12][n[55].id_checklist_event]?n[12][n[55].id_checklist_event]:"Cargar evidencia")+"")&&Le(r,t)},d(n){n&&a(e)}}}function Kn(i){let e;return{c(){e=s("ion-spinner"),this.h()},l(t){e=c(t,"ION-SPINNER",{name:!0,class:!0}),m(e).forEach(a),this.h()},h(){v(e,"name","dots"),v(e,"class","button-spinner svelte-1ruehls")},m(t,r){J(t,e,r)},p:Ae,d(t){t&&a(e)}}}function bt(i,e){let t,r,n,l=e[55],f,d,_=e[55].item+"",k,g,h,u=e[55].mandatory=="1"?" * ":"",p,b,O,A,V,S,G,q,j,P;const B=()=>e[34](n,l),E=()=>e[34](null,l);function y(){return e[35](e[55])}function U(F,ee){return F[11][F[55].id_checklist_event]?Kn:Gn}let H=U(e),R=H(e);function W(...F){return e[37](e[55],...F)}return q=dt(e[21][0]),{key:i,first:null,c(){t=s("ion-item"),r=s("ion-label"),n=s("input"),f=N(),d=s("p"),k=be(_),g=N(),h=s("b"),p=be(u),b=N(),O=s("ion-button"),A=s("div"),R.c(),V=N(),S=s("input"),G=N(),this.h()},l(F){t=c(F,"ION-ITEM",{});var ee=m(t);r=c(ee,"ION-LABEL",{style:!0});var te=m(r);n=c(te,"INPUT",{id:!0,style:!0,type:!0}),f=T(te),d=c(te,"P",{style:!0});var le=m(d);k=Ee(le,_),g=T(le),le.forEach(a),h=c(te,"B",{style:!0});var pe=m(h);p=Ee(pe,u),pe.forEach(a),te.forEach(a),b=T(ee),O=c(ee,"ION-BUTTON",{fill:!0,class:!0,size:!0});var ae=m(O);A=c(ae,"DIV",{class:!0});var de=m(A);R.l(de),V=T(de),S=c(de,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0}),de.forEach(a),ae.forEach(a),G=T(ee),ee.forEach(a),this.h()},h(){Q(n,"id",`chkbox-${e[55].id_checklist_event}`),M(n,"pointer-events","auto"),Q(n,"type","checkbox"),n.__value=e[55].id_checklist_event,tn(n,n.__value),n.required=!0,M(d,"margin-left","10px"),M(h,"margin-left","5px"),M(r,"display","flex"),M(S,"display","none"),Q(S,"id","chklist-"+e[55].id_checklist_event),Q(S,"name","fileToUpload"),Q(S,"type","file"),Q(S,"accept","image/*"),Q(A,"class","button-content svelte-1ruehls"),v(O,"fill","outline"),v(O,"class","loadEvidence svelte-1ruehls"),v(O,"size","small"),q.p(n),this.first=t},m(F,ee){J(F,t,ee),o(t,r),o(r,n),n.checked=~(e[4]||[]).indexOf(n.__value),B(),o(r,f),o(r,d),o(d,k),o(d,g),o(r,h),o(h,p),o(t,b),o(t,O),o(O,A),R.m(A,null),o(A,V),o(A,S),e[36](S),o(t,G),j||(P=[ce(n,"change",e[33]),ce(n,"change",y),ce(S,"change",W)],j=!0)},p(F,ee){e=F,ee[0]&16&&(n.checked=~(e[4]||[]).indexOf(n.__value)),l!==e[55]&&(E(),l=e[55],B()),H===(H=U(e))&&R?R.p(e,ee):(R.d(1),R=H(e),R&&(R.c(),R.m(A,V)))},d(F){F&&a(t),E(),R.d(),e[36](null),q.r(),j=!1,Be(P)}}}function Xn(i){let e,t,r,n,l="Cancelar",f,d,_="REQUERIMIENTOS DE RUTA",k,g,h,u,p,b,O,A="Confirmar",V,S;function G(B,E){return B[14]?qn:Fn}let j=G(i)(i),P=i[13]&&jn(i);return{c(){e=s("ion-header"),t=s("ion-toolbar"),r=s("ion-buttons"),n=s("ion-button"),n.textContent=l,f=N(),d=s("ion-title"),d.textContent=_,k=N(),g=s("ion-content"),h=s("ion-list"),j.c(),u=N(),P&&P.c(),p=N(),b=s("ion-footer"),O=s("ion-button"),O.textContent=A,this.h()},l(B){e=c(B,"ION-HEADER",{translucent:!0});var E=m(e);t=c(E,"ION-TOOLBAR",{});var y=m(t);r=c(y,"ION-BUTTONS",{slot:!0});var U=m(r);n=c(U,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),ne(n)!=="svelte-1dnmkxs"&&(n.textContent=l),U.forEach(a),f=T(y),d=c(y,"ION-TITLE",{"data-svelte-h":!0}),ne(d)!=="svelte-19bar5p"&&(d.textContent=_),y.forEach(a),E.forEach(a),k=T(B),g=c(B,"ION-CONTENT",{fullscreen:!0});var H=m(g);h=c(H,"ION-LIST",{});var R=m(h);j.l(R),u=T(R),P&&P.l(R),R.forEach(a),H.forEach(a),p=T(B),b=c(B,"ION-FOOTER",{});var W=m(b);O=c(W,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),ne(O)!=="svelte-g82qqw"&&(O.textContent=A),W.forEach(a),this.h()},h(){v(n,"color","medium"),v(r,"slot","start"),v(e,"translucent",""),v(g,"fullscreen",""),v(O,"fill","outline"),v(O,"color","tertiary"),v(O,"strong",""),M(O,"width","99%"),M(O,"height","auto")},m(B,E){J(B,e,E),o(e,t),o(t,r),o(r,n),o(t,f),o(t,d),J(B,k,E),J(B,g,E),o(g,h),j.m(h,null),o(h,u),P&&P.m(h,null),J(B,p,E),J(B,b,E),o(b,O),V||(S=[ce(n,"click",i[15]),ce(O,"click",i[16])],V=!0)},p(B,E){j.p(B,E),B[13]&&P.p(B,E)},i:Ae,o:Ae,d(B){B&&(a(e),a(k),a(g),a(p),a(b)),j.d(),P&&P.d(),V=!1,Be(S)}}}function ct(i,e){if(typeof i=="object"&&i!==null||Array.isArray(i)){if(Array.isArray(i))return i.map(t=>ct(t,e)).flat();{const t=Object.keys(i);let r;return e=="id_checklist_event"?r=t.filter(l=>l.toLowerCase().includes("id_checklist_event")).map(l=>i[l]):e=="mandatory"?r=t.filter(l=>l.toLowerCase().includes("mandatory")).map(l=>i[l]):(console.error("Tipo de dato no reconocido."),r=!1),r}}else return console.error("Invalid input. Please provide a valid object or array."),[]}function Wn(i,e,t){let r=it,n=document.querySelector("ion-modal");const l=n.componentProps.checklist,f=n.componentProps.driverId,d=n.componentProps.routeId,_=n.componentProps.isLast;let k,g,h,u,p=[],b=null,O={},A,V,S,G,q={},j=new Object,P={},B={};Ze(()=>{j=JSON.parse(localStorage.getItem("userSession")),_?console.log("Último checklist"):rt.update(z=>(z.mandatory=ct(l,"mandatory"),z.items=ct(l,"id_checklist_event"),z))});function E(z){t(11,q[z]=!0,q)}const y=async()=>{await(await je.create({header:"Datos o checklist incompletos",message:"Carga la evidencia requerida y marca todas las casillas para confirmar",buttons:[{text:"Cerrar"}]})).present()},U=async()=>{await(await je.create({header:"Datos capturados",message:"El kilometraje y gasolina final fueron registrados correctamente, espere aprobación para finalizar ruta",buttons:[{text:"Cerrar"}]})).present()},H=async z=>{await(await je.create({header:"Datos inválidos",message:z=="km"?"Llena correctamente el campo de kilometraje inicial":"Llena correctamente el campo de gasolina inicial",buttons:[{text:"Cerrar"}]})).present()},R=()=>{et.dismiss(),f?qe(`/drivers/${f}`):qe("/drivers/me")},W=()=>{if(_){var z=pe(h,"km"),w=pe(u,"gas");let oe=new FormData;oe.append("km_final",z),oe.append("gas_final",w),oe.append("id_route",d),oe=me(oe),z&&w?(R(),fetch(`${r}api/admin/checklist/add_evidence.php`,{method:"POST",body:oe}).then(he=>he.json()).then(he=>{U()}).catch(he=>{console.error("Error fetching data:",he)})):y()}else{var Y=pe(k,"km"),x=pe(g,"gas");rt.update(oe=>{oe.items;const he=oe.mandatory;if(oe.items.filter((fe,ve)=>oe.mandatory[ve]==="1").every(fe=>oe.checkedIndices.includes(fe))&&Y&&x){R();let fe=new FormData;fe=me(fe),fe.append("km_inicial",Y),fe.append("gas_inicial",x),fe.append("id_route",d);for(const ve in P)if(P.hasOwnProperty(ve)){const{img:ze,img_id:Ve}=P[ve];fe.append(`selectedImages[${ve}][img]`,ze),fe.append(`selectedImages[${ve}][img_id]`,Ve)}fetch(`${r}api/admin/checklist/add_evidence.php`,{method:"POST",body:fe}).then(ve=>ve.json()).then(ve=>{he&&he.some(ze=>ze==="1")?le(d,"checklist-pending"):le(d,"enroute")}).catch(ve=>{console.error("Error fetching data:",ve)})}else if(!he&&Y&&x){let fe=new FormData;fe.append("km_inicial",Y),fe.append("gas_inicial",x),fe=me(fe),fetch(`${r}api/admin/checklist/add_evidence.php`,{method:"POST",body:fe}).then(ve=>ve.json()).then(ve=>{le(d,"enroute")}).catch(ve=>{console.error("Error fetching data:",ve)})}else y();return oe})}ue()},F=async(z,w)=>{E(w);const x=z.target.files[0],oe=await ee(x);if(oe){let he=new FormData;he.append("fileToUpload",oe),he=me(he);try{const Te=await fetch(`${r}api/admin/manager/upload_img_driver.php`,{method:"POST",body:he});if(Te.ok){const re=await Te.json();P={...P,[w]:{img:re.img,img_id:re.img_id}},t(12,B={...B,[w]:re.filename}),te(w),t(6,O[w].checked=!0,O),t(11,q[w]=!1,q)}else console.error("File upload failed:",Te.statusText)}catch(Te){console.error("Error during file upload:",Te)}}},ee=async z=>new Promise(w=>{const Y=new FileReader;Y.onload=x=>{const oe=new Image;oe.src=x.target.result,oe.onload=()=>{const he=document.createElement("canvas"),Te=he.getContext("2d"),re=800,fe=600;let ve=oe.width,ze=oe.height;ve>re&&(ze*=re/ve,ve=re),ze>fe&&(ve*=fe/ze,ze=fe),he.width=ve,he.height=ze,Te.drawImage(oe,0,0,ve,ze),he.toBlob(Ve=>{w(Ve)},"image/jpeg",.7)}},Y.readAsDataURL(z)}),te=z=>{rt.update(w=>(w.checkedIndices.indexOf(z)===-1?w.checkedIndices.push(z):console.error(`ID ${z} is already checked.`),w.items.forEach(x=>{x.id_checklist_event===z&&(x.checked=!0)}),w))};function le(z,w){let Y=new FormData;Y.append("id_route",z),Y.append("status",w),Y=me(Y),fetch(`${r}api/admin/route/change_status.php`,{method:"POST",body:Y}).then(x=>x.json()).then(x=>{}).catch(x=>{console.error("Error fetching data:",x)})}function pe(z,w){return/^\d+$/.test(z)?parseInt(z,10):(H(w),null)}function ae(z,w){de(w),n.componentProps.data_type=w,Ue("modal-gas-km",Vn,{r:w}).then(()=>{Ge.subscribe(Y=>{ge(Y,w)})})}function de(z){xt.update(w=>({...w,flag:[z]}))}function ge(z,w){t(0,k=z.km_inicial?z.km_inicial:null),t(1,g=z.gas_inicial?z.gas_inicial:null),t(2,h=z.km_final?z.km_final:null),t(3,u=z.gas_final?z.gas_final:null),w=="km_inicial"&&A&&t(7,A.checked=!0,A),w=="gas_inicial"&&V&&t(8,V.checked=!0,V),w=="km_final"&&S&&t(9,S.checked=!0,S),w=="gas_final"&&G&&t(10,G.checked=!0,G)}function ue(){Ge.set({km_inicial:[],gas_inicial:[],km_final:[],gas_final:[]})}function me(z){return z.append("token",j.token),z.append("id_user_over",j.id_user),z}const Ie=[[]];function Oe(){p=Qe(Ie[0],this.__value,this.checked),t(4,p)}function we(z){Se[z?"unshift":"push"](()=>{S=z,t(9,S)})}const Ce=z=>ae(z,"km_final");function _e(){p=Qe(Ie[0],this.__value,this.checked),t(4,p)}function Ne(z){Se[z?"unshift":"push"](()=>{G=z,t(10,G)})}const ye=z=>ae(z,"gas_final");function ke(){p=Qe(Ie[0],this.__value,this.checked),t(4,p)}function se(z){Se[z?"unshift":"push"](()=>{A=z,t(7,A)})}const $=z=>ae(z,"km_inicial");function ie(z){Se[z?"unshift":"push"](()=>{V=z,t(8,V)})}function I(){p=Qe(Ie[0],this.__value,this.checked),t(4,p)}const C=z=>ae(z,"gas_inicial");function D(){p=Qe(Ie[0],this.__value,this.checked),t(4,p)}function L(z,w){Se[z?"unshift":"push"](()=>{O[w.id_checklist_event]=z,t(6,O)})}const K=z=>te(z.id_checklist_event);function X(z){Se[z?"unshift":"push"](()=>{b=z,t(5,b)})}return[k,g,h,u,p,b,O,A,V,S,G,q,B,l,_,R,W,F,te,ae,Oe,Ie,we,Ce,_e,Ne,ye,ke,se,$,ie,I,C,D,L,K,X,(z,w)=>F(w,z.id_checklist_event)]}class $t extends Je{constructor(e){super(),Ye(this,e,Wn,Xn,We,{},null,[-1,-1])}}function Et(i,e,t){const r=i.slice();return r[53]=e[t],r[55]=t,r}function Jn(i){let e,t,r="Confirmar",n,l;return{c(){e=s("ion-buttons"),t=s("ion-button"),t.textContent=r,this.h()},l(f){e=c(f,"ION-BUTTONS",{slot:!0});var d=m(e);t=c(d,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),ne(t)!=="svelte-1ida0il"&&(t.textContent=r),d.forEach(a),this.h()},h(){v(t,"strong",""),v(e,"slot","end")},m(f,d){J(f,e,d),o(e,t),n||(l=ce(t,"click",i[22]),n=!0)},p:Ae,d(f){f&&a(e),n=!1,l()}}}function Yn(i){let e,t,r,n,l,f="Teléfono de Negocio",d,_,k=i[13].client_phone+"",g;return{c(){e=s("ion-item"),t=s("ion-icon"),r=N(),n=s("ion-label"),l=s("p"),l.textContent=f,d=N(),_=s("h2"),g=be(k),this.h()},l(h){e=c(h,"ION-ITEM",{href:!0});var u=m(e);t=c(u,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),r=T(u),n=c(u,"ION-LABEL",{class:!0});var p=m(n);l=c(p,"P",{"data-svelte-h":!0}),ne(l)!=="svelte-1u5l7fz"&&(l.textContent=f),d=T(p),_=c(p,"H2",{});var b=m(_);g=Ee(b,k),b.forEach(a),p.forEach(a),u.forEach(a),this.h()},h(){v(t,"icon",mn),v(t,"slot","start"),v(n,"class","ion-text-wrap"),v(e,"href","tel:"+i[13].client_phone)},m(h,u){J(h,e,u),o(e,t),o(e,r),o(e,n),o(n,l),o(n,d),o(n,_),o(_,g)},p:Ae,d(h){h&&a(e)}}}function Qn(i){let e,t,r,n,l,f="Domicilio Alternativo",d,_,k=i[13].line2+"",g,h,u;return{c(){e=s("ion-item"),t=s("ion-icon"),r=N(),n=s("ion-label"),l=s("p"),l.textContent=f,d=N(),_=s("h2"),g=be(k),h=N(),u=s("ion-icon"),this.h()},l(p){e=c(p,"ION-ITEM",{href:!0});var b=m(e);t=c(b,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),r=T(b),n=c(b,"ION-LABEL",{class:!0});var O=m(n);l=c(O,"P",{"data-svelte-h":!0}),ne(l)!=="svelte-1ub9uzw"&&(l.textContent=f),d=T(O),_=c(O,"H2",{});var A=m(_);g=Ee(A,k),A.forEach(a),O.forEach(a),h=T(b),u=c(b,"ION-ICON",{icon:!0,slot:!0}),m(u).forEach(a),b.forEach(a),this.h()},h(){v(t,"icon",_t),v(t,"slot","start"),v(n,"class","ion-text-wrap"),v(u,"icon",Re),v(u,"slot","end"),v(e,"href","https://www.google.com/maps/searhc/?api=1&query="+i[13].line2)},m(p,b){J(p,e,b),o(e,t),o(e,r),o(e,n),o(n,l),o(n,d),o(n,_),o(_,g),o(e,h),o(e,u)},p:Ae,d(p){p&&a(e)}}}function Zn(i){let e,t,r,n,l,f="Domicilio",d,_,k=i[13].line1+"",g,h,u,p,b=i[13].line2&&i[13].line2.trim().length,O,A=b&&xn(i);return{c(){e=s("ion-item"),t=s("ion-icon"),r=N(),n=s("ion-label"),l=s("p"),l.textContent=f,d=N(),_=s("h2"),g=be(k),h=N(),u=s("ion-icon"),p=N(),A&&A.c(),O=De(),this.h()},l(V){e=c(V,"ION-ITEM",{href:!0});var S=m(e);t=c(S,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),r=T(S),n=c(S,"ION-LABEL",{class:!0});var G=m(n);l=c(G,"P",{"data-svelte-h":!0}),ne(l)!=="svelte-cbm7q1"&&(l.textContent=f),d=T(G),_=c(G,"H2",{});var q=m(_);g=Ee(q,k),q.forEach(a),G.forEach(a),h=T(S),u=c(S,"ION-ICON",{icon:!0,slot:!0}),m(u).forEach(a),S.forEach(a),p=T(V),A&&A.l(V),O=De(),this.h()},h(){v(t,"icon",_t),v(t,"slot","start"),v(n,"class","ion-text-wrap"),v(u,"icon",Re),v(u,"slot","end"),v(e,"href","https://www.google.com/maps/search/?api=1&query="+i[13].line1)},m(V,S){J(V,e,S),o(e,t),o(e,r),o(e,n),o(n,l),o(n,d),o(n,_),o(_,g),o(e,h),o(e,u),J(V,p,S),A&&A.m(V,S),J(V,O,S)},p(V,S){b&&A.p(V,S)},d(V){V&&(a(e),a(p),a(O)),A&&A.d(V)}}}function xn(i){let e,t,r,n,l,f="Domicilio Alternativo",d,_,k=i[13].line2+"",g,h,u;return{c(){e=s("ion-item"),t=s("ion-icon"),r=N(),n=s("ion-label"),l=s("p"),l.textContent=f,d=N(),_=s("h2"),g=be(k),h=N(),u=s("ion-icon"),this.h()},l(p){e=c(p,"ION-ITEM",{href:!0});var b=m(e);t=c(b,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),r=T(b),n=c(b,"ION-LABEL",{class:!0});var O=m(n);l=c(O,"P",{"data-svelte-h":!0}),ne(l)!=="svelte-1ub9uzw"&&(l.textContent=f),d=T(O),_=c(O,"H2",{});var A=m(_);g=Ee(A,k),A.forEach(a),O.forEach(a),h=T(b),u=c(b,"ION-ICON",{icon:!0,slot:!0}),m(u).forEach(a),b.forEach(a),this.h()},h(){v(t,"icon",_t),v(t,"slot","start"),v(n,"class","ion-text-wrap"),v(u,"icon",Re),v(u,"slot","end"),v(e,"href","https://www.google.com/maps/search/?api=1&query="+i[13].line2)},m(p,b){J(p,e,b),o(e,t),o(e,r),o(e,n),o(n,l),o(n,d),o(n,_),o(_,g),o(e,h),o(e,u)},p:Ae,d(p){p&&a(e)}}}function It(i){let e,t,r,n,l,f="Contacto del Cliente",d,_,k,g,h=i[17]&&i[17]==="1"&&$n(i);return{c(){e=s("ion-item"),t=s("ion-icon"),r=N(),n=s("ion-label"),l=s("p"),l.textContent=f,d=N(),_=s("h2"),k=be(i[6]),g=N(),h&&h.c(),this.h()},l(u){e=c(u,"ION-ITEM",{});var p=m(e);t=c(p,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),r=T(p),n=c(p,"ION-LABEL",{class:!0});var b=m(n);l=c(b,"P",{"data-svelte-h":!0}),ne(l)!=="svelte-1utsyb6"&&(l.textContent=f),d=T(b),_=c(b,"H2",{});var O=m(_);k=Ee(O,i[6]),O.forEach(a),b.forEach(a),g=T(p),h&&h.l(p),p.forEach(a),this.h()},h(){v(t,"icon",vn),v(t,"slot","start"),v(n,"class","ion-text-wrap")},m(u,p){J(u,e,p),o(e,t),o(e,r),o(e,n),o(n,l),o(n,d),o(n,_),o(_,k),o(e,g),h&&h.m(e,null)},p(u,p){p[0]&64&&Le(k,u[6]),u[17]&&u[17]==="1"&&h.p(u,p)},d(u){u&&a(e),h&&h.d()}}}function $n(i){let e,t=`<ion-icon icon="${kn}" slot="start"></ion-icon>
                        Notificar Cliente`,r,n;return{c(){e=s("ion-button"),e.innerHTML=t,this.h()},l(l){e=c(l,"ION-BUTTON",{fill:!0,style:!0,"data-svelte-h":!0}),ne(e)!=="svelte-w3qtwm"&&(e.innerHTML=t),this.h()},h(){v(e,"fill","outline"),M(e,"margin-left","16px")},m(l,f){J(l,e,f),r||(n=ce(e,"click",i[23]),r=!0)},p:Ae,d(l){l&&a(e),r=!1,n()}}}function kt(i){let e,t,r,n,l,f="Notas de ubicación",d,_,k;return{c(){e=s("ion-item"),t=s("ion-icon"),r=N(),n=s("ion-label"),l=s("p"),l.textContent=f,d=N(),_=s("h2"),k=be(i[7]),this.h()},l(g){e=c(g,"ION-ITEM",{});var h=m(e);t=c(h,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),r=T(h),n=c(h,"ION-LABEL",{class:!0});var u=m(n);l=c(u,"P",{"data-svelte-h":!0}),ne(l)!=="svelte-nhm2ft"&&(l.textContent=f),d=T(u),_=c(u,"H2",{});var p=m(_);k=Ee(p,i[7]),p.forEach(a),u.forEach(a),h.forEach(a),this.h()},h(){v(t,"icon",Yt),v(t,"slot","start"),v(n,"class","ion-text-wrap")},m(g,h){J(g,e,h),o(e,t),o(e,r),o(e,n),o(n,l),o(n,d),o(n,_),o(_,k)},p(g,h){h[0]&128&&Le(k,g[7])},d(g){g&&a(e)}}}function eo(i){let e,t,r,n,l,f="Horarios",d,_,k=i[13].schedule+"",g;return{c(){e=s("ion-item"),t=s("ion-icon"),r=N(),n=s("ion-label"),l=s("p"),l.textContent=f,d=N(),_=s("h2"),g=be(k),this.h()},l(h){e=c(h,"ION-ITEM",{});var u=m(e);t=c(u,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),r=T(u),n=c(u,"ION-LABEL",{});var p=m(n);l=c(p,"P",{"data-svelte-h":!0}),ne(l)!=="svelte-11q7hm5"&&(l.textContent=f),d=T(p),_=c(p,"H2",{});var b=m(_);g=Ee(b,k),b.forEach(a),p.forEach(a),u.forEach(a),this.h()},h(){v(t,"icon",gn),v(t,"slot","start")},m(h,u){J(h,e,u),o(e,t),o(e,r),o(e,n),o(n,l),o(n,d),o(n,_),o(_,g)},p:Ae,d(h){h&&a(e)}}}function to(i){let e,t,r,n,l,f="Notas del operador",d,_,k=i[13].driver_comments+"",g;return{c(){e=s("ion-item"),t=s("ion-icon"),r=N(),n=s("ion-label"),l=s("p"),l.textContent=f,d=N(),_=s("h2"),g=be(k),this.h()},l(h){e=c(h,"ION-ITEM",{});var u=m(e);t=c(u,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),r=T(u),n=c(u,"ION-LABEL",{});var p=m(n);l=c(p,"P",{"data-svelte-h":!0}),ne(l)!=="svelte-1yk9qp4"&&(l.textContent=f),d=T(p),_=c(p,"H2",{});var b=m(_);g=Ee(b,k),b.forEach(a),p.forEach(a),u.forEach(a),this.h()},h(){v(t,"icon",Qt),v(t,"slot","start")},m(h,u){J(h,e,u),o(e,t),o(e,r),o(e,n),o(n,l),o(n,d),o(n,_),o(_,g)},p:Ae,d(h){h&&a(e)}}}function no(i){let e,t=i[13].logistic_comments!="<br>"&&oo(i);return{c(){t&&t.c(),e=De()},l(r){t&&t.l(r),e=De()},m(r,n){t&&t.m(r,n),J(r,e,n)},p(r,n){r[13].logistic_comments!="<br>"&&t.p(r,n)},d(r){r&&a(e),t&&t.d(r)}}}function oo(i){let e,t,r,n,l,f="Comentarios logísticos",d,_,k=i[13].logistic_comments+"",g;return{c(){e=s("ion-item"),t=s("ion-icon"),r=N(),n=s("ion-label"),l=s("p"),l.textContent=f,d=N(),_=s("h2"),g=be(k),this.h()},l(h){e=c(h,"ION-ITEM",{});var u=m(e);t=c(u,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),r=T(u),n=c(u,"ION-LABEL",{class:!0});var p=m(n);l=c(p,"P",{"data-svelte-h":!0}),ne(l)!=="svelte-1iz85r6"&&(l.textContent=f),d=T(p),_=c(p,"H2",{});var b=m(_);g=Ee(b,k),b.forEach(a),p.forEach(a),u.forEach(a),this.h()},h(){v(t,"icon",Yt),v(t,"slot","start"),v(n,"class","ion-text-wrap")},m(h,u){J(h,e,u),o(e,t),o(e,r),o(e,n),o(n,l),o(n,d),o(n,_),o(_,g)},p:Ae,d(h){h&&a(e)}}}function Ot(i){let e,t,r,n;return{c(){e=s("ion-item"),t=s("ion-icon"),r=N(),n=s("ion-textarea"),this.h()},l(l){e=c(l,"ION-ITEM",{});var f=m(e);t=c(f,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),r=T(f),n=c(f,"ION-TEXTAREA",{placeholder:!0}),m(n).forEach(a),f.forEach(a),this.h()},h(){v(t,"icon",bn),v(t,"slot","start"),v(n,"placeholder","Escribe el motivo...")},m(l,f){J(l,e,f),o(e,t),o(e,r),o(e,n),i[29](n)},p:Ae,d(l){l&&a(e),i[29](null)}}}function lo(i){let e,t,r,n,l,f="Estado de entrega",d,_,k="Entregado",g,h,u="No Entregado",p,b,O="Entrega Parcial",A,V,S,G,q,j,P,B,E=i[4]===!0&&Nt(i),y=(i[5]===!0||i[5]===!1&&i[4]===!1)&&Tt(i);return{c(){e=s("ion-item"),t=s("ion-icon"),r=N(),n=s("ion-select"),l=s("div"),l.textContent=f,d=N(),_=s("ion-select-option"),_.textContent=k,g=N(),h=s("ion-select-option"),h.textContent=u,p=N(),b=s("ion-select-option"),b.textContent=O,A=N(),V=s("ion-item"),S=s("ion-icon"),G=N(),q=s("ion-textarea"),j=N(),P=s("section"),E&&E.c(),B=N(),y&&y.c(),this.h()},l(U){e=c(U,"ION-ITEM",{});var H=m(e);t=c(H,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),r=T(H),n=c(H,"ION-SELECT",{value:!0});var R=m(n);l=c(R,"DIV",{slot:!0,"data-svelte-h":!0}),ne(l)!=="svelte-1635zca"&&(l.textContent=f),d=T(R),_=c(R,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),ne(_)!=="svelte-s33eln"&&(_.textContent=k),g=T(R),h=c(R,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),ne(h)!=="svelte-1a859l3"&&(h.textContent=u),p=T(R),b=c(R,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),ne(b)!=="svelte-1c4dcm8"&&(b.textContent=O),R.forEach(a),H.forEach(a),A=T(U),V=c(U,"ION-ITEM",{});var W=m(V);S=c(W,"ION-ICON",{icon:!0,slot:!0}),m(S).forEach(a),G=T(W),q=c(W,"ION-TEXTAREA",{label:!0,placeholder:!0}),m(q).forEach(a),W.forEach(a),j=T(U),P=c(U,"SECTION",{style:!0});var F=m(P);E&&E.l(F),B=T(F),y&&y.l(F),F.forEach(a),this.h()},h(){v(t,"icon",En),v(t,"slot","start"),Q(l,"slot","label"),v(_,"value","delivered"),v(h,"value","notdelivered"),v(b,"value","partialdeliver"),v(n,"value",i[16]?i[16]:"delivered"),v(S,"icon",st),v(S,"slot","start"),v(q,"label","Notas"),v(q,"placeholder","Escribe aquí..."),M(P,"display","flex"),M(P,"gap","8px"),M(P,"padding","16px 16px 6px")},m(U,H){J(U,e,H),o(e,t),o(e,r),o(e,n),o(n,l),o(n,d),o(n,_),o(n,g),o(n,h),o(n,p),o(n,b),i[30](n),J(U,A,H),J(U,V,H),o(V,S),o(V,G),o(V,q),i[31](q),J(U,j,H),J(U,P,H),E&&E.m(P,null),o(P,B),y&&y.m(P,null)},p(U,H){U[4]===!0?E?E.p(U,H):(E=Nt(U),E.c(),E.m(P,B)):E&&(E.d(1),E=null),U[5]===!0||U[5]===!1&&U[4]===!1?y?y.p(U,H):(y=Tt(U),y.c(),y.m(P,null)):y&&(y.d(1),y=null)},d(U){U&&(a(e),a(A),a(V),a(j),a(P)),i[30](null),i[31](null),E&&E.d(),y&&y.d()}}}function Nt(i){let e,t=`<ion-icon icon="${On}" slot="start"></ion-icon>
                        Ingreso`,r,n;return{c(){e=s("ion-button"),e.innerHTML=t,this.h()},l(l){e=c(l,"ION-BUTTON",{id:!0,style:!0,"data-svelte-h":!0}),ne(e)!=="svelte-3onvnr"&&(e.innerHTML=t),this.h()},h(){v(e,"id","checkInBtn"),M(e,"flex","1")},m(l,f){J(l,e,f),r||(n=ce(e,"click",i[24]),r=!0)},p:Ae,d(l){l&&a(e),r=!1,n()}}}function Tt(i){let e,t,r,n,l,f;return{c(){e=s("ion-button"),t=s("ion-icon"),r=be(`
                        Salida`),this.h()},l(d){e=c(d,"ION-BUTTON",{id:!0,style:!0,disabled:!0});var _=m(e);t=c(_,"ION-ICON",{icon:!0,slot:!0}),m(t).forEach(a),r=Ee(_,`
                        Salida`),_.forEach(a),this.h()},h(){v(t,"icon",In),v(t,"slot","start"),v(e,"id","checkOutBtn"),M(e,"flex","1"),v(e,"disabled",n=i[5]===!1)},m(d,_){J(d,e,_),o(e,t),o(e,r),l||(f=ce(e,"click",i[25]),l=!0)},p(d,_){_[0]&32&&n!==(n=d[5]===!1)&&v(e,"disabled",n)},d(d){d&&a(e),l=!1,f()}}}function io(i){let e,t,r,n,l,f="Subir Evidencia",d,_,k,g;return{c(){e=s("section"),t=s("ion-button"),r=s("ion-icon"),n=N(),l=s("label"),l.textContent=f,d=N(),_=s("input"),this.h()},l(h){e=c(h,"SECTION",{style:!0});var u=m(e);t=c(u,"ION-BUTTON",{fill:!0,class:!0,style:!0});var p=m(t);r=c(p,"ION-ICON",{icon:!0,slot:!0}),m(r).forEach(a),n=T(p),l=c(p,"LABEL",{for:!0,"data-svelte-h":!0}),ne(l)!=="svelte-1wg51s6"&&(l.textContent=f),d=T(p),_=c(p,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0}),p.forEach(a),u.forEach(a),this.h()},h(){v(r,"icon",Zt),v(r,"slot","start"),Q(l,"for","eventEvidence"),M(_,"display","none"),Q(_,"id","eventEvidence"),Q(_,"name","fileToUpload"),Q(_,"type","file"),_.multiple=!0,Q(_,"accept","image/*"),v(t,"fill","outline"),v(t,"class","loadEvidence"),M(t,"flex","1"),M(e,"display","flex"),M(e,"gap","8px"),M(e,"padding","0px 16px")},m(h,u){J(h,e,u),o(e,t),o(t,r),o(t,n),o(t,l),o(t,d),o(t,_),k||(g=[ce(_,"change",i[18]),ce(_,"click",i[19])],k=!0)},p:Ae,d(h){h&&a(e),k=!1,Be(g)}}}function Ct(i){let e,t='<ion-spinner name="dots"></ion-spinner>';return{c(){e=s("section"),e.innerHTML=t,this.h()},l(r){e=c(r,"SECTION",{style:!0,"data-svelte-h":!0}),ne(e)!=="svelte-1sj3e0"&&(e.innerHTML=t),this.h()},h(){M(e,"text-align","center")},m(r,n){J(r,e,n)},d(r){r&&a(e)}}}function yt(i){let e,t,r=He(i[2]),n=[];for(let l=0;l<r.length;l+=1)n[l]=wt(Et(i,r,l));return{c(){e=s("section"),t=s("div");for(let l=0;l<n.length;l+=1)n[l].c();this.h()},l(l){e=c(l,"SECTION",{});var f=m(e);t=c(f,"DIV",{class:!0,style:!0});var d=m(t);for(let _=0;_<n.length;_+=1)n[_].l(d);d.forEach(a),f.forEach(a),this.h()},h(){Q(t,"class","image-grid"),M(t,"display","grid"),M(t,"grid-template-columns","repeat(auto-fill, minmax(100px, 1fr))"),M(t,"gap","10px"),M(t,"padding","0px 10px")},m(l,f){J(l,e,f),o(e,t);for(let d=0;d<n.length;d+=1)n[d]&&n[d].m(t,null)},p(l,f){if(f[0]&69206020){r=He(l[2]);let d;for(d=0;d<r.length;d+=1){const _=Et(l,r,d);n[d]?n[d].p(_,f):(n[d]=wt(_),n[d].c(),n[d].m(t,null))}for(;d<n.length;d+=1)n[d].d(1);n.length=r.length}},d(l){l&&a(e),nn(n,l)}}}function wt(i){let e,t,r,n,l,f=`<ion-icon icon="${Nn}"></ion-icon>`,d,_,k;function g(){return i[32](i[53])}function h(){return i[33](i[55])}return{c(){e=s("div"),t=s("ion-img"),n=N(),l=s("button"),l.innerHTML=f,d=N(),this.h()},l(u){e=c(u,"DIV",{class:!0,style:!0});var p=m(e);t=c(p,"ION-IMG",{src:!0,alt:!0,style:!0}),m(t).forEach(a),n=T(p),l=c(p,"BUTTON",{class:!0,style:!0,"data-svelte-h":!0}),ne(l)!=="svelte-zguiov"&&(l.innerHTML=f),d=T(p),p.forEach(a),this.h()},h(){Ke(t.src,r=i[53])||v(t,"src",r),v(t,"alt","Evidencia fotográfica"),M(t,"width","100%"),M(t,"height","100px"),M(t,"object-fit","cover"),M(t,"cursor","pointer"),M(t,"border","1px solid #ccc"),M(t,"border-radius","4px"),M(t,"margin-top","16px"),Q(l,"class","remove-button"),M(l,"position","absolute"),M(l,"top","5px"),M(l,"right","5px"),M(l,"border","none"),M(l,"cursor","pointer"),M(l,"font-size","18px"),M(l,"background","white"),M(l,"border-radius","50%"),M(l,"padding","3px 4px 0px"),M(l,"box-shadow","2px 2px 6px rgba(0, 0, 0, 0.3)"),M(l,"color","#0000008f"),Q(e,"class","image-container"),M(e,"position","relative")},m(u,p){J(u,e,p),o(e,t),o(e,n),o(e,l),o(e,d),_||(k=[ce(t,"click",g),ce(l,"click",h)],_=!0)},p(u,p){i=u,p[0]&4&&!Ke(t.src,r=i[53])&&v(t,"src",r)},d(u){u&&a(e),_=!1,Be(k)}}}function Lt(i){let e,t,r,n,l,f,d=`<ion-icon icon="${Tn}"></ion-icon>`,_,k;return{c(){e=s("div"),t=s("div"),r=s("ion-img"),l=N(),f=s("button"),f.innerHTML=d,this.h()},l(g){e=c(g,"DIV",{class:!0,style:!0});var h=m(e);t=c(h,"DIV",{class:!0,style:!0});var u=m(t);r=c(u,"ION-IMG",{src:!0,alt:!0,style:!0}),m(r).forEach(a),l=T(u),f=c(u,"BUTTON",{class:!0,style:!0,"data-svelte-h":!0}),ne(f)!=="svelte-g0qr0o"&&(f.innerHTML=d),u.forEach(a),h.forEach(a),this.h()},h(){Ke(r.src,n=i[11])||v(r,"src",n),v(r,"alt","Evidencia fotográfica"),M(r,"width","100%"),M(r,"height","auto"),Q(f,"class","close-button"),M(f,"position","absolute"),M(f,"top","5px"),M(f,"right","5px"),M(f,"background","white"),M(f,"color","#444444d1"),M(f,"border","none"),M(f,"cursor","pointer"),M(f,"padding","2px 2px 0px 6px"),M(f,"border-radius","50%"),M(f,"font-size","20px"),Q(t,"class","modal-content"),M(t,"position","relative"),M(t,"background","white"),M(t,"padding","20px"),M(t,"border-radius","8px"),M(t,"max-width","90vw"),M(t,"max-height","90vh"),M(t,"overflow","auto"),Q(e,"class","modal-overlay"),M(e,"position","fixed"),M(e,"top","0"),M(e,"left","0"),M(e,"width","100vw"),M(e,"height","100vh"),M(e,"background","rgba(0, 0, 0, 0.8)"),M(e,"display","flex"),M(e,"justify-content","center"),M(e,"align-items","center"),M(e,"z-index","1000")},m(g,h){J(g,e,h),o(e,t),o(t,r),o(t,l),o(t,f),_||(k=[ce(f,"click",i[27]),ce(t,"click",on(i[28])),ce(e,"click",i[27])],_=!0)},p(g,h){h[0]&2048&&!Ke(r.src,n=g[11])&&v(r,"src",n)},d(g){g&&a(e),_=!1,Be(k)}}}function ro(i){let e,t,r,n,l="Cerrar",f,d,_=i[13].title+"",k,g,h,u,p,b,O,A,V,S,G="Negocio",q,j,P=i[13].client_name+"",B,E,y=i[13].client_phone&&i[13].client_phone.trim().length,U,H,R,W,F=i[13].schedule&&i[13].schedule.trim().length,ee,te,le=i[13].logistic_comments&&i[13].logistic_comments.trim().length,pe,ae,de,ge,ue,me,Ie,Oe,we,Ce=(!i[14]&&!i[15]||i[14]&&i[15])&&Jn(i),_e=y&&Yn(i);function Ne(w,Y){if(w[13].line1&&w[13].line1.trim().length)return Zn;if(w[13].line2&&w[13].line2.trim().length)return Qn}let ye=Ne(i),ke=ye&&ye(i),se=i[6]&&It(i),$=i[7]&&i[7]!=="<br>"&&kt(i),ie=F&&eo(i),I=i[13].driver_comments&&to(i),C=le&&no(i),D=i[8]&&Ot(i),L=!i[15]&&lo(i),K=(i[14]&&i[15]||!i[14]&&!i[15])&&io(i),X=i[3]&&Ct(),Z=i[1]&&yt(i),z=i[10]&&Lt(i);return{c(){e=s("ion-header"),t=s("ion-toolbar"),r=s("ion-buttons"),n=s("ion-button"),n.textContent=l,f=N(),d=s("ion-title"),k=be(_),g=N(),Ce&&Ce.c(),h=N(),u=s("ion-content"),p=s("ion-list"),b=s("ion-item"),O=s("ion-icon"),A=N(),V=s("ion-label"),S=s("p"),S.textContent=G,q=N(),j=s("h2"),B=be(P),E=N(),_e&&_e.c(),U=N(),ke&&ke.c(),H=N(),se&&se.c(),R=N(),$&&$.c(),W=N(),ie&&ie.c(),ee=N(),I&&I.c(),te=N(),C&&C.c(),pe=N(),D&&D.c(),ae=N(),L&&L.c(),de=N(),K&&K.c(),ge=N(),X&&X.c(),ue=N(),Z&&Z.c(),me=N(),z&&z.c(),Ie=De(),this.h()},l(w){e=c(w,"ION-HEADER",{translucent:!0});var Y=m(e);t=c(Y,"ION-TOOLBAR",{});var x=m(t);r=c(x,"ION-BUTTONS",{slot:!0});var oe=m(r);n=c(oe,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),ne(n)!=="svelte-2ks32x"&&(n.textContent=l),oe.forEach(a),f=T(x),d=c(x,"ION-TITLE",{style:!0,title:!0});var he=m(d);k=Ee(he,_),he.forEach(a),g=T(x),Ce&&Ce.l(x),x.forEach(a),Y.forEach(a),h=T(w),u=c(w,"ION-CONTENT",{fullscreen:!0});var Te=m(u);p=c(Te,"ION-LIST",{});var re=m(p);b=c(re,"ION-ITEM",{});var fe=m(b);O=c(fe,"ION-ICON",{icon:!0,slot:!0}),m(O).forEach(a),A=T(fe),V=c(fe,"ION-LABEL",{});var ve=m(V);S=c(ve,"P",{"data-svelte-h":!0}),ne(S)!=="svelte-57b1dg"&&(S.textContent=G),q=T(ve),j=c(ve,"H2",{});var ze=m(j);B=Ee(ze,P),ze.forEach(a),ve.forEach(a),fe.forEach(a),E=T(re),_e&&_e.l(re),U=T(re),ke&&ke.l(re),H=T(re),se&&se.l(re),R=T(re),$&&$.l(re),W=T(re),ie&&ie.l(re),ee=T(re),I&&I.l(re),te=T(re),C&&C.l(re),pe=T(re),D&&D.l(re),ae=T(re),L&&L.l(re),de=T(re),K&&K.l(re),ge=T(re),X&&X.l(re),ue=T(re),Z&&Z.l(re),re.forEach(a),Te.forEach(a),me=T(w),z&&z.l(w),Ie=De(),this.h()},h(){v(n,"color","medium"),v(r,"slot","start"),M(d,"text-align","center"),v(d,"title",i[13].title),v(e,"translucent",""),v(O,"icon",pn),v(O,"slot","start"),v(u,"fullscreen","")},m(w,Y){J(w,e,Y),o(e,t),o(t,r),o(r,n),o(t,f),o(t,d),o(d,k),o(t,g),Ce&&Ce.m(t,null),J(w,h,Y),J(w,u,Y),o(u,p),o(p,b),o(b,O),o(b,A),o(b,V),o(V,S),o(V,q),o(V,j),o(j,B),o(p,E),_e&&_e.m(p,null),o(p,U),ke&&ke.m(p,null),o(p,H),se&&se.m(p,null),o(p,R),$&&$.m(p,null),o(p,W),ie&&ie.m(p,null),o(p,ee),I&&I.m(p,null),o(p,te),C&&C.m(p,null),o(p,pe),D&&D.m(p,null),o(p,ae),L&&L.m(p,null),o(p,de),K&&K.m(p,null),o(p,ge),X&&X.m(p,null),o(p,ue),Z&&Z.m(p,null),J(w,me,Y),z&&z.m(w,Y),J(w,Ie,Y),Oe||(we=ce(n,"click",i[20]),Oe=!0)},p(w,Y){(!w[14]&&!w[15]||w[14]&&w[15])&&Ce.p(w,Y),y&&_e.p(w,Y),ke&&ke.p(w,Y),w[6]?se?se.p(w,Y):(se=It(w),se.c(),se.m(p,R)):se&&(se.d(1),se=null),w[7]&&w[7]!=="<br>"?$?$.p(w,Y):($=kt(w),$.c(),$.m(p,W)):$&&($.d(1),$=null),F&&ie.p(w,Y),w[13].driver_comments&&I.p(w,Y),le&&C.p(w,Y),w[8]?D?D.p(w,Y):(D=Ot(w),D.c(),D.m(p,ae)):D&&(D.d(1),D=null),w[15]||L.p(w,Y),(w[14]&&w[15]||!w[14]&&!w[15])&&K.p(w,Y),w[3]?X||(X=Ct(),X.c(),X.m(p,ue)):X&&(X.d(1),X=null),w[1]?Z?Z.p(w,Y):(Z=yt(w),Z.c(),Z.m(p,null)):Z&&(Z.d(1),Z=null),w[10]?z?z.p(w,Y):(z=Lt(w),z.c(),z.m(Ie.parentNode,Ie)):z&&(z.d(1),z=null)},i:Ae,o:Ae,d(w){w&&(a(e),a(h),a(u),a(me),a(Ie)),Ce&&Ce.d(),_e&&_e.d(),ke&&ke.d(),se&&se.d(),$&&$.d(),ie&&ie.d(),I&&I.d(),C&&C.d(),D&&D.d(),L&&L.d(),K&&K.d(),X&&X.d(),Z&&Z.d(),z&&z.d(w),Oe=!1,we()}}}const At=/Teléfono:\s*(\d{10,})/;function ot(i=""){return i.split(",").map(t=>t.trim())}function ao(i,e,t){let r=it,n=document.querySelector("ion-modal"),l=n.componentProps.delivery,f=n.componentProps.isLast||!1,d=n.componentProps.flag||!1,_=l.driver_comments?l.driver_comments:"",k=l.deliver_status?l.deliver_status:"",g=l.img?l.img:"",h=l.img_id?l.img_id:"",u=g?ot(g):new Array,p=h?ot(h):new Array,b={latitude:null,longitude:null},O=l.stopsApproval,A=l.smsActive,V=!1,S=!0,G=!1,q="",j=l.comments_ext,P=!1,B="",E=!1,y="",U=new Object,H="";Ze(()=>{U=JSON.parse(localStorage.getItem("userSession")),W()});async function R(L="",K,X={}){let Z=new FormData;t(3,V=!0);for(const[z,w]of Object.entries(X))Z.append(z,w);Z=ke(Z);try{const z=await fetch(L,{method:"POST",body:Z});if(z.ok){const w=await z.json();K(w)}else console.error("Request failed:",z.statusText)}catch(z){console.error("Error during file upload:",z)}finally{t(3,V=!1)}}function W(){l.date_service?l.date_service&&!l.date_completed&&!l.service_time?(t(4,S=!1),t(5,G=!0)):l.date_service&&l.date_completed&&l.service_time&&(t(4,S=!1),t(5,G=!1)):(t(4,S=!0),t(5,G=!1))}if(l.comments_ext){const L=l.comments_ext.match(At);L&&(q=L[1],j=l.comments_ext.replace(At,"").trim())}const F=async(L,K)=>{await(await je.create({header:L||"Error",message:K||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()},ee=async(L="",K="",X="",Z,z={})=>{await(await je.create({header:L||"Error",message:K||"Vuelva a intentar",buttons:[{text:"No",role:"cancel",handler:()=>{}},{text:"Sí",handler:()=>{R(X,Z,z)}}]})).present()},te=async L=>{if(u.length==5)F("Límite de evidencias","Solo se permite subir 5 fotos por parada");else if(d&&f&&u.length==1)F("Límite de evidencias","Para el final de la ruta solo se permite subir 1 foto");else{const Z=L.target.files[0],z=await ae(Z);if(z){t(1,g=u.join(",")),h=p.join(",");var K=new Object;K.fileToUpload=z,R(`${r}api/admin/manager/upload_img_driver.php`,function(w){t(1,g=g?`${g},${w.img}`:w.img),h=h?`${h},${w.img_id}`:w.img_id,t(2,u=ot(g)),p=ot(h)},K)}}};function le(L){var K=l.service_time;!K&&S&&!f&&!d&&(L.preventDefault(),F("Registrar Ingreso","Antes de subir la evidencia registra el ingreso a la actual parada."))}function pe(){var L=d?l.date_completed:!1;if(!L&&!S&&G&&!f&&!d){var K=new Object;K.id_event=l.id_event,K.type="checkout",ee("Registrar Salida","¿Completaste tu entrega?",r+"api/admin/route/record_check_date.php",function(X){X.minutes&&F("Tiempo por parada","Completaste la parada en "+X.minutes+" minutos.")},K)}}const ae=async L=>new Promise(K=>{const X=new FileReader;X.onload=Z=>{const z=new Image;z.src=Z.target.result,z.onload=()=>{const w=document.createElement("canvas"),Y=w.getContext("2d"),x=800,oe=600;let he=z.width,Te=z.height;he>x&&(Te*=x/he,he=x),Te>oe&&(he*=oe/Te,Te=oe),w.width=he,w.height=Te,Y.drawImage(z,0,0,he,Te),w.toBlob(re=>{K(re)},"image/jpeg",.7)}},X.readAsDataURL(L)}),de=()=>{n.dismiss({data:Date.now()})};function ge(L){t(2,u=u.filter((K,X)=>X!==L))}const ue=async()=>{try{if(t(1,g=u.join(",")),h=p.join(","),pe(),await Ie())if(H.value=="delivered"||H.value!=="delivered"&&(_.value||l.driver_comments)||d&&f){const K={id_route:l.id_route,...!d&&!f&&{id_event:l.id_event},...!d&&!f&&{comments:_.value},...!d&&!f&&{deliver_status:H.value},img:g,img_id:h,lat:b.latitude,lon:b.longitude,...O==="0"&&{approve:"0"},...f&&{isLast:!0},...d&&f&&{destiny:!0}};K.img&&K.img_id||g?R(`${r}api/admin/evidence/send_evidence.php`,function(X){if(X.success==!0){const Z=K.id_route;de(),f&&me("","",Z,f)}else F("Carga fallida","Actualiza la página y vuelve a intentar cargar la información!")},K):F("Información incompleta","Cargar evidencia fotográfica faltante para completar parada.")}else F("Motivo de status de entrega","Favor de ingresar en notas el motivo por el que la entrega no fue entregada correctamente");else F("Ubicación faltante","Asegúrate darle permisos a Rutaflow para acceder a tu ubicación")}catch(L){console.error("Error fetching data:",L)}},me=(L,K,X,Z)=>{n.componentProps.routeId=X,n.componentProps.driverId=l.id_driver,Ue("modal-km-gas",$t,{checklist:L,driverId:K,routeId:X,isLast:Z}).then(z=>{})},Ie=async()=>navigator.geolocation?new Promise((L,K)=>{navigator.geolocation.getCurrentPosition(X=>{b.latitude=X.coords.latitude,b.longitude=X.coords.longitude,L(!0)},X=>{console.error("Error getting location:",X),L(!1)})}):(console.error("Geolocation is not supported by your browser"),!1);async function Oe(L){L.stopPropagation();let K=new FormData;K.append("client_phone",q),K.append("client_name",l.title),K.append("delivery_phone",l.client_phone),K.append("enterprise_name",l.enterprise_name),K=ke(K);try{const X=await fetch(`${r}api/admin/message_central/send_sms.php`,{method:"POST",body:K});if(X.ok){const Z=await X.json();F("SMS enviado","Se envío correctamente un SMS a "+l.title+" con número de teléfono: "+q)}else F("SMS no enviado","Hubo un error al enviar SMS a "+l.title+" con número de teléfono: "+phoneNumber0+". Por favor contacte a soporte.")}catch(X){console.error("Error during file upload:",X)}}function we(){t(4,S=!1),t(5,G=!0),_e(l.id_event,"checkin")}function Ce(){t(5,G=!1),t(4,S=!1),_e(l.id_event,"checkout")}async function _e(L,K){if(K){let X=new FormData;X.append("type",K),X.append("id_event",L),X=ke(X);try{const Z=await fetch(`${r}api/admin/route/record_check_date.php`,{method:"POST",body:X});if(Z.ok){const z=await Z.json();z.minutes&&F("Tiempo por parada","Completaste la parada en "+z.minutes+" minutos.")}else console.error("File upload failed:",Z.statusText)}catch(Z){console.error("Error during file upload:",Z)}finally{}}}const Ne=L=>{t(11,y=L),t(10,E=!0)},ye=()=>{t(10,E=!1),t(11,y=null)};function ke(L){return L.append("token",U.token),L.append("id_user_over",U.id_user),L}function se(L){ln.call(this,i,L)}function $(L){Se[L?"unshift":"push"](()=>{B=L,t(9,B)})}function ie(L){Se[L?"unshift":"push"](()=>{H=L,t(12,H)})}function I(L){Se[L?"unshift":"push"](()=>{_=L,t(0,_)})}return[_,g,u,V,S,G,q,j,P,B,E,y,H,l,f,d,k,A,te,le,de,ge,ue,Oe,we,Ce,Ne,ye,se,$,ie,I,L=>Ne(L),L=>ge(L)]}class zt extends Je{constructor(e){super(),Ye(this,e,ao,ro,We,{},null,[-1,-1])}}function Mt(i){let e;return{c(){e=s("ion-spinner"),this.h()},l(t){e=c(t,"ION-SPINNER",{name:!0}),m(e).forEach(a),this.h()},h(){v(e,"name","dots")},m(t,r){J(t,e,r)},d(t){t&&a(e)}}}function St(i){let e,t,r;return{c(){e=s("section"),t=s("ion-img"),this.h()},l(n){e=c(n,"SECTION",{});var l=m(e);t=c(l,"ION-IMG",{src:!0,alt:!0,style:!0}),m(t).forEach(a),l.forEach(a),this.h()},h(){Ke(t.src,r=i[0])||v(t,"src",r),v(t,"alt","Evidencia fotográfica"),M(t,"max-width","100%"),M(t,"margin-top","16px")},m(n,l){J(n,e,l),o(e,t)},p(n,l){l&1&&!Ke(t.src,r=n[0])&&v(t,"src",r)},d(n){n&&a(e)}}}function so(i){let e,t,r,n,l="Cancelar",f,d,_="AGREGAR GASTO",k,g,h,u,p,b,O,A,V,S,G,q,j,P,B,E,y,U,H='Tipo de pago <ion-text color="danger">(Obligatorio)</ion-text>',R,W,F="Efectivo",ee,te,le="Tarjeta",pe,ae,de="Transferencia",ge,ue,me,Ie,Oe,we,Ce,_e,Ne,ye,ke=`<ion-icon icon="${Zt}" slot="start"></ion-icon>
                        Subir Evidencia`,se,$,ie,I,C,D,L,K,X="Confirmar",Z,z,w=i[5]&&Mt(),Y=i[0]&&St(i);return{c(){e=s("ion-header"),t=s("ion-toolbar"),r=s("ion-buttons"),n=s("ion-button"),n.textContent=l,f=N(),d=s("ion-title"),d.textContent=_,k=N(),g=s("ion-content"),h=s("ion-list"),u=s("ion-item"),p=s("ion-icon"),b=N(),O=s("ion-input"),A=N(),V=s("ion-item"),S=s("ion-icon"),G=N(),q=s("ion-input"),j=N(),P=s("ion-item"),B=s("ion-icon"),E=N(),y=s("ion-select"),U=s("div"),U.innerHTML=H,R=N(),W=s("ion-select-option"),W.textContent=F,ee=N(),te=s("ion-select-option"),te.textContent=le,pe=N(),ae=s("ion-select-option"),ae.textContent=de,ge=N(),ue=s("ion-item"),me=s("ion-icon"),Ie=N(),Oe=s("ion-textarea"),we=N(),Ce=s("section"),_e=s("label"),Ne=s("ion-button"),ye=s("label"),ye.innerHTML=ke,se=N(),$=s("input"),ie=N(),w&&w.c(),I=N(),Y&&Y.c(),C=N(),D=s("ion-footer"),L=s("ion-toolbar"),K=s("ion-button"),K.textContent=X,this.h()},l(x){e=c(x,"ION-HEADER",{translucent:!0});var oe=m(e);t=c(oe,"ION-TOOLBAR",{});var he=m(t);r=c(he,"ION-BUTTONS",{slot:!0});var Te=m(r);n=c(Te,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),ne(n)!=="svelte-1f8rjcf"&&(n.textContent=l),Te.forEach(a),f=T(he),d=c(he,"ION-TITLE",{title:!0,"data-svelte-h":!0}),ne(d)!=="svelte-efps2s"&&(d.textContent=_),he.forEach(a),oe.forEach(a),k=T(x),g=c(x,"ION-CONTENT",{fullscreen:!0});var re=m(g);h=c(re,"ION-LIST",{});var fe=m(h);u=c(fe,"ION-ITEM",{});var ve=m(u);p=c(ve,"ION-ICON",{icon:!0,slot:!0}),m(p).forEach(a),b=T(ve),O=c(ve,"ION-INPUT",{label:!0,type:!0,placeholder:!0,value:!0}),m(O).forEach(a),ve.forEach(a),A=T(fe),V=c(fe,"ION-ITEM",{});var ze=m(V);S=c(ze,"ION-ICON",{icon:!0,slot:!0}),m(S).forEach(a),G=T(ze),q=c(ze,"ION-INPUT",{label:!0,type:!0,value:!0}),m(q).forEach(a),ze.forEach(a),j=T(fe),P=c(fe,"ION-ITEM",{});var Ve=m(P);B=c(Ve,"ION-ICON",{icon:!0,slot:!0}),m(B).forEach(a),E=T(Ve),y=c(Ve,"ION-SELECT",{placeholder:!0,value:!0});var Fe=m(y);U=c(Fe,"DIV",{slot:!0,"data-svelte-h":!0}),ne(U)!=="svelte-wl764p"&&(U.innerHTML=H),R=T(Fe),W=c(Fe,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),ne(W)!=="svelte-i9crym"&&(W.textContent=F),ee=T(Fe),te=c(Fe,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),ne(te)!=="svelte-fx0z11"&&(te.textContent=le),pe=T(Fe),ae=c(Fe,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),ne(ae)!=="svelte-1c24jf2"&&(ae.textContent=de),Fe.forEach(a),Ve.forEach(a),ge=T(fe),ue=c(fe,"ION-ITEM",{});var tt=m(ue);me=c(tt,"ION-ICON",{icon:!0,slot:!0}),m(me).forEach(a),Ie=T(tt),Oe=c(tt,"ION-TEXTAREA",{label:!0,placeholder:!0}),m(Oe).forEach(a),tt.forEach(a),we=T(fe),Ce=c(fe,"SECTION",{});var ht=m(Ce);_e=c(ht,"LABEL",{for:!0,style:!0});var pt=m(_e);Ne=c(pt,"ION-BUTTON",{fill:!0,size:!0,class:!0,expand:!0});var nt=m(Ne);ye=c(nt,"LABEL",{for:!0,style:!0,"data-svelte-h":!0}),ne(ye)!=="svelte-1m9yw22"&&(ye.innerHTML=ke),se=T(nt),$=c(nt,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0}),nt.forEach(a),pt.forEach(a),ht.forEach(a),ie=T(fe),w&&w.l(fe),I=T(fe),Y&&Y.l(fe),fe.forEach(a),re.forEach(a),C=T(x),D=c(x,"ION-FOOTER",{});var mt=m(D);L=c(mt,"ION-TOOLBAR",{});var vt=m(L);K=c(vt,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),ne(K)!=="svelte-1c7dl3f"&&(K.textContent=X),vt.forEach(a),mt.forEach(a),this.h()},h(){v(n,"color","medium"),v(r,"slot","start"),v(d,"title",""),v(e,"translucent",""),v(p,"icon",Qt),v(p,"slot","start"),v(O,"label","Concepto"),v(O,"type","text"),v(O,"placeholder","Escribe aquí..."),v(O,"value",i[6]?i[6]:""),v(S,"icon",st),v(S,"slot","start"),v(q,"label","Cantidad"),v(q,"type","number"),v(q,"value",i[7]?i[7]:""),v(B,"icon",Cn),v(B,"slot","start"),Q(U,"slot","label"),v(W,"value","cash"),v(te,"value","card"),v(ae,"value","transfer"),v(y,"placeholder","Tipo de pago"),v(y,"value",i[8]?i[8]:""),v(me,"icon",st),v(me,"slot","start"),v(Oe,"label","Comentarios"),v(Oe,"placeholder","Escribe aquí..."),Q(ye,"for","eventEvidence"),M(ye,"width","100%"),M(ye,"padding","8px"),M($,"display","none"),Q($,"id","eventEvidence"),Q($,"name","fileToUpload"),Q($,"type","file"),Q($,"accept","image/*"),v(Ne,"fill","outline"),v(Ne,"size","small"),v(Ne,"class","loadEvidence"),v(Ne,"expand","block"),Q(_e,"for","eventEvidence"),M(_e,"display","block"),M(_e,"width","100%"),v(g,"fullscreen",""),v(K,"fill","outline"),v(K,"color","tertiary"),v(K,"strong",""),M(K,"width","99%"),M(K,"height","auto")},m(x,oe){J(x,e,oe),o(e,t),o(t,r),o(r,n),o(t,f),o(t,d),J(x,k,oe),J(x,g,oe),o(g,h),o(h,u),o(u,p),o(u,b),o(u,O),i[12](O),o(h,A),o(h,V),o(V,S),o(V,G),o(V,q),i[13](q),o(h,j),o(h,P),o(P,B),o(P,E),o(P,y),o(y,U),o(y,R),o(y,W),o(y,ee),o(y,te),o(y,pe),o(y,ae),i[14](y),o(h,ge),o(h,ue),o(ue,me),o(ue,Ie),o(ue,Oe),i[15](Oe),o(h,we),o(h,Ce),o(Ce,_e),o(_e,Ne),o(Ne,ye),o(Ne,se),o(Ne,$),o(h,ie),w&&w.m(h,null),o(h,I),Y&&Y.m(h,null),J(x,C,oe),J(x,D,oe),o(D,L),o(L,K),Z||(z=[ce(n,"click",i[10]),ce($,"change",i[9]),ce(K,"click",i[11])],Z=!0)},p(x,[oe]){x[5]?w||(w=Mt(),w.c(),w.m(h,I)):w&&(w.d(1),w=null),x[0]?Y?Y.p(x,oe):(Y=St(x),Y.c(),Y.m(h,null)):Y&&(Y.d(1),Y=null)},i:Ae,o:Ae,d(x){x&&(a(e),a(k),a(g),a(C),a(D)),i[12](null),i[13](null),i[14](null),i[15](null),w&&w.d(),Y&&Y.d(),Z=!1,Be(z)}}}function co(i,e,t){let r=it,n=document.querySelector("ion-modal"),l=n.componentProps.routeId,f=n.componentProps.ex_concept,d=n.componentProps.ex_amount,_=n.componentProps.ex_type,k=n.componentProps.id_expense,g="",h="",u="",p=0,b="",O="",A=!1,V=new Object;Ze(()=>{V=JSON.parse(localStorage.getItem("userSession"))});const S=async(R,W)=>{await(await je.create({header:R||"Error",message:W||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()},G=async R=>{t(5,A=!0);const F=R.target.files[0],ee=await q(F);if(ee){let te=new FormData;te.append("fileToUpload",ee),te=B(te);try{const le=await fetch(`${r}api/admin/manager/upload_img_driver.php`,{method:"POST",body:te});if(le.ok){const pe=await le.json();t(0,g=pe.img),h=pe.img_id}else console.error("File upload failed:",le.statusText)}catch(le){console.error("Error during file upload:",le)}finally{t(5,A=!1)}}},q=async R=>new Promise(W=>{const F=new FileReader;F.onload=ee=>{const te=new Image;te.src=ee.target.result,te.onload=()=>{const le=document.createElement("canvas"),pe=le.getContext("2d"),ae=800,de=600;let ge=te.width,ue=te.height;ge>ae&&(ue*=ae/ge,ge=ae),ue>de&&(ge*=de/ue,ue=de),le.width=ge,le.height=ue,pe.drawImage(te,0,0,ge,ue),le.toBlob(me=>{W(me)},"image/jpeg",.7)}},F.readAsDataURL(R)}),j=()=>{et.dismiss()},P=()=>{var R=new Object;R.id_route=l,R.comments=b.value,R.type=u.value,R.img=g,R.img_id=h,R.amount=p.value,R.concept=O.value,R.status="done",R.id_expense=k||"null";let W=new FormData;for(const F in R)W.append(F,R[F]);W=B(W),!h||!g||!b.value||!p.value||!O.value?S("Datos incompletos","Llena los datos requeridos para completar el registro"):fetch(`${r}api/admin/expenses/add_expense.php`,{method:"POST",body:W}).then(F=>F.json()).then(F=>{j()}).catch(F=>{console.error("Error fetching data:",F)})};function B(R){return R.append("token",V.token),R.append("id_user_over",V.id_user),R}function E(R){Se[R?"unshift":"push"](()=>{O=R,t(4,O)})}function y(R){Se[R?"unshift":"push"](()=>{p=R,t(2,p)})}function U(R){Se[R?"unshift":"push"](()=>{u=R,t(1,u)})}function H(R){Se[R?"unshift":"push"](()=>{b=R,t(3,b)})}return[g,u,p,b,O,A,f,d,_,G,j,P,E,y,U,H]}class ut extends Je{constructor(e){super(),Ye(this,e,co,so,We,{})}}function Dt(i,e,t){const r=i.slice();return r[7]=e[t],r}function uo(i){let e,t="Cargar gasto",r,n;function l(...f){return i[4](i[7],...f)}return{c(){e=s("ion-button"),e.textContent=t,this.h()},l(f){e=c(f,"ION-BUTTON",{fill:!0,size:!0,"aria-selected":!0,"data-svelte-h":!0}),ne(e)!=="svelte-175aelj"&&(e.textContent=t),this.h()},h(){v(e,"fill","outline"),v(e,"size","small"),v(e,"aria-selected","")},m(f,d){J(f,e,d),r||(n=ce(e,"click",l),r=!0)},p(f,d){i=f},d(f){f&&a(e),r=!1,n()}}}function fo(i){let e,t="Gasto completado";return{c(){e=s("ion-button"),e.textContent=t,this.h()},l(r){e=c(r,"ION-BUTTON",{fill:!0,size:!0,"aria-selected":!0,"data-svelte-h":!0}),ne(e)!=="svelte-tlger7"&&(e.textContent=t),this.h()},h(){v(e,"fill","solid"),v(e,"size","small"),v(e,"aria-selected","")},m(r,n){J(r,e,n)},p:Ae,d(r){r&&a(e)}}}function Pt(i,e){let t,r,n,l=e[7].concept+"",f,d,_;function k(u,p){return u[7].status=="done"?fo:uo}let h=k(e)(e);return{key:i,first:null,c(){t=s("ion-item"),r=s("ion-label"),n=s("p"),f=be(l),d=N(),h.c(),_=N(),this.h()},l(u){t=c(u,"ION-ITEM",{});var p=m(t);r=c(p,"ION-LABEL",{style:!0});var b=m(r);n=c(b,"P",{style:!0});var O=m(n);f=Ee(O,l),O.forEach(a),b.forEach(a),d=T(p),h.l(p),_=T(p),p.forEach(a),this.h()},h(){M(n,"margin-left","10px"),M(r,"display","flex"),this.first=t},m(u,p){J(u,t,p),o(t,r),o(r,n),o(n,f),o(t,d),h.m(t,null),o(t,_)},p(u,p){e=u,h.p(e,p)},d(u){u&&a(t),h.d()}}}function _o(i){let e,t,r,n,l=`<ion-icon style="font-size: 25px!important;" icon="${yn}"></ion-icon>`,f,d,_="LISTA DE GASTOS",k,g,h,u=[],p=new Map,b,O,A,V="Cerrar",S,G,q=He(i[0]);const j=P=>P[7].id_expenses;for(let P=0;P<q.length;P+=1){let B=Dt(i,q,P),E=j(B);p.set(E,u[P]=Pt(E,B))}return{c(){e=s("ion-header"),t=s("ion-toolbar"),r=s("ion-buttons"),n=s("ion-button"),n.innerHTML=l,f=N(),d=s("ion-title"),d.textContent=_,k=N(),g=s("ion-content"),h=s("ion-list");for(let P=0;P<u.length;P+=1)u[P].c();b=N(),O=s("ion-footer"),A=s("ion-button"),A.textContent=V,this.h()},l(P){e=c(P,"ION-HEADER",{translucent:!0});var B=m(e);t=c(B,"ION-TOOLBAR",{});var E=m(t);r=c(E,"ION-BUTTONS",{slot:!0});var y=m(r);n=c(y,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),ne(n)!=="svelte-160xz3i"&&(n.innerHTML=l),y.forEach(a),f=T(E),d=c(E,"ION-TITLE",{"data-svelte-h":!0}),ne(d)!=="svelte-1phn90x"&&(d.textContent=_),E.forEach(a),B.forEach(a),k=T(P),g=c(P,"ION-CONTENT",{fullscreen:!0});var U=m(g);h=c(U,"ION-LIST",{});var H=m(h);for(let W=0;W<u.length;W+=1)u[W].l(H);H.forEach(a),U.forEach(a),b=T(P),O=c(P,"ION-FOOTER",{});var R=m(O);A=c(R,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),ne(A)!=="svelte-zv7v83"&&(A.textContent=V),R.forEach(a),this.h()},h(){v(n,"color","medium"),v(r,"slot","end"),v(e,"translucent",""),v(g,"fullscreen",""),v(A,"fill","outline"),v(A,"color","tertiary"),v(A,"strong",""),M(A,"width","99%"),M(A,"height","auto")},m(P,B){J(P,e,B),o(e,t),o(t,r),o(r,n),o(t,f),o(t,d),J(P,k,B),J(P,g,B),o(g,h);for(let E=0;E<u.length;E+=1)u[E]&&u[E].m(h,null);J(P,b,B),J(P,O,B),o(O,A),S||(G=[ce(n,"click",i[3]),ce(A,"click",i[1])],S=!0)},p(P,[B]){B&5&&(q=He(P[0]),u=xe(u,B,j,1,P,q,p,h,$e,Pt,null,Dt))},i:Ae,o:Ae,d(P){P&&(a(e),a(k),a(g),a(b),a(O));for(let B=0;B<u.length;B+=1)u[B].d();S=!1,Be(G)}}}function ho(i){let e=document.querySelector("ion-modal");e.componentProps.routeId;let t=e.componentProps.expenses;Ze(()=>{});const r=()=>{et.dismiss()};function n(d,_,k,g,h){e.componentProps.ex_amount=k,e.componentProps.ex_concept=_,e.componentProps.ex_type=g,e.componentProps.id_expense=h,Ue("modal-expense",ut,{amount:k,concept:_,type:g,id_expense:h}).then(()=>{}),r()}return[t,r,n,d=>{Ue("modal-expense",ut,{routeId:d}).then(_=>{}),r()},(d,_)=>n(_,d.concept,d.amount,d.type,d.id_expenses)]}class po extends Je{constructor(e){super(),Ye(this,e,ho,_o,We,{})}}const{document:Bt}=Dn;function Ht(i,e,t){const r=i.slice();return r[48]=e[t],r[50]=t,r}function Rt(i,e,t){const r=i.slice();return r[48]=e[t],r[50]=t,r}function Ut(i,e,t){const r=i.slice();return r[48]=e[t],r[50]=t,r}function Vt(i){let e,t;return e=new zn({props:{$$slots:{default:[ko]},$$scope:{ctx:i}}}),{c(){un(e.$$.fragment)},l(r){fn(e.$$.fragment,r)},m(r,n){dn(e,r,n),t=!0},p(r,n){const l={};n[0]&1019|n[1]&4194304&&(l.$$scope={dirty:n,ctx:r}),e.$set(l)},i(r){t||(lt(e.$$.fragment,r),t=!0)},o(r){at(e.$$.fragment,r),t=!1},d(r){_n(e,r)}}}function mo(i){let e,t='<div id="g_map" style="width: 100%; height: 100vh;"></div>';return{c(){e=s("ion-content"),e.innerHTML=t},l(r){e=c(r,"ION-CONTENT",{"data-svelte-h":!0}),ne(e)!=="svelte-1ydw6i9"&&(e.innerHTML=t)},m(r,n){J(r,e,n)},p:Ae,d(r){r&&a(e)}}}function vo(i){let e;function t(l,f){if(l[7].length>0)return bo;if(!l[3])return go}let r=t(i),n=r&&r(i);return{c(){n&&n.c(),e=De()},l(l){n&&n.l(l),e=De()},m(l,f){n&&n.m(l,f),J(l,e,f)},p(l,f){r===(r=t(l))&&n?n.p(l,f):(n&&n.d(1),n=r&&r(l),n&&(n.c(),n.m(e.parentNode,e)))},d(l){l&&a(e),n&&n.d(l)}}}function go(i){let e,t,r,n='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Jala para actualizar" refreshing-spinner="circles" refreshing-text="Actualizando..."></ion-refresher-content>',l,f,d,_,k,g,h="0",u,p,b,O,A,V=i[6].origin+"",S,G,q,j="",P,B,E,y=[],U=new Map,H,R,W,F,ee,te=i[5].length+1+"",le,pe,ae,de,ge,ue,me=i[6].destination+"",Ie,Oe,we,Ce="",_e,Ne,ye,ke,se=i[4]&&Ft(i),$=He(i[5]);const ie=I=>I[48].id_event;for(let I=0;I<$.length;I+=1){let C=Ht(i,$,I),D=ie(C);U.set(D,y[I]=jt(D,C))}return{c(){se&&se.c(),e=N(),t=s("ion-content"),r=s("ion-refresher"),r.innerHTML=n,l=N(),f=s("ion-list"),d=s("ion-item"),_=s("ion-avatar"),k=s("div"),g=s("div"),g.textContent=h,p=N(),b=s("ion-label"),O=s("ion-text"),A=s("h3"),S=be(V),G=N(),q=s("div"),q.innerHTML=j,P=N(),B=s("ion-icon"),E=N();for(let I=0;I<y.length;I+=1)y[I].c();H=N(),R=s("ion-item"),W=s("ion-avatar"),F=s("div"),ee=s("div"),le=be(te),ae=N(),de=s("ion-label"),ge=s("ion-text"),ue=s("h3"),Ie=be(me),Oe=N(),we=s("div"),we.innerHTML=Ce,_e=N(),Ne=s("ion-icon"),this.h()},l(I){se&&se.l(I),e=T(I),t=c(I,"ION-CONTENT",{});var C=m(t);r=c(C,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),ne(r)!=="svelte-1srnbs3"&&(r.innerHTML=n),l=T(C),f=c(C,"ION-LIST",{});var D=m(f);d=c(D,"ION-ITEM",{});var L=m(d);_=c(L,"ION-AVATAR",{slot:!0});var K=m(_);k=c(K,"DIV",{class:!0,title:!0,style:!0});var X=m(k);g=c(X,"DIV",{class:!0,"data-svelte-h":!0}),ne(g)!=="svelte-3lvlrb"&&(g.textContent=h),X.forEach(a),K.forEach(a),p=T(L),b=c(L,"ION-LABEL",{button:!0});var Z=m(b);O=c(Z,"ION-TEXT",{color:!0});var z=m(O);A=c(z,"H3",{});var w=m(A);S=Ee(w,V),w.forEach(a),z.forEach(a),G=T(Z),q=c(Z,"DIV",{class:!0,"data-svelte-h":!0}),ne(q)!=="svelte-gz9kb"&&(q.innerHTML=j),Z.forEach(a),P=T(L),B=c(L,"ION-ICON",{icon:!0,slot:!0}),m(B).forEach(a),L.forEach(a),E=T(D);for(let ve=0;ve<y.length;ve+=1)y[ve].l(D);H=T(D),R=c(D,"ION-ITEM",{});var Y=m(R);W=c(Y,"ION-AVATAR",{slot:!0});var x=m(W);F=c(x,"DIV",{class:!0,title:!0,style:!0});var oe=m(F);ee=c(oe,"DIV",{class:!0});var he=m(ee);le=Ee(he,te),he.forEach(a),oe.forEach(a),x.forEach(a),ae=T(Y),de=c(Y,"ION-LABEL",{button:!0});var Te=m(de);ge=c(Te,"ION-TEXT",{color:!0});var re=m(ge);ue=c(re,"H3",{});var fe=m(ue);Ie=Ee(fe,me),fe.forEach(a),re.forEach(a),Oe=T(Te),we=c(Te,"DIV",{class:!0,"data-svelte-h":!0}),ne(we)!=="svelte-130ohbs"&&(we.innerHTML=Ce),Te.forEach(a),_e=T(Y),Ne=c(Y,"ION-ICON",{icon:!0,slot:!0}),m(Ne).forEach(a),Y.forEach(a),D.forEach(a),C.forEach(a),this.h()},h(){v(r,"slot","fixed"),Q(g,"class","order svelte-egzizz"),Q(k,"class","order-wrapper svelte-egzizz"),Q(k,"title",u="$"+i[6].origin),M(k,"background-color",i[6].color),M(k,"color",Me(i[6].color)),v(_,"slot","start"),v(O,"color","#2e2e2e"),Q(q,"class","sub svelte-egzizz"),v(b,"button",""),v(B,"icon",Re),v(B,"slot","end"),Q(ee,"class","order svelte-egzizz"),Q(F,"class","order-wrapper svelte-egzizz"),Q(F,"title",pe="$"+i[6].destination),M(F,"background-color",i[6].color),M(F,"color",Me(i[6].color)),v(W,"slot","start"),v(ge,"color","#2e2e2e"),Q(we,"class","sub svelte-egzizz"),v(de,"button",""),v(Ne,"icon",Re),v(Ne,"slot","end")},m(I,C){se&&se.m(I,C),J(I,e,C),J(I,t,C),o(t,r),i[30](r),o(t,l),o(t,f),o(f,d),o(d,_),o(_,k),o(k,g),o(d,p),o(d,b),o(b,O),o(O,A),o(A,S),o(b,G),o(b,q),o(d,P),o(d,B),o(f,E);for(let D=0;D<y.length;D+=1)y[D]&&y[D].m(f,null);o(f,H),o(f,R),o(R,W),o(W,F),o(F,ee),o(ee,le),o(R,ae),o(R,de),o(de,ge),o(ge,ue),o(ue,Ie),o(de,Oe),o(de,we),o(R,_e),o(R,Ne),ye||(ke=[ce(r,"ionRefresh",i[10]),ce(b,"click",i[31]),ce(de,"click",i[33])],ye=!0)},p(I,C){I[4]?se?se.p(I,C):(se=Ft(I),se.c(),se.m(e.parentNode,e)):se&&(se.d(1),se=null),C[0]&64&&u!==(u="$"+I[6].origin)&&Q(k,"title",u),C[0]&64&&M(k,"background-color",I[6].color),C[0]&64&&M(k,"color",Me(I[6].color)),C[0]&64&&V!==(V=I[6].origin+"")&&Le(S,V),C[0]&331808&&($=He(I[5]),y=xe(y,C,ie,1,I,$,U,f,$e,jt,H,Ht)),C[0]&32&&te!==(te=I[5].length+1+"")&&Le(le,te),C[0]&64&&pe!==(pe="$"+I[6].destination)&&Q(F,"title",pe),C[0]&64&&M(F,"background-color",I[6].color),C[0]&64&&M(F,"color",Me(I[6].color)),C[0]&64&&me!==(me=I[6].destination+"")&&Le(Ie,me)},d(I){I&&(a(e),a(t)),se&&se.d(I),i[30](null);for(let C=0;C<y.length;C+=1)y[C].d();ye=!1,Be(ke)}}}function bo(i){let e,t;function r(f,d){return d[0]&144&&(e=null),e==null&&(e=!!(f[7].filter(No).every(To)&&!f[4])),e?Io:Eo}let n=r(i,[-1,-1]),l=n(i);return{c(){l.c(),t=De()},l(f){l.l(f),t=De()},m(f,d){l.m(f,d),J(f,t,d)},p(f,d){n===(n=r(f,d))&&l?l.p(f,d):(l.d(1),l=n(f),l&&(l.c(),l.m(t.parentNode,t)))},d(f){f&&a(t),l.d(f)}}}function Ft(i){let e=i[14]("",i[1],i[0])+"",t;return{c(){t=be(e)},l(r){t=Ee(r,e)},m(r,n){J(r,t,n)},p(r,n){n[0]&3&&e!==(e=r[14]("",r[1],r[0])+"")&&Le(t,e)},d(r){r&&a(t)}}}function qt(i){let e;return{c(){e=s("span"),this.h()},l(t){e=c(t,"SPAN",{class:!0}),m(e).forEach(a),this.h()},h(){Q(e,"class","notes svelte-egzizz")},m(t,r){J(t,e,r)},d(t){t&&a(e)}}}function jt(i,e){let t,r,n,l,f=parseInt(e[48].pos)+1+"",d,_,k,g,h,u,p=e[48].title+"",b,O,A=e[48].support_list&&e[48].support_list.length||e[16](e[48]),V,S,G,q,j=A&&qt();function P(){return e[32](e[48])}return{key:i,first:null,c(){t=s("ion-item"),r=s("ion-avatar"),n=s("div"),l=s("div"),d=be(f),k=N(),g=s("ion-label"),h=s("ion-text"),u=s("h3"),b=be(p),O=N(),j&&j.c(),V=N(),S=s("ion-icon"),this.h()},l(B){t=c(B,"ION-ITEM",{});var E=m(t);r=c(E,"ION-AVATAR",{slot:!0});var y=m(r);n=c(y,"DIV",{class:!0,title:!0,style:!0});var U=m(n);l=c(U,"DIV",{class:!0});var H=m(l);d=Ee(H,f),H.forEach(a),U.forEach(a),y.forEach(a),k=T(E),g=c(E,"ION-LABEL",{button:!0});var R=m(g);h=c(R,"ION-TEXT",{color:!0});var W=m(h);u=c(W,"H3",{});var F=m(u);b=Ee(F,p),O=T(F),j&&j.l(F),F.forEach(a),W.forEach(a),R.forEach(a),V=T(E),S=c(E,"ION-ICON",{icon:!0,slot:!0,style:!0}),m(S).forEach(a),E.forEach(a),this.h()},h(){Q(l,"class","order svelte-egzizz"),Q(n,"class","order-wrapper svelte-egzizz"),Q(n,"title",_=Xe(e[48].status)),M(n,"background-color",Pe(e[48].status,e[48].date_service)),M(n,"color",Me(Pe(e[48].status))),v(r,"slot","start"),v(h,"color","#2e2e2e"),v(g,"button",""),v(S,"icon",Re),v(S,"slot","end"),M(S,"color",Pe(e[48].status,e[48].date_service)),this.first=t},m(B,E){J(B,t,E),o(t,r),o(r,n),o(n,l),o(l,d),o(t,k),o(t,g),o(g,h),o(h,u),o(u,b),o(u,O),j&&j.m(u,null),o(t,V),o(t,S),G||(q=ce(g,"click",P),G=!0)},p(B,E){e=B,E[0]&32&&f!==(f=parseInt(e[48].pos)+1+"")&&Le(d,f),E[0]&32&&_!==(_=Xe(e[48].status))&&Q(n,"title",_),E[0]&32&&M(n,"background-color",Pe(e[48].status,e[48].date_service)),E[0]&32&&M(n,"color",Me(Pe(e[48].status))),E[0]&32&&p!==(p=e[48].title+"")&&Le(b,p),E[0]&32&&(A=e[48].support_list&&e[48].support_list.length||e[16](e[48])),A?j||(j=qt(),j.c(),j.m(u,null)):j&&(j.d(1),j=null),E[0]&32&&M(S,"color",Pe(e[48].status,e[48].date_service))},d(B){B&&a(t),j&&j.d(),G=!1,q()}}}function Eo(i){let e=i[14](i[7],i[1],i[0])+"",t,r,n,l,f='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Pull to refresh" refreshing-spinner="circles" refreshing-text="Refreshing..."></ion-refresher-content>',d,_,k,g,h,u,p="0",b,O,A,V,S,G=i[6].origin+"",q,j,P,B="",E,y,U,H=[],R=new Map,W,F,ee,te,le,pe=i[5].length+1+"",ae,de,ge,ue,me,Ie,Oe=i[6].destination+"",we,Ce,_e,Ne="",ye,ke,se,$,ie=He(i[5]);const I=C=>C[48].id_event;for(let C=0;C<ie.length;C+=1){let D=Rt(i,ie,C),L=I(D);R.set(L,H[C]=Kt(L,D))}return{c(){t=be(e),r=N(),n=s("ion-content"),l=s("ion-refresher"),l.innerHTML=f,d=N(),_=s("ion-list"),k=s("ion-item"),g=s("ion-avatar"),h=s("div"),u=s("div"),u.textContent=p,O=N(),A=s("ion-label"),V=s("ion-text"),S=s("h3"),q=be(G),j=N(),P=s("div"),P.innerHTML=B,E=N(),y=s("ion-icon"),U=N();for(let C=0;C<H.length;C+=1)H[C].c();W=N(),F=s("ion-item"),ee=s("ion-avatar"),te=s("div"),le=s("div"),ae=be(pe),ge=N(),ue=s("ion-label"),me=s("ion-text"),Ie=s("h3"),we=be(Oe),Ce=N(),_e=s("div"),_e.innerHTML=Ne,ye=N(),ke=s("ion-icon"),this.h()},l(C){t=Ee(C,e),r=T(C),n=c(C,"ION-CONTENT",{});var D=m(n);l=c(D,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),ne(l)!=="svelte-dvt1s"&&(l.innerHTML=f),d=T(D),_=c(D,"ION-LIST",{});var L=m(_);k=c(L,"ION-ITEM",{});var K=m(k);g=c(K,"ION-AVATAR",{slot:!0});var X=m(g);h=c(X,"DIV",{class:!0,title:!0,style:!0});var Z=m(h);u=c(Z,"DIV",{class:!0,"data-svelte-h":!0}),ne(u)!=="svelte-3lvlrb"&&(u.textContent=p),Z.forEach(a),X.forEach(a),O=T(K),A=c(K,"ION-LABEL",{button:!0});var z=m(A);V=c(z,"ION-TEXT",{color:!0});var w=m(V);S=c(w,"H3",{});var Y=m(S);q=Ee(Y,G),Y.forEach(a),w.forEach(a),j=T(z),P=c(z,"DIV",{class:!0,"data-svelte-h":!0}),ne(P)!=="svelte-gz9kb"&&(P.innerHTML=B),z.forEach(a),E=T(K),y=c(K,"ION-ICON",{icon:!0,slot:!0}),m(y).forEach(a),K.forEach(a),U=T(L);for(let ze=0;ze<H.length;ze+=1)H[ze].l(L);W=T(L),F=c(L,"ION-ITEM",{});var x=m(F);ee=c(x,"ION-AVATAR",{slot:!0});var oe=m(ee);te=c(oe,"DIV",{class:!0,title:!0,style:!0});var he=m(te);le=c(he,"DIV",{class:!0});var Te=m(le);ae=Ee(Te,pe),Te.forEach(a),he.forEach(a),oe.forEach(a),ge=T(x),ue=c(x,"ION-LABEL",{button:!0});var re=m(ue);me=c(re,"ION-TEXT",{color:!0});var fe=m(me);Ie=c(fe,"H3",{});var ve=m(Ie);we=Ee(ve,Oe),ve.forEach(a),fe.forEach(a),Ce=T(re),_e=c(re,"DIV",{class:!0,"data-svelte-h":!0}),ne(_e)!=="svelte-130ohbs"&&(_e.innerHTML=Ne),re.forEach(a),ye=T(x),ke=c(x,"ION-ICON",{icon:!0,slot:!0}),m(ke).forEach(a),x.forEach(a),L.forEach(a),D.forEach(a),this.h()},h(){v(l,"slot","fixed"),Q(u,"class","order svelte-egzizz"),Q(h,"class","order-wrapper svelte-egzizz"),Q(h,"title",b="$"+i[6].origin),M(h,"background-color",i[6].color),M(h,"color",Me(i[6].color)),v(g,"slot","start"),v(V,"color","#2e2e2e"),Q(P,"class","sub svelte-egzizz"),v(A,"button",""),v(y,"icon",Re),v(y,"slot","end"),Q(le,"class","order svelte-egzizz"),Q(te,"class","order-wrapper svelte-egzizz"),Q(te,"title",de="$"+i[6].destination),M(te,"background-color",i[6].color),M(te,"color",Me(i[6].color)),v(ee,"slot","start"),v(me,"color","#2e2e2e"),Q(_e,"class","sub svelte-egzizz"),v(ue,"button",""),v(ke,"icon",Re),v(ke,"slot","end")},m(C,D){J(C,t,D),J(C,r,D),J(C,n,D),o(n,l),i[26](l),o(n,d),o(n,_),o(_,k),o(k,g),o(g,h),o(h,u),o(k,O),o(k,A),o(A,V),o(V,S),o(S,q),o(A,j),o(A,P),o(k,E),o(k,y),o(_,U);for(let L=0;L<H.length;L+=1)H[L]&&H[L].m(_,null);o(_,W),o(_,F),o(F,ee),o(ee,te),o(te,le),o(le,ae),o(F,ge),o(F,ue),o(ue,me),o(me,Ie),o(Ie,we),o(ue,Ce),o(ue,_e),o(F,ye),o(F,ke),se||($=[ce(l,"ionRefresh",i[10]),ce(A,"click",i[27]),ce(ue,"click",i[29])],se=!0)},p(C,D){D[0]&131&&e!==(e=C[14](C[7],C[1],C[0])+"")&&Le(t,e),D[0]&64&&b!==(b="$"+C[6].origin)&&Q(h,"title",b),D[0]&64&&M(h,"background-color",C[6].color),D[0]&64&&M(h,"color",Me(C[6].color)),D[0]&64&&G!==(G=C[6].origin+"")&&Le(q,G),D[0]&331808&&(ie=He(C[5]),H=xe(H,D,I,1,C,ie,R,_,$e,Kt,W,Rt)),D[0]&32&&pe!==(pe=C[5].length+1+"")&&Le(ae,pe),D[0]&64&&de!==(de="$"+C[6].destination)&&Q(te,"title",de),D[0]&64&&M(te,"background-color",C[6].color),D[0]&64&&M(te,"color",Me(C[6].color)),D[0]&64&&Oe!==(Oe=C[6].destination+"")&&Le(we,Oe)},d(C){C&&(a(t),a(r),a(n)),i[26](null);for(let D=0;D<H.length;D+=1)H[D].d();se=!1,Be($)}}}function Io(i){let e,t,r='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Jale para actualizar" refreshing-spinner="circles" refreshing-text="Actualizando..."></ion-refresher-content>',n,l,f,d,_,k,g="0",h,u,p,b,O,A=i[6].origin+"",V,S,G,q="",j,P,B,E=[],y=new Map,U,H,R,W,F,ee=i[5].length+1+"",te,le,pe,ae,de,ge,ue=i[6].destination+"",me,Ie,Oe,we="",Ce,_e,Ne,ye,ke=He(i[5]);const se=$=>$[48].id_event;for(let $=0;$<ke.length;$+=1){let ie=Ut(i,ke,$),I=se(ie);y.set(I,E[$]=Wt(I,ie))}return{c(){e=s("ion-content"),t=s("ion-refresher"),t.innerHTML=r,n=N(),l=s("ion-list"),f=s("ion-item"),d=s("ion-avatar"),_=s("div"),k=s("div"),k.textContent=g,u=N(),p=s("ion-label"),b=s("ion-text"),O=s("h3"),V=be(A),S=N(),G=s("div"),G.innerHTML=q,j=N(),P=s("ion-icon"),B=N();for(let $=0;$<E.length;$+=1)E[$].c();U=N(),H=s("ion-item"),R=s("ion-avatar"),W=s("div"),F=s("div"),te=be(ee),pe=N(),ae=s("ion-label"),de=s("ion-text"),ge=s("h3"),me=be(ue),Ie=N(),Oe=s("div"),Oe.innerHTML=we,Ce=N(),_e=s("ion-icon"),this.h()},l($){e=c($,"ION-CONTENT",{});var ie=m(e);t=c(ie,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),ne(t)!=="svelte-15ukrgn"&&(t.innerHTML=r),n=T(ie),l=c(ie,"ION-LIST",{});var I=m(l);f=c(I,"ION-ITEM",{});var C=m(f);d=c(C,"ION-AVATAR",{slot:!0});var D=m(d);_=c(D,"DIV",{class:!0,title:!0,style:!0});var L=m(_);k=c(L,"DIV",{class:!0,"data-svelte-h":!0}),ne(k)!=="svelte-3lvlrb"&&(k.textContent=g),L.forEach(a),D.forEach(a),u=T(C),p=c(C,"ION-LABEL",{button:!0});var K=m(p);b=c(K,"ION-TEXT",{color:!0});var X=m(b);O=c(X,"H3",{});var Z=m(O);V=Ee(Z,A),Z.forEach(a),X.forEach(a),S=T(K),G=c(K,"DIV",{class:!0,"data-svelte-h":!0}),ne(G)!=="svelte-gz9kb"&&(G.innerHTML=q),K.forEach(a),j=T(C),P=c(C,"ION-ICON",{icon:!0,slot:!0}),m(P).forEach(a),C.forEach(a),B=T(I);for(let re=0;re<E.length;re+=1)E[re].l(I);U=T(I),H=c(I,"ION-ITEM",{});var z=m(H);R=c(z,"ION-AVATAR",{slot:!0});var w=m(R);W=c(w,"DIV",{class:!0,title:!0,style:!0});var Y=m(W);F=c(Y,"DIV",{class:!0});var x=m(F);te=Ee(x,ee),x.forEach(a),Y.forEach(a),w.forEach(a),pe=T(z),ae=c(z,"ION-LABEL",{button:!0});var oe=m(ae);de=c(oe,"ION-TEXT",{color:!0});var he=m(de);ge=c(he,"H3",{});var Te=m(ge);me=Ee(Te,ue),Te.forEach(a),he.forEach(a),Ie=T(oe),Oe=c(oe,"DIV",{class:!0,"data-svelte-h":!0}),ne(Oe)!=="svelte-130ohbs"&&(Oe.innerHTML=we),oe.forEach(a),Ce=T(z),_e=c(z,"ION-ICON",{icon:!0,slot:!0}),m(_e).forEach(a),z.forEach(a),I.forEach(a),ie.forEach(a),this.h()},h(){v(t,"slot","fixed"),Q(k,"class","order svelte-egzizz"),Q(_,"class","order-wrapper svelte-egzizz"),Q(_,"title",h="$"+i[6].origin),M(_,"background-color",i[6].color),M(_,"color",Me(i[6].color)),v(d,"slot","start"),v(b,"color","#2e2e2e"),Q(G,"class","sub svelte-egzizz"),v(p,"button",""),v(P,"icon",Re),v(P,"slot","end"),Q(F,"class","order svelte-egzizz"),Q(W,"class","order-wrapper svelte-egzizz"),Q(W,"title",le="$"+i[6].destination),M(W,"background-color",i[6].color),M(W,"color",Me(i[6].color)),v(R,"slot","start"),v(de,"color","#2e2e2e"),Q(Oe,"class","sub svelte-egzizz"),v(ae,"button",""),v(_e,"icon",Re),v(_e,"slot","end")},m($,ie){J($,e,ie),o(e,t),i[22](t),o(e,n),o(e,l),o(l,f),o(f,d),o(d,_),o(_,k),o(f,u),o(f,p),o(p,b),o(b,O),o(O,V),o(p,S),o(p,G),o(f,j),o(f,P),o(l,B);for(let I=0;I<E.length;I+=1)E[I]&&E[I].m(l,null);o(l,U),o(l,H),o(H,R),o(R,W),o(W,F),o(F,te),o(H,pe),o(H,ae),o(ae,de),o(de,ge),o(ge,me),o(ae,Ie),o(ae,Oe),o(H,Ce),o(H,_e),Ne||(ye=[ce(t,"ionRefresh",i[10]),ce(p,"click",i[23]),ce(ae,"click",i[25])],Ne=!0)},p($,ie){ie[0]&64&&h!==(h="$"+$[6].origin)&&Q(_,"title",h),ie[0]&64&&M(_,"background-color",$[6].color),ie[0]&64&&M(_,"color",Me($[6].color)),ie[0]&64&&A!==(A=$[6].origin+"")&&Le(V,A),ie[0]&331808&&(ke=He($[5]),E=xe(E,ie,se,1,$,ke,y,l,$e,Wt,U,Ut)),ie[0]&32&&ee!==(ee=$[5].length+1+"")&&Le(te,ee),ie[0]&64&&le!==(le="$"+$[6].destination)&&Q(W,"title",le),ie[0]&64&&M(W,"background-color",$[6].color),ie[0]&64&&M(W,"color",Me($[6].color)),ie[0]&64&&ue!==(ue=$[6].destination+"")&&Le(me,ue)},d($){$&&a(e),i[22](null);for(let ie=0;ie<E.length;ie+=1)E[ie].d();Ne=!1,Be(ye)}}}function Gt(i){let e;return{c(){e=s("span"),this.h()},l(t){e=c(t,"SPAN",{class:!0}),m(e).forEach(a),this.h()},h(){Q(e,"class","notes svelte-egzizz")},m(t,r){J(t,e,r)},d(t){t&&a(e)}}}function Kt(i,e){let t,r,n,l,f=parseInt(e[48].pos)+1+"",d,_,k,g,h,u,p=e[48].title+"",b,O,A=e[48].support_list&&e[48].support_list.length||e[16](e[48]),V,S,G="",q,j,P,B,E=A&&Gt();function y(){return e[28](e[48])}return{key:i,first:null,c(){t=s("ion-item"),r=s("ion-avatar"),n=s("div"),l=s("div"),d=be(f),k=N(),g=s("ion-label"),h=s("ion-text"),u=s("h3"),b=be(p),O=N(),E&&E.c(),V=N(),S=s("div"),S.innerHTML=G,q=N(),j=s("ion-icon"),this.h()},l(U){t=c(U,"ION-ITEM",{});var H=m(t);r=c(H,"ION-AVATAR",{slot:!0});var R=m(r);n=c(R,"DIV",{class:!0,title:!0,style:!0});var W=m(n);l=c(W,"DIV",{class:!0});var F=m(l);d=Ee(F,f),F.forEach(a),W.forEach(a),R.forEach(a),k=T(H),g=c(H,"ION-LABEL",{button:!0});var ee=m(g);h=c(ee,"ION-TEXT",{color:!0});var te=m(h);u=c(te,"H3",{});var le=m(u);b=Ee(le,p),O=T(le),E&&E.l(le),le.forEach(a),te.forEach(a),V=T(ee),S=c(ee,"DIV",{class:!0,"data-svelte-h":!0}),ne(S)!=="svelte-qaecoo"&&(S.innerHTML=G),ee.forEach(a),q=T(H),j=c(H,"ION-ICON",{icon:!0,slot:!0}),m(j).forEach(a),H.forEach(a),this.h()},h(){Q(l,"class","order svelte-egzizz"),Q(n,"class","order-wrapper svelte-egzizz"),Q(n,"title",_=Xe(e[48].status)),M(n,"background-color",Pe(e[48].status,e[48].date_service)),M(n,"color",Me(Pe(e[48].status))),v(r,"slot","start"),v(h,"color","#2e2e2e"),Q(S,"class","sub svelte-egzizz"),v(g,"button",""),v(j,"icon",Re),v(j,"slot","end"),this.first=t},m(U,H){J(U,t,H),o(t,r),o(r,n),o(n,l),o(l,d),o(t,k),o(t,g),o(g,h),o(h,u),o(u,b),o(u,O),E&&E.m(u,null),o(g,V),o(g,S),o(t,q),o(t,j),P||(B=ce(g,"click",y),P=!0)},p(U,H){e=U,H[0]&32&&f!==(f=parseInt(e[48].pos)+1+"")&&Le(d,f),H[0]&32&&_!==(_=Xe(e[48].status))&&Q(n,"title",_),H[0]&32&&M(n,"background-color",Pe(e[48].status,e[48].date_service)),H[0]&32&&M(n,"color",Me(Pe(e[48].status))),H[0]&32&&p!==(p=e[48].title+"")&&Le(b,p),H[0]&32&&(A=e[48].support_list&&e[48].support_list.length||e[16](e[48])),A?E||(E=Gt(),E.c(),E.m(u,null)):E&&(E.d(1),E=null)},d(U){U&&a(t),E&&E.d(),P=!1,B()}}}function Xt(i){let e;return{c(){e=s("span"),this.h()},l(t){e=c(t,"SPAN",{class:!0}),m(e).forEach(a),this.h()},h(){Q(e,"class","notes svelte-egzizz")},m(t,r){J(t,e,r)},d(t){t&&a(e)}}}function Wt(i,e){let t,r,n,l,f=parseInt(e[48].pos)+1+"",d,_,k,g,h,u,p=e[48].title+"",b,O,A=e[48].support_list&&e[48].support_list.length||e[16](e[48]),V,S,G="",q,j,P,B,E=A&&Xt();function y(){return e[24](e[48])}return{key:i,first:null,c(){t=s("ion-item"),r=s("ion-avatar"),n=s("div"),l=s("div"),d=be(f),k=N(),g=s("ion-label"),h=s("ion-text"),u=s("h3"),b=be(p),O=N(),E&&E.c(),V=N(),S=s("div"),S.innerHTML=G,q=N(),j=s("ion-icon"),this.h()},l(U){t=c(U,"ION-ITEM",{});var H=m(t);r=c(H,"ION-AVATAR",{slot:!0});var R=m(r);n=c(R,"DIV",{class:!0,title:!0,style:!0});var W=m(n);l=c(W,"DIV",{class:!0});var F=m(l);d=Ee(F,f),F.forEach(a),W.forEach(a),R.forEach(a),k=T(H),g=c(H,"ION-LABEL",{button:!0});var ee=m(g);h=c(ee,"ION-TEXT",{color:!0});var te=m(h);u=c(te,"H3",{});var le=m(u);b=Ee(le,p),O=T(le),E&&E.l(le),le.forEach(a),te.forEach(a),V=T(ee),S=c(ee,"DIV",{class:!0,"data-svelte-h":!0}),ne(S)!=="svelte-qaecoo"&&(S.innerHTML=G),ee.forEach(a),q=T(H),j=c(H,"ION-ICON",{icon:!0,slot:!0}),m(j).forEach(a),H.forEach(a),this.h()},h(){Q(l,"class","order svelte-egzizz"),Q(n,"class","order-wrapper svelte-egzizz"),Q(n,"title",_=Xe(e[48].status)),M(n,"background-color",Pe(e[48].status,e[48].date_service)),M(n,"color",Me(Pe(e[48].status))),v(r,"slot","start"),v(h,"color","#2e2e2e"),Q(S,"class","sub svelte-egzizz"),v(g,"button",""),v(j,"icon",Re),v(j,"slot","end"),this.first=t},m(U,H){J(U,t,H),o(t,r),o(r,n),o(n,l),o(l,d),o(t,k),o(t,g),o(g,h),o(h,u),o(u,b),o(u,O),E&&E.m(u,null),o(g,V),o(g,S),o(t,q),o(t,j),P||(B=ce(g,"click",y),P=!0)},p(U,H){e=U,H[0]&32&&f!==(f=parseInt(e[48].pos)+1+"")&&Le(d,f),H[0]&32&&_!==(_=Xe(e[48].status))&&Q(n,"title",_),H[0]&32&&M(n,"background-color",Pe(e[48].status,e[48].date_service)),H[0]&32&&M(n,"color",Me(Pe(e[48].status))),H[0]&32&&p!==(p=e[48].title+"")&&Le(b,p),H[0]&32&&(A=e[48].support_list&&e[48].support_list.length||e[16](e[48])),A?E||(E=Xt(),E.c(),E.m(u,null)):E&&(E.d(1),E=null)},d(U){U&&a(t),E&&E.d(),P=!1,B()}}}function ko(i){let e,t,r,n,l=`<ion-icon icon="${wn}"></ion-icon>`,f,d,_,k=`<ion-icon icon="${Ln}"></ion-icon>`,g,h,u=(i[6].name?i[6].name.toUpperCase():"")+"",p,b,O,A='<ion-segment-button value="list"><ion-label>Paradas</ion-label></ion-segment-button> <ion-segment-button value="map"><ion-label>Mapa</ion-label></ion-segment-button>',V,S,G,q;function j(E,y){if(E[9]==="list")return vo;if(E[9]==="map")return mo}let P=j(i),B=P&&P(i);return{c(){e=s("ion-header"),t=s("ion-toolbar"),r=s("ion-buttons"),n=s("ion-button"),n.innerHTML=l,f=N(),d=s("ion-buttons"),_=s("ion-button"),_.innerHTML=k,g=N(),h=s("ion-title"),p=be(u),b=N(),O=s("ion-segment"),O.innerHTML=A,V=N(),B&&B.c(),S=De(),this.h()},l(E){e=c(E,"ION-HEADER",{translucent:!0});var y=m(e);t=c(y,"ION-TOOLBAR",{});var U=m(t);r=c(U,"ION-BUTTONS",{slot:!0});var H=m(r);n=c(H,"ION-BUTTON",{title:!0,alt:!0,"data-svelte-h":!0}),ne(n)!=="svelte-7ppz3r"&&(n.innerHTML=l),H.forEach(a),f=T(U),d=c(U,"ION-BUTTONS",{slot:!0});var R=m(d);_=c(R,"ION-BUTTON",{"data-svelte-h":!0}),ne(_)!=="svelte-nf50hj"&&(_.innerHTML=k),R.forEach(a),g=T(U),h=c(U,"ION-TITLE",{});var W=m(h);p=Ee(W,u),W.forEach(a),U.forEach(a),b=T(y),O=c(y,"ION-SEGMENT",{value:!0,"data-svelte-h":!0}),ne(O)!=="svelte-lue4c9"&&(O.innerHTML=A),y.forEach(a),V=T(E),B&&B.l(E),S=De(),this.h()},h(){v(n,"title","Atrás"),v(n,"alt","Atrás"),v(r,"slot","start"),v(d,"slot","end"),v(O,"value","list"),v(e,"translucent","")},m(E,y){J(E,e,y),o(e,t),o(t,r),o(r,n),o(t,f),o(t,d),o(d,_),o(t,g),o(t,h),o(h,p),o(e,b),o(e,O),J(E,V,y),B&&B.m(E,y),J(E,S,y),G||(q=[ce(n,"click",i[17]),ce(_,"click",i[20]),ce(O,"ionChange",i[21])],G=!0)},p(E,y){y[0]&64&&u!==(u=(E[6].name?E[6].name.toUpperCase():"")+"")&&Le(p,u),P===(P=j(E))&&B?B.p(E,y):(B&&B.d(1),B=P&&P(E),B&&(B.c(),B.m(S.parentNode,S)))},d(E){E&&(a(e),a(V),a(S)),B&&B.d(E),G=!1,Be(q)}}}function Oo(i){let e,t,r,n=i[2]&&Vt(i);return{c(){e=N(),n&&n.c(),t=De(),this.h()},l(l){rn("svelte-kn0kph",Bt.head).forEach(a),e=T(l),n&&n.l(l),t=De(),this.h()},h(){Bt.title="Rutaflow - Detalles de ruta"},m(l,f){J(l,e,f),n&&n.m(l,f),J(l,t,f),r=!0},p(l,f){l[2]?n?(n.p(l,f),f[0]&4&&lt(n,1)):(n=Vt(l),n.c(),lt(n,1),n.m(t.parentNode,t)):n&&(hn(),at(n,1,1,()=>{n=null}),cn())},i(l){r||(lt(n),r=!0)},o(l){at(n),r=!1},d(l){l&&(a(e),a(t)),n&&n.d(l)}}}function Pe(i,e=""){let t="#ffffff";return i==="pending"&&!e?t="#f2e300":i=="pending"&&e?t="#F6A833":i==="completed"&&(t="#44d900"),t}function Xe(i){let e="";return i=="pending"?e="Pendiente":i=="completed"&&(e="Completado"),e}function Me(i){i.slice(0,1)==="#"&&(i=i.slice(1)),i.length===3&&(i=i.split("").map(function(l){return l+l}).join(""));const e=parseInt(i.substr(0,2),16),t=parseInt(i.substr(2,2),16),r=parseInt(i.substr(4,2),16);return(e*299+t*587+r*114)/1e3>=128?"#414040":"#fff"}function Jt(i,e){for(let t=0;t<e.length;t++)if(e[t].alias===i)return e[t].val;return""}const No=i=>i.mandatory==="1",To=i=>i.img;function Co(i,e,t){let r;an(i,An,I=>t(19,r=I));var n=this&&this.__awaiter||function(I,C,D,L){function K(X){return X instanceof D?X:new D(function(Z){Z(X)})}return new(D||(D=Promise))(function(X,Z){function z(x){try{Y(L.next(x))}catch(oe){Z(oe)}}function w(x){try{Y(L.throw(x))}catch(oe){Z(oe)}}function Y(x){x.done?X(x.value):K(x.value).then(z,w)}Y((L=L.apply(I,C||[])).next())})};let{routeId:l}=e,{driverId:f}=e,d=it,_=new Object,k=!0,g=!1,h=[],u={},p=[],b=[],O,A=!1,V="list",S,G="",q="",j=new Object;const P=()=>n(void 0,void 0,void 0,function*(){yield y(l),O.complete()});Ze(()=>n(void 0,void 0,void 0,function*(){de(),yield y(l)}));function B(I){return n(this,void 0,void 0,function*(){if(t(9,V=I),V==="map"){yield sn(),S=document.getElementById("g_map");const C=new google.maps.Map(S,{zoom:8,center:{lat:20.6745683,lng:-103.3986104},mapId:"4504f8b37365c3d0"}),D=new google.maps.LatLngBounds,{AdvancedMarkerElement:L,PinElement:K}=yield google.maps.importLibrary("marker");navigator.geolocation?navigator.geolocation.getCurrentPosition(function(X){const Z=new google.maps.LatLng(X.coords.latitude,X.coords.longitude);new google.maps.Marker({position:Z,map:C,icon:{path:google.maps.SymbolPath.CIRCLE,fillColor:"#0062ff",fillOpacity:1,scale:6,strokeColor:"#ffffff",strokeWeight:2}}),new google.maps.Circle({strokeColor:"#00BFFF",strokeOpacity:.5,strokeWeight:1,fillColor:"#00BFFF",fillOpacity:.2,map:C,center:Z,radius:X.coords.accuracy}),D.extend(Z)},function(X){console.error("Error retrieving location:",X)}):console.error("Geolocation not supported by this browser."),u.lat1===u.lat2&&u.lon1===u.lon2?E(D,C,{lat:u.lat2,lon:u.lon2,color:u.color,title:u.destination},{type:"icon",iconClass:"icon-home",title:"Origen/Destino",glyph:`0,${String(h.length+1)}`}):(E(D,C,{lat:u.lat1,lon:u.lon1,color:u.color,title:u.origin},{type:"icon",iconClass:"icon-home",title:"Origen",glyph:"0"}),E(D,C,{lat:u.lat2,lon:u.lon2,color:u.color,title:u.destination},{type:"icon",iconClass:"icon-flag",title:"Destino",glyph:String(h.length+1)})),h.forEach((X,Z)=>{const z=parseFloat(X.lat),w=parseFloat(X.lon),Y=new google.maps.LatLng(z,w),x=new google.maps.Marker({position:{lat:z,lng:w},map:C,title:X.title}),oe=new K({background:Pe(X.status,X.date_service),borderColor:"#000",glyphColor:"#000",glyph:(parseInt(X.pos)+1).toString()});new L({map:C,position:Y,content:oe.element,title:"Parada "+(parseInt(X.pos)+1).toString()+": "+X.title}).addListener("click",function(Te){H(X,!1)}),D.extend(x.getPosition())}),C.fitBounds(D)}})}function E(I,C,D,L){return n(this,void 0,void 0,function*(){let K;const X=parseFloat(D.lat),Z=parseFloat(D.lon),z=new google.maps.LatLng(X,Z),{AdvancedMarkerElement:w,PinElement:Y}=yield google.maps.importLibrary("marker");L.type=="icon"?(K=document.createElement("i"),K.className=`${L.iconClass} icon`,K.style.fontSize="14px",K.style.color=Me(D.color),K.style.fontWeight="600"):L.type=="text";const x=new google.maps.Marker({position:{lat:X,lng:Z},map:C,title:`${L.title}. ${D.title}`}),oe=new Y({background:D.color,borderColor:"#000",glyphColor:Me(D.color),glyph:L.glyph});return new w({map:C,position:z,content:oe.element,title:L.title+": "+D.title}).addListener("click",function(Te){R(u,L.title=="Destino"||L.title=="Origen/Destino")}),x})}function y(I){return n(this,void 0,void 0,function*(){let C=new FormData;C.append("id_route",I),C=ae(C);try{const L=yield(yield fetch(`${d}api/admin/report/seguimiento_list.php`,{method:"POST",body:C})).json();t(6,u=L.data.seguimiento_list[0]),t(5,h=L.data.event_list),t(7,p=L.data.checklist),b=L.data.expenses,u&&t(4,g=u.km_inicial=="0"&&u.gas_inicial=="0"),t(3,k=!1)}catch(D){t(3,k=!1),console.error("Error fetching data:",D)}})}const U=I=>new Promise((C,D)=>{let L=new FormData;L.append("id_route",I.id_route),L.append("id_event",I.id_event),L=ae(L),fetch(`${d}api/admin/evidence/evidence_by_event.php`,{method:"POST",body:L}).then(K=>K.json()).then(K=>{C(K.data.event_evidence[0])}).catch(K=>{console.error("Error fetching data:",K),D(K)})}),H=(I,C)=>{U(I).then(D=>{I.stopsApproval=G,I.smsActive=q,D&&(I.img=D.img,I.driver_comments=D.driver_comments,I.comments=D.comments),Ue("modal-delivery-info",zt,{delivery:I,isLast:C}).then(L=>{}).finally(()=>{y(l)})})},R=(I,C)=>{var D=new Object;C?D={title:I.destination,line1:I.dest_address}:D={title:I.origin,line1:I.origin_address},D.client_name=I.client_name,D.client_phone=I.tel,D.id_route=I.id_route,D.stopsApproval=G,D.smsActive=q;var L=!0;Ue("modal-delivery-info",zt,{delivery:D,isLast:C,flag:L})},W=(I,C,D)=>{var L=!1;return A||(A=!0,Ue("modal-checklist",$t,{checklist:I,driverId:C,routeId:D,isLast:L}).then(K=>{A=!1}),te(D,"checklist")),""},F=I=>n(void 0,void 0,void 0,function*(){return yield y(I),b.length>0?Ue("modal-expense-detail",po,{routeId:I,expenses:b}).then(C=>{}):Ue("modal-expense",ut,{routeId:I}).then(C=>{}),""}),ee=I=>{if(I.tracking_type=="subscription"){if(I.subscriber_info&&I.payment_type==="cash"&&new Date(I.subscriber_info.payment_next)<new Date)return!0}else if(I.tracking_type=="ecommerce"&&Number(I.payment_pending)>0)return!0;return!1};function te(I,C){let D=new FormData;return D.append("id_route",I),D.append("status",C),D=ae(D),fetch(`${d}api/admin/route/change_status.php`,{method:"POST",body:D}).then(L=>L.json()).then(L=>{}).catch(L=>{console.error("Error fetching data:",L)}),""}const le=()=>{_.type=="super"||_.type=="admin"?qe("/drivers/me"):_.id_driver&&qe(`/drivers/${_.id_driver}`)},pe=(I,C)=>n(void 0,void 0,void 0,function*(){yield(yield je.create({header:I||"Error",message:C||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()});function ae(I){return I.append("token",_.token),I.append("id_user_over",_.id_user),I}const de=()=>n(void 0,void 0,void 0,function*(){if(_.id_enterprise){let I=new FormData;I.append("id_enterprise",_.id_enterprise),I=ae(I);try{const C=yield fetch(`${d}api/admin/enterprise/enterprise_settings.php`,{method:"POST",body:I});C.ok?(j=(yield C.json()).nodos,G=Jt("stops_wait_approval",j),q=Jt("sms_active",j)):console.error("File upload failed:",C.statusText)}catch(C){console.error("Error during file upload:",C)}}}),ge=()=>F(l),ue=I=>B(I.detail.value);function me(I){Se[I?"unshift":"push"](()=>{O=I,t(8,O)})}const Ie=()=>{R(u,!1)},Oe=I=>{const C=h.findIndex(Z=>Z.id_event===I.id_event),D=C===0,L=C>0?h[C-1]:null,K=D||L&&L.img!==null,X=I.img!==null&&I.img!=="";K||D&&!X?H(I,!1):pe("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")},we=()=>{R(u,!0)};function Ce(I){Se[I?"unshift":"push"](()=>{O=I,t(8,O)})}const _e=()=>{R(u,!1)},Ne=I=>{const C=h.findIndex(Z=>Z.id_event===I.id_event),D=C===0,L=C>0?h[C-1]:null,K=D||L&&L.img!==null,X=I.img!==null&&I.img!=="";K||D&&!X?H(I,!1):pe("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")},ye=()=>{R(u,!0)};function ke(I){Se[I?"unshift":"push"](()=>{O=I,t(8,O)})}const se=()=>{R(u,!1)},$=I=>{const C=h.findIndex(Z=>Z.id_event===I.id_event),D=C===0,L=C>0?h[C-1]:null,K=D||L&&L.img!==null,X=I.img!==null&&I.img!=="";K||D&&!X?H(I,!1):pe("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")},ie=()=>{R(u,!0)};return i.$$set=I=>{"routeId"in I&&t(0,l=I.routeId),"driverId"in I&&t(1,f=I.driverId)},i.$$.update=()=>{i.$$.dirty[0]&524293&&(t(0,{routeId:l,driverId:f}=r.params,l,(t(1,f),t(19,r),t(2,_),t(0,l))),t(2,_=JSON.parse(localStorage.getItem("userSession"))),_?_.id_user&&(_.type=="admin"||_.type=="super")?(y(l),qe(`/drivers/me/routes/${l}`)):_.id_user&&_.id_driver&&(y(l),qe(`/drivers/${_.id_driver}/routes/${l}`)):qe("/"))},[l,f,_,k,g,h,u,p,O,V,P,B,H,R,W,F,ee,le,pe,r,ge,ue,me,Ie,Oe,we,Ce,_e,Ne,ye,ke,se,$,ie]}class Do extends Je{constructor(e){super(),Ye(this,e,Co,Oo,We,{routeId:0,driverId:1},null,[-1,-1])}}export{Do as component};

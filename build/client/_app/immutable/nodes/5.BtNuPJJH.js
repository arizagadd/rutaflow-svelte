import{Z as ut,s as Ke,e as s,j as T,b as c,q as p,d as le,h as a,m as C,v as m,i as Y,w as o,x as me,n as Le,z as Be,_ as Zt,B as G,o as Ye,k as Se,$ as ft,t as Ie,r as ke,f as $,a0 as $t,a1 as Je,A as Me,y as we,a2 as ot,l as xt,p as en,F as tn}from"../chunks/index.BzUyNcuj.js";import{S as Xe,i as We,t as nt,a as rt,c as nn,b as on,d as ln,m as rn,e as an,g as sn}from"../chunks/index.D9GPdhpm.js";import{e as Re,u as Qe,d as Ze,a as cn,b as un,c as fn,i as Xt,f as _n,g as Wt,h as dn,j as at,k as hn,m as Jt,s as _t,n as Pe,o as pn,q as mn,r as vn,t as gn,v as bn,w as En,p as In}from"../chunks/index.Df2A8omQ.js";import"../chunks/index-6e05b96e.C_9q9BoX.js";import{m as $e,D as lt,a as qe,I as kn}from"../chunks/IonPage.C1Q1qCZn.js";import{q as On,t as Nn}from"../chunks/ion-modal.BYMRzj9z.js";import{g as Ve}from"../chunks/entry.hK-GcuAY.js";const Tn=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global,Cn=(i,e)=>{if(!customElements.get(i)){class t extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const n={};for(const r of this.attributes)n[r.name]=r.value;new e({target:this.shadowRoot,props:n})}}customElements.define(i,t)}},yn=function(i){return document.createElement(i).constructor!==HTMLElement},wn=(i,e)=>{yn(i)||Cn(i,e)},Ue=async(i,e,t)=>{On(),Nn(),wn(i,e);const l=await $e.create({component:i,componentProps:t});return l.present(),await l.onWillDismiss()};let je=ut({km_inicial:[],gas_inicial:[],km_final:[],gas_final:[]}),Yt=ut({flag:[]});function Ln(i){let e,t,l,n,r="Cancelar",d,h,_="Captura de Km/Gas",E,g,f,u="Confirmar",v,b,k,O,B,z,V;return{c(){e=s("ion-header"),t=s("ion-toolbar"),l=s("ion-buttons"),n=s("ion-button"),n.textContent=r,d=T(),h=s("ion-title"),h.textContent=_,E=T(),g=s("ion-buttons"),f=s("ion-button"),f.textContent=u,v=T(),b=s("ion-content"),k=s("ion-item"),O=s("ion-input"),this.h()},l(F){e=c(F,"ION-HEADER",{translucent:!0});var R=p(e);t=c(R,"ION-TOOLBAR",{});var A=p(t);l=c(A,"ION-BUTTONS",{slot:!0});var M=p(l);n=c(M,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),le(n)!=="svelte-17pq4f4"&&(n.textContent=r),M.forEach(a),d=C(A),h=c(A,"ION-TITLE",{"data-svelte-h":!0}),le(h)!=="svelte-1yhkaq7"&&(h.textContent=_),E=C(A),g=c(A,"ION-BUTTONS",{slot:!0});var I=p(g);f=c(I,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),le(f)!=="svelte-cm6j4s"&&(f.textContent=u),I.forEach(a),A.forEach(a),R.forEach(a),v=C(F),b=c(F,"ION-CONTENT",{fullscreen:!0});var L=p(b);k=c(L,"ION-ITEM",{});var w=p(k);O=c(w,"ION-INPUT",{class:!0,inputmode:!0,pattern:!0,type:!0,placeholder:!0,value:!0,required:!0});var S=p(O);S.forEach(a),w.forEach(a),L.forEach(a),this.h()},h(){m(n,"color","medium"),m(l,"slot","start"),m(f,"strong",""),m(g,"slot","end"),m(e,"translucent",""),m(O,"class","fin-km"),m(O,"inputmode","numeric"),m(O,"pattern","[0-9]*"),m(O,"type","number"),m(O,"placeholder",B="Ingresa "+i[0]+" actual"),m(O,"value",i[1]),m(O,"required",""),m(b,"fullscreen","")},m(F,R){Y(F,e,R),o(e,t),o(t,l),o(l,n),o(t,d),o(t,h),o(t,E),o(t,g),o(g,f),Y(F,v,R),Y(F,b,R),o(b,k),o(k,O),z||(V=[me(n,"click",i[2]),me(f,"click",i[3]),me(O,"input",i[4])],z=!0)},p(F,[R]){R&1&&B!==(B="Ingresa "+F[0]+" actual")&&m(O,"placeholder",B),R&2&&m(O,"value",F[1])},i:Le,o:Le,d(F){F&&(a(e),a(v),a(b)),z=!1,Be(V)}}}function zn(i,e,t){const l=Zt();let n=document.querySelector("ion-modal"),r=n.componentProps.data_type;n.componentProps.isLast;let d;Yt.subscribe(f=>{r=f.flag[0],r=="km_final"||r=="km_inicial"?t(0,d="kilometraje"):t(0,d="litros de gasolina")});let h=0;function _(){$e.dismiss()}function E(){l("modalResult",{data:"Your data",role:"confirm"}),r=="km_inicial"?je.update(u=>({...u,km_inicial:[h]})):r=="gas_inicial"?je.update(u=>({...u,gas_inicial:[h]})):r=="km_final"?je.update(u=>({...u,km_final:[h]})):r=="gas_final"&&je.update(u=>({...u,gas_final:[h]})),_()}return[d,h,_,E,f=>t(1,h=f.target.value)]}class An extends Xe{constructor(e){super(),We(this,e,zn,Ln,Ke,{})}}const it=ut({items:[],checkedIndices:[],mandatory:[]});function vt(i,e,t){const l=i.slice();return l[53]=e[t],l[54]=e,l[55]=t,l}function Mn(i){let e,t,l,n,r,d="Kilometraje inicial",h,_,E=i[0]?i[0]+" km.":"Cargar km",g,f,u,v,b,k,O,B="Gasolina inicial (litros)",z,V,F=i[1]?i[1]+" litros":"Cargar gas",R,A,M,I;return A=ft(i[21][0]),{c(){e=s("ion-item"),t=s("ion-label"),l=s("input"),n=T(),r=s("p"),r.textContent=d,h=T(),_=s("ion-button"),g=Ie(E),f=T(),u=s("ion-item"),v=s("ion-label"),b=s("input"),k=T(),O=s("p"),O.textContent=B,z=T(),V=s("ion-button"),R=Ie(F),this.h()},l(L){e=c(L,"ION-ITEM",{});var w=p(e);t=c(w,"ION-LABEL",{style:!0});var S=p(t);l=c(S,"INPUT",{id:!0,style:!0,type:!0}),n=C(S),r=c(S,"P",{style:!0,"data-svelte-h":!0}),le(r)!=="svelte-88twxi"&&(r.textContent=d),S.forEach(a),h=C(w),_=c(w,"ION-BUTTON",{fill:!0,size:!0,class:!0,"aria-selected":!0});var q=p(_);g=ke(q,E),q.forEach(a),w.forEach(a),f=C(L),u=c(L,"ION-ITEM",{});var W=p(u);v=c(W,"ION-LABEL",{style:!0});var j=p(v);b=c(j,"INPUT",{id:!0,style:!0,type:!0}),k=C(j),O=c(j,"P",{style:!0,"data-svelte-h":!0}),le(O)!=="svelte-1ux30eb"&&(O.textContent=B),j.forEach(a),z=C(W),V=c(W,"ION-BUTTON",{fill:!0,class:!0,size:!0,style:!0});var Q=p(V);R=ke(Q,F),Q.forEach(a),W.forEach(a),this.h()},h(){$(l,"id","chkbox-km-ini"),G(l,"pointer-events","auto"),$(l,"type","checkbox"),l.required=!0,G(r,"margin-left","10px"),G(t,"display","flex"),m(_,"fill","outline"),m(_,"size","small"),m(_,"class","loadKmInicial"),m(_,"aria-selected",""),$(b,"id","chkbox-gas-ini"),G(b,"pointer-events","auto"),$(b,"type","checkbox"),b.required=!0,G(O,"margin-left","10px"),G(v,"display","flex"),m(V,"fill","outline"),m(V,"class","loadGasInicial"),m(V,"size","small"),G(V,"height","16px "),A.p(l,b)},m(L,w){Y(L,e,w),o(e,t),o(t,l),l.checked=~(i[4]||[]).indexOf(l.__value),i[28](l),o(t,n),o(t,r),o(e,h),o(e,_),o(_,g),Y(L,f,w),Y(L,u,w),o(u,v),o(v,b),i[30](b),b.checked=~(i[4]||[]).indexOf(b.__value),o(v,k),o(v,O),o(u,z),o(u,V),o(V,R),M||(I=[me(l,"change",i[27]),me(_,"click",i[29]),me(b,"change",i[31]),me(V,"click",i[32])],M=!0)},p(L,w){w[0]&16&&(l.checked=~(L[4]||[]).indexOf(l.__value)),w[0]&1&&E!==(E=L[0]?L[0]+" km.":"Cargar km")&&we(g,E),w[0]&16&&(b.checked=~(L[4]||[]).indexOf(b.__value)),w[0]&2&&F!==(F=L[1]?L[1]+" litros":"Cargar gas")&&we(R,F)},d(L){L&&(a(e),a(f),a(u)),i[28](null),i[30](null),A.r(),M=!1,Be(I)}}}function Dn(i){let e,t,l,n,r,d="Kilometraje final",h,_,E=i[2]?i[2]+" km.":"Cargar km",g,f,u,v,b,k,O,B="Gasolina final (litros)",z,V,F=i[3]?i[3]+" litros":"Cargar gas",R,A,M,I;return A=ft(i[21][0]),{c(){e=s("ion-item"),t=s("ion-label"),l=s("input"),n=T(),r=s("p"),r.textContent=d,h=T(),_=s("ion-button"),g=Ie(E),f=T(),u=s("ion-item"),v=s("ion-label"),b=s("input"),k=T(),O=s("p"),O.textContent=B,z=T(),V=s("ion-button"),R=Ie(F),this.h()},l(L){e=c(L,"ION-ITEM",{});var w=p(e);t=c(w,"ION-LABEL",{style:!0});var S=p(t);l=c(S,"INPUT",{id:!0,style:!0,type:!0}),n=C(S),r=c(S,"P",{style:!0,"data-svelte-h":!0}),le(r)!=="svelte-ccmu71"&&(r.textContent=d),S.forEach(a),h=C(w),_=c(w,"ION-BUTTON",{fill:!0,size:!0,class:!0,"aria-selected":!0});var q=p(_);g=ke(q,E),q.forEach(a),w.forEach(a),f=C(L),u=c(L,"ION-ITEM",{});var W=p(u);v=c(W,"ION-LABEL",{style:!0});var j=p(v);b=c(j,"INPUT",{id:!0,style:!0,type:!0}),k=C(j),O=c(j,"P",{style:!0,"data-svelte-h":!0}),le(O)!=="svelte-wsoyd2"&&(O.textContent=B),j.forEach(a),z=C(W),V=c(W,"ION-BUTTON",{fill:!0,size:!0,class:!0});var Q=p(V);R=ke(Q,F),Q.forEach(a),W.forEach(a),this.h()},h(){$(l,"id","chkbox-km-fin"),G(l,"pointer-events","auto"),$(l,"type","checkbox"),l.required=!0,G(r,"margin-left","10px"),G(t,"display","flex"),m(_,"fill","outline"),m(_,"size","small"),m(_,"class","loadKmInicial"),m(_,"aria-selected",""),$(b,"id","chkbox-gas-fin"),G(b,"pointer-events","auto"),$(b,"type","checkbox"),b.required=!0,G(O,"margin-left","10px"),G(v,"display","flex"),m(V,"fill","outline"),m(V,"size","small"),m(V,"class","loadGasInicial"),A.p(l,b)},m(L,w){Y(L,e,w),o(e,t),o(t,l),l.checked=~(i[4]||[]).indexOf(l.__value),i[22](l),o(t,n),o(t,r),o(e,h),o(e,_),o(_,g),Y(L,f,w),Y(L,u,w),o(u,v),o(v,b),b.checked=~(i[4]||[]).indexOf(b.__value),i[25](b),o(v,k),o(v,O),o(u,z),o(u,V),o(V,R),M||(I=[me(l,"change",i[20]),me(_,"click",i[23]),me(b,"change",i[24]),me(V,"click",i[26])],M=!0)},p(L,w){w[0]&16&&(l.checked=~(L[4]||[]).indexOf(l.__value)),w[0]&4&&E!==(E=L[2]?L[2]+" km.":"Cargar km")&&we(g,E),w[0]&16&&(b.checked=~(L[4]||[]).indexOf(b.__value)),w[0]&8&&F!==(F=L[3]?L[3]+" litros":"Cargar gas")&&we(R,F)},d(L){L&&(a(e),a(f),a(u)),i[22](null),i[25](null),A.r(),M=!1,Be(I)}}}function Sn(i){let e=[],t=new Map,l,n=Re(i[13]);const r=d=>d[53].id_checklist_event;for(let d=0;d<n.length;d+=1){let h=vt(i,n,d),_=r(h);t.set(_,e[d]=gt(_,h))}return{c(){for(let d=0;d<e.length;d+=1)e[d].c();l=Se()},l(d){for(let h=0;h<e.length;h+=1)e[h].l(d);l=Se()},m(d,h){for(let _=0;_<e.length;_+=1)e[_]&&e[_].m(d,h);Y(d,l,h)},p(d,h){h[0]&407664&&(n=Re(d[13]),e=Qe(e,h,r,1,d,n,t,l.parentNode,Ze,gt,l,vt))},d(d){d&&a(l);for(let h=0;h<e.length;h+=1)e[h].d(d)}}}function Pn(i){let e,t=(i[12][i[53].id_checklist_event]?i[12][i[53].id_checklist_event]:"Cargar evidencia")+"",l;return{c(){e=s("label"),l=Ie(t),this.h()},l(n){e=c(n,"LABEL",{for:!0,class:!0});var r=p(e);l=ke(r,t),r.forEach(a),this.h()},h(){$(e,"for","chklist-"+i[53].id_checklist_event),$(e,"class","button-label svelte-1ruehls")},m(n,r){Y(n,e,r),o(e,l)},p(n,r){r[0]&4096&&t!==(t=(n[12][n[53].id_checklist_event]?n[12][n[53].id_checklist_event]:"Cargar evidencia")+"")&&we(l,t)},d(n){n&&a(e)}}}function Bn(i){let e;return{c(){e=s("ion-spinner"),this.h()},l(t){e=c(t,"ION-SPINNER",{name:!0,class:!0}),p(e).forEach(a),this.h()},h(){m(e,"name","dots"),m(e,"class","button-spinner svelte-1ruehls")},m(t,l){Y(t,e,l)},p:Le,d(t){t&&a(e)}}}function gt(i,e){let t,l,n,r=e[53],d,h,_=e[53].item+"",E,g,f,u=e[53].mandatory=="1"?" * ":"",v,b,k,O,B,z,V,F,R,A;const M=()=>e[34](n,r),I=()=>e[34](null,r);function L(){return e[35](e[53])}function w(j,Q){return j[11][j[53].id_checklist_event]?Bn:Pn}let S=w(e),q=S(e);function W(...j){return e[37](e[53],...j)}return F=ft(e[21][0]),{key:i,first:null,c(){t=s("ion-item"),l=s("ion-label"),n=s("input"),d=T(),h=s("p"),E=Ie(_),g=T(),f=s("b"),v=Ie(u),b=T(),k=s("ion-button"),O=s("div"),q.c(),B=T(),z=s("input"),V=T(),this.h()},l(j){t=c(j,"ION-ITEM",{});var Q=p(t);l=c(Q,"ION-LABEL",{style:!0});var ne=p(l);n=c(ne,"INPUT",{id:!0,style:!0,type:!0}),d=C(ne),h=c(ne,"P",{style:!0});var fe=p(h);E=ke(fe,_),g=C(fe),fe.forEach(a),f=c(ne,"B",{style:!0});var ge=p(f);v=ke(ge,u),ge.forEach(a),ne.forEach(a),b=C(Q),k=c(Q,"ION-BUTTON",{fill:!0,class:!0,size:!0});var _e=p(k);O=c(_e,"DIV",{class:!0});var de=p(O);q.l(de),B=C(de),z=c(de,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0}),de.forEach(a),_e.forEach(a),V=C(Q),Q.forEach(a),this.h()},h(){$(n,"id",`chkbox-${e[53].id_checklist_event}`),G(n,"pointer-events","auto"),$(n,"type","checkbox"),n.__value=e[53].id_checklist_event,$t(n,n.__value),n.required=!0,G(h,"margin-left","10px"),G(f,"margin-left","5px"),G(l,"display","flex"),G(z,"display","none"),$(z,"id","chklist-"+e[53].id_checklist_event),$(z,"name","fileToUpload"),$(z,"type","file"),$(z,"accept","image/*"),$(O,"class","button-content svelte-1ruehls"),m(k,"fill","outline"),m(k,"class","loadEvidence svelte-1ruehls"),m(k,"size","small"),F.p(n),this.first=t},m(j,Q){Y(j,t,Q),o(t,l),o(l,n),n.checked=~(e[4]||[]).indexOf(n.__value),M(),o(l,d),o(l,h),o(h,E),o(h,g),o(l,f),o(f,v),o(t,b),o(t,k),o(k,O),q.m(O,null),o(O,B),o(O,z),e[36](z),o(t,V),R||(A=[me(n,"change",e[33]),me(n,"change",L),me(z,"change",W)],R=!0)},p(j,Q){e=j,Q[0]&16&&(n.checked=~(e[4]||[]).indexOf(n.__value)),r!==e[53]&&(I(),r=e[53],M()),S===(S=w(e))&&q?q.p(e,Q):(q.d(1),q=S(e),q&&(q.c(),q.m(O,B)))},d(j){j&&a(t),I(),q.d(),e[36](null),F.r(),R=!1,Be(A)}}}function Hn(i){let e,t,l,n,r="Cancelar",d,h,_="REQUERIMIENTOS DE RUTA",E,g,f,u,v,b,k,O="Confirmar",B,z;function V(M,I){return M[14]?Dn:Mn}let R=V(i)(i),A=i[13]&&Sn(i);return{c(){e=s("ion-header"),t=s("ion-toolbar"),l=s("ion-buttons"),n=s("ion-button"),n.textContent=r,d=T(),h=s("ion-title"),h.textContent=_,E=T(),g=s("ion-content"),f=s("ion-list"),R.c(),u=T(),A&&A.c(),v=T(),b=s("ion-footer"),k=s("ion-button"),k.textContent=O,this.h()},l(M){e=c(M,"ION-HEADER",{translucent:!0});var I=p(e);t=c(I,"ION-TOOLBAR",{});var L=p(t);l=c(L,"ION-BUTTONS",{slot:!0});var w=p(l);n=c(w,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),le(n)!=="svelte-1dnmkxs"&&(n.textContent=r),w.forEach(a),d=C(L),h=c(L,"ION-TITLE",{"data-svelte-h":!0}),le(h)!=="svelte-19bar5p"&&(h.textContent=_),L.forEach(a),I.forEach(a),E=C(M),g=c(M,"ION-CONTENT",{fullscreen:!0});var S=p(g);f=c(S,"ION-LIST",{});var q=p(f);R.l(q),u=C(q),A&&A.l(q),q.forEach(a),S.forEach(a),v=C(M),b=c(M,"ION-FOOTER",{});var W=p(b);k=c(W,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),le(k)!=="svelte-g82qqw"&&(k.textContent=O),W.forEach(a),this.h()},h(){m(n,"color","medium"),m(l,"slot","start"),m(e,"translucent",""),m(g,"fullscreen",""),m(k,"fill","outline"),m(k,"color","tertiary"),m(k,"strong",""),G(k,"width","99%"),G(k,"height","auto")},m(M,I){Y(M,e,I),o(e,t),o(t,l),o(l,n),o(t,d),o(t,h),Y(M,E,I),Y(M,g,I),o(g,f),R.m(f,null),o(f,u),A&&A.m(f,null),Y(M,v,I),Y(M,b,I),o(b,k),B||(z=[me(n,"click",i[15]),me(k,"click",i[16])],B=!0)},p(M,I){R.p(M,I),M[13]&&A.p(M,I)},i:Le,o:Le,d(M){M&&(a(e),a(E),a(g),a(v),a(b)),R.d(),A&&A.d(),B=!1,Be(z)}}}function st(i,e){if(typeof i=="object"&&i!==null||Array.isArray(i)){if(Array.isArray(i))return i.map(t=>st(t,e)).flat();{const t=Object.keys(i);let l;return e=="id_checklist_event"?l=t.filter(r=>r.toLowerCase().includes("id_checklist_event")).map(r=>i[r]):e=="mandatory"?l=t.filter(r=>r.toLowerCase().includes("mandatory")).map(r=>i[r]):(console.error("Tipo de dato no reconocido."),l=!1),l}}else return console.error("Invalid input. Please provide a valid object or array."),[]}function Rn(i,e,t){let l=lt,n=document.querySelector("ion-modal");const r=n.componentProps.checklist,d=n.componentProps.driverId,h=n.componentProps.routeId,_=n.componentProps.isLast;let E,g,f,u,v=[],b=null,k={},O,B,z,V,F={},R={},A={};Ye(()=>{_?console.log("Último checklist"):it.update(N=>(N.mandatory=st(r,"mandatory"),N.items=st(r,"id_checklist_event"),N))});function M(N){t(11,F[N]=!0,F)}const I=async()=>{await(await qe.create({header:"Datos o checklist incompletos",message:"Carga la evidencia requerida y marca todas las casillas para confirmar",buttons:[{text:"Cerrar"}]})).present()},L=async()=>{await(await qe.create({header:"Datos capturados",message:"El kilometraje y gasolina final fueron registrados correctamente, espere aprobación para finalizar ruta",buttons:[{text:"Cerrar"}]})).present()},w=async N=>{await(await qe.create({header:"Datos inválidos",message:N=="km"?"Llena correctamente el campo de kilometraje inicial":"Llena correctamente el campo de gasolina inicial",buttons:[{text:"Cerrar"}]})).present()},S=()=>{$e.dismiss(),d?Ve(`/drivers/${d}`):Ve("/drivers/me")},q=()=>{if(_){var N=fe(f,"km"),X=fe(u,"gas");const ce=new FormData;ce.append("km_final",N),ce.append("gas_final",X),ce.append("id_route",h),N&&X?(S(),fetch(`${l}api/admin/checklist/add_evidence.php`,{method:"POST",body:ce}).then(ue=>ue.json()).then(ue=>{L()}).catch(ue=>{console.error("Error fetching data:",ue)})):I()}else{var ve=fe(E,"km"),pe=fe(g,"gas");it.update(ce=>{ce.items;const ue=ce.mandatory;if(ce.items.filter((be,Ee)=>ce.mandatory[Ee]==="1").every(be=>ce.checkedIndices.includes(be))&&ve&&pe){S();const be=new FormData;for(const Ee in R)if(R.hasOwnProperty(Ee)){const{img:Ae,img_id:He}=R[Ee];be.append(`selectedImages[${Ee}][img]`,Ae),be.append(`selectedImages[${Ee}][img_id]`,He)}be.append("km_inicial",ve),be.append("gas_inicial",pe),be.append("id_route",h),fetch(`${l}api/admin/checklist/add_evidence.php`,{method:"POST",body:be}).then(Ee=>Ee.json()).then(Ee=>{ue&&ue.some(Ae=>Ae==="1")?ne(h,"checklist-pending"):ne(h,"enroute")}).catch(Ee=>{console.error("Error fetching data:",Ee)})}else if(!ue&&ve&&pe){var ye=new FormData;ye.append("km_inicial",ve),ye.append("gas_inicial",pe),fetch(`${l}api/admin/checklist/add_evidence.php`,{method:"POST",body:ye}).then(be=>be.json()).then(be=>{ne(h,"enroute")}).catch(be=>{console.error("Error fetching data:",be)})}else I();return ce})}Ne()},W=async(N,X)=>{M(X);const pe=N.target.files[0],ce=await j(pe);if(ce){const ue=new FormData;ue.append("fileToUpload",ce);try{const oe=await fetch(`${l}api/admin/manager/upload_img_driver.php`,{method:"POST",body:ue});if(oe.ok){const Ce=await oe.json();R={...R,[X]:{img:Ce.img,img_id:Ce.img_id}},t(12,A={...A,[X]:Ce.filename}),Q(X),t(6,k[X].checked=!0,k),t(11,F[X]=!1,F)}else console.error("File upload failed:",oe.statusText)}catch(oe){console.error("Error during file upload:",oe)}}},j=async N=>new Promise(X=>{const ve=new FileReader;ve.onload=pe=>{const ce=new Image;ce.src=pe.target.result,ce.onload=()=>{const ue=document.createElement("canvas"),oe=ue.getContext("2d"),Ce=800,ye=600;let be=ce.width,Ee=ce.height;be>Ce&&(Ee*=Ce/be,be=Ce),Ee>ye&&(be*=ye/Ee,Ee=ye),ue.width=be,ue.height=Ee,oe.drawImage(ce,0,0,be,Ee),ue.toBlob(Ae=>{X(Ae)},"image/jpeg",.7)}},ve.readAsDataURL(N)}),Q=N=>{it.update(X=>(X.checkedIndices.indexOf(N)===-1?X.checkedIndices.push(N):console.error(`ID ${N} is already checked.`),X.items.forEach(pe=>{pe.id_checklist_event===N&&(pe.checked=!0)}),X))};function ne(N,X){let ve=new FormData;ve.append("id_route",N),ve.append("status",X),fetch(`${l}api/admin/route/change_status.php`,{method:"POST",body:ve}).then(pe=>pe.json()).then(pe=>{}).catch(pe=>{console.error("Error fetching data:",pe)})}function fe(N,X){return/^\d+$/.test(N)?parseInt(N,10):(w(X),null)}function ge(N,X){_e(X),n.componentProps.data_type=X,Ue("modal-gas-km",An,{r:X}).then(()=>{je.subscribe(ve=>{de(ve,X)})})}function _e(N){Yt.update(X=>({...X,flag:[N]}))}function de(N,X){t(0,E=N.km_inicial?N.km_inicial:null),t(1,g=N.gas_inicial?N.gas_inicial:null),t(2,f=N.km_final?N.km_final:null),t(3,u=N.gas_final?N.gas_final:null),X=="km_inicial"&&O&&t(7,O.checked=!0,O),X=="gas_inicial"&&B&&t(8,B.checked=!0,B),X=="km_final"&&z&&t(9,z.checked=!0,z),X=="gas_final"&&V&&t(10,V.checked=!0,V)}function Ne(){je.set({km_inicial:[],gas_inicial:[],km_final:[],gas_final:[]})}const he=[[]];function Oe(){v=Je(he[0],this.__value,this.checked),t(4,v)}function Te(N){Me[N?"unshift":"push"](()=>{z=N,t(9,z)})}const Z=N=>ge(N,"km_final");function ee(){v=Je(he[0],this.__value,this.checked),t(4,v)}function ie(N){Me[N?"unshift":"push"](()=>{V=N,t(10,V)})}const re=N=>ge(N,"gas_final");function te(){v=Je(he[0],this.__value,this.checked),t(4,v)}function y(N){Me[N?"unshift":"push"](()=>{O=N,t(7,O)})}const K=N=>ge(N,"km_inicial");function U(N){Me[N?"unshift":"push"](()=>{B=N,t(8,B)})}function H(){v=Je(he[0],this.__value,this.checked),t(4,v)}const J=N=>ge(N,"gas_inicial");function D(){v=Je(he[0],this.__value,this.checked),t(4,v)}function P(N,X){Me[N?"unshift":"push"](()=>{k[X.id_checklist_event]=N,t(6,k)})}const x=N=>Q(N.id_checklist_event);function ae(N){Me[N?"unshift":"push"](()=>{b=N,t(5,b)})}return[E,g,f,u,v,b,k,O,B,z,V,F,A,r,_,S,q,W,Q,ge,Oe,he,Te,Z,ee,ie,re,te,y,K,U,H,J,D,P,x,ae,(N,X)=>W(X,N.id_checklist_event)]}class Qt extends Xe{constructor(e){super(),We(this,e,Rn,Hn,Ke,{},null,[-1,-1])}}function Un(i){let e,t,l="Confirmar",n,r;return{c(){e=s("ion-buttons"),t=s("ion-button"),t.textContent=l,this.h()},l(d){e=c(d,"ION-BUTTONS",{slot:!0});var h=p(e);t=c(h,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),le(t)!=="svelte-1ida0il"&&(t.textContent=l),h.forEach(a),this.h()},h(){m(t,"strong",""),m(e,"slot","end")},m(d,h){Y(d,e,h),o(e,t),n||(r=me(t,"click",i[16]),n=!0)},p:Le,d(d){d&&a(e),n=!1,r()}}}function Fn(i){let e,t,l,n,r,d="Teléfono de Negocio",h,_,E=i[10].client_phone+"",g;return{c(){e=s("ion-item"),t=s("ion-icon"),l=T(),n=s("ion-label"),r=s("p"),r.textContent=d,h=T(),_=s("h2"),g=Ie(E),this.h()},l(f){e=c(f,"ION-ITEM",{href:!0});var u=p(e);t=c(u,"ION-ICON",{icon:!0,slot:!0}),p(t).forEach(a),l=C(u),n=c(u,"ION-LABEL",{class:!0});var v=p(n);r=c(v,"P",{"data-svelte-h":!0}),le(r)!=="svelte-1u5l7fz"&&(r.textContent=d),h=C(v),_=c(v,"H2",{});var b=p(_);g=ke(b,E),b.forEach(a),v.forEach(a),u.forEach(a),this.h()},h(){m(t,"icon",un),m(t,"slot","start"),m(n,"class","ion-text-wrap"),m(e,"href","tel:"+i[10].client_phone)},m(f,u){Y(f,e,u),o(e,t),o(e,l),o(e,n),o(n,r),o(n,h),o(n,_),o(_,g)},p:Le,d(f){f&&a(e)}}}function Vn(i){let e,t,l,n,r,d="Domicilio Alternativo",h,_,E=i[10].line2+"",g,f,u;return{c(){e=s("ion-item"),t=s("ion-icon"),l=T(),n=s("ion-label"),r=s("p"),r.textContent=d,h=T(),_=s("h2"),g=Ie(E),f=T(),u=s("ion-icon"),this.h()},l(v){e=c(v,"ION-ITEM",{href:!0});var b=p(e);t=c(b,"ION-ICON",{icon:!0,slot:!0}),p(t).forEach(a),l=C(b),n=c(b,"ION-LABEL",{class:!0});var k=p(n);r=c(k,"P",{"data-svelte-h":!0}),le(r)!=="svelte-1ub9uzw"&&(r.textContent=d),h=C(k),_=c(k,"H2",{});var O=p(_);g=ke(O,E),O.forEach(a),k.forEach(a),f=C(b),u=c(b,"ION-ICON",{icon:!0,slot:!0}),p(u).forEach(a),b.forEach(a),this.h()},h(){m(t,"icon",_t),m(t,"slot","start"),m(n,"class","ion-text-wrap"),m(u,"icon",Pe),m(u,"slot","end"),m(e,"href","https://www.google.com/maps/searhc/?api=1&query="+i[10].line2)},m(v,b){Y(v,e,b),o(e,t),o(e,l),o(e,n),o(n,r),o(n,h),o(n,_),o(_,g),o(e,f),o(e,u)},p:Le,d(v){v&&a(e)}}}function qn(i){let e,t,l,n,r,d="Domicilio",h,_,E=i[10].line1+"",g,f,u,v,b=i[10].line2&&i[10].line2.trim().length,k,O=b&&jn(i);return{c(){e=s("ion-item"),t=s("ion-icon"),l=T(),n=s("ion-label"),r=s("p"),r.textContent=d,h=T(),_=s("h2"),g=Ie(E),f=T(),u=s("ion-icon"),v=T(),O&&O.c(),k=Se(),this.h()},l(B){e=c(B,"ION-ITEM",{href:!0});var z=p(e);t=c(z,"ION-ICON",{icon:!0,slot:!0}),p(t).forEach(a),l=C(z),n=c(z,"ION-LABEL",{class:!0});var V=p(n);r=c(V,"P",{"data-svelte-h":!0}),le(r)!=="svelte-cbm7q1"&&(r.textContent=d),h=C(V),_=c(V,"H2",{});var F=p(_);g=ke(F,E),F.forEach(a),V.forEach(a),f=C(z),u=c(z,"ION-ICON",{icon:!0,slot:!0}),p(u).forEach(a),z.forEach(a),v=C(B),O&&O.l(B),k=Se(),this.h()},h(){m(t,"icon",_t),m(t,"slot","start"),m(n,"class","ion-text-wrap"),m(u,"icon",Pe),m(u,"slot","end"),m(e,"href","https://www.google.com/maps/search/?api=1&query="+i[10].line1)},m(B,z){Y(B,e,z),o(e,t),o(e,l),o(e,n),o(n,r),o(n,h),o(n,_),o(_,g),o(e,f),o(e,u),Y(B,v,z),O&&O.m(B,z),Y(B,k,z)},p(B,z){b&&O.p(B,z)},d(B){B&&(a(e),a(v),a(k)),O&&O.d(B)}}}function jn(i){let e,t,l,n,r,d="Domicilio Alternativo",h,_,E=i[10].line2+"",g,f,u;return{c(){e=s("ion-item"),t=s("ion-icon"),l=T(),n=s("ion-label"),r=s("p"),r.textContent=d,h=T(),_=s("h2"),g=Ie(E),f=T(),u=s("ion-icon"),this.h()},l(v){e=c(v,"ION-ITEM",{href:!0});var b=p(e);t=c(b,"ION-ICON",{icon:!0,slot:!0}),p(t).forEach(a),l=C(b),n=c(b,"ION-LABEL",{class:!0});var k=p(n);r=c(k,"P",{"data-svelte-h":!0}),le(r)!=="svelte-1ub9uzw"&&(r.textContent=d),h=C(k),_=c(k,"H2",{});var O=p(_);g=ke(O,E),O.forEach(a),k.forEach(a),f=C(b),u=c(b,"ION-ICON",{icon:!0,slot:!0}),p(u).forEach(a),b.forEach(a),this.h()},h(){m(t,"icon",_t),m(t,"slot","start"),m(n,"class","ion-text-wrap"),m(u,"icon",Pe),m(u,"slot","end"),m(e,"href","https://www.google.com/maps/search/?api=1&query="+i[10].line2)},m(v,b){Y(v,e,b),o(e,t),o(e,l),o(e,n),o(n,r),o(n,h),o(n,_),o(_,g),o(e,f),o(e,u)},p:Le,d(v){v&&a(e)}}}function bt(i){let e,t,l,n,r,d="Contacto del Cliente",h,_,E,g,f=i[2]&&i[2]==="1"&&Et(i);return{c(){e=s("ion-item"),t=s("ion-icon"),l=T(),n=s("ion-label"),r=s("p"),r.textContent=d,h=T(),_=s("h2"),E=Ie(i[6]),g=T(),f&&f.c(),this.h()},l(u){e=c(u,"ION-ITEM",{});var v=p(e);t=c(v,"ION-ICON",{icon:!0,slot:!0}),p(t).forEach(a),l=C(v),n=c(v,"ION-LABEL",{class:!0});var b=p(n);r=c(b,"P",{"data-svelte-h":!0}),le(r)!=="svelte-1utsyb6"&&(r.textContent=d),h=C(b),_=c(b,"H2",{});var k=p(_);E=ke(k,i[6]),k.forEach(a),b.forEach(a),g=C(v),f&&f.l(v),v.forEach(a),this.h()},h(){m(t,"icon",fn),m(t,"slot","start"),m(n,"class","ion-text-wrap")},m(u,v){Y(u,e,v),o(e,t),o(e,l),o(e,n),o(n,r),o(n,h),o(n,_),o(_,E),o(e,g),f&&f.m(e,null)},p(u,v){v[0]&64&&we(E,u[6]),u[2]&&u[2]==="1"?f?f.p(u,v):(f=Et(u),f.c(),f.m(e,null)):f&&(f.d(1),f=null)},d(u){u&&a(e),f&&f.d()}}}function Et(i){let e,t=`<ion-icon icon="${pn}" slot="start"></ion-icon>
                        Notificar Cliente`,l,n;return{c(){e=s("ion-button"),e.innerHTML=t,this.h()},l(r){e=c(r,"ION-BUTTON",{fill:!0,style:!0,"data-svelte-h":!0}),le(e)!=="svelte-w3qtwm"&&(e.innerHTML=t),this.h()},h(){m(e,"fill","outline"),G(e,"margin-left","16px")},m(r,d){Y(r,e,d),l||(n=me(e,"click",i[17]),l=!0)},p:Le,d(r){r&&a(e),l=!1,n()}}}function It(i){let e,t,l,n,r,d="Notas de ubicación",h,_,E;return{c(){e=s("ion-item"),t=s("ion-icon"),l=T(),n=s("ion-label"),r=s("p"),r.textContent=d,h=T(),_=s("h2"),E=Ie(i[7]),this.h()},l(g){e=c(g,"ION-ITEM",{});var f=p(e);t=c(f,"ION-ICON",{icon:!0,slot:!0}),p(t).forEach(a),l=C(f),n=c(f,"ION-LABEL",{class:!0});var u=p(n);r=c(u,"P",{"data-svelte-h":!0}),le(r)!=="svelte-nhm2ft"&&(r.textContent=d),h=C(u),_=c(u,"H2",{});var v=p(_);E=ke(v,i[7]),v.forEach(a),u.forEach(a),f.forEach(a),this.h()},h(){m(t,"icon",Xt),m(t,"slot","start"),m(n,"class","ion-text-wrap")},m(g,f){Y(g,e,f),o(e,t),o(e,l),o(e,n),o(n,r),o(n,h),o(n,_),o(_,E)},p(g,f){f[0]&128&&we(E,g[7])},d(g){g&&a(e)}}}function Gn(i){let e,t,l,n,r,d="Horarios",h,_,E=i[10].schedule+"",g;return{c(){e=s("ion-item"),t=s("ion-icon"),l=T(),n=s("ion-label"),r=s("p"),r.textContent=d,h=T(),_=s("h2"),g=Ie(E),this.h()},l(f){e=c(f,"ION-ITEM",{});var u=p(e);t=c(u,"ION-ICON",{icon:!0,slot:!0}),p(t).forEach(a),l=C(u),n=c(u,"ION-LABEL",{});var v=p(n);r=c(v,"P",{"data-svelte-h":!0}),le(r)!=="svelte-11q7hm5"&&(r.textContent=d),h=C(v),_=c(v,"H2",{});var b=p(_);g=ke(b,E),b.forEach(a),v.forEach(a),u.forEach(a),this.h()},h(){m(t,"icon",_n),m(t,"slot","start")},m(f,u){Y(f,e,u),o(e,t),o(e,l),o(e,n),o(n,r),o(n,h),o(n,_),o(_,g)},p:Le,d(f){f&&a(e)}}}function Kn(i){let e,t,l,n,r,d="Notas del operador",h,_,E=i[10].driver_comments+"",g;return{c(){e=s("ion-item"),t=s("ion-icon"),l=T(),n=s("ion-label"),r=s("p"),r.textContent=d,h=T(),_=s("h2"),g=Ie(E),this.h()},l(f){e=c(f,"ION-ITEM",{});var u=p(e);t=c(u,"ION-ICON",{icon:!0,slot:!0}),p(t).forEach(a),l=C(u),n=c(u,"ION-LABEL",{});var v=p(n);r=c(v,"P",{"data-svelte-h":!0}),le(r)!=="svelte-1yk9qp4"&&(r.textContent=d),h=C(v),_=c(v,"H2",{});var b=p(_);g=ke(b,E),b.forEach(a),v.forEach(a),u.forEach(a),this.h()},h(){m(t,"icon",Wt),m(t,"slot","start")},m(f,u){Y(f,e,u),o(e,t),o(e,l),o(e,n),o(n,r),o(n,h),o(n,_),o(_,g)},p:Le,d(f){f&&a(e)}}}function Xn(i){let e,t=i[10].logistic_comments!="<br>"&&Wn(i);return{c(){t&&t.c(),e=Se()},l(l){t&&t.l(l),e=Se()},m(l,n){t&&t.m(l,n),Y(l,e,n)},p(l,n){l[10].logistic_comments!="<br>"&&t.p(l,n)},d(l){l&&a(e),t&&t.d(l)}}}function Wn(i){let e,t,l,n,r,d="Comentarios logísticos",h,_,E=i[10].logistic_comments+"",g;return{c(){e=s("ion-item"),t=s("ion-icon"),l=T(),n=s("ion-label"),r=s("p"),r.textContent=d,h=T(),_=s("h2"),g=Ie(E),this.h()},l(f){e=c(f,"ION-ITEM",{});var u=p(e);t=c(u,"ION-ICON",{icon:!0,slot:!0}),p(t).forEach(a),l=C(u),n=c(u,"ION-LABEL",{class:!0});var v=p(n);r=c(v,"P",{"data-svelte-h":!0}),le(r)!=="svelte-1iz85r6"&&(r.textContent=d),h=C(v),_=c(v,"H2",{});var b=p(_);g=ke(b,E),b.forEach(a),v.forEach(a),u.forEach(a),this.h()},h(){m(t,"icon",Xt),m(t,"slot","start"),m(n,"class","ion-text-wrap")},m(f,u){Y(f,e,u),o(e,t),o(e,l),o(e,n),o(n,r),o(n,h),o(n,_),o(_,g)},p:Le,d(f){f&&a(e)}}}function kt(i){let e,t,l,n;return{c(){e=s("ion-item"),t=s("ion-icon"),l=T(),n=s("ion-textarea"),this.h()},l(r){e=c(r,"ION-ITEM",{});var d=p(e);t=c(d,"ION-ICON",{icon:!0,slot:!0}),p(t).forEach(a),l=C(d),n=c(d,"ION-TEXTAREA",{placeholder:!0}),p(n).forEach(a),d.forEach(a),this.h()},h(){m(t,"icon",dn),m(t,"slot","start"),m(n,"placeholder","Escribe el motivo...")},m(r,d){Y(r,e,d),o(e,t),o(e,l),o(e,n),i[20](n)},p:Le,d(r){r&&a(e),i[20](null)}}}function Jn(i){let e,t,l,n,r,d,h,_=i[4]===!0&&Ot(i),E=(i[5]===!0||i[5]===!1&&i[4]===!1)&&Nt(i);return{c(){e=s("ion-item"),t=s("ion-icon"),l=T(),n=s("ion-textarea"),r=T(),d=s("section"),_&&_.c(),h=T(),E&&E.c(),this.h()},l(g){e=c(g,"ION-ITEM",{});var f=p(e);t=c(f,"ION-ICON",{icon:!0,slot:!0}),p(t).forEach(a),l=C(f),n=c(f,"ION-TEXTAREA",{label:!0,placeholder:!0}),p(n).forEach(a),f.forEach(a),r=C(g),d=c(g,"SECTION",{style:!0});var u=p(d);_&&_.l(u),h=C(u),E&&E.l(u),u.forEach(a),this.h()},h(){m(t,"icon",at),m(t,"slot","start"),m(n,"label","Notas"),m(n,"placeholder","Escribe aquí..."),G(d,"display","flex"),G(d,"gap","8px"),G(d,"padding","16px 16px 6px")},m(g,f){Y(g,e,f),o(e,t),o(e,l),o(e,n),i[21](n),Y(g,r,f),Y(g,d,f),_&&_.m(d,null),o(d,h),E&&E.m(d,null)},p(g,f){g[4]===!0?_?_.p(g,f):(_=Ot(g),_.c(),_.m(d,h)):_&&(_.d(1),_=null),g[5]===!0||g[5]===!1&&g[4]===!1?E?E.p(g,f):(E=Nt(g),E.c(),E.m(d,null)):E&&(E.d(1),E=null)},d(g){g&&(a(e),a(r),a(d)),i[21](null),_&&_.d(),E&&E.d()}}}function Ot(i){let e,t=`<ion-icon icon="${mn}" slot="start"></ion-icon>
                        Ingreso`,l,n;return{c(){e=s("ion-button"),e.innerHTML=t,this.h()},l(r){e=c(r,"ION-BUTTON",{id:!0,style:!0,"data-svelte-h":!0}),le(e)!=="svelte-3onvnr"&&(e.innerHTML=t),this.h()},h(){m(e,"id","checkInBtn"),G(e,"flex","1")},m(r,d){Y(r,e,d),l||(n=me(e,"click",i[18]),l=!0)},p:Le,d(r){r&&a(e),l=!1,n()}}}function Nt(i){let e,t,l,n,r,d;return{c(){e=s("ion-button"),t=s("ion-icon"),l=Ie(`
                        Salida`),this.h()},l(h){e=c(h,"ION-BUTTON",{id:!0,style:!0,disabled:!0});var _=p(e);t=c(_,"ION-ICON",{icon:!0,slot:!0}),p(t).forEach(a),l=ke(_,`
                        Salida`),_.forEach(a),this.h()},h(){m(t,"icon",hn),m(t,"slot","start"),m(e,"id","checkOutBtn"),G(e,"flex","1"),m(e,"disabled",n=i[5]===!1)},m(h,_){Y(h,e,_),o(e,t),o(e,l),r||(d=me(e,"click",i[19]),r=!0)},p(h,_){_[0]&32&&n!==(n=h[5]===!1)&&m(e,"disabled",n)},d(h){h&&a(e),r=!1,d()}}}function Yn(i){let e,t,l,n,r,d="Subir Evidencia",h,_,E,g;return{c(){e=s("section"),t=s("ion-button"),l=s("ion-icon"),n=T(),r=s("label"),r.textContent=d,h=T(),_=s("input"),this.h()},l(f){e=c(f,"SECTION",{style:!0});var u=p(e);t=c(u,"ION-BUTTON",{fill:!0,class:!0,style:!0});var v=p(t);l=c(v,"ION-ICON",{icon:!0,slot:!0}),p(l).forEach(a),n=C(v),r=c(v,"LABEL",{for:!0,"data-svelte-h":!0}),le(r)!=="svelte-1wg51s6"&&(r.textContent=d),h=C(v),_=c(v,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0}),v.forEach(a),u.forEach(a),this.h()},h(){m(l,"icon",Jt),m(l,"slot","start"),$(r,"for","eventEvidence"),G(_,"display","none"),$(_,"id","eventEvidence"),$(_,"name","fileToUpload"),$(_,"type","file"),$(_,"accept","image/*"),m(t,"fill","outline"),m(t,"class","loadEvidence"),G(t,"flex","1"),G(e,"display","flex"),G(e,"gap","8px"),G(e,"padding","0px 16px")},m(f,u){Y(f,e,u),o(e,t),o(t,l),o(t,n),o(t,r),o(t,h),o(t,_),E||(g=[me(_,"change",i[13]),me(_,"click",i[14])],E=!0)},p:Le,d(f){f&&a(e),E=!1,Be(g)}}}function Tt(i){let e,t='<ion-spinner name="dots"></ion-spinner>';return{c(){e=s("section"),e.innerHTML=t,this.h()},l(l){e=c(l,"SECTION",{style:!0,"data-svelte-h":!0}),le(e)!=="svelte-1sj3e0"&&(e.innerHTML=t),this.h()},h(){G(e,"text-align","center")},m(l,n){Y(l,e,n)},d(l){l&&a(e)}}}function Ct(i){let e,t,l;return{c(){e=s("section"),t=s("ion-img"),this.h()},l(n){e=c(n,"SECTION",{});var r=p(e);t=c(r,"ION-IMG",{src:!0,alt:!0,style:!0}),p(t).forEach(a),r.forEach(a),this.h()},h(){ot(t.src,l=i[1])||m(t,"src",l),m(t,"alt","Evidencia fotográfica"),G(t,"max-width","100%"),G(t,"margin-top","16px")},m(n,r){Y(n,e,r),o(e,t)},p(n,r){r[0]&2&&!ot(t.src,l=n[1])&&m(t,"src",l)},d(n){n&&a(e)}}}function Qn(i){let e,t,l,n,r="Cerrar",d,h,_=i[10].title+"",E,g,f,u,v,b,k,O,B,z,V="Negocio",F,R,A=i[10].client_name+"",M,I,L=i[10].client_phone&&i[10].client_phone.trim().length,w,S,q,W,j=i[10].schedule&&i[10].schedule.trim().length,Q,ne,fe=i[10].logistic_comments&&i[10].logistic_comments.trim().length,ge,_e,de,Ne,he,Oe,Te,Z=(!i[11]&&!i[12]||i[11]&&i[12])&&Un(i),ee=L&&Fn(i);function ie(N,X){if(N[10].line1&&N[10].line1.trim().length)return qn;if(N[10].line2&&N[10].line2.trim().length)return Vn}let re=ie(i),te=re&&re(i),y=i[6]&&bt(i),K=i[7]&&i[7]!=="<br>"&&It(i),U=j&&Gn(i),H=i[10].driver_comments&&Kn(i),J=fe&&Xn(i),D=i[8]&&kt(i),P=!i[12]&&Jn(i),x=(i[11]&&i[12]||!i[11]&&!i[12])&&Yn(i),ae=i[3]&&Tt(),se=i[1]&&Ct(i);return{c(){e=s("ion-header"),t=s("ion-toolbar"),l=s("ion-buttons"),n=s("ion-button"),n.textContent=r,d=T(),h=s("ion-title"),E=Ie(_),g=T(),Z&&Z.c(),f=T(),u=s("ion-content"),v=s("ion-list"),b=s("ion-item"),k=s("ion-icon"),O=T(),B=s("ion-label"),z=s("p"),z.textContent=V,F=T(),R=s("h2"),M=Ie(A),I=T(),ee&&ee.c(),w=T(),te&&te.c(),S=T(),y&&y.c(),q=T(),K&&K.c(),W=T(),U&&U.c(),Q=T(),H&&H.c(),ne=T(),J&&J.c(),ge=T(),D&&D.c(),_e=T(),P&&P.c(),de=T(),x&&x.c(),Ne=T(),ae&&ae.c(),he=T(),se&&se.c(),this.h()},l(N){e=c(N,"ION-HEADER",{translucent:!0});var X=p(e);t=c(X,"ION-TOOLBAR",{});var ve=p(t);l=c(ve,"ION-BUTTONS",{slot:!0});var pe=p(l);n=c(pe,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),le(n)!=="svelte-2ks32x"&&(n.textContent=r),pe.forEach(a),d=C(ve),h=c(ve,"ION-TITLE",{style:!0,title:!0});var ce=p(h);E=ke(ce,_),ce.forEach(a),g=C(ve),Z&&Z.l(ve),ve.forEach(a),X.forEach(a),f=C(N),u=c(N,"ION-CONTENT",{fullscreen:!0});var ue=p(u);v=c(ue,"ION-LIST",{});var oe=p(v);b=c(oe,"ION-ITEM",{});var Ce=p(b);k=c(Ce,"ION-ICON",{icon:!0,slot:!0}),p(k).forEach(a),O=C(Ce),B=c(Ce,"ION-LABEL",{});var ye=p(B);z=c(ye,"P",{"data-svelte-h":!0}),le(z)!=="svelte-57b1dg"&&(z.textContent=V),F=C(ye),R=c(ye,"H2",{});var be=p(R);M=ke(be,A),be.forEach(a),ye.forEach(a),Ce.forEach(a),I=C(oe),ee&&ee.l(oe),w=C(oe),te&&te.l(oe),S=C(oe),y&&y.l(oe),q=C(oe),K&&K.l(oe),W=C(oe),U&&U.l(oe),Q=C(oe),H&&H.l(oe),ne=C(oe),J&&J.l(oe),ge=C(oe),D&&D.l(oe),_e=C(oe),P&&P.l(oe),de=C(oe),x&&x.l(oe),Ne=C(oe),ae&&ae.l(oe),he=C(oe),se&&se.l(oe),oe.forEach(a),ue.forEach(a),this.h()},h(){m(n,"color","medium"),m(l,"slot","start"),G(h,"text-align","center"),m(h,"title",i[10].title),m(e,"translucent",""),m(k,"icon",cn),m(k,"slot","start"),m(u,"fullscreen","")},m(N,X){Y(N,e,X),o(e,t),o(t,l),o(l,n),o(t,d),o(t,h),o(h,E),o(t,g),Z&&Z.m(t,null),Y(N,f,X),Y(N,u,X),o(u,v),o(v,b),o(b,k),o(b,O),o(b,B),o(B,z),o(B,F),o(B,R),o(R,M),o(v,I),ee&&ee.m(v,null),o(v,w),te&&te.m(v,null),o(v,S),y&&y.m(v,null),o(v,q),K&&K.m(v,null),o(v,W),U&&U.m(v,null),o(v,Q),H&&H.m(v,null),o(v,ne),J&&J.m(v,null),o(v,ge),D&&D.m(v,null),o(v,_e),P&&P.m(v,null),o(v,de),x&&x.m(v,null),o(v,Ne),ae&&ae.m(v,null),o(v,he),se&&se.m(v,null),Oe||(Te=me(n,"click",i[15]),Oe=!0)},p(N,X){(!N[11]&&!N[12]||N[11]&&N[12])&&Z.p(N,X),L&&ee.p(N,X),te&&te.p(N,X),N[6]?y?y.p(N,X):(y=bt(N),y.c(),y.m(v,q)):y&&(y.d(1),y=null),N[7]&&N[7]!=="<br>"?K?K.p(N,X):(K=It(N),K.c(),K.m(v,W)):K&&(K.d(1),K=null),j&&U.p(N,X),N[10].driver_comments&&H.p(N,X),fe&&J.p(N,X),N[8]?D?D.p(N,X):(D=kt(N),D.c(),D.m(v,_e)):D&&(D.d(1),D=null),N[12]||P.p(N,X),(N[11]&&N[12]||!N[11]&&!N[12])&&x.p(N,X),N[3]?ae||(ae=Tt(),ae.c(),ae.m(v,he)):ae&&(ae.d(1),ae=null),N[1]?se?se.p(N,X):(se=Ct(N),se.c(),se.m(v,null)):se&&(se.d(1),se=null)},i:Le,o:Le,d(N){N&&(a(e),a(f),a(u)),Z&&Z.d(),ee&&ee.d(),te&&te.d(),y&&y.d(),K&&K.d(),U&&U.d(),H&&H.d(),J&&J.d(),D&&D.d(),P&&P.d(),x&&x.d(),ae&&ae.d(),se&&se.d(),Oe=!1,Te()}}}const yt=/Teléfono:\s*(\d{10,})/;function wt(i,e){for(let t=0;t<e.length;t++)if(e[t].alias===i)return e[t].val;return""}function Zn(i,e,t){let l=lt,n=document.querySelector("ion-modal"),r=n.componentProps.delivery,d=n.componentProps.isLast||!1,h=n.componentProps.flag||!1,_=r.driver_comments?r.driver_comments:"",E=r.img?r.img:"",g="",f={latitude:null,longitude:null},u=new Object,v="",b="",k=!1,O=!0,B=!1,z="",V=r.comments_ext,F=!1,R="";Ye(()=>{_e(),M()});async function A(Z="",ee,ie={}){const re=new FormData;t(3,k=!0);for(const[te,y]of Object.entries(ie))re.append(te,y);try{const te=await fetch(Z,{method:"POST",body:re});if(te.ok){const y=await te.json();ee(y)}else console.error("Request failed:",te.statusText)}catch(te){console.error("Error during file upload:",te)}finally{t(3,k=!1)}}function M(){r.date_service?r.date_service&&!r.date_completed&&!r.service_time?(t(4,O=!1),t(5,B=!0)):r.date_service&&r.date_completed&&r.service_time&&(t(4,O=!1),t(5,B=!1)):(t(4,O=!0),t(5,B=!1))}if(r.comments_ext){const Z=r.comments_ext.match(yt);Z&&(z=Z[1],V=r.comments_ext.replace(yt,"").trim())}const I=async(Z,ee)=>{await(await qe.create({header:Z||"Error",message:ee||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()},L=async(Z="",ee="",ie="",re,te={})=>{await(await qe.create({header:Z||"Error",message:ee||"Vuelva a intentar",buttons:[{text:"No",role:"cancel",handler:()=>{console.log('User selected "No"')}},{text:"Sí",handler:()=>{A(ie,re,te)}}]})).present()},w=async Z=>{const ie=Z.target.files[0],re=await W(ie);if(re){var te=new Object;te.fileToUpload=re,A(`${l}api/admin/manager/upload_img_driver.php`,function(y){t(1,E=y.img),g=y.img_id},te)}};function S(Z){var ee=r.service_time;!ee&&O&&!d&&!h&&(Z.preventDefault(),I("Registrar Ingreso","Antes de subir la evidencia registra el ingreso a la actual parada."))}function q(){var Z=h?r.date_completed:!1;if(!Z&&!O&&B&&!d&&!h){var ee=new Object;ee.id_event=r.id_event,ee.type="checkout",L("Registrar Salida","¿Completaste tu entrega?",l+"api/admin/route/record_check_date.php",function(ie){ie.minutes&&I("Tiempo por parada","Completaste la parada en "+ie.minutes+" minutos.")},ee)}}const W=async Z=>new Promise(ee=>{const ie=new FileReader;ie.onload=re=>{const te=new Image;te.src=re.target.result,te.onload=()=>{const y=document.createElement("canvas"),K=y.getContext("2d"),U=800,H=600;let J=te.width,D=te.height;J>U&&(D*=U/J,J=U),D>H&&(J*=H/D,D=H),y.width=J,y.height=D,K.drawImage(te,0,0,J,D),y.toBlob(P=>{ee(P)},"image/jpeg",.7)}},ie.readAsDataURL(Z)}),j=()=>{n.dismiss({data:Date.now()})},Q=async()=>{try{if(q(),await fe()){const ee={id_route:r.id_route,id_event:r.id_event,comments:_.value,img:E,img_id:g,lat:f.latitude,lon:f.longitude,...v==="0"&&{approve:"0"},...d&&{isLast:!0},...h&&d==!0&&{destiny:!0}};ee.img&&ee.img_id?A(`${l}api/admin/evidence/send_evidence.php`,function(ie){if(ie.success==!0){const re=ee.id_route;j(),d&&ne("","",re,d)}else I("Carga fallida","Actualiza la página y vuelve a intentar cargar la información!")},ee):r.img?j():I("Información incompleta","Cargar evidencia fotográfica faltante para completar parada.")}else I("Ubicación faltante","Asegúrate darle permisos a Rutaflow para acceder a tu ubicación")}catch(Z){console.error("Error fetching data:",Z)}},ne=(Z,ee,ie,re)=>{n.componentProps.routeId=ie,n.componentProps.driverId=r.id_driver,Ue("modal-km-gas",Qt,{checklist:Z,driverId:ee,routeId:ie,isLast:re}).then(te=>{})},fe=async()=>navigator.geolocation?new Promise((Z,ee)=>{navigator.geolocation.getCurrentPosition(ie=>{f.latitude=ie.coords.latitude,f.longitude=ie.coords.longitude,Z(!0)},ie=>{console.error("Error getting location:",ie),Z(!1)})}):(console.error("Geolocation is not supported by your browser"),!1);async function ge(Z){Z.stopPropagation();const ee=new FormData;ee.append("client_phone",z),ee.append("client_name",r.title),ee.append("delivery_phone",r.client_phone),ee.append("enterprise_name",r.enterprise_name);try{const ie=await fetch(`${l}api/admin/message_central/send_sms.php`,{method:"POST",body:ee});if(ie.ok){const re=await ie.json();I("SMS enviado","Se envío correctamente un SMS a "+r.title+" con número de teléfono: "+z)}else I("SMS no enviado","Hubo un error al enviar SMS a "+r.title+" con número de teléfono: "+phoneNumber0+". Por favor contacte a soporte.")}catch(ie){console.error("Error during file upload:",ie)}}const _e=async()=>{if(r.id_enterprise){const Z=new FormData;Z.append("id_enterprise",r.id_enterprise);try{const ee=await fetch(`${l}api/admin/enterprise/enterprise_settings.php`,{method:"POST",body:Z});ee.ok?(u=(await ee.json()).nodos,v=wt("stops_wait_approval",u),t(2,b=wt("sms_active",u))):console.error("File upload failed:",ee.statusText)}catch(ee){console.error("Error during file upload:",ee)}}};function de(){t(4,O=!1),t(5,B=!0),he(r.id_event,"checkin")}function Ne(){t(5,B=!1),t(4,O=!1),he(r.id_event,"checkout")}async function he(Z,ee){if(ee){const ie=new FormData;ie.append("type",ee),ie.append("id_event",Z);try{const re=await fetch(`${l}api/admin/route/record_check_date.php`,{method:"POST",body:ie});if(re.ok){const te=await re.json();te.minutes&&I("Tiempo por parada","Completaste la parada en "+te.minutes+" minutos.")}else console.error("File upload failed:",re.statusText)}catch(re){console.error("Error during file upload:",re)}finally{}}}function Oe(Z){Me[Z?"unshift":"push"](()=>{R=Z,t(9,R)})}function Te(Z){Me[Z?"unshift":"push"](()=>{_=Z,t(0,_)})}return[_,E,b,k,O,B,z,V,F,R,r,d,h,w,S,j,Q,ge,de,Ne,Oe,Te]}class Lt extends Xe{constructor(e){super(),We(this,e,Zn,Qn,Ke,{},null,[-1,-1])}}function zt(i){let e;return{c(){e=s("ion-spinner"),this.h()},l(t){e=c(t,"ION-SPINNER",{name:!0}),p(e).forEach(a),this.h()},h(){m(e,"name","dots")},m(t,l){Y(t,e,l)},d(t){t&&a(e)}}}function At(i){let e,t,l;return{c(){e=s("section"),t=s("ion-img"),this.h()},l(n){e=c(n,"SECTION",{});var r=p(e);t=c(r,"ION-IMG",{src:!0,alt:!0,style:!0}),p(t).forEach(a),r.forEach(a),this.h()},h(){ot(t.src,l=i[0])||m(t,"src",l),m(t,"alt","Evidencia fotográfica"),G(t,"max-width","100%"),G(t,"margin-top","16px")},m(n,r){Y(n,e,r),o(e,t)},p(n,r){r&1&&!ot(t.src,l=n[0])&&m(t,"src",l)},d(n){n&&a(e)}}}function $n(i){let e,t,l,n,r="Cancelar",d,h,_="AGREGAR GASTO",E,g,f,u,v,b,k,O,B,z,V,F,R,A,M,I,L,w,S='Tipo de pago <ion-text color="danger">(Obligatorio)</ion-text>',q,W,j="Efectivo",Q,ne,fe="Tarjeta",ge,_e,de="Transferencia",Ne,he,Oe,Te,Z,ee,ie,re,te,y,K=`<ion-icon icon="${Jt}" slot="start"></ion-icon>
                        Subir Evidencia`,U,H,J,D,P,x,ae,se,N="Confirmar",X,ve,pe=i[5]&&zt(),ce=i[0]&&At(i);return{c(){e=s("ion-header"),t=s("ion-toolbar"),l=s("ion-buttons"),n=s("ion-button"),n.textContent=r,d=T(),h=s("ion-title"),h.textContent=_,E=T(),g=s("ion-content"),f=s("ion-list"),u=s("ion-item"),v=s("ion-icon"),b=T(),k=s("ion-input"),O=T(),B=s("ion-item"),z=s("ion-icon"),V=T(),F=s("ion-input"),R=T(),A=s("ion-item"),M=s("ion-icon"),I=T(),L=s("ion-select"),w=s("div"),w.innerHTML=S,q=T(),W=s("ion-select-option"),W.textContent=j,Q=T(),ne=s("ion-select-option"),ne.textContent=fe,ge=T(),_e=s("ion-select-option"),_e.textContent=de,Ne=T(),he=s("ion-item"),Oe=s("ion-icon"),Te=T(),Z=s("ion-textarea"),ee=T(),ie=s("section"),re=s("label"),te=s("ion-button"),y=s("label"),y.innerHTML=K,U=T(),H=s("input"),J=T(),pe&&pe.c(),D=T(),ce&&ce.c(),P=T(),x=s("ion-footer"),ae=s("ion-toolbar"),se=s("ion-button"),se.textContent=N,this.h()},l(ue){e=c(ue,"ION-HEADER",{translucent:!0});var oe=p(e);t=c(oe,"ION-TOOLBAR",{});var Ce=p(t);l=c(Ce,"ION-BUTTONS",{slot:!0});var ye=p(l);n=c(ye,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),le(n)!=="svelte-1f8rjcf"&&(n.textContent=r),ye.forEach(a),d=C(Ce),h=c(Ce,"ION-TITLE",{title:!0,"data-svelte-h":!0}),le(h)!=="svelte-efps2s"&&(h.textContent=_),Ce.forEach(a),oe.forEach(a),E=C(ue),g=c(ue,"ION-CONTENT",{fullscreen:!0});var be=p(g);f=c(be,"ION-LIST",{});var Ee=p(f);u=c(Ee,"ION-ITEM",{});var Ae=p(u);v=c(Ae,"ION-ICON",{icon:!0,slot:!0}),p(v).forEach(a),b=C(Ae),k=c(Ae,"ION-INPUT",{label:!0,type:!0,placeholder:!0,value:!0}),p(k).forEach(a),Ae.forEach(a),O=C(Ee),B=c(Ee,"ION-ITEM",{});var He=p(B);z=c(He,"ION-ICON",{icon:!0,slot:!0}),p(z).forEach(a),V=C(He),F=c(He,"ION-INPUT",{label:!0,type:!0,value:!0}),p(F).forEach(a),He.forEach(a),R=C(Ee),A=c(Ee,"ION-ITEM",{});var xe=p(A);M=c(xe,"ION-ICON",{icon:!0,slot:!0}),p(M).forEach(a),I=C(xe),L=c(xe,"ION-SELECT",{placeholder:!0,value:!0});var Fe=p(L);w=c(Fe,"DIV",{slot:!0,"data-svelte-h":!0}),le(w)!=="svelte-wl764p"&&(w.innerHTML=S),q=C(Fe),W=c(Fe,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),le(W)!=="svelte-i9crym"&&(W.textContent=j),Q=C(Fe),ne=c(Fe,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),le(ne)!=="svelte-fx0z11"&&(ne.textContent=fe),ge=C(Fe),_e=c(Fe,"ION-SELECT-OPTION",{value:!0,"data-svelte-h":!0}),le(_e)!=="svelte-1c24jf2"&&(_e.textContent=de),Fe.forEach(a),xe.forEach(a),Ne=C(Ee),he=c(Ee,"ION-ITEM",{});var et=p(he);Oe=c(et,"ION-ICON",{icon:!0,slot:!0}),p(Oe).forEach(a),Te=C(et),Z=c(et,"ION-TEXTAREA",{label:!0,placeholder:!0}),p(Z).forEach(a),et.forEach(a),ee=C(Ee),ie=c(Ee,"SECTION",{});var dt=p(ie);re=c(dt,"LABEL",{for:!0,style:!0});var ht=p(re);te=c(ht,"ION-BUTTON",{fill:!0,size:!0,class:!0,expand:!0});var tt=p(te);y=c(tt,"LABEL",{for:!0,style:!0,"data-svelte-h":!0}),le(y)!=="svelte-1m9yw22"&&(y.innerHTML=K),U=C(tt),H=c(tt,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0}),tt.forEach(a),ht.forEach(a),dt.forEach(a),J=C(Ee),pe&&pe.l(Ee),D=C(Ee),ce&&ce.l(Ee),Ee.forEach(a),be.forEach(a),P=C(ue),x=c(ue,"ION-FOOTER",{});var pt=p(x);ae=c(pt,"ION-TOOLBAR",{});var mt=p(ae);se=c(mt,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),le(se)!=="svelte-1c7dl3f"&&(se.textContent=N),mt.forEach(a),pt.forEach(a),this.h()},h(){m(n,"color","medium"),m(l,"slot","start"),m(h,"title",""),m(e,"translucent",""),m(v,"icon",Wt),m(v,"slot","start"),m(k,"label","Concepto"),m(k,"type","text"),m(k,"placeholder","Escribe aquí..."),m(k,"value",i[6]?i[6]:""),m(z,"icon",at),m(z,"slot","start"),m(F,"label","Cantidad"),m(F,"type","number"),m(F,"value",i[7]?i[7]:""),m(M,"icon",vn),m(M,"slot","start"),$(w,"slot","label"),m(W,"value","cash"),m(ne,"value","card"),m(_e,"value","transfer"),m(L,"placeholder","Tipo de pago"),m(L,"value",i[8]?i[8]:""),m(Oe,"icon",at),m(Oe,"slot","start"),m(Z,"label","Comentarios"),m(Z,"placeholder","Escribe aquí..."),$(y,"for","eventEvidence"),G(y,"width","100%"),G(y,"padding","8px"),G(H,"display","none"),$(H,"id","eventEvidence"),$(H,"name","fileToUpload"),$(H,"type","file"),$(H,"accept","image/*"),m(te,"fill","outline"),m(te,"size","small"),m(te,"class","loadEvidence"),m(te,"expand","block"),$(re,"for","eventEvidence"),G(re,"display","block"),G(re,"width","100%"),m(g,"fullscreen",""),m(se,"fill","outline"),m(se,"color","tertiary"),m(se,"strong",""),G(se,"width","99%"),G(se,"height","auto")},m(ue,oe){Y(ue,e,oe),o(e,t),o(t,l),o(l,n),o(t,d),o(t,h),Y(ue,E,oe),Y(ue,g,oe),o(g,f),o(f,u),o(u,v),o(u,b),o(u,k),i[12](k),o(f,O),o(f,B),o(B,z),o(B,V),o(B,F),i[13](F),o(f,R),o(f,A),o(A,M),o(A,I),o(A,L),o(L,w),o(L,q),o(L,W),o(L,Q),o(L,ne),o(L,ge),o(L,_e),i[14](L),o(f,Ne),o(f,he),o(he,Oe),o(he,Te),o(he,Z),i[15](Z),o(f,ee),o(f,ie),o(ie,re),o(re,te),o(te,y),o(te,U),o(te,H),o(f,J),pe&&pe.m(f,null),o(f,D),ce&&ce.m(f,null),Y(ue,P,oe),Y(ue,x,oe),o(x,ae),o(ae,se),X||(ve=[me(n,"click",i[10]),me(H,"change",i[9]),me(se,"click",i[11])],X=!0)},p(ue,[oe]){ue[5]?pe||(pe=zt(),pe.c(),pe.m(f,D)):pe&&(pe.d(1),pe=null),ue[0]?ce?ce.p(ue,oe):(ce=At(ue),ce.c(),ce.m(f,null)):ce&&(ce.d(1),ce=null)},i:Le,o:Le,d(ue){ue&&(a(e),a(E),a(g),a(P),a(x)),i[12](null),i[13](null),i[14](null),i[15](null),pe&&pe.d(),ce&&ce.d(),X=!1,Be(ve)}}}function xn(i,e,t){let l=lt,n=document.querySelector("ion-modal"),r=n.componentProps.routeId,d=n.componentProps.ex_concept,h=n.componentProps.ex_amount,_=n.componentProps.ex_type,E=n.componentProps.id_expense,g="",f="",u="",v=0,b="",k="",O=!1;Ye(()=>{});const B=async(w,S)=>{await(await qe.create({header:w,message:S,buttons:[{text:"Cerrar"}]})).present()},z=async w=>{t(5,O=!0);const q=w.target.files[0],W=await V(q);if(W){const j=new FormData;j.append("fileToUpload",W);try{const Q=await fetch(`${l}api/admin/manager/upload_img_driver.php`,{method:"POST",body:j});if(Q.ok){const ne=await Q.json();t(0,g=ne.img),f=ne.img_id}else console.error("File upload failed:",Q.statusText)}catch(Q){console.error("Error during file upload:",Q)}finally{t(5,O=!1)}}},V=async w=>new Promise(S=>{const q=new FileReader;q.onload=W=>{const j=new Image;j.src=W.target.result,j.onload=()=>{const Q=document.createElement("canvas"),ne=Q.getContext("2d"),fe=800,ge=600;let _e=j.width,de=j.height;_e>fe&&(de*=fe/_e,_e=fe),de>ge&&(_e*=ge/de,de=ge),Q.width=_e,Q.height=de,ne.drawImage(j,0,0,_e,de),Q.toBlob(Ne=>{S(Ne)},"image/jpeg",.7)}},q.readAsDataURL(w)}),F=()=>{$e.dismiss()},R=()=>{var w=new Object;w.id_route=r,w.comments=b.value,w.type=u.value,w.img=g,w.img_id=f,w.amount=v.value,w.concept=k.value,w.status="done",w.id_expense=E||"null";const S=new FormData;for(const q in w)S.append(q,w[q]);!f||!g||!b.value||!v.value||!k.value?B("Datos incompletos","Llena los datos requeridos para completar el registro"):fetch(`${l}api/admin/expenses/add_expense.php`,{method:"POST",body:S}).then(q=>q.json()).then(q=>{F()}).catch(q=>{console.error("Error fetching data:",q)})};function A(w){Me[w?"unshift":"push"](()=>{k=w,t(4,k)})}function M(w){Me[w?"unshift":"push"](()=>{v=w,t(2,v)})}function I(w){Me[w?"unshift":"push"](()=>{u=w,t(1,u)})}function L(w){Me[w?"unshift":"push"](()=>{b=w,t(3,b)})}return[g,u,v,b,k,O,d,h,_,z,F,R,A,M,I,L]}class ct extends Xe{constructor(e){super(),We(this,e,xn,$n,Ke,{})}}function Mt(i,e,t){const l=i.slice();return l[7]=e[t],l}function eo(i){let e,t="Cargar gasto",l,n;function r(...d){return i[4](i[7],...d)}return{c(){e=s("ion-button"),e.textContent=t,this.h()},l(d){e=c(d,"ION-BUTTON",{fill:!0,size:!0,"aria-selected":!0,"data-svelte-h":!0}),le(e)!=="svelte-175aelj"&&(e.textContent=t),this.h()},h(){m(e,"fill","outline"),m(e,"size","small"),m(e,"aria-selected","")},m(d,h){Y(d,e,h),l||(n=me(e,"click",r),l=!0)},p(d,h){i=d},d(d){d&&a(e),l=!1,n()}}}function to(i){let e,t="Gasto completado";return{c(){e=s("ion-button"),e.textContent=t,this.h()},l(l){e=c(l,"ION-BUTTON",{fill:!0,size:!0,"aria-selected":!0,"data-svelte-h":!0}),le(e)!=="svelte-tlger7"&&(e.textContent=t),this.h()},h(){m(e,"fill","solid"),m(e,"size","small"),m(e,"aria-selected","")},m(l,n){Y(l,e,n)},p:Le,d(l){l&&a(e)}}}function Dt(i,e){let t,l,n,r=e[7].concept+"",d,h,_;function E(u,v){return u[7].status=="done"?to:eo}let f=E(e)(e);return{key:i,first:null,c(){t=s("ion-item"),l=s("ion-label"),n=s("p"),d=Ie(r),h=T(),f.c(),_=T(),this.h()},l(u){t=c(u,"ION-ITEM",{});var v=p(t);l=c(v,"ION-LABEL",{style:!0});var b=p(l);n=c(b,"P",{style:!0});var k=p(n);d=ke(k,r),k.forEach(a),b.forEach(a),h=C(v),f.l(v),_=C(v),v.forEach(a),this.h()},h(){G(n,"margin-left","10px"),G(l,"display","flex"),this.first=t},m(u,v){Y(u,t,v),o(t,l),o(l,n),o(n,d),o(t,h),f.m(t,null),o(t,_)},p(u,v){e=u,f.p(e,v)},d(u){u&&a(t),f.d()}}}function no(i){let e,t,l,n,r=`<ion-icon style="font-size: 25px!important;" icon="${gn}"></ion-icon>`,d,h,_="LISTA DE GASTOS",E,g,f,u=[],v=new Map,b,k,O,B="Cerrar",z,V,F=Re(i[0]);const R=A=>A[7].id_expenses;for(let A=0;A<F.length;A+=1){let M=Mt(i,F,A),I=R(M);v.set(I,u[A]=Dt(I,M))}return{c(){e=s("ion-header"),t=s("ion-toolbar"),l=s("ion-buttons"),n=s("ion-button"),n.innerHTML=r,d=T(),h=s("ion-title"),h.textContent=_,E=T(),g=s("ion-content"),f=s("ion-list");for(let A=0;A<u.length;A+=1)u[A].c();b=T(),k=s("ion-footer"),O=s("ion-button"),O.textContent=B,this.h()},l(A){e=c(A,"ION-HEADER",{translucent:!0});var M=p(e);t=c(M,"ION-TOOLBAR",{});var I=p(t);l=c(I,"ION-BUTTONS",{slot:!0});var L=p(l);n=c(L,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),le(n)!=="svelte-160xz3i"&&(n.innerHTML=r),L.forEach(a),d=C(I),h=c(I,"ION-TITLE",{"data-svelte-h":!0}),le(h)!=="svelte-1phn90x"&&(h.textContent=_),I.forEach(a),M.forEach(a),E=C(A),g=c(A,"ION-CONTENT",{fullscreen:!0});var w=p(g);f=c(w,"ION-LIST",{});var S=p(f);for(let W=0;W<u.length;W+=1)u[W].l(S);S.forEach(a),w.forEach(a),b=C(A),k=c(A,"ION-FOOTER",{});var q=p(k);O=c(q,"ION-BUTTON",{fill:!0,color:!0,strong:!0,style:!0,"data-svelte-h":!0}),le(O)!=="svelte-zv7v83"&&(O.textContent=B),q.forEach(a),this.h()},h(){m(n,"color","medium"),m(l,"slot","end"),m(e,"translucent",""),m(g,"fullscreen",""),m(O,"fill","outline"),m(O,"color","tertiary"),m(O,"strong",""),G(O,"width","99%"),G(O,"height","auto")},m(A,M){Y(A,e,M),o(e,t),o(t,l),o(l,n),o(t,d),o(t,h),Y(A,E,M),Y(A,g,M),o(g,f);for(let I=0;I<u.length;I+=1)u[I]&&u[I].m(f,null);Y(A,b,M),Y(A,k,M),o(k,O),z||(V=[me(n,"click",i[3]),me(O,"click",i[1])],z=!0)},p(A,[M]){M&5&&(F=Re(A[0]),u=Qe(u,M,R,1,A,F,v,f,Ze,Dt,null,Mt))},i:Le,o:Le,d(A){A&&(a(e),a(E),a(g),a(b),a(k));for(let M=0;M<u.length;M+=1)u[M].d();z=!1,Be(V)}}}function oo(i){let e=document.querySelector("ion-modal");e.componentProps.routeId;let t=e.componentProps.expenses;Ye(()=>{});const l=()=>{$e.dismiss()};function n(h,_,E,g,f){e.componentProps.ex_amount=E,e.componentProps.ex_concept=_,e.componentProps.ex_type=g,e.componentProps.id_expense=f,Ue("modal-expense",ct,{amount:E,concept:_,type:g,id_expense:f}).then(()=>{}),l()}return[t,l,n,h=>{Ue("modal-expense",ct,{routeId:h}).then(_=>{}),l()},(h,_)=>n(_,h.concept,h.amount,h.type,h.id_expenses)]}class lo extends Xe{constructor(e){super(),We(this,e,oo,no,Ke,{})}}const{document:St}=Tn;function Pt(i,e,t){const l=i.slice();return l[44]=e[t],l[46]=t,l}function Bt(i,e,t){const l=i.slice();return l[44]=e[t],l[46]=t,l}function Ht(i,e,t){const l=i.slice();return l[44]=e[t],l[46]=t,l}function Rt(i){let e,t;return e=new kn({props:{$$slots:{default:[fo]},$$scope:{ctx:i}}}),{c(){on(e.$$.fragment)},l(l){ln(e.$$.fragment,l)},m(l,n){rn(e,l,n),t=!0},p(l,n){const r={};n[0]&1019|n[1]&262144&&(r.$$scope={dirty:n,ctx:l}),e.$set(r)},i(l){t||(nt(e.$$.fragment,l),t=!0)},o(l){rt(e.$$.fragment,l),t=!1},d(l){an(e,l)}}}function io(i){let e,t='<div id="g_map" style="width: 100%; height: 100vh;"></div>';return{c(){e=s("ion-content"),e.innerHTML=t},l(l){e=c(l,"ION-CONTENT",{"data-svelte-h":!0}),le(e)!=="svelte-1ydw6i9"&&(e.innerHTML=t)},m(l,n){Y(l,e,n)},p:Le,d(l){l&&a(e)}}}function ro(i){let e;function t(r,d){if(r[7].length>0)return so;if(!r[3])return ao}let l=t(i),n=l&&l(i);return{c(){n&&n.c(),e=Se()},l(r){n&&n.l(r),e=Se()},m(r,d){n&&n.m(r,d),Y(r,e,d)},p(r,d){l===(l=t(r))&&n?n.p(r,d):(n&&n.d(1),n=l&&l(r),n&&(n.c(),n.m(e.parentNode,e)))},d(r){r&&a(e),n&&n.d(r)}}}function ao(i){let e,t,l,n='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Jala para actualizar" refreshing-spinner="circles" refreshing-text="Actualizando..."></ion-refresher-content>',r,d,h,_,E,g,f="0",u,v,b,k,O,B=i[6].origin+"",z,V,F,R="",A,M,I,L=[],w=new Map,S,q,W,j,Q,ne=i[5].length+1+"",fe,ge,_e,de,Ne,he,Oe=i[6].destination+"",Te,Z,ee,ie="",re,te,y,K,U=i[4]&&Ut(i),H=Re(i[5]);const J=D=>D[44].id_event;for(let D=0;D<H.length;D+=1){let P=Pt(i,H,D),x=J(P);w.set(x,L[D]=Vt(x,P))}return{c(){U&&U.c(),e=T(),t=s("ion-content"),l=s("ion-refresher"),l.innerHTML=n,r=T(),d=s("ion-list"),h=s("ion-item"),_=s("ion-avatar"),E=s("div"),g=s("div"),g.textContent=f,v=T(),b=s("ion-label"),k=s("ion-text"),O=s("h3"),z=Ie(B),V=T(),F=s("div"),F.innerHTML=R,A=T(),M=s("ion-icon"),I=T();for(let D=0;D<L.length;D+=1)L[D].c();S=T(),q=s("ion-item"),W=s("ion-avatar"),j=s("div"),Q=s("div"),fe=Ie(ne),_e=T(),de=s("ion-label"),Ne=s("ion-text"),he=s("h3"),Te=Ie(Oe),Z=T(),ee=s("div"),ee.innerHTML=ie,re=T(),te=s("ion-icon"),this.h()},l(D){U&&U.l(D),e=C(D),t=c(D,"ION-CONTENT",{});var P=p(t);l=c(P,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),le(l)!=="svelte-1srnbs3"&&(l.innerHTML=n),r=C(P),d=c(P,"ION-LIST",{});var x=p(d);h=c(x,"ION-ITEM",{});var ae=p(h);_=c(ae,"ION-AVATAR",{slot:!0});var se=p(_);E=c(se,"DIV",{class:!0,title:!0,style:!0});var N=p(E);g=c(N,"DIV",{class:!0,"data-svelte-h":!0}),le(g)!=="svelte-3lvlrb"&&(g.textContent=f),N.forEach(a),se.forEach(a),v=C(ae),b=c(ae,"ION-LABEL",{button:!0});var X=p(b);k=c(X,"ION-TEXT",{color:!0});var ve=p(k);O=c(ve,"H3",{});var pe=p(O);z=ke(pe,B),pe.forEach(a),ve.forEach(a),V=C(X),F=c(X,"DIV",{class:!0,"data-svelte-h":!0}),le(F)!=="svelte-gz9kb"&&(F.innerHTML=R),X.forEach(a),A=C(ae),M=c(ae,"ION-ICON",{icon:!0,slot:!0}),p(M).forEach(a),ae.forEach(a),I=C(x);for(let Ae=0;Ae<L.length;Ae+=1)L[Ae].l(x);S=C(x),q=c(x,"ION-ITEM",{});var ce=p(q);W=c(ce,"ION-AVATAR",{slot:!0});var ue=p(W);j=c(ue,"DIV",{class:!0,title:!0,style:!0});var oe=p(j);Q=c(oe,"DIV",{class:!0});var Ce=p(Q);fe=ke(Ce,ne),Ce.forEach(a),oe.forEach(a),ue.forEach(a),_e=C(ce),de=c(ce,"ION-LABEL",{button:!0});var ye=p(de);Ne=c(ye,"ION-TEXT",{color:!0});var be=p(Ne);he=c(be,"H3",{});var Ee=p(he);Te=ke(Ee,Oe),Ee.forEach(a),be.forEach(a),Z=C(ye),ee=c(ye,"DIV",{class:!0,"data-svelte-h":!0}),le(ee)!=="svelte-130ohbs"&&(ee.innerHTML=ie),ye.forEach(a),re=C(ce),te=c(ce,"ION-ICON",{icon:!0,slot:!0}),p(te).forEach(a),ce.forEach(a),x.forEach(a),P.forEach(a),this.h()},h(){m(l,"slot","fixed"),$(g,"class","order svelte-egzizz"),$(E,"class","order-wrapper svelte-egzizz"),$(E,"title",u="$"+i[6].origin),G(E,"background-color",i[6].color),G(E,"color",ze(i[6].color)),m(_,"slot","start"),m(k,"color","#2e2e2e"),$(F,"class","sub svelte-egzizz"),m(b,"button",""),m(M,"icon",Pe),m(M,"slot","end"),$(Q,"class","order svelte-egzizz"),$(j,"class","order-wrapper svelte-egzizz"),$(j,"title",ge="$"+i[6].destination),G(j,"background-color",i[6].color),G(j,"color",ze(i[6].color)),m(W,"slot","start"),m(Ne,"color","#2e2e2e"),$(ee,"class","sub svelte-egzizz"),m(de,"button",""),m(te,"icon",Pe),m(te,"slot","end")},m(D,P){U&&U.m(D,P),Y(D,e,P),Y(D,t,P),o(t,l),i[30](l),o(t,r),o(t,d),o(d,h),o(h,_),o(_,E),o(E,g),o(h,v),o(h,b),o(b,k),o(k,O),o(O,z),o(b,V),o(b,F),o(h,A),o(h,M),o(d,I);for(let x=0;x<L.length;x+=1)L[x]&&L[x].m(d,null);o(d,S),o(d,q),o(q,W),o(W,j),o(j,Q),o(Q,fe),o(q,_e),o(q,de),o(de,Ne),o(Ne,he),o(he,Te),o(de,Z),o(de,ee),o(q,re),o(q,te),y||(K=[me(l,"ionRefresh",i[10]),me(b,"click",i[31]),me(de,"click",i[33])],y=!0)},p(D,P){D[4]?U?U.p(D,P):(U=Ut(D),U.c(),U.m(e.parentNode,e)):U&&(U.d(1),U=null),P[0]&64&&u!==(u="$"+D[6].origin)&&$(E,"title",u),P[0]&64&&G(E,"background-color",D[6].color),P[0]&64&&G(E,"color",ze(D[6].color)),P[0]&64&&B!==(B=D[6].origin+"")&&we(z,B),P[0]&331808&&(H=Re(D[5]),L=Qe(L,P,J,1,D,H,w,d,Ze,Vt,S,Pt)),P[0]&32&&ne!==(ne=D[5].length+1+"")&&we(fe,ne),P[0]&64&&ge!==(ge="$"+D[6].destination)&&$(j,"title",ge),P[0]&64&&G(j,"background-color",D[6].color),P[0]&64&&G(j,"color",ze(D[6].color)),P[0]&64&&Oe!==(Oe=D[6].destination+"")&&we(Te,Oe)},d(D){D&&(a(e),a(t)),U&&U.d(D),i[30](null);for(let P=0;P<L.length;P+=1)L[P].d();y=!1,Be(K)}}}function so(i){let e,t;function l(d,h){return h[0]&144&&(e=null),e==null&&(e=!!(d[7].filter(ho).every(po)&&!d[4])),e?uo:co}let n=l(i,[-1,-1]),r=n(i);return{c(){r.c(),t=Se()},l(d){r.l(d),t=Se()},m(d,h){r.m(d,h),Y(d,t,h)},p(d,h){n===(n=l(d,h))&&r?r.p(d,h):(r.d(1),r=n(d),r&&(r.c(),r.m(t.parentNode,t)))},d(d){d&&a(t),r.d(d)}}}function Ut(i){let e=i[14]("",i[1],i[0])+"",t;return{c(){t=Ie(e)},l(l){t=ke(l,e)},m(l,n){Y(l,t,n)},p(l,n){n[0]&3&&e!==(e=l[14]("",l[1],l[0])+"")&&we(t,e)},d(l){l&&a(t)}}}function Ft(i){let e;return{c(){e=s("span"),this.h()},l(t){e=c(t,"SPAN",{class:!0}),p(e).forEach(a),this.h()},h(){$(e,"class","notes svelte-egzizz")},m(t,l){Y(t,e,l)},d(t){t&&a(e)}}}function Vt(i,e){let t,l,n,r,d=parseInt(e[44].pos)+1+"",h,_,E,g,f,u,v=e[44].title+"",b,k,O=e[44].support_list&&e[44].support_list.length||e[16](e[44]),B,z,V,F,R=O&&Ft();function A(){return e[32](e[44])}return{key:i,first:null,c(){t=s("ion-item"),l=s("ion-avatar"),n=s("div"),r=s("div"),h=Ie(d),E=T(),g=s("ion-label"),f=s("ion-text"),u=s("h3"),b=Ie(v),k=T(),R&&R.c(),B=T(),z=s("ion-icon"),this.h()},l(M){t=c(M,"ION-ITEM",{});var I=p(t);l=c(I,"ION-AVATAR",{slot:!0});var L=p(l);n=c(L,"DIV",{class:!0,title:!0,style:!0});var w=p(n);r=c(w,"DIV",{class:!0});var S=p(r);h=ke(S,d),S.forEach(a),w.forEach(a),L.forEach(a),E=C(I),g=c(I,"ION-LABEL",{button:!0});var q=p(g);f=c(q,"ION-TEXT",{color:!0});var W=p(f);u=c(W,"H3",{});var j=p(u);b=ke(j,v),k=C(j),R&&R.l(j),j.forEach(a),W.forEach(a),q.forEach(a),B=C(I),z=c(I,"ION-ICON",{icon:!0,slot:!0,style:!0}),p(z).forEach(a),I.forEach(a),this.h()},h(){$(r,"class","order svelte-egzizz"),$(n,"class","order-wrapper svelte-egzizz"),$(n,"title",_=Ge(e[44].status)),G(n,"background-color",De(e[44].status,e[44].date_service)),G(n,"color",ze(De(e[44].status))),m(l,"slot","start"),m(f,"color","#2e2e2e"),m(g,"button",""),m(z,"icon",Pe),m(z,"slot","end"),G(z,"color",De(e[44].status,e[44].date_service)),this.first=t},m(M,I){Y(M,t,I),o(t,l),o(l,n),o(n,r),o(r,h),o(t,E),o(t,g),o(g,f),o(f,u),o(u,b),o(u,k),R&&R.m(u,null),o(t,B),o(t,z),V||(F=me(g,"click",A),V=!0)},p(M,I){e=M,I[0]&32&&d!==(d=parseInt(e[44].pos)+1+"")&&we(h,d),I[0]&32&&_!==(_=Ge(e[44].status))&&$(n,"title",_),I[0]&32&&G(n,"background-color",De(e[44].status,e[44].date_service)),I[0]&32&&G(n,"color",ze(De(e[44].status))),I[0]&32&&v!==(v=e[44].title+"")&&we(b,v),I[0]&32&&(O=e[44].support_list&&e[44].support_list.length||e[16](e[44])),O?R||(R=Ft(),R.c(),R.m(u,null)):R&&(R.d(1),R=null),I[0]&32&&G(z,"color",De(e[44].status,e[44].date_service))},d(M){M&&a(t),R&&R.d(),V=!1,F()}}}function co(i){let e=i[14](i[7],i[1],i[0])+"",t,l,n,r,d='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Pull to refresh" refreshing-spinner="circles" refreshing-text="Refreshing..."></ion-refresher-content>',h,_,E,g,f,u,v="0",b,k,O,B,z,V=i[6].origin+"",F,R,A,M="",I,L,w,S=[],q=new Map,W,j,Q,ne,fe,ge=i[5].length+1+"",_e,de,Ne,he,Oe,Te,Z=i[6].destination+"",ee,ie,re,te="",y,K,U,H,J=Re(i[5]);const D=P=>P[44].id_event;for(let P=0;P<J.length;P+=1){let x=Bt(i,J,P),ae=D(x);q.set(ae,S[P]=jt(ae,x))}return{c(){t=Ie(e),l=T(),n=s("ion-content"),r=s("ion-refresher"),r.innerHTML=d,h=T(),_=s("ion-list"),E=s("ion-item"),g=s("ion-avatar"),f=s("div"),u=s("div"),u.textContent=v,k=T(),O=s("ion-label"),B=s("ion-text"),z=s("h3"),F=Ie(V),R=T(),A=s("div"),A.innerHTML=M,I=T(),L=s("ion-icon"),w=T();for(let P=0;P<S.length;P+=1)S[P].c();W=T(),j=s("ion-item"),Q=s("ion-avatar"),ne=s("div"),fe=s("div"),_e=Ie(ge),Ne=T(),he=s("ion-label"),Oe=s("ion-text"),Te=s("h3"),ee=Ie(Z),ie=T(),re=s("div"),re.innerHTML=te,y=T(),K=s("ion-icon"),this.h()},l(P){t=ke(P,e),l=C(P),n=c(P,"ION-CONTENT",{});var x=p(n);r=c(x,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),le(r)!=="svelte-dvt1s"&&(r.innerHTML=d),h=C(x),_=c(x,"ION-LIST",{});var ae=p(_);E=c(ae,"ION-ITEM",{});var se=p(E);g=c(se,"ION-AVATAR",{slot:!0});var N=p(g);f=c(N,"DIV",{class:!0,title:!0,style:!0});var X=p(f);u=c(X,"DIV",{class:!0,"data-svelte-h":!0}),le(u)!=="svelte-3lvlrb"&&(u.textContent=v),X.forEach(a),N.forEach(a),k=C(se),O=c(se,"ION-LABEL",{button:!0});var ve=p(O);B=c(ve,"ION-TEXT",{color:!0});var pe=p(B);z=c(pe,"H3",{});var ce=p(z);F=ke(ce,V),ce.forEach(a),pe.forEach(a),R=C(ve),A=c(ve,"DIV",{class:!0,"data-svelte-h":!0}),le(A)!=="svelte-gz9kb"&&(A.innerHTML=M),ve.forEach(a),I=C(se),L=c(se,"ION-ICON",{icon:!0,slot:!0}),p(L).forEach(a),se.forEach(a),w=C(ae);for(let He=0;He<S.length;He+=1)S[He].l(ae);W=C(ae),j=c(ae,"ION-ITEM",{});var ue=p(j);Q=c(ue,"ION-AVATAR",{slot:!0});var oe=p(Q);ne=c(oe,"DIV",{class:!0,title:!0,style:!0});var Ce=p(ne);fe=c(Ce,"DIV",{class:!0});var ye=p(fe);_e=ke(ye,ge),ye.forEach(a),Ce.forEach(a),oe.forEach(a),Ne=C(ue),he=c(ue,"ION-LABEL",{button:!0});var be=p(he);Oe=c(be,"ION-TEXT",{color:!0});var Ee=p(Oe);Te=c(Ee,"H3",{});var Ae=p(Te);ee=ke(Ae,Z),Ae.forEach(a),Ee.forEach(a),ie=C(be),re=c(be,"DIV",{class:!0,"data-svelte-h":!0}),le(re)!=="svelte-130ohbs"&&(re.innerHTML=te),be.forEach(a),y=C(ue),K=c(ue,"ION-ICON",{icon:!0,slot:!0}),p(K).forEach(a),ue.forEach(a),ae.forEach(a),x.forEach(a),this.h()},h(){m(r,"slot","fixed"),$(u,"class","order svelte-egzizz"),$(f,"class","order-wrapper svelte-egzizz"),$(f,"title",b="$"+i[6].origin),G(f,"background-color",i[6].color),G(f,"color",ze(i[6].color)),m(g,"slot","start"),m(B,"color","#2e2e2e"),$(A,"class","sub svelte-egzizz"),m(O,"button",""),m(L,"icon",Pe),m(L,"slot","end"),$(fe,"class","order svelte-egzizz"),$(ne,"class","order-wrapper svelte-egzizz"),$(ne,"title",de="$"+i[6].destination),G(ne,"background-color",i[6].color),G(ne,"color",ze(i[6].color)),m(Q,"slot","start"),m(Oe,"color","#2e2e2e"),$(re,"class","sub svelte-egzizz"),m(he,"button",""),m(K,"icon",Pe),m(K,"slot","end")},m(P,x){Y(P,t,x),Y(P,l,x),Y(P,n,x),o(n,r),i[26](r),o(n,h),o(n,_),o(_,E),o(E,g),o(g,f),o(f,u),o(E,k),o(E,O),o(O,B),o(B,z),o(z,F),o(O,R),o(O,A),o(E,I),o(E,L),o(_,w);for(let ae=0;ae<S.length;ae+=1)S[ae]&&S[ae].m(_,null);o(_,W),o(_,j),o(j,Q),o(Q,ne),o(ne,fe),o(fe,_e),o(j,Ne),o(j,he),o(he,Oe),o(Oe,Te),o(Te,ee),o(he,ie),o(he,re),o(j,y),o(j,K),U||(H=[me(r,"ionRefresh",i[10]),me(O,"click",i[27]),me(he,"click",i[29])],U=!0)},p(P,x){x[0]&131&&e!==(e=P[14](P[7],P[1],P[0])+"")&&we(t,e),x[0]&64&&b!==(b="$"+P[6].origin)&&$(f,"title",b),x[0]&64&&G(f,"background-color",P[6].color),x[0]&64&&G(f,"color",ze(P[6].color)),x[0]&64&&V!==(V=P[6].origin+"")&&we(F,V),x[0]&331808&&(J=Re(P[5]),S=Qe(S,x,D,1,P,J,q,_,Ze,jt,W,Bt)),x[0]&32&&ge!==(ge=P[5].length+1+"")&&we(_e,ge),x[0]&64&&de!==(de="$"+P[6].destination)&&$(ne,"title",de),x[0]&64&&G(ne,"background-color",P[6].color),x[0]&64&&G(ne,"color",ze(P[6].color)),x[0]&64&&Z!==(Z=P[6].destination+"")&&we(ee,Z)},d(P){P&&(a(t),a(l),a(n)),i[26](null);for(let x=0;x<S.length;x+=1)S[x].d();U=!1,Be(H)}}}function uo(i){let e,t,l='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Jale para actualizar" refreshing-spinner="circles" refreshing-text="Actualizando..."></ion-refresher-content>',n,r,d,h,_,E,g="0",f,u,v,b,k,O=i[6].origin+"",B,z,V,F="",R,A,M,I=[],L=new Map,w,S,q,W,j,Q=i[5].length+1+"",ne,fe,ge,_e,de,Ne,he=i[6].destination+"",Oe,Te,Z,ee="",ie,re,te,y,K=Re(i[5]);const U=H=>H[44].id_event;for(let H=0;H<K.length;H+=1){let J=Ht(i,K,H),D=U(J);L.set(D,I[H]=Kt(D,J))}return{c(){e=s("ion-content"),t=s("ion-refresher"),t.innerHTML=l,n=T(),r=s("ion-list"),d=s("ion-item"),h=s("ion-avatar"),_=s("div"),E=s("div"),E.textContent=g,u=T(),v=s("ion-label"),b=s("ion-text"),k=s("h3"),B=Ie(O),z=T(),V=s("div"),V.innerHTML=F,R=T(),A=s("ion-icon"),M=T();for(let H=0;H<I.length;H+=1)I[H].c();w=T(),S=s("ion-item"),q=s("ion-avatar"),W=s("div"),j=s("div"),ne=Ie(Q),ge=T(),_e=s("ion-label"),de=s("ion-text"),Ne=s("h3"),Oe=Ie(he),Te=T(),Z=s("div"),Z.innerHTML=ee,ie=T(),re=s("ion-icon"),this.h()},l(H){e=c(H,"ION-CONTENT",{});var J=p(e);t=c(J,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),le(t)!=="svelte-15ukrgn"&&(t.innerHTML=l),n=C(J),r=c(J,"ION-LIST",{});var D=p(r);d=c(D,"ION-ITEM",{});var P=p(d);h=c(P,"ION-AVATAR",{slot:!0});var x=p(h);_=c(x,"DIV",{class:!0,title:!0,style:!0});var ae=p(_);E=c(ae,"DIV",{class:!0,"data-svelte-h":!0}),le(E)!=="svelte-3lvlrb"&&(E.textContent=g),ae.forEach(a),x.forEach(a),u=C(P),v=c(P,"ION-LABEL",{button:!0});var se=p(v);b=c(se,"ION-TEXT",{color:!0});var N=p(b);k=c(N,"H3",{});var X=p(k);B=ke(X,O),X.forEach(a),N.forEach(a),z=C(se),V=c(se,"DIV",{class:!0,"data-svelte-h":!0}),le(V)!=="svelte-gz9kb"&&(V.innerHTML=F),se.forEach(a),R=C(P),A=c(P,"ION-ICON",{icon:!0,slot:!0}),p(A).forEach(a),P.forEach(a),M=C(D);for(let be=0;be<I.length;be+=1)I[be].l(D);w=C(D),S=c(D,"ION-ITEM",{});var ve=p(S);q=c(ve,"ION-AVATAR",{slot:!0});var pe=p(q);W=c(pe,"DIV",{class:!0,title:!0,style:!0});var ce=p(W);j=c(ce,"DIV",{class:!0});var ue=p(j);ne=ke(ue,Q),ue.forEach(a),ce.forEach(a),pe.forEach(a),ge=C(ve),_e=c(ve,"ION-LABEL",{button:!0});var oe=p(_e);de=c(oe,"ION-TEXT",{color:!0});var Ce=p(de);Ne=c(Ce,"H3",{});var ye=p(Ne);Oe=ke(ye,he),ye.forEach(a),Ce.forEach(a),Te=C(oe),Z=c(oe,"DIV",{class:!0,"data-svelte-h":!0}),le(Z)!=="svelte-130ohbs"&&(Z.innerHTML=ee),oe.forEach(a),ie=C(ve),re=c(ve,"ION-ICON",{icon:!0,slot:!0}),p(re).forEach(a),ve.forEach(a),D.forEach(a),J.forEach(a),this.h()},h(){m(t,"slot","fixed"),$(E,"class","order svelte-egzizz"),$(_,"class","order-wrapper svelte-egzizz"),$(_,"title",f="$"+i[6].origin),G(_,"background-color",i[6].color),G(_,"color",ze(i[6].color)),m(h,"slot","start"),m(b,"color","#2e2e2e"),$(V,"class","sub svelte-egzizz"),m(v,"button",""),m(A,"icon",Pe),m(A,"slot","end"),$(j,"class","order svelte-egzizz"),$(W,"class","order-wrapper svelte-egzizz"),$(W,"title",fe="$"+i[6].destination),G(W,"background-color",i[6].color),G(W,"color",ze(i[6].color)),m(q,"slot","start"),m(de,"color","#2e2e2e"),$(Z,"class","sub svelte-egzizz"),m(_e,"button",""),m(re,"icon",Pe),m(re,"slot","end")},m(H,J){Y(H,e,J),o(e,t),i[22](t),o(e,n),o(e,r),o(r,d),o(d,h),o(h,_),o(_,E),o(d,u),o(d,v),o(v,b),o(b,k),o(k,B),o(v,z),o(v,V),o(d,R),o(d,A),o(r,M);for(let D=0;D<I.length;D+=1)I[D]&&I[D].m(r,null);o(r,w),o(r,S),o(S,q),o(q,W),o(W,j),o(j,ne),o(S,ge),o(S,_e),o(_e,de),o(de,Ne),o(Ne,Oe),o(_e,Te),o(_e,Z),o(S,ie),o(S,re),te||(y=[me(t,"ionRefresh",i[10]),me(v,"click",i[23]),me(_e,"click",i[25])],te=!0)},p(H,J){J[0]&64&&f!==(f="$"+H[6].origin)&&$(_,"title",f),J[0]&64&&G(_,"background-color",H[6].color),J[0]&64&&G(_,"color",ze(H[6].color)),J[0]&64&&O!==(O=H[6].origin+"")&&we(B,O),J[0]&331808&&(K=Re(H[5]),I=Qe(I,J,U,1,H,K,L,r,Ze,Kt,w,Ht)),J[0]&32&&Q!==(Q=H[5].length+1+"")&&we(ne,Q),J[0]&64&&fe!==(fe="$"+H[6].destination)&&$(W,"title",fe),J[0]&64&&G(W,"background-color",H[6].color),J[0]&64&&G(W,"color",ze(H[6].color)),J[0]&64&&he!==(he=H[6].destination+"")&&we(Oe,he)},d(H){H&&a(e),i[22](null);for(let J=0;J<I.length;J+=1)I[J].d();te=!1,Be(y)}}}function qt(i){let e;return{c(){e=s("span"),this.h()},l(t){e=c(t,"SPAN",{class:!0}),p(e).forEach(a),this.h()},h(){$(e,"class","notes svelte-egzizz")},m(t,l){Y(t,e,l)},d(t){t&&a(e)}}}function jt(i,e){let t,l,n,r,d=parseInt(e[44].pos)+1+"",h,_,E,g,f,u,v=e[44].title+"",b,k,O=e[44].support_list&&e[44].support_list.length||e[16](e[44]),B,z,V="",F,R,A,M,I=O&&qt();function L(){return e[28](e[44])}return{key:i,first:null,c(){t=s("ion-item"),l=s("ion-avatar"),n=s("div"),r=s("div"),h=Ie(d),E=T(),g=s("ion-label"),f=s("ion-text"),u=s("h3"),b=Ie(v),k=T(),I&&I.c(),B=T(),z=s("div"),z.innerHTML=V,F=T(),R=s("ion-icon"),this.h()},l(w){t=c(w,"ION-ITEM",{});var S=p(t);l=c(S,"ION-AVATAR",{slot:!0});var q=p(l);n=c(q,"DIV",{class:!0,title:!0,style:!0});var W=p(n);r=c(W,"DIV",{class:!0});var j=p(r);h=ke(j,d),j.forEach(a),W.forEach(a),q.forEach(a),E=C(S),g=c(S,"ION-LABEL",{button:!0});var Q=p(g);f=c(Q,"ION-TEXT",{color:!0});var ne=p(f);u=c(ne,"H3",{});var fe=p(u);b=ke(fe,v),k=C(fe),I&&I.l(fe),fe.forEach(a),ne.forEach(a),B=C(Q),z=c(Q,"DIV",{class:!0,"data-svelte-h":!0}),le(z)!=="svelte-qaecoo"&&(z.innerHTML=V),Q.forEach(a),F=C(S),R=c(S,"ION-ICON",{icon:!0,slot:!0}),p(R).forEach(a),S.forEach(a),this.h()},h(){$(r,"class","order svelte-egzizz"),$(n,"class","order-wrapper svelte-egzizz"),$(n,"title",_=Ge(e[44].status)),G(n,"background-color",De(e[44].status,e[44].date_service)),G(n,"color",ze(De(e[44].status))),m(l,"slot","start"),m(f,"color","#2e2e2e"),$(z,"class","sub svelte-egzizz"),m(g,"button",""),m(R,"icon",Pe),m(R,"slot","end"),this.first=t},m(w,S){Y(w,t,S),o(t,l),o(l,n),o(n,r),o(r,h),o(t,E),o(t,g),o(g,f),o(f,u),o(u,b),o(u,k),I&&I.m(u,null),o(g,B),o(g,z),o(t,F),o(t,R),A||(M=me(g,"click",L),A=!0)},p(w,S){e=w,S[0]&32&&d!==(d=parseInt(e[44].pos)+1+"")&&we(h,d),S[0]&32&&_!==(_=Ge(e[44].status))&&$(n,"title",_),S[0]&32&&G(n,"background-color",De(e[44].status,e[44].date_service)),S[0]&32&&G(n,"color",ze(De(e[44].status))),S[0]&32&&v!==(v=e[44].title+"")&&we(b,v),S[0]&32&&(O=e[44].support_list&&e[44].support_list.length||e[16](e[44])),O?I||(I=qt(),I.c(),I.m(u,null)):I&&(I.d(1),I=null)},d(w){w&&a(t),I&&I.d(),A=!1,M()}}}function Gt(i){let e;return{c(){e=s("span"),this.h()},l(t){e=c(t,"SPAN",{class:!0}),p(e).forEach(a),this.h()},h(){$(e,"class","notes svelte-egzizz")},m(t,l){Y(t,e,l)},d(t){t&&a(e)}}}function Kt(i,e){let t,l,n,r,d=parseInt(e[44].pos)+1+"",h,_,E,g,f,u,v=e[44].title+"",b,k,O=e[44].support_list&&e[44].support_list.length||e[16](e[44]),B,z,V="",F,R,A,M,I=O&&Gt();function L(){return e[24](e[44])}return{key:i,first:null,c(){t=s("ion-item"),l=s("ion-avatar"),n=s("div"),r=s("div"),h=Ie(d),E=T(),g=s("ion-label"),f=s("ion-text"),u=s("h3"),b=Ie(v),k=T(),I&&I.c(),B=T(),z=s("div"),z.innerHTML=V,F=T(),R=s("ion-icon"),this.h()},l(w){t=c(w,"ION-ITEM",{});var S=p(t);l=c(S,"ION-AVATAR",{slot:!0});var q=p(l);n=c(q,"DIV",{class:!0,title:!0,style:!0});var W=p(n);r=c(W,"DIV",{class:!0});var j=p(r);h=ke(j,d),j.forEach(a),W.forEach(a),q.forEach(a),E=C(S),g=c(S,"ION-LABEL",{button:!0});var Q=p(g);f=c(Q,"ION-TEXT",{color:!0});var ne=p(f);u=c(ne,"H3",{});var fe=p(u);b=ke(fe,v),k=C(fe),I&&I.l(fe),fe.forEach(a),ne.forEach(a),B=C(Q),z=c(Q,"DIV",{class:!0,"data-svelte-h":!0}),le(z)!=="svelte-qaecoo"&&(z.innerHTML=V),Q.forEach(a),F=C(S),R=c(S,"ION-ICON",{icon:!0,slot:!0}),p(R).forEach(a),S.forEach(a),this.h()},h(){$(r,"class","order svelte-egzizz"),$(n,"class","order-wrapper svelte-egzizz"),$(n,"title",_=Ge(e[44].status)),G(n,"background-color",De(e[44].status,e[44].date_service)),G(n,"color",ze(De(e[44].status))),m(l,"slot","start"),m(f,"color","#2e2e2e"),$(z,"class","sub svelte-egzizz"),m(g,"button",""),m(R,"icon",Pe),m(R,"slot","end"),this.first=t},m(w,S){Y(w,t,S),o(t,l),o(l,n),o(n,r),o(r,h),o(t,E),o(t,g),o(g,f),o(f,u),o(u,b),o(u,k),I&&I.m(u,null),o(g,B),o(g,z),o(t,F),o(t,R),A||(M=me(g,"click",L),A=!0)},p(w,S){e=w,S[0]&32&&d!==(d=parseInt(e[44].pos)+1+"")&&we(h,d),S[0]&32&&_!==(_=Ge(e[44].status))&&$(n,"title",_),S[0]&32&&G(n,"background-color",De(e[44].status,e[44].date_service)),S[0]&32&&G(n,"color",ze(De(e[44].status))),S[0]&32&&v!==(v=e[44].title+"")&&we(b,v),S[0]&32&&(O=e[44].support_list&&e[44].support_list.length||e[16](e[44])),O?I||(I=Gt(),I.c(),I.m(u,null)):I&&(I.d(1),I=null)},d(w){w&&a(t),I&&I.d(),A=!1,M()}}}function fo(i){let e,t,l,n,r=`<ion-icon icon="${bn}"></ion-icon>`,d,h,_,E=`<ion-icon icon="${En}"></ion-icon>`,g,f,u=(i[6].name?i[6].name.toUpperCase():"")+"",v,b,k,O='<ion-segment-button value="list"><ion-label>Paradas</ion-label></ion-segment-button> <ion-segment-button value="map"><ion-label>Mapa</ion-label></ion-segment-button>',B,z,V,F;function R(I,L){if(I[9]==="list")return ro;if(I[9]==="map")return io}let A=R(i),M=A&&A(i);return{c(){e=s("ion-header"),t=s("ion-toolbar"),l=s("ion-buttons"),n=s("ion-button"),n.innerHTML=r,d=T(),h=s("ion-buttons"),_=s("ion-button"),_.innerHTML=E,g=T(),f=s("ion-title"),v=Ie(u),b=T(),k=s("ion-segment"),k.innerHTML=O,B=T(),M&&M.c(),z=Se(),this.h()},l(I){e=c(I,"ION-HEADER",{translucent:!0});var L=p(e);t=c(L,"ION-TOOLBAR",{});var w=p(t);l=c(w,"ION-BUTTONS",{slot:!0});var S=p(l);n=c(S,"ION-BUTTON",{title:!0,alt:!0,"data-svelte-h":!0}),le(n)!=="svelte-7ppz3r"&&(n.innerHTML=r),S.forEach(a),d=C(w),h=c(w,"ION-BUTTONS",{slot:!0});var q=p(h);_=c(q,"ION-BUTTON",{"data-svelte-h":!0}),le(_)!=="svelte-nf50hj"&&(_.innerHTML=E),q.forEach(a),g=C(w),f=c(w,"ION-TITLE",{});var W=p(f);v=ke(W,u),W.forEach(a),w.forEach(a),b=C(L),k=c(L,"ION-SEGMENT",{value:!0,"data-svelte-h":!0}),le(k)!=="svelte-lue4c9"&&(k.innerHTML=O),L.forEach(a),B=C(I),M&&M.l(I),z=Se(),this.h()},h(){m(n,"title","Atrás"),m(n,"alt","Atrás"),m(l,"slot","start"),m(h,"slot","end"),m(k,"value","list"),m(e,"translucent","")},m(I,L){Y(I,e,L),o(e,t),o(t,l),o(l,n),o(t,d),o(t,h),o(h,_),o(t,g),o(t,f),o(f,v),o(e,b),o(e,k),Y(I,B,L),M&&M.m(I,L),Y(I,z,L),V||(F=[me(n,"click",i[17]),me(_,"click",i[20]),me(k,"ionChange",i[21])],V=!0)},p(I,L){L[0]&64&&u!==(u=(I[6].name?I[6].name.toUpperCase():"")+"")&&we(v,u),A===(A=R(I))&&M?M.p(I,L):(M&&M.d(1),M=A&&A(I),M&&(M.c(),M.m(z.parentNode,z)))},d(I){I&&(a(e),a(B),a(z)),M&&M.d(I),V=!1,Be(F)}}}function _o(i){let e,t,l,n=i[2]&&Rt(i);return{c(){e=T(),n&&n.c(),t=Se(),this.h()},l(r){xt("svelte-kn0kph",St.head).forEach(a),e=C(r),n&&n.l(r),t=Se(),this.h()},h(){St.title="Rutaflow - Detalles de ruta"},m(r,d){Y(r,e,d),n&&n.m(r,d),Y(r,t,d),l=!0},p(r,d){r[2]?n?(n.p(r,d),d[0]&4&&nt(n,1)):(n=Rt(r),n.c(),nt(n,1),n.m(t.parentNode,t)):n&&(sn(),rt(n,1,1,()=>{n=null}),nn())},i(r){l||(nt(n),l=!0)},o(r){rt(n),l=!1},d(r){r&&(a(e),a(t)),n&&n.d(r)}}}function De(i,e=""){let t="#ffffff";return i==="pending"&&!e?t="#f2e300":i=="pending"&&e?t="#F6A833":i==="completed"&&(t="#44d900"),t}function Ge(i){let e="";return i=="pending"?e="Pendiente":i=="completed"&&(e="Completado"),e}function ze(i){i.slice(0,1)==="#"&&(i=i.slice(1)),i.length===3&&(i=i.split("").map(function(r){return r+r}).join(""));const e=parseInt(i.substr(0,2),16),t=parseInt(i.substr(2,2),16),l=parseInt(i.substr(4,2),16);return(e*299+t*587+l*114)/1e3>=128?"#414040":"#fff"}const ho=i=>i.mandatory==="1",po=i=>i.img;function mo(i,e,t){let l;en(i,In,y=>t(19,l=y));var n=this&&this.__awaiter||function(y,K,U,H){function J(D){return D instanceof U?D:new U(function(P){P(D)})}return new(U||(U=Promise))(function(D,P){function x(N){try{se(H.next(N))}catch(X){P(X)}}function ae(N){try{se(H.throw(N))}catch(X){P(X)}}function se(N){N.done?D(N.value):J(N.value).then(x,ae)}se((H=H.apply(y,K||[])).next())})};let{routeId:r}=e,{driverId:d}=e,h=lt,_=new Object,E=!0,g=!1,f=[],u={},v=[],b=[],k,O=!1,B="list",z;const V=()=>n(void 0,void 0,void 0,function*(){yield A(r),k.complete()});Ye(()=>n(void 0,void 0,void 0,function*(){yield A(r)}));function F(y){return n(this,void 0,void 0,function*(){if(t(9,B=y),B==="map"){yield tn(),z=document.getElementById("g_map");const K=new google.maps.Map(z,{zoom:8,center:{lat:20.6745683,lng:-103.3986104},mapId:"4504f8b37365c3d0"}),U=new google.maps.LatLngBounds,{AdvancedMarkerElement:H,PinElement:J}=yield google.maps.importLibrary("marker");navigator.geolocation?navigator.geolocation.getCurrentPosition(function(D){const P=new google.maps.LatLng(D.coords.latitude,D.coords.longitude);new google.maps.Marker({position:P,map:K,icon:{path:google.maps.SymbolPath.CIRCLE,fillColor:"#0062ff",fillOpacity:1,scale:6,strokeColor:"#ffffff",strokeWeight:2}}),new google.maps.Circle({strokeColor:"#00BFFF",strokeOpacity:.5,strokeWeight:1,fillColor:"#00BFFF",fillOpacity:.2,map:K,center:P,radius:D.coords.accuracy}),U.extend(P)},function(D){console.error("Error retrieving location:",D)}):console.error("Geolocation not supported by this browser."),u.lat1===u.lat2&&u.lon1===u.lon2?R(U,K,{lat:u.lat2,lon:u.lon2,color:u.color,title:u.destination},{type:"icon",iconClass:"icon-home",title:"Origen/Destino",glyph:`0,${String(f.length+1)}`}):(R(U,K,{lat:u.lat1,lon:u.lon1,color:u.color,title:u.origin},{type:"icon",iconClass:"icon-home",title:"Origen",glyph:"0"}),R(U,K,{lat:u.lat2,lon:u.lon2,color:u.color,title:u.destination},{type:"icon",iconClass:"icon-flag",title:"Destino",glyph:String(f.length+1)})),f.forEach((D,P)=>{const x=parseFloat(D.lat),ae=parseFloat(D.lon),se=new google.maps.LatLng(x,ae),N=new google.maps.Marker({position:{lat:x,lng:ae},map:K,title:D.title}),X=new J({background:De(D.status,D.date_service),borderColor:"#000",glyphColor:"#000",glyph:(parseInt(D.pos)+1).toString()});new H({map:K,position:se,content:X.element,title:"Parada "+(parseInt(D.pos)+1).toString()+": "+D.title}).addListener("click",function(pe){I(D,!1)}),U.extend(N.getPosition())}),K.fitBounds(U)}})}function R(y,K,U,H){return n(this,void 0,void 0,function*(){let J;const D=parseFloat(U.lat),P=parseFloat(U.lon),x=new google.maps.LatLng(D,P),{AdvancedMarkerElement:ae,PinElement:se}=yield google.maps.importLibrary("marker");H.type=="icon"?(J=document.createElement("i"),J.className=`${H.iconClass} icon`,J.style.fontSize="14px",J.style.color=ze(U.color),J.style.fontWeight="600"):H.type=="text";const N=new google.maps.Marker({position:{lat:D,lng:P},map:K,title:`${H.title}. ${U.title}`}),X=new se({background:U.color,borderColor:"#000",glyphColor:ze(U.color),glyph:H.glyph});return new ae({map:K,position:x,content:X.element,title:H.title+": "+U.title}).addListener("click",function(pe){L(u,H.title=="Destino"||H.title=="Origen/Destino")}),N})}function A(y){return n(this,void 0,void 0,function*(){const K=new FormData;K.append("id_route",y);try{const H=yield(yield fetch(`${h}api/admin/report/seguimiento_list.php`,{method:"POST",body:K})).json();t(6,u=H.data.seguimiento_list[0]),t(5,f=H.data.event_list),t(7,v=H.data.checklist),b=H.data.expenses,u&&t(4,g=u.km_inicial=="0"&&u.gas_inicial=="0"),t(3,E=!1)}catch(U){t(3,E=!1),console.error("Error fetching data:",U)}})}const M=y=>new Promise((K,U)=>{const H=new FormData;H.append("id_route",y.id_route),H.append("id_event",y.id_event),fetch(`${h}api/admin/evidence/evidence_by_event.php`,{method:"POST",body:H}).then(J=>J.json()).then(J=>{K(J.data.event_evidence[0])}).catch(J=>{console.error("Error fetching data:",J),U(J)})}),I=(y,K)=>{M(y).then(U=>{U&&(y.img=U.img,y.driver_comments=U.driver_comments,y.comments=U.comments),Ue("modal-delivery-info",Lt,{delivery:y,isLast:K}).then(H=>{}).finally(()=>{A(r)})})},L=(y,K)=>{var U=new Object;K?U={title:y.destination,line1:y.dest_address}:U={title:y.origin,line1:y.origin_address},U.client_name=y.client_name,U.client_phone=y.tel,U.id_route=y.id_route;var H=!0;Ue("modal-delivery-info",Lt,{delivery:U,isLast:K,flag:H})},w=(y,K,U)=>{var H=!1;return O||(O=!0,Ue("modal-checklist",Qt,{checklist:y,driverId:K,routeId:U,isLast:H}).then(J=>{O=!1}),W(U,"checklist")),""},S=y=>n(void 0,void 0,void 0,function*(){return yield A(y),b.length>0?Ue("modal-expense-detail",lo,{routeId:y,expenses:b}).then(K=>{}):Ue("modal-expense",ct,{routeId:y}).then(K=>{}),""}),q=y=>{if(y.tracking_type=="subscription"){if(y.subscriber_info&&y.payment_type==="cash"&&new Date(y.subscriber_info.payment_next)<new Date)return!0}else if(y.tracking_type=="ecommerce"&&Number(y.payment_pending)>0)return!0;return!1};function W(y,K){let U=new FormData;return U.append("id_route",y),U.append("status",K),fetch(`${h}api/admin/route/change_status.php`,{method:"POST",body:U}).then(H=>H.json()).then(H=>{}).catch(H=>{console.error("Error fetching data:",H)}),""}const j=()=>{_.type=="super"||_.type=="admin"?Ve("/drivers/me"):_.id_driver&&Ve(`/drivers/${_.id_driver}`)},Q=(y,K)=>n(void 0,void 0,void 0,function*(){yield(yield qe.create({header:y||"Error",message:K||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()}),ne=()=>S(r),fe=y=>F(y.detail.value);function ge(y){Me[y?"unshift":"push"](()=>{k=y,t(8,k)})}const _e=()=>{L(u,!1)},de=y=>{const K=f.findIndex(P=>P.id_event===y.id_event),U=K===0,H=K>0?f[K-1]:null,J=U||H&&H.img!==null,D=y.img!==null&&y.img!=="";J||U&&!D?I(y,!1):Q("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")},Ne=()=>{L(u,!0)};function he(y){Me[y?"unshift":"push"](()=>{k=y,t(8,k)})}const Oe=()=>{L(u,!1)},Te=y=>{const K=f.findIndex(P=>P.id_event===y.id_event),U=K===0,H=K>0?f[K-1]:null,J=U||H&&H.img!==null,D=y.img!==null&&y.img!=="";J||U&&!D?I(y,!1):Q("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")},Z=()=>{L(u,!0)};function ee(y){Me[y?"unshift":"push"](()=>{k=y,t(8,k)})}const ie=()=>{L(u,!1)},re=y=>{const K=f.findIndex(P=>P.id_event===y.id_event),U=K===0,H=K>0?f[K-1]:null,J=U||H&&H.img!==null,D=y.img!==null&&y.img!=="";J||U&&!D?I(y,!1):Q("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")},te=()=>{L(u,!0)};return i.$$set=y=>{"routeId"in y&&t(0,r=y.routeId),"driverId"in y&&t(1,d=y.driverId)},i.$$.update=()=>{i.$$.dirty[0]&524293&&(t(0,{routeId:r,driverId:d}=l.params,r,(t(1,d),t(19,l),t(2,_),t(0,r))),t(2,_=JSON.parse(localStorage.getItem("userSession"))),_?_.id_user&&(_.type=="admin"||_.type=="super")?(A(r),Ve(`/drivers/me/routes/${r}`)):_.id_user&&_.id_driver&&(A(r),Ve(`/drivers/${_.id_driver}/routes/${r}`)):Ve("/"))},[r,d,_,E,g,f,u,v,k,B,V,F,I,L,w,S,q,j,Q,l,ne,fe,ge,_e,de,Ne,he,Oe,Te,Z,ee,ie,re,te]}class No extends Xe{constructor(e){super(),We(this,e,mo,_o,Ke,{routeId:0,driverId:1},null,[-1,-1])}}export{No as component};

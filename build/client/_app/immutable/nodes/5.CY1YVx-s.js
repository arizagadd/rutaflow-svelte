import{Z as xe,s as Ke,e as u,j as D,b as f,q as b,d as X,h as s,m as B,v as N,i as U,w as l,x as Z,n as me,z as Pe,_ as Lt,o as At,k as ue,$ as et,t as Q,r as $,f as q,B as F,a0 as Dt,y as ae,a1 as Re,A as He,a2 as ft,l as Bt,p as Pt}from"../chunks/index.BYLndrM5.js";import{S as Ge,i as We,t as ze,a as Qe,c as St,b as Mt,d as Rt,m as Ht,e as Ut,g as qt}from"../chunks/index.BNHbygFo.js";import{e as Te,u as Xe,d as Je,a as Ft,c as zt,b as Vt,i as Tt,f as jt,g as Kt,s as tt,h as Se,j as Gt,p as Wt}from"../chunks/index.vsl-1s80.js";import{g as Ce}from"../chunks/entry.DfGKay2-.js";import"../chunks/index-48209844.IIRtDZyg.js";import{m as nt,a as Ve,I as Xt}from"../chunks/IonPage.KvUD72q2.js";import{q as Jt,t as Yt}from"../chunks/ion-modal.CsJaVgKZ.js";const Zt=(i,e)=>{if(!customElements.get(i)){class t extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const n={};for(const r of this.attributes)n[r.name]=r.value;new e({target:this.shadowRoot,props:n})}}customElements.define(i,t)}},Qt=function(i){return document.createElement(i).constructor!==HTMLElement},$t=(i,e)=>{Qt(i)||Zt(i,e)},je=async(i,e,t)=>{Jt(),Yt(),$t(i,e);const o=await nt.create({component:i,componentProps:t});return o.present(),await o.onWillDismiss()};let Ae=xe({km_inicial:[],gas_inicial:[],km_final:[],gas_final:[]}),Ct=xe({flag:[]});function xt(i){let e,t,o,n,r="Cancelar",_,h,p="Captura de Km/Gas",I,k,m,c="Confirmar",v,g,a,d,O,w,H;return{c(){e=u("ion-header"),t=u("ion-toolbar"),o=u("ion-buttons"),n=u("ion-button"),n.textContent=r,_=D(),h=u("ion-title"),h.textContent=p,I=D(),k=u("ion-buttons"),m=u("ion-button"),m.textContent=c,v=D(),g=u("ion-content"),a=u("ion-item"),d=u("ion-input"),this.h()},l(A){e=f(A,"ION-HEADER",{translucent:!0});var L=b(e);t=f(L,"ION-TOOLBAR",{});var C=b(t);o=f(C,"ION-BUTTONS",{slot:!0});var P=b(o);n=f(P,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),X(n)!=="svelte-17pq4f4"&&(n.textContent=r),P.forEach(s),_=B(C),h=f(C,"ION-TITLE",{"data-svelte-h":!0}),X(h)!=="svelte-1yhkaq7"&&(h.textContent=p),I=B(C),k=f(C,"ION-BUTTONS",{slot:!0});var S=b(k);m=f(S,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),X(m)!=="svelte-cm6j4s"&&(m.textContent=c),S.forEach(s),C.forEach(s),L.forEach(s),v=B(A),g=f(A,"ION-CONTENT",{fullscreen:!0});var y=b(g);a=f(y,"ION-ITEM",{});var z=b(a);d=f(z,"ION-INPUT",{class:!0,inputmode:!0,pattern:!0,type:!0,placeholder:!0,value:!0,required:!0});var E=b(d);E.forEach(s),z.forEach(s),y.forEach(s),this.h()},h(){N(n,"color","medium"),N(o,"slot","start"),N(m,"strong",""),N(k,"slot","end"),N(e,"translucent",""),N(d,"class","fin-km"),N(d,"inputmode","numeric"),N(d,"pattern","[0-9]*"),N(d,"type","number"),N(d,"placeholder",O="Ingresa "+i[0]+" actual"),N(d,"value",i[1]),N(d,"required",""),N(g,"fullscreen","")},m(A,L){U(A,e,L),l(e,t),l(t,o),l(o,n),l(t,_),l(t,h),l(t,I),l(t,k),l(k,m),U(A,v,L),U(A,g,L),l(g,a),l(a,d),w||(H=[Z(n,"click",i[2]),Z(m,"click",i[3]),Z(d,"input",i[4])],w=!0)},p(A,[L]){L&1&&O!==(O="Ingresa "+A[0]+" actual")&&N(d,"placeholder",O),L&2&&N(d,"value",A[1])},i:me,o:me,d(A){A&&(s(e),s(v),s(g)),w=!1,Pe(H)}}}function en(i,e,t){const o=Lt();let n=document.querySelector("ion-modal"),r=n.componentProps.data_type;n.componentProps.isLast;let _;Ct.subscribe(m=>{r=m.flag[0],r=="km_final"||r=="km_inicial"?t(0,_="kilometraje"):t(0,_="litros de gasolina")});let h=0;function p(){nt.dismiss()}function I(){o("modalResult",{data:"Your data",role:"confirm"}),r=="km_inicial"?Ae.update(c=>({...c,km_inicial:[h]})):r=="gas_inicial"?Ae.update(c=>({...c,gas_inicial:[h]})):r=="km_final"?Ae.update(c=>({...c,km_final:[h]})):r=="gas_final"&&Ae.update(c=>({...c,gas_final:[h]})),p()}return[_,h,p,I,m=>t(1,h=m.target.value)]}class tn extends Ge{constructor(e){super(),We(this,e,en,xt,Ke,{})}}const Ze=xe({items:[],checkedIndices:[]});function _t(i,e,t){const o=i.slice();return o[39]=e[t],o}function nn(i){let e,t,o,n,r,_="Kilometraje inicial",h,p,I,k=i[0]?i[0]+" km.":"Cargar km",m,c,v,g,a,d,O,w="Gasolina inicial (litros)",H,A,L,C=i[1]?i[1]+" litros":"Cargar gas",P,S,y,z;return S=et(i[15][0]),{c(){e=u("ion-item"),t=u("ion-label"),o=u("input"),n=D(),r=u("p"),r.textContent=_,h=D(),p=u("ion-button"),I=u("label"),m=Q(k),c=D(),v=u("ion-item"),g=u("ion-label"),a=u("input"),d=D(),O=u("p"),O.textContent=w,H=D(),A=u("ion-button"),L=u("label"),P=Q(C),this.h()},l(E){e=f(E,"ION-ITEM",{});var T=b(e);t=f(T,"ION-LABEL",{style:!0});var M=b(t);o=f(M,"INPUT",{id:!0,style:!0,type:!0}),n=B(M),r=f(M,"P",{style:!0,"data-svelte-h":!0}),X(r)!=="svelte-88twxi"&&(r.textContent=_),M.forEach(s),h=B(T),p=f(T,"ION-BUTTON",{fill:!0,class:!0,"aria-selected":!0});var j=b(p);I=f(j,"LABEL",{for:!0,style:!0});var K=b(I);m=$(K,k),K.forEach(s),j.forEach(s),T.forEach(s),c=B(E),v=f(E,"ION-ITEM",{});var G=b(v);g=f(G,"ION-LABEL",{style:!0});var W=b(g);a=f(W,"INPUT",{id:!0,style:!0,type:!0}),d=B(W),O=f(W,"P",{style:!0,"data-svelte-h":!0}),X(O)!=="svelte-1ux30eb"&&(O.textContent=w),W.forEach(s),H=B(G),A=f(G,"ION-BUTTON",{fill:!0,class:!0});var ee=b(A);L=f(ee,"LABEL",{for:!0,style:!0});var fe=b(L);P=$(fe,C),fe.forEach(s),ee.forEach(s),G.forEach(s),this.h()},h(){q(o,"id","chkbox-km-ini"),F(o,"pointer-events","auto"),q(o,"type","checkbox"),o.required=!0,F(r,"margin-left","10px"),F(t,"display","flex"),q(I,"for","chklist-km-ini"),F(I,"padding","8px 10px"),N(p,"fill","outline"),N(p,"class","loadKmInicial"),N(p,"aria-selected",""),q(a,"id","chkbox-gas-ini"),F(a,"pointer-events","auto"),q(a,"type","checkbox"),a.required=!0,F(O,"margin-left","10px"),F(g,"display","flex"),q(L,"for","chklist-gas-ini"),F(L,"padding","8px 10px"),N(A,"fill","outline"),N(A,"class","loadGasInicial"),S.p(o,a)},m(E,T){U(E,e,T),l(e,t),l(t,o),o.checked=~(i[4]||[]).indexOf(o.__value),l(t,n),l(t,r),l(e,h),l(e,p),l(p,I),l(I,m),U(E,c,T),U(E,v,T),l(v,g),l(g,a),a.checked=~(i[4]||[]).indexOf(a.__value),l(g,d),l(g,O),l(v,H),l(v,A),l(A,L),l(L,P),y||(z=[Z(o,"change",i[19]),Z(p,"click",i[20]),Z(a,"change",i[21]),Z(A,"click",i[22])],y=!0)},p(E,T){T[0]&16&&(o.checked=~(E[4]||[]).indexOf(o.__value)),T[0]&1&&k!==(k=E[0]?E[0]+" km.":"Cargar km")&&ae(m,k),T[0]&16&&(a.checked=~(E[4]||[]).indexOf(a.__value)),T[0]&2&&C!==(C=E[1]?E[1]+" litros":"Cargar gas")&&ae(P,C)},d(E){E&&(s(e),s(c),s(v)),S.r(),y=!1,Pe(z)}}}function on(i){let e,t,o,n,r,_="Kilometraje final",h,p,I,k=i[2]?i[2]+" km.":"Cargar km",m,c,v,g,a,d,O,w="Gasolina final (litros)",H,A,L,C=i[3]?i[3]+" litros":"Cargar gas",P,S,y,z;return S=et(i[15][0]),{c(){e=u("ion-item"),t=u("ion-label"),o=u("input"),n=D(),r=u("p"),r.textContent=_,h=D(),p=u("ion-button"),I=u("label"),m=Q(k),c=D(),v=u("ion-item"),g=u("ion-label"),a=u("input"),d=D(),O=u("p"),O.textContent=w,H=D(),A=u("ion-button"),L=u("label"),P=Q(C),this.h()},l(E){e=f(E,"ION-ITEM",{});var T=b(e);t=f(T,"ION-LABEL",{style:!0});var M=b(t);o=f(M,"INPUT",{id:!0,style:!0,type:!0}),n=B(M),r=f(M,"P",{style:!0,"data-svelte-h":!0}),X(r)!=="svelte-ccmu71"&&(r.textContent=_),M.forEach(s),h=B(T),p=f(T,"ION-BUTTON",{fill:!0,class:!0,"aria-selected":!0});var j=b(p);I=f(j,"LABEL",{for:!0,style:!0});var K=b(I);m=$(K,k),K.forEach(s),j.forEach(s),T.forEach(s),c=B(E),v=f(E,"ION-ITEM",{});var G=b(v);g=f(G,"ION-LABEL",{style:!0});var W=b(g);a=f(W,"INPUT",{id:!0,style:!0,type:!0}),d=B(W),O=f(W,"P",{style:!0,"data-svelte-h":!0}),X(O)!=="svelte-wsoyd2"&&(O.textContent=w),W.forEach(s),H=B(G),A=f(G,"ION-BUTTON",{fill:!0,class:!0});var ee=b(A);L=f(ee,"LABEL",{for:!0,style:!0});var fe=b(L);P=$(fe,C),fe.forEach(s),ee.forEach(s),G.forEach(s),this.h()},h(){q(o,"id","chkbox-km-fin"),F(o,"pointer-events","auto"),q(o,"type","checkbox"),o.required=!0,F(r,"margin-left","10px"),F(t,"display","flex"),q(I,"for","chkbox-km-fin"),F(I,"padding","8px 10px"),N(p,"fill","outline"),N(p,"class","loadKmInicial"),N(p,"aria-selected",""),q(a,"id","chkbox-gas-fin"),F(a,"pointer-events","auto"),q(a,"type","checkbox"),a.required=!0,F(O,"margin-left","10px"),F(g,"display","flex"),q(L,"for","chklist-gas-fin"),F(L,"padding","8px 10px"),N(A,"fill","outline"),N(A,"class","loadGasInicial"),S.p(o,a)},m(E,T){U(E,e,T),l(e,t),l(t,o),o.checked=~(i[4]||[]).indexOf(o.__value),l(t,n),l(t,r),l(e,h),l(e,p),l(p,I),l(I,m),U(E,c,T),U(E,v,T),l(v,g),l(g,a),a.checked=~(i[4]||[]).indexOf(a.__value),l(g,d),l(g,O),l(v,H),l(v,A),l(A,L),l(L,P),y||(z=[Z(o,"change",i[14]),Z(p,"click",i[16]),Z(a,"change",i[17]),Z(A,"click",i[18])],y=!0)},p(E,T){T[0]&16&&(o.checked=~(E[4]||[]).indexOf(o.__value)),T[0]&4&&k!==(k=E[2]?E[2]+" km.":"Cargar km")&&ae(m,k),T[0]&16&&(a.checked=~(E[4]||[]).indexOf(a.__value)),T[0]&8&&C!==(C=E[3]?E[3]+" litros":"Cargar gas")&&ae(P,C)},d(E){E&&(s(e),s(c),s(v)),S.r(),y=!1,Pe(z)}}}function ln(i){let e=[],t=new Map,o,n=Te(i[7]);const r=_=>_[39].id_checklist_event;for(let _=0;_<n.length;_+=1){let h=_t(i,n,_),p=r(h);t.set(p,e[_]=ht(p,h))}return{c(){for(let _=0;_<e.length;_+=1)e[_].c();o=ue()},l(_){for(let h=0;h<e.length;h+=1)e[h].l(_);o=ue()},m(_,h){for(let p=0;p<e.length;p+=1)e[p]&&e[p].m(_,h);U(_,o,h)},p(_,h){h[0]&6384&&(n=Te(_[7]),e=Xe(e,h,r,1,_,n,t,o.parentNode,Je,ht,o,_t))},d(_){_&&s(o);for(let h=0;h<e.length;h+=1)e[h].d(_)}}}function ht(i,e){let t,o,n,r,_,h=e[39].item+"",p,I,k,m,c=(e[6][e[39].id_checklist_event]?e[6][e[39].id_checklist_event]:"Cargar evidencia")+"",v,g,a,d,O,w,H;function A(){return e[24](e[39])}function L(...C){return e[26](e[39],...C)}return O=et(e[15][0]),{key:i,first:null,c(){t=u("ion-item"),o=u("ion-label"),n=u("input"),r=D(),_=u("p"),p=Q(h),I=D(),k=u("ion-button"),m=u("label"),v=Q(c),g=D(),a=u("input"),d=D(),this.h()},l(C){t=f(C,"ION-ITEM",{});var P=b(t);o=f(P,"ION-LABEL",{style:!0});var S=b(o);n=f(S,"INPUT",{id:!0,style:!0,type:!0}),r=B(S),_=f(S,"P",{style:!0});var y=b(_);p=$(y,h),y.forEach(s),S.forEach(s),I=B(P),k=f(P,"ION-BUTTON",{fill:!0,class:!0});var z=b(k);m=f(z,"LABEL",{for:!0,style:!0});var E=b(m);v=$(E,c),E.forEach(s),g=B(z),a=f(z,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0}),z.forEach(s),d=B(P),P.forEach(s),this.h()},h(){q(n,"id",`chkbox-${e[39].id_checklist_event}`),F(n,"pointer-events","auto"),q(n,"type","checkbox"),n.__value=e[39].id_checklist_event,Dt(n,n.__value),n.required=!0,F(_,"margin-left","10px"),F(o,"display","flex"),q(m,"for","chklist-"+e[39].id_checklist_event),F(m,"padding","8px 10px"),F(a,"display","none"),q(a,"id","chklist-"+e[39].id_checklist_event),q(a,"name","fileToUpload"),q(a,"type","file"),q(a,"accept","image/*"),N(k,"fill","outline"),N(k,"class","loadEvidence svelte-1kg2bry"),O.p(n),this.first=t},m(C,P){U(C,t,P),l(t,o),l(o,n),n.checked=~(e[4]||[]).indexOf(n.__value),l(o,r),l(o,_),l(_,p),l(t,I),l(t,k),l(k,m),l(m,v),l(k,g),l(k,a),e[25](a),l(t,d),w||(H=[Z(n,"change",e[23]),Z(n,"change",A),Z(a,"change",L)],w=!0)},p(C,P){e=C,P[0]&16&&(n.checked=~(e[4]||[]).indexOf(n.__value)),P[0]&64&&c!==(c=(e[6][e[39].id_checklist_event]?e[6][e[39].id_checklist_event]:"Cargar evidencia")+"")&&ae(v,c)},d(C){C&&s(t),e[25](null),O.r(),w=!1,Pe(H)}}}function rn(i){let e,t,o,n,r="Cancelar",_,h,p="Requerimientos de ruta",I,k,m,c="Confirmar",v,g,a,d,O,w;function H(P,S){return P[8]?on:nn}let L=H(i)(i),C=i[7]&&ln(i);return{c(){e=u("ion-header"),t=u("ion-toolbar"),o=u("ion-buttons"),n=u("ion-button"),n.textContent=r,_=D(),h=u("ion-title"),h.textContent=p,I=D(),k=u("ion-buttons"),m=u("ion-button"),m.textContent=c,v=D(),g=u("ion-content"),a=u("ion-list"),L.c(),d=D(),C&&C.c(),this.h()},l(P){e=f(P,"ION-HEADER",{translucent:!0});var S=b(e);t=f(S,"ION-TOOLBAR",{});var y=b(t);o=f(y,"ION-BUTTONS",{slot:!0});var z=b(o);n=f(z,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),X(n)!=="svelte-1dnmkxs"&&(n.textContent=r),z.forEach(s),_=B(y),h=f(y,"ION-TITLE",{"data-svelte-h":!0}),X(h)!=="svelte-ucox25"&&(h.textContent=p),I=B(y),k=f(y,"ION-BUTTONS",{slot:!0});var E=b(k);m=f(E,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),X(m)!=="svelte-1ida0il"&&(m.textContent=c),E.forEach(s),y.forEach(s),S.forEach(s),v=B(P),g=f(P,"ION-CONTENT",{fullscreen:!0});var T=b(g);a=f(T,"ION-LIST",{});var M=b(a);L.l(M),d=B(M),C&&C.l(M),M.forEach(s),T.forEach(s),this.h()},h(){N(n,"color","medium"),N(o,"slot","start"),N(m,"strong",""),N(k,"slot","end"),N(e,"translucent",""),N(g,"fullscreen","")},m(P,S){U(P,e,S),l(e,t),l(t,o),l(o,n),l(t,_),l(t,h),l(t,I),l(t,k),l(k,m),U(P,v,S),U(P,g,S),l(g,a),L.m(a,null),l(a,d),C&&C.m(a,null),O||(w=[Z(n,"click",i[9]),Z(m,"click",i[10])],O=!0)},p(P,S){L.p(P,S),P[7]&&C.p(P,S)},i:me,o:me,d(P){P&&(s(e),s(v),s(g)),L.d(),C&&C.d(),O=!1,Pe(w)}}}function yt(i){return typeof i=="object"&&i!==null||Array.isArray(i)?Array.isArray(i)?i.map(e=>yt(e)).flat():Object.keys(i).filter(n=>n.toLowerCase().includes("id_checklist_event")).map(n=>i[n]):(console.error("Invalid input. Please provide a valid object or array."),[])}function an(i,e){let t=new FormData;t.append("id_route",i),t.append("status",e),fetch("https://app.rutaflow.com/api/admin/route/change_status.php",{method:"POST",body:t}).then(o=>o.json()).then(o=>{}).catch(o=>{console.error("Error fetching data:",o)})}function sn(i,e,t){let o=document.querySelector("ion-modal");const n=o.componentProps.checklist,r=o.componentProps.driverId,_=o.componentProps.routeId,h=o.componentProps.isLast;let p,I,k,m,c=[],v=null,g={},a={};At(()=>{h?console.log("Último checklist"):Ze.update(R=>(R.items=yt(n),R))});const d=async()=>{await(await Ve.create({header:"Datos o checklist incompletos",message:"Carga la evidencia requerida y marca todas las casillas para confirmar",buttons:[{text:"Cerrar"}]})).present()},O=async()=>{await(await Ve.create({header:"Datos capturados",message:"El kilometraje y gasolina final fueron registrados correctamente, espere aprobación para finalizar ruta",buttons:[{text:"Cerrar"}]})).present()},w=async R=>{await(await Ve.create({header:"Datos inválidos",message:R=="km"?"Llena correctamente el campo de kilometraje inicial":"Llena correctamente el campo de gasolina inicial",buttons:[{text:"Cerrar"}]})).present()},H=()=>{nt.dismiss(),r?Ce(`/drivers/${r}`):Ce("/drivers/me")},A=()=>{if(h){var R=S(k,"km"),V=S(m,"gas");const J=new FormData;J.append("km_final",R),J.append("gas_final",V),J.append("id_route",_),R&&V?(H(),fetch("https://app.rutaflow.com/api/admin/checklist/add_evidence.php",{method:"POST",body:J}).then(ie=>ie.json()).then(ie=>{O()}).catch(ie=>{console.error("Error fetching data:",ie)})):d()}else{var ne=S(p,"km"),he=S(I,"gas");Ze.update(J=>{if(J.items.every(Y=>J.checkedIndices.includes(Y))&&ne&&he){H();const Y=new FormData;for(const oe in g)if(g.hasOwnProperty(oe)){const{img:pe,img_id:ve}=g[oe];Y.append(`selectedImages[${oe}][img]`,pe),Y.append(`selectedImages[${oe}][img_id]`,ve)}Y.append("km_inicial",ne),Y.append("gas_inicial",he),Y.append("id_route",_),fetch("https://app.rutaflow.com/api/admin/checklist/add_evidence.php",{method:"POST",body:Y}).then(oe=>oe.json()).then(oe=>{an(_,"enroute")}).catch(oe=>{console.error("Error fetching data:",oe)})}else d();return J})}T()},L=async(R,V)=>{const he=R.target.files[0],J=await C(he);if(J){const ie=new FormData;ie.append("fileToUpload",J);try{const de=await fetch("https://app.rutaflow.com/api/admin/manager/upload_img_driver.php",{method:"POST",body:ie});if(de.ok){const Y=await de.json();g={...g,[V]:{img:Y.img,img_id:Y.img_id}},t(6,a={...a,[V]:Y.filename})}else console.error("File upload failed:",de.statusText)}catch(de){console.error("Error during file upload:",de)}}},C=async R=>new Promise(V=>{const ne=new FileReader;ne.onload=he=>{const J=new Image;J.src=he.target.result,J.onload=()=>{const ie=document.createElement("canvas"),de=ie.getContext("2d"),Y=800,oe=600;let pe=J.width,ve=J.height;pe>Y&&(ve*=Y/pe,pe=Y),ve>oe&&(pe*=oe/ve,ve=oe),ie.width=pe,ie.height=ve,de.drawImage(J,0,0,pe,ve),ie.toBlob(Ye=>{V(Ye)},"image/jpeg",.7)}},ne.readAsDataURL(R)}),P=R=>{Ze.update(V=>(V.checkedIndices.indexOf(R)===-1?V.checkedIndices.push(R):console.error(`ID ${R} is already checked.`),V.items.forEach(he=>{he.id_checklist_event===R&&(he.checked=!0)}),V))};function S(R,V){return/^\d+$/.test(R)?parseInt(R,10):(w(V),null)}function y(R,V){z(V),o.componentProps.data_type=V,je("modal-gas-km",tn,{r:V}).then(()=>{Ae.subscribe(ne=>{E(ne)})})}function z(R){Ct.update(V=>({...V,flag:[R]}))}function E(R){t(0,p=R.km_inicial?R.km_inicial:null),t(1,I=R.gas_inicial?R.gas_inicial:null),t(2,k=R.km_final?R.km_final:null),t(3,m=R.gas_final?R.gas_final:null)}function T(){Ae.set({km_inicial:[],gas_inicial:[],km_final:[],gas_final:[]})}const M=[[]];function j(){c=Re(M[0],this.__value,this.checked),t(4,c)}const K=R=>y(R,"km_final");function G(){c=Re(M[0],this.__value,this.checked),t(4,c)}const W=R=>y(R,"gas_final");function ee(){c=Re(M[0],this.__value,this.checked),t(4,c)}const fe=R=>y(R,"km_inicial");function _e(){c=Re(M[0],this.__value,this.checked),t(4,c)}const le=R=>y(R,"gas_inicial");function ge(){c=Re(M[0],this.__value,this.checked),t(4,c)}const ke=R=>P(R.id_checklist_event);function Me(R){He[R?"unshift":"push"](()=>{v=R,t(5,v)})}return[p,I,k,m,c,v,a,n,h,H,A,L,P,y,j,M,K,G,W,ee,fe,_e,le,ge,ke,Me,(R,V)=>L(V,R.id_checklist_event)]}class wt extends Ge{constructor(e){super(),We(this,e,sn,rn,Ke,{},null,[-1,-1])}}function cn(i){let e,t,o,n,r,_="Domicilio 2",h,p,I=i[2].line2+"",k,m,c;return{c(){e=u("ion-item"),t=u("ion-icon"),o=D(),n=u("ion-label"),r=u("p"),r.textContent=_,h=D(),p=u("h2"),k=Q(I),m=D(),c=u("ion-icon"),this.h()},l(v){e=f(v,"ION-ITEM",{href:!0});var g=b(e);t=f(g,"ION-ICON",{icon:!0,slot:!0}),b(t).forEach(s),o=B(g),n=f(g,"ION-LABEL",{class:!0});var a=b(n);r=f(a,"P",{"data-svelte-h":!0}),X(r)!=="svelte-1qy148r"&&(r.textContent=_),h=B(a),p=f(a,"H2",{});var d=b(p);k=$(d,I),d.forEach(s),a.forEach(s),m=B(g),c=f(g,"ION-ICON",{icon:!0,slot:!0}),b(c).forEach(s),g.forEach(s),this.h()},h(){N(t,"icon",tt),N(t,"slot","start"),N(n,"class","ion-text-wrap"),N(c,"icon",Se),N(c,"slot","end"),N(e,"href","https://www.google.com/maps/searhc/?api=1&query="+i[2].line2)},m(v,g){U(v,e,g),l(e,t),l(e,o),l(e,n),l(n,r),l(n,h),l(n,p),l(p,k),l(e,m),l(e,c)},p:me,d(v){v&&s(e)}}}function un(i){let e,t,o,n,r,_="Domicilio 1",h,p,I=i[2].line1+"",k,m,c,v,g=i[2].line2&&i[2].line2.trim().length,a,d=g&&fn(i);return{c(){e=u("ion-item"),t=u("ion-icon"),o=D(),n=u("ion-label"),r=u("p"),r.textContent=_,h=D(),p=u("h2"),k=Q(I),m=D(),c=u("ion-icon"),v=D(),d&&d.c(),a=ue(),this.h()},l(O){e=f(O,"ION-ITEM",{href:!0});var w=b(e);t=f(w,"ION-ICON",{icon:!0,slot:!0}),b(t).forEach(s),o=B(w),n=f(w,"ION-LABEL",{class:!0});var H=b(n);r=f(H,"P",{"data-svelte-h":!0}),X(r)!=="svelte-1ehcrdm"&&(r.textContent=_),h=B(H),p=f(H,"H2",{});var A=b(p);k=$(A,I),A.forEach(s),H.forEach(s),m=B(w),c=f(w,"ION-ICON",{icon:!0,slot:!0}),b(c).forEach(s),w.forEach(s),v=B(O),d&&d.l(O),a=ue(),this.h()},h(){N(t,"icon",tt),N(t,"slot","start"),N(n,"class","ion-text-wrap"),N(c,"icon",Se),N(c,"slot","end"),N(e,"href","https://www.google.com/maps/search/?api=1&query="+i[2].line1)},m(O,w){U(O,e,w),l(e,t),l(e,o),l(e,n),l(n,r),l(n,h),l(n,p),l(p,k),l(e,m),l(e,c),U(O,v,w),d&&d.m(O,w),U(O,a,w)},p(O,w){g&&d.p(O,w)},d(O){O&&(s(e),s(v),s(a)),d&&d.d(O)}}}function fn(i){let e,t,o,n,r,_="Domicilio 2",h,p,I=i[2].line2+"",k,m,c;return{c(){e=u("ion-item"),t=u("ion-icon"),o=D(),n=u("ion-label"),r=u("p"),r.textContent=_,h=D(),p=u("h2"),k=Q(I),m=D(),c=u("ion-icon"),this.h()},l(v){e=f(v,"ION-ITEM",{href:!0});var g=b(e);t=f(g,"ION-ICON",{icon:!0,slot:!0}),b(t).forEach(s),o=B(g),n=f(g,"ION-LABEL",{class:!0});var a=b(n);r=f(a,"P",{"data-svelte-h":!0}),X(r)!=="svelte-1qy148r"&&(r.textContent=_),h=B(a),p=f(a,"H2",{});var d=b(p);k=$(d,I),d.forEach(s),a.forEach(s),m=B(g),c=f(g,"ION-ICON",{icon:!0,slot:!0}),b(c).forEach(s),g.forEach(s),this.h()},h(){N(t,"icon",tt),N(t,"slot","start"),N(n,"class","ion-text-wrap"),N(c,"icon",Se),N(c,"slot","end"),N(e,"href","https://www.google.com/maps/search/?api=1&query="+i[2].line2)},m(v,g){U(v,e,g),l(e,t),l(e,o),l(e,n),l(n,r),l(n,h),l(n,p),l(p,k),l(e,m),l(e,c)},p:me,d(v){v&&s(e)}}}function _n(i){let e,t=i[2].comments!="<br>"&&hn(i);return{c(){t&&t.c(),e=ue()},l(o){t&&t.l(o),e=ue()},m(o,n){t&&t.m(o,n),U(o,e,n)},p(o,n){o[2].comments!="<br>"&&t.p(o,n)},d(o){o&&s(e),t&&t.d(o)}}}function hn(i){let e,t,o,n,r,_="Notas de ubicación",h,p,I=i[2].comments+"",k;return{c(){e=u("ion-item"),t=u("ion-icon"),o=D(),n=u("ion-label"),r=u("p"),r.textContent=_,h=D(),p=u("h2"),k=Q(I),this.h()},l(m){e=f(m,"ION-ITEM",{});var c=b(e);t=f(c,"ION-ICON",{icon:!0,slot:!0}),b(t).forEach(s),o=B(c),n=f(c,"ION-LABEL",{class:!0});var v=b(n);r=f(v,"P",{"data-svelte-h":!0}),X(r)!=="svelte-nhm2ft"&&(r.textContent=_),h=B(v),p=f(v,"H2",{});var g=b(p);k=$(g,I),g.forEach(s),v.forEach(s),c.forEach(s),this.h()},h(){N(t,"icon",Tt),N(t,"slot","start"),N(n,"class","ion-text-wrap")},m(m,c){U(m,e,c),l(e,t),l(e,o),l(e,n),l(n,r),l(n,h),l(n,p),l(p,k)},p:me,d(m){m&&s(e)}}}function dn(i){let e,t,o,n,r,_="Horarios",h,p,I=i[2].schedule+"",k;return{c(){e=u("ion-item"),t=u("ion-icon"),o=D(),n=u("ion-label"),r=u("p"),r.textContent=_,h=D(),p=u("h2"),k=Q(I),this.h()},l(m){e=f(m,"ION-ITEM",{});var c=b(e);t=f(c,"ION-ICON",{icon:!0,slot:!0}),b(t).forEach(s),o=B(c),n=f(c,"ION-LABEL",{});var v=b(n);r=f(v,"P",{"data-svelte-h":!0}),X(r)!=="svelte-11q7hm5"&&(r.textContent=_),h=B(v),p=f(v,"H2",{});var g=b(p);k=$(g,I),g.forEach(s),v.forEach(s),c.forEach(s),this.h()},h(){N(t,"icon",jt),N(t,"slot","start")},m(m,c){U(m,e,c),l(e,t),l(e,o),l(e,n),l(n,r),l(n,h),l(n,p),l(p,k)},p:me,d(m){m&&s(e)}}}function pn(i){let e,t,o,n,r,_="Notas del operador",h,p,I=i[2].driver_comments+"",k;return{c(){e=u("ion-item"),t=u("ion-icon"),o=D(),n=u("ion-label"),r=u("p"),r.textContent=_,h=D(),p=u("h2"),k=Q(I),this.h()},l(m){e=f(m,"ION-ITEM",{});var c=b(e);t=f(c,"ION-ICON",{icon:!0,slot:!0}),b(t).forEach(s),o=B(c),n=f(c,"ION-LABEL",{});var v=b(n);r=f(v,"P",{"data-svelte-h":!0}),X(r)!=="svelte-1yk9qp4"&&(r.textContent=_),h=B(v),p=f(v,"H2",{});var g=b(p);k=$(g,I),g.forEach(s),v.forEach(s),c.forEach(s),this.h()},h(){N(t,"icon",Kt),N(t,"slot","start")},m(m,c){U(m,e,c),l(e,t),l(e,o),l(e,n),l(n,r),l(n,h),l(n,p),l(p,k)},p:me,d(m){m&&s(e)}}}function mn(i){let e,t=i[2].logistic_comments!="<br>"&&vn(i);return{c(){t&&t.c(),e=ue()},l(o){t&&t.l(o),e=ue()},m(o,n){t&&t.m(o,n),U(o,e,n)},p(o,n){o[2].logistic_comments!="<br>"&&t.p(o,n)},d(o){o&&s(e),t&&t.d(o)}}}function vn(i){let e,t,o,n,r,_="Comentarios logísticos",h,p,I=i[2].logistic_comments+"",k;return{c(){e=u("ion-item"),t=u("ion-icon"),o=D(),n=u("ion-label"),r=u("p"),r.textContent=_,h=D(),p=u("h2"),k=Q(I),this.h()},l(m){e=f(m,"ION-ITEM",{});var c=b(e);t=f(c,"ION-ICON",{icon:!0,slot:!0}),b(t).forEach(s),o=B(c),n=f(c,"ION-LABEL",{class:!0});var v=b(n);r=f(v,"P",{"data-svelte-h":!0}),X(r)!=="svelte-1iz85r6"&&(r.textContent=_),h=B(v),p=f(v,"H2",{});var g=b(p);k=$(g,I),g.forEach(s),v.forEach(s),c.forEach(s),this.h()},h(){N(t,"icon",Tt),N(t,"slot","start"),N(n,"class","ion-text-wrap")},m(m,c){U(m,e,c),l(e,t),l(e,o),l(e,n),l(n,r),l(n,h),l(n,p),l(p,k)},p:me,d(m){m&&s(e)}}}function dt(i){let e,t,o;return{c(){e=u("section"),t=u("ion-img"),this.h()},l(n){e=f(n,"SECTION",{});var r=b(e);t=f(r,"ION-IMG",{src:!0,alt:!0,style:!0}),b(t).forEach(s),r.forEach(s),this.h()},h(){ft(t.src,o=i[1])||N(t,"src",o),N(t,"alt","Evidencia fotográfica"),F(t,"max-width","100%"),F(t,"margin-top","16px")},m(n,r){U(n,e,r),l(e,t)},p(n,r){r&2&&!ft(t.src,o=n[1])&&N(t,"src",o)},d(n){n&&s(e)}}}function bn(i){let e,t,o,n,r="Cancelar",_,h,p=i[2].title+"",I,k,m,c,v="Confirmar",g,a,d,O,w,H,A,L,C="Cliente",P,S,y=i[2].client_name+"",z,E,T,M=i[2].comments&&i[2].comments.trim().length,j,K=i[2].schedule&&i[2].schedule.trim().length,G,W,ee=i[2].logistic_comments&&i[2].logistic_comments.trim().length,fe,_e,le,ge,ke,Me,ye,R,V,ne,he,J,ie="Subir Evidencia",de,Y,oe,pe,ve;function Ye(x,se){if(x[2].line1&&x[2].line1.trim().length)return un;if(x[2].line2&&x[2].line2.trim().length)return cn}let ot=Ye(i),be=ot&&ot(i),Ee=M&&_n(i),Ie=K&&dn(i),Oe=i[2].driver_comments&&pn(i),Ne=ee&&mn(i),re=i[1]&&dt(i);return{c(){e=u("ion-header"),t=u("ion-toolbar"),o=u("ion-buttons"),n=u("ion-button"),n.textContent=r,_=D(),h=u("ion-title"),I=Q(p),k=D(),m=u("ion-buttons"),c=u("ion-button"),c.textContent=v,g=D(),a=u("ion-content"),d=u("ion-list"),O=u("ion-item"),w=u("ion-icon"),H=D(),A=u("ion-label"),L=u("p"),L.textContent=C,P=D(),S=u("h2"),z=Q(y),E=D(),be&&be.c(),T=D(),Ee&&Ee.c(),j=D(),Ie&&Ie.c(),G=D(),Oe&&Oe.c(),W=D(),Ne&&Ne.c(),fe=D(),_e=u("ion-item"),le=u("ion-icon"),ge=D(),ke=u("ion-textarea"),Me=D(),ye=u("section"),R=u("label"),V=u("ion-button"),ne=u("ion-icon"),he=D(),J=u("label"),J.textContent=ie,de=D(),Y=u("input"),oe=D(),re&&re.c(),this.h()},l(x){e=f(x,"ION-HEADER",{translucent:!0});var se=b(e);t=f(se,"ION-TOOLBAR",{});var we=b(t);o=f(we,"ION-BUTTONS",{slot:!0});var lt=b(o);n=f(lt,"ION-BUTTON",{color:!0,"data-svelte-h":!0}),X(n)!=="svelte-1f8rjcf"&&(n.textContent=r),lt.forEach(s),_=B(we),h=f(we,"ION-TITLE",{title:!0});var it=b(h);I=$(it,p),it.forEach(s),k=B(we),m=f(we,"ION-BUTTONS",{slot:!0});var rt=b(m);c=f(rt,"ION-BUTTON",{strong:!0,"data-svelte-h":!0}),X(c)!=="svelte-1ida0il"&&(c.textContent=v),rt.forEach(s),we.forEach(s),se.forEach(s),g=B(x),a=f(x,"ION-CONTENT",{fullscreen:!0});var at=b(a);d=f(at,"ION-LIST",{});var te=b(d);O=f(te,"ION-ITEM",{});var Ue=b(O);w=f(Ue,"ION-ICON",{icon:!0,slot:!0}),b(w).forEach(s),H=B(Ue),A=f(Ue,"ION-LABEL",{});var qe=b(A);L=f(qe,"P",{"data-svelte-h":!0}),X(L)!=="svelte-jrq7ei"&&(L.textContent=C),P=B(qe),S=f(qe,"H2",{});var st=b(S);z=$(st,y),st.forEach(s),qe.forEach(s),Ue.forEach(s),E=B(te),be&&be.l(te),T=B(te),Ee&&Ee.l(te),j=B(te),Ie&&Ie.l(te),G=B(te),Oe&&Oe.l(te),W=B(te),Ne&&Ne.l(te),fe=B(te),_e=f(te,"ION-ITEM",{});var Fe=b(_e);le=f(Fe,"ION-ICON",{icon:!0,slot:!0}),b(le).forEach(s),ge=B(Fe),ke=f(Fe,"ION-TEXTAREA",{label:!0,placeholder:!0}),b(ke).forEach(s),Fe.forEach(s),Me=B(te),ye=f(te,"SECTION",{});var ct=b(ye);R=f(ct,"LABEL",{for:!0,style:!0});var ut=b(R);V=f(ut,"ION-BUTTON",{fill:!0,class:!0,expand:!0});var Le=b(V);ne=f(Le,"ION-ICON",{icon:!0,slot:!0}),b(ne).forEach(s),he=B(Le),J=f(Le,"LABEL",{for:!0,style:!0,"data-svelte-h":!0}),X(J)!=="svelte-1as0od8"&&(J.textContent=ie),de=B(Le),Y=f(Le,"INPUT",{style:!0,id:!0,name:!0,type:!0,accept:!0}),Le.forEach(s),ut.forEach(s),ct.forEach(s),oe=B(te),re&&re.l(te),te.forEach(s),at.forEach(s),this.h()},h(){N(n,"color","medium"),N(o,"slot","start"),N(h,"title",i[2].title),N(c,"strong",""),N(m,"slot","end"),N(e,"translucent",""),N(w,"icon",Ft),N(w,"slot","start"),N(le,"icon",zt),N(le,"slot","start"),N(ke,"label","Notas"),N(ke,"placeholder","Escribe aquí..."),N(ne,"icon",Vt),N(ne,"slot","start"),q(J,"for","eventEvidence"),F(J,"padding","8px 10px"),F(Y,"display","none"),q(Y,"id","eventEvidence"),q(Y,"name","fileToUpload"),q(Y,"type","file"),q(Y,"accept","image/*"),N(V,"fill","outline"),N(V,"class","loadEvidence"),N(V,"expand","block"),q(R,"for","eventEvidence"),F(R,"display","block"),F(R,"width","100%"),N(a,"fullscreen","")},m(x,se){U(x,e,se),l(e,t),l(t,o),l(o,n),l(t,_),l(t,h),l(h,I),l(t,k),l(t,m),l(m,c),U(x,g,se),U(x,a,se),l(a,d),l(d,O),l(O,w),l(O,H),l(O,A),l(A,L),l(A,P),l(A,S),l(S,z),l(d,E),be&&be.m(d,null),l(d,T),Ee&&Ee.m(d,null),l(d,j),Ie&&Ie.m(d,null),l(d,G),Oe&&Oe.m(d,null),l(d,W),Ne&&Ne.m(d,null),l(d,fe),l(d,_e),l(_e,le),l(_e,ge),l(_e,ke),i[6](ke),l(d,Me),l(d,ye),l(ye,R),l(R,V),l(V,ne),l(V,he),l(V,J),l(V,de),l(V,Y),l(d,oe),re&&re.m(d,null),pe||(ve=[Z(n,"click",i[4]),Z(c,"click",i[5]),Z(Y,"change",i[3])],pe=!0)},p(x,[se]){be&&be.p(x,se),M&&Ee.p(x,se),K&&Ie.p(x,se),x[2].driver_comments&&Oe.p(x,se),ee&&Ne.p(x,se),x[1]?re?re.p(x,se):(re=dt(x),re.c(),re.m(d,null)):re&&(re.d(1),re=null)},i:me,o:me,d(x){x&&(s(e),s(g),s(a)),be&&be.d(),Ee&&Ee.d(),Ie&&Ie.d(),Oe&&Oe.d(),Ne&&Ne.d(),i[6](null),re&&re.d(),pe=!1,Pe(ve)}}}function gn(i,e,t){let o=document.querySelector("ion-modal"),n=o.componentProps.delivery,r=o.componentProps.isLast,_=n.driver_comments?n.driver_comments:"",h=n.img?n.img:"",p="";const I=async a=>{const O=a.target.files[0],w=await k(O);if(w){const H=new FormData;H.append("fileToUpload",w);try{const A=await fetch("https://app.rutaflow.com/api/admin/manager/upload_img_driver.php",{method:"POST",body:H});if(A.ok){const L=await A.json();t(1,h=L.img),p=L.img_id}else console.error("File upload failed:",A.statusText)}catch(A){console.error("Error during file upload:",A)}}},k=async a=>new Promise(d=>{const O=new FileReader;O.onload=w=>{const H=new Image;H.src=w.target.result,H.onload=()=>{const A=document.createElement("canvas"),L=A.getContext("2d"),C=800,P=600;let S=H.width,y=H.height;S>C&&(y*=C/S,S=C),y>P&&(S*=P/y,y=P),A.width=S,A.height=y,L.drawImage(H,0,0,S,y),A.toBlob(z=>{d(z)},"image/jpeg",.7)}},O.readAsDataURL(a)}),m=()=>{o.dismiss({data:Date.now()})},c=()=>{var a=new Object;a.id_route=n.id_route,a.id_event=n.id_event,a.comments=_.value,a.img=h,a.img_id=p;const d=new FormData;for(const O in a)d.append(O,a[O]);fetch("https://app.rutaflow.com/api/admin/evidence/send_evidence.php",{method:"POST",body:d}).then(O=>O.json()).then(O=>{m();var w=a.id_route;r&&v("","",w,r)}).catch(O=>{console.error("Error fetching data:",O)})},v=(a,d,O,w)=>{o.componentProps.routeId=O,o.componentProps.driverId=n.id_driver,je("modal-km-gas",wt,{checklist:a,driverId:d,routeId:O,isLast:w}).then(H=>{})};function g(a){He[a?"unshift":"push"](()=>{_=a,t(0,_)})}return[_,h,n,I,m,c,g]}class kn extends Ge{constructor(e){super(),We(this,e,gn,bn,Ke,{})}}function pt(i,e,t){const o=i.slice();return o[26]=e[t],o}function mt(i,e,t){const o=i.slice();return o[26]=e[t],o[28]=t,o}function vt(i,e,t){const o=i.slice();return o[26]=e[t],o[28]=t,o}function bt(i){let e,t;return e=new Xt({props:{$$slots:{default:[Tn]},$$scope:{ctx:i}}}),{c(){Mt(e.$$.fragment)},l(o){Rt(e.$$.fragment,o)},m(o,n){Ht(e,o,n),t=!0},p(o,n){const r={};n[0]&127|n[1]&2&&(r.$$scope={dirty:n,ctx:o}),e.$set(r)},i(o){t||(ze(e.$$.fragment,o),t=!0)},o(o){Qe(e.$$.fragment,o),t=!1},d(o){Ut(e,o)}}}function En(i){let e=$e(i[0],"enroute")+"",t,o,n,r,_='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Jala para actualizar" refreshing-spinner="circles" refreshing-text="Actualizando..."></ion-refresher-content>',h,p,I=[],k=new Map,m,c,v=Te(i[3]);const g=a=>a[26].id_event;for(let a=0;a<v.length;a+=1){let d=pt(i,v,a),O=g(d);k.set(O,I[a]=kt(O,d))}return{c(){t=Q(e),o=D(),n=u("ion-content"),r=u("ion-refresher"),r.innerHTML=_,h=D(),p=u("ion-list");for(let a=0;a<I.length;a+=1)I[a].c();this.h()},l(a){t=$(a,e),o=B(a),n=f(a,"ION-CONTENT",{});var d=b(n);r=f(d,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),X(r)!=="svelte-1jkndk3"&&(r.innerHTML=_),h=B(d),p=f(d,"ION-LIST",{});var O=b(p);for(let w=0;w<I.length;w+=1)I[w].l(O);O.forEach(s),d.forEach(s),this.h()},h(){N(r,"slot","fixed")},m(a,d){U(a,t,d),U(a,o,d),U(a,n,d),l(n,r),i[19](r),l(n,h),l(n,p);for(let O=0;O<I.length;O+=1)I[O]&&I[O].m(p,null);m||(c=Z(r,"ionRefresh",i[7]),m=!0)},p(a,d){d[0]&1&&e!==(e=$e(a[0],"enroute")+"")&&ae(t,e),d[0]&5384&&(v=Te(a[3]),I=Xe(I,d,g,1,a,v,k,p,Je,kt,null,pt))},d(a){a&&(s(t),s(o),s(n)),i[19](null);for(let d=0;d<I.length;d+=1)I[d].d();m=!1,c()}}}function In(i){let e,t;function o(_,h){return h[0]&32&&(e=null),e==null&&(e=!!_[5].every(yn)),e?Nn:On}let n=o(i,[-1,-1]),r=n(i);return{c(){r.c(),t=ue()},l(_){r.l(_),t=ue()},m(_,h){r.m(_,h),U(_,t,h)},p(_,h){n===(n=o(_,h))&&r?r.p(_,h):(r.d(1),r=n(_),r&&(r.c(),r.m(t.parentNode,t)))},d(_){_&&s(t),r.d(_)}}}function gt(i){let e;return{c(){e=u("span"),this.h()},l(t){e=f(t,"SPAN",{class:!0}),b(e).forEach(s),this.h()},h(){q(e,"class","notes svelte-ziybgw")},m(t,o){U(t,e,o)},d(t){t&&s(e)}}}function kt(i,e){let t,o,n,r,_=parseInt(e[26].pos)+1+"",h,p,I,k,m,c,v=e[26].title+"",g,a,d=e[26].support_list&&e[26].support_list.length||e[10](e[26]),O,w,H,A,L,C=d&&gt();function P(){return e[20](e[26])}return{key:i,first:null,c(){t=u("ion-item"),o=u("ion-avatar"),n=u("div"),r=u("div"),h=Q(_),I=D(),k=u("ion-label"),m=u("ion-text"),c=u("h3"),g=Q(v),a=D(),C&&C.c(),O=D(),w=u("ion-icon"),H=D(),this.h()},l(S){t=f(S,"ION-ITEM",{});var y=b(t);o=f(y,"ION-AVATAR",{slot:!0});var z=b(o);n=f(z,"DIV",{class:!0,title:!0,style:!0});var E=b(n);r=f(E,"DIV",{class:!0});var T=b(r);h=$(T,_),T.forEach(s),E.forEach(s),z.forEach(s),I=B(y),k=f(y,"ION-LABEL",{button:!0});var M=b(k);m=f(M,"ION-TEXT",{color:!0});var j=b(m);c=f(j,"H3",{});var K=b(c);g=$(K,v),a=B(K),C&&C.l(K),K.forEach(s),j.forEach(s),M.forEach(s),O=B(y),w=f(y,"ION-ICON",{icon:!0,slot:!0,style:!0}),b(w).forEach(s),H=B(y),y.forEach(s),this.h()},h(){q(r,"class","order svelte-ziybgw"),q(n,"class","order-wrapper svelte-ziybgw"),q(n,"title",p=De(e[26].status)),F(n,"background-color",ce(e[26])),F(n,"color",Be(ce(e[26]))),N(o,"slot","start"),N(m,"color","#2e2e2e"),N(k,"button",""),N(w,"icon",Se),N(w,"slot","end"),F(w,"color",ce(e[26])),this.first=t},m(S,y){U(S,t,y),l(t,o),l(o,n),l(n,r),l(r,h),l(t,I),l(t,k),l(k,m),l(m,c),l(c,g),l(c,a),C&&C.m(c,null),l(t,O),l(t,w),l(t,H),A||(L=Z(k,"click",P),A=!0)},p(S,y){e=S,y[0]&8&&_!==(_=parseInt(e[26].pos)+1+"")&&ae(h,_),y[0]&8&&p!==(p=De(e[26].status))&&q(n,"title",p),y[0]&8&&F(n,"background-color",ce(e[26])),y[0]&8&&F(n,"color",Be(ce(e[26]))),y[0]&8&&v!==(v=e[26].title+"")&&ae(g,v),y[0]&8&&(d=e[26].support_list&&e[26].support_list.length||e[10](e[26])),d?C||(C=gt(),C.c(),C.m(c,null)):C&&(C.d(1),C=null),y[0]&8&&F(w,"color",ce(e[26]))},d(S){S&&s(t),C&&C.d(),A=!1,L()}}}function On(i){let e=i[9](i[5],i[1],i[0])+"",t,o,n,r,_='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Pull to refresh" refreshing-spinner="circles" refreshing-text="Refreshing..."></ion-refresher-content>',h,p,I=[],k=new Map,m,c,v=Te(i[3]);const g=a=>a[26].id_event;for(let a=0;a<v.length;a+=1){let d=mt(i,v,a),O=g(d);k.set(O,I[a]=It(O,d))}return{c(){t=Q(e),o=D(),n=u("ion-content"),r=u("ion-refresher"),r.innerHTML=_,h=D(),p=u("ion-list");for(let a=0;a<I.length;a+=1)I[a].c();this.h()},l(a){t=$(a,e),o=B(a),n=f(a,"ION-CONTENT",{});var d=b(n);r=f(d,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),X(r)!=="svelte-1poui8g"&&(r.innerHTML=_),h=B(d),p=f(d,"ION-LIST",{});var O=b(p);for(let w=0;w<I.length;w+=1)I[w].l(O);O.forEach(s),d.forEach(s),this.h()},h(){N(r,"slot","fixed")},m(a,d){U(a,t,d),U(a,o,d),U(a,n,d),l(n,r),i[17](r),l(n,h),l(n,p);for(let O=0;O<I.length;O+=1)I[O]&&I[O].m(p,null);m||(c=Z(r,"ionRefresh",i[7]),m=!0)},p(a,d){d[0]&35&&e!==(e=a[9](a[5],a[1],a[0])+"")&&ae(t,e),d[0]&9480&&(v=Te(a[3]),I=Xe(I,d,g,1,a,v,k,p,Je,It,null,mt))},d(a){a&&(s(t),s(o),s(n)),i[17](null);for(let d=0;d<I.length;d+=1)I[d].d();m=!1,c()}}}function Nn(i){let e,t,o='<ion-refresher-content pulling-icon="arrow-dropdown" pulling-text="Pull to refresh" refreshing-spinner="circles" refreshing-text="Refreshing..."></ion-refresher-content>',n,r,_=[],h=new Map,p,I,k=Te(i[3]);const m=c=>c[26].id_event;for(let c=0;c<k.length;c+=1){let v=vt(i,k,c),g=m(v);h.set(g,_[c]=Nt(g,v))}return{c(){e=u("ion-content"),t=u("ion-refresher"),t.innerHTML=o,n=D(),r=u("ion-list");for(let c=0;c<_.length;c+=1)_[c].c();this.h()},l(c){e=f(c,"ION-CONTENT",{});var v=b(e);t=f(v,"ION-REFRESHER",{slot:!0,"data-svelte-h":!0}),X(t)!=="svelte-1poui8g"&&(t.innerHTML=o),n=B(v),r=f(v,"ION-LIST",{});var g=b(r);for(let a=0;a<_.length;a+=1)_[a].l(g);g.forEach(s),v.forEach(s),this.h()},h(){N(t,"slot","fixed")},m(c,v){U(c,e,v),l(e,t),i[15](t),l(e,n),l(e,r);for(let g=0;g<_.length;g+=1)_[g]&&_[g].m(r,null);p||(I=Z(t,"ionRefresh",i[7]),p=!0)},p(c,v){v[0]&9480&&(k=Te(c[3]),_=Xe(_,v,m,1,c,k,h,r,Je,Nt,null,vt))},d(c){c&&s(e),i[15](null);for(let v=0;v<_.length;v+=1)_[v].d();p=!1,I()}}}function Et(i){let e;return{c(){e=u("span"),this.h()},l(t){e=f(t,"SPAN",{class:!0}),b(e).forEach(s),this.h()},h(){q(e,"class","notes svelte-ziybgw")},m(t,o){U(t,e,o)},d(t){t&&s(e)}}}function It(i,e){let t,o,n,r,_=parseInt(e[26].pos)+1+"",h,p,I,k,m,c,v=e[26].title+"",g,a,d=e[26].support_list&&e[26].support_list.length||e[10](e[26]),O,w,H="",A,L,C,P,S,y=d&&Et();function z(){return e[18](e[26],e[28])}return{key:i,first:null,c(){t=u("ion-item"),o=u("ion-avatar"),n=u("div"),r=u("div"),h=Q(_),I=D(),k=u("ion-label"),m=u("ion-text"),c=u("h3"),g=Q(v),a=D(),y&&y.c(),O=D(),w=u("div"),w.innerHTML=H,A=D(),L=u("ion-icon"),C=D(),this.h()},l(E){t=f(E,"ION-ITEM",{});var T=b(t);o=f(T,"ION-AVATAR",{slot:!0});var M=b(o);n=f(M,"DIV",{class:!0,title:!0,style:!0});var j=b(n);r=f(j,"DIV",{class:!0});var K=b(r);h=$(K,_),K.forEach(s),j.forEach(s),M.forEach(s),I=B(T),k=f(T,"ION-LABEL",{button:!0});var G=b(k);m=f(G,"ION-TEXT",{color:!0});var W=b(m);c=f(W,"H3",{});var ee=b(c);g=$(ee,v),a=B(ee),y&&y.l(ee),ee.forEach(s),W.forEach(s),O=B(G),w=f(G,"DIV",{class:!0,"data-svelte-h":!0}),X(w)!=="svelte-130ohbs"&&(w.innerHTML=H),G.forEach(s),A=B(T),L=f(T,"ION-ICON",{icon:!0,slot:!0}),b(L).forEach(s),C=B(T),T.forEach(s),this.h()},h(){q(r,"class","order svelte-ziybgw"),q(n,"class","order-wrapper svelte-ziybgw"),q(n,"title",p=De(e[26].status)),F(n,"background-color",ce(e[26])),F(n,"color",Be(ce(e[26]))),N(o,"slot","start"),N(m,"color","#2e2e2e"),q(w,"class","sub svelte-ziybgw"),N(k,"button",""),N(L,"icon",Se),N(L,"slot","end"),this.first=t},m(E,T){U(E,t,T),l(t,o),l(o,n),l(n,r),l(r,h),l(t,I),l(t,k),l(k,m),l(m,c),l(c,g),l(c,a),y&&y.m(c,null),l(k,O),l(k,w),l(t,A),l(t,L),l(t,C),P||(S=Z(k,"click",z),P=!0)},p(E,T){e=E,T[0]&8&&_!==(_=parseInt(e[26].pos)+1+"")&&ae(h,_),T[0]&8&&p!==(p=De(e[26].status))&&q(n,"title",p),T[0]&8&&F(n,"background-color",ce(e[26])),T[0]&8&&F(n,"color",Be(ce(e[26]))),T[0]&8&&v!==(v=e[26].title+"")&&ae(g,v),T[0]&8&&(d=e[26].support_list&&e[26].support_list.length||e[10](e[26])),d?y||(y=Et(),y.c(),y.m(c,null)):y&&(y.d(1),y=null)},d(E){E&&s(t),y&&y.d(),P=!1,S()}}}function Ot(i){let e;return{c(){e=u("span"),this.h()},l(t){e=f(t,"SPAN",{class:!0}),b(e).forEach(s),this.h()},h(){q(e,"class","notes svelte-ziybgw")},m(t,o){U(t,e,o)},d(t){t&&s(e)}}}function Nt(i,e){let t,o,n,r,_=parseInt(e[26].pos)+1+"",h,p,I,k,m,c,v=e[26].title+"",g,a,d=e[26].support_list&&e[26].support_list.length||e[10](e[26]),O,w,H="",A,L,C,P,S,y=d&&Ot();function z(){return e[16](e[26],e[28])}return{key:i,first:null,c(){t=u("ion-item"),o=u("ion-avatar"),n=u("div"),r=u("div"),h=Q(_),I=D(),k=u("ion-label"),m=u("ion-text"),c=u("h3"),g=Q(v),a=D(),y&&y.c(),O=D(),w=u("div"),w.innerHTML=H,A=D(),L=u("ion-icon"),C=D(),this.h()},l(E){t=f(E,"ION-ITEM",{});var T=b(t);o=f(T,"ION-AVATAR",{slot:!0});var M=b(o);n=f(M,"DIV",{class:!0,title:!0,style:!0});var j=b(n);r=f(j,"DIV",{class:!0});var K=b(r);h=$(K,_),K.forEach(s),j.forEach(s),M.forEach(s),I=B(T),k=f(T,"ION-LABEL",{button:!0});var G=b(k);m=f(G,"ION-TEXT",{color:!0});var W=b(m);c=f(W,"H3",{});var ee=b(c);g=$(ee,v),a=B(ee),y&&y.l(ee),ee.forEach(s),W.forEach(s),O=B(G),w=f(G,"DIV",{class:!0,"data-svelte-h":!0}),X(w)!=="svelte-130ohbs"&&(w.innerHTML=H),G.forEach(s),A=B(T),L=f(T,"ION-ICON",{icon:!0,slot:!0}),b(L).forEach(s),C=B(T),T.forEach(s),this.h()},h(){q(r,"class","order svelte-ziybgw"),q(n,"class","order-wrapper svelte-ziybgw"),q(n,"title",p=De(e[26].status)),F(n,"background-color",ce(e[26])),F(n,"color",Be(ce(e[26]))),N(o,"slot","start"),N(m,"color","#2e2e2e"),q(w,"class","sub svelte-ziybgw"),N(k,"button",""),N(L,"icon",Se),N(L,"slot","end"),this.first=t},m(E,T){U(E,t,T),l(t,o),l(o,n),l(n,r),l(r,h),l(t,I),l(t,k),l(k,m),l(m,c),l(c,g),l(c,a),y&&y.m(c,null),l(k,O),l(k,w),l(t,A),l(t,L),l(t,C),P||(S=Z(k,"click",z),P=!0)},p(E,T){e=E,T[0]&8&&_!==(_=parseInt(e[26].pos)+1+"")&&ae(h,_),T[0]&8&&p!==(p=De(e[26].status))&&q(n,"title",p),T[0]&8&&F(n,"background-color",ce(e[26])),T[0]&8&&F(n,"color",Be(ce(e[26]))),T[0]&8&&v!==(v=e[26].title+"")&&ae(g,v),T[0]&8&&(d=e[26].support_list&&e[26].support_list.length||e[10](e[26])),d?y||(y=Ot(),y.c(),y.m(c,null)):y&&(y.d(1),y=null)},d(E){E&&s(t),y&&y.d(),P=!1,S()}}}function Tn(i){let e,t,o,n,r=`<ion-icon icon="${Gt}"></ion-icon>`,_,h,p,I=i[2].name+"",k,m,c,v=i[4].name+"",g,a,d,O,w;function H(C,P){return C[5].length>0?In:En}let A=H(i),L=A(i);return{c(){e=u("ion-header"),t=u("ion-toolbar"),o=u("ion-buttons"),n=u("ion-button"),n.innerHTML=r,_=D(),h=u("ion-buttons"),p=u("ion-button"),k=Q(I),m=D(),c=u("ion-title"),g=Q(v),a=D(),L.c(),d=ue(),this.h()},l(C){e=f(C,"ION-HEADER",{translucent:!0});var P=b(e);t=f(P,"ION-TOOLBAR",{});var S=b(t);o=f(S,"ION-BUTTONS",{slot:!0});var y=b(o);n=f(y,"ION-BUTTON",{title:!0,alt:!0,"data-svelte-h":!0}),X(n)!=="svelte-7ppz3r"&&(n.innerHTML=r),y.forEach(s),_=B(S),h=f(S,"ION-BUTTONS",{slot:!0});var z=b(h);p=f(z,"ION-BUTTON",{});var E=b(p);k=$(E,I),E.forEach(s),z.forEach(s),m=B(S),c=f(S,"ION-TITLE",{});var T=b(c);g=$(T,v),T.forEach(s),S.forEach(s),P.forEach(s),a=B(C),L.l(C),d=ue(),this.h()},h(){N(n,"title","Atrás"),N(n,"alt","Atrás"),N(o,"slot","start"),N(h,"slot","secondary"),N(e,"translucent","")},m(C,P){U(C,e,P),l(e,t),l(t,o),l(o,n),l(t,_),l(t,h),l(h,p),l(p,k),l(t,m),l(t,c),l(c,g),U(C,a,P),L.m(C,P),U(C,d,P),O||(w=Z(n,"click",i[11]),O=!0)},p(C,P){P[0]&4&&I!==(I=C[2].name+"")&&ae(k,I),P[0]&16&&v!==(v=C[4].name+"")&&ae(g,v),A===(A=H(C))&&L?L.p(C,P):(L.d(1),L=A(C),L&&(L.c(),L.m(d.parentNode,d)))},d(C){C&&(s(e),s(a),s(d)),L.d(C),O=!1,w()}}}function Cn(i){let e,t,o,n=i[2]&&bt(i);return{c(){e=D(),n&&n.c(),t=ue(),this.h()},l(r){Bt("svelte-kn0kph",document.head).forEach(s),e=B(r),n&&n.l(r),t=ue(),this.h()},h(){document.title="Rutaflow - Detalles de ruta"},m(r,_){U(r,e,_),n&&n.m(r,_),U(r,t,_),o=!0},p(r,_){r[2]?n?(n.p(r,_),_[0]&4&&ze(n,1)):(n=bt(r),n.c(),ze(n,1),n.m(t.parentNode,t)):n&&(qt(),Qe(n,1,1,()=>{n=null}),St())},i(r){o||(ze(n),o=!0)},o(r){Qe(n),o=!1},d(r){r&&(s(e),s(t)),n&&n.d(r)}}}function ce(i){let e="#ffffff";return i.status==="pending"?e="#f2e300":i.status==="completed"&&(e="#44d900"),e}function De(i){let e="";return i=="pending"?e="Pendiente":i=="completed"&&(e="Completado"),e}function Be(i){i.slice(0,1)==="#"&&(i=i.slice(1)),i.length===3&&(i=i.split("").map(function(r){return r+r}).join(""));const e=parseInt(i.substr(0,2),16),t=parseInt(i.substr(2,2),16),o=parseInt(i.substr(4,2),16);return(e*299+t*587+o*114)/1e3>=128?"#414040":"#fff"}function $e(i,e){let t=new FormData;return t.append("id_route",i),t.append("status",e),fetch("https://app.rutaflow.com/api/admin/route/change_status.php",{method:"POST",body:t}).then(o=>o.json()).then(o=>{}).catch(o=>{console.error("Error fetching data:",o)}),""}const yn=i=>i.img;function wn(i,e,t){let o;Pt(i,Wt,E=>t(14,o=E));var n=this&&this.__awaiter||function(E,T,M,j){function K(G){return G instanceof M?G:new M(function(W){W(G)})}return new(M||(M=Promise))(function(G,W){function ee(le){try{_e(j.next(le))}catch(ge){W(ge)}}function fe(le){try{_e(j.throw(le))}catch(ge){W(ge)}}function _e(le){le.done?G(le.value):K(le.value).then(ee,fe)}_e((j=j.apply(E,T||[])).next())})};let{routeId:r}=e,{driverId:_}=e,h=new Object,p=[],I={},k={},m;const c=()=>n(void 0,void 0,void 0,function*(){yield v(r),m.complete()});function v(E){const T=new FormData;T.append("id_route",E),fetch("https://app.rutaflow.com/api/admin/report/seguimiento_list.php",{method:"POST",body:T}).then(M=>M.json()).then(M=>{t(4,I=M.data.seguimiento_list[0]),t(3,p=M.data.event_list),t(5,k=M.data.checklist)}).catch(M=>{console.error("Error fetching data:",M)})}const g=E=>new Promise((T,M)=>{const j=new FormData;j.append("id_route",E.id_route),j.append("id_event",E.id_event),fetch("https://app.rutaflow.com/api/admin/evidence/evidence_by_event.php",{method:"POST",body:j}).then(K=>K.json()).then(K=>{T(K.data.event_evidence[0])}).catch(K=>{console.error("Error fetching data:",K),M(K)})}),a=(E,T)=>{g(E).then(M=>{E.client_name=I.client_name,M&&(E.img=M.img,E.driver_comments=M.driver_comments,E.comments=M.comments),je("modal-delivery-info",kn,{delivery:E,isLast:T}).then(j=>{})})},d=(E,T,M)=>{var j=!1;return je("modal-checklist",wt,{checklist:E,driverId:T,routeId:M,isLast:j}).then(K=>{}),$e(M,"checklist"),""},O=E=>{if(E.tracking_type=="subscription"){if(E.subscriber_info&&E.payment_type==="cash"&&new Date(E.subscriber_info.payment_next)<new Date)return!0}else if(E.tracking_type=="ecommerce"&&Number(E.payment_pending)>0)return!0;return!1},w=()=>{h.id_driver?Ce(`/drivers/${h.id_driver}`):Ce("/drivers/me")},H=(E,T)=>n(void 0,void 0,void 0,function*(){yield(yield Ve.create({header:E||"Error",message:T||"Vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()});function A(E){return E===p.length-1}function L(E){He[E?"unshift":"push"](()=>{m=E,t(6,m)})}const C=(E,T)=>a(E,A(T));function P(E){He[E?"unshift":"push"](()=>{m=E,t(6,m)})}const S=(E,T)=>a(E,A(T));function y(E){He[E?"unshift":"push"](()=>{m=E,t(6,m)})}const z=E=>{const T=p.findIndex(W=>W.id_event===E.id_event),M=T===0,j=T>0?p[T-1]:null,K=M||j&&j.img!==null,G=E.img!==null&&E.img!=="";K||M&&!G?a(E):H("Información incompleta","No puedes visualizar otras paradas hasta cargar evidencia del destino pasado")};return i.$$set=E=>{"routeId"in E&&t(0,r=E.routeId),"driverId"in E&&t(1,_=E.driverId)},i.$$.update=()=>{i.$$.dirty[0]&16389&&(t(0,{routeId:r,driverId:_}=o.params,r,(t(1,_),t(14,o),t(2,h),t(0,r))),t(2,h=JSON.parse(localStorage.getItem("userSession"))),h?h.id_user&&(h.type=="admin"||h.type=="super")?(Ce(`/drivers/me/routes/${r}`),v(r)):h.id_user&&h.id_driver&&(v(r),Ce(`/drivers/${h.id_driver}/routes/${r}`)):Ce("/"))},[r,_,h,p,I,k,m,c,a,d,O,w,H,A,o,L,C,P,S,y,z]}class Rn extends Ge{constructor(e){super(),We(this,e,wn,Cn,Ke,{routeId:0,driverId:1},null,[-1,-1])}}export{Rn as component};

import{s as oe,n as X,r as ue,b as Y,e as Z}from"../chunks/scheduler.b5b41669.js";import{S as ae,i as re,g as f,h as _,j as b,f as h,y as g,a as ie,z as k,r as H,u as P,v as j,d as A,t as B,w as W,A as x,s as L,x as ee,c as R,k as ce,B as d}from"../chunks/index.0caecd64.js";import"../chunks/index-48209844.1f2cafa1.js";import{I as de,a as te}from"../chunks/IonPage.55f3dafc.js";import{a as pe}from"../chunks/authStore.37f3e6d9.js";import{g as C}from"../chunks/navigation.09f8b6e4.js";function me(a){let e,o,n;return{c(){e=f("ion-input"),this.h()},l(t){e=_(t,"ION-INPUT",{type:!0,name:!0,placeholder:!0,value:!0}),b(e).forEach(h),this.h()},h(){g(e,"type",a[2]),g(e,"name",a[1]),g(e,"placeholder",a[3]),g(e,"value",a[0])},m(t,r){ie(t,e,r),o||(n=[k(e,"ionBlur",a[5]),k(e,"ionChange",a[4])],o=!0)},p(t,[r]){r&4&&g(e,"type",t[2]),r&2&&g(e,"name",t[1]),r&8&&g(e,"placeholder",t[3]),r&1&&g(e,"value",t[0])},i:X,o:X,d(t){t&&h(e),o=!1,ue(n)}}}function fe(a,e,o){let{name:n=""}=e,{type:t="text"}=e,{placeholder:r=""}=e,{value:u}=e;function v(i){o(0,u=i.target.value)}function l(){}return a.$$set=i=>{"name"in i&&o(1,n=i.name),"type"in i&&o(2,t=i.type),"placeholder"in i&&o(3,r=i.placeholder),"value"in i&&o(0,u=i.value)},[u,n,t,r,v,l]}class ne extends ae{constructor(e){super(),re(this,e,fe,me,oe,{name:1,type:2,placeholder:3,value:0})}}function _e(a){let e,o,n='<ion-col></ion-col> <ion-col class="w-80 text-center svelte-19nd3yu"><img src="/app/rutaflow.png" alt="Rutaflow" class="svelte-19nd3yu"/></ion-col> <ion-col></ion-col>',t,r,u,v,l,i,I,c,p,m,S,w,D,M,N,F='<ion-col class="signup-col"><ion-button class="submit-btn svelte-19nd3yu" color="#2c83d3" expand="block" type="submit">Ingresar</ion-button></ion-col>',T,q,J;function se(s){a[3](s)}let U={type:"text",placeholder:"Correo o Usuario",name:"email",required:!0};a[0].email!==void 0&&(U.value=a[0].email),c=new ne({props:U}),Y.push(()=>x(c,"value",se));function le(s){a[4](s)}let z={type:"password",placeholder:"Contraseña",name:"password",required:!0};return a[0].password!==void 0&&(z.value=a[0].password),w=new ne({props:z}),Y.push(()=>x(w,"value",le)),{c(){e=f("ion-content"),o=f("ion-row"),o.innerHTML=n,t=L(),r=f("div"),u=f("form"),v=f("ion-row"),l=f("ion-col"),i=f("ion-list"),I=f("ion-item"),H(c.$$.fragment),m=L(),S=f("ion-item"),H(w.$$.fragment),M=L(),N=f("ion-row"),N.innerHTML=F,this.h()},l(s){e=_(s,"ION-CONTENT",{class:!0,padding:!0});var y=b(e);o=_(y,"ION-ROW",{class:!0,"data-svelte-h":!0}),ee(o)!=="svelte-1mi73el"&&(o.innerHTML=n),t=R(y),r=_(y,"DIV",{class:!0});var E=b(r);u=_(E,"FORM",{});var O=b(u);v=_(O,"ION-ROW",{});var V=b(v);l=_(V,"ION-COL",{});var G=b(l);i=_(G,"ION-LIST",{});var $=b(i);I=_($,"ION-ITEM",{});var K=b(I);P(c.$$.fragment,K),K.forEach(h),m=R($),S=_($,"ION-ITEM",{});var Q=b(S);P(w.$$.fragment,Q),Q.forEach(h),$.forEach(h),G.forEach(h),V.forEach(h),M=R(O),N=_(O,"ION-ROW",{"data-svelte-h":!0}),ee(N)!=="svelte-19dro8s"&&(N.innerHTML=F),O.forEach(h),E.forEach(h),y.forEach(h),this.h()},h(){g(o,"class","logo-row svelte-19nd3yu"),ce(r,"class","login-box svelte-19nd3yu"),g(e,"class","login-content"),g(e,"padding","")},m(s,y){ie(s,e,y),d(e,o),d(e,t),d(e,r),d(r,u),d(u,v),d(v,l),d(l,i),d(i,I),j(c,I,null),d(i,m),d(i,S),j(w,S,null),d(u,M),d(u,N),T=!0,q||(J=k(u,"submit",a[1]),q=!0)},p(s,y){const E={};!p&&y&1&&(p=!0,E.value=s[0].email,Z(()=>p=!1)),c.$set(E);const O={};!D&&y&1&&(D=!0,O.value=s[0].password,Z(()=>D=!1)),w.$set(O)},i(s){T||(A(c.$$.fragment,s),A(w.$$.fragment,s),T=!0)},o(s){B(c.$$.fragment,s),B(w.$$.fragment,s),T=!1},d(s){s&&h(e),W(c),W(w),q=!1,J()}}}function he(a){let e,o;return e=new de({props:{$$slots:{default:[_e]},$$scope:{ctx:a}}}),{c(){H(e.$$.fragment)},l(n){P(e.$$.fragment,n)},m(n,t){j(e,n,t),o=!0},p(n,[t]){const r={};t&33&&(r.$$scope={dirty:t,ctx:n}),e.$set(r)},i(n){o||(A(e.$$.fragment,n),o=!0)},o(n){B(e.$$.fragment,n),o=!1},d(n){W(e,n)}}}function ge(a,e,o){let n={},t=new Object;const r=l=>{l.preventDefault(),console.log("submit",n);const i=async()=>{await(await te.create({header:"Datos inválidos",message:"El correo o la contraseña son incorrectos, vuelva a intentar",buttons:[{text:"Cerrar"}]})).present()},I=async()=>{await(await te.create({header:"Sin perfil de operador",message:"Su cuenta no cuenta con un perfil de operador creado",buttons:[{text:"Cerrar"}]})).present()},c=new FormData;return c.append("email",n.email),c.append("pass",n.password),fetch("https://rutaflow-app-development.up.railway.app/api/admin/user/user_login.php",{method:"POST",body:c}).then(p=>p.json()).then(p=>{if(p.nodos.length){const m=p.nodos[0];localStorage.setItem("userSession",JSON.stringify(m)),pe.set({resolved:!0,id:m.id_driver?m.id_driver:"me",user:{userData:m}}),console.log(m),m.id_driver?C(`/app/drivers/${m.id_driver}`):(C("/app/drivers/me"),I())}else i()}).catch(p=>{i()})};function u(l){a.$$.not_equal(n.email,l)&&(n.email=l,o(0,n))}function v(l){a.$$.not_equal(n.password,l)&&(n.password=l,o(0,n))}return a.$$.update=()=>{a.$$.dirty&4&&(o(2,t=JSON.parse(localStorage.getItem("userSession"))),t?t.id_user&&(t.type=="admin"||t.type=="superadmin")?C("/app/drivers/me"):t.id_user&&t.id_driver&&C(`/app/drivers/${t.id_driver}`):C("/app/"))},[n,r,t,u,v]}class Ne extends ae{constructor(e){super(),re(this,e,ge,he,oe,{})}}export{Ne as component};
